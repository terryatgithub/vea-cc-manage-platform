(function(e){function t(t){for(var n,i,l=t[0],s=t[1],c=t[2],u=0,d=[];u<l.length;u++)i=l[u],r[i]&&d.push(r[i][0]),r[i]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);p&&p(t);while(d.length)d.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],n=!0,i=1;i<a.length;i++){var l=a[i];0!==r[l]&&(n=!1)}n&&(o.splice(t--,1),e=s(s.s=a[0]))}return e}var n={},i={app:0},r={app:0},o=[];function l(e){return s.p+"js/"+({}[e]||e)+"."+{"chunk-15b8f1ca":"db983fe0","chunk-5d18b2b4":"8e4f7c4d","chunk-aeb3c65a":"96f56097","chunk-c9c8ab1e":"9e3eac39","chunk-17556570":"71ba2da7","chunk-186084e7":"a9efe45c","chunk-49f36ed8":"473984de","chunk-54162f7c":"cb053db3","chunk-55807fc4":"5a3e4c4d","chunk-ecc0b95a":"846ea201"}[e]+".js"}function s(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.e=function(e){var t=[],a={"chunk-15b8f1ca":1,"chunk-5d18b2b4":1,"chunk-aeb3c65a":1,"chunk-c9c8ab1e":1,"chunk-17556570":1,"chunk-186084e7":1,"chunk-49f36ed8":1,"chunk-54162f7c":1,"chunk-55807fc4":1,"chunk-ecc0b95a":1};i[e]?t.push(i[e]):0!==i[e]&&a[e]&&t.push(i[e]=new Promise(function(t,a){for(var n="css/"+({}[e]||e)+"."+{"chunk-15b8f1ca":"55dc8277","chunk-5d18b2b4":"8260c5d9","chunk-aeb3c65a":"8260c5d9","chunk-c9c8ab1e":"23b2c47e","chunk-17556570":"c6f0c725","chunk-186084e7":"1bfbcd29","chunk-49f36ed8":"94b708b5","chunk-54162f7c":"ebe7cbd3","chunk-55807fc4":"31bb51b3","chunk-ecc0b95a":"3aefee90"}[e]+".css",r=s.p+n,o=document.getElementsByTagName("link"),l=0;l<o.length;l++){var c=o[l],u=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(u===n||u===r))return t()}var d=document.getElementsByTagName("style");for(l=0;l<d.length;l++){c=d[l],u=c.getAttribute("data-href");if(u===n||u===r)return t()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=t,p.onerror=function(t){var n=t&&t.target&&t.target.src||r,o=new Error("Loading CSS chunk "+e+" failed.\n("+n+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=n,delete i[e],p.parentNode.removeChild(p),a(o)},p.href=r;var h=document.getElementsByTagName("head")[0];h.appendChild(p)}).then(function(){i[e]=0}));var n=r[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise(function(t,a){n=r[e]=[t,a]});t.push(n[2]=o);var c,u=document.createElement("script");u.charset="utf-8",u.timeout=120,s.nc&&u.setAttribute("nonce",s.nc),u.src=l(e),c=function(t){u.onerror=u.onload=null,clearTimeout(d);var a=r[e];if(0!==a){if(a){var n=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src,o=new Error("Loading chunk "+e+" failed.\n("+n+": "+i+")");o.type=n,o.request=i,a[1](o)}r[e]=void 0}};var d=setTimeout(function(){c({type:"timeout",target:u})},12e4);u.onerror=u.onload=c,document.head.appendChild(u)}return Promise.all(t)},s.m=e,s.c=n,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(a,n,function(t){return e[t]}.bind(null,n));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var d=0;d<c.length;d++)t(c[d]);var p=u;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"00b2":function(e,t,a){"use strict";var n=a("9659"),i=a.n(n);i.a},"02ab":function(e,t,a){"use strict";var n=a("4c75"),i=a.n(n);i.a},"03df":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Table",{staticStyle:{"margin-top":"10px"},attrs:{data:e.tableData,header:e.tableHeader,props:{border:!0},selectionType:"none"}})},i=[],r=(a("ac6a"),a("cebc")),o=(a("6b54"),a("59c7")),l=a("193e"),s={data:function(){return{table:{props:{border:!0}}}},components:{Table:o["Table"]},computed:{tableHeader:function(){var e=this,t=(this.header||[]).slice(),a={label:this.orderText||"排序",width:100,render:function(t,a){var n=a.row,i=a.$index,r=n._realIndex,o=void 0===r?i:r;return e.readonly?o+1:t(l["a"],{key:o+Math.random().toString(),props:{value:o+1},on:{input:function(t){e.handleChangeOrder(o,t)}}})}},n={label:"操作",width:80,render:function(t,a){var n=a.$index;a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handleRemoveRow(n)}}},"删除")}};return t.unshift(a),this.hideAction||t.push(n),t},tableData:function(){var e=this.filterFn,t=this.value||[];return e&&(t=t.reduce(function(t,a,n){return e(a)&&t.push(Object(r["a"])({},a,{_realIndex:n})),t},[])),t}},props:["value","header","hideAction","readonly","filterFn","orderText"],methods:{handleChangeOrder:function(e,t){var a=this.value;t>a.length&&(t=a.length);var n=t-1,i=e,r=a[i];a.splice(i,1),this.$emit("input",[].concat(a.slice(0,n),r,a.slice(n)))},handleRemoveRow:function(e){var t=this.value.slice();t.splice(e,1),this.$emit("input",t)},handleAppendData:function(e,t){var a=this.value,n=e,i=e.reduce(function(e,a,n){return e[a[t]]=n,e},{}),r=[];a.forEach(function(e){var a=i[e[t]];void 0!==a&&(r.push(e),n[a]=void 0)}),this.$emit("input",r.concat(n.filter(function(e){return e})))}}},c=s,u=a("2877"),d=Object(u["a"])(c,n,i,!1,null,null,null);t["a"]=d.exports},"03ee":function(e,t,a){"use strict";var n=a("8873"),i=a.n(n);i.a},"04b2":function(e,t,a){"use strict";var n=a("cfd2"),i=a.n(n);i.a},"056e":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"click-copy",attrs:{title:e.title||"复制"},on:{click:function(t){return t.stopPropagation(),e.handleCopy(t)}}},[e._t("default")],2)},i=[],r={props:["title","content","successMsg","errorMsg"],methods:{handleCopy:function(){var e=this;this.doCopy(this.content).then(function(){e.$message.success(e.successMsg||"已复制到剪贴板")}).catch(function(){e.$message.error(e.errorMsg||"复制失败")})},doCopy:function(e){if(navigator.clipboard)return navigator.clipboard.writeText(e);if(document.execCommand){var t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.focus(),t.select();var a=document.execCommand("copy");return document.body.removeChild(t),a?Promise.resolve():Promise.reject()}return Promise.reject(new Error("浏览器不支持复制"))}}},o=r,l=(a("3b78"),a("2877")),s=Object(l["a"])(o,n,i,!1,null,"19d2791a",null);t["a"]=s.exports},"07d0":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("RemoteSelectorWrapper",{ref:"wrapper",attrs:{title:e.title,"custom-class":"resource-selector",disabled:e.disabled,"is-live":e.isLive},on:{"select-start":e.handleSelectStart},scopedSlots:e._u([{key:"content",fn:function(t){var n=t.isShow;return[e.isLive||n?a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"homepageId","selection-type":e.selectionType,"select-end-on-click":!0,table:e.table,filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"pagination-change":e.fetchData,"filter-change":e.handleFilterChange,"filter-reset":e.handleResetFilter,"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}}):e._e()]}}])})},i=[],r=a("a1fe"),o=a("42f0"),l=a("f6e7"),s=a.n(l),c={data:function(){return{options:[],pagination:{currentPage:1,pageSize:15,total:0},filter:this.genDefaultFilter(),filterSchema:null,table:{data:[],selected:[],header:[{label:"ID",prop:"homepageId",width:"100"},{label:"名称",width:"130",prop:"homepageName",sortable:!0},{label:"关联版面名称",prop:"relationTabName",render:function(e,t){var a=t.row,n=a.relationTabName;return n.length>40&&(n=n.substring(0,40)+"..."),e("div",{attrs:{title:a.relationTabName}},n)}},{label:"首页模式",prop:"homepageModel",render:function(e,t){var a=t.row;return"child"===a.homepageModel?"儿童模式":"标准模式"}},{label:"更新时间",prop:"lastUpdateDate",width:150,sortable:!0}],selectionType:"multiple",props:{"tooltip-effect":"dark"}},selected:[],originSelected:[]}},props:["title","disabled","isLive","source","selectionType","category","homepageModel"],components:{RemoteSelectorWrapper:r["a"],BaseSelector:o["a"]},methods:{handleSelectStart:function(){this.$emit("select-start"),this.isLive?this.fetchData():this.handleResetFilter()},handleSelectCancel:function(){this.$refs.wrapper.handleSelectCancel()},handleSelectEnd:function(e){this.$emit("select-end",e),this.$refs.wrapper.handleSelectEnd()},genDefaultFilter:function(){return{homepageModel:this.homepageModel}},handleFilterChange:function(e){this.filter=JSON.parse(JSON.stringify(e)),this.pagination.currentPage=1,this.fetchData()},handleResetFilter:function(){this.filter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=JSON.parse(JSON.stringify(this.filter)),a=this.pagination;a&&(t.page=a.currentPage,t.rows=a.pageSize),this.$service.getHomePageModelPageList(t).then(function(t){e.table.data=t.rows,e.pagination.total=t.total})}},created:function(){var e=s.a.map({homepageId:s.a.o.string.other("form",{component:"Input",placeholder:"ID"}),homepageName:s.a.o.string.other("form",{component:"Input",placeholder:"名称"})}).other("form",{cols:{item:6,label:0,wrapper:22},layout:"inline",footer:{cols:{item:6,label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e}},u=c,d=a("2877"),p=Object(d["a"])(u,n,i,!1,null,null,null);t["a"]=p.exports},"0939":function(e,t,a){},"0a51":function(e,t,a){},"0afe":function(e,t,a){"use strict";var n=a("29b7"),i=a.n(n);i.a},"0c81":function(e,t,a){"use strict";var n=a("7087"),i=a.n(n);i.a},"0e59":function(e,t,a){},"0ea4":function(e,t,a){"use strict";var n=a("fac2"),i=a.n(n);i.a},"0eaa":function(e,t,a){"use strict";var n=a("30f7"),i=a.n(n);i.a},"0f48":function(e,t,a){"use strict";var n=a("b6cd"),i=a.n(n);i.a},"0fb4":function(e,t,a){},"109d":function(e,t,a){},1367:function(e,t,a){"use strict";var n=a("b771"),i=a.n(n);i.a},"13a2":function(e,t,a){"use strict";var n=a("acd5"),i=a.n(n);i.a},1443:function(e,t,a){"use strict";var n=a("1e5f"),i=a.n(n);i.a},"14d4":function(e,t,a){"use strict";var n=a("991a"),i=a.n(n);i.a},1591:function(e,t,a){"use strict";var n=a("60d6"),i=a.n(n);i.a},"15a2":function(e,t,a){},"165a":function(e,t,a){"use strict";var n=a("4903"),i=a.n(n);i.a},"181a":function(e,t,a){},"193e":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-input",{ref:"input",attrs:{disabled:e.disabled},on:{focus:e.handleSelectAll,change:e.handleOrderChange},model:{value:e.order,callback:function(t){e.order=t},expression:"order"}})},i=[],r={data:function(){return{order:void 0}},watch:{value:"handleInputValue"},props:["value","disabled","clearable"],methods:{handleInputValue:function(e){this.order=e},handleSelectAll:function(){this.$refs.input.select()},handleOrderChange:function(e){/^\d+$/.test(e)&&e>0?this.$emit("input",e):(this.$message({type:"error",message:"请输入正整数"}),this.order=this.value)}},created:function(){this.order=this.value}},o=r,l=a("2877"),s=Object(l["a"])(o,n,i,!1,null,null,null);t["a"]=s.exports},"1b36":function(e,t,a){"use strict";var n=a("9cfd"),i=a.n(n);i.a},"1cf5":function(e,t,a){},"1d2f":function(e,t,a){"use strict";var n=a("2bfb"),i=a.n(n);i.a},"1e5f":function(e,t,a){},"1f40":function(e,t,a){},"1faa":function(e,t,a){},"1ffc":function(e,t,a){"use strict";var n=a("6a79"),i=a.n(n);i.a},"1fff":function(e,t,a){},"200b":function(e,t,a){},2149:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-input",{ref:"input",attrs:{type:"text",name:e.name,autocomplete:e.autocomplete,clearable:e.clearable,value:e.inputValue,disabled:e.disabled,placeholder:e.placeholder},on:{input:e.handleInputValue,blur:function(t){return e.$emit("blur")}}},[e.prepend?a("span",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("\n    "+e._s(e.prepend)+"\n  ")]):e._e(),e.append?a("span",{attrs:{slot:"append"},slot:"append"},[e._v("\n    "+e._s(e.append)+"\n  ")]):e._e()])},i=[],r={data:function(){return{inputValue:void 0}},props:["value","disabled","append","prepend","placeholder","name","autocomplete","clearable"],methods:{handleInputValue:function(e){(""===e||/^[1-9]\d*$/.test(e))&&(this.inputValue=e,this.$emit("input",e))}},created:function(){var e=this;this.$watch("value",function(t){e.inputValue!==t&&(e.inputValue=t)},{immediate:!0})}},o=r,l=a("2877"),s=Object(l["a"])(o,n,i,!1,null,null,null);t["a"]=s.exports},2252:function(e,t,a){"use strict";var n=a("7e4f"),i=a.n(n);i.a},2351:function(e,t,a){},2366:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAFxElEQVR4Xu1bXWwUVRT+zt3WLq0iGFTAaKIRwxNIQehM2xkN4osxMSH+gQIamC2IkWh8USNogg8+KAGhu0NVFCFBjUbjkyGhs9CdLT8iEB+IGjQKifJT6w8BlpljRt1SF3fnznQ7u4Xt23bO+b5zvnvumdk7ZwmX+R9d5vmjJkCtAkIqsCSt6AI0F4DKwG0EXBUSqrgb88KUbr+XNzDSygpiGp+L0dq323qOlYMv8BYwMspkypEJQns5AiiFwczzTd3emrdJWMq7IFrA4NMAVvW1269/SHCGEkcgARZ3t7bHhPs5QKOHQirty+7DKT277UIFqJsJeDT/mZn3iCv4waSS/V4as8BQWoAndrVOrHPdQwS6JixZUD9i96Gknv1gQABL2UJE8wbjMPPPsZjQO9t6DgfF9+ylBTDS6kYCFochCetz0RZIq+8DmF+Ix4wTLjmzu7Teg0G5pAR47MCUplH9TX0Eqg9KMBR7gvt4UstuGugBafUdAIv+D5OB48ROa0rv/SYIp5QAiZ0t94HFZ0GAy2HLwDJTy3QOEsAEsKQoNvNRqqPmZGvmF1l+KQGMdMvzBLFaFrRcdsxYbeqZFy/cBVrWg8SykviM7Ckt0yZ7d5ASIGEpa0D0dLkSk8Vh5q2mbg/secNSVxFhpb8/r0xp9iv+dpJN0LCUJBElZADLbHM4pWUmX6gAVQPB8uVgnI0hN2mDvudHP1upCqigABCCJg++xRlpdQOBFwE0qmRyhESqPeP1DB8zPwsAlRSgsA9IhBvIpOorAAHKOVDm/xpXvwAAGPguJujesE97pYQZEQJ4CTDjDIi7BLDZbTx32Jyxrz/Mihf6jBgBgiYr2zsuXQHAb5qa/ZSfcJesAAAnU5q9tCbASH8O8FvB4tdrFVDbApH2AAaOAfyxYM5C4Gj40i1R1KAJYDR75wQEaizNEeUWYN5/vh53v6Xap4Yj8ULMZdYdNzpUfwDA2KroAQSeldTs3VEkn+cwrJaFRGLguOxi7ogqgJn7Td0eE2XyHpexY/o4ijUcr3wFMJ9M6fa4qAXwDmob+6/8o/ICAHDgTA1zJD0U0Yy0cj+BPolKgBQRGcXIGPxlw4Tj6rpJ354dSlKyvh2WMs0lbC/9kiaiHpAPmsE/EFMXBO8l8Jn8/x1H/FkXy52sqxcn1rX0/lYqyQcYsfjBKfHRZ+Jxx4nFXaY4cy7OLOKCMIrc2HgGphHjWRAaquc2KLt0kdpFXAGR5iZFVhOgfN8FEmmlE6AOKeGrxqiMFVAToFYBI28LMNBpapnSL1JlByRktgAz/wRgPQn+moDfh6MVsIvrQTSVQcv9hrLKKsA/7+NQ9ICRwZlzTsPsTXd1DzwADYcAecyOHvU618F+AiYWfzotYwX4CUDMzUnd3j+cSRdiL0mrcwXwUcUF8EbWTM1uijJ5j2vRjtvHNMQa+4rysrshpWef9ItL7r1AiS3A4BwazzWZM/bl/MjKed33PCAqAbykXHLnbGzPbi9ngn5YhqXMI6ItkVRAwio9m+O9vXXqeGZUZ4IdGeUG9zx5TfDaqhDAC8I7GiPB68jFIQhIT2n5rXT+uktMwqGJTKIZ4KV+EyLMvN7U7eV++FI9wK8C/Egqcb0mQDkrwEgrbxBoRSVWMiwnM9aaesZ3tE9qCxhp5TkCvRY2mMr4yc0KSgmQ2DVrDtzYF5VJJBxr4ZxxMRQpAbzDyrE71T6/LyDhQh0eL4fP39Kl7z7ihy4lgAeSSCsvA/SSH2A1XPe+nJma3SoTi7QAf4/M/9r0FRHdKgNcKRv25smEO9ts690hE4O0AB7YYmvmzYLqugm4SQa8EjYM9wVTy74qyx1IAA/U2Dv9ajrdsAbgBQAJWaJht2PsdZie6bqzZ2cQrsAC5MET1qxJIPEIgHsY5P1srvhzeZCIJG29n8kAfASEHkH8abI92y3p+h+z0AKEIatGn5oA1bgqUcZ02VfAX+O2k1+cxKrTAAAAAElFTkSuQmCC"},2537:function(e,t,a){},"25d0":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"coocaaVId","is-live":e.isLive,"selection-type":e.selectionType,table:e.table,pagination:e.pagination,"select-end-on-dbl-click":!0},on:{"pagination-change":e.fetchData,"filter-reset":e.handleFilterReset,"select-cancel":function(t){return e.$emit("select-cancel")},"select-end":e.selectEnd}},[a("el-collapse",{attrs:{slot:"filter",value:"1"},on:{change:e.handleCollapseChange},slot:"filter"},[a("el-collapse-item",{attrs:{title:"查询条件",name:"1"}},[a("el-form",{staticClass:"search-form",attrs:{inline:!0,model:e.filter,"label-width":"80px"},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilterChange(t)}}},[a("el-form-item",{attrs:{label:"渠道"}},[a("CommonSelector",{attrs:{filterable:"",disabled:e.disablePartner,options:e.$consts.partnerOptions},model:{value:e.filter.partner,callback:function(t){e.$set(e.filter,"partner",t)},expression:"filter.partner"}})],1),a("el-form-item",{attrs:{label:"内容源"}},[a("CommonSelector",{attrs:{filterable:"",options:e.sourceEnums},model:{value:e.filter.sources,callback:function(t){e.$set(e.filter,"sources",t)},expression:"filter.sources"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"tencent"===e.filter.sources,expression:"filter.sources === 'tencent'"}],attrs:{label:"牌照"}},[a("CommonSelector",{attrs:{filterable:"",options:e.licenseEnums,clearable:""},model:{value:e.filter.license,callback:function(t){e.$set(e.filter,"license",t)},expression:"filter.license"}})],1),a("el-form-item",{attrs:{label:"频道类型"}},[a("CommonSelector",{attrs:{filterable:"",options:e.categoryEnums,clearable:""},model:{value:e.filter.category,callback:function(t){e.$set(e.filter,"category",t)},expression:"filter.category"}})],1),a("el-form-item",{attrs:{label:"影片类型"}},[a("CommonSelector",{attrs:{filterable:"",options:e.videoTypeEnums,clearable:""},model:{value:e.filter.videoTypes,callback:function(t){e.$set(e.filter,"videoTypes",t)},expression:"filter.videoTypes"}})],1),a("el-form-item",{attrs:{label:"付费类型"}},[a("CommonSelector",{attrs:{filterable:"",options:e.payTypeEnums,clearable:""},model:{value:e.filter.payTypes,callback:function(t){e.$set(e.filter,"payTypes",t)},expression:"filter.payTypes"}})],1),a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{attrs:{clearable:""},model:{value:e.filter.title,callback:function(t){e.$set(e.filter,"title",t)},expression:"filter.title"}})],1),a("el-form-item",{attrs:{label:"素材类型"}},[a("CommonSelector",{attrs:{filterable:"",options:e.contentTypeEnums,clearable:""},model:{value:e.filter.contentTypes,callback:function(t){e.$set(e.filter,"contentTypes",t)},expression:"filter.contentTypes"}})],1),a("el-form-item",{attrs:{label:"年代"}},[a("el-input",{staticStyle:{width:"75px"},attrs:{size:"small",clearable:""},on:{blur:e.yearStartListen},model:{value:e.filter.yearStart,callback:function(t){e.$set(e.filter,"yearStart",t)},expression:"filter.yearStart"}}),e._v("\n          -\n          "),a("el-input",{staticStyle:{width:"75px"},attrs:{size:"small",clearable:""},on:{blur:e.yearEndListen},model:{value:e.filter.yearEnd,callback:function(t){e.$set(e.filter,"yearEnd",t)},expression:"filter.yearEnd"}})],1),a("span",{directives:[{name:"show",rawName:"v-show",value:e.isMore,expression:"isMore"}]},[a("el-form-item",{attrs:{label:"影片格式"}},[a("CommonSelector",{attrs:{filterable:"",clearable:"",options:e.videoFormatEnums},model:{value:e.filter.videoFormat,callback:function(t){e.$set(e.filter,"videoFormat",t)},expression:"filter.videoFormat"}})],1),a("el-form-item",{attrs:{label:"内容标签"}},[a("CommonSelector",{attrs:{filterable:"",clearable:"",options:e.contentTagEnums},model:{value:e.filter.contentTag,callback:function(t){e.$set(e.filter,"contentTag",t)},expression:"filter.contentTag"}})],1),a("el-form-item",{attrs:{label:"排序方式"}},[a("el-select",{staticStyle:{width:"120px"},attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.filter.orderBy,callback:function(t){e.$set(e.filter,"orderBy",t)},expression:"filter.orderBy"}},[a("el-option",{attrs:{label:"请选择",value:""}}),e._l(e.conditionList.orderBy,function(e){return a("el-option",{key:"order"+e.tagId,attrs:{label:e.tagCnName,value:e.tagEnName}})})],2),a("el-tooltip",{attrs:{content:"asc"===e.filter.order?"升序":"降序"}},[a("el-button",{attrs:{icon:"asc"===e.filter.order?"el-icon-arrow-up":"el-icon-arrow-down"},on:{click:function(t){return e.changeSort()}}})],1)],1),a("el-form-item",{attrs:{label:"导演"}},[a("CommonSelector",{attrs:{clearable:"",placeholder:"请选择/输入",filterable:"","allow-create":"",options:e.directorEnums},model:{value:e.filter.directors,callback:function(t){e.$set(e.filter,"directors",t)},expression:"filter.directors"}})],1),a("el-form-item",{attrs:{label:"主演"}},[a("CommonSelector",{attrs:{clearable:"",placeholder:"请选择/输入",filterable:"","allow-create":"",options:e.actiorEnums},model:{value:e.filter.actors,callback:function(t){e.$set(e.filter,"actors",t)},expression:"filter.actors"}})],1),a("el-form-item",{attrs:{label:"地区"}},[a("CommonSelector",{attrs:{clearable:"",placeholder:"请选择/输入",filterable:"","allow-create":"",options:e.areaEnums},model:{value:e.filter.areas,callback:function(t){e.$set(e.filter,"areas",t)},expression:"filter.areas"}})],1),a("el-form-item",{staticStyle:{display:"block"},attrs:{label:"影片标签"}},[a("TagLogicFilter",{ref:"tagLogicFilter",model:{value:e.filter.tagCodes,callback:function(t){e.$set(e.filter,"tagCodes",t)},expression:"filter.tagCodes"}})],1)],1),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{icon:e.isMore?"el-icon-arrow-up":"el-icon-arrow-down",size:"small"},on:{click:function(t){e.isMore=!e.isMore}}},[e._v(e._s(e.isMore?"收起":"展开"))]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{attrs:{size:"small",type:"warning"},on:{click:e.handleFilterReset}},[e._v("重置")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleFilterChangeAndReset}},[e._v("查询并重置")])],1)],1)],1)],1),a("EpisodeSelector",{ref:"episodeSelector",attrs:{id:e.currentVideoId,source:e.filter.sources},on:{"select-end":e.handleSelectEpisodeEnd}},[a("span")])],1)},i=[],r=(a("ac6a"),a("456d"),a("cebc")),o=(a("20d6"),a("7514"),a("42f0")),l=a("ea3f"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("remote-selector-wrapper",{ref:"wrapper",attrs:{title:"选择单集"},on:{"select-start":e.handleSelectStart}},[a("BaseSelector",{ref:"baseSelector",attrs:{slot:"content","id-field":"coocaaVId","selection-type":e.selectionType,table:e.table,pagination:e.pagination,"select-end-on-dbl-click":!0},on:{"pagination-change":e.fetchData,"filter-reset":e.handleFilterReset,"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd},slot:"content"},[a("el-form",{attrs:{slot:"filter",inline:!0,"label-width":"72px"},slot:"filter",model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("el-form-item",{attrs:{label:"素材类型"}},[a("el-select",{attrs:{filterable:"",clearable:""},model:{value:e.filter.urlIsTrailer,callback:function(t){e.$set(e.filter,"urlIsTrailer",t)},expression:"filter.urlIsTrailer"}},e._l(e.episodeTypeEnums,function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"单集名称"}},[a("el-input",{attrs:{clearable:""},model:{value:e.filter.urlTitle,callback:function(t){e.$set(e.filter,"urlTitle",t)},expression:"filter.urlTitle"}})],1),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{attrs:{size:"small",type:"warning"},on:{click:e.handleFilterReset}},[e._v("重置")])],1)],1),e._t("default")],2)},c=[],u=(a("c5f6"),a("5076")),d=[{label:"正片",value:"0"},{label:"预告",value:"1"},{label:"短视频",value:"6"}],p={0:"正片",1:"预告",6:"短视频"},h={components:{BaseSelector:o["a"],RemoteSelectorWrapper:u["a"]},data:function(){var e=this;return{pagination:{currentPage:1,pageSize:15},filter:this.getDefaultFilter(),efficientFilter:this.getDefaultFilter(),episodeTypeEnums:d,table:{props:{},header:[{label:"集数名",prop:"urlCollection",width:"70"},{label:"单集ID",prop:"coocaaMId",width:"150"},{label:"单集名称",prop:"urlTitle"},{label:"图片",prop:"thumb",render:function(e,t){var a=t.row;return e("img",{attrs:{referrerpolicy:"no-referrer",width:"50px",height:"50px",class:"imgs",src:a.thumb}})}},{label:"素材类型",width:"120",prop:"urlIsTrailer",render:function(e,t){var a=t.row;return p[a.urlIsTrailer]}},{label:"时长",width:120,render:function(t,a){var n=a.row;return e.secondToTimeStr(n.duration)}},{label:"跳转播放",width:100,render:function(t,a){var n=a.row,i=e.source;if("tencent"===i||"yinhe"===i){var r="tencent"===i?"https://v.qq.com/x/cover/".concat(n.coocaaMId,"/").concat(n.thirdVuId,".html"):"http://so.iqiyi.com/so/q_".concat(n.urlTitle);return t("a",{class:"link",attrs:{target:"_blank",href:r}},"跳转")}}}],data:[],selected:[],selectionType:"single"},selected:[]}},props:{selectionType:{type:String,default:function(){return"single"}},source:String,id:[String,Number]},methods:{secondToTimeStr:function(e){if(e){var t=Math.floor(e/3600),a=Math.floor((e-3600*t)/60),n=e-3600*t-60*a;return"".concat(t,"小时").concat(a,"分").concat(n,"秒")}},handleSelectStart:function(){var e=this.$refs.baseSelector;e&&e.clearSelected(),this.handleFilterReset()},handleSelectCancel:function(){this.$refs.wrapper.handleSelectCancel()},getDefaultFilter:function(){return{urlIsTrailer:void 0,urlTitle:void 0,source:this.source,id:this.id}},getFilter:function(){var e=this.pagination,t=Object(r["a"])({},this.efficientFilter);return e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.efficientFilter=this.getDefaultFilter(),this.pagination.currentPage=1,this.table.data=[],this.fetchData()},fetchData:function(){var e=this,t=this.getFilter();this.$service.getSegmentList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows||[]})},handleSelectEnd:function(){this.$refs.wrapper.handleSelectEnd(),this.$emit.apply(this,["select-end"].concat(Array.prototype.slice.call(arguments)))}},created:function(){}},m=h,f=a("2877"),v=Object(f["a"])(m,s,c,!1,null,"517bfb6b",null),g=v.exports,b=a("e32f"),y={components:{BaseSelector:o["a"],CommonSelector:l["a"],EpisodeSelector:g,TagLogicFilter:b["a"]},data:function(){var e=this;return{isMore:!1,currentVideoId:void 0,conditionList:{},sourceEnums:[],sourceText:{},pagination:{currentPage:1,pageSize:15},filter:this.getDefaultFilter(),efficientFilter:this.getDefaultFilter(),table:{props:{},header:[{prop:"coocaaVId",label:"ID",width:"130",sortable:!0},{prop:"title",label:"标题",width:"100"},{prop:"subTitle",label:"副标题",width:"100"},{prop:"ccVideoSourceEntities",label:"内容源",width:"60",render:function(t,a){var n=a.row,i=n.ccVideoSourceEntities[0];if(i)return e.sourceText[i.thirdSource]||""}},{prop:"videoStatus",label:"状态",width:"50",formatter:function(e){return["失效","有效","待审核","审核不通过","草稿"][e.videoStatus]}},{prop:"thumb",label:"图片",width:"60",render:function(e,t){var a=t.row;return e("img",{key:a.thumb,attrs:{width:"50px",height:"50px",referrerpolicy:"no-referrer",src:a.thumb}})}},{prop:"videoType",label:"影片类型",width:"80"},{prop:"contentType",label:"内容类型",width:"80"},{prop:"season",label:"期数"},{prop:"directors",label:"导演"},{prop:"actors",label:"演员",showOverflowTooltip:!0},{prop:"publishArea",label:"地区"},{prop:"year",label:"年代"},{prop:"segment",label:"已选集数",type:"specialBut",width:"105",mouseStyle:"hover",fixed:"right",render:function(t,a){var n=a.row,i=n.coocaaVId,r=e.selectedEpisodes;if(r[i])return t("el-button",{attrs:{type:"primary",text:"已选集数",value:"已选集数",title:r[i].urlTitle}},"已选集数")}},{prop:"but",label:"操作",width:"105",fixed:"right",render:function(t,a){var n=a.row;return t("el-button",{on:{click:function(t){t.stopPropagation(),e.handleSelectEpisode(n)}}},"选择单集")}}],data:[],selected:[],selectionType:"single"},selectedEpisodes:{}}},computed:{selected:function(){return this.$refs.baseSelector.selected.slice()},licenseEnums:function(){return(this.conditionList.license||this.conditionList.licensee||[]).map(function(e){var t=e.tagCnName,a=e.tagEnName;return{label:t,value:a}})},categoryEnums:function(){var e=(this.conditionList.sources||[{}])[0].child;return(e||[]).map(function(e){var t=e.categoryName,a=e.categoryId;return{label:t,value:a}})},videoTypeEnums:function(){var e=this.filter.category;return e?(this.conditionList.sources[0].child.find(function(t){var a=t.categoryId;return a===e}).child[0].tagEntities||[]).map(function(e){var t=e.tagName;return{label:t,value:t}}):[]},payTypeEnums:function(){return(this.conditionList.payTypes||[]).map(function(e){var t=e.tagCnName,a=e.tagEnName;return{label:t,value:a}})},contentTypeEnums:function(){return(this.conditionList.contentTypes||[]).map(function(e){var t=e.contentType,a=e.contentTypeId;return{label:t,value:a}})},videoFormatEnums:function(){return(this.conditionList.videoFormat||[]).map(function(e){var t=e.tagCnName,a=e.tagEnName;return{label:t,value:a}})},contentTagEnums:function(){return(this.conditionList.contentTag||[]).map(function(e){var t=e.tagCnName;return{label:t,value:t}})},directorEnums:function(){return(this.conditionList.directors||[]).map(function(e){var t=e.tagCnName;return{label:t,value:t}})},actiorEnums:function(){return(this.conditionList.actors||[]).map(function(e){var t=e.tagCnName;return{label:t,value:t}})},areaEnums:function(){return(this.conditionList.areas||[]).map(function(e){var t=e.tagCnName;return{label:t,value:t}})}},props:["isLive","disablePartner","selection-type","source","idType"],watch:{"filter.partner":"onPartnerChange","filter.sources":"onSourceChange","filter.category":"onCategoryChange"},methods:{selectEnd:function(e){var t=this;e=e.map(function(e){return e.selectedEpisodes=t.selectedEpisodes[e.coocaaVId],e}),this.$emit("select-end",e)},handleCollapseChange:function(){setTimeout(function(){window.dispatchEvent(new Event("resize"))},1e3)},handleSelectEpisode:function(e){var t=this;this.currentVideoId=e.coocaaVId,this.$nextTick(function(){t.$refs.episodeSelector.$refs.wrapper.handleSelectStart()})},handleSelectEpisodeEnd:function(e){var t=this.currentVideoId;this.$set(this.selectedEpisodes,t,e[0]);var a=this.table.data,n=a.findIndex(function(e){return e.coocaaVId===t}),i=a[n],r=this.$refs.baseSelector;"single"===this.selectionType?r.tableSelected!==n&&r.handleTableRowSelectionChange(i,n):"multiple"===this.selectionType&&-1===r.tableSelected.indexOf(n)&&r.handleTableRowSelectionAdd(i,n)},onPartnerChange:function(){var e=this,t=this.filter.partner;return this.sourceEnums=[],t?this.$service.getPartnerSource({partnerName:t}).then(function(a){var n=a.rows.reduce(function(e,t){return t.source_List&&(e=e.concat(t.source_List.map(function(e){var t=e.source_code,a=e.source_title;return{label:a,value:t}}))),e},[]),i=n.find(function(e){return e.value===t})||n[0];i&&(e.filter.sources=i.value),e.sourceEnums=n,e.sourceText=n.reduce(function(e,t){return e[t.value]=t.label,e},Object(r["a"])({},e.sourceText))}):Promise.resolve()},onSourceChange:function(e){"tencent"!==e&&(this.filter.license=void 0)},onCategoryChange:function(){this.filter.videoTypes=void 0},getSourceLabel:function(e){for(var t=!1,a=0;a<e.ccVideoSourceEntities.length;a++)if("4KGarden"===e.ccVideoSourceEntities[a].thirdSource){t=!0;break}return!0===t?"4k花园":e.ccVideoSourceEntities[0]&&"tencent"===e.ccVideoSourceEntities[0].thirdSource?"腾讯":e.ccVideoSourceEntities[0]&&"yinhe"===e.ccVideoSourceEntities[0].thirdSource?"爱奇艺":void 0},statusLabel:function(e){return["失效","有效","待审核","审核不通过","草稿"][e.videoStatus]},getDefaultFilter:function(){return{resType:"vod",callbackparam:"result",partner:this.$consts.sourceToPartner[this.source||this.$consts.sourceOptions[0].value],sources:"",category:"",videoTypes:"",license:"",payTypes:"",provider:"",title:"",contentTypes:"",yearStart:void 0,yearEnd:void 0,videoFormat:"",contentTag:"",orderBy:"",order:"desc",directors:"",actors:"",areas:"",tagCodes:[[]],idType:this.idType}},getFilter:function(){var e=this.pagination,t=this.efficientFilter,a=Object.keys(t).reduce(function(e,a){return""!==t[a]&&(e[a]=t[a]),e},{});return a.partner=void 0,e&&(a.page=e.currentPage,a.rows=e.pageSize),a},handleFilterChangeAndReset:function(){var e=this;this.handleFilterChange(),this.filter=this.getDefaultFilter(),this.$refs.tagLogicFilter.reset(),this.onPartnerChange().then(function(){e.efficientFilter=JSON.parse(JSON.stringify(e.filter))})},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleFilterReset:function(){var e=this;this.filter=this.getDefaultFilter(),this.pagination.currentPage=1,this.$refs.tagLogicFilter.reset(),this.onPartnerChange().then(function(){e.efficientFilter=JSON.parse(JSON.stringify(e.filter))})},fetchData:function(){var e=this,t=this.getFilter();this.$service.getMediaVideoInfos(t).then(function(t){e.pagination.total=t.total||0,e.table.data=t.rows||[],e.setPartner(e.table.data,e.filter.partner)})},setPartner:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;e.forEach(function(e){e._partner=t})},handleTeachTypesChange:function(e){this.filter.gradeList=void 0,this.filter.videoTypes=void 0,this.filter.teachTypes=e},yearStartListen:function(){this.filter.yearStart&&!+this.filter.yearStart&&(this.$message("年代必须为数字"),this.filter.yearStart=null)},yearEndListen:function(){this.filter.yearEnd&&!+this.filter.yearEnd&&(this.$message("年代必须为数字"),this.filter.yearEnd=null)},changeSort:function(){"asc"===this.filter.order?this.filter.order="desc":this.filter.order="asc"}},created:function(){var e=this;this.$service.mediaGetCondition().then(function(t){e.conditionList=t.vod}),this.onPartnerChange()}},w=y,I=(a("b82d"),Object(f["a"])(w,n,i,!1,null,"72cd7b1d",null));t["a"]=I.exports},"27be":function(e,t,a){"use strict";var n=a("57e4"),i=a.n(n);i.a},"28b5":function(e,t,a){"use strict";var n=a("bec4"),i=a.n(n);i.a},"28bf":function(e,t,a){},"28cf":function(e,t,a){},2956:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PageWrapper",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"pageWrapper",staticClass:"tab-info-wrapper",attrs:{"element-loading-text":e.loadingText,"data-test-id":"tab-info"}},[a("PageContentWrapper",{directives:[{name:"show",rawName:"v-show",value:"tab_info"===e.activePage,expression:"activePage === 'tab_info'"}]},[a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("CommonContent",{ref:"commonContent",attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{replicate:function(t){e.mode="replicate"},copy:e.handleCopy,edit:function(t){e.mode="edit"},unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,audit:function(t){return e.$emit("upsert-end")},"submit-audit":e.handleSubmitAudit,"save-draft":e.handleSaveDraft,"select-version":e.fetchData,"cancel-timing":function(t){return e.fetchData(e.tabInfo.currentVersion)},delete:function(t){return e.$emit("upsert-end",t)}}},["read"!==e.mode?[a("el-form",{ref:"tabForm",attrs:{rules:e.rules,model:e.tabInfo,"label-width":"170px"}},[a("div",{staticClass:"form-legend-header",on:{click:function(t){e.isCollapseBase=!e.isCollapseBase}}},[e.isCollapseBase?a("i",{staticClass:"el-icon-arrow-down"}):a("i",{staticClass:"el-icon-arrow-up"}),a("span",[e._v("基本信息")])]),a("div",{style:{display:e.isCollapseBase?"none":"block"}},[a("el-form-item",{attrs:{label:"版面名称",prop:"tabName"}},[a("el-input",{attrs:{clearable:""},model:{value:e.tabInfo.tabName,callback:function(t){e.$set(e.tabInfo,"tabName","string"===typeof t?t.trim():t)},expression:"tabInfo.tabName"}})],1),a("el-form-item",{attrs:{label:"TAB标题(中文)",prop:"tabCnTitle"}},[a("el-input",{attrs:{clearable:""},model:{value:e.tabInfo.tabCnTitle,callback:function(t){e.$set(e.tabInfo,"tabCnTitle","string"===typeof t?t.trim():t)},expression:"tabInfo.tabCnTitle"}})],1),a("el-form-item",{attrs:{label:"TAB标题(英文)",prop:"tabEnTitle"}},[a("el-input",{attrs:{clearable:""},model:{value:e.tabInfo.tabEnTitle,callback:function(t){e.$set(e.tabInfo,"tabEnTitle","string"===typeof t?t.trim():t)},expression:"tabInfo.tabEnTitle"}})],1),a("el-form-item",{staticClass:"selectItem",attrs:{label:"业务分类",prop:"tabCategory"}},[a("cc-business-type-selector",{attrs:{filterable:"","is-read":e.isReplicate,value:e.tabInfo.tabCategory},on:{input:e.handleChangeTabCategory}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.showSystemDefault,expression:"showSystemDefault"}],attrs:{label:"系统默认",prop:"systemDefault"}},[a("el-switch",{attrs:{"on-text":"是","off-text":"否",value:!!e.tabInfo.systemDefault},on:{input:function(t){e.tabInfo.systemDefault=t?1:0}}})],1),a("el-form-item",{staticClass:"selectItem",attrs:{label:"AppId",prop:"tabAppid"}},[a("cc-appid-selector",{attrs:{filterable:"","is-read":e.isReplicate,disabled:e.disableAppId},model:{value:e.tabInfo.tabAppid,callback:function(t){e.$set(e.tabInfo,"tabAppid",t)},expression:"tabInfo.tabAppid"}})],1),e.hasSource?a("el-form-item",{attrs:{label:"内容源",prop:"tabResource"}},[a("SourceRadioSelector",{attrs:{value:e.tabInfo.tabResource,disabled:e.isReplicate},on:{input:e.handleChangeSource}})],1):e._e(),a("el-form-item",{attrs:{label:"TAB对应的icon",prop:"pictureName"}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleSelectIconStart}},[e._v("选择")]),e.tabInfo.iconTypeName?a("span",{staticClass:"marginL"},[e._v("已选择： "+e._s(e.tabInfo.iconTypeName))]):e._e()],1),a("el-form-item",{attrs:{label:"标题图片"}},[a("GlobalPictureSelector",{attrs:{title:"选择素材","picture-resolution":"178*80"},on:{"select-end":function(t){return e.handleSelectTitleIcon("imgOnSelected",t)}}},[a("el-form-item",{staticClass:"tab-title-icon-wrapper",attrs:{prop:"imgOnSelected"}},[e.tabInfo.imgOnSelected?[a("img",{attrs:{src:e.tabInfo.imgOnSelected}}),a("i",{staticClass:"el-icon el-icon-close tab-title-icon__remove",on:{click:function(t){t.stopPropagation(),e.tabInfo.imgOnSelected=""}}})]:e._e(),a("div",{staticClass:"tab-title-icon__title"},[e._v("选中")])],2)],1),a("GlobalPictureSelector",{attrs:{title:"选择素材","picture-resolution":"178*80"},on:{"select-end":function(t){return e.handleSelectTitleIcon("imgOnFocus",t)}}},[a("el-form-item",{staticClass:"tab-title-icon-wrapper",attrs:{prop:"imgOnFocus"}},[e.tabInfo.imgOnFocus?[a("img",{attrs:{src:e.tabInfo.imgOnFocus}}),a("i",{staticClass:"el-icon el-icon-close tab-title-icon__remove",on:{click:function(t){t.stopPropagation(),e.tabInfo.imgOnFocus=""}}})]:e._e(),a("div",{staticClass:"tab-title-icon__title"},[e._v("落焦")])],2)],1),a("GlobalPictureSelector",{attrs:{title:"选择素材","picture-resolution":"178*80"},on:{"select-end":function(t){return e.handleSelectTitleIcon("imgOnBlur",t)}}},[a("el-form-item",{staticClass:"tab-title-icon-wrapper",attrs:{prop:"imgOnBlur"}},[e.tabInfo.imgOnBlur?[a("img",{attrs:{src:e.tabInfo.imgOnBlur}}),a("i",{staticClass:"el-icon el-icon-close tab-title-icon__remove",on:{click:function(t){t.stopPropagation(),e.tabInfo.imgOnBlur=""}}})]:e._e(),a("div",{staticClass:"tab-title-icon__title"},[e._v("非落焦")])],2)],1)],1),a("el-form-item",{attrs:{label:"固定刷新时间",prop:"timeCycle"}},[a("InputMinute",{attrs:{min:5,max:360},model:{value:e.tabInfo.timeCycle,callback:function(t){e.$set(e.tabInfo,"timeCycle",t)},expression:"tabInfo.timeCycle"}}),a("span",{staticClass:"hint remarks"},[e._v("设置范围:5分钟-6小时")])],1),e.canForceRefresh?a("el-form-item",{staticClass:"force-refresh-time-list",attrs:{label:"强制刷新时间点"}},[a("el-form-item",{attrs:{label:"时间点1","label-width":"80px"}},[a("el-date-picker",{attrs:{clearable:"",type:"datetime",placeholder:"选择日期时间"},model:{value:e.tabInfo.refreshTimeList[0],callback:function(t){e.$set(e.tabInfo.refreshTimeList,0,t)},expression:"tabInfo.refreshTimeList[0]"}})],1),a("el-form-item",{attrs:{label:"时间点2","label-width":"80px"}},[a("el-date-picker",{attrs:{clearable:"",type:"datetime",placeholder:"选择日期时间"},model:{value:e.tabInfo.refreshTimeList[1],callback:function(t){e.$set(e.tabInfo.refreshTimeList,1,t)},expression:"tabInfo.refreshTimeList[1]"}})],1),a("el-form-item",{attrs:{label:"时间点3","label-width":"80px"}},[a("el-date-picker",{attrs:{clearable:"",type:"datetime",placeholder:"选择日期时间"},model:{value:e.tabInfo.refreshTimeList[2],callback:function(t){e.$set(e.tabInfo.refreshTimeList,2,t)},expression:"tabInfo.refreshTimeList[2]"}})],1),a("div",{staticClass:"hint remarks"},[e._v("强制刷新时会导致画面闪动，如无必要，请勿使用")])],1):e._e(),1!==e.tabInfo.hasSubTab&&1===e.tabInfo.tabType?a("el-form-item",{staticClass:"force-refresh-time-list"},[a("el-form-item",{attrs:{label:"线落焦色","label-width":"180px"}},[a("el-color-picker",{model:{value:e.tabInfo.blockLineFocusColor,callback:function(t){e.$set(e.tabInfo,"blockLineFocusColor",t)},expression:"tabInfo.blockLineFocusColor"}})],1),a("el-form-item",{attrs:{label:"面落焦色","label-width":"180px"}},[a("el-color-picker",{model:{value:e.tabInfo.blockFieldFocusColor,callback:function(t){e.$set(e.tabInfo,"blockFieldFocusColor",t)},expression:"tabInfo.blockFieldFocusColor"}})],1),a("el-form-item",{attrs:{label:"推荐位标题色","label-width":"180px"}},[a("el-color-picker",{model:{value:e.tabInfo.blockTitleUnfocusColor,callback:function(t){e.$set(e.tabInfo,"blockTitleUnfocusColor",t)},expression:"tabInfo.blockTitleUnfocusColor"}})],1)],1):e._e(),1!==e.tabInfo.hasSubTab&&1===e.tabInfo.tabType?a("el-form-item",{staticClass:"force-refresh-time-list"},[a("el-form-item",{attrs:{label:"推荐位标题色(落焦)","label-width":"180px"}},[a("el-color-picker",{model:{value:e.tabInfo.blockTitleFocusColor,callback:function(t){e.$set(e.tabInfo,"blockTitleFocusColor",t)},expression:"tabInfo.blockTitleFocusColor"}})],1),a("el-form-item",{attrs:{label:"版块标题色","label-width":"180px"}},[a("el-color-picker",{model:{value:e.tabInfo.panelTitleColor,callback:function(t){e.$set(e.tabInfo,"panelTitleColor",t)},expression:"tabInfo.panelTitleColor"}})],1)],1):e._e(),2===e.tabInfo.tabType?a("el-form-item",{staticClass:"force-refresh-time-list"},[a("el-form-item",{attrs:{label:"线落焦色","label-width":"180px"}},[a("el-color-picker",{model:{value:e.tabInfo.blockLineFocusColor,callback:function(t){e.$set(e.tabInfo,"blockLineFocusColor",t)},expression:"tabInfo.blockLineFocusColor"}})],1),a("el-form-item",{attrs:{label:"面落焦色","label-width":"180px"}},[a("el-color-picker",{model:{value:e.tabInfo.blockFieldFocusColor,callback:function(t){e.$set(e.tabInfo,"blockFieldFocusColor",t)},expression:"tabInfo.blockFieldFocusColor"}})],1),a("el-form-item",{attrs:{label:"推荐位标题色","label-width":"180px"}},[a("el-color-picker",{model:{value:e.tabInfo.blockTitleUnfocusColor,callback:function(t){e.$set(e.tabInfo,"blockTitleUnfocusColor",t)},expression:"tabInfo.blockTitleUnfocusColor"}})],1)],1):e._e(),2===e.tabInfo.tabType?a("el-form-item",{staticClass:"force-refresh-time-list"},[a("el-form-item",{attrs:{label:"推荐位标题色(落焦)","label-width":"180px"}},[a("el-color-picker",{model:{value:e.tabInfo.blockTitleFocusColor,callback:function(t){e.$set(e.tabInfo,"blockTitleFocusColor",t)},expression:"tabInfo.blockTitleFocusColor"}})],1),a("el-form-item",{attrs:{label:"版块标题色","label-width":"180px"}},[a("el-color-picker",{model:{value:e.tabInfo.panelTitleColor,callback:function(t){e.$set(e.tabInfo,"panelTitleColor",t)},expression:"tabInfo.panelTitleColor"}})],1)],1):e._e(),2!==e.tabInfo.tabType&&1!==e.tabInfo.hasSubTab&&13!==e.tabInfo.tabType?a("TabPluginParams",{attrs:{propPrefix:"tabPluginInfo."},model:{value:e.tabInfo.tabPluginInfo,callback:function(t){e.$set(e.tabInfo,"tabPluginInfo",t)},expression:"tabInfo.tabPluginInfo"}}):e._e()],1),"edit"===e.mode||"replicate"===e.mode?a("div",[a("div",{staticClass:"form-legend-header",on:{click:e.handleTabDataClick}},[e.isCollapseData?a("i",{staticClass:"el-icon-arrow-down"}):a("i",{staticClass:"el-icon-arrow-up"}),a("span",[e._v("版面数据        ")]),e._v("\n              昨日UVCTR："),a("span",[e._v(e._s(e.tabUVCTR.value?e.toPercent(e.tabUVCTR.value):"N/A"))]),e._v("，\n              日环比"),a("span",{class:e.tabUVCTR.dailyGrowth>0?"data-up":"data-down"},[e._v(e._s(e.tabUVCTRPercent.dailyGrowth))]),e._v("；\n              周同比"),a("span",{class:e.tabUVCTR.weeklyGrowth>0?"data-up":"data-down"},[e._v(e._s(e.tabUVCTRPercent.weeklyGrowth))])]),e.isCollapseData?e._e():a("div",[a("div",{staticClass:"chart-box"},[a("div",{staticClass:"chart-box--title"},[e._v(e._s(e.clickUvChartData.title))]),a("VeLine",{attrs:{data:e.clickUvChartData,"legend-visible":!1,extend:e.clickUvChartExtend,settings:e.clickUvChartSettings}})],1),a("div",{staticClass:"chart-box"},[a("div",{staticClass:"chart-box--title"},[e._v(e._s(e.uvctrChartData.title))]),a("VeLine",{attrs:{data:e.uvctrChartData,"legend-visible":!1,extend:e.uvctrChartExtend,settings:e.uvctrChartSettings}})],1),a("div",{staticClass:"chart-box"},[a("div",{staticClass:"chart-box--title"},[e._v(e._s(e.uvctrHourChartData.title))]),a("VeLine",{attrs:{data:e.uvctrHourChartData,"legend-visible":!1,extend:e.uvctrHourChartExtend,settings:e.uvctrHourChartSettings}})],1)])]):e._e(),a("div",{staticClass:"form-legend-header",on:{click:function(t){e.isCollapseExtend=!e.isCollapseExtend}}},[e.isCollapseExtend?a("i",{staticClass:"el-icon-arrow-down"}):a("i",{staticClass:"el-icon-arrow-up"}),a("span",[e._v("版块配置")])]),a("div",{style:{display:e.isCollapseExtend?"none":"block"}},[a("el-form-item",{attrs:{label:"版面属性",prop:"tabType"}},[a("el-radio-group",{attrs:{value:e.tabInfo.tabType,disabled:e.isReplicate},on:{input:e.handleInputTabType,change:e.handleInputChange}},e._l(e.TAB_TYPES,function(t,n){return a("el-radio",{key:n,attrs:{label:t.value}},[e._v(e._s(t.label))])}),1)],1),1===e.tabInfo.tabType?[a("el-form-item",{attrs:{label:"是否二级版面",prop:"hasSubTab"}},[a("el-switch",{attrs:{disabled:e.isReplicate,value:!!e.tabInfo.hasSubTab,"on-text":"是","off-text":"否"},on:{input:e.handleInputHasSubTab}})],1),1===e.tabInfo.hasSubTab?a("el-form-item",{attrs:{label:"是否支持记忆",prop:"flagIsRecord"}},[a("el-switch",{attrs:{value:!!e.tabInfo.flagIsRecord,"on-text":"是","off-text":"否"},on:{input:function(t){e.tabInfo.flagIsRecord=t?1:0}}})],1):e._e(),a("el-form-item",{attrs:{label:"活动浮窗",prop:"floatWindow"}},[a("cc-float-window-selector",{attrs:{params:e.floatWindowParams},on:{"select-end":e.handleSelectFloatWindowEnd}}),e.tabInfo.activityFloatWindow?[e._v("\n                    已选择: "+e._s(e.tabInfo.activityFloatWindow.pluginName)+"\n                    "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.handleRemoveFloatWindow}},[e._v("删除")])]:e._e()],2),1===e.tabInfo.hasSubTab?a("el-form-item",{attrs:{label:"选择版面"}},[a("cc-tab-selector-el",{ref:"tabSelector",attrs:{source:e.tabInfo.tabResource,"has-sub-tab":0},on:{"select-start":e.handleSelectTabStart,"select-end":e.handleSelectTabEnd}}),a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleCreateTab}},[e._v("新建版面")]),a("div",[a("OrderableTable",{ref:"subTabTable",attrs:{header:e.subTabTableHeader},model:{value:e.tabInfo.tabList,callback:function(t){e.$set(e.tabInfo,"tabList",t)},expression:"tabInfo.tabList"}})],1)],1):e._e()]:e._e(),13===e.tabInfo.tabType?[a("el-form-item",{attrs:{label:"选择版面"}},[a("cc-tab-selector-el",{ref:"tabSelector",attrs:{source:e.tabInfo.tabResource,"has-sub-tab":0,oneOption:e.oneOption},on:{"select-start":e.handleSelectTabStart,"select-end":e.handleSelectTabEnd}}),a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleCreateTab}},[e._v("新建版面")]),a("div",[a("OrderableTable",{ref:"subTabTable",attrs:{header:e.subTabTableHeader},model:{value:e.tabInfo.tabList,callback:function(t){e.$set(e.tabInfo,"tabList",t)},expression:"tabInfo.tabList"}})],1)],1)]:e._e(),2===e.tabInfo.tabType?[a("el-form-item",{attrs:{label:"活动浮窗",prop:"floatWindow"}},[a("cc-float-window-selector",{attrs:{params:e.floatWindowParams},on:{"select-end":e.handleSelectFloatWindowEnd}}),e.tabInfo.activityFloatWindow?[e._v("\n                    已选择: "+e._s(e.tabInfo.activityFloatWindow.pluginName)+"\n                    "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.handleRemoveFloatWindow}},[e._v("删除")])]:e._e()],2)]:e._e(),1===e.tabInfo.tabType&&0===e.tabInfo.hasSubTab||2===e.tabInfo.tabType?a("el-form-item",{attrs:{label:"选择版块"}},[a("div",{staticClass:"tab-info__virtual-tab-menu",style:{visibility:e.isPanelDragging?"hidden":"visible"}},[e.showAffix?a("Affix",{staticStyle:{width:"725px",display:"inline-block",background:"#fff","z-index":"1"},attrs:{"relative-element-selector":".tab-info__virtual-tab","scroll-container-selector":".page-content-wrapper",offset:{top:128,bottom:50}}},[a("cc-panel-selector-el",{ref:"panelSelector",attrs:{source:e.tabInfo.tabResource,tabType:e.tabInfo.tabType},on:{"select-end":e.handleSelectPanelEnd}}),a("el-dropdown",[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("\n                        新建\n                        "),a("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(t){e.activePage="panel"}}},[e._v("常规版块")]),a("el-dropdown-item",{nativeOn:{click:function(t){e.activePage="album_panel"}}},[e._v("业务专辑")]),a("el-dropdown-item",{nativeOn:{click:function(t){e.activePage="private_panel"}}},[e._v("专属影院")])],1)],1),a("el-button",{staticClass:"marginL",attrs:{type:"primary",plain:""},on:{click:function(t){return e.handleToggleAllPanel(!1)}}},[e._v("展开所有")]),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.handleToggleAllPanel(!0)}}},[e._v("收起所有")]),a("el-button",{attrs:{type:"primary",disabled:0===e.panelsModified.length},on:{click:e.handleSubmitBlockExchange}},[e._v("提交推荐位移动")]),a("el-button",{attrs:{type:"primary",disabled:0===e.blockExchangeHistory.length},on:{click:e.handleRevertBlockExchange}},[e._v("\n                      撤销上次推荐位移动 "+e._s(e.blockExchangeHistory.length>0?"("+e.blockExchangeHistory.length+")":"")+"\n                    ")])],1):e._e()],1),a("div",{staticClass:"block-exchange-wrapper"},[e.showAffix?a("Affix",{attrs:{"relative-element-selector":".tab-info__virtual-tab","scroll-container-selector":".page-content-wrapper",offset:{top:110,bottom:20}}},[a("BlockExchangeCenter",{directives:[{name:"show",rawName:"v-show",value:e.blocksToExchange.length>0,expression:"blocksToExchange.length > 0"}],attrs:{active:e.activeBlockIndex,"panel-data":e.panelListIndexed,blocks:e.blocksToExchange},on:{activate:function(t){e.activeBlockIndex=t},remove:e.handleRemoveBlock}})],1):e._e()],1),a("cc-virtual-tab",{ref:"virtualTab",staticClass:"tab-info__virtual-tab",attrs:{"show-chart-btn":!0,"show-exchange-tool":e.showExchangeTool,panels:e.tabInfo.pannelList,"panel-data":e.panelListIndexed,width:725,ratio:.315,"show-title":!0},on:{"insert-panel":e.handleInsertPanel,"reorder-panel":e.handleReOrderPanel,"remove-panel":e.handleRemovePanel,"change-crowd":e.handleChangeCrowdOfPanel,"toggle-type":e.handleTogglePanelType,collapse:e.handleChangeCollapseState,uncollapse:e.handleChangeCollapseState,"open-panel":e.handlePreviewPanel,"change-panel-order":e.handleChangePanelOrder,"click-block":e.handleClickBlock,"drag-start":e.handleDragStart,"drag-end":e.handleDragEnd,"show-all-panel":e.handleShowAllPanels,"lazy-init":e.handleLazyInit,"copy-block":e.handleCopyBlock,"exchange-block":e.handleExchangeBlock}})],1):e._e()],2),2===e.tabInfo.tabType||13===e.tabInfo.tabType?[a("div",{staticClass:"form-legend-header",on:{click:function(t){e.isCollapseSpec=!e.isCollapseSpec}}},[e.isCollapseSpec?a("i",{staticClass:"el-icon-arrow-down"}):a("i",{staticClass:"el-icon-arrow-up"}),a("span",[e._v("专题配置")])]),a("div",{style:{display:e.isCollapseSpec||e.isPanelDragging?"none":"block"}},[a("el-form-item",{attrs:{label:"会员展示"}},[a("el-select",{attrs:{filterable:"",placeholder:"前端不显示",clearable:!0},model:{value:e.tabInfo.vipButtonSourceId,callback:function(t){e.$set(e.tabInfo,"vipButtonSourceId",t)},expression:"tabInfo.vipButtonSourceId"}},e._l(e.vipEnums,function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})}),1)],1),13!==e.tabInfo.tabType?a("el-form-item",{attrs:{label:"专题版面大背景",prop:"alumbTabBg"}},[a("GlobalPictureSelector",{attrs:{title:"选择素材","picture-resolution":"1920*1080"},on:{"select-end":e.handleSelectBgEnd}}),a("div",[e.tabInfo.alumbTabBg?a("div",{staticClass:"image-preview-wrapper"},[a("img",{staticClass:"image-preview",attrs:{src:e.tabInfo.alumbTabBg}})]):e._e()])],1):e._e(),13!==e.tabInfo.tabType?a("el-form-item",{attrs:{label:"专题版面长图背景图",prop:"alumbTabLongBg"}},[a("GlobalPictureSelector",{attrs:{title:"选择长图素材","query-long-poster":1},on:{"select-end":e.handleSelectLongBgEnd}}),a("span",{staticClass:"remarks marginL"},[e._v("备注：长图下最多支持6个版块")]),a("div",[e.tabInfo.alumbTabLongBg?a("div",{staticClass:"image-preview-wrapper image-preview-wrapper--long"},[a("img",{staticClass:"image-preview",attrs:{src:e.tabInfo.alumbTabLongBg}}),a("i",{staticClass:"el-icon el-icon-close",attrs:{title:"移除"},on:{click:function(t){e.tabInfo.alumbTabLongBg=void 0}}})]):e._e()])],1):e._e(),a("el-form-item",{attrs:{label:"收藏展示图"}},[a("GlobalPictureSelector",{attrs:{title:"选择素材","picture-resolution":"260*364"},on:{"select-end":e.handleSelectCollectImgEnd}}),a("div",[e.tabInfo.collectImg?a("div",{staticClass:"image-preview-wrapper"},[a("img",{staticClass:"image-preview",attrs:{src:e.tabInfo.collectImg}})]):e._e()])],1),a("el-form-item",{attrs:{label:"启用高清背景切换模式",prop:"flagIsBlockBg"}},[a("el-switch",{attrs:{value:!!e.tabInfo.flagIsBlockBg,"on-text":"是","off-text":"否"},on:{input:function(t){e.tabInfo.flagIsBlockBg=t?1:0}}})],1),a("el-form-item",{attrs:{label:"版面简介显示高"}},[a("el-input-number",{attrs:{min:0,max:880,step:1},model:{value:e.tabInfo.sinkSize,callback:function(t){e.$set(e.tabInfo,"sinkSize",e._n(t))},expression:"tabInfo.sinkSize"}}),a("span",{staticClass:"remarks marginL"},[e._v(" 注:数值范围0-880")])],1)],1)]:e._e(),e.tabInfo.hasSubTab?e._e():a("div",{staticClass:"form-legend-header",on:{click:function(t){e.isCollapseCustom=!e.isCollapseCustom}}},[e.isCollapseCustom?a("i",{staticClass:"el-icon-arrow-down"}):a("i",{staticClass:"el-icon-arrow-up"}),a("span",[e._v("版块个性化排序配置")])]),e.tabInfo.hasSubTab?e._e():a("div",{style:{display:e.isCollapseCustom?"none":"block"}},[a("el-form-item",{attrs:{label:"启动版块个性化推荐"}},[a("el-switch",{attrs:{value:!!e.tabInfo.panelRecommendConfig.enableRecommend},on:{input:e.handleInputRecommendFlag}})],1),e.tabInfo.panelRecommendConfig.enableRecommend?a("div",[a("el-form-item",{attrs:{label:"选择版块流",prop:"panelRecommendConfig.recommendSign",rules:[{required:!0,message:"请选择版块流"}]}},[a("RecommendStreamSignSelector",{attrs:{filterable:"",confirm:"改变版块流将清空优先推荐版块，确认修改？",value:e.tabInfo.panelRecommendConfig.recommendSign},on:{input:e.handleInputRecommendSign}}),e._v("\n                  该流可推荐版块: "+e._s(e.recommendStreamSignPanelCount)+" 个\n                ")],1),a("el-form-item",{attrs:{label:"从第几个位置开始推荐",prop:"panelRecommendConfig.recommendIndex",rules:[{required:!0,message:"请设置开始推荐位置",trigger:"blur"}]}},[a("InputPositiveInt",{staticStyle:{width:"200px"},attrs:{clearable:""},model:{value:e.tabInfo.panelRecommendConfig.recommendIndex,callback:function(t){e.$set(e.tabInfo.panelRecommendConfig,"recommendIndex",t)},expression:"tabInfo.panelRecommendConfig.recommendIndex"}}),e._v("\n                  例: 选择 1， 则整个版面都是个性化推荐, 当前版块总数 "+e._s(e.tabInfo.pannelList.length)+"\n                ")],1),a("el-form-item",{attrs:{label:"优先推荐版块"}},[a("RecommendPanelSelector",{attrs:{disabled:!e.tabInfo.panelRecommendConfig.recommendSign,title:e.tabInfo.panelRecommendConfig.recommendSign?"选择版块":"请先选择版块流",category:e.tabInfo.panelRecommendConfig.recommendSign,source:e.tabInfo.tabResource},on:{"select-end":e.handleSelectRecommendPanelEnd}}),a("OrderableTable",{attrs:{header:e.panelRecommendHeader},model:{value:e.tabInfo.panelRecommendConfig.panelInfoList,callback:function(t){e.$set(e.tabInfo.panelRecommendConfig,"panelInfoList",t)},expression:"tabInfo.panelRecommendConfig.panelInfoList"}})],1)],1):e._e()],1)],2),e.showIconSelector?a("cc-icon-selector",{on:{"select-cancel":e.handleSelectIconCancel,"select-end":e.handleSelectIconEnd}}):e._e(),e.showCrowdSelector?a("cc-crowd-selector",{on:{"select-cancel":e.handleSelectCrowdCancel,"select-end":e.handleSelectCrowdEnd}}):e._e()]:e._e(),"read"===e.mode?[a("el-form",{ref:"tabForm",attrs:{rules:e.rules,model:e.tabInfo,"label-width":"170px"}},[a("div",{staticClass:"form-legend-header",on:{click:function(t){e.isCollapseBase=!e.isCollapseBase}}},[e.isCollapseBase?a("i",{staticClass:"el-icon-arrow-down"}):a("i",{staticClass:"el-icon-arrow-up"}),a("span",[e._v("基本信息")])]),a("div",{style:{display:e.isCollapseBase?"none":"block"}},[a("el-form-item",{attrs:{label:"版面名称",prop:"tabName"}},[e._v(e._s(e.tabInfo.tabName))]),a("el-form-item",{attrs:{label:"TAB标题(中文)",prop:"tabCnTitle"}},[e._v(e._s(e.tabInfo.tabCnTitle))]),a("el-form-item",{attrs:{label:"TAB标题(英文)",prop:"tabEnTitle"}},[e._v(e._s(e.tabInfo.tabEnTitle))]),a("el-form-item",{attrs:{label:"业务分类",prop:"tabCategory"}},[a("cc-business-type-selector",{attrs:{"is-read":!0},model:{value:e.tabInfo.tabCategory,callback:function(t){e.$set(e.tabInfo,"tabCategory",t)},expression:"tabInfo.tabCategory"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.showSystemDefault,expression:"showSystemDefault"}],attrs:{label:"系统默认",prop:"systemDefault"}},[e._v(e._s(e.tabInfo.systemDefault?"是":"否"))]),a("el-form-item",{attrs:{label:"AppId",prop:"tabAppid"}},[a("cc-appid-selector",{attrs:{"is-read":!0},model:{value:e.tabInfo.tabAppid,callback:function(t){e.$set(e.tabInfo,"tabAppid",t)},expression:"tabInfo.tabAppid"}})],1),e.hasSource?a("el-form-item",{attrs:{label:"内容源",prop:"tabResource"}},[e._v(e._s(e.$consts.sourceText[e.tabInfo.tabResource]))]):e._e(),a("el-form-item",{attrs:{label:"TAB对应的icon",prop:"pictureName"}},[e.tabInfo.iconTypeName?a("span",[e._v(e._s(e.tabInfo.iconTypeName))]):e._e(),e.tabInfo.pictureUrl?a("div",{staticClass:"tab-icon-wrapper",on:{click:e.handleSelectIconStart}},[a("img",{attrs:{src:e.tabInfo.pictureUrl}})]):e._e()]),a("el-form-item",{attrs:{label:"标题图片"}},[a("el-form-item",{staticClass:"tab-title-icon-wrapper",attrs:{prop:"imgOnSelected"}},[e.tabInfo.imgOnSelected?a("img",{attrs:{src:e.tabInfo.imgOnSelected}}):e._e(),a("div",{staticClass:"tab-title-icon__title"},[e._v("选中")])]),a("el-form-item",{staticClass:"tab-title-icon-wrapper",attrs:{prop:"imgOnFocus"}},[e.tabInfo.imgOnFocus?a("img",{attrs:{src:e.tabInfo.imgOnFocus}}):e._e(),a("div",{staticClass:"tab-title-icon__title"},[e._v("落焦")])]),a("el-form-item",{staticClass:"tab-title-icon-wrapper",attrs:{prop:"imgOnBlur"}},[e.tabInfo.imgOnBlur?a("img",{attrs:{src:e.tabInfo.imgOnBlur}}):e._e(),a("div",{staticClass:"tab-title-icon__title"},[e._v("非落焦")])])],1),a("el-form-item",{attrs:{label:"固定刷新时间",prop:"timeCycle"}},[e._v(e._s(e.parseMinToStr(e.tabInfo.timeCycle)))]),e.canForceRefresh?a("el-form-item",{staticClass:"force-refresh-time-list",attrs:{label:"强制刷新时间点"}},[a("el-form-item",{attrs:{label:"时间点1","label-width":"80px"}},[a("el-date-picker",{attrs:{disabled:!0,type:"datetime"},model:{value:e.tabInfo.refreshTimeList[0],callback:function(t){e.$set(e.tabInfo.refreshTimeList,0,t)},expression:"tabInfo.refreshTimeList[0]"}})],1),a("el-form-item",{attrs:{label:"时间点2","label-width":"80px"}},[a("el-date-picker",{attrs:{disabled:!0,type:"datetime"},model:{value:e.tabInfo.refreshTimeList[1],callback:function(t){e.$set(e.tabInfo.refreshTimeList,1,t)},expression:"tabInfo.refreshTimeList[1]"}})],1),a("el-form-item",{attrs:{label:"时间点3","label-width":"80px"}},[a("el-date-picker",{attrs:{disabled:!0,type:"datetime"},model:{value:e.tabInfo.refreshTimeList[2],callback:function(t){e.$set(e.tabInfo.refreshTimeList,2,t)},expression:"tabInfo.refreshTimeList[2]"}})],1)],1):e._e(),a("el-form-item",{staticClass:"force-refresh-time-list"},[a("el-form-item",{attrs:{label:"线落焦色","label-width":"180px"}},[a("el-color-picker",{attrs:{disabled:""},model:{value:e.tabInfo.blockLineFocusColor,callback:function(t){e.$set(e.tabInfo,"blockLineFocusColor",t)},expression:"tabInfo.blockLineFocusColor"}})],1),a("el-form-item",{attrs:{label:"面落焦色","label-width":"180px"}},[a("el-color-picker",{attrs:{disabled:""},model:{value:e.tabInfo.blockFieldFocusColor,callback:function(t){e.$set(e.tabInfo,"blockFieldFocusColor",t)},expression:"tabInfo.blockFieldFocusColor"}})],1),a("el-form-item",{attrs:{label:"推荐位标题色","label-width":"180px"}},[a("el-color-picker",{attrs:{disabled:""},model:{value:e.tabInfo.blockTitleUnfocusColor,callback:function(t){e.$set(e.tabInfo,"blockTitleUnfocusColor",t)},expression:"tabInfo.blockTitleUnfocusColor"}})],1)],1),a("el-form-item",{staticClass:"force-refresh-time-list"},[a("el-form-item",{attrs:{label:"推荐位标题色(落焦)","label-width":"180px"}},[a("el-color-picker",{attrs:{disabled:""},model:{value:e.tabInfo.blockTitleFocusColor,callback:function(t){e.$set(e.tabInfo,"blockTitleFocusColor",t)},expression:"tabInfo.blockTitleFocusColor"}})],1),a("el-form-item",{attrs:{label:"版块标题色","label-width":"180px"}},[a("el-color-picker",{attrs:{disabled:""},model:{value:e.tabInfo.panelTitleColor,callback:function(t){e.$set(e.tabInfo,"panelTitleColor",t)},expression:"tabInfo.panelTitleColor"}})],1)],1),2!==e.tabInfo.tabType?a("TabPluginParamsRead",{attrs:{value:e.tabInfo.tabPluginInfo}}):e._e()],1),a("div",{staticClass:"form-legend-header",on:{click:e.handleTabDataClick}},[e.isCollapseData?a("i",{staticClass:"el-icon-arrow-down"}):a("i",{staticClass:"el-icon-arrow-up"}),a("span",[e._v("版面数据        ")]),e._v("\n              昨日UVCTR："),a("span",[e._v(e._s(e.tabUVCTR.value?e.toPercent(e.tabUVCTR.value):"N/A"))]),e._v("，\n              日环比"),a("span",{class:e.tabUVCTR.dailyGrowth>0?"data-up":"data-down"},[e._v(e._s(e.tabUVCTRPercent.dailyGrowth))]),e._v("；\n              周同比"),a("span",{class:e.tabUVCTR.weeklyGrowth>0?"data-up":"data-down"},[e._v(e._s(e.tabUVCTRPercent.weeklyGrowth))])]),e.isCollapseData?e._e():a("div",[a("div",{staticClass:"chart-box"},[a("div",{staticClass:"chart-box--title"},[e._v(e._s(e.clickUvChartData.title))]),a("VeLine",{attrs:{data:e.clickUvChartData,"legend-visible":!1,extend:e.clickUvChartExtend,settings:e.clickUvChartSettings,"mark-line":e.markLine,"mark-point":e.markPoint}})],1),a("div",{staticClass:"chart-box"},[a("div",{staticClass:"chart-box--title"},[e._v(e._s(e.uvctrChartData.title))]),a("VeLine",{attrs:{data:e.uvctrChartData,"legend-visible":!1,extend:e.uvctrChartExtend,settings:e.uvctrChartSettings,"mark-line":e.markLine,"mark-point":e.markPoint}})],1),a("div",{staticClass:"chart-box"},[a("div",{staticClass:"chart-box--title"},[e._v(e._s(e.uvctrHourChartData.title))]),a("VeLine",{attrs:{data:e.uvctrHourChartData,"legend-visible":!1,extend:e.uvctrHourChartExtend,settings:e.uvctrHourChartSettings,"mark-line":e.markLine,"mark-point":e.markPoint}})],1)]),a("div",{staticClass:"form-legend-header",on:{click:function(t){e.isCollapseExtend=!e.isCollapseExtend}}},[e.isCollapseExtend?a("i",{staticClass:"el-icon-arrow-down"}):a("i",{staticClass:"el-icon-arrow-up"}),a("span",[e._v("配置内容")])]),a("div",{style:{display:e.isCollapseExtend?"none":"block"}},[a("el-form-item",{attrs:{label:"版面属性",prop:"tabType"}},[e._v("\n                "+e._s(e.$consts.optionsToText(e.TAB_TYPES)[e.tabInfo.tabType])+"\n              ")]),1===e.tabInfo.tabType?[1===e.tabInfo.hasSubTab?[a("el-form-item",{attrs:{label:"是否二级版面",prop:"hasSubTab"}},[e._v(e._s(1===e.tabInfo.hasSubTab?"是":"否"))]),1===e.tabInfo.hasSubTab?a("el-form-item",{attrs:{label:"是否支持记忆",prop:"flagIsRecord"}},[e._v(e._s(1===e.tabInfo.flagIsRecord?"是":"否"))]):e._e(),a("el-form-item",{attrs:{label:"活动浮窗",prop:"floatWindow"}},[e.tabInfo.activityFloatWindow?[e._v(e._s(e.tabInfo.activityFloatWindow.pluginName))]:e._e()],2)]:e._e()]:e._e(),1===e.tabInfo.hasSubTab||13===e.tabInfo.tabType?[a("el-form-item",{attrs:{label:"选择版面"}},[a("div",[a("el-table",{staticStyle:{"margin-top":"20px","max-width":"80%"},attrs:{data:e.tabInfo.tabList,border:""}},[a("el-table-column",{attrs:{prop:"",label:"排序",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.$index+1))]}}],null,!1,811300409)}),a("el-table-column",{attrs:{prop:"tabId",label:"版面ID",width:"180"}}),a("el-table-column",{attrs:{prop:"tabName",label:"版面名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.handlePreviewTab(t.row,t.row.currentVersion,t.$index)}}},[e._v(e._s(t.row.tabName))])]}}],null,!1,4001151170)}),a("el-table-column",{attrs:{prop:"duplicateVersion",label:"待审核副本",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.duplicateVersion?a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.handlePreviewTab(t.row,t.row.duplicateVersion,t.$index)}}},[e._v(e._s(t.row.duplicateVersion))]):e._e()]}}],null,!1,3763728115)})],1)],1)])]:e._e(),2===e.tabInfo.tabType?[a("el-form-item",{attrs:{label:"活动浮窗",prop:"floatWindow"}},[e.tabInfo.activityFloatWindow?[e._v(e._s(e.tabInfo.activityFloatWindow.pluginName))]:e._e()],2)]:e._e(),0===e.tabInfo.hasSubTab?a("el-form-item",{attrs:{label:"选择版块"}},[a("div",{staticClass:"tab-info__virtual-tab-menu"},[e.showAffix?a("Affix",{staticStyle:{width:"725px",display:"inline-block",background:"#fff","z-index":"1"},attrs:{"relative-element-selector":".tab-info__virtual-tab","scroll-container-selector":".page-content-wrapper",offset:{top:140,bottom:50}}},[a("el-button",{on:{click:function(t){return e.handleToggleAllPanel(!1)}}},[e._v("展开所有")]),a("el-button",{on:{click:function(t){return e.handleToggleAllPanel(!0)}}},[e._v("收起所有")]),a("el-button",{attrs:{type:"primary",disabled:0===e.panelsModified.length},on:{click:e.handleSubmitBlockExchange}},[e._v("提交推荐位移动")]),a("el-button",{attrs:{type:"primary",disabled:0===e.blockExchangeHistory.length},on:{click:e.handleRevertBlockExchange}},[e._v("\n                      撤销上次推荐位移动 "+e._s(e.blockExchangeHistory.length>0?"("+e.blockExchangeHistory.length+")":"")+"\n                    ")])],1):e._e()],1),a("div",{staticClass:"block-exchange-wrapper"},[e.showAffix?a("Affix",{attrs:{"relative-element-selector":".tab-info__virtual-tab","scroll-container-selector":".page-content-wrapper",offset:{top:110,bottom:20}}},[a("BlockExchangeCenter",{directives:[{name:"show",rawName:"v-show",value:e.blocksToExchange.length>0,expression:"blocksToExchange.length > 0"}],attrs:{active:e.activeBlockIndex,"panel-data":e.panelListIndexed,blocks:e.blocksToExchange},on:{activate:function(t){e.activeBlockIndex=t},remove:e.handleRemoveBlock}})],1):e._e()],1),a("cc-virtual-tab",{ref:"virtualTab",staticClass:"tab-info__virtual-tab",attrs:{panels:e.tabInfo.pannelList,"panel-data":e.panelListIndexed,"show-chart-btn":!0,"show-exchange-tool":e.showExchangeTool,"read-only":!0,width:725,ratio:.315,"show-title":!0},on:{"open-panel":e.handlePreviewPanel,"click-block":e.handleClickBlock,collapse:e.handleChangeCollapseState,uncollapse:e.handleChangeCollapseState,"show-all-panel":e.handleShowAllPanels,"lazy-init":e.handleLazyInit,"copy-block":e.handleCopyBlock,"exchange-block":e.handleExchangeBlock}})],1):e._e(),2===e.tabInfo.tabType?[a("div",{staticClass:"form-legend-header"},[a("span",[e._v("专题配置")])]),a("el-form-item",{attrs:{label:"会员展示"}},[e._v("\n                    "+e._s(e.getVipButtonSourceItem(e.tabInfo.vipButtonSourceId).sourceName)+"\n                ")]),13!==e.tabInfo.tabType?a("el-form-item",{attrs:{label:"专题版面大背景",prop:"alumbTabBg"}},[a("div",[e.tabInfo.alumbTabBg?a("div",{staticClass:"image-preview-wrapper"},[a("img",{staticClass:"image-preview",attrs:{src:e.tabInfo.alumbTabBg}})]):e._e()])]):e._e(),13!==e.tabInfo.tabType?a("el-form-item",{attrs:{label:"专题版面长图背景",prop:"alumbTabLongBg"}},[a("div",[e.tabInfo.alumbTabLongBg?a("div",{staticClass:"image-preview-wrapper"},[a("img",{staticClass:"image-preview",attrs:{src:e.tabInfo.alumbTabLongBg}})]):e._e()])]):e._e(),a("el-form-item",{attrs:{label:"收藏展示图"}},[a("div",[e.tabInfo.collectImg?a("div",{staticClass:"image-preview-wrapper"},[a("img",{staticClass:"image-preview",attrs:{src:e.tabInfo.collectImg}})]):e._e()])]),a("el-form-item",{attrs:{label:"启用高清背景切换模式",prop:"flagIsBlockBg"}},[e._v("\n                  "+e._s(e.tabInfo.flagIsBlockBg?"是":"否")+"\n                ")]),a("el-form-item",{attrs:{label:"版面简介显示高"}},[e._v(e._s(e.tabInfo.sinkSize))]),a("el-form-item",{attrs:{label:"版块标题颜色"}},[a("input",{attrs:{disabled:"",type:"color"},domProps:{value:e.tabInfo.panelTitleColor}})]),a("el-form-item",{attrs:{label:"推荐位字体颜色(落焦)"}},[a("input",{attrs:{disabled:"",type:"color"},domProps:{value:e.tabInfo.blockTitleFocusColor}})])]:e._e()],2),e.tabInfo.hasSubTab?e._e():a("div",{staticClass:"form-legend-header",on:{click:function(t){e.isCollapseCustom=!e.isCollapseCustom}}},[e.isCollapseCustom?a("i",{staticClass:"el-icon-arrow-down"}):a("i",{staticClass:"el-icon-arrow-up"}),a("span",[e._v("版块个性化排序配置")])]),e.tabInfo.hasSubTab?e._e():a("div",{style:{display:e.isCollapseCustom?"none":"block"}},[a("el-form-item",{attrs:{label:"启动版块个性化推荐"}},[e._v("\n                "+e._s(e.tabInfo.panelRecommendConfig.enableRecommend?"是":"否")+"\n              ")]),e.tabInfo.panelRecommendConfig.enableRecommend?[a("el-form-item",{attrs:{label:"选择版块流"}},[a("RecommendStreamSignSelector",{attrs:{"is-read":!0,confirm:"改变版块流将清空优先推荐版块，确认修改？"},model:{value:e.tabInfo.panelRecommendConfig.recommendSign,callback:function(t){e.$set(e.tabInfo.panelRecommendConfig,"recommendSign",t)},expression:"tabInfo.panelRecommendConfig.recommendSign"}})],1),a("el-form-item",{attrs:{label:"从第几个位置开始推荐",prop:"panelRecommendConfig.recommendIndex",rules:[{required:!0,message:"不能为空"}]}},[e._v("\n                  "+e._s(e.tabInfo.panelRecommendConfig.recommendIndex)+"\n                ")]),a("el-form-item",{attrs:{label:"优先推荐版块"}},[a("OrderableTable",{attrs:{readonly:!0,"hide-action":!0,header:e.panelRecommendHeader},model:{value:e.tabInfo.panelRecommendConfig.panelInfoList,callback:function(t){e.$set(e.tabInfo.panelRecommendConfig,"panelInfoList",t)},expression:"tabInfo.panelRecommendConfig.panelInfoList"}})],1)]:e._e()],2)])]:e._e()],2)],1)],1),"tab"===e.activePage?a("PageContentWrapper",[4===e.embedTab.tabType?a("JDTabInfo",{attrs:{"title-prefix":e.title,id:e.embedTab.id,version:e.embedTab.version,"init-mode":e.embedTab.mode},on:{"upsert-end":e.handleTabEmbedBack,"go-back":function(t){e.activePage="tab_info"}}}):a("TabInfo",{attrs:{"title-prefix":e.title,id:e.embedTab.id,version:e.embedTab.version,"init-mode":e.embedTab.mode},on:{"upsert-end":e.handleTabEmbedBack,"go-back":function(t){e.activePage="tab_info"}}})],1):e._e(),"panel_preview"===e.activePage?a("PageContentWrapper",["function"===e.panelPreview.parentType?a("MarkPanelInfo",{attrs:{"title-prefix":e.title,"init-mode":e.panelPreview.initMode,id:e.panelPreview.id,version:e.panelPreview.version},on:{"upsert-end":e.handlePreviewPanelEnd,"go-back":e.handlePreviewPanelEnd}}):[5,9,10].indexOf(e.panelPreview.dataType)>-1&&3!==e.panelPreview.fillType&&4!==e.panelPreview.fillType?a("PrivatePanelInfo",{attrs:{"title-prefix":e.title,"init-mode":e.panelPreview.initMode,id:e.panelPreview.id,version:e.panelPreview.version},on:{"upsert-end":e.handlePreviewPanelEnd,"go-back":e.handlePreviewPanelEnd}}):a("PanelInfo",{attrs:{"title-prefix":e.title,"init-mode":e.panelPreview.initMode,id:e.panelPreview.id,version:e.panelPreview.version,"panel-data-type":e.panelPreview.dataType,"init-group-index":e.panelPreview.initGroupIndex,"init-block-index":e.panelPreview.initBlockIndex},on:{"upsert-end":e.handlePreviewPanelEnd,"go-back":e.handlePreviewPanelEnd}})],1):e._e(),"panel"===e.activePage?a("PageContentWrapper",[a("PanelInfo",{attrs:{"title-prefix":e.title,"init-mode":"create","panel-data-type":1},on:{"upsert-end":function(t){e.activePage="tab_info"},"go-back":function(t){e.activePage="tab_info"}}})],1):e._e(),"album_panel"===e.activePage?a("PageContentWrapper",[a("PanelInfo",{attrs:{"title-prefix":e.title,"init-mode":"create","panel-data-type":3},on:{"upsert-end":function(t){e.activePage="tab_info"},"go-back":function(t){e.activePage="tab_info"}}})],1):e._e(),"private_panel"===e.activePage?a("PageContentWrapper",[a("PrivatePanelInfo",{attrs:{"title-prefix":e.title,"init-mode":"create"},on:{"upsert-end":function(t){e.activePage="tab_info"},"go-back":function(t){e.activePage="tab_info"}}})],1):e._e()],1)},i=[],r=(a("7514"),a("5df3"),a("4f7f"),a("cebc")),o=(a("6b54"),a("2fdb"),a("6762"),a("28a5"),a("ac6a"),a("20d6"),a("7618")),l={60:"4",67:"-1",61:"10",66:"6",31:"0"};function s(e){return l[e]||"-1"}var c=a("a36a"),u=a("4bc7"),d=a("5f87"),p=a("da3c"),h=a("c3d5"),m=a("5eb0"),f=a("9311"),v=a("8353"),g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isRead?a("span",[e._v(e._s(e.valueLabel))]):a("el-select",{ref:"select",attrs:{filterable:e.filterable,value:e.value},on:{input:e.handleInput}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})}),1)},b=[],y={data:function(){return{options:[]}},computed:{valueLabel:function(){var e=this.value,t=this.options;if(e&&t){var a=t.find(function(t){return t.value===e});if(a)return a.label}}},props:["value","isRead","filterable"],methods:{handleInput:function(e){var t=this;this.$emit("input",e),this.$nextTick(function(){t.$refs.select.blur()})}},created:function(){var e=this,t=this.isRead;this.$service.getDictType({type:"businessType",isFilter:t?0:1}).then(function(t){e.options=t.map(function(e){return{label:e.dictCnName,value:e.dictId}})})}},w=y,I=a("2877"),C=Object(I["a"])(w,g,b,!1,null,null,null),T=C.exports,S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isRead?a("span",[e._v("\n    "+e._s(e.valueLabel)+"\n")]):a("el-select",{attrs:{filterable:e.filterable,value:e.value,disabled:e.disabled},on:{input:function(t){return e.$emit("input",t)}}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})}),1)},k=[],_={data:function(){return{options:[]}},computed:{valueLabel:function(){var e=this.value,t=this.options;if(void 0!==e&&t){var a=t.find(function(t){return t.value===e});if(a)return a.label}}},props:["value","isRead","disabled","filterable"],methods:{},created:function(){var e=this;this.$service.getDictType({type:"appIdType"}).then(function(t){e.options=t.map(function(e){return{label:e.dictCnName,value:+e.dictEnName}})})}},P=_,x=Object(I["a"])(P,S,k,!1,null,null,null),F=x.exports,D=a("b1cd"),R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("RemoteSelectorWrapper",{ref:"wrapper",attrs:{title:"选择浮窗",filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset,"select-end":e.handleSelectEnd,"select-start":e.fetchData}},[a("CardList",{attrs:{slot:"item-list",data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-change":e.handleRowSelectionChange},slot:"item-list",scopedSlots:e._u([{key:"row",fn:function(t){var n=t.row;return a("div",{staticClass:"box-list"},[a("p",{staticClass:"list-p"},[a("img",{key:n.globalPicture.pictureUrl,staticClass:"list-img",attrs:{src:n.globalPicture.pictureUrl}})]),a("p",{staticClass:"list-title"},[e._v(e._s(n.pluginName))]),a("div",[e._v(e._s(n.pluginId)+" / "+e._s(n.modifierName)+" / "+e._s(n.createdDate))])])}}])}),a("div",{attrs:{slot:"actions"},slot:"actions"}),e._t("default")],2)},L=[],$=a("f6e7"),N=a.n($),E=a("5076"),O=a("59c7"),A={components:{CardList:O["CardList"],RemoteSelectorWrapper:E["a"]},props:{params:{type:Object,default:function(){return{}}}},data:function(){return{filter:{pluginId:void 0,pluginName:void 0},filterSchema:N.a.map({pluginId:N.a.o.oneOf([N.a.value(""),N.a.number]).$msg("请输入数字").other("form",{component:"Input",label:" ",placeholder:"ID",cols:{item:3,wrapper:23}}),pluginName:N.a.o.string.other("form",{label:" ",placeholder:"功能名称",cols:{item:3,wrapper:23}})}).other("form",{layout:"inline",footer:{cols:{item:3,wrapper:23},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}}),pagination:{currentPage:1,pageSize:15},selected:[],table:{loading:!1,props:{},data:[],selected:void 0,selectionType:"single"}}},methods:{handleRowSelectionChange:function(e,t){this.table.selected=t,this.$refs.wrapper.handleSelectEnd()},handleFilterChange:function(){this.pagination.currentPage=1,this.fetchData()},handleFilterReset:function(){this.filter={pluginId:void 0,pluginName:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination,a=this.params,n=a.sourceArray;return t&&(e.page=t.currentPage,e.rows=t.pageSize),n&&(e.sourceArray=n),e},fetchData:function(){var e=this;this.table.selected=void 0;var t=this.parseFilter();this.pictureResolution&&(t.pictureResolution=this.pictureResolution),this.$service.floatWindowList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},handleSelectEnd:function(){var e=this.table,t=e.data,a=e.selected;this.$emit("select-end",t[a]),this.table.selected=void 0}},created:function(){}},V=A,B=(a("1d2f"),Object(I["a"])(V,R,L,!1,null,"5b5e54c3",null)),M=B.exports,U=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"选择 ICON",visible:!0,"before-close":e.handleClose}},[a("div",{staticClass:"icon-selector__wrapper"},e._l(e.options,function(t){return a("img",{key:t.pictureUrl,class:e.selected&&e.selected.pictureId===t.pictureId?"active":"",attrs:{referrerpolicy:"no-referrer",src:t.pictureUrl,alt:"图标",title:t.iconTypeName},on:{click:function(a){e.selected=t}}})}),0),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSelectEnd}},[e._v("确 定")])],1)])},G=[],j={data:function(){return{selected:void 0,options:[]}},props:["value"],methods:{handleClose:function(){this.selected=void 0,this.$nextTick(function(){this.$emit("select-cancel")}.bind(this))},handleSelectEnd:function(){this.$emit("select-end",this.selected)}},created:function(){var e=this;this.$service.tabIconList().then(function(t){e.options=t.rows})}},z=j,W=(a("0afe"),Object(I["a"])(z,U,G,!1,null,"467bfb14",null)),q=W.exports,J=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:{"cc-virtual-tab":!0,"collapse-all":e.isDragging},style:{width:e.width+"px"}},[e.readOnly?e._e():a("div",{staticClass:"panel-placeholder panel-placeholder__normal",on:{dragenter:e.handleDragEnter,dragleave:e.handleDragLeave,dragover:e.handleDragOver,drop:function(t){return e.handleDrop(t,{type:"NORMAL",index:-1})}}}),e._l(e.panels,function(t,n){return[e.show?a("div",{directives:[{name:"shadow-drag",rawName:"v-shadow-drag",value:{type:t.type,index:n},expression:"{type: panelItem.type, index: index}"}],key:"panel-"+n,class:{"tab-placeholder":!0,"tab-placeholder--normal":"NORMAL"===t.type,collapse:t.isCollapse,"is-dragable":!e.readOnly,"tab-placeholder--dragging":void 0===e.draggingCrowdIndex&&e.draggingIndex===n},on:{"shadow-drag-start":function(t){return e.handleDragStart(t,n)},"shadow-drag-end":e.handleDragEnd}},[a("div",{staticClass:"panel-group-title"},[t.isCollapse?a("i",{staticClass:"el-icon-arrow-down",on:{click:function(t){return e.handleCollapse(!1,n)}}}):a("i",{staticClass:"el-icon-arrow-up",on:{click:function(t){return e.handleCollapse(!0,n)}}}),"SPEC"===t.type?[e._v("\n          "+e._s(e.getPanelInfo(t.crowdPanels[0]).panelName)+" ("+e._s(t.crowdPanels.length)+")\n        ")]:[e._v(e._s(e.getPanelInfo(t.panel).panelName))],a("InputOrder",{key:Math.random().toString(),staticClass:"tab-placeholder__index",attrs:{size:"small",clearable:"",value:n+1,disabled:e.readOnly,draggable:"true"},on:{input:function(t){return e.$emit("change-panel-order",n,t)}},nativeOn:{dragstart:function(t){return e.disableDrag(t)}}}),e.readOnly?e._e():a("i",{staticClass:"tab-placeholder__group-remove el-icon-close",attrs:{title:"删除组"},on:{click:function(t){return e.handleRemovePanel(n)}}})],2),a("div",{staticClass:"panel-group-content"},["SPEC"===t.type?a("div",[e.readOnly?e._e():a("div",{staticClass:"panel-placeholder",on:{dragenter:e.handleDragEnter,dragleave:e.handleDragLeave,dragover:e.handleDragOver,drop:function(t){return e.handleDrop(t,{type:"CROWD",index:n,crowdIndex:-1})}}}),e._l(t.crowdPanels,function(i,r){return[a("cc-var",{directives:[{name:"show",rawName:"v-show",value:e.isDragging||t.isShowAll||0===r,expression:"isDragging || panelItem.isShowAll || crowdIndex === 0"},{name:"shadow-drag",rawName:"v-shadow-drag",value:{type:"CROWD",index:n,crowdIndex:r},expression:"{type: 'CROWD', index: index, crowdIndex: crowdIndex}"}],key:r,class:{"tab-placeholder__panel-wrapper":!0,"panel-duplicate":i.isDuplicate,"tab-placeholder__panel-wrapper--dragging":e.draggingCrowdIndex===r&&e.draggingIndex===n},attrs:{panel:e.getPanelInfo(i)},nativeOn:{"shadow-drag-start":function(t){return e.handleDragStart(t,n,r)},"shadow-drag-end":function(t){return e.handleDragEnd(t)}},scopedSlots:e._u([{key:"default",fn:function(o){var l=o.panel;return[a("div",{staticClass:"panel-tools"},[e.readOnly?e._e():[1===t.crowdPanels.length?a("a",{staticClass:"panel-tools-btn",on:{click:function(t){return e.$emit("toggle-type",n)}}},[e._v("\n                      取消定向\n                    ")]):a("a",{staticClass:"panel-tools-btn panel-tools-btn--disabled",attrs:{title:"请将版块移出版块组，再取消定向"}},[e._v("取消定向")]),a("i",{staticClass:"panel-tools-btn panel-tools-btn--remove el-icon-close",attrs:{title:"删除"},on:{click:function(t){return e.handleRemovePanel(n,r)}}})]],2),a("div",{staticClass:"tab-plcacholder-info"},[a("div",{staticClass:"tab-placeholder-info__link",on:{click:function(t){return e.handleOpenPanel(l)}}},[a("vue-lazy-component",{on:{"before-init":function(t){return e.$emit("lazy-init",i)}}},[e._v("\n                      "+e._s(l.panelId)+"\n                    ")]),a("span",{directives:[{name:"show",rawName:"v-show",value:4!==l.status,expression:"panel.status !== 4"}],staticClass:"panel-status--waiting"},[e._v("\n                      ("+e._s(e.STATUS_TEXT[l.status])+")\n                    ")])],1),a("div",{staticClass:"tab-placeholder-info__link",on:{click:function(t){return e.handleOpenPanel(l)}}},[e._v("\n                    "+e._s(l.panelName)+"\n                  ")]),i.dmpInfo?a("div",{staticClass:"tab-placeholder-info__link",on:{click:function(t){return e.$emit("change-crowd",n,r)}}},[e._v("\n                    人群: "+e._s(i.dmpInfo.crowdName)+"\n                  ")]):e._e()]),a("div",{staticClass:"tab-placeholder__panel"},[a("div",{staticClass:"tab-placeholder__panel-title",on:{click:function(t){return e.handleOpenPanel(l)}}},[e._v("\n                    "+e._s(l.panelTitle)+"\n                  ")]),a("cc-virtual-panel-group",{key:r,attrs:{panel:e.panelData[i.id],ratio:e.ratio,active:i.activeIndex,"show-chart-btn":e.showChartBtn,"show-exchange-tool":e.showExchangeTool,"show-title":e.showTitle},on:{"copy-block":function(t){return e.handleCopyBlock({panelGroupId:i.id,groupIndex:arguments[0],blockIndex:arguments[1]})},"exchange-block":function(t){return e.handleExchangeBlock({panelGroupId:i.id,groupIndex:arguments[0],blockIndex:arguments[1]})},activate:function(t){return e.handleActivate(i,t)},"click-block":function(t){return e.handleClickBlock({index:n,crowdIndex:r,activeIndex:arguments[0],blockIndex:arguments[1]})}}},[e.panelData[i.id].panelList?a("PanelStatisticTable",{key:i.id,attrs:{slot:"stat",panelID:i.id,isShow:!t.isCollapse},slot:"stat"}):e._e()],1)],1)]}}],null,!0)}),e.readOnly?e._e():a("div",{directives:[{name:"show",rawName:"v-show",value:e.isDragging||t.isShowAll||0===r,expression:"isDragging || panelItem.isShowAll || crowdIndex === 0"}],key:"crowd-"+r,staticClass:"panel-placeholder",on:{dragenter:e.handleDragEnter,dragleave:e.handleDragLeave,dragover:e.handleDragOver,drop:function(t){return e.handleDrop(t,{type:"CROWD",index:n,crowdIndex:r})}}})]}),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isDragging&&!t.isShowAll&&t.crowdPanels.length>1,expression:"!isDragging && !panelItem.isShowAll && panelItem.crowdPanels.length > 1"}],staticClass:"btn-show-all"},[a("a",{attrs:{title:"显示所有版块"},on:{click:function(t){return e.handleShowAllPanels(n)}}},[a("i",{staticClass:"el-icon-arrow-down"}),e._v("\n              共 "+e._s(t.crowdPanels.length)+" 个版块\n            ")])])],2):a("div",{staticClass:"tab-placeholder__normal-panel"},[a("cc-var",{class:{"tab-placeholder__panel-wrapper":!0,"panel-duplicate":t.panel.isDuplicate},attrs:{panel:e.getPanelInfo(t.panel)},scopedSlots:e._u([{key:"default",fn:function(i){var r=i.panel;return[a("div",{staticClass:"panel-tools"},[e.readOnly?e._e():[a("a",{staticClass:"panel-tools-btn btn-crowd--set",on:{click:function(t){return e.$emit("toggle-type",n)}}},[e._v("设置定向")]),a("i",{staticClass:"panel-tools-btn panel-tools-btn--remove el-icon-close",attrs:{title:"删除"},on:{click:function(t){return e.handleRemovePanel(n)}}})]],2),a("div",{staticClass:"tab-plcacholder-info"},[a("div",{staticClass:"tab-placeholder-info__link",on:{click:function(t){return e.handleOpenPanel(r)}}},[a("vue-lazy-component",{on:{"before-init":function(a){return e.$emit("lazy-init",t.panel)}}},[e._v("\n                    "+e._s(r.panelId)+"\n                  ")]),a("span",{directives:[{name:"show",rawName:"v-show",value:4!==r.status,expression:"panel.status !== 4"}],staticClass:"panel-status--waiting"},[e._v("\n                    ("+e._s(e.STATUS_TEXT[r.status])+")\n                  ")])],1),a("div",{staticClass:"tab-placeholder-info__link",on:{click:function(t){return e.handleOpenPanel(r)}}},[e._v(e._s(r.panelName))])]),a("div",{staticClass:"tab-placeholder__panel"},[a("div",{staticClass:"tab-placeholder__panel-title",on:{click:function(t){return e.handleOpenPanel(r)}}},[e._v("\n                  "+e._s(r.panelTitle)+"\n                ")]),a("cc-virtual-panel-group",{attrs:{panel:e.panelData[t.panel.id],active:r.activeIndex,ratio:e.ratio,"show-title":e.showTitle,"show-chart-btn":e.showChartBtn,"show-exchange-tool":e.showExchangeTool},on:{"copy-block":function(a){return e.handleCopyBlock({panelGroupId:t.panel.id,groupIndex:arguments[0],blockIndex:arguments[1]})},"exchange-block":function(a){return e.handleExchangeBlock({panelGroupId:t.panel.id,groupIndex:arguments[0],blockIndex:arguments[1]})},activate:function(a){return e.handleActivate(t.panel,a)},"click-block":function(t){return e.handleClickBlock({index:n,activeIndex:arguments[0],blockIndex:arguments[1]})}}})],1),e.panelData[t.panel.id].panelList?a("PanelStatisticTable",{key:t.panel.id,attrs:{panelID:t.panel.id,isShow:!t.isCollapse}}):e._e()]}}],null,!0)})],1)])]):e._e(),e.readOnly?e._e():a("div",{key:"placeholder-"+n,staticClass:"panel-placeholder panel-placeholder__normal",on:{dragenter:e.handleDragEnter,dragleave:e.handleDragLeave,dragover:e.handleDragOver,drop:function(t){return e.handleDrop(t,{type:"NORMAL",index:n})}}})]})],2)},H=[],K=a("b6c7"),Y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"cc-virtual-panel-group"},[e.panel.panelList?["group"===e.panel.parentType?[a("el-tabs",{attrs:{type:"card",value:e.active+""},on:{input:function(t){return e.$emit("activate",t)}}},e._l(e.panel.panelList,function(t,n){return a("el-tab-pane",{key:n,attrs:{name:n+""}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(t.panelTitle))]),a("cc-virtual-panel",{attrs:{"panel-group":e.panel,"panel-index":n,blocks:t.blocks,ratio:e.ratio,"show-title":e.showTitle,"show-chart-btn":e.showChartBtn,"show-exchange-tool":e.showExchangeTool,"disable-exchange-tool":e.disableExchangeTool},on:{"copy-block":function(t){return e.handleCopyBlock(n,t)},"exchange-block":function(t){return e.handleExchangeBlock(n,t)},"click-block":function(t){return e.handleClickBlock(n,t)}}})],1)}),1)]:e.isRecStreamPanel?e._e():a("cc-virtual-panel",{attrs:{"panel-group":e.panel,"panel-index":0,blocks:e.panel.panelList[0].blocks,ratio:e.ratio,"show-title":e.showTitle,"show-chart-btn":e.showChartBtn,"show-exchange-tool":e.showExchangeTool,"disable-exchange-tool":e.disableExchangeTool},on:{"copy-block":function(t){return e.handleCopyBlock(0,t)},"exchange-block":function(t){return e.handleExchangeBlock(0,t)},"click-block":function(t){return e.handleClickBlock(0,t)}}})]:a("div",{staticClass:"skeleton"},[a("div",{staticClass:"skeleton__block"}),a("div",{staticClass:"skeleton__block"}),a("div",{staticClass:"skeleton__block"}),a("div",{staticClass:"skeleton__block"})]),e._t("stat")],2)},Q=[],X=a("8133"),Z={components:{"cc-virtual-panel":X["a"]},props:["panel","ratio","active","showTitle","showExchangeTool","showChartBtn"],computed:{disableExchangeTool:function(){return this.isForbiddenType||this.isForbiddenStatus},isRecStreamPanel:function(){var e=this.panel,t=e.pannelList[0].fillType,a=this.$consts.panelFillTypes,n=t===a.recStream;return n},isForbiddenType:function(){var e=this.panel,t=e.parentType,a=e.pannelList[0].fillType,n=this.$consts.panelFillTypes,i=1===e.pannelList[0].rankIsOpen,r=a===n.mediaRule,o=12===e.panelGroupType;return"function"===t||"subscribe"===t||i||r||o},isForbiddenStatus:function(){var e=this.panel.pannelStatus;return!(2===e||4===e)},errorMsg:function(){return this.isForbiddenStatus?"只有审核通过和草稿状态的版块支持移动待":"不能移动排行榜版块、影片规则筛选版块、预约版块、功能版块、酷开幸福榜里的推荐位"}},methods:{handleClickBlock:function(e,t){this.$emit("click-block",e,t)},handleCopyBlock:function(e,t){if(this.disableExchangeTool)return this.$message.error(this.errorMsg);this.$emit("copy-block",e,t)},handleExchangeBlock:function(e,t){if(this.disableExchangeTool)return this.$message.error(this.errorMsg);this.$emit("exchange-block",e,t)}}},ee=Z,te=(a("b92a"),Object(I["a"])(ee,Y,Q,!1,null,"73e9031c",null)),ae=te.exports,ne=a("193e"),ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isShow?a("div",{staticClass:"table-box",attrs:{title:"版块ID: "+e.panelID}},[a("Table",{attrs:{data:e.clickUvTable.data,props:e.clickUvTable.props,header:e.clickUvTable.header,"selection-type":e.clickUvTable.selectionType}}),a("Table",{attrs:{data:e.uvctrTable.data,props:e.uvctrTable.props,header:e.uvctrTable.header,"selection-type":e.uvctrTable.selectionType}})],1):e._e()},re=[],oe={components:{Table:O["Table"]},data:function(){return{clickUvTable:{props:{border:!0,size:"small","row-style":function(){return"height: 20px"},"cell-style":function(){return"padding: 0; text-align: center"},"header-cell-style":function(){return"padding: 0; text-align: center"}},header:[{label:"",prop:"date",width:40},{label:"点击UV",prop:"clickUv",width:80},{label:"环比",prop:"dailyGrowth",width:80,render:function(e,t){var a=t.row;if(!a.dailyGrowth)return"N/A";var n="↑"===a.dailyGrowth.split(" ").pop()?0:1;return e("div",{style:{color:["red","#00AA00"][n]}},a.dailyGrowth)}},{label:"同比",prop:"weeklyGrowth",width:80,render:function(e,t){var a=t.row;if(!a.weeklyGrowth)return"N/A";var n="↑"===a.weeklyGrowth.split(" ").pop()?0:1;return e("div",{style:{color:["red","#00AA00"][n]}},a.weeklyGrowth)}}],data:[],selectionType:"none"},uvctrTable:{props:{border:!0,size:"small","row-style":function(){return"height: 20px"},"cell-style":function(){return"padding: 0; text-align: center"},"header-cell-style":function(){return"padding: 0; text-align: center"}},header:[{label:"",prop:"date",width:40},{label:"UVCTR",prop:"uvctr",width:80},{label:"环比",prop:"dailyGrowth",width:80,render:function(e,t){var a=t.row;if(!a.dailyGrowth)return"N/A";var n="↑"===a.dailyGrowth.split(" ").pop()?0:1;return e("div",{style:{color:["red","#00AA00"][n]}},a.dailyGrowth)}},{label:"同比",prop:"weeklyGrowth",width:80,render:function(e,t){var a=t.row;if(!a.weeklyGrowth)return"N/A";var n="↑"===a.weeklyGrowth.split(" ").pop()?0:1;return e("div",{style:{color:["red","#00AA00"][n]}},a.weeklyGrowth)}}],data:[],selectionType:"none"}}},props:["panelID","isShow"],methods:{toPercent:function(e){return(Math.round(1e4*e)/100).toFixed(2)+"%"},toArrowPercent:function(e){var t=this.toPercent(Math.abs(e));return t+(e>0?" ↑":" ↓")},getDateday:function(e){return e.split("-").pop()},getPanelSimpleBrowseData:function(){var e=this;this.$service.getPanelSimpleBrowseData({id:this.panelID,days:3}).then(function(t){var a=t.rows[0].data,n=[],i=[];a.forEach(function(t){var a={},r={};if(!t.date)return a={date:"-",clickUv:"-",dailyGrowth:"-",weeklyGrowth:"-"},r={date:"-",uvctr:"-",dailyGrowth:"-",weeklyGrowth:"-"},n.push(a),void i.push(r);var o=e.getDateday(t.date),l=t.clickUv,s=t.uvctr;a={date:o,clickUv:l.value,dailyGrowth:l.dailyGrowth?e.toArrowPercent(l.dailyGrowth):"-",weeklyGrowth:l.weeklyGrowth?e.toArrowPercent(l.weeklyGrowth):"-"},r={date:o,uvctr:e.toPercent(s.value),dailyGrowth:s.dailyGrowth?e.toArrowPercent(s.dailyGrowth):"-",weeklyGrowth:s.weeklyGrowth?e.toArrowPercent(s.weeklyGrowth):"-"},n.push(a),i.push(r)}),e.clickUvTable.data=n.reverse(),e.uvctrTable.data=i.reverse()})}},created:function(){this.getPanelSimpleBrowseData()}},le=oe,se=(a("ce8b"),Object(I["a"])(le,ie,re,!1,null,"584908d8",null)),ce=se.exports,ue=a("49ab"),de={components:{"cc-var":K["a"],"cc-virtual-panel-group":ae,InputOrder:ne["a"],PanelStatisticTable:ce,VueLazyComponent:ue["component"]},data:function(){return this.table={props:{border:!0,size:"small","row-style":function(){return"height: 20px"},"cell-style":function(){return"padding: 0"},"header-cell-style":function(){return"padding: 0"}},header:[{label:"",prop:"date",width:35},{label:"曝光UV",prop:"exposureUV",width:70},{label:"环比",prop:"dailyGrowth",width:70},{label:"同比",prop:"weeklyGrowth",width:70}],data:[{date:"27",exposureUV:"178123",dailyGrowth:"13.3%",weeklyGrowth:"13.3%"},{date:"28",exposureUV:"178123",dailyGrowth:"13.3%",weeklyGrowth:"13.3%"},{date:"29",exposureUV:"178123",dailyGrowth:"13.3%",weeklyGrowth:"13.3%"}],selectionType:"none"},this.table2={props:{border:!0,size:"small","row-style":function(){return"height: 20px"},"cell-style":function(){return"padding: 0"},"header-cell-style":function(){return"padding: 0"}},header:[{label:"",prop:"date",width:35},{label:"UVCTR",prop:"UVCTR",width:70},{label:"环比",prop:"dailyGrowth",width:70},{label:"同比",prop:"weeklyGrowth",width:70}],data:[{date:"27",UVCTR:"178123",dailyGrowth:"13.3%",weeklyGrowth:"13.3%"},{date:"28",UVCTR:"178123",dailyGrowth:"13.3%",weeklyGrowth:"13.3%"},{date:"29",UVCTR:"178123",dailyGrowth:"13.3%",weeklyGrowth:"13.3%"}],selectionType:"none"},{show:!0,isDragging:!1,draggingIndex:void 0,draggingCrowdIndex:void 0,STATUS_TEXT:this.$consts.statusText}},props:["panels","ratio","width","panelData","showTitle","readOnly","showExchangeTool","showChartBtn"],methods:{refresh:function(){var e=this;this.show=!1,this.$nextTick(function(){e.show=!0})},disableDrag:function(e){e.stopPropagation(),e.preventDefault()},getPanelInfo:function(e){var t=this.panelData[e.id],a=e.activeIndex||0,n={duplicateVersion:t.duplicateVersion,dmpInfo:e.dmpInfo,panelId:t.pannelGroupId,status:t.pannelStatus,panelName:t.pannelName,panelTitle:t.panelTitle,activeIndex:a};if(t.parentType){var i=t.pannelList[a];n.panelTitle=i.pannelTitle||" ",n.panelName=i.pannelName}return n},hasDuplicateVersion:function(e){var t=e.duplicateVersion;if(t&&"no"!==t)return t},handleActivate:function(e,t){this.$set(e,"activeIndex",+t)},handleDragStart:function(e,t,a){if(this.readOnly)return e.preventDefault(),void e.stopPropagation();this.$emit("drag-start"),setTimeout(function(){this.isDragging=!0,this.draggingIndex=t,this.draggingCrowdIndex=a}.bind(this),0)},handleDragEnd:function(){this.isDragging=!1,this.draggingIndex=void 0,this.draggingCrowdIndex=void 0,this.$emit("drag-end")},handleCollapse:function(e,t){this.$emit(e?"collapse":"uncollapse",t)},handleDragEnter:function(e){e.currentTarget.classList.add("active")},handleDragLeave:function(e){e.currentTarget.classList.remove("active")},handleAddPanel:function(e,t,a){this.$emit("add-panel",{type:e,index:t,crowdIndex:a})},handleDrop:function(e,t){this.handleDragLeave(e);var a=JSON.parse(e.dataTransfer.getData("text/plain"));setTimeout(function(){a.pannelGroupId?this.$emit("insert-panel",a,t):this.$emit("reorder-panel",a,t)}.bind(this),20)},handleDragOver:function(e){e.preventDefault()},handleOpenPanel:function(e){this.$emit("open-panel",e)},handleInsertPanel:function(){},handleRemovePanel:function(e,t){this.$emit("remove-panel",e,t)},handleClickBlock:function(e){this.$emit("click-block",e)},handleShowAllPanels:function(e){this.$emit("show-all-panel",e)},handleCopyBlock:function(e){this.$emit("copy-block",e)},handleExchangeBlock:function(e){this.$emit("exchange-block",e)}}},pe=de,he=(a("e96a"),Object(I["a"])(pe,J,H,!1,null,null,null)),me=he.exports,fe=a("ce06"),ve=a("9ead"),ge=a("363f"),be=a("03df"),ye=a("43f4"),we=a("99ad"),Ie=a("6857"),Ce=a("8bca"),Te=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isRead?a("span",[e._v(e._s(e.valueLabel))]):a("el-select",{ref:"select",attrs:{filterable:e.filterable,value:e.value},on:{input:e.handleInput}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})}),1)},Se=[],ke={data:function(){return{options:[]}},computed:{valueLabel:function(){var e=this.value,t=this.options;if(e&&t){var a=t.find(function(t){return t.value===e});if(a)return a.label}}},props:["value","isRead","confirm","filterable"],methods:{handleInput:function(e){var t=this,a=this.confirm,n=this.value,i=n&&e!==n;i&&a?this.$confirm(a,"提示").then(function(){t.$emit("input",e),t.$nextTick(function(){t.$refs.select.blur()})}).catch(function(){t.$nextTick(function(){t.$refs.select.blur()})}):this.$emit("input",e)}},created:function(){var e=this;this.$service.getDictType({type:"recommendStreamSign"}).then(function(t){e.options=t.map(function(e){return{label:e.dictCnName,value:e.dictCnName}})})}},_e=ke,Pe=Object(I["a"])(_e,Te,Se,!1,null,null,null),xe=Pe.exports,Fe=a("2149"),De=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("RemoteSelectorWrapper",{ref:"wrapper",attrs:{title:e.title,"custom-class":"resource-selector",disabled:e.disabled,"is-live":e.isLive},on:{"select-start":e.handleSelectStart},scopedSlots:e._u([{key:"content",fn:function(t){var n=t.isShow;return[e.isLive||n?a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"panelGroupId","selection-type":e.selectionType,table:e.table,pagination:e.pagination},on:{"pagination-change":e.fetchData,"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}},[a("el-form",{attrs:{slot:"filter",inline:!0},slot:"filter",model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("el-form-item",[a("el-input",{attrs:{clearable:"",placeholder:"版块ID"},model:{value:e.filter.panelGroupId,callback:function(t){e.$set(e.filter,"panelGroupId",t)},expression:"filter.panelGroupId"}})],1),a("el-form-item",[a("el-input",{attrs:{clearable:"",placeholder:"版块名称"},model:{value:e.filter.panelGroupName,callback:function(t){e.$set(e.filter,"panelGroupName",t)},expression:"filter.panelGroupName"}})],1),a("el-form-item",[a("el-input",{attrs:{clearable:"",placeholder:"版块组标题"},model:{value:e.filter.panelGroupTitle,callback:function(t){e.$set(e.filter,"panelGroupTitle",t)},expression:"filter.panelGroupTitle"}})],1),a("el-button",{attrs:{type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{attrs:{type:"warning"},on:{click:e.handleResetFilter}},[e._v("重置")])],1)],1):e._e()]}}])},[e._t("default")],2)},Re=[],Le=a("42f0"),$e={data:function(){var e=this.$consts.statusOptions.filter(function(e){return[3,4,7].indexOf(e.value)>-1}),t=e.reduce(function(e,t){return e[t.value]=t.label,e},{});return{options:[],panelCategoryOptions:[],pannelCategoryOptionsIndexed:{},panelStatusOptions:e,panelStatusOptionsIndexed:t,parentTypeOptions:[{label:"分组版块",value:"group"},{label:"功能版块",value:"function"}],pagination:{currentPage:1,pageSize:15,total:0},filter:this.genDefaultFilter(),efficientFilter:this.genDefaultFilter(),table:{data:[],selected:[],header:[{label:"ID",prop:"panelGroupId",width:200},{label:"名称",prop:"panelGroupName","show-overflow-tooltip":!0},{label:"版块组标题",prop:"panelGroupTitle","show-overflow-tooltip":!0},{prop:"lastUpdateDate",label:"更新时间",width:190}],selectionType:"multiple",props:{"tooltip-effect":"dark"}},selected:[],originSelected:[]}},props:["title","disabled","isLive","source","selectionType","category"],components:{RemoteSelectorWrapper:E["a"],BaseSelector:Le["a"]},methods:{handleSelectStart:function(){this.$emit("select-start"),this.isLive?this.fetchData():this.handleResetFilter()},handleSelectCancel:function(){this.$refs.wrapper.handleSelectCancel()},handleSelectEnd:function(e){this.$emit("select-end",e),this.$refs.wrapper.handleSelectEnd()},genDefaultFilter:function(){return{panelGroupId:void 0,panelGroupName:void 0,panelGroupTitle:void 0,panelGroupCategory:void 0,source:void 0,flag:1}},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleResetFilter:function(){this.filter=this.genDefaultFilter(),this.efficientFilter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=JSON.parse(JSON.stringify(this.efficientFilter)),a=this.pagination;a&&(t.page=a.currentPage,t.rows=a.pageSize),this.category&&(t.panelGroupCategory=this.category),this.source&&(t.source=this.source),this.$service.panelRecommendList(t).then(function(t){e.table.data=t.rows,e.pagination.total=t.total})}},created:function(){var e=this;this.$service.getDictType({type:"businessType"}).then(function(t){e.panelCategoryOptions=t.map(function(e){return{label:e.dictCnName,value:e.dictId,disabled:e.disabled}}),e.pannelCategoryOptionsIndexed=e.panelCategoryOptions.reduce(function(e,t){return e[t.value]=t.label,e},{})})}},Ne=$e,Ee=Object(I["a"])(Ne,De,Re,!1,null,null,null),Oe=Ee.exports,Ae=a("c3da"),Ve=a.n(Ae),Be=(a("95a8"),a("db0e"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"block-exchange-center"},[a("div",{staticClass:"block-exchange-center-title"},[e._v("推荐位中转站")]),a("div",{staticClass:"block-item-list"},e._l(e.blocks,function(t,n){return a("Var",{key:t.key,class:{"block-item":!0,active:n===e.active},attrs:{block:e.getBlockContent(t)},nativeOn:{click:function(t){return e.$emit("activate",n)}},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.block;return i?[a("div",{staticClass:"block-item-img-wrapper"},[a("img",{staticClass:"block-item-img",attrs:{referrerpolicy:"no-referrer",src:i.pictureUrl}})]),a("div",{staticClass:"block-item-title"},[e._v(e._s(i.title))]),a("i",{staticClass:"block-item-remove el-icon-error",on:{click:function(t){return t.stopPropagation(),e.$emit("remove",n)}}})]:void 0}}],null,!0)})}),1)])}),Me=[],Ue={components:{Var:K["a"]},props:["blocks","panelData","active"],methods:{getBlockContent:function(e){var t=e.panelGroupId,a=e.groupIndex,n=e.blockIndex,i=this.panelData[t];if(i&&i.panelList){var r=i.panelList[a].blocks[n].videoContentList[0];return r}}}},Ge=Ue,je=(a("c192"),Object(I["a"])(Ge,Be,Me,!1,null,"4894d3f4",null)),ze=je.exports,We=a("2ef0"),qe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form-item",{attrs:{label:"插件包名",prop:e.formProp("packagename")}},[a("el-input",{model:{value:e.inputValue.packagename,callback:function(t){e.$set(e.inputValue,"packagename","string"===typeof t?t.trim():t)},expression:"inputValue.packagename"}})],1),a("el-form-item",{attrs:{label:"插件分类名",prop:e.formProp("category")}},[a("el-input",{model:{value:e.inputValue.category,callback:function(t){e.$set(e.inputValue,"category","string"===typeof t?t.trim():t)},expression:"inputValue.category"}})],1),a("el-form-item",{attrs:{label:"插件主页最低版本",prop:e.formProp("minHomepageVersion")}},[a("el-input",{attrs:{maxlength:"7"},model:{value:e.inputValue.minHomepageVersion,callback:function(t){e.$set(e.inputValue,"minHomepageVersion","string"===typeof t?t.trim():t)},expression:"inputValue.minHomepageVersion"}}),a("i",[e._v("例：7104343")])],1),a("el-form-item",{attrs:{label:"扩展参数"}},[e._l(e.inputValue.params,function(t,n){return a("div",{key:n,staticClass:"app-extend-params"},[a("el-form-item",{attrs:{label:"key:","label-width":"60px",prop:e.formProp("params."+n+".key"),rules:e.rules.params.key}},[a("el-input",{model:{value:t.key,callback:function(a){e.$set(t,"key","string"===typeof a?a.trim():a)},expression:"param.key"}})],1),a("el-form-item",{attrs:{label:"value:","label-width":"60px",prop:e.formProp("params."+n+".value"),rules:e.rules.params.value}},[a("el-input",{model:{value:t.value,callback:function(a){e.$set(t,"value","string"===typeof a?a.trim():a)},expression:"param.value"}})],1),a("a",{staticClass:"app-params__remove-param",on:{click:function(t){return e.handleRemoveParam(n)}}},[a("i",{staticClass:"el-icon-minus"})])],1)}),a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleAddParam}},[a("i",{staticClass:"el-icon-plus"}),e._v(" 添加\n    ")])],2)],1)},Je=[],He={data:function(){var e=this,t=function(t,a,n){if(/[！￥……（）——【】：；“”‘’、《》，。？\s+]/.test(a))return n(new Error("请勿输入特殊或空白字符"));var i=e.inputValue.params.filter(function(e){var t=e.key;return t===a}).length>1;if(i)return n(new Error("key 不能重复"));n()},a=function(e,t,a){/[！￥……（）——【】：；“”‘’、《》，。？\s+]/.test(t)?a(new Error("请勿输入特殊或空白字符")):a()};return{inputValue:{packagename:void 0,category:void 0,minHomepageVersion:void 0,params:[],exception:{}},rules:{packagename:[{required:!0,message:"请输入应用包名",trigger:"blur"}],category:[{required:!0,message:"请输入插件分类名",trigger:"blur"}],minHomepageVersion:[{required:!0,message:"请输入插件主页最低版本",trigger:"blur"},{validator:function(e,t,a){if(t&&!/^\+?[1-9][0-9]*$/.test(t))return a(new Error("插件主页最低版本只能输入数字"));a()}}],params:{key:[{required:!0,message:"不能为空",trigger:"blur"},{validator:t,trigger:"blur"}],value:[{required:!0,message:"不能为空",trigger:"blur"},{validator:a,trigger:"blur"}]}}}},props:{value:{},propPrefix:{}},watch:{value:"setInputValue"},methods:{formProp:function(e){return(this.propPrefix||"")+e},genDefaultValue:function(){return{packagename:void 0,category:void 0,minHomepageVersion:void 0,params:[]}},setInputValue:function(e){e!==this.inputValue&&(this.inputValue=Object.assign(this.genDefaultValue(),e))},emitInputValue:function(e){this.$emit("input",this.inputValue)},handleAddParam:function(){this.inputValue.params.push({key:void 0,value:void 0})},handleRemoveParam:function(e){this.inputValue.params.splice(e,1)}},created:function(){this.value&&this.setInputValue(this.value),this.$watch("inputValue",this.emitInputValue,{deep:!0})}},Ke=He,Ye=(a("57da"),Object(I["a"])(Ke,qe,Je,!1,null,"e4cfeb8a",null)),Qe=Ye.exports,Xe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form-item",{attrs:{label:"插件包名"}},[e._v(e._s(e.value.packagename))]),a("el-form-item",{attrs:{label:"插件分类名"}},[e._v(e._s(e.value.category))]),a("el-form-item",{attrs:{label:"插件主页最低版本"}},[e._v(e._s(e.value.minHomepageVersion))]),a("el-form-item",{attrs:{label:"扩展参数"}},e._l(e.value.params,function(t,n){return a("div",{key:n,staticClass:"app-extend-params"},[a("el-form-item",{attrs:{label:"","label-width":"0px"}},[a("el-tag",[e._v("key")]),e._v(" \n        "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.key,placement:"top"}},[a("span",[e._v(e._s(t.key))])])],1),a("el-form-item",{attrs:{label:"","label-width":"0px"}},[a("el-tag",[e._v("value")]),e._v(" \n        "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.value,placement:"top"}},[a("span",[e._v(e._s(t.value))])])],1)],1)}),0)],1)},Ze=[],et={template:"#cc-app-params-read",data:function(){return{defaultArr:[]}},props:["value"],created:function(){},mounted:function(){console.log(this.value,"----fff-")}},tt=et,at=(a("ab91"),Object(I["a"])(tt,Xe,Ze,!1,null,"3c046010",null)),nt=at.exports,it={},rt={name:"TabInfo",mixins:[ge["a"]],components:{"cc-tab-selector-el":v["a"],"cc-panel-selector-el":f["a"],"cc-business-type-selector":T,"cc-appid-selector":F,"cc-float-window-selector":M,"cc-icon-selector":q,"cc-virtual-tab":me,"cc-crowd-selector":fe["a"],JDTabInfo:c["a"],InputPositiveInt:Fe["a"],CommonContent:h["a"],Affix:ve["Affix"],ContentCard:m["a"],SourceRadioSelector:p["a"],OrderableTable:be["a"],PageWrapper:u["a"],PageContentWrapper:d["a"],PanelInfo:ye["a"],PrivatePanelInfo:we["a"],MarkPanelInfo:Ie["a"],InputMinute:Ce["a"],RecommendStreamSignSelector:xe,RecommendPanelSelector:Oe,VeLine:Ve.a,BlockExchangeCenter:ze,GlobalPictureSelector:D["a"],TabPluginParams:Qe,TabPluginParamsRead:nt},data:function(){var e=this;this.markLine={data:[{name:"平均线",type:"average"}]},this.markPoint={data:[{name:"最大值",type:"max"},{name:"最小值",type:"min"}]};var t={draft:2,waiting:3,accepted:4,rejected:5,processing:7},a={0:"下架",2:"草稿",3:"待审核",4:"审核通过",5:"审核不通过",7:"审核通过未上线"},n={grid:{top:"10%",left:"5%",right:"5%",bottom:"10%",containLabel:!0},series:function(e){return e[0].smooth=!1,e},xAxis:{axisLabel:{rotate:45,formatter:function(e){var t=e.indexOf("(");if(-1===t)return e;var a=e.slice(t-e.length),n=e.slice(0,t);return["{a|".concat(a,"}"),n].join("")},rich:{a:{color:"red"}}}},color:["#1E90FF ","#2f4554"]};return this.clickUvChartSettings={labelMap:{y:"点击UV"}},this.uvctrChartSettings={labelMap:{y:"UVCTR"}},this.uvctrHourChartSettings={labelMap:{y:"UVCTR"}},{oneOption:"2",loading:!1,loadingText:"",showAffix:!0,UVCTR:{value:"",dailyGrowth:"",weeklyGrowth:""},tabUVCTR:{value:"",dailyGrowth:"",weeklyGrowth:""},tabUVCTRPercent:{value:"N/A",dailyGrowth:"N/A",weeklyGrowth:"N/A"},clickUvChartData:{title:"",columns:["x","y"],rows:[],unit:""},uvctrChartData:{title:"",columns:["x","y"],rows:[],unit:""},uvctrHourChartData:{title:"",columns:["x","y"],rows:[],unit:""},clickUvChartExtend:Object.assign({},n),uvctrChartExtend:Object.assign({},n),uvctrHourChartExtend:Object.assign({},n),mode:"create",activePage:"tab_info",scrollTop:0,panelPreview:{panel:null,id:void 0,version:void 0,initMode:void 0,initGroupIndex:void 0,initBlockIndex:void 0},recommendStreamSignOptions:[],recommendStreamSignPanelCount:"-",resourceName:"版面",embedTab:void 0,isCollapseBase:!1,isCollapseExtend:!1,isCollapseSpec:!1,isCollapseCustom:!1,isCollapseData:!0,isPanelDragging:!1,STATUS:t,STATUS_TEXT:a,urls:{save:"/tab/save.html",historyList:"/v1/hvi/historyList.html"},showIconSelector:!1,showFloatWindowSelector:!1,showBgSelector:!1,showLongBgSelector:!1,showPanelSelector:!1,showCrowdSelector:!1,SOURCE:[{label:"腾讯",value:"o_tencent"},{label:"爱奇艺",value:"o_iqiyi"},{label:"优酷",value:"o_youku"}],TAB_TYPES:[{label:"普通版面",value:1},{label:"专题版面",value:2},{label:"分页专题",value:13}],panelListIndexed:{},vipEnums:[],vipEnumsData:[],activeBlockIndex:void 0,blocksToExchange:[],blockExchangeHistory:[],panelsModified:[],tabInfo:{tabId:void 0,currentVersion:void 0,tabParentType:"home",tabType:1,hasSubTab:0,flagIsBlockBg:0,tabName:void 0,tabCnTitle:void 0,tabEnTitle:void 0,tabCategory:67,tabAppid:-1,tabResource:"o_tencent",iconTypeName:void 0,pictureName:void 0,tabParams:{},tabStatus:void 0,tabOnclick:void 0,systemDefault:0,timeCycle:120,cornerIconName:void 0,flagIsRecord:0,isTiming:0,releaseTime:void 0,refreshTimeList:[void 0,void 0,void 0],tabExtArr:{},pannelList:[],tabList:[],sinkSize:0,isShowvip:1,alumbTabBg:void 0,alumbTabLongBg:void 0,panelTitleColor:void 0,blockTitleFocusColor:void 0,blockTitleUnfocusColor:void 0,collectImg:void 0,activityFloatWindow:void 0,imgOnBlur:void 0,imgOnFocus:void 0,imgOnSelected:void 0,vipButtonSourceId:void 0,panelRecommendConfig:{enableRecommend:0,recommendSign:"",recommendIndex:void 0,panelInfoList:[]},blockLineFocusColor:void 0,blockFieldFocusColor:void 0,minHomepageVersion:"",params:{},tabPluginInfo:{}},versionList:[],panelNormalDuplicates:{},panelSpecDuplicates:{},subTabTableHeader:[{label:"版面ID",prop:"tabId",width:180},{label:"版面名称",prop:"tabName",render:function(t,a){var n=a.$index,i=a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handlePreviewTab(i,i.currentVersion,n)}}},i.tabName)}},{label:"待审核副本",width:120,render:function(t,a){var n=a.$index,i=a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handlePreviewTab(i,i.duplicateVersion,n)}}},i.duplicateVersion)}}],panelRecommendHeader:[{label:"版块ID",prop:"pannelGroupId"},{label:"版块名称",prop:"pannelName"}]}},props:["id","version","init-mode"],computed:{resourceInfo:function(){var e,t=this.tabInfo;return t.tabId&&(e={id:t.tabId,version:t.currentVersion,status:t.tabStatus,type:"tab",menuElId:"tabInfo"}),e},floatWindowParams:function(){var e={o_tencent:"0,1",o_iqiyi:"0,2",o_youku:"0,3"};return{sourceArray:e[this.tabInfo.tabResource]||"0"}},isReplicate:function(){return"replicate"===this.mode||"yes"===this.tabInfo.duplicateVersion},rules:function(){return{tabName:[{required:!0,message:"请输入版面名称",trigger:"blur"},{max:45,message:"不超过 45 个字符"}],tabCnTitle:[{required:!0,message:"请输入中文标题",trigger:"blur"},{max:45,message:"不超过 45 个字符"}],tabEnTitle:[{required:!0,message:"请输入英文标题",trigger:"blur"},{max:45,message:"不超过 45 个字符"}],pictureName:[{required:!0,message:"请选择Tab对应的icon",trigger:"blur"}],alumbTabBg:[{required:!0,message:"请设置大背景",trigger:"blur"}]}},showSystemDefault:function(){var e=this.tabInfo.tabCategory;return 60===e||61===e||66===e},hasSource:function(){var e=this.tabInfo.tabCategory;return 67==e||31==e},disableAppId:function(){return-1!==+s(this.tabInfo.tabCategory)},couldSetReleaseTime:function(){var e=this.mode,t=this.tabInfo.currentVersion,a="create"===e||"copy"===e,n="edit"===e&&"V1"===t,i="10"===this.$consts.idPrefix;return i&&!(a||n)},canForceRefresh:function(){var e=this.tabInfo,t=2===e.tabType;return!t},showExchangeTool:function(){return!0}},watch:{"tabInfo.tabResource":"getVipButtonSource"},activated:function(){this.resetAffix()},methods:{handleSelectBgPicEnd:function(e){this.contentForm.bgImgUrl=e.pictureUrl},resetAffix:function(){var e=this;this.showAffix=!1,this.$nextTick(function(){e.showAffix=!0})},handleRemoveBlock:function(e){var t=this.blocksToExchange;if("object"===Object(o["a"])(e)){var a=e;e=t.findIndex(function(e){return e.panelGroupId===a.panelGroupId&&e.groupIndex===a.groupIndex&&e.blockIndex===a.blockIndex})}if(e>=0){var n=this.activeBlockIndex;this.activeBlockIndex=e>n?n:n===e?0:n-1,t.splice(e,1)}},handleRemoveBlockByPanelGroupId:function(e){var t=this;this.blocksToExchange.forEach(function(a){a.panelGroupId===e&&t.handleRemoveBlock(a)})},handleCopyBlock:function(e){var t=e.panelGroupId,a=e.groupIndex,n=e.blockIndex,i=this.blocksToExchange,r="".concat(t,"-").concat(a,"-").concat(n),o={key:r,panelGroupId:t,groupIndex:a,blockIndex:n},l=i.findIndex(function(e){return e.key===r});l>-1?this.activeBlockIndex=l:(i.unshift(o),this.activeBlockIndex=0)},handleExchangeBlock:function(e){var t=this.activeBlockIndex,a=this.blocksToExchange,n=a[t];if(!n)return this.$message.error("请先选择要交换的推荐位");var i=this.doExchangeBlock(e,n);if(i){var r=this.panelsModified||[],o=e.panelGroupId,l=n.panelGroupId;r.push(o),r.push(l),this.blockExchangeHistory.push({blockA:e,blockB:n}),this.handleRemoveBlock(e),this.handleRemoveBlock(n)}},doExchangeBlock:function(e,t){var a=this.panelListIndexed,n="".concat(e.panelGroupId,"-").concat(e.groupIndex,"-").concat(e.blockIndex),i="".concat(t.panelGroupId,"-").concat(t.groupIndex,"-").concat(t.blockIndex);if(n===i)return this.$message.error("复制的推荐位与交换的推荐位是同一个推荐位"),!1;var r=a[e.panelGroupId].panelList[e.groupIndex],o=a[t.panelGroupId].panelList[t.groupIndex],l=r.blocks[e.blockIndex],s=o.blocks[t.blockIndex],c=l.videoContentList.some(function(e){return 1===e.flagSetRec}),u=s.videoContentList.some(function(e){return 1===e.flagSetRec});if(c||u){var d=l.contentPosition,p=s.contentPosition,h=d.width+"*"+d.height,m=p.width+"*"+p.height;if(h!==m){var f=c?"交换的推荐位设置了推荐流":"复制的推荐位设置了推荐流";return this.$message.error("交换失败, ".concat(f,", 两个推荐位的尺寸不一致")),!1}}var v=l.videoContentList;l.videoContentList=s.videoContentList.slice(),s.videoContentList=v.slice();var g=l.specificContentList;l.specificContentList=s.specificContentList.slice(),s.specificContentList=g.slice(),r.blocks=r.blocks.slice(),o.blocks=o.blocks.slice();var b=it[e.panelGroupId].pannelList[e.groupIndex].contentList[e.blockIndex],y=it[t.panelGroupId].pannelList[t.groupIndex].contentList[t.blockIndex],w=b.videoContentList;b.videoContentList=y.videoContentList.slice(),y.videoContentList=w.slice();var I=b.specificContentList;return b.specificContentList=y.specificContentList.slice(),y.specificContentList=I.slice(),!0},handleSubmitBlockExchange:function(){var e=this;this.clearBlockExchangeHistory(),this.panelsModified=Object(We["uniq"])(this.panelsModified),this.doSubmitBlockExchange().then(function(){e.loading=!1})},doSubmitBlockExchange:function(){var e=this,t=this.panelListIndexed,a=this.panelsModified,n=a[0];if(n){this.loading=!0,this.loadingText="正在提交推荐位移动, 当前版块 ".concat(n,", 还有 ").concat(a.length-1," 个待提交...");var i=Object(We["cloneDeep"])(it[n]),r=this.STATUS;return i.pannelList[0].pannelStatus===r.accepted&&(i.currentVersion="",i.pannelList.forEach(function(e){e.pannelStatus=r.draft})),this.$service.panelUpsertSilent(i).then(function(){return e.panelsModified=a.filter(function(e){return e!==n}),e.$message.success("版块 ".concat(n," 提交成功")),e.updatePanelVersion(t[n],function(){e.loadPanelDetail(t[n])}),e.doSubmitBlockExchange()}).catch(function(){e.loading=!1,e.$message.error("版块 ".concat(n," 提交出现错误，请重新提交"))})}return Promise.resolve()},handleRevertBlockExchange:function(){var e=this.panelsModified,t=this.blockExchangeHistory;if(t.length>0){this.panelsModified=e.slice(0,e.length-2);var a=t.pop();this.doExchangeBlock(a.blockB,a.blockA)}},clearBlockExchangeState:function(){this.panelsModified=[],this.blocksToExchange=[],this.clearBlockExchangeHistory()},clearBlockExchangeHistory:function(){this.blockExchangeHistory=[]},handleLazyInit:function(e){var t=this.panelListIndexed[e.id];this.loadPanelDetail(t)},handleInputChange:function(e){this.tabInfo.collectImg=""},handleInputTabType:function(e){var t=this;(2===e||13===e||1===e&&2!==this.tabInfo.tabType)&&(this.tabInfo.refreshTimeList=[],this.tabInfo.tabType=e),1===e&&this.$confirm("切换到普通版面将清空含有VIP二维码推荐位和视频播放推荐位的版块，是否切换？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=t.tabInfo.pannelList,n=[],i=a.filter(function(e){var a=e.panel.id,i=(t.panelListIndexed[a].pluginTypes||"").split(","),r=-1!==i.indexOf("REFERENCE_PLAY_VIDEO")||-1!==i.indexOf("REFERENCE_VIP_QRCODE");return r&&n.push(a),r});i.forEach(function(e){var n=a.indexOf(e);t.doRemovePanel(n)}),t.updateDuplicates(),t.panelsModified=t.panelsModified.filter(function(e){return!n.includes(e)}),t.clearBlockExchangeHistory(),t.tabInfo.tabType=e}).catch(function(e){return console.log(e)})},toPercent:function(e){return Math.round(1e4*e)/100+"%"},toArrowPercent:function(e){var t=this.toPercent(Math.abs(e));return t+(e>0?" ↑":" ↓")},parseMinToStr:function(e){var t=Math.floor(e/60),a=e%60,n=t>9?""+t:"0"+t,i=a>9?""+a:"0"+a;return n+":"+i},handleDragStart:function(){var e=this;setTimeout(function(){e.isPanelDragging=!0})},handleDragEnd:function(){setTimeout(function(){this.isPanelDragging=!1}.bind(this))},handleCreateTab:function(){this.activePage="tab",this.embedTab={mode:"create"}},handleOpenPanel:function(){console.log(arguments)},handleShowAllPanels:function(e){this.$set(this.tabInfo.pannelList[e],"isShowAll",!0)},handleTogglePanelType:function(e){var t=this.tabInfo.pannelList,a=t[e];if("SPEC"===a.type){var n=a.crowdPanels[0];n.dmpInfo=void 0,this.$set(t,e,{type:"NORMAL",panel:n,isCollapse:a.isCollapse}),this.updateDuplicates()}else this.selectCrowdCallback=function(n){a.panel.dmpInfo=n,this.$set(t,e,{type:"SPEC",crowdPanels:[a.panel],isShowAll:!1,isCollapse:a.isCollapse}),this.updateDuplicates(),this.$sendEvent({type:"create_panel_dmp",payload:{tab_id:this.tabInfo.tabId||"new"}})},this.selectCrowdForIndex=e,this.handleSelectCrowdStart()},handleToggleAllPanel:function(e){this.tabInfo.pannelList.forEach(function(t){this.$set(t,"isCollapse",e)}.bind(this))},handleChangeTabCategory:function(e){var t=this.tabInfo,a=t.tabCategory,n=[67,31].indexOf(a)>-1,i=[67,31].indexOf(e)>-1,r=!n&&i,o=function(){i?""===t.tabResource&&(t.tabResource="o_tencent"):t.tabResource="",60!==e&&61!==e&&66!==e&&(t.systemDefault=0),t.tabAppid=+s(e),t.tabCategory=e,r&&this.clearContents()}.bind(this);r?this.$confirm("是否要切换业务分类，从不分源分类切换到分源分类之后所选择的版块或二级版面数据将会清除掉?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(o).catch(function(){}):o()},handlePreviewPanel:function(e){var t=e.panelId,a=this.panelsModified.includes(t);if(a)return this.$message.warning("该版块有未提交的推荐位移动，请先提交推荐位移动");var n=this.panelListIndexed[e.panelId],i=n.duplicateVersion||n.currentVersion,r=this.panelListIndexed[e.panelId],o=r.pannelList[0].fillType;this.activePage="panel_preview",this.panelPreview={panel:n,initMode:"read",id:n.pannelGroupId,dataType:n.pannelType,parentType:n.parentType,version:i,fillType:o}},handlePreviewPanelEnd:function(){var e=this.panelPreview.panel;this.updatePanelVersion(e,function(){this.loadPanelDetail(e)}.bind(this)),this.panelPreview=null,this.activePage="tab_info"},handleClickBlock:function(e){var t=this.$consts.idPrefix,a=e.index,n=e.crowdIndex,i=e.activeIndex,r=e.blockIndex,o=this.getPanelByIndex(a,n),l=this.panelListIndexed[o.id],s=l.pannelStatus,c=l.panelGroupType,u=this.STATUS,d=l.pannelGroupId,p=this.panelsModified.includes(d);if(p)return this.$message.warning("该版块有未提交的推荐位移动，请先提交推荐位移动");var h="11"===t,m=l.duplicateVersion||l.currentVersion,f=l.pannelList[0].fillType,v={panel:l,dataType:l.pannelType,parentType:l.parentType,initMode:"read",id:l.pannelGroupId,version:m,initGroupIndex:void 0,initBlockIndex:void 0,fillType:f};switch(!0){case h&&0===l.pannelGroupId.toString().indexOf(10):break;case 12===c:v.initGroupIndex=i,v.initBlockIndex=r;break;case s===u.draft:v.initMode="edit",v.initGroupIndex=i,v.initBlockIndex=r;break;case s===u.accepted:v.initMode="replicate",v.initGroupIndex=i,v.initBlockIndex=r;break;case s===u.waiting:break}this.panelPreview=v,this.activePage="panel_preview"},handleChangeSource:function(e){this.$confirm("是否要切换内容源，切换内容源之后所选择的版块或二级版面数据将会清除掉！","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){this.tabInfo.tabResource=e,this.resetPanelRecommendConfig(),this.clearContents()}.bind(this)).catch(function(e){throw e})},clearContents:function(){var e=this.$refs.tabSelector;this.tabInfo.vipButtonSourceId=void 0,this.tabInfo.tabList=[],e&&e.handleRemoteSelectClear(),this.tabInfo.pannelList=[],this.clearBlockExchangeState()},handleClose:function(){},handleSelectTitleIcon:function(e,t){this.tabInfo[e]=t.pictureUrl},handleSelectIconStart:function(){this.showIconSelector=!0},handleSelectIconCancel:function(){this.showIconSelector=!1},handleSelectIconEnd:function(e){this.showIconSelector=!1,this.tabInfo.pictureName=e.pictureName,this.tabInfo.iconTypeName=e.iconTypeName,this.tabInfo.pictureUrl=e.pictureUrl},handleSelectFloatWindowEnd:function(e){this.showFloatWindowSelector=!1,this.tabInfo.activityFloatWindow={pluginId:e.pluginId,pluginName:e.pluginName,pluginType:e.pluginType}},handleRemoveFloatWindow:function(){this.tabInfo.activityFloatWindow=void 0},handleSelectBgStart:function(){this.showBgSelector=!0},handleSelectBgCancel:function(){this.showBgSelector=!1},handleSelectBgEnd:function(e){this.showBgSelector=!1,this.tabInfo.alumbTabBg=e.pictureUrl},handleSelectCollectImgEnd:function(e){this.showBgSelector=!1,this.tabInfo.collectImg=e.pictureUrl},handleSelectLongBgStart:function(){this.showLongBgSelector=!0},handleSelectLongBgCancel:function(){this.showLongBgSelector=!1},handleSelectLongBgEnd:function(e){this.showLongBgSelector=!1,this.tabInfo.alumbTabLongBg=e.pictureUrl},handleSelectCrowdStart:function(){this.showCrowdSelector=!0},handleSelectCrowdCancel:function(){this.showCrowdSelector=!1},handleSelectCrowdEnd:function(e,t){var a={crowdId:t.value,crowdName:t.label,policyId:e.value,policyName:e.label},n=this.selectCrowdForIndex,i=this.tabInfo.pannelList[n];if(void 0!==n&&"SPEC"===i.type){var r=i.crowdPanels,o=r.length;while(--o>=0)if(r[o].dmpInfo.crowdId===a.crowdId)break;if(o>=0)return this.$message({type:"error",message:"该定向版块组第"+(o+1)+"个版块已选择该人群"})}this.selectCrowdCallback(a),this.showCrowdSelector=!1,this.selectCrowdCallback=void 0},handleChangeCrowdOfPanel:function(e,t){this.selectCrowdCallback=function(a){this.tabInfo.pannelList[e].crowdPanels[t].dmpInfo=a},this.selectCrowdForIndex=e,this.handleSelectCrowdStart()},handleSelectPanelEnd:function(e){var t=this.tabInfo.pannelList,a=t.length-1;e.forEach(function(e,t){this.doInsertPanel(e,{index:a+t,type:"NORMAL"})}.bind(this)),this.showPanelSelector=!1,this.$refs.virtualTab.isDragging=!1},handleInsertPanel:function(e,t){"NORMAL"===t.type||e.dmpInfo?this.doInsertPanel(e,t):(this.selectCrowdCallback=function(a){e.dmpInfo=a,this.doInsertPanel(e,t)},this.selectCrowdForIndex=t.index,this.handleSelectCrowdStart())},handleChangeCollapseState:function(e){var t=this.tabInfo.pannelList[e];this.$set(t,"isCollapse",!t.isCollapse)},doInsertPanel:function(e,t){var a=e.pannelGroupId,n=e.dmpInfo,i=t.type,r=t.index,o=t.crowdIndex,l=this.tabInfo.pannelList;if("NORMAL"===i){var s={type:i,panel:{id:a,isDuplicate:!1,activeIndex:0,dmpInfo:void 0},isCollapse:!1};l.splice(r+1,0,s)}else{var c=l[r];c.crowdPanels.splice(o+1,0,{id:a,isDuplicate:!1,activeIndex:0,dmpInfo:n})}this.$set(this.panelListIndexed,e.pannelGroupId,e),this.updateDuplicates()},loadPanelDetail:function(e,t){var a=this,n=e.pannelGroupId,i=e.duplicateVersion||e.currentVersion;this.$service.panelGetDetailSilence({id:n,version:i}).then(function(t){if(t.pannelGroupId){it[t.pannelGroupId]=Object(We["cloneDeep"])(t);var i=t.pannelList||[],o=i.map(function(e){return{panelTitle:e.pannelTitle,blocks:"function"===t.parentType||"tag"===t.parentType?[]:this.getPanelBlocks(e)}}.bind(a));delete t.currentVersion,delete t.duplicateVersion,a.panelListIndexed[n]=Object(r["a"])({},e,t,{panelList:o,pannelStatus:t.pannelList[0].pannelStatus})}})},updatePanelVersion:function(e,t){var a=this;this.$service.panelPageList({pannelType:e.pannelType,pannelId:e.pannelGroupId}).then(function(n){var i=n.rows[0];e.lastUpdateDate!==i.lastUpdateDate&&a.handleRemoveBlockByPanelGroupId(e.pannelGroupId),e.currentVersion=i.currentVersion,e.duplicateVersion=i.duplicateVersion,t()})},handleReOrderPanel:function(e,t){var a=e.type,n=e.index,i=e.crowdIndex,r=t.type,o=t.index,l=t.crowdIndex,s=this.tabInfo.pannelList,c=s[n];switch(!0){case"SPEC"===a&&"NORMAL"===r:this.doRemovePanel(n);var u=n<=o?o:o+1;s.splice(u,0,c);break;case"SPEC"===a&&"CROWD"===r:this.$message({type:"error",message:"定向版块组不能拖到别的定向版块组里边"});break;case"CROWD"===a&&"NORMAL"===r:var d={type:"SPEC",crowdPanels:[c.crowdPanels[i]]};1===c.crowdPanels.length?(this.doRemovePanel(n,i),s.splice(n<=o?Math.max(o,0):o+1,0,d)):(this.doRemovePanel(n,i),s.splice(o+1,0,d));break;case"CROWD"===a&&"CROWD"===r:var p=s[n].crowdPanels,h=s[o].crowdPanels,m=p[i];if(n===o)h.splice(i,1),h.splice(i<=l?l:l+1,0,m);else{var f=h.length;while(--f>=0)if(h[f].dmpInfo.crowdId===m.dmpInfo.crowdId)break;if(f>=0)return this.$message({type:"error",message:"该定向版块组第"+(f+1)+"个版块已选择该人群"});h.splice(l+1,0,m),this.doRemovePanel(n,i)}break;case"NORMAL"===a&&"NORMAL"===r:this.doRemovePanel(n),s.splice(n<=o?o:o+1,0,c);break;case"NORMAL"===a&&"CROWD"===r:this.selectCrowdCallback=function(e){this.$set(c.panel,"dmpInfo",e),s[o].crowdPanels.splice(l+1,0,c.panel),this.doRemovePanel(n),this.updateDuplicates()},this.selectCrowdForIndex=o,this.handleSelectCrowdStart();break}},getPanelIdByIndex:function(e,t){return this.getPanelByIndex(e,t).id},getPanelByIndex:function(e,t){var a,n=this.tabInfo.pannelList;return a=void 0!==t?n[e].crowdPanels[t]:n[e].panel,a},handleRemovePanel:function(e,t){var a,n,i=this.tabInfo.pannelList,r=i[e];if(void 0===t&&"SPEC"===r.type){var o=this.getPanelIdByIndex(e,0),l=this.panelListIndexed[o];a="是否确定删除版块组 "+(l.pannelName||l.pannelGroupRemark),n=r.crowdPanels.map(function(e){return e.id})}else{var s=this.getPanelIdByIndex(e,t),c=this.panelListIndexed[s];a="是否确定删除版块 "+(c.pannelName||c.pannelGroupRemark),n=[s]}this.$confirm(a).then(function(){this.doRemovePanel(e,t),this.updateDuplicates(),this.panelsModified=this.panelsModified.filter(function(e){return!n.includes(e)}),this.clearBlockExchangeHistory()}.bind(this)).catch(function(){})},doRemovePanel:function(e,t){var a=this.tabInfo.pannelList;if(void 0!==t){var n=a[e].crowdPanels;n.splice(t,1),0===n.length&&a.splice(e,1)}else a.splice(e,1)},getPanelBlocks:function(e){e=JSON.parse(JSON.stringify(e));var t=e.parentType,a=JSON.parse(e.layoutInfo.layoutJson8),n=a.type,i=a.contents,r=i.length,o=i.length,l=e.contentList,s=i[r-1],c=s.x+s.width,u=s.resize||{},d=s.y+(u.height||s.height),p=function(){if("Expander"===n&&2===r){var e=a.extra.space;return function(t){var a=i[1],n=a.resize,r=a.title_info,o=c+(t-2)*e+(t-3)*a.width,l=a.y,s={height:a.height,width:a.width,x:o,y:l,isExtra:!0,title_info:r,loop:a.loop,type:a.type};return r&&n&&(s.resize={height:n.height,width:n.width,x:o,y:l}),s}}if("Expander"===n){var t=a.extra.space;return function(e){var a=Math.floor(e/r)-1,n=e%r,o=i[n],l=o.resize,s=o.title_info,u=o.x+a*c+a*t,d=o.y,p={height:o.height,width:o.width,x:u,y:d,isExtra:!0,title_info:s,loop:o.loop,type:o.type};return s&&l&&(p.resize={height:l.height,width:l.width,x:u,y:d}),p}}if("Lengthwise"===n){var o=0;return function(e){var t=Math.ceil(e/r)-1,a=e-r*t-1,n=i[a],l=n.resize,s=n.title_info,c=n.x,u=n.y+t*d+t*o,p={height:n.height,width:n.width,x:c,y:u,isExtra:!0,title_info:s};return s&&l&&(p.resize={height:l.height,width:l.width,x:c,y:u}),p}}};if("Expander"===n||"Lengthwise"===n){var h=p(),m="group"===t?o:Math.max(o,l.length),f=i.length;while(f++<m)i.push(h(f))}var v=i.map(function(e,t){var a=l[t]||{},n=a.videoContentList||[];return a.videoContentList=n,a.contentPosition=Object.assign({},e,{resize:void 0}),a.titleInfo=e.title_info,a.resize=e.resize,a});return v},updateDuplicates:function(){var e=this.tabInfo.pannelList,t={},a={},n={},i={};e.forEach(function(e,r){if("NORMAL"===e.type){var o=e.panel,l=o.id;n[l]?t[l]=!0:n[l]=!0,i[l]&&(i[l].forEach(function(e){a[e]=a[e]||{},a[e][l]=!0}),t[l]=!0)}else{var s=e.crowdPanels,c={},u=a[r]||{};s.forEach(function(e,a){var r=e,o=r.id;c[o]?u[o]=!0:c[o]=!0,i[o]=i[o]||[],i[o].push(a),n[o]&&(u[o]=!0,t[o]=!0)}),a[r]=u}}),console.log(t),console.log(a),e.forEach(function(e,n){if("NORMAL"===e.type)t[e.panel.id+""]?e.panel.isDuplicate=!0:e.panel.isDuplicate=!1;else{var i=a[n]||{};e.crowdPanels.forEach(function(e){i[e.id+""]?e.isDuplicate=!0:e.isDuplicate=!1})}}),console.log("panelList",e)},handleSelectTabStart:function(){this.$nextTick(function(){var e=this.$refs.tabSelector;this.tabInfo.tabList.forEach(function(t){e.handleTableRowSelectionAdd(t)})}.bind(this))},handleSelectTabEnd:function(e){this.$refs.subTabTable.handleAppendData(e,"tabId")},handleChangePanelOrder:function(e,t){var a=t-1,n=e,i=this.tabInfo.pannelList,r=i[n];i.splice(n,1),this.tabInfo.pannelList=[].concat(i.slice(0,a),r,i.slice(a))},openTabWin:function(e){var t=this.basicFn.numToPannelTypeUrl(e)+"/add.html";this.FastDevTool.createDialogWin("add-view",{confirmInfo:!0,fit:!0,iconCls:"icon-edit",minimizable:!1,maximizable:!0,title:"版块页面",content:this.FastDevTool.createIframe(t)})},handleTabEmbedBack:function(){var e=this;this.activePage="tab_info";var t=this.embedTab,a=t.index,n=t.id;void 0!==a&&this.$service.tabInfoList({tabId:n}).then(function(t){Object.assign(e.tabInfo.tabList[a],t.rows[0])}),this.embedTab=void 0},handlePreviewTab:function(e,t,a){var n=this,i=e.tabId;this.$service.tabInfoGetBase({id:i}).then(function(e){var r=e.tabType,o=e.tabRemark;n.activePage="tab",n.embedTab={index:a,id:4===r?o:i,version:t,tabType:r,mode:"read"}})},handleShowTimeShelf:function(){var e=this.getFormData();e.tabStatus=this.STATUS.waiting,this.validateFormData(e,function(){this.showTimeShelf=!0}.bind(this))},handleCopy:function(e){var t=this.$consts.status;e===t.waiting?this.handleSubmitAudit():this.handleSaveDraft()},handleSaveDraft:function(){var e=this,t=this.getFormData();return t.isTiming=void 0,t.releaseTime=void 0,t.tabStatus=this.$consts.status.draft,t.tabPluginInfo.minHomepageVersion&&!/^\+?[1-9][0-9]*$/.test(t.tabPluginInfo.minHomepageVersion)?this.$message.error("插件主页最低版本只能输入数字"):t.tabPluginInfo.minHomepageVersion&&t.tabPluginInfo.minHomepageVersion.length<7?this.$message.error("插件主页最低版本不能少于7位数"):void this.validateFormData(t,function(){e.upsertTabInfo(t)})},handleSubmitAudit:function(e){var t=this,a=this.getFormData();return 13===a.tabType&&(a.hasSubTab=1),a.tabPluginInfo.minHomepageVersion&&!/^\+?[1-9][0-9]*$/.test(a.tabPluginInfo.minHomepageVersion)?this.$message.error("插件主页最低版本只能输入数字"):a.tabPluginInfo.minHomepageVersion&&a.tabPluginInfo.minHomepageVersion.length<7?this.$message.error("插件主页最低版本不能少于7位数"):(a.tabStatus=this.$consts.status.waiting,void this.validateFormData(a,function(){t.couldSetReleaseTime?e?(a.isTiming=e.isTiming,a.releaseTime=e.releaseTime,t.upsertTabInfo(a)):t.$refs.commonContent.showReleaseTimeSetter=!0:t.upsertTabInfo(a)}))},handleSelectRecommendPanelEnd:function(e){var t=(e||[]).map(function(e){return{pannelGroupId:e.panelGroupId,pannelName:e.panelGroupName}}),a=this.tabInfo.panelRecommendConfig.panelInfoList||[],n=a.reduce(function(e,t,a){return e[t.pannelGroupId]=a,e},{}),i=[];t.forEach(function(e){var t=n[e.pannelGroupId];void 0===t&&i.push(e)}),this.tabInfo.panelRecommendConfig.panelInfoList=a.concat(i)},getFormData:function(){var e=JSON.parse(JSON.stringify(this.tabInfo));console.log(e,"----getFormData---");var t=this.mode;return"replicate"===t&&(e.currentVersion=""),"copy"===t&&(e.tabId=void 0,e.currentVersion=""),e},validateFormData:function(e,t){var a,n=this.STATUS,i=e.tabStatus,r=e.panelRecommendConfig.enableRecommend,o=function(e){this.$message({type:"error",message:e})}.bind(this);if(i===n.draft){var l=["tabName"];r&&(l=l.concat(["panelRecommendConfig.recommendIndex","panelRecommendConfig.recommendSign"]));var s=l.length,c=!0,u=function(e){s--,e&&(c=!1),0===s&&(c?t():o("请把表单填写完整"))};this.$refs.tabForm.validateField(l,u)}else this.$refs.tabForm.validate(function(n){if(n){if(1===e.tabType&&1===e.hasSubTab)0===e.tabList.length&&(a="请选择二级版面");else if(1===e.tabType)0===e.pannelList.length&&(a="请选择版块");else{var i=e.pannelList;e:for(var r=0,l=i.length;r<l;r++){var s=i[r];if("NORMAL"===s.type){if(s.panel.isDuplicate){a="含有重复版块";break e}}else for(var c=s.crowdPanels,u=0,d=c.length;u<d;u++)if(c[u].isDuplicate){a="含有重复版块";break e}}}2===e.tabType&&e.alumbTabLongBg&&e.pannelList.length>6&&(a="长图专题版块不能超过6个");var p=e.panelRecommendConfig,h=e.pannelList.length;p.enableRecommend&&p.recommendIndex>h&&(a="推荐开始位置不能大于版面的版块数, 当前版块总数 ".concat(h));var m=e.refreshTimeList.filter(function(e){return e}),f=new Set(m);m.length>f.size&&(a="强制刷新时间点不能重复"),a?o(a):t()}else o("请把表单填写完整")})},parseTabInfo:function(e){for(var t=e.refreshTimeList.filter(function(e){return e}).map(function(e){return+new Date(e)}),a=[],n=e.pannelList,i=0,r=n.length;i<r;i++){var o=n[i],l=void 0;"NORMAL"===o.type?l={pannelGroupId:o.panel.id,pannelSequence:i,isDmpPanel:0}:(l={pannelSequence:i,isDmpPanel:1},l.dmpPanelList=o.crowdPanels.map(function(e,t){return{pannelGroupId:e.id,pannelSequence:t,dmpPolicyId:e.dmpInfo.policyId,dmpPolicyName:e.dmpInfo.policyName,dmpCrowdId:e.dmpInfo.crowdId,dmpCrowdName:e.dmpInfo.crowdName}})),a.push(l)}var s={selected_img_url:e.imgOnSelected,focus_img_url:e.imgOnFocus,unfocus_img_url:e.imgOnBlur};s=JSON.stringify(s);var c={isShowvip:e.isShowvip,alumbTabBg:e.alumbTabBg,alumbTabLongBg:e.alumbTabLongBg,sinkSize:e.sinkSize,panelTitleColor:e.panelTitleColor,blockTitleFocusColor:e.blockTitleFocusColor,blockTitleUnfocusColor:e.blockTitleUnfocusColor,blockLineFocusColor:e.blockLineFocusColor,blockFieldFocusColor:e.blockFieldFocusColor,flagIsBlockBg:e.flagIsBlockBg,collectImg:e.collectImg},u=e.vipButtonSourceId;if(u){var d=this.getVipButtonSourceItem(u);c.vipButtonSourceId=u,c.vipButtonSourceName=d.sourceName,c.vipButtonSourceSign=d.sourceSign}var p={};p=JSON.stringify(p);var h,m=[],f=e.activityFloatWindow;f&&m.push({pluginId:f.pluginId,pluginType:f.pluginType}),e.hasSubTab&&e.tabList.length>0&&(h=e.tabList.map(function(e,t){return{subTabId:e.tabId,subSequence:t}}),h=JSON.stringify(h));var v=e.panelRecommendConfig;v.enableRecommend?v.panelInfoList=v.panelInfoList.map(function(e,t){return{panelRecommendConfig:t,pannelGroupId:e.pannelGroupId}}):v={enableRecommend:0,recommendSign:"",recommendIndex:1,panelInfoList:[]};var g={cornerIconName:e.cornerIconName,currentVersion:e.currentVersion,flagIsRecord:e.flagIsRecord,hasSubTab:e.hasSubTab,isTiming:e.isTiming,panelInfoList:a,pictureName:e.pictureName,releaseTime:e.releaseTime,refreshTimeList:t,systemDefault:e.systemDefault||0,systemPluginList:m,tabAppid:e.tabAppid,tabCategory:e.tabCategory,tabCnTitle:e.tabCnTitle,tabEnTitle:e.tabEnTitle,tabExtArr:c,tabId:e.tabId,tabJson:h,tabName:e.tabName,tabOnclick:e.tabOnclick,tabParams:p,tabParentType:e.tabParentType,tabResource:e.tabResource,tabStatus:e.tabStatus,tabTitleIcons:s,tabType:e.tabType,timeCycle:e.timeCycle,panelRecommendConfig:v,tabPluginInfo:e.tabPluginInfo};return g},setTabInfo:function(e){var t,a=this.tabInfo,n=JSON.parse(e.tabTitleIcons||"{}"),i=e.tabExtArr||e.tabExtArrEntity||{},r=e.systemPluginList||[],o=r[0];o&&(t={pluginId:o.pluginId,pluginName:o.pluginName,pluginType:o.pluginType});var l=[];if(e.panelInfoList){var s=[];l=e.panelInfoList.map(function(e){return e.isDmpPanel?{type:"SPEC",isCollapse:!1,isShowAll:!1,crowdPanels:e.dmpPanelList.map(function(e){return this.$set(this.panelListIndexed,e.pannelGroupId,e),s.push(e),{id:e.pannelGroupId,isDuplicate:!1,activeIndex:0,dmpInfo:{crowdId:e.dmpCrowdId,policyId:e.dmpPolicyId,crowdName:e.dmpCrowdName,policyName:e.dmpPolicyName}}}.bind(this))}:(this.$set(this.panelListIndexed,e.pannelGroupId,e),s.push(e),{type:"NORMAL",isCollapse:!1,panel:{id:e.pannelGroupId,isDuplicate:!1,activeIndex:0,dmpInfo:void 0}})}.bind(this))}var c=e.refreshTimeList||[],u=Array.apply(null,{length:3}).map(function(e,t){var a=c[t];if(a)return new Date(a)}),d=e.tabPluginInfo||{},p=d.packagename,h=d.category,m=d.minHomepageVersion,f=d.params,v={packagename:p,category:h,minHomepageVersion:m,params:f?JSON.parse(f):[]};this.tabInfo.tabPluginInfo=v;var g=e.panelRecommendConfig?e.panelRecommendConfig:a.panelRecommendConfig;g.panelInfoList=g.panelInfoList||[],this.tabInfo=Object.assign({},a,{tabId:e.tabId,currentVersion:e.currentVersion,tabParentType:e.tabParentType,tabType:e.tabType,hasSubTab:e.hasSubTab,flagIsBlockBg:i.flagIsBlockBg,tabName:e.tabName,tabCnTitle:e.tabCnTitle,tabEnTitle:e.tabEnTitle,tabCategory:e.tabCategory,tabAppid:e.tabAppid,tabResource:e.tabResource,iconTypeName:e.iconTypeName,pictureName:e.pictureName,tabStatus:e.tabStatus,tabOnclick:void 0,systemDefault:e.systemDefault,timeCycle:e.timeCycle,cornerIconName:e.cornerIconName,flagIsRecord:e.flagIsRecord,isTiming:e.isTiming,releaseTime:e.releaseTime,refreshTimeList:u,pannelList:l,tabList:e.tabList,alumbTabBg:i.alumbTabBg,alumbTabLongBg:i.alumbTabLongBg,isShowvip:i.isShowvip,panelTitleColor:i.panelTitleColor,blockTitleFocusColor:i.blockTitleFocusColor,blockTitleUnfocusColor:i.blockTitleUnfocusColor,blockLineFocusColor:i.blockLineFocusColor,blockFieldFocusColor:i.blockFieldFocusColor,collectImg:i.collectImg,sinkSize:i.sinkSize,activityFloatWindow:t,imgOnBlur:n.unfocus_img_url,imgOnFocus:n.focus_img_url,imgOnSelected:n.selected_img_url,vipButtonSourceId:i.vipButtonSourceId,panelRecommendConfig:g,duplicateVersion:e.duplicateVersion,tabPluginInfo:this.tabInfo.tabPluginInfo}),this.updateDuplicates(),this.setRecommendStreamSignPanelCount()},upsertTabInfo:function(e){var t=this,a=function(){var a=t.parseTabInfo(e);console.log(e,"---提交成功"),t.$service.tabInfoUpsert(a,"操作成功").then(function(){t.$emit("upsert-end")})};this.doSubmitBlockExchange().then(a)},fetchData:function(e){var t=this;this.$service.tabInfoGet({id:this.id,version:e}).then(function(e){t.setTabInfo(e),t.clearBlockExchangeState(),t.$refs.virtualTab.refresh()})},getSimpleBrowseData:function(){var e=this;this.$service.getTabSimpleBrowseData({id:this.id}).then(function(t){var a=t.rows[0].data[0]?t.rows[0].data[0].uvctr:"N/A";e.tabUVCTR=a,e.tabUVCTRPercent.dailyGrowth=a.dailyGrowth?e.toArrowPercent(a.dailyGrowth):"N/A",e.tabUVCTRPercent.weeklyGrowth=a.weeklyGrowth?e.toArrowPercent(a.weeklyGrowth):"N/A"})},getVipButtonSourceItem:function(e){var t=this.vipEnumsData.find(function(t){return t.sourceId===e});return t||{}},getVipButtonSource:function(){var e=this,t=null,a=this.tabInfo.tabResource;a&&(t={source:a}),this.$service.getVipButtonSource(t).then(function(t){e.vipEnumsData=t,e.vipEnums=t.map(function(e){return{value:e.sourceId,label:e.sourceName}})})},handleModeChange:function(e){"edit"!==e&&"copy"!==e&&"replicate"!==e||(this.isCollapseBase=!0,this.clearBlockExchangeState())},handleInputRecommendFlag:function(e){this.tabInfo.panelRecommendConfig.enableRecommend=e?1:0},handleInputRecommendSign:function(e){var t=this.tabInfo.panelRecommendConfig;t.recommendSign=e,this.resetPanelRecommendConfig()},handleInputHasSubTab:function(e){this.tabInfo.hasSubTab=e?1:0,this.tabInfo.panelRecommendConfig.enableRecommend=0,this.clearBlockExchangeState()},setRecommendStreamSignPanelCount:function(){var e=this,t=this.tabInfo,a=t.panelRecommendConfig.recommendSign;this.recommendStreamSignPanelCount="-",a&&this.$service.panelRecommendList({source:t.tabResource,panelGroupCategory:a}).then(function(t){e.recommendStreamSignPanelCount=t.total})},resetPanelRecommendConfig:function(){var e=this.tabInfo.panelRecommendConfig;e.panelInfoList=[],e.recommendIndex=void 0,this.setRecommendStreamSignPanelCount()},equipChartStyle:function(){var e={axisLabel:{formatter:"{value}%"}};this.uvctrChartExtend.yAxis=e,this.uvctrHourChartExtend.yAxis=e},handleTabDataClick:function(){var e=this;this.isCollapseData=!this.isCollapseData,""===this.clickUvChartData.title&&this.$service.getTabChartData({id:this.id}).then(function(t){var a=t.rows;e.clickUvChartData.rows=a[0].data,e.clickUvChartData.title=a[0].title,e.clickUvChartData.unit=a[0].unit,e.uvctrChartData.rows=a[1].data,e.uvctrChartData.title=a[1].title,e.uvctrChartData.unit=a[1].unit,e.uvctrHourChartData.rows=a[2].data,e.uvctrHourChartData.title=a[2].title,e.uvctrHourChartData.unit=a[2].unit})}},created:function(){var e=this.initMode;this.mode=e,this.$watch("mode",this.handleModeChange,{immediate:!0}),this.id&&(this.fetchData(this.version),this.getSimpleBrowseData(),this.$sendEvent({type:"tab_show",payload:{tab_id:this.id}})),this.getVipButtonSource(),this.equipChartStyle()}},ot=rt,lt=(a("8924"),a("7ef0"),Object(I["a"])(ot,n,i,!1,null,"4a9a84af",null));t["a"]=lt.exports},"29b7":function(e,t,a){},"2b84":function(e,t,a){},"2bfb":function(e,t,a){},"2c71":function(e,t,a){"use strict";var n=a("f223"),i=a.n(n);i.a},"2da0":function(e,t,a){},"2df9":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("ActionList",{staticClass:"buttonGroup",attrs:{actions:e.actions,target:this}})],1)},i=[],r=(a("6762"),a("2fdb"),a("ac6a"),a("59c7")),o={components:{ActionList:r["ActionList"]},props:{pageName:String,notContainBtns:{type:Array,default:function(){return[]}}},data:function(){return{actions:{}}},methods:{add:function(){this.$emit("add")},edit:function(){this.$emit("edit")},delete:function(){this.$emit("delete")},batchAudit:function(){this.$emit("batch-audit")}},created:function(){var e=this;this.$service.getButtonGroupForPageList(this.pageName).then(function(t){var a={};t.filter(function(e){return"contentAuthSetting"!==e.runComm}).forEach(function(t){if(!e.notContainBtns.includes(t.runComm))switch(t.runComm){case"add":a[t.runComm]={text:t.runName,type:"primary"};break;case"edit":a[t.runComm]={text:t.runName,type:"success"};break;case"delete":a[t.runComm]={text:t.runName,type:"danger"};break;default:a[t.runComm]={text:t.runName,type:"primary"};break}}),e.actions=a})}},l=o,s=(a("ec2c"),a("2877")),c=Object(s["a"])(l,n,i,!1,null,"0572018b",null);t["a"]=c.exports},"2e70":function(e,t,a){"use strict";var n=a("4b58"),i=a.n(n);i.a},"30ee":function(e,t,a){},"30f7":function(e,t,a){},3125:function(e,t,a){"use strict";var n=a("545a"),i=a.n(n);i.a},3172:function(e,t,a){},"31b7":function(e,t,a){},"31c4":function(e,t,a){},3250:function(e,t,a){},3260:function(e,t,a){},"326e":function(e,t,a){},"32c2":function(e,t,a){"use strict";var n=a("d82b"),i=a.n(n);i.a},3354:function(e,t,a){"use strict";var n=a("a318"),i=a.n(n);i.a},3377:function(e,t,a){"use strict";var n=a("b59d"),i=a.n(n);i.a},3397:function(e,t,a){},"33c1":function(e,t,a){"use strict";var n=a("6aa1"),i=a.n(n);i.a},"33c9":function(e,t,a){},"363f":function(e,t,a){"use strict";var n={create:"创建",read:"预览",edit:"编辑",replicate:"",copy:"复制"};t["a"]={props:["titlePrefix"],computed:{title:function(){var e=this.mode,t=this.resourceName||"",a="replicate"===e?"创建".concat(t,"副本"):(n[e]||"")+t,i=this.titlePrefix;return i?"".concat(i," / ").concat(a):a}}}},3667:function(e,t,a){},3731:function(e,t,a){"use strict";var n=a("1faa"),i=a.n(n);i.a},"377a":function(e,t,a){},3830:function(e,t,a){"use strict";var n=a("dc91"),i=a.n(n);i.a},"38b6":function(e,t,a){"use strict";var n=a("efa1"),i=a.n(n);i.a},"38c9":function(e,t,a){"use strict";var n=a("e20e"),i=a.n(n);i.a},3912:function(e,t,a){"use strict";a("ac6a"),a("7514"),a("6b54");var n={homepage:{id:"homepageId",status:"homepageStatus"},panelInfo:{id:"pannelGroupId",status:"pannelStatus"},tabInfo:{id:"tabId",status:"tabStatus"},film:{id:"tabId",status:"tabStatus"},policy:{id:"policyId",status:"policyStatus"},broadcastBlock:{id:"id",status:"status"},blockInfo:{id:"pluginId",status:"pluginStatus"},sysPlugin:{id:"pluginId",status:"pluginStatus"},picture:{id:"pictureId",status:"pictureStatus"},layout:{id:"layoutId",status:"layoutStatus"},cornerIcon:{id:"cornerIconId",status:"cornerStatus"},cornerIconType:{id:"typeId",status:"typeStatus"},clickEvent:{id:"commonOnclickId",status:"commonOnclickStatus"},crowdRel:{id:"id"},topic:{id:"id",status:"status"},topicConfig:{id:"id",status:"status"},panelRecommend:{id:"panelGroupId"},deviceConfig:{id:"id"},policyGroup:{id:"id",status:"status"}};t["a"]={data:function(){return{resourceType:void 0}},watch:{"table.data":"clearSelected"},methods:{checkAction:function(e,t,a){a()},handleRead:function(e,t){var a=this;this.checkAction(e,"read",function(){a.$emit("read",e,t)})},handleCreate:function(){var e=this;this.checkAction(null,"create",function(){e.$emit("create")})},handleEdit:function(){var e=this,t=this.selected.length;if(0===t)return this.$message({type:"error",message:"未选中记录"});if(t>1)return this.$message({type:"error",message:"只能选择一条记录"});var a=this.selected[0],i=this.resourceType,r=this.$consts.idPrefix,o=n[i],l=a[o.id],s=a[o.status],c=this.$consts.status;this.checkAction(a,"edit",function(){if("tabInfo"===i&&4===a.tabType)return e.$message({type:"error",message:"第三方版面不能编辑"});if(-1===["clickEvent"].indexOf(i)&&l.toString().slice(0,2)!==r)return e.$message({type:"error",message:"无权限编辑该记录"});if(["crowdRel","panelRecommend"].indexOf(i)>-1)return e.$emit("edit",a);if(["sysPlugin","picture","layout","cornerIcon","cornerIconType","clickEvent"].indexOf(i)>-1){if(s===c.accepted)return e.$message({type:"error",message:"该状态不允许编辑"})}else if(s!==c.draft&&s!==c.rejected)return e.$message({type:"error",message:"该状态不允许编辑"});e.$emit("edit",a)})},handleDelete:function(){var e=this,t=this.resourceType,a=this.selected,n=a.length;if(0===n)return this.$message({type:"error",message:"未选中记录"});this.checkAction(a,"delete",function(){if("tabInfo"===t){var n=a.find(function(e){return 4===e.tabType});if(n)return e.$message({type:"error",message:"".concat(n.tabName," 为第三方版面，不能删除")})}e.$confirm("确认要删除选中对记录？").then(function(){e.$emit("delete",a)}).catch(function(){})})},handleCopy:function(e){var t=this,a=this.resourceType;this.checkAction(e,"copy",function(){if("tabInfo"===a&&4===e.tabType)return t.$message({type:"error",message:"第三方版面不能复制"});t.$emit("copy",e)})},handleRowSelectionAdd:function(e){this.selected.push(e),this.updateTableSelected()},handleRowSelectionRemove:function(e){var t=n[this.resourceType].id;this.selected=this.selected.filter(function(a){return a[t]!==e[t]}),this.updateTableSelected()},handleAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleRowSelectionAdd):(this.selected=[],this.table.selected=[])},handleAllRowSelectionRemove:function(){this.selected=[],this.table.selected=[]},updateTableSelected:function(){var e=n[this.resourceType].id,t=this.table,a=this.selected.reduce(function(t,a){return t[a[e]]=!0,t},{});t.selected=t.data.reduce(function(t,n,i){return a[n[e]]&&t.push(i),t},[])},clearSelected:function(){this.selected=[],this.table.selected=[],this.updateTableSelected()}}}},"394f":function(e,t,a){"use strict";var n=a("7704"),i=a.n(n);i.a},"3b78":function(e,t,a){"use strict";var n=a("bebe"),i=a.n(n);i.a},"3c39":function(e,t,a){"use strict";var n=a("8490"),i=a.n(n);i.a},"3c3a":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAF40lEQVR4Xu1bW2wUVRj+/tkCLZcKVdSd4iWKiYlQE0ChuyMRIQETjchDSZSdwQdDEA2KokaFYIpGMSgxEpQYdaclmhoDGo0xEQNxtihINEZ4MEAjsLMVA5RLobTd+c201ECxnd1zzgz7wLzu/13+b8+cPTPnLCHC62jj1HGdXlkNM1cxaVUEVIJxCoRjGuM4x+hAfMGPeyO0BApbrNWuGeGhch4zTCKeCVCQZguBvybwluvN5h/C9hdkRlj/RFNt1ekObSkBTwNUKUi0nTxeEl+Y2SOID4QpD4BXQWu91VjBjOUARgQ6CCpg9piwQS9vW0Z1ezqDyov9XGkAR5ruHdl1tnszEWYVayS4nnd53HX/OGvn0eDawiuUBfDPp0m9qxNbQXR74fLFVTLj0FBg1ljL+bM45MDVSgI41FRbEevQdgI0QZWxgXn4YHl5R01V3e4TKrSUBODaxmYAc1UYKoSDGd/rLc5sWgWvkPrBaqQDyKYTTxFp78oaKRbPzPXVVmZlsbj+9VIBtG0yxpzp5r9ANErWSLF4ZnQMQ378NdaObLHYC+ulAsimjfVEeELGgBSWuVG3MikZDuEAXNu4EcABADEZA7JY8niCzEJJPIC0sRSEdbINyOO91brZvEKURziArJ3cSqD7RIUV4vbqpnOHKJ9QAEcbp1ae84Ycu9zDv6/pmOeNv25h836REIQCcD9JTIembRcRDAPD7M2ttpq/FOEWCiCbTj5CRJtEBMPB8GLdzLwvwi0UQC6dXM5Ea0QEw8DILIqEAsimk2uIyH/cLYmLmTdUWxmh9YhQAG46+RKIXiuJ7gEw81vVVuZ5ET9iAdiJxwFto4hgSJgVuumsFuEWC6DBmAPGtyKCoWCIF+ipjNCkLBSA/+anu6PrZAEvOEPptz+pzHJYKADfgJs2fgFhciQdDiLCwHG93BlLdciLeBEPwE7UA9orIqIqMTK/AL4P4QByH90z1ivzDhNoqMqGiuVizk+qtnb8Wiyur144AJ8gayffI9ASUXEFuO9005kjwyMVwOH03VdrNNR/CLlKxoQQ1t8vgDdF5tuXugX6TOcaDJMZaaEmJEDEeDNuOS9KUPRApUZAn3j07wZ4V/yGIQmasa27JAI40lA7vsuL/UGEYbKGgvHMpGkTVO0iKxkBveuC5CIQCT2SBjd9UcVG3XQWFYkZsFxZAD2/CunkZ0Q0X5W5S3iYTw0vo5tGP+ocV6WhNAB/n6A9j/0EjFFl8GIeXqabmXdUcisNoHcUJB4i0raoNHmeqyVe7twmuuQdyI/yAHrmgxD2ColgxVOOrTrYUAJobayd6Hmx31WZZXCnXt42quQPSFzYcNY2fiJgqqIQvtFN5wFFXBfRhDICeucC4wUivKHENONt3XKeVcLVjyS0ANyG2rngmH9uQP5iflm3Mq/LE13KEFoArbbxoAd8pcI0g9dXm5knVXD15wgtADedWAbS1qowzYxMteUYKrgiDCC5HUTT1ZhmJg8TZbbBI10H5BoTd7HnH5pSen2um06dUkZVj8MXmgrzxBgRz4+nMk0qQ1A6BzCDcrbxBQgPqzT5HxfzmTLNu/Pa1I59qviVBhDJO0LGbt1yppRUAP4379rJ9US0WJWxQXkY83TLUbLGGHAEuA3TJpEXm+mBAg88E2EagNmRNN+zGYpzBF7LoK7BNDUNDHgHQbGfB3qD9L8BuLbhb3jUR9VQFDpEmBFPOdsKWge4tnEKwMgojEWlQYRV8ZTzamAA7geTh6Oioj0qY9Hp8DrdzDwTGMD5v7icjs5YVEpXArgyAgq6BbgJMfes0R7NJkdUw9/XKfAW8Etdu3Y2s5YkQg1Ao6O0GZpW78nyDwMnwdAMlCix0meBEu1xUFs9AeTs5EoujZPfEWXI+yry7c+Neey3Nvp7k3FLPg+hk9YRuQ1FhphXxq1Mvf8UNwWgXaGolDRp768C5T6edjPHylpK2ms45npOl56fAxILPVCKQJf1/z/h9HkpK4NPDs+3m/4c8C+sR/9QvJUjfgAAAABJRU5ErkJggg=="},"3cad":function(e,t,a){"use strict";var n=a("8979"),i=a.n(n);i.a},"3cff":function(e,t,a){"use strict";var n=a("eebe"),i=a.n(n);i.a},"3d85":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content-auth-manager"},[e._t("button",[a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.showManageButton,expression:"showManageButton"}],attrs:{type:"primary"},on:{click:e.handleOpenAuthManagement}},[e._v("\n      内容权限管理\n    ")])]),a("el-dialog",{staticClass:"content-auth-manager__dialog",attrs:{title:"权限设置",visible:e.showManagementDialog,width:"80vw"},on:{"update:visible":function(t){e.showManagementDialog=t}}},[a("div",{staticClass:"content-auth-list"},[a("div",{staticClass:"actions"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("\n          保存\n        ")]),a("el-button",{attrs:{type:"warning"},on:{click:function(t){e.showManagementDialog=!1}}},[e._v("\n          关闭\n        ")])],1),a("el-autocomplete",{staticClass:"user-search-input",attrs:{placeholder:"用户名称、账号、邮箱","fetch-suggestions":e.handleSearch},on:{select:e.handleAddUser},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),a("Table",{attrs:{header:e.table.header,data:e.table.data}})],1)])],2)},i=[],r=a("59c7"),o={components:{Table:r["Table"]},data:function(){return{showManagementDialog:!1,showManageButton:!1,keyword:"",currentUserId:void 0,ownerId:void 0,table:{data:[],header:[{label:"登录账号",prop:"loginName"},{label:"公司部门",prop:"deptName"},{label:"电子邮件",prop:"email"},{label:"查看",render:function(e,t){return e("el-checkbox",{props:{disabled:this.isDisableRow(t.row),value:!!t.row.browser},on:{input:function(e){t.row.browser=e?1:0}}})}.bind(this)},{label:"编辑",render:function(e,t){return e("el-checkbox",{props:{disabled:this.isDisableRow(t.row),value:!!t.row.edit},on:{input:function(e){t.row.edit=e?1:0}}})}.bind(this)},{label:"删除",render:function(e,t){return e("el-checkbox",{props:{disabled:this.isDisableRow(t.row),value:!!t.row.delete},on:{input:function(e){t.row.delete=e?1:0}}})}.bind(this)}]}}},props:["resourceId","resourceType","menuElid"],methods:{isDisableRow:function(e){return this.currentUserId===this.ownerId&&e.userId===this.currentUserId},handleOpenAuthManagement:function(){this.getUsers(),this.showManagementDialog=!0},handleAddUser:function(e){var t=e.row;this.keyword="",this.table.data.push({userId:t.userId,loginName:t.loginName,deptName:t.deptName,email:t.email,browser:1,edit:0,delete:0})},handleSearch:function(e,t){e&&this.$service.userConfigPageList({keyword:e}).then(function(e){var a=this.table.data.reduce(function(e,t){return e[t.userId]=!0,e},{}),n=e.rows.map(function(e){return{userId:e.userId,value:e.loginName+"("+e.email+")",row:e}}).filter(function(e){return!a[e.userId]});t(n)}.bind(this)).catch(function(){t()})},getUsers:function(){this.$service.getResourceContentAuthList({resourceId:this.resourceId,resourceType:this.resourceType,menuElid:this.menuElid}).then(function(e){this.currentUserId=e.currentUserId,this.ownerId=e.ownerId,this.table.data=e.userContentAuthList}.bind(this))},updateUserAuth:function(e,t,a){var n=e[t];e[t]=a;var i={resourceId:this.resourceId,resourceType:this.resourceType,userContentAuthList:[{userId:e.userId,browser:e.browser,edit:e.edit,delete:e.delete}]};this.$service.upsertResourceContentAuthList(i,"保存成功").catch(function(){e[t]=n})},handleSave:function(){var e=this.table.data.reduce(function(e,t){return(t.browser||t.edit||t.delete)&&e.push({userId:t.userId,browser:t.browser,edit:t.edit,delete:t.delete}),e},[]),t={resourceId:this.resourceId,resourceType:this.resourceType,userContentAuthList:e};this.$service.upsertResourceContentAuthList(t,"保存成功")}},created:function(){this.resourceId&&this.$service.getUserContentAuth({resourceId:this.resourceId,resourceType:this.resourceType,menuElid:this.menuElid}).then(function(e){e.enableContentAuth&&e.contentAuth.contentAuthSetting&&(this.showManageButton=!0)}.bind(this))}},l=o,s=(a("9b76"),a("2877")),c=Object(s["a"])(l,n,i,!1,null,"7e84a902",null);t["a"]=c.exports},"3f9a":function(e,t,a){},"41fc":function(e,t,a){},4240:function(e,t,a){"use strict";var n=a("a901"),i=a.n(n);i.a},4257:function(e,t,a){"use strict";var n=a("2da0"),i=a.n(n);i.a},4275:function(e,t,a){"use strict";a.d(t,"a",function(){return n});function n(e){return e&&12===e.panelGroupType}},4287:function(e,t,a){},"42f0":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"remote-selector-main"},[a("div",{staticClass:"remote-selector-main__filter"},[e._t("filter",[e.filterSchema?a("GateSchemaForm",{attrs:{schema:e.filterSchema},on:{submit:e.handleFilter,reset:e.handleResetFilterForm},model:{value:e.viewFilter,callback:function(t){e.viewFilter=t},expression:"viewFilter"}}):e._e()],{selected:e.selected})],2),a("div",{ref:"selectorContent",staticClass:"remote-selector-main__content"},[e._t("item-list",[a("Table",{ref:"table",attrs:{data:e.table.data,header:e.table.header,selected:e.tableSelected,props:e.tableProps,"selection-type":e.selectionType||e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleTableRowSelectionAdd,"row-selection-remove":e.handleTableRowSelectionRemove,"row-selection-change":e.handleTableRowSelectionChange,"all-row-selection-change":e.handleTableAllRowSelectionChange,"row-dblclick":e.handleRowDblClick}})])],2),a("div",{staticClass:"remote-selector-main__footer"},[a("div",{staticClass:"remote-selector-main__pagination"},[e._t("pagination",[e.pagination?a("el-pagination",{attrs:{"current-page":e.pagination.currentPage,"page-sizes":[15,20,30,50,100,200],"page-size":e.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pagination.total},on:{"size-change":e.handlePageSizeChange,"current-change":e.handlePageChange}}):e._e()])],2),a("div",{staticClass:"remote-selector-main__actions"},[e._t("actions",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSelectEnd}},[e._v("\n            确定\n          ")]),a("el-button",{on:{click:e.handleSelectCancel}},[e._v("\n            取消\n          ")])])],2)]),e._t("default")],2)},i=[],r=(a("ac6a"),a("cebc")),o=a("59c7"),l={components:{Table:o["Table"]},data:function(){return{tableHeight:void 0,selected:[],tableSelected:[],inputFilter:{},viewFilter:{}}},props:["idField","filter","filterSchema","table","pagination","selectionType","selectEndOnDblClick","selectEndOnClick"],computed:{tableProps:function(){var e=this.table.Props||{};return e.height?e:Object(r["a"])({},e,{height:this.tableHeight})}},watch:{"table.data":"updateTableSelected"},methods:{setViewFilter:function(e){this.inputFilter!==e&&(this.inputFilter=e||{},this.viewFilter=e?JSON.parse(JSON.stringify(e)):{})},clearSelected:function(){this.selected=[],this.tableSelected=[]},handleSelectEnd:function(){if(0===this.selected.length)return this.$message({type:"error",message:"请选择数据"});this.$emit("select-end",this.selected.slice())},handleSelectCancel:function(){this.$emit("select-cancel"),this.tableSelected=[],this.selected=[]},handleFilter:function(e){e&&0!==e.length||(this.inputFilter=JSON.parse(JSON.stringify(this.viewFilter)),this.$set(this.pagination,"currentPage",1),this.$emit("filter-change",this.inputFilter))},handlePageSizeChange:function(e){this.$set(this.pagination,"pageSize",e),this.$emit("pagination-change")},handlePageChange:function(e){this.$set(this.pagination,"currentPage",e),this.$emit("pagination-change")},handleResetFilterForm:function(){this.$emit("filter-reset")},handleTableRowSelectionChange:function(e,t){this.selected=[e],this.tableSelected=t,this.selectEndOnClick&&"single"===this.selectionType&&this.handleSelectEnd()},handleTableRowSelectionAdd:function(e){this.selected=this.selected.concat(e),this.updateTableSelected()},handleTableRowSelectionRemove:function(e){var t=this.getId;this.selected=this.selected.filter(function(a){return t(a)!==t(e)}),this.updateTableSelected()},handleTableAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleTableRowSelectionAdd):this.table.data.forEach(this.handleTableRowSelectionRemove)},updateTableSelected:function(){var e=this.getId,t=this.table,a=this.selected.map(function(t){return e(t)}),n=t.data.reduce(function(t,n,i){return a.indexOf(e(n))>-1&&t.push(i),t},[]);this.tableSelected="single"===this.selectionType?n[0]:n,setTimeout(function(){window.dispatchEvent(new Event("resize"))},0)},setTableHeight:function(){this.tableHeight=this.$refs.selectorContent.scrollHeight+"px",this.$refs.table.$refs.table.doLayout()},handleRowDblClick:function(){this.selectEndOnDblClick&&"single"===this.selectionType&&this.handleSelectEnd()},getId:function(e){var t=this.idField;return"function"===typeof t?t(e):e[t]}},activated:function(){this.setTableHeight()},created:function(){this.$watch("filter",this.setViewFilter,{immediate:!0})},mounted:function(){window.addEventListener("resize",this.setTableHeight),this.setTableHeight()},beforeDestroy:function(){window.removeEventListener("resize",this.setTableHeight)}},s=l,c=(a("607a"),a("2877")),u=Object(c["a"])(s,n,i,!1,null,"5eaeaaaa",null);t["a"]=u.exports},"439e":function(e,t,a){},"43a1":function(e,t,a){},"43f4":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("TabPage",[a("PageWrapper",[a("PageContentWrapper",{directives:[{name:"show",rawName:"v-show",value:"panel_info"==e.activePage,expression:"activePage == 'panel_info'"}]},[a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("CommonContent",{ref:"commonContent",attrs:{mode:e.mode,"resource-info":e.resourceInfo,"is-frozen":e.isFrozen},on:{replicate:function(t){e.mode="replicate"},edit:function(t){e.mode="edit"},unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,audit:function(t){return e.$emit("upsert-end")},"submit-audit":e.handleSubmitAudit,"save-draft":e.handleSaveDraft,"select-version":e.fetchData,delete:function(t){return e.$emit("upsert-end",t)},"cancel-timing":function(t){return e.fetchData(e.pannel.currentVersion)}}},[a("div",{attrs:{slot:"copy-confirm"},slot:"copy-confirm"},[e._v("\n            复制到\n            "),a("el-select",{model:{value:e.copyToPanelDataType,callback:function(t){e.copyToPanelDataType=t},expression:"copyToPanelDataType"}},[a("el-option",{attrs:{value:1,label:"常规运营"}}),a("el-option",{attrs:{value:3,label:"业务专辑"}})],1),e._v("\n             \n            "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleCopy(e.$consts.status.draft)}}},[e._v("复制为草稿")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleCopy(e.$consts.status.waiting)}}},[e._v("复制并提交审核")])],1),1==e.currentPanelDataType?a("div",{staticClass:"base-info"},[a("div",[e._v("常规运营版块：")]),a("div",[e._v("运营人员纯手工运营的版块，可以通过此版块自主配置影片、频道、活动、系统功能等，此类版块适合首屏比较固定的内容版块，不做个性推荐积累。")])]):e._e(),3==e.currentPanelDataType?a("div",{staticClass:"base-info"},[a("div",[e._v("业务专辑：")]),a("div",[e._v("运营人员可以把业务站点专辑，关联映射至此版块中，可以多个进行排序。")])]):e._e(),"read"!==e.mode?[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"form",attrs:{model:e.pannel,"label-width":"120px"}},[a("el-form-item",{staticClass:"selectItem",attrs:{label:"业务分类"}},[a("CommonSelector",{attrs:{filterable:"",value:e.pannel.panelGroupCategory,disabled:e.isReplica,options:e.businessTypeEnums},on:{input:e.handlePanelGroupCategoryChange}}),a("span",{staticClass:"remarks marginL"},[e._v("注：只有一个权限的操作者不能选择业务分类")])],1),e.hasSource?a("el-form-item",{attrs:{label:"内容源"}},[a("SourceRadioSelector",{attrs:{value:e.pannel.pannelResource,disabled:e.isReplica},on:{input:e.handlePannelResourceChange}})],1):e._e(),a("el-form-item",{attrs:{label:"版块名称",required:""}},[a("el-input",{attrs:{clearable:""},model:{value:e.pannel.pannelName,callback:function(t){e.$set(e.pannel,"pannelName","string"===typeof t?t.trim():t)},expression:"pannel.pannelName"}})],1),a("el-form-item",{attrs:{label:"版块分类",required:""}},[a("CommonSelector",{attrs:{type:"radio",value:e.pannel.parentType,disabled:e.isReplica,options:e.$consts.panelTypeOptions},on:{input:e.handleInputParentType}})],1),"group"===e.pannel.parentType?a("el-form-item",{attrs:{label:"落焦规则"}},[a("el-radio-group",{on:{change:e.handleFocusConfigChange},model:{value:e.pannel.focusConfig,callback:function(t){e.$set(e.pannel,"focusConfig",t)},expression:"pannel.focusConfig"}},[a("el-radio",{attrs:{label:""}},[e._v("手动指定")]),a("el-radio",{attrs:{label:"week"}},[e._v("根据一周时间")]),a("el-radio",{attrs:{label:"timeSlot"}},[e._v("根据时间段")])],1)],1):e._e(),a("el-form-item",{attrs:{label:"版块属性"}},[a("BinCheckBox",{attrs:{label:"4K",disabled:e.isReplica},model:{value:e.pannel.flagIs4k,callback:function(t){e.$set(e.pannel,"flagIs4k",t)},expression:"pannel.flagIs4k"}})],1)],1),"edit"===e.mode||"replicate"===e.mode?a("div",[a("div",{staticClass:"form-legend-header",on:{click:e.handlePanelDataClick}},[e.isCollapseData?a("i",{staticClass:"el-icon-arrow-down"}):a("i",{staticClass:"el-icon-arrow-up"}),a("span",[e._v("版块数据        ")]),e._v("\n                昨日UVCTR："),a("span",[e._v(e._s(e.panelUVCTR.value?e.toPercent(e.panelUVCTR.value):"N/A"))]),e._v("，\n                日环比"),a("span",{class:e.panelUVCTR.dailyGrowth>0?"data-up":"data-down"},[e._v(e._s(e.panelUVCTRPercent.dailyGrowth))]),e._v("；\n                周同比"),a("span",{class:e.panelUVCTR.weeklyGrowth>0?"data-up":"data-down"},[e._v(e._s(e.panelUVCTRPercent.weeklyGrowth))])]),e.isCollapseData?e._e():a("div",e._l(e.panelChartDataArr,function(t,n){return a("div",{key:n,staticClass:"chart-box"},[a("div",{staticClass:"chart-box--title"},[e._v(e._s(t.title))]),a("VeLine",{attrs:{data:e.handleChartData(t),"legend-visible":!1,extend:e.handleChartExtend(t),settings:e.handleChartSettings(t),events:e.handleChartEvents(n,"edit"),"mark-line":e.markLine,"mark-point":e.markPoint}})],1)}),0)]):e._e(),a("div",{staticClass:"form-legend-header"},[a("span",[e._v("内容配置")])]),a("el-form",{ref:"form",attrs:{model:e.pannel,"label-width":"150px"}},[e.showPannelTitleField?a("el-form-item",{attrs:{label:"版块标题",required:""}},[a("el-input",{staticStyle:{width:"300px"},attrs:{clearable:"",placeholder:"请输入版块标题"},model:{value:e.pannel.pannelList[0].pannelTitle,callback:function(t){e.$set(e.pannel.pannelList[0],"pannelTitle",t)},expression:"pannel.pannelList[0].pannelTitle"}}),a("BinCheckBox",{attrs:{label:"前端不显示标题","is-negative":""},model:{value:e.pannel.showTitle,callback:function(t){e.$set(e.pannel,"showTitle",t)},expression:"pannel.showTitle"}})],1):e._e(),"group"===e.pannel.parentType?a("el-form-item",{attrs:{label:"版块标题",required:""}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入版块标题"},model:{value:e.pannel.groupTitle,callback:function(t){e.$set(e.pannel,"groupTitle",t)},expression:"pannel.groupTitle"}})],1):e._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:"subscribe"!==e.pannel.parentType&&"tag"!==e.pannel.parentType,expression:"pannel.parentType !== 'subscribe' && pannel.parentType !== 'tag'"}]},["normal"===e.pannel.parentType?a("el-form-item",{attrs:{label:"版块内容来源"}},[a("el-radio-group",{attrs:{value:e.pannelFillType},on:{input:e.handleInputFillType}},e._l(e.fillTypeOptions,function(t){return a("el-radio",{key:t.value,attrs:{label:t.value}},[e._v("\n                      "+e._s(t.label)+"\n                    ")])}),1)],1):e._e(),1===e.pannelFillType?[a("el-form-item",{attrs:{label:"版块布局",required:""}},[a("LayoutSelector",{ref:"layoutSelector",on:{"select-end":e.handleSelectLayoutEnd}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return t.stopPropagation(),e.handleSelectLayoutStart(t)}}},[e._v("选择布局")])],1),e.selectedLayout?a("span",{staticClass:"marginL"},[e._v("(已选择: "+e._s(e.selectedLayout.layoutName)+")")]):e._e(),a("BinCheckBox",{staticClass:"marginL",attrs:{label:"设置前端推荐位底色透明"},model:{value:e.pannel.lucenyFlag,callback:function(t){e.$set(e.pannel,"lucenyFlag",t)},expression:"pannel.lucenyFlag"}})],1),a("el-form-item",{attrs:{label:"落焦形式",required:""}},[a("CommonSelector",{attrs:{type:"radio-button",options:e.$consts.panelFocusOptions,placeholder:"请选择"},model:{value:e.pannel.focusShape,callback:function(t){e.$set(e.pannel,"focusShape",t)},expression:"pannel.focusShape"}}),a("BinCheckBox",{directives:[{name:"show",rawName:"v-show",value:0===e.pannel.focusShape,expression:"pannel.focusShape === 0"}],staticStyle:{"margin-left":"25px"},attrs:{label:"设置异形焦点"},model:{value:e.isShowfocusImgUrl,callback:function(t){e.isShowfocusImgUrl=t},expression:"isShowfocusImgUrl"}})],1),e.isShowfocusImgUrl&&0===e.pannel.focusShape?a("el-form-item",{attrs:{label:"异形焦点"}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.selectedLayout,expression:"!selectedLayout"}],attrs:{disabled:!e.selectedLayout}},[e._v("选择异形焦点(请先选择布局)")]),a("GlobalPictureSelector",{directives:[{name:"show",rawName:"v-show",value:e.selectedLayout,expression:"selectedLayout"}],attrs:{title:"选择异形焦点","picture-resolution":e.alienFocusResolution},on:{"select-end":e.handleSelectAlienFocusEnd}}),a("div",[e.pannel.focusImgUrl?a("img",{staticStyle:{"margin-top":"10px",width:"200px",border:"1px solid #eee"},attrs:{src:e.pannel.focusImgUrl}}):e._e()])],1):e._e(),e.pannel.pannelGroupId?a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isShowTagsField,expression:"isShowTagsField"}],staticClass:"tag-list",attrs:{label:"资源共有标签"}},[a("div",{staticClass:"media-tag-list"},e._l(e.sharedTags,function(t,n){return a("div",{key:n,staticClass:"media-tag-list__item"},[e._v("\n                        "+e._s(t.tagName)+"\n                        "),a("el-input-number",{attrs:{max:1.5,min:.5,step:.1},on:{change:function(a){return e.handleInputTagWeight(arguments[0],arguments[1],t)}},model:{value:t.tagWeight,callback:function(a){e.$set(t,"tagWeight",a)},expression:"item.tagWeight"}})],1)}),0)]):a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isShowTagsField,expression:"isShowTagsField"}],staticClass:"tag-list",attrs:{label:"资源共有标签"}},e._l(e.sharedTags,function(t,n){return a("el-tag",{key:n,attrs:{type:"primary"}},[e._v(e._s(t.tagName)+"/"+e._s(t.tagWeight))])}),1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isShowTagsField,expression:"isShowTagsField"}],staticClass:"tag-list",attrs:{label:"资源批量打标签"}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleBatchAddTag}},[e._v("\n                      批量打标签\n                    ")]),e.isVideoOrEdu?a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isShowTagsField&&"normal"===e.pannel.parentType,expression:"isShowTagsField && pannel.parentType === 'normal'"}],staticClass:"item-item-wrapper",attrs:{"label-width":"160px",label:"是否开启版块标签引导"}},[a("el-switch",{attrs:{value:!!e.firstPanel.flagTagVector,"active-color":"#13ce66","inactive-color":"grey"},on:{input:e.handleInputFlagTagVector}}),1===e.firstPanel.flagTagVector?[a("span",[e._v("可引导标签："+e._s(e.firstPanel.panelTagVectorInfo.categoryName))]),a("TagTypeSelector",{model:{value:e.firstPanel.panelTagVectorInfo.focusCategory,callback:function(t){e.$set(e.firstPanel.panelTagVectorInfo,"focusCategory",t)},expression:"firstPanel.panelTagVectorInfo.focusCategory"}},[a("span",{attrs:{slot:"tip"},slot:"tip"})])]:e._e()],2):e._e()],1),a("el-form-item",{attrs:{label:"批量填充"}},[a("span",{directives:[{name:"show",rawName:"v-show",value:!e.selectedLayout,expression:"!selectedLayout"}]},[e._v("\n                      请先选择布局\n                    ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.selectedLayout,expression:"selectedLayout"}]},[[a("ResourceSelector",{ref:"resourceSelector",attrs:{selectors:e.mediaResourceSelectors,"is-live":!1,"disable-partner":!!e.pannel.pannelResource,"selection-type":"multiple","init-active-selector":e.initActiveResoruceSelector,source:e.pannel.pannelResource,"business-type":e.pannel.panelGroupCategory},on:{"select-end":e.handleSelectResourceEnd}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return t.stopPropagation(),e.handleSelectResourceStart(t)}}},[e._v("选择资源")])],1),e.canFillWithRanking?a("ResourceSelector",{ref:"rankingSelector",staticClass:"margin-left-10",attrs:{selectors:["ranking"],"is-live":!1,"disable-partner":!!e.pannel.pannelResource,"selection-type":"single",source:e.pannel.pannelResource,"business-type":e.pannel.panelGroupCategory},on:{"select-end":e.handleSelectRankingEnd}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return t.stopPropagation(),e.handleSelectRankingStart(t)}}},[e._v("\n                              选择排行榜\n                            ")])],1):a("el-tooltip",{attrs:{effect:"dark",placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n                            使用排行榜，布局必须满足：标题布局、不带价格、只有一行、\n                            "),a("br"),e._v("\n                            每个推荐位都是 260*364、推荐位数量 6~11 个\n                            "),a("br"),e._v("\n                            目前只支持业务类型为 不限、教育、影视\n                          ")]),a("el-button",{staticClass:"is-disabled",attrs:{type:"primary",plain:""}},[e._v("\n                            选择排行榜\n                          ")])],1),a("el-button",{staticClass:"btn-clear-current-blocks",attrs:{type:"primary",plain:""},on:{click:e.handleClearCurrentBlocks}},[e._v("\n                          清空当前版块推荐位\n                        ")])],a("el-form-item",{staticClass:"item-item-wrapper",attrs:{label:"第三方内容源左上角标","label-width":"160px"}},[a("el-switch",{attrs:{value:!!e.pannel.flagThirdSourceCorner,"active-color":"#13ce66","inactive-color":"grey"},on:{input:function(t){e.pannel.flagThirdSourceCorner=+t}}})],1)],2),"group"===e.pannel.parentType?a("div",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"primary",disabled:!!e.pannel.pannelList[e.activePannelIndex].panelIsFocus||""!=e.pannel.focusConfig},on:{click:e.handleSetDefaultActiveTab}},[e._v("\n                        设置默认落焦\n                      ")]),a("el-button",{attrs:{type:"primary",disabled:e.pannel.pannelList.length>=10},on:{click:e.handleAddTab}},[e._v("\n                        添加分组\n                      ")])],1):e._e(),a("div",{staticClass:"pannel-blocks"},["group"===e.pannel.parentType?[a("el-tabs",{attrs:{value:e.activePannelIndex+"",type:"card",closable:""},on:{input:function(t){e.activePannelIndex=+t},"tab-remove":e.handleRemoveTab}},e._l(e.pannel.pannelList,function(t,n){return a("el-tab-pane",{key:n,attrs:{name:n.toString()}},[a("span",{attrs:{slot:"label"},on:{dblclick:function(t){return e.handleSetPanelGroupInfoStart(n)}},slot:"label"},[e._v("\n                              "+e._s((t.pannelTitle||"").trim()||"双击修改")+"\n                              "+e._s(t.panelIsFocus&&""===e.pannel.focusConfig?"(默认落焦)":"")+"\n                            ")]),a("VirtualPanel",{attrs:{"panel-group":e.pannel,"panel-index":n,blocks:t.contentList,mode:e.mode,"show-chart-btn":!!e.id},on:{drag:e.handleDragBlock,"remove-block":e.handleRemoveBlock,"click-block":e.handleClickBlock}})],1)}),1)]:a("VirtualPanel",{attrs:{blocks:e.pannel.pannelList[0].contentList,mode:e.mode,"panel-group":e.pannel,"panel-index":0,"show-chart-btn":!!e.id},on:{drag:e.handleDragBlock,"remove-block":e.handleRemoveBlock,"click-block":e.handleClickBlock}})],2)])]:e._e(),2===e.pannelFillType?[a("el-form-item",{attrs:{label:"展示影片数量",required:""}},[a("CommonSelector",{attrs:{type:"radio-button",value:e.pannel.pannelList[0].filmNum,options:e.filmNumOptions},on:{input:e.handleInputFilmNum}})],1),a("el-form-item",{attrs:{label:"选择排行榜",required:""}},[a("ResourceSelector",{ref:"rankingFillSelector",attrs:{selectors:["ranking"],"is-live":!1,"disable-partner":!!e.pannel.pannelResource,"selection-type":"single",source:e.pannel.pannelResource,"business-type":e.pannel.panelGroupCategory,disabled:!e.pannel.pannelList[0].filmNum||e.pannel.pannelList[0].filmNum<5},on:{"select-end":function(t){return e.handleSelectRankingEnd(t,"rank")}}},[a("el-button",{attrs:{type:"primary",disabled:!e.pannel.pannelList[0].filmNum||e.pannel.pannelList[0].filmNum<5||e.pannel.pannelList[0].filmNum>10,plain:""}},[e._v("\n                          选择排行榜\n                        ")]),e.pannel.pannelList[0].rankName?a("el-tag",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.pannel.pannelList[0].rankName))]):e._e()],1)],1),0!==e.pannel.pannelList[0].contentList.length?a("el-form-item",{attrs:{label:"推荐位"}},[a("VirtualPanel",{staticClass:"pannel-blocks",attrs:{mode:e.mode,isNotExtra:!0,blocks:e.pannel.pannelList[0].contentList},on:{"click-block":e.handleClickBlock}})],1):e._e()]:e._e(),3===e.pannelFillType||4===e.pannelFillType?[a("el-form-item",{attrs:{label:"选择布局"}},[a("el-radio-group",{staticStyle:{"margin-top":"10px"},attrs:{value:e.selectedLayoutId},on:{input:e.handleInputLayoutId}},e._l(e.mediaRuleLayoutOptions,function(t){return a("el-radio",{key:t.dictEnName,staticClass:"layout-radio",attrs:{label:+t.dictEnName}},[e._v("\n                        "+e._s(t.dictCnName)),a("i",{staticClass:"el-icon-question",on:{click:function(a){return e.handleShowLayout(t.dictUrl)}}})])}),1)],1),e.pannelFillType===e.$consts.panelFillTypes.mediaRule?a("el-form-item",{attrs:{label:"配置影片筛选规则",required:""}},[a("ConfigureFilmFilterRule",{staticStyle:{display:"inline-block"},attrs:{source:e.pannel.pannelResource},on:{"get-filter-result":e.handleGetFilterResult}}),e.pannel.pannelList[0].mediaRuleDesc?a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"text"},on:{click:function(t){return e.showMediaRuleDesc(e.pannel.pannelList[0].mediaRuleDesc)}}},[e._v("查看规则\n                    ")]):e._e()],1):e._e(),e.pannelFillType===e.$consts.panelFillTypes.recStream?a("el-form-item",{attrs:{label:"选择推荐流",required:""}},[a("NewBlockRecStreamSelector",{attrs:{title:"选择推荐流","selection-type":"single",source:e.pannel.pannelResource,scene:e.scene},on:{"select-end":e.handleSelectBlockRecNew}}),e.firstPanel.recStreamPanelRls?[e._v("\n                        已选择: "),a("el-tag",[e._v("\n                        "+e._s(e.firstPanel.recStreamPanelRls.recId)+"\n                        ("+e._s(e.firstPanel.recStreamPanelRls.recName)+")\n                        ")])]:e._e()],2):e._e(),e.pannelFillType===e.$consts.panelFillTypes.mediaRule&&e.firstPanel.contentList.length>0?a("el-form-item",{attrs:{label:"推荐位"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleRefreshMediaRuleContents}},[e._v("刷新推荐位内容")]),a("VirtualPanel",{staticClass:"pannel-blocks",attrs:{isNotExtra:!0,"show-post-updater":e.isFillWithMediaRule,mode:e.mode,blocks:e.pannel.pannelList[0].contentList},on:{"update-post-end":e.handleUpdatePostEnd,"click-block":e.handleClickBlock}})],1):e._e(),a("el-form-item",{attrs:{label:"插入"}},[a("el-button",{attrs:{type:"primary",disabled:!e.selectedLayout},on:{click:e.handleAddIntervene}},[e._v("添加")]),a("VirtualIntervenePanel",{staticClass:"pannel-blocks",staticStyle:{display:"flex"},attrs:{mode:e.mode,maxCount:e.interveneMaxCount,blocks:e.interveneContentList},on:{"click-block":e.handleClickInterveneBlock,"remove-block":e.handleRemoveIntervene,"end-intervene-input":e.handleEndIntervenePos}})],1)]:e._e(),a("el-dialog",{attrs:{title:"预览图片",visible:e.picDialogVisible,width:"40%"},on:{"update:visible":function(t){e.picDialogVisible=t}}},[a("div",{staticClass:"pics"},[a("img",{staticStyle:{width:"100%"},attrs:{src:e.reviewPicUrl}})])])],2),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"subscribe"===e.pannel.parentType,expression:"pannel.parentType === 'subscribe'"}],attrs:{label:"预约影片"}},[a("ResourceSelector",{ref:"subscribeSelector",attrs:{selectors:["subscribe"],"is-live":!1,"disable-partner":!!e.pannel.pannelResource,"selection-type":"multiple",source:e.pannel.pannelResource,"business-type":e.pannel.panelGroupCategory},on:{"select-end":e.handleSelectSubscribeEnd}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return t.stopPropagation(),e.handleSelectSubscribeStart(t)}}},[e._v("选择预约影片")])],1),a("SubscribeVideos",{attrs:{blocks:e.pannel.pannelList[0].contentList},on:{"remove-block":e.handleRemoveBlock}})],1),"tag"===e.pannel.parentType?[a("el-form-item",{attrs:{label:"行数"}},[a("el-input-number",{attrs:{min:1,max:5,"step-strictly":""},model:{value:e.firstPanel.tagPanelInfo.rowNum,callback:function(t){e.$set(e.firstPanel.tagPanelInfo,"rowNum",t)},expression:"firstPanel.tagPanelInfo.rowNum"}}),a("TagTypeSelector",{model:{value:e.firstPanel.tagPanelInfo.focusCategory,callback:function(t){e.$set(e.firstPanel.tagPanelInfo,"focusCategory",t)},expression:"firstPanel.tagPanelInfo.focusCategory"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("标签详情页默认落焦分类")])])],1),a("el-form-item",{attrs:{label:"选择算法"}},[a("CommonSelector",{staticClass:"radio-block-select",attrs:{type:"radio",options:e.$consts.panelTagAlgorithmOptions},model:{value:e.firstPanel.tagPanelInfo.algorithmType,callback:function(t){e.$set(e.firstPanel.tagPanelInfo,"algorithmType",t)},expression:"firstPanel.tagPanelInfo.algorithmType"}})],1)]:e._e()],2)]:e._e(),"read"===e.mode?[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"form",attrs:{model:e.pannel,"label-width":"120px"}},[e.businessTypeEnums.length>0?a("el-form-item",{attrs:{label:"业务分类"}},[e._v("\n                "+e._s((e.businessTypeEnums.find(function(t){return t.value==e.pannel.panelGroupCategory})||{}).label)+"\n              ")]):e._e(),e.hasSource?a("el-form-item",{attrs:{label:"内容源"}},[e._v("\n                "+e._s(e.$consts.sourceText[e.pannel.pannelResource])+"\n              ")]):e._e(),a("el-form-item",{attrs:{label:"版块名称",required:""}},[a("div",[e._v(e._s(e.pannel.pannelName))])]),a("el-form-item",{attrs:{label:"版块分类",required:""}},[a("div",[e._v(e._s(e.$consts.panelTypeText[e.pannel.parentType])+" ")])]),""!==e.pannel.focusConfig?a("el-form-item",{attrs:{label:"落焦规则"}},[a("div",[e._v(e._s(""===e.pannel.focusConfig?"手动指定":{week:"根据一周时间",timeSlot:"根据时间段"}[e.pannel.focusConfig])+" ")])]):e._e(),a("el-form-item",{attrs:{label:"版块属性"}},[a("BinCheckBox",{attrs:{label:"4K",disabled:!0},model:{value:e.pannel.flagIs4k,callback:function(t){e.$set(e.pannel,"flagIs4k",t)},expression:"pannel.flagIs4k"}})],1)],1),a("div",[a("div",{staticClass:"form-legend-header",on:{click:e.handlePanelDataClick}},[e.isCollapseData?a("i",{staticClass:"el-icon-arrow-down"}):a("i",{staticClass:"el-icon-arrow-up"}),a("span",[e._v("版块数据        ")]),e._v("\n              昨日UVCTR："),a("span",[e._v(e._s(e.panelUVCTR.value?e.toPercent(e.panelUVCTR.value):"N/A"))]),e._v("，\n              日环比"),a("span",{class:e.panelUVCTR.dailyGrowth>0?"data-up":"data-down"},[e._v(e._s(e.panelUVCTRPercent.dailyGrowth))]),e._v("；\n              周同比"),a("span",{class:e.panelUVCTR.weeklyGrowth>0?"data-up":"data-down"},[e._v(e._s(e.panelUVCTRPercent.weeklyGrowth))])]),e.isCollapseData?e._e():a("div",e._l(e.panelChartDataArr,function(t,n){return a("div",{key:n,staticClass:"chart-box"},[a("div",{staticClass:"chart-box--title"},[e._v(e._s(t.title))]),a("VeLine",{attrs:{data:e.handleChartData(t),"legend-visible":!1,extend:e.handleChartExtend(t),settings:e.handleChartSettings(t),"mark-line":e.markLine,"mark-point":e.markPoint}})],1)}),0)]),a("div",{staticClass:"form-legend-header"},[a("span",[e._v("内容配置")])]),a("el-form",{ref:"form",attrs:{model:e.pannel,"label-width":"120px"}},[e.showPannelTitleField?a("el-form-item",{attrs:{label:"版块标题",required:""}},[a("div",[e._v(e._s(e.firstPanel.pannelTitle)+" "+e._s(!1===e.pannel.showTitle?"(前端不显示)":""))])]):e._e(),"group"===e.pannel.parentType?a("el-form-item",{attrs:{label:"版块标题",required:""}},[a("div",[e._v(e._s(e.pannel.groupTitle)+" "+e._s(!1===e.pannel.showTitle?"(前端不显示)":""))])]):e._e(),"normal"===e.pannel.parentType?a("el-form-item",{attrs:{label:"版块内容来源"}},[e._v("\n                "+e._s(e.$consts.panelFillTypeText[e.pannelFillType])+"\n              ")]):e._e(),e.selectedLayout?a("el-form-item",{attrs:{label:"版块布局"}},[a("div",[e._v(e._s(e.selectedLayout.layoutName)+"("+e._s(e.selectedLayout.layoutId)+")"+e._s(e.pannel.lucenyFlag?"(透明)":""))])]):e._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:"normal"===e.pannel.parentType||"group"===e.pannel.parentType,expression:"pannel.parentType === 'normal' || pannel.parentType === 'group'"}]},[1===e.pannelFillType?[a("el-form-item",{attrs:{label:"落焦形式",required:""}},[e._v("\n                    "+e._s(e.$consts.panelFocusText[e.pannel.focusShape])+"\n                  ")]),e.isShowfocusImgUrl&&0===e.pannel.focusShape?a("el-form-item",{attrs:{label:"异形焦点"}},[a("div",[e.pannel.focusImgUrl?a("img",{staticStyle:{"margin-top":"10px",width:"200px",border:"1px solid #eee"},attrs:{src:e.pannel.focusImgUrl}}):e._e()])]):e._e(),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isShowTagsField,expression:"isShowTagsField"}],staticClass:"tag-list",attrs:{label:"资源共有标签"}},e._l(e.sharedTags,function(t,n){return a("el-tag",{key:n,attrs:{type:"primary"}},[e._v(e._s(t.tagName)+"/"+e._s(t.tagWeight))])}),1),a("el-form-item",{staticClass:"line-height-item",attrs:{label:"第三方内容源左上角标"}},[a("el-switch",{attrs:{value:!!e.pannel.flagThirdSourceCorner,disabled:!0,"active-color":"#13ce66","inactive-color":"grey"},on:{input:function(t){e.pannel.flagThirdSourceCorner=+t}}})],1),e.isVideoOrEdu?a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isShowTagsField&&"normal"===e.pannel.parentType,expression:"isShowTagsField && pannel.parentType === 'normal'"}],staticClass:"item-item-wrapper",attrs:{label:"版块标签引导"}},[a("el-switch",{attrs:{value:!!e.firstPanel.flagTagVector,disabled:!0,"active-color":"#13ce66","inactive-color":"grey"},on:{input:e.handleInputFlagTagVector}}),1===e.firstPanel.flagTagVector?[a("span",[e._v("可引导标签："+e._s(e.firstPanel.panelTagVectorInfo.categoryName))]),a("TagTypeSelector",{attrs:{disabled:!0},model:{value:e.firstPanel.panelTagVectorInfo.focusCategory,callback:function(t){e.$set(e.firstPanel.panelTagVectorInfo,"focusCategory",t)},expression:"firstPanel.panelTagVectorInfo.focusCategory"}},[a("span",{attrs:{slot:"tip"},slot:"tip"})])]:e._e()],2):e._e()]:e._e(),2===e.pannelFillType?[a("el-form-item",{attrs:{label:"展示影片数量"}},[e._v("\n                    "+e._s(e.firstPanel.filmNum)+"\n                  ")]),a("el-form-item",{attrs:{label:"选用排行榜"}},[e._v("\n                    "+e._s(e.firstPanel.rankName)+"\n                  ")])]:e._e(),3===e.pannelFillType?a("el-form-item",{attrs:{label:"筛选规则描述"}},[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.showMediaRuleDesc(e.firstPanel.mediaRuleDesc)}}},[e._v("查看规则\n                  ")]),a("ClickCopy",{attrs:{content:e.firstPanel.mediaRule}},[a("el-button",{attrs:{type:"text"}},[e._v("复制规则json")])],1)],1):e._e(),e.pannelFillType!==e.PANEL_FILL_TYPE.recStream&&"tag"!==e.pannel.parentType?a("el-form-item",{attrs:{label:"推荐位"}},[e.pannelFillType===e.PANEL_FILL_TYPE.mediaRule?a("el-button",{attrs:{type:"primary"},on:{click:e.handleRefreshMediaRuleContents}},[e._v("刷新推荐位内容")]):e._e(),a("div",{staticClass:"pannel-blocks pannel-blocks--read"},["group"===e.pannel.parentType?[a("el-tabs",{attrs:{value:e.activePannelIndex+"",type:"card"},on:{input:function(t){e.activePannelIndex=+t}}},e._l(e.pannel.pannelList,function(t,n){return a("el-tab-pane",{key:n,attrs:{name:n.toString()}},[a("span",{attrs:{slot:"label"},on:{dblclick:function(t){return e.handleSetPanelGroupInfoStart(n)}},slot:"label"},[e._v("\n                            "+e._s(t.pannelTitle)+" "+e._s(t.panelIsFocus&&""===e.pannel.focusConfig?"(默认落焦)":"")+"\n                          ")]),a("VirtualPanel",{attrs:{"panel-group":e.pannel,"panel-index":n,blocks:t.contentList,mode:e.mode,"show-chart-btn":!!e.id,"show-post-updater":e.isFillWithMediaRule},on:{"update-post-end":e.handleUpdatePostEnd,"click-block":e.handleClickBlock}})],1)}),1)]:a("VirtualPanel",{attrs:{mode:e.mode,"panel-group":e.pannel,"panel-index":0,blocks:e.firstPanel.contentList,"show-chart-btn":!!e.id,"show-post-updater":e.isFillWithMediaRule},on:{"update-post-end":e.handleUpdatePostEnd,"click-block":e.handleClickBlock}})],2)],1):e._e(),e.pannelFillType===e.$consts.panelFillTypes.recStream?a("el-form-item",{attrs:{label:"选择推荐流",required:""}},[e.firstPanel.recStreamPanelRls?[e._v("\n                    已选择: "),a("el-tag",[e._v("\n                      "+e._s(e.firstPanel.recStreamPanelRls.recId)+"\n                      ("+e._s(e.firstPanel.recStreamPanelRls.recName)+")\n                    ")])]:e._e()],2):e._e(),e.pannelFillType===e.PANEL_FILL_TYPE.mediaRule||e.pannelFillType===e.PANEL_FILL_TYPE.recStream?[a("el-form-item",{attrs:{label:"插入"}},[a("VirtualIntervenePanel",{staticClass:"pannel-blocks",staticStyle:{display:"flex"},attrs:{mode:e.mode,disabled:!0,maxCount:e.interveneMaxCount,blocks:e.interveneContentList},on:{"click-block":e.handleClickInterveneBlock,"remove-block":e.handleRemoveIntervene,"end-intervene-input":e.handleEndIntervenePos}})],1)]:e._e()],2),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"subscribe"===e.pannel.parentType,expression:"pannel.parentType === 'subscribe'"}],attrs:{label:"预约影片"}},[a("SubscribeVideos",{attrs:{mode:e.mode,blocks:e.firstPanel.contentList},on:{"remove-block":e.handleRemoveBlock}})],1),"tag"===e.pannel.parentType?[a("el-form-item",{attrs:{label:"行数"}},[e._v("\n                  "+e._s(e.firstPanel.tagPanelInfo.rowNum)+"\n                  "),a("TagTypeSelector",{attrs:{disabled:!0},model:{value:e.firstPanel.tagPanelInfo.focusCategory,callback:function(t){e.$set(e.firstPanel.tagPanelInfo,"focusCategory",t)},expression:"firstPanel.tagPanelInfo.focusCategory"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("标签详情页默认落焦分类")])])],1),a("el-form-item",{attrs:{label:"选择算法"}},[e._v("\n                  "+e._s(e.$consts.panelTagAlgorithmText[e.firstPanel.tagPanelInfo.algorithmType])+"\n                ")])]:e._e()],2)]:e._e()],2),e.activePanelGroup?a("PanelGroupInfoSetter",{attrs:{info:e.activePanelGroup,mode:e.mode,"panel-list":e.pannel.pannelList,"focus-config":e.pannel.focusConfig},on:{"set-end":e.handleSetPanelGroupInfoEnd,"set-cancel":e.handleSetPanelGroupInfoCancel}}):e._e(),e.showAddTagDialog?a("TagFrame",{attrs:{"is-batch":!0,ids:e.panelResourceIds},on:{close:e.handleBatchAddTagEnd}}):e._e()],1)],1),"block_content"==e.activePage?a("PageContentWrapper",[a("BlockContent",{attrs:{mode:e.mode,data:e.blockContentProps,source:e.pannel.pannelResource,pannel:e.pannel.pannelList[+e.activePannelIndex],"pannel-group-id":e.pannel.pannelGroupId,"hide-title-options":!!e.blockContentProps.blockInfo.title_info},on:{cancel:e.handleSetBlockContentCancle,save:e.handleSetBlockContentEnd}})],1):e._e(),"block_content__intervene"==e.activePage?a("PageContentWrapper",[a("BlockContent",{attrs:{mode:e.mode,isInterveneBlock:!0,data:e.blockConetentInterveneProps,source:e.pannel.pannelResource,pannel:e.pannel.pannelList[0],"pannel-group-id":e.pannel.pannelGroupId,"hide-title-options":e.interveneHideTitle},on:{cancel:e.handleSetInterveneBlockContentCancle,save:e.handleSetInterveneBlockContentEnd}})],1):e._e()],1)],1)},i=[],r=(a("96cf"),a("3b8d")),o=(a("55dd"),a("456d"),a("7618")),l=(a("7514"),a("28a5"),a("6b54"),a("3b2b"),a("20d6"),a("cebc")),s=(a("6762"),a("2fdb"),a("ac6a"),a("bbf7")),c=a("4bc7"),u=a("5f87"),d=a("5eb0"),p=a("c3d5"),h=a("363f"),m=a("8133"),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",e._l(e.blocks,function(t,n){return a("div",{key:e.content[n].vContentId+"-"+n,staticClass:"block-item--wrapper"},[a("div",{staticClass:"intervene-input--wrapper"},[a("InputPositiveInt",{ref:"posInput",refInFor:!0,staticStyle:{width:"65px"},attrs:{clearable:"",value:t.intervenePos,disabled:e.disabled},on:{input:function(t){return e.handleInputValue(t,n)},blur:function(t){return e.$emit("end-intervene-input",n)}}}),e.disabled?e._e():a("i",{staticClass:"el-icon-circle-close intervene-remove-icon",on:{click:function(t){return t.stopPropagation(),e.$emit("remove-block",n)}}})],1),a("div",{staticClass:"intervene-block",on:{click:function(t){return e.handleClickBlock(n)}}},[e.content[n].pictureUrl?a("img",{key:e.content[n].pictureUrl,staticClass:"block-post",attrs:{referrerpolicy:"no-referrer",loading:"lazy",src:e.content[n].pictureUrl}}):e._e()])])}),0)},v=[],g=(a("c5f6"),a("2149")),b={components:{InputPositiveInt:g["a"]},props:{blocks:Array,maxCount:{type:Number,default:9},disabled:{type:Boolean,default:!1}},data:function(){return{}},computed:{content:function(){return this.blocks.map(function(e){var t=e.videoContentList[0]||{},a=t.pictureUrl;if(a){var n="block/sign.png";t.pictureUrl="/themes/images/block/sign.png"===a?n:a}return t})}},methods:{handleRemoveBlock:function(e){this.$emit("remove-block",e)},handleClickBlock:function(e){this.$emit("click-block",e)},handleInputValue:function(e,t){var a=this.blocks[t].intervenePos,n=this.maxCount;if(""!==e&&(e<1||e>n)){var i=this.$refs.posInput[t];return i.inputValue=a,this.$message.error("插入位置必须在1~".concat(n,"之间"))}this.blocks[t].intervenePos=e}},created:function(){}},y=b,w=(a("165a"),a("2877")),I=Object(w["a"])(y,f,v,!1,null,"4005f638",null),C=I.exports,T=a("da3c"),S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("remote-selector-wrapper",{ref:"wrapper",attrs:{customClass:"layout-selector--global",disabled:e.disabled,title:e.title||"选择布局"},on:{"select-start":e.handleSelectStart}},[a("div",{attrs:{slot:"filter"},slot:"filter"},[a("el-form",{attrs:{inline:!0},nativeOn:{submit:function(t){return t.preventDefault(),e.handleFilter(t)},reset:function(t){return t.preventDefault(),e.handleResetFilter(t)}}},[a("el-form-item",{attrs:{label:"布局ID"}},[a("InputPositiveInt",{attrs:{clearable:""},model:{value:e.filter.layoutId,callback:function(t){e.$set(e.filter,"layoutId",t)},expression:"filter.layoutId"}})],1),a("el-form-item",{attrs:{label:"布局名称"}},[a("el-input",{attrs:{clearable:""},model:{value:e.filter.layoutName,callback:function(t){e.$set(e.filter,"layoutName",t)},expression:"filter.layoutName"}})],1),a("el-form-item",{attrs:{label:"布局分类"}},[a("el-select",{attrs:{clearable:"",filterable:""},model:{value:e.filter.layoutType,callback:function(t){e.$set(e.filter,"layoutType",t)},expression:"filter.layoutType"}},e._l(e.layoutTypeOptions,function(e){return a("el-option",{key:e.dictId,attrs:{value:e.dictId,label:e.dictCnName}})}),1)],1),a("el-form-item",{attrs:{label:"布局标题"}},[a("el-select",{attrs:{clearable:"",filterable:""},model:{value:e.filter.layoutIsTitle,callback:function(t){e.$set(e.filter,"layoutIsTitle",t)},expression:"filter.layoutIsTitle"}},[a("el-option",{attrs:{value:0,label:"不带标题"}}),a("el-option",{attrs:{value:1,label:"带标题"}})],1)],1),a("el-button",{attrs:{type:"primary","native-type":"submit"}},[e._v("查询")]),a("el-button",{attrs:{type:"warning","native-type":"reset"}},[e._v("重置")])],1)],1),a("div",{staticClass:"item-list--table",attrs:{slot:"item-list"},slot:"item-list"},[a("Table",{attrs:{data:e.table.data,header:e.table.header,selected:e.table.selected,props:e.table.props,"selection-type":e.selectionType||e.table.selectionType,"select-on-row-click":!0},on:{"row-dblclick":e.handleRowDblClick,"row-selection-change":e.handleTableRowSelectionChange}})],1),a("div",{staticClass:"item-list--common",attrs:{slot:"after-item-list"},slot:"after-item-list"},[e._l(e.videoCommonLayouts,function(t){return a("el-tag",{key:t.value,staticClass:"common-layout-item",on:{click:function(a){return e.handleSelectCommonLayout(t.value)}}},[e._v("\n      "+e._s(t.label)+"("+e._s(t.value)+")\n    ")])}),a("hr",{staticClass:"common-layout-divide"}),e._l(e.eduCommonLayouts,function(t){return a("el-tag",{key:t.value,staticClass:"common-layout-item",on:{click:function(a){return e.handleSelectCommonLayout(t.value)}}},[e._v("\n      "+e._s(t.label)+"("+e._s(t.value)+")\n    ")])})],2),a("el-pagination",{attrs:{slot:"pagination","current-page":e.pagination.page,"page-sizes":[15,20,30],"page-size":e.pagination.rows,layout:"total, sizes, prev, pager, next, jumper",total:e.pagination.total},on:{"size-change":function(t){e.pagination.rows=t},"current-change":function(t){e.pagination.page=t}},slot:"pagination"}),a("div",{attrs:{slot:"actions"},slot:"actions"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSelectEnd}},[e._v("确定")]),a("el-button",{on:{click:function(t){return e.$refs.wrapper.handleSelectCancel()}}},[e._v("取消")]),a("el-dialog",{attrs:{title:"请输入预置推荐位个数",width:"350px",visible:e.showBlockCountDialog,"append-to-body":!0},on:{"update:visible":function(t){e.showBlockCountDialog=t}}},[a("el-form",{ref:"blockCountForm",attrs:{model:e.formBlock,rules:e.formBlockRules},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.emitSelectEnd(t))}}},[a("el-form-item",{attrs:{label:"推荐位个数",prop:"count"}},[a("el-input",{ref:"blockCount",attrs:{clearable:"",placeholder:e.blockCountPlaceholder},on:{keypress:function(e){e.preventDefault(),e.stopPropagation()}},model:{value:e.formBlock.count,callback:function(t){e.$set(e.formBlock,"count",e._n(t))},expression:"formBlock.count"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showBlockCountDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.emitSelectEnd}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{visible:e.showPreviewDialog,"append-to-body":!0},on:{"update:visible":function(t){e.showPreviewDialog=t}}},[a("LayoutRead",{attrs:{content:e.previewContent,"content-width":600}})],1)],1),e._t("default")],2)},k=[],_=a("59c7"),P=a("5076"),x=a("b1fe"),F="layoutId",D={components:{Table:_["Table"],RemoteSelectorWrapper:P["a"],LayoutRead:x["a"],InputPositiveInt:g["a"]},data:function(){var e=this;this.$createElement;return{options:[],showPreviewDialog:!1,previewContent:[],showBlockCountDialog:!1,layoutTypeOptions:[],layoutTypeText:{},selectedLayout:null,formBlock:{count:void 0},formBlockRules:{count:[{required:!0,validator:this.validateNum,trigger:"blur"}]},pagination:{page:1,rows:15,total:0},filter:this.getDefaultFilter(),table:{data:[],selected:[],header:[{label:"ID",prop:"layoutId",width:200},{label:"名称",prop:"layoutName"},{label:"分类",width:200,render:function(t,a){var n=a.row;return e.layoutTypeText[n.layoutType]}},{label:"预览",render:function(t,a){var n=a.row;return t("div",[t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handlePreview(n,"v8")}}},["预览"]),t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handlePreview(n,"v6")}}},["预览6.0"])])}},{prop:"createdDate",label:"创建时间",width:190},{prop:"modifierName",label:"更新人",width:120}],selectionType:"single"},selected:[],videoCommonLayouts:null,eduCommonLayouts:null}},props:["title","selectionType","disabled"],watch:{"pagination.page":"fetchData","pagination.rows":"fetchData"},computed:{blockCountPlaceholder:function(){var e=this.selectedLayout||{},t=e.layoutJsonParsed,a=t&&t.contents.length;if(a)return"请输入大于或等于"+a+"的数"}},methods:{handlePreview:function(e,t){this.showPreviewDialog=!0;var a="v6"===t?e.layoutJson:e.layoutJson8;this.previewContent=JSON.parse(a).contents},validateNum:function(e,t,a){var n=/^[1-9]\d*$/,i=this.selectedLayout.layoutJsonParsed.contents.length;n.test(t)?t<i?a(new Error("请输入大于或等于"+i+"的数")):a():a(new Error("请输入个数"))},handleRowDblClick:function(e){this.handleTableRowSelectionChange(e,this.table.data.indexOf(e)),this.handleSelectEnd()},getDefaultFilter:function(){return{layoutStatus:this.$consts.status.accepted,layoutId:void 0,layoutName:void 0,layoutType:void 0,layoutIsTitle:void 0}},resetPageAndSelect:function(){this.selected=[],this.table.selected=void 0,this.pagination.page=1},handleFilter:function(){this.resetPageAndSelect(),this.fetchData()},handleResetFilter:function(){this.filter=this.getDefaultFilter(),this.resetPageAndSelect(),this.fetchData()},handleSelectStart:function(){this.formBlock={count:void 0},this.handleResetFilter(),this.getCommonLayouts()},handleSelectCommonLayout:function(e){var t=this;this.$service.getLayoutInforById({id:e}).then(function(e){if(e.layoutStatus!==t.$consts.status.accepted)return t.$message.error("当前布局不存在或不是审核通过状态, 请选择另外一个");t.doSelectEnd(e)}).catch(function(e){t.$message.error("获取布局信息失败，请重新选择")})},handleSelectEnd:function(){var e=this.selected[0];e?this.doSelectEnd(e):this.$message({message:"请选择一条记录",type:"warning"})},resetBlockForm:function(){var e=this.$refs.blockCountForm;e&&(e.clearValidate(),this.formBlock.count=void 0)},doSelectEnd:function(e){var t=this,a=JSON.parse(e.layoutJson8),n=a.type;e.layoutJsonParsed=a,this.selectedLayout=e,"Expander"===n||"Lengthwise"===n?(this.showBlockCountDialog=!0,this.resetBlockForm(),this.$nextTick(function(){t.$refs.blockCount.focus()})):this.emitSelectEnd()},emitSelectEnd:function(){this.showBlockCountDialog?this.$refs.blockCountForm.validate(function(e){e&&(this.showBlockCountDialog=!1,this.$refs.wrapper.handleSelectEnd(),this.$emit("select-end",this.selectedLayout,this.formBlock.count))}.bind(this)):(this.$refs.wrapper.handleSelectEnd(),this.$emit("select-end",this.selectedLayout,this.formBlock.count))},fetchData:function(){var e=this,t=JSON.parse(JSON.stringify(this.filter)),a=this.pagination;t.page=a.page,t.rows=a.rows,this.$service.getLayoutInforPageList(t).then(function(t){e.table.data=t.rows,e.pagination.total=t.total,e.selected=[],e.table.selected=void 0})},getCommonLayouts:function(){var e=this,t=this.videoCommonLayouts,a=this.eduCommonLayouts;t&&a||(this.$service.getDictType({type:"videoCommonLayout"}).then(function(t){e.videoCommonLayouts=t.map(function(e){return{label:e.dictCnName,value:e.dictEnName}})}),this.$service.getDictType({type:"eduCommonLayout"}).then(function(t){e.eduCommonLayouts=t.map(function(e){return{label:e.dictCnName,value:e.dictEnName}})}))},handleTableRowSelectionChange:function(e,t){this.selected=[e],this.table.selected=t},handleTableRowSelectionAdd:function(e){this.selected=this.selected.concat(e),this.updateTableSelected()},updateTableSelected:function(){var e=this.table,t=this.selected.map(function(e){return e.id});e.selected=e.data.reduce(function(e,a,n){return t.indexOf(a[F])>-1&&e.push(n),e},[])},fetchLayoutTypeOptions:function(){var e=this;this.$service.getDictType({type:"layoutType"}).then(function(t){e.layoutTypeOptions=t,e.layoutTypeText=t.reduce(function(e,t){return e[t.dictId]=t.dictCnName,e},{})})}},created:function(){var e=this;this.fetchLayoutTypeOptions(),this.$service.getDictType({type:"businessType"}).then(function(t){e.panelCategoryOptions=t,e.pannelCategoryOptionsIndexed=t.reduce(function(e,t){return e[t.dictId]=t.dictCnName,e},{})})}},R=D,L=(a("81e3"),Object(w["a"])(R,S,k,!1,null,"45a04c15",null)),$=L.exports,N=a("b1cd"),E=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("cancel")}}},["read"!==e.mode?a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("\n    保存\n  ")]):e._e(),a("el-collapse",{staticClass:"wrapper-collapse",model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[a("el-collapse-item",{attrs:{title:"通用内容",name:"normal"}},[a("el-form",{attrs:{"label-width":"120px"}},[a("el-form-item",{attrs:{label:"内容资源"}},[a("el-select",{directives:[{name:"show",rawName:"v-show",value:"read"!==e.mode,expression:"mode !== 'read'"}],staticStyle:{"margin-bottom":"10px"},attrs:{filterable:""},model:{value:e.normalContentWrapper.selectionType,callback:function(t){e.$set(e.normalContentWrapper,"selectionType",t)},expression:"normalContentWrapper.selectionType"}},[a("el-option",{attrs:{value:"manual",label:"手动添加"}})],1),"read"!==e.mode?a("div",[e.isInterveneBlock?e._e():a("ResourceSelector",{ref:"resourceSelector",attrs:{"is-live":!1,"disable-partner":!!e.source,selectors:["video","app","edu","pptv","live","topic","rotate","good"],"selection-type":"multiple",source:e.source},on:{"select-end":e.handleSelectResourcesEnd}},[a("el-button",[e._v("批量选择资源")])],1)],1):e._e(),a("div",{staticClass:"normal-content-wrapper__list"},[a("div",{staticClass:"added-contents-wrapper",attrs:{gutter:8}},[a("read"===e.mode?"div":"draggable",{tag:"component",staticClass:"added-contents-list",on:{start:e.handleDragConentStart,end:function(t){return e.handleDragConentEnd(t,"normal")}},model:{value:e.normalContentList,callback:function(t){e.normalContentList=t},expression:"normalContentList"}},e._l(e.normalContentList,function(t,n){return a("el-card",{key:n,class:{activeContent:"normal"===e.activeType&&n===e.activeIndex},attrs:{"body-style":{padding:"0px"}},nativeOn:{click:function(t){return e.handleActivate("normal",n)}}},["read"!==e.mode&&e.normalContentList.length>1?a("i",{staticClass:"remove-handle el-icon-close",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleRemoveContent(n,"normal")}}}):e._e(),a("img",{attrs:{referrerpolicy:"no-referrer",src:e.getPictureUrl(t.pictureUrl)}})])}),1),"read"!==e.mode?a("el-card",{nativeOn:{click:function(t){return e.handleAddContent("normal")}}},[a("i",{staticClass:"el-icon-plus"},[e._v("添加资源")])]):e._e()],1),"normal"===e.activeType?a("BlockForm",{key:"active_index_"+e.activeIndex,ref:"normalBlockForm",attrs:{mode:e.mode,"check-crowd":e.checkCrowd,"content-type":"normal",source:e.source,data:e.data,pannel:e.pannel,"pannel-group-id":e.pannelGroupId,"content-form":e.contentForm,"hide-title-options":e.hideTitleOptions,"is-intervene-block":e.isInterveneBlock},on:{click:function(e){e.stopPropagation()},"cover-type-change":e.handleCoverTypeChange}}):e._e()],1)],1)],1)],1),e.isInterveneBlock?e._e():a("el-collapse-item",{directives:[{name:"show",rawName:"v-show",value:"block"!==e.contentForm.coverType,expression:"contentForm.coverType !== 'block'"}],attrs:{title:"精细化定向内容",name:"specific"}},[a("el-row",{staticClass:"added-contents-wrapper",attrs:{gutter:8}},[a("read"===e.mode?"div":"draggable",{tag:"component",staticClass:"added-contents-list",on:{start:e.handleDragConentStart,end:function(t){return e.handleDragConentEnd(t,"specific")}},model:{value:e.specificContentList,callback:function(t){e.specificContentList=t},expression:"specificContentList"}},e._l(e.specificContentList,function(t,n){return a("el-card",{key:n,class:{activeContent:"specific"===e.activeType&&n===e.activeIndex},attrs:{"body-style":{padding:"0px"}},nativeOn:{click:function(t){return e.handleActivate("specific",n)}}},["read"!==e.mode?a("i",{staticClass:"remove-handle el-icon-close",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleRemoveContent(n,"specific")}}}):e._e(),a("img",{attrs:{referrerpolicy:"no-referrer",src:e.getPictureUrl(t.pictureUrl)}}),t.vContentId?a("span",{staticClass:"content-id"},[e._v(" "+e._s(t.vContentId)+" ")]):e._e()])}),1),"read"!==e.mode?a("el-card",{nativeOn:{click:function(t){return e.handleAddContent("specific")}}},[a("i",{staticClass:"el-icon-plus"},[e._v("添加资源")])]):e._e()],1),"specific"===e.activeType?a("BlockForm",{ref:"specificBlockForm",attrs:{"content-type":"specific",mode:e.mode,"check-crowd":e.checkCrowd,data:e.data,source:e.source,"pannel-group-id":e.pannelGroupId,pannel:e.pannel,"content-form":e.contentForm,"hide-title-options":e.hideTitleOptions,"is-intervene-block":e.isInterveneBlock},on:{click:function(e){e.stopPropagation()},"cover-type-change":e.handleCoverTypeChange}}):e._e()],1)],1)],1)},O=[],A=(a("7f7f"),a("768b")),V=a("75fc"),B=a("310e"),M=a.n(B),U=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.contentForm?a("el-form",{ref:"contentForm",staticClass:"block-content-form",attrs:{model:e.contentForm,rules:e.contentRule,"label-width":"160px"}},["specific"===e.contentType?[a("el-form-item",{attrs:{label:"内容类别",prop:"resourceType"}},[a("el-radio-group",{attrs:{disabled:e.isReadonly},model:{value:e.contentForm.resourceType,callback:function(t){e.$set(e.contentForm,"resourceType",t)},expression:"contentForm.resourceType"}},[a("el-radio",{attrs:{label:0}},[e._v("内容")]),a("el-radio",{attrs:{label:1}},[e._v("活动")])],1)],1),a("el-form-item",{attrs:{label:"关联定向人群",prop:"dmpRegistryInfo"}},[a("el-button",{attrs:{type:"primary",disabled:e.isReadonly},on:{click:e.handleSelectCrowdStart}},[e._v("添加人群")]),e.contentForm.dmpRegistryInfo?a("el-tag",{attrs:{type:"primary"}},[e._v("已选择: "+e._s(e.contentForm.dmpRegistryInfo.dmpPolicyName)+"("+e._s(e.contentForm.dmpRegistryInfo.dmpPolicyId)+") / "+e._s(e.contentForm.dmpRegistryInfo.dmpCrowdName)+"("+e._s(e.contentForm.dmpRegistryInfo.dmpCrowdId)+")")]):e._e()],1)]:e._e(),a("el-form-item",{attrs:{label:"资源类别",prop:"coverType"}},[a("CommonSelector",{attrs:{disabled:e.isReadonly,type:"radio-button",value:e.contentForm.coverType,disabledItems:e.disabledCoverTypes,hiddenItems:e.hiddenCoverTypes,options:e.$consts.panelCoverTypeOptions},on:{input:function(t){return e.$emit("cover-type-change",t)}}})],1),"tvLive"===e.contentForm.coverType?a("div",{key:"tvLive"},[a("el-form-item",{attrs:{label:"广电直播app资源选择",prop:"tvLiveInfo"}},[a("CommonSelector",{attrs:{disabled:e.isReadonly,type:"radio",value:e.contentForm.tvLiveInfo.clickType,options:e.GD_LIVE_CLICK_TYPE_OPTIONS},on:{input:e.handleInputGDLiveClickType}})],1),e.contentForm.tvLiveInfo.clickType===e.GD_LIVE_CLICK_TYPES.channel?a("el-form-item",{key:"channelSelector",attrs:{prop:"tvLiveInfo.channelId",label:"频道选择"}},[e.isReadonly?e._e():a("GDChannelSelector",{attrs:{title:"选择频道","selection-type":"single"},on:{"select-end":e.handleSelectGDChannelEnd}}),e.contentForm.tvLiveInfo.channelId?[e._v("\n          已选择: "),a("el-tag",[e._v(e._s(e.contentForm.tvLiveInfo.channelId))])]:e._e()],2):e._e(),e.contentForm.tvLiveInfo.clickType===e.GD_LIVE_CLICK_TYPES.telecast?a("el-form-item",{attrs:{prop:"tvLiveInfo.channelId",label:"节目选择"}},[e.isReadonly?e._e():a("GDChannelSelector",{key:"scheduleSelector",attrs:{hasSchedule:"",title:"选择节目","selection-type":"single"},on:{"select-end":e.handleSelectGDChannelEnd}}),e.contentForm.tvLiveInfo.channelId?[e._v("\n          已选择: "),a("el-tag",[e._v(e._s(e.contentForm.tvLiveInfo.channelId))]),a("el-tag",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.contentForm.extraValue1))])]:e._e()],2):e._e()],1):e._e(),"maskLife"===e.contentForm.coverType?[a("el-form-item",{attrs:{label:"生活方式资源选择",prop:"coverType"}},[a("CommonSelector",{attrs:{disabled:e.isReadonly,type:"radio",value:e.contentForm.maskLifeInfo.lifeType,options:e.MASK_LIFE_TYPE_OPTIONS},on:{input:e.handleInputMaskLifeType}})],1),e.contentForm.maskLifeInfo.lifeType===e.MASK_LIFE_TYPES.video?a("el-form-item",{attrs:{label:"选择视频资源"}},[a("MaskVideoSelector",{directives:[{name:"show",rawName:"v-show",value:!e.isReadonly,expression:"!isReadonly"}],attrs:{title:"选择视频","selection-type":"single"},on:{"select-end":e.handleSelectMaskVideoEnd}}),a("span",{directives:[{name:"show",rawName:"v-show",value:e.maskLifeInfo.videoId,expression:"maskLifeInfo.videoId"}]},[e._v("\n            已选择: "+e._s(e.maskLifeInfo.videoId)+"\n            "),a("i",{directives:[{name:"show",rawName:"v-show",value:!e.isReadonly,expression:"!isReadonly"}],staticClass:"el-icon-close btn-remove-icon",on:{click:e.handleRemoveMaskVideo}})])],1):e._e(),e.contentForm.maskLifeInfo.lifeType===e.MASK_LIFE_TYPES.authorMain?a("el-form-item",{key:"authorId",attrs:{label:"选择视频资源",prop:"maskLifeInfo.authorId",rules:e.contentRule.authorId}},[e.isReadonly?e._e():a("MaskAuthorSelector",{attrs:{title:"选择作者","selection-type":"single"},on:{"select-end":e.handleSelectAuthorEnd}}),a("span",{directives:[{name:"show",rawName:"v-show",value:e.maskLifeInfo.authorId,expression:"maskLifeInfo.authorId"}]},[e._v(" 已选择: "+e._s(e.maskLifeInfo.authorName)+" ("+e._s(e.maskLifeInfo.authorId)+") ")])],1):e._e(),e.contentForm.maskLifeInfo.lifeType===e.MASK_LIFE_TYPES.authorCategory?a("el-form-item",{key:"category",attrs:{label:"选择视频资源"}},[e.isReadonly?e._e():a("KnowledgeTagSelector",{attrs:{title:"选择知识","selection-type":"single"},on:{"select-end":e.handleSelectKnowledgeTagEnd}}),a("span",{directives:[{name:"show",rawName:"v-show",value:e.maskLifeInfo.categoryId,expression:"maskLifeInfo.categoryId"}]},[e._v("\n          已选择: "+e._s(e.maskLifeInfo.categoryName)+" ("+e._s(e.maskLifeInfo.categoryId)+")\n          "),a("i",{directives:[{name:"show",rawName:"v-show",value:!e.isReadonly,expression:"!isReadonly"}],staticClass:"el-icon-close btn-remove-icon",on:{click:e.handleRemoveKnowledgeTag}})])],1):e._e(),"video"===e.maskLifeInfo.lifeType?[a("el-form-item",{attrs:{label:"视频点击跳转"}},[a("el-radio-group",{attrs:{disabled:e.isReadonly,value:e.maskLifeInfo.recommendType},on:{input:e.handleInputRecommendType}},e._l(e.MASK_LIFE_RECOMMEND_TYPE_OPTIONS,function(t){return a("el-radio",{key:t.value,attrs:{label:t.value}},[e._v("\n              "+e._s(t.label)+"\n            ")])}),1)],1),e.maskLifeInfo.recommendType===e.MASK_LIFE_RECOMMEND_TYPES.category?a("el-form-item",{key:"rec-category",attrs:{label:"知识",prop:"maskLifeInfo.categoryId",rules:e.contentRule.categoryId}},[e.maskLifeInfo.videoId?[a("el-select",{attrs:{filterable:"",disabled:e.isReadonly,value:e.maskLifeInfo.categoryId},on:{input:function(t){return e.handleInputRecommendCategory(e.maskLifeInfo,t)},"visible-change":function(t){return e.initVideoInfo(e.maskLifeInfo)}}},e._l(e.getCategoryOptions(e.maskLifeInfo),function(e){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})}),1)]:[e.isReadonly?e._e():a("KnowledgeTagSelector",{attrs:{title:"选择知识","selection-type":"single"},on:{"select-end":e.handleSelectRecommendKnowledgeTagEnd}}),a("span",{directives:[{name:"show",rawName:"v-show",value:e.maskLifeInfo.categoryId,expression:"maskLifeInfo.categoryId"}]},[e._v(" 已选择: "+e._s(e.maskLifeInfo.categoryName)+" ("+e._s(e.maskLifeInfo.categoryId)+")")])]],2):e._e(),e.maskLifeInfo.videoId||e.maskLifeInfo.recommendType!==e.MASK_LIFE_RECOMMEND_TYPES.author?e._e():a("el-form-item",{key:"rec-author",attrs:{label:"作者",prop:"maskLifeInfo.authorId",rules:e.contentRule.authorId}},[e.isReadonly?e._e():a("MaskAuthorSelector",{attrs:{title:"选择作者","selection-type":"single"},on:{"select-end":e.handleSelectRecommendAuthorEnd}}),a("span",{directives:[{name:"show",rawName:"v-show",value:e.maskLifeInfo.authorId,expression:"maskLifeInfo.authorId"}]},[e._v(" 已选择: "+e._s(e.maskLifeInfo.authorName)+" ("+e._s(e.maskLifeInfo.authorId)+") ")])],1)]:e._e()]:e._e(),"media"===e.contentForm.coverType?a("el-form-item",{key:"coverTypeMedia",attrs:{label:"内容资源",prop:"extraValue1"}},[e.isReadonly?e._e():a("ResourceSelector",{ref:"resourceSelector",attrs:{"is-live":!1,"disable-partner":!!e.source,selectors:["video","edu","pptv","live","topic","rotate"],"selection-type":"single","id-type":e.idType,source:e.source},on:{"select-end":e.handleSelectMediaEnd}},[a("el-button",[e._v("选择资源")])],1),e.contentForm.extraValue1?a("el-tag",{attrs:{type:"primary"}},[e._v("已选择: "+e._s(e.contentForm.extraValue1))]):e._e(),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.isReadonly&&e.contentForm.extraValue1,expression:"!isReadonly && contentForm.extraValue1"}],attrs:{plain:"",type:"primary"},on:{click:e.handleAddTagStart}},[e._v("打标签")])],1):e._e(),"app"===e.contentForm.coverType?a("el-form-item",{key:"coverTypeApp",attrs:{label:"内容资源",prop:"extraValue1"}},[e.isReadonly?e._e():a("ResourceSelector",{ref:"resourceSelector",attrs:{"is-live":!1,selectors:["app"],"disable-partner":!!e.source,"selection-type":"single","id-type":e.idType,source:e.source},on:{"select-end":e.handleSelectAppEnd}},[a("el-button",[e._v("选择资源")])],1),e.contentForm.extraValue1?a("el-tag",{attrs:{type:"primary"}},[e._v("已选择: "+e._s(e.contentForm.extraValue1))]):e._e()],1):e._e(),"mall"===e.contentForm.coverType?a("el-form-item",{key:"coverTypeMall",attrs:{label:"内容资源",prop:"extraValue1"}},[e.isReadonly?e._e():a("ResourceSelector",{ref:"resourceSelector",attrs:{"is-live":!1,selectors:["good"],"selection-type":"single","id-type":e.idType,"auto-fetch-selectors":["good"]},on:{"select-end":e.handleSelectGoodEnd}},[a("el-button",[e._v("选择商品")])],1),e.contentForm.extraValue1?a("el-tag",{attrs:{type:"primary"}},[e._v("已选择: "+e._s(e.contentForm.extraValue1))]):e._e()],1):e._e(),"specfic"===e.contentType?["custom"===e.contentForm.coverType?a("el-form-item",{attrs:{label:"内容类型"}},[a("el-select",{attrs:{filterable:"",disabled:e.isReadonly},model:{value:e.contentForm.blockResourceType,callback:function(t){e.$set(e.contentForm,"blockResourceType",t)},expression:"contentForm.blockResourceType"}},[a("el-option",{attrs:{label:"影视",value:1}}),a("el-option",{attrs:{label:"应用",value:0}}),a("el-option",{attrs:{label:"其他",value:-1}})],1)],1):e._e()]:e._e(),a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{attrs:{clearable:"",disabled:e.isReadonly},model:{value:e.contentForm.title,callback:function(t){e.$set(e.contentForm,"title","string"===typeof t?t.trim():t)},expression:"contentForm.title"}}),e.hideTitleOptions?e._e():a("el-checkbox",{attrs:{value:!e.contentForm.showTitle,disabled:e.isReadonly},on:{input:function(t){e.contentForm.showTitle=t?0:1}}},[e._v("\n        关闭标题栏，仅图片运营\n      ")])],1),"block"!==e.contentForm.coverType?a("el-form-item",{attrs:{label:"副标题",prop:"subTitle"}},[a("el-input",{attrs:{clearable:"",disabled:e.isReadonly},model:{value:e.contentForm.subTitle,callback:function(t){e.$set(e.contentForm,"subTitle","string"===typeof t?t.trim():t)},expression:"contentForm.subTitle"}}),a("el-checkbox",{attrs:{value:!e.contentForm.showSubTitle,disabled:e.isReadonly},on:{input:function(t){e.contentForm.showSubTitle=t?0:1}}},[e._v("\n        落焦不显示副标题\n      ")])],1):e._e(),a("el-form-item",{attrs:{label:"单集副标题",prop:"singleSubTitle"}},[a("el-input",{attrs:{clearable:"",disabled:e.isReadonly},model:{value:e.contentForm.singleSubTitle,callback:function(t){e.$set(e.contentForm,"singleSubTitle","string"===typeof t?t.trim():t)},expression:"contentForm.singleSubTitle"}}),e._v(" 有单集副标题时，优先显示单集副标题\n    ")],1),"block"!==e.contentForm.coverType?a("el-form-item",{attrs:{label:"内容海报",prop:"pictureUrl"}},[a("GlobalPictureSelector",{attrs:{disabled:e.isReadonly,"picture-resolution":e.resolution[0]+"*"+e.resolution[1],resource:e.contentForm},on:{"select-end":e.handleSelectPostEnd}},[a("div",{staticClass:"post-box corner-box",style:{height:e.postSize.height+"px",width:e.postSize.width+"px",cursor:"pointer"}},[e.contentForm.pictureUrl?a("img",{attrs:{referrerpolicy:"no-referrer",src:e.contentForm.pictureUrl}}):e._e(),a("div",{staticClass:"post-info"},[[1,2,9,4,5].indexOf(e.contentForm.categoryId)>-1?a("div",{staticClass:"post-episode"},[e.contentForm.showSeries?a("span",{staticClass:"episode"},[1===e.contentForm.categoryId||2===e.contentForm.categoryId||9===e.contentForm.categoryId?[e._v("\n                  "+e._s("ended"===e.contentForm.publishStatus?e.contentForm.series?e.contentForm.series+"集全":"暂无":e.contentForm.series?"已更新至"+e.contentForm.series+"集":"暂无")+"\n                ")]:5===e.contentForm.categoryId?[e._v("\n                  "+e._s("ended"===e.contentForm.publishStatus?"":e.contentForm.variety?e.contentForm.variety:"暂无")+"\n                ")]:e._e()],2):e._e(),e.contentForm.showScore?a("span",{staticClass:"score"},[e._v(e._s(e.contentForm.score?e.contentForm.score+"分":""))]):e._e()]):e._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:e.contentForm.showTitle,expression:"contentForm.showTitle"}],staticClass:"post-title",attrs:{title:e.contentForm.title}},[e._v("\n              "+e._s(e.contentForm.title)+"\n            ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.contentForm.showTitle&&e.contentForm.showSubTitle,expression:"contentForm.showTitle && contentForm.showSubTitle"}],staticClass:"post-sub-title",attrs:{title:e.contentForm.singleSubTitle||e.contentForm.subTitle}},[e._v("\n              "+e._s(e.contentForm.singleSubTitle||e.contentForm.subTitle)+"\n            ")])]),e._l(e.contentForm.cornerList,function(t,n){return a("span",{key:n,class:["corner","corner-"+n],on:{click:function(e){e.stopPropagation()}}},[a("CornerSelector",{attrs:{disabled:e.isReadonly,position:n},on:{"select-end":function(t){return e.handleSelectCornerIconEnd(t,n)}}},[t.imgUrl?a("span",{staticClass:"corner-img-wrapper"},[a("img",{attrs:{referrerpolicy:"no-referrer",src:t.imgUrl}}),a("i",{directives:[{name:"show",rawName:"v-show",value:!e.isReadonly,expression:"!isReadonly"}],staticClass:"el-icon-circle-close",attrs:{title:"删除角标"},on:{click:function(t){return t.stopPropagation(),e.handleRemoveCornerIcon(n)}}})]):a("div",{staticClass:"corner-add-icon-wrapper"},[a("i",{staticClass:"el-icon-plus"})])])],1)})],2)]),a("div",[a("el-checkbox",{attrs:{value:!e.contentForm.showSeries,disabled:e.isReadonly},on:{input:function(t){e.contentForm.showSeries=t?0:1}}},[e._v("\n          不展示期数\n        ")]),a("el-checkbox",{attrs:{value:!e.contentForm.showScore,disabled:e.isReadonly},on:{input:function(t){e.contentForm.showScore=t?0:1}}},[e._v("\n          不展示评分\n        ")])],1)],1):e._e(),e.shouldHaveBackupPicture?a("el-form-item",{attrs:{label:"替补海报",prop:"alternativePictureUrl"}},[a("GlobalPictureSelector",{attrs:{"picture-resolution":e.resolution[0]+"*"+e.resolution[1]},on:{"select-end":e.handleSelectBackupPostEnd}},[a("div",{staticClass:"post-box",style:{height:e.postSize.height+"px",width:e.postSize.width+"px",cursor:"pointer"}},[a("img",{attrs:{referrerpolicy:"no-referrer",src:e.contentForm.alternativePictureUrl}})])])],1):e._e(),"media"!==e.contentForm.coverType||e.isInterveneBlock?e._e():[a("el-form-item",{attrs:{label:"配置高清背景图和视频"}},[a("el-switch",{attrs:{disabled:e.isReadonly,"active-color":"#13ce66","inactive-color":"grey"},model:{value:e.isShowConfigBg,callback:function(t){e.isShowConfigBg=t},expression:"isShowConfigBg"}})],1),e.isShowConfigBg?a("el-form-item",{attrs:{label:"背景视频",prop:"bgParams.id"}},[e.isReadonly?e._e():a("ResourceSelector",{ref:"resourceSelector",attrs:{"is-live":!1,"disable-partner":!!e.source,selectors:["video","edu","pptv","live","topic","rotate"],"selection-type":"single",source:e.source,"id-type":e.idType},on:{"select-end":e.handleSelectBgMediaEnd}},[a("el-button",[e._v("选择资源")])],1),e.contentForm.bgParams&&e.contentForm.bgParams.id?a("el-tag",{attrs:{type:"primary",closable:!e.isReadonly},on:{close:e.handleRemoveBgMedia}},[e._v("\n          已选择: "+e._s(e.contentForm.bgParams.id)+" "+e._s(e.contentForm.bgParams.title?"("+e.contentForm.bgParams.title+")":"")+"\n        ")]):e._e()],1):e._e(),e.isShowConfigBg?a("el-form-item",{attrs:{label:"背景图",prop:"bgImgUrl"}},[a("GlobalPictureSelector",{attrs:{disabled:e.isReadonly},on:{"select-end":e.handleSelectBgEnd}},[e.contentForm.bgImgUrl?a("div",{staticClass:"bg-img-wrapper"},[a("img",{staticClass:"bg-img",attrs:{referrerpolicy:"no-referrer",src:e.contentForm.bgImgUrl}}),a("i",{directives:[{name:"show",rawName:"v-show",value:!e.isReadonly&&e.contentForm.bgImgUrl,expression:"!isReadonly && contentForm.bgImgUrl"}],staticClass:"el-icon-close",attrs:{title:"删除背景"},on:{click:function(t){t.stopPropagation(),e.contentForm.bgImgUrl=""}}})]):a("div",{staticClass:"bg-placeholder"})])],1):e._e()],"block"===e.contentForm.coverType?a("el-form-item",{attrs:{label:"推荐位",prop:"vContentId"}},[e.isReadonly?e._e():a("ResourceSelector",{ref:"blockSelector",attrs:{"is-live":!1,selectors:["func","broadcast"],"selection-type":"single",source:e.source,"id-type":e.idType,"before-select-end-cbs":e.beforeSelectBlockCbs},on:{"select-end":e.handleSelectBlockEnd}},[a("el-button",[e._v("选择推荐位")])],1),e.contentForm.vContentId?a("el-tag",{attrs:{type:"primary"}},[e._v("已选择: "+e._s(e.contentForm.vContentId))]):e._e()],1):e._e(),e.isMall&&["custom","media","app"].indexOf(e.contentForm.coverType)>-1?a("el-form-item",{attrs:{label:"价格",prop:"price"}},[a("Price",{staticStyle:{"margin-right":"10px"},attrs:{clearable:"",min:"0",disabled:e.isReadonly},model:{value:e.contentForm.price,callback:function(t){e.$set(e.contentForm,"price","string"===typeof t?t.trim():t)},expression:"contentForm.price"}}),e._v("(元)\n    ")],1):e._e(),e.isMall&&["custom","media","app"].indexOf(e.contentForm.coverType)>-1?a("el-form-item",{attrs:{label:"秒杀价",prop:"secKillPrice"}},[a("Price",{staticStyle:{"margin-right":"10px"},attrs:{clearable:"",min:"0",disabled:e.isReadonly},model:{value:e.contentForm.secKillPrice,callback:function(t){e.$set(e.contentForm,"secKillPrice","string"===typeof t?t.trim():t)},expression:"contentForm.secKillPrice"}}),e._v("(元)\n    ")],1):e._e(),"custom"===e.contentForm.coverType?[a("el-form-item",{attrs:{label:"打开方式"}},[a("el-select",{attrs:{disabled:e.isReadonly},on:{change:e.handleOpenModeChange},model:{value:e.contentForm.redundantParams.openMode,callback:function(t){e.$set(e.contentForm.redundantParams,"openMode",t)},expression:"contentForm.redundantParams.openMode"}},[a("el-option",{attrs:{label:"网页",value:"webpage"}}),a("el-option",{attrs:{label:"视频",value:"video"}}),a("el-option",{attrs:{label:"图片",value:"picture"}}),a("el-option",{attrs:{label:"版面",value:"tab"}}),a("el-option",{attrs:{label:"第三方应用",value:"app"}})],1),e.isReadonly?e._e():a("ClickEventSelector",{directives:[{name:"show",rawName:"v-show",value:"app"===e.contentForm.redundantParams.openMode,expression:"contentForm.redundantParams.openMode === 'app'"}],on:{"select-end":e.handleSelectClickEventEnd}},[a("el-button",{attrs:{type:"primary"}},[e._v("快速填充")])],1)],1),"webpage"===e.contentForm.redundantParams.openMode?[a("el-form-item",{attrs:{label:"网页类型",prop:"webpageType"}},[a("el-radio-group",{attrs:{disabled:e.isReadonly},on:{change:e.handleWebPageTypeChange},model:{value:e.contentForm.redundantParams.webpageType,callback:function(t){e.$set(e.contentForm.redundantParams,"webpageType",t)},expression:"contentForm.redundantParams.webpageType"}},[a("el-radio",{attrs:{label:"1"}},[e._v("浮窗网页")]),a("el-radio",{attrs:{label:"2"}},[e._v("全屏网页")])],1)],1),a("el-form-item",{key:"webpageUrl",attrs:{label:"网页地址",prop:"redundantParams.webpageUrl",rules:e.contentRule.webpageUrl}},[a("el-input",{attrs:{clearable:"",disabled:e.isReadonly},model:{value:e.contentForm.redundantParams.webpageUrl,callback:function(t){e.$set(e.contentForm.redundantParams,"webpageUrl","string"===typeof t?t.trim():t)},expression:"contentForm.redundantParams.webpageUrl"}})],1),a("el-form-item",{key:"webpage-versioncode",attrs:{label:"应用版本号",prop:"redundantParams.versioncode",rules:e.contentRule.versioncode}},[a("el-input",{attrs:{clearable:"",disabled:e.isReadonly},model:{value:e.contentForm.redundantParams.versioncode,callback:function(t){e.$set(e.contentForm.redundantParams,"versioncode","string"===typeof t?t.trim():t)},expression:"contentForm.redundantParams.versioncode"}})],1)]:e._e(),"video"===e.contentForm.redundantParams.openMode?[a("el-form-item",{key:"videoName",attrs:{label:"视频名称",prop:"redundantParams.videoName",rules:e.contentRule.videoName}},[a("el-input",{attrs:{clearable:"",disabled:e.isReadonly},model:{value:e.contentForm.redundantParams.videoName,callback:function(t){e.$set(e.contentForm.redundantParams,"videoName","string"===typeof t?t.trim():t)},expression:"contentForm.redundantParams.videoName"}})],1),a("el-form-item",{key:"videoUrl",attrs:{label:"视频地址",prop:"redundantParams.videoUrl",rules:e.contentRule.videoUrl}},[a("el-input",{attrs:{clearable:"",disabled:e.isReadonly},model:{value:e.contentForm.redundantParams.videoUrl,callback:function(t){e.$set(e.contentForm.redundantParams,"videoUrl","string"===typeof t?t.trim():t)},expression:"contentForm.redundantParams.videoUrl"}})],1)]:e._e(),"picture"===e.contentForm.redundantParams.openMode?[a("el-form-item",{key:"pictureUrl",attrs:{label:"选择图片",prop:"redundantParams.pictureUrl",rules:e.contentRule.pictureUrl}},[a("Upload",{ref:"upload",attrs:{multiple:!1,accept:"image/jpg,image/jpeg,image/png,image/bmp,image/gif"},on:{upload:e.handleUpload},scopedSlots:e._u([{key:"preview",fn:function(t){var n=t.fileList;return a("div",{staticClass:"upload-pic-list"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isReadonly&&0===n.length,expression:"!isReadonly && fileList.length === 0"}],staticClass:"upload-pic-list__add",on:{click:function(t){!e.isReadonly&&e.$refs.upload.handleSelectFile()}}}),n.length>0?a("div",{staticClass:"upload-pic-list__item",on:{click:function(t){!e.isReadonly&&e.$refs.upload.handleSelectFile()}}},["error"===n[0].status?a("div",{staticClass:"upload-pic-list__error"},[e._v("\n                  上传失败: "+e._s(n[0].message)+"\n                ")]):e._e(),"uploading"===n[0].status?a("div",{staticClass:"upload-pic-list__progress"},[a("el-progress",{attrs:{width:100,type:"circle",percentage:n[0].percentage}})],1):a("img",{attrs:{src:n[0].dataUrl}}),"uploading"===n[0].status||e.isReadonly?e._e():a("i",{staticClass:"upload-pic-list__remove el-icon el-icon-close",attrs:{title:"移除"},on:{click:function(t){return t.stopPropagation(),e.handleRemovePicture(n[0])}}})]):e._e()])}}],null,!1,64832960)}),a("span",[e._v("提示:只能上传png/gif/jpg/bmp文件")])],1)]:e._e(),"tab"===e.contentForm.redundantParams.openMode?[a("el-form-item",{key:"tabId",attrs:{label:"版面",prop:"redundantParams.tabId",rules:e.contentRule.tabId}},[a("TabSelector",{attrs:{disabled:e.isReadonly,title:"选择版面","selection-type":"single",source:e.source,"selected-close":!0},on:{"select-end":e.handleSelectTabEnd}}),e.contentForm.redundantParams.tabId?a("el-tag",{attrs:{type:"primary"}},[e._v("\n            已选择: "+e._s(e.contentForm.redundantParams.tabId)+"\n          ")]):e._e()],1)]:e._e(),"app"===e.contentForm.redundantParams.openMode?[e.isReadonly?a("div",[a("AppParamsRead",{attrs:{value:e.contentForm.redundantParams}}),a("Params",{attrs:{readonly:!0,params:e.contentForm.appParams,"prop-prefix":"appParams."}})],1):a("div",[a("AppParamsForm",{key:"app",attrs:{"label-width":"140px","prop-prefix":"redundantParams."},model:{value:e.contentForm.redundantParams,callback:function(t){e.$set(e.contentForm,"redundantParams",t)},expression:"contentForm.redundantParams"}}),a("Params",{attrs:{params:e.contentForm.appParams,"prop-prefix":"appParams."}})],1)]:e._e()]:e._e(),"block"===e.contentForm.coverType||e.isInterveneBlock?e._e():a("el-form-item",{attrs:{label:"开启个性化推荐"}},[a("el-switch",{attrs:{disabled:e.isReadonly,value:!!e.contentForm.flagSetRec,"active-color":"#13ce66","inactive-color":"grey"},on:{input:e.handleInputFlagSetRec}})],1),e.contentForm.flagSetRec?[a("RecommendStreamSelector",{attrs:{value:0===e.contentForm.mediaAutomationBlockRls.type?e.contentForm.mediaAutomationBlockRls.mediaAutomationId:"",disabled:e.isReadonly,source:e.source,resolution:e.resolution[0]+"*"+e.resolution[1]},on:{"select-end":e.handleSelectRecomStream,"del-select":function(t){e.contentForm.mediaAutomationBlockRls.mediaAutomationId=void 0}}}),a("NewBlockRecStreamSelector",{staticStyle:{margin:"0 0 10px 160px"},attrs:{title:"选择新推荐流","selection-type":"single",source:e.source,scene:e.scene,disabled:e.isReadonly},on:{"select-end":e.handleSelectBlockRecStreamEnd}}),!0===e.isReadonly&&1===e.contentForm.mediaAutomationBlockRls.type?[e._v("\n            已选择: "),1===e.contentForm.mediaAutomationBlockRls.type?a("el-tag",[e._v("\n            "+e._s(e.contentForm.mediaAutomationBlockRls.mediaAutomationId)+"("+e._s(e.contentForm.mediaAutomationBlockRls.mediaAutomationName)+")\n            ")]):e._e()]:e._e(),0==e.isReadonly&&1===e.contentForm.mediaAutomationBlockRls.type?[e._v("\n            已选择: "),1===e.contentForm.mediaAutomationBlockRls.type?a("el-tag",{attrs:{closable:"",disabled:e.isReadonly},on:{close:function(t){return e.handleDelTagClose(e.contentForm.mediaAutomationBlockRls)}}},[e._v("\n            "+e._s(e.contentForm.mediaAutomationBlockRls.mediaAutomationId)+"("+e._s(e.contentForm.mediaAutomationBlockRls.mediaAutomationName)+")\n            ")]):e._e()]:e._e()]:e._e(),e.contentForm.flagSetRec?a("el-form-item",{attrs:{label:"刷新机制",prop:"mediaAutomationBlockRls.refreshCal"}},[a("InputPositiveInt",{staticClass:"flash-count-input",attrs:{clearable:"",disabled:e.isReadonly},model:{value:e.contentForm.mediaAutomationBlockRls.refreshCal,callback:function(t){e.$set(e.contentForm.mediaAutomationBlockRls,"refreshCal",t)},expression:"contentForm.mediaAutomationBlockRls.refreshCal"}}),e._v("\n      客户端曝光X次之后刷新推荐位\n    ")],1):e._e(),"media"===e.contentForm.coverType?a("el-form-item",{attrs:{label:"开启推荐位引导标签"}},[a("el-switch",{attrs:{disabled:e.isReadonly,value:!!e.contentForm.flagTagVector,"active-color":"#13ce66","inactive-color":"grey"},on:{input:e.handleInputFlagTagVector}})],1):e._e(),"media"===e.contentForm.coverType?a("el-form-item",{attrs:{label:"应用版本号",prop:"versionCode"}},[a("el-input",{attrs:{clearable:"",disabled:e.isReadonly},model:{value:e.contentForm.versionCode,callback:function(t){e.$set(e.contentForm,"versionCode","string"===typeof t?t.trim():t)},expression:"contentForm.versionCode"}})],1):e._e(),"normal"===e.contentType?[e.isInterveneBlock||"group"===e.data.pannelParentType||"Mall"===e.data.blockInfo.type||"media"!==e.contentForm.coverType&&"app"!==e.contentForm.coverType&&"custom"!==e.contentForm.coverType?e._e():a("el-form-item",{attrs:{label:"设置广告位",prop:"flagIsSetad"}},[a("el-radio-group",{attrs:{disabled:e.isReadonly},model:{value:e.contentForm.flagIsSetad,callback:function(t){e.$set(e.contentForm,"flagIsSetad",t)},expression:"contentForm.flagIsSetad"}},[a("el-radio",{attrs:{label:0}},[e._v("否")]),a("el-radio",{attrs:{label:1}},[e._v("是")])],1)],1)]:e._e()],2):e._e(),e.showCrowdSelector?a("CrowdSelector",{on:{"select-cancel":e.handleSelectCrowdCancel,"select-end":e.handleSelectCrowdEnd}}):e._e(),e.showBlockTagDialog?a("TagFrame",{attrs:{ids:[e.currentResourceId]},on:{close:function(t){e.showBlockTagDialog=!1}}}):e._e()],1)},G=[],j=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-input",{attrs:{clearable:"",disabled:e.disabled},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}})},z=[],W=function(e){return parseFloat(e.toPrecision(12))},q={data:function(){return{inputValue:void 0}},props:["value","disabled","clearable"],watch:{inputValue:"updateValue",value:"updateInputValue"},methods:{updateValue:function(e){var t=+e;isNaN(t)||0===t||(e=W(100*e)),this.$emit("input",e)},updateInputValue:function(e){var t=W(e/100);isNaN(t)||0===t?this.inputValue=e:t!==+this.inputValue&&(this.inputValue=t)}},created:function(){this.updateInputValue(this.value)}},J=q,H=Object(w["a"])(J,j,z,!1,null,null,null),K=H.exports,Y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form-item",{attrs:{label:"应用包名",prop:e.formProp("packagename"),rules:e.rules.packagename}},[a("el-input",{attrs:{clearable:""},model:{value:e.inputValue.packagename,callback:function(t){e.$set(e.inputValue,"packagename","string"===typeof t?t.trim():t)},expression:"inputValue.packagename"}})],1),a("el-form-item",{attrs:{label:"应用版本号",prop:e.formProp("versioncode"),rules:e.rules.versioncode}},[a("el-input",{attrs:{clearable:""},model:{value:e.inputValue.versioncode,callback:function(t){e.$set(e.inputValue,"versioncode","string"===typeof t?t.trim():t)},expression:"inputValue.versioncode"}})],1),a("el-form-item",{attrs:{label:"启动动作",prop:e.formProp("dowhat"),rules:e.rules.dowhat}},[a("el-select",{model:{value:e.inputValue.dowhat,callback:function(t){e.$set(e.inputValue,"dowhat",t)},expression:"inputValue.dowhat"}},e._l(e.dowhatOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"启动方式",prop:e.formProp("bywhat"),rules:e.rules.bywhat}},[a("el-select",{model:{value:e.inputValue.bywhat,callback:function(t){e.$set(e.inputValue,"bywhat",t)},expression:"inputValue.bywhat"}},e._l(e.bywhatOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"启动参数",prop:e.formProp("byvalue"),rules:e.rules.byvalue}},[a("el-input",{attrs:{type:"textarea",clearable:""},model:{value:e.inputValue.byvalue,callback:function(t){e.$set(e.inputValue,"byvalue","string"===typeof t?t.trim():t)},expression:"inputValue.byvalue"}})],1),a("el-form-item",{attrs:{label:"数据配置",prop:"formProp('data')"}},[a("el-input",{attrs:{clearable:""},model:{value:e.inputValue.data,callback:function(t){e.$set(e.inputValue,"data","string"===typeof t?t.trim():t)},expression:"inputValue.data"}})],1),a("el-form-item",{attrs:{label:"扩展参数"}},[e._l(e.inputValue.params,function(t,n){return a("div",{key:n,staticClass:"app-extend-params"},[a("el-form-item",{attrs:{label:"key:","label-width":"60px",prop:e.formProp("params."+n+".key"),rules:e.rules.params.key}},[a("el-input",{attrs:{clearable:""},model:{value:t.key,callback:function(a){e.$set(t,"key","string"===typeof a?a.trim():a)},expression:"param.key"}})],1),a("el-form-item",{attrs:{label:"value:","label-width":"60px",prop:e.formProp("params."+n+".value"),rules:e.rules.params.value}},[a("el-input",{attrs:{clearable:""},model:{value:t.value,callback:function(a){e.$set(t,"value","string"===typeof a?a.trim():a)},expression:"param.value"}})],1),a("a",{staticClass:"app-params__remove-param",on:{click:function(t){return e.handleRemoveParam(n)}}},[a("i",{staticClass:"el-icon-minus"})])],1)}),a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleAddParam}},[a("i",{staticClass:"el-icon-plus"}),e._v(" 添加\n    ")])],2)],1)},Q=[],X={data:function(){var e=this,t=function(t,a,n){if(/[！￥……（）——【】：；“”‘’、《》，。？\s+]/.test(a))return n(new Error("请勿输入特殊或空白字符"));var i=e.inputValue.params.filter(function(e){var t=e.key;return t===a}).length>1;if(i)return n(new Error("key 不能重复"));n()},a=function(e,t,a){/[！￥……（）——【】：；“”‘’、《》，。？\s+]/.test(t)?a(new Error("请勿输入特殊或空白字符")):a()};return{inputValue:{packagename:void 0,versioncode:void 0,dowhat:void 0,bywhat:void 0,byvalue:void 0,data:void 0,params:[],exception:{}},rules:{packagename:[{required:!0,message:"请输入应用包名",trigger:"blur"}],versioncode:[{required:!0,message:"请输入应用版本号",trigger:"blur"},{validator:function(e,t,a){if(!/^(-1|\d*)$/.test(t))return a(new Error("应用版本号只能是数字或者-1"));a()}}],dowhat:[{required:!0,message:"请选择启动动作",trigger:"blur"}],bywhat:[{required:!0,message:"请选择启动方式",trigger:"blur"}],byvalue:[{required:!0,message:"请输入启动参数",trigger:"blur"}],params:{key:[{required:!0,message:"不能为空",trigger:"blur"},{validator:t,trigger:"blur"}],value:[{required:!0,message:"不能为空",trigger:"blur"},{validator:a,trigger:"blur"}]}}}},props:{value:{},propPrefix:{},dowhatOptions:{default:function(){return[{label:"startActivity",value:"startActivity"},{label:"startService",value:"startService"},{label:"sendBroadcast",value:"sendBroadcast"}]}},bywhatOptions:{default:function(){return[{label:"action",value:"action"},{label:"class",value:"class"},{label:"uri",value:"uri"}]}}},watch:{value:"setInputValue"},methods:{formProp:function(e){return(this.propPrefix||"")+e},genDefaultValue:function(){return{packagename:void 0,versioncode:void 0,dowhat:void 0,bywhat:void 0,byvalue:void 0,params:[]}},setInputValue:function(e){e!==this.inputValue&&(this.inputValue=Object.assign(this.genDefaultValue(),e))},emitInputValue:function(e){this.$emit("input",this.inputValue)},handleAddParam:function(){this.inputValue.params.push({key:void 0,value:void 0})},handleRemoveParam:function(e){this.inputValue.params.splice(e,1)}},created:function(){this.value&&this.setInputValue(this.value),this.$watch("inputValue",this.emitInputValue,{deep:!0})}},Z=X,ee=(a("d406"),Object(w["a"])(Z,Y,Q,!1,null,"323b6613",null)),te=ee.exports,ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form-item",{attrs:{label:"应用包名"}},[e._v(e._s(e.value.packagename))]),a("el-form-item",{attrs:{label:"应用版本号"}},[e._v(e._s(e.value.versioncode))]),a("el-form-item",{attrs:{label:"启动动作"}},[e._v(e._s(e.value.dowhat))]),a("el-form-item",{attrs:{label:"启动方式"}},[e._v(e._s(e.value.bywhat))]),a("el-form-item",{attrs:{label:"启动参数"}},[e._v(e._s(e.value.byvalue))]),a("el-form-item",{attrs:{label:"数据配置",prop:"formProp('data')"}},[e._v(e._s(e.value.data))]),a("el-form-item",{attrs:{label:"扩展参数"}},e._l(e.value.params,function(t,n){return a("div",{key:n,staticClass:"app-extend-params"},[a("el-form-item",{attrs:{label:"","label-width":"0px"}},[a("el-tag",[e._v("key")]),e._v(" \n        "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.key,placement:"top"}},[a("span",[e._v(e._s(t.key))])])],1),a("el-form-item",{attrs:{label:"","label-width":"0px"}},[a("el-tag",[e._v("value")]),e._v(" \n        "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.value,placement:"top"}},[a("span",[e._v(e._s(t.value))])])],1)],1)}),0)],1)},ne=[],ie={template:"#cc-app-params-read",data:function(){return{}},props:["value"],created:function(){}},re=ie,oe=(a("f146"),Object(w["a"])(re,ae,ne,!1,null,"7b0390e9",null)),le=oe.exports,se=a("4ef5"),ce=a("cc30"),ue=a("ea3f"),de=a("ce06"),pe=a("8353"),he=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("RemoteSelectorWrapper",{ref:"wrapper",attrs:{"custom-class":"resource-selector"},on:{"select-start":e.handleSelectStart},scopedSlots:e._u([{key:"content",fn:function(t){var n=t.isShow;return[e.isLive||n?a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"pannelGroupId","is-live":e.isLive,"selection-type":e.selectionType||"single",table:e.table,filter:e.filter,"filter-schema":null,pagination:e.pagination,"select-end-on-dbl-click":!0},on:{"pagination-change":e.fetchData,"filter-change":e.handleFilterChange,"filter-reset":e.handleResetFilter,"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}},[a("el-form",{attrs:{slot:"filter",model:e.filter,"label-width":"80px",inline:!0},nativeOn:{reset:function(t){return t.preventDefault(),e.handleResetFilter(t)},submit:function(t){return t.preventDefault(),e.handleFilterChange(t)}},slot:"filter"},[a("el-form-item",{attrs:{label:""}},[a("InputPositiveInt",{attrs:{clearable:"",placeholder:"ID"},model:{value:e.filter.commonOnclickId,callback:function(t){e.$set(e.filter,"commonOnclickId",t)},expression:"filter.commonOnclickId"}})],1),a("el-form-item",{attrs:{label:""}},[a("el-input",{attrs:{clearable:"",placeholder:"点击事件名称"},model:{value:e.filter.onlickName,callback:function(t){e.$set(e.filter,"onlickName","string"===typeof t?t.trim():t)},expression:"filter.onlickName"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary","native-type":"submit"}},[e._v("查询")]),a("el-button",{attrs:{"native-type":"reset"}},[e._v("重置")])],1)],1)],1):e._e()]}}])},[e._t("default")],2)},me=[],fe=a("42f0"),ve={components:{InputPositiveInt:g["a"],RemoteSelectorWrapper:P["a"],BaseSelector:fe["a"]},data:function(){return{pagination:{currentPage:1,pageSize:15,total:0},filter:this.getDefaultFilter(),efficientFilter:this.getDefaultFilter(),filterSchema:null,table:{props:{},header:[{label:"ID",prop:"commonOnclickId",width:"70"},{label:"点击事件名称",prop:"onlickName"},{label:"备注",prop:"remark"},{label:"修改人",prop:"modifierName"},{label:"修改时间",prop:"lastUpdateDate",width:"170"}],data:[],selected:[]},selected:[],originSelected:[]}},props:["isLive","source","selectionType"],methods:{handleSelectStart:function(){this.$emit("select-start"),this.fetchData()},handleSelectCancel:function(){this.$refs.wrapper.handleSelectCancel()},handleSelectEnd:function(e){this.$emit("select-end",e),this.$refs.wrapper.handleSelectEnd()},getDefaultFilter:function(){return{commonOnclickId:void 0,onlickName:void 0}},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleResetFilter:function(){this.filter=this.getDefaultFilter(),this.efficientFilter=this.getDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.pagination,t=JSON.parse(JSON.stringify(this.efficientFilter));return e&&(t.page=e.currentPage,t.rows=e.pageSize),t},fetchData:function(){var e=this,t=this.parseFilter();this.$service.getClickData(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){this.fetchData()}},ge=ve,be=Object(w["a"])(ge,he,me,!1,null,null,null),ye=be.exports,we=a("5b59"),Ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("FrameDialog",{attrs:{title:"批量打标签",url:e.url,"frame-style":{padding:"0 10px"},fullscreen:!0},on:{close:e.handleClose}})},Ce=[],Te=a("477b"),Se={components:{FrameDialog:Te["a"]},props:["ids","isBatch"],data:function(){return{}},computed:{url:function(){var e=this.ids||[],t=/^(127|172|beta)/.test(location.host)?"http://dev-mgr-media.tc.cc0808.com":"http://mgrnew.media.tc.skysrt.com";return t+"/#/ccGlobalMediaTag/com.html?origin=".concat(location.origin,"&referrer=homepage&enableDelete=0&coocaaVId=")+e.join(",")}},methods:{handleClose:function(){this.$emit("close")}},mounted:function(){window.addEventListener("message",this.handleClose)},beforeDestroy:function(){window.removeEventListener("message",this.handleClose)}},ke=Se,_e=Object(w["a"])(ke,Ie,Ce,!1,null,null,null),Pe=_e.exports,xe=[{label:"跳转到视频列表页",value:"video"},{label:"拉起到作者主页",value:"authorMain"},{label:"拉起到作者分类页",value:"authorCategory"},{label:"正常启动",value:"launch"}],Fe={video:"video",authorMain:"authorMain",authorCategory:"authorCategory",launch:"launch"},De=[{label:"随心看视频流",value:"recommend"},{label:"知识视频流",value:"category"},{label:"作者视频流",value:"author"}],Re={recommend:"recommend",category:"category",author:"author"},Le=[{label:"启动到频道",value:"channel"},{label:"正常启动",value:"normal"},{label:"启动到节目",value:"telecast"}],$e={channel:"channel",normal:"normal",telecast:"telecast"};function Ne(e){var t=e.category,a=void 0===t?"":t,n=e.categoryName,i=void 0===n?"":n,r=e.filterValue,o=void 0===r?"":r;a=a.split(","),i=i.split(","),o=o.split(",");var l=a.map(function(e,t){return{label:i[t],filterValue:o[t],value:e}});return{categoryOptions:l,authorId:e.userId,authorName:e.userName}}function Ee(e,t){var a=t[0]||{};if(t.length>1){var n=Object(A["a"])(e,2),i=n[0],r=n[1],o=i>r?"h":"v";a=t.find(function(e){return e.style===o})||a}return a.url}function Oe(e,t){var a,n=-99999;return e&&t&&t.forEach(function(t){var i=Ae(e,t.size.split(/[*|x]/));i>n&&(n=i,a=t.url)}),a}function Ae(e,t){var a,n=Object(A["a"])(e,2),i=n[0],r=n[1],o=Object(A["a"])(t,2),l=o[0],s=o[1],c=i/r,u=l/s,d=i>=r&&l>=s||i<=r&&l<=s,p=d?100:0,h=70-45*Math.abs(c-u);a=c>u?i>l?i/l:l/i:r>s?r/s:s/r;var m=Math.max(38-8*a,0);return p+h+m}function Ve(e,t){var a=t.selectedType,n=t.selected,i=t.selectedEpisode,r=t.blockSize,o=n._partner,l=function(){return Oe.apply(null,arguments)};if(Object.assign(e,{coverType:"media",vContentId:"",blockResourceType:"",platformId:"",versionCode:"",extraValue1:"",extraValue4:"",extraValue5:""}),"video"===a){if(i){var s={0:"extraValue5",1:"extraValue5",6:"extraValue4"},c={tencent:"_otx_",yinhe:"_oqy_",youku:"_oyk_"},u=s[i.urlIsTrailer]||"extraValue5",d=c[o];e.contentType=0,e.videoContentType="movie",6===i.urlIsTrailer&&i.thirdVId?e.extraValue1=d+i.thirdVId:e.extraValue1=d+n.coocaaVId;var p=i.thirdVuId,h=void 0===p?"":p,m=0===h.indexOf("bili");e[u]=m?h:i.coocaaMId,e.singleId=i.coocaaMId,e.pictureUrl=i.thumb,e.title=i.urlTitle,e.subTitle=We(i.urlSubTitle),e.singleSubTitle="",e.blockResourceType=1}else"tencent"===o?e.extraValue1="_otx_"+n.coocaaVId:"yinhe"===o?e.extraValue1="_oqy_"+n.coocaaVId:"youku"===o&&(e.extraValue1="_oyk_"+n.coocaaVId),e.singleId="",e.contentType=0,e.videoContentType="movie",e.extraValue5=void 0,e.platformId=n.source,e.pictureUrl=l(r,n.imageInfoList)||n.thumb,e.picturePreset=n.imageInfoList,e.title=n.title,e.subTitle=We(n.subTitle),e.singleSubTitle="",e.blockResourceType=1;var f=n.ccVideoSourceEntities[0],v=f.score,g=f.updatedSegment,b=f.publishSegment,y=0==b,w=y?"unknown":g===b?"ended":"updating";e.publishStatus=w,e.score=v,e.series=y?null:g,e.variety=f.lastCollection}else if("edu"===a){e.contentType=3;var I={2:"eduPicBook",3:"eduListenStory"};e.videoContentType=I[n.contentForm]||"edu",e.extraValue1="_otx_"+n.coocaaVId,e.platformId=n.source,e.pictureUrl=l(r,n.imageInfoList)||n.thumb,e.picturePreset=n.imageInfoList,e.title=n.title,e.subTitle=We(n.subTitle),e.singleSubTitle="",e.blockResourceType=1;var C=n.ccVideoSourceEntities;C&&C[0]&&1===C[0].isTvod&&(e.versionCode=342e4)}else"pptv"===a?(e.contentType=4,e.videoContentType="pptv",e.extraValue1="pptv_tvsports://tvsports_detail?section_id="+n.pid+"&from_internal=1",e.title=n.pTitle,e.subTitle=We(n.pTitle),e.singleSubTitle="",e.blockResourceType=1):"live"===a?(e.contentType=6,e.videoContentType="txLive",e.extraValue1=n.vId+"",e.platformId=n.source,e.pictureUrl=n.thumb,e.title=n.title,e.subTitle=We(n.subTitle),e.singleSubTitle="",e.blockResourceType=1):"topic"===a?("parentTopic"===n.dataSign?e.contentType=8:e.contentType=7,"parentTopic"===n.dataSign?e.videoContentType="bigTopic":e.videoContentType="topic",e.extraValue1=n.code+"",e.pictureUrl=l(r,n.imageInfoList)||n.picture,e.title=n.title,e.subTitle=We(n.subTitle),e.singleSubTitle="",e.blockResourceType=1):"rotate"===a&&(e.extraValue1=n.id+"",e.pictureUrl=n.picture,e.title=n.title,e.subTitle=We(n.subTitle),e.singleSubTitle="",e.blockResourceType=1,e.videoContentType="rotate");e.categoryId=n.categoryId,e.onclick=((n.ccVideoSourceEntities||[])[0]||{}).onclick}function Be(e,t){t&&(e.coverType="app",e.contentType=2,e.videoContentType="app",e.extraValue1=t.appPackageName,e.pictureUrl=t.appImageUrl,e.title=t.appName,e.subTitle=We(t.appName),e.singleSubTitle="",e.blockResourceType=3)}function Me(e,t){t&&(e.coverType="mall",e.contentType=13,e.videoContentType="mall",e.extraValue1=t.resourceId,e.pictureUrl=t.resourceImgUrl,e.title=t.resourceName,e.subTitle=We(t.resourceName),e.singleSubTitle="",e.blockResourceType=-1)}function Ue(e,t){t&&(e.coverType="media",e.contentType=0,e.videoContentType="movie",e.extraValue1=t.id,e.pictureUrl=t.images,e.title=t.title,e.subTitle=We(t.title),e.singleSubTitle="",e.blockResourceType=-1)}function Ge(e,t){var a=t.selected,n=a._partner,i={tencent:"_otx_",yinhe:"_oqy_",youku:"_oyk_"};a&&(e.coverType="media",e.contentType=0,e.videoContentType="movie",e.extraValue1=i[n]+a.trailerId,e.pictureUrl=a.picture,e.title=a.trailerTitle,e.thirdSource=a.thirdSource,e.subTitle=a.positiveTitle,e.singleSubTitle="",e.blockResourceType=-1,e.subscribeOnlineTime=a.onlineTime||"")}function je(e,t){var a=Object.keys(e).find(function(t){return e[t].length>0});return ze(e,a)}function ze(e,t){var a=e[t],n=e.episode||{};return{selectedType:t,selected:a,selectedEpisode:n}}function We(e){return(e||"").slice(0,45)}function qe(e,t){switch(e){case"media":return t.extraValue1;case"block":return t.vContentId;case"mall":return t.extraValue1}}function Je(e){e=e||{};var t=e.maskLifeInfo;return delete e.maskLifeInfo,Object(l["a"])({coverType:"media",title:"",showTitle:0,subTitle:"",showSubTitle:0,singleSubTitle:"",pictureUrl:"",showSeries:1,showScore:1,alternativePictureUrl:"",extraValue1:"",extraValue5:"",singleId:"",vContentId:"",resourceType:0,cornerList:[{},{}],blockResourceType:-1,moviePercent:100,jumpType:"detail",versionCode:"",price:"",secKillPrice:"",flagIsSetad:0,redundantParams:Ye(),bgImgUrl:"",flagSetRec:0,flagTagVector:0,mediaAutomationBlockRls:{refreshCal:1,mediaAutomationId:"",blockType:"normal"},bgParams:{id:"",title:""},bgType:"",appParams:[],maskLifeInfo:Ke(t),tvLiveInfo:void 0},e)}function He(e){return Object(l["a"])({clickType:$e.channel,categoryId:void 0,channelId:void 0,startTime:void 0},e)}function Ke(e){return Object(l["a"])({lifeType:"launch",videoId:"",authorId:"",authorName:"",categoryId:"",categoryName:"",recommendType:"recommend",filterValue:"",videoInfo:null},e)}function Ye(){return{openMode:"app",webpageUrl:"",webpageType:"2",videoName:"",videoUrl:"",pictureUrl:"",tabId:"",packagename:"",versioncode:"-1",dowhat:"startActivity",bywhat:"action",byvalue:"",data:void 0,params:[{key:"",value:""}]}}function Qe(e,t){var a=[].concat(Xe(e,t,"video"),et(e,t),Xe(e,t,"edu"),Xe(e,t,"pptv"),Xe(e,t,"live"),Xe(e,t,"topic"),Xe(e,t,"rotate"),tt(e,t));return a}function Xe(e,t,a){var n=ze(e,a),i=n.selectedType,r=n.selected||[],o=n.selectedEpisode,l=r.map(function(e){var a=Je(t);return Ve(a,{selectedType:i,selected:e,selectedEpisode:o[e.coocaaVId]}),a});return l}function Ze(e,t){var a=e.map(function(e){var a=Je(t);return Ve(a,{selectedType:0===e.businessType?"video":"edu",selected:e}),a});return a}function et(e,t){var a=e.app||[],n=a.map(function(e){var a=Je(t);return Be(a,e),a});return n}function tt(e,t){var a=e.good||[],n=a.map(function(e){var a=Je(t);return Me(a,e),a});return n}var at=[{cornerIconId:10334,position:0,imgUrl:"http://img.sky.fs.skysrt.com/tvos6_imgs_master/20191029/20191029110042310136_46*50.png"},{cornerIconId:10335,position:0,imgUrl:"http://img.sky.fs.skysrt.com/tvos6_imgs_master/20191029/20191029110130504587_46*50.png"},{cornerIconId:10336,position:0,imgUrl:"http://img.sky.fs.skysrt.com/tvos6_imgs_master/20191029/20191029110130914436_46*50.png"},{cornerIconId:10337,position:0,imgUrl:"http://img.sky.fs.skysrt.com/tvos6_imgs_master/20191029/20191029110130735921_46*50.png"},{cornerIconId:10338,position:0,imgUrl:"http://img.sky.fs.skysrt.com/tvos6_imgs_master/20191029/20191029110130455987_46*50.png"},{cornerIconId:10339,position:0,imgUrl:"http://img.sky.fs.skysrt.com/tvos6_imgs_master/20191029/20191029110131328570_46*50.png"},{cornerIconId:10340,position:0,imgUrl:"http://img.sky.fs.skysrt.com/tvos6_imgs_master/20191029/20191029110131373933_46*50.png"},{cornerIconId:10341,position:0,imgUrl:"http://img.sky.fs.skysrt.com/tvos6_imgs_master/20191029/20191029110131101494_46*50.png"},{cornerIconId:10342,position:0,imgUrl:"http://img.sky.fs.skysrt.com/tvos6_imgs_master/20191029/20191029110131545215_46*50.png"},{cornerIconId:10343,position:0,imgUrl:"http://img.sky.fs.skysrt.com/tvos6_imgs_master/20191029/20191029110131525588_46*50.png"}];function nt(e,t){var a=e.rankingCode,n=e.ranking||[],i=n.map(function(e,t){var a=Je(),n=at[t];return a.cornerList=[Object(l["a"])({},n),{}],Ue(a,e),a}),r=Je({title:"查看更多",coverType:"custom",pictureUrl:"http://img.sky.fs.skysrt.com/tvos6_imgs_master/20191029/20191029110257831374_260*364.jpg",onclick:JSON.stringify({packagename:"com.tianci.movieplatform",versioncode:7100001,dowhat:"startActivity",bywhat:"action",byvalue:"coocaa.intent.movie.ranking",params:{rankingCode:a},exception:{}})});return i.concat(r)}function it(e,t){var a=e.subscribe||[],n=a.map(function(e){var a=Je(t);return Ge(a,{selected:e}),a});return n}function rt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.length,a=e.every(function(e){var t=e.contentPosition,a=t.width,n=t.height,i=t.y,r=t.title_info,o=t.mall_resize;return 0===i&&260===a&&364===n&&r&&!o}),n=t>=6&&t<=11;return a&&n}var ot={cibn:"cibn",movie1905:"movie1905",sohu:"sohu",mgtv:"mgtv",gdn:"4KGarden",wasu:"wasu",tvb:"tvb",bili:"bili",df:"dfdjy"},lt=a("99eb"),st=a("5794"),ct=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{display:"inline-block"}},[a("div",{on:{click:e.handleAddTagStart}},[e._t("default",[a("el-button",{attrs:{disabled:e.disabled,type:"primary",plain:""}},[e._v(e._s(e.title||"选择知识"))])])],2),e.showTagsDialog?a("InterestTagSelector",{attrs:{"selection-type":e.selectionType},on:{"select-end":e.handleAddTagEnd,"select-cancel":e.handleAddTagCancel}}):e._e()],1)},ut=[],dt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"cc-media-tags-selector",attrs:{title:"选择标签",fullscreen:!0,"show-close":!1,modal:!1,"modal-append-to-body":!0,visible:!0}},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSelectEnd}},[e._v("\n    确定\n  ")]),a("el-button",{attrs:{type:"warning"},on:{click:e.handleSelectCancel}},[e._v("\n    关闭\n  ")]),a("div",{staticStyle:{"margin-top":"10px",display:"block","min-height":"30px"}},[a("span",{staticStyle:{float:"left"}},[e._v("已选择  ")]),e._l(e.selectedTags,function(t){return a("el-tag",{key:t.tagCode,attrs:{closable:!0},on:{close:function(a){return e.handleRemoveTag(t)}}},[e._v("\n          "+e._s(t.tagCnName)+"\n      ")])})],2),a("MediaTagSelector",{ref:"mediaTag",attrs:{"selection-type":e.selectionType},on:{"get-tag-nodes":e.handleInputTags}})],1)},pt=[],ht=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",e._l(e.levels,function(t,n){return a("div",{key:t.parentId,staticClass:"tree-level"},[e.tags[t.parentId]&&e.tags[t.parentId].length>0?[a("div",[e._v("第 "+e._s(e.toChineseNumber(n+1))+" 层")]),a("div",e._l(e.tags[t.parentId],function(i){return a("span",{key:i.tagCode,class:{"tree-node":!0,"tree-leaf":0!=i.nodeType,active:t.activeId===i.tagCode,checked:e.selectedIndex[i.tagCode]},on:{click:function(t){return e.handleActivateTag(i,n)}}},[0!=i.nodeType&&"single"===e.selectionType?a("el-radio",{attrs:{label:!0,value:!!e.selectedIndex[i.tagCode]},on:{input:function(t){return e.handleSelectTag(i,n)}},nativeOn:{click:function(e){e.stopPropagation()}}},[a("span")]):0!=i.nodeType?a("el-checkbox",{attrs:{value:!!e.selectedIndex[i.tagCode]},on:{input:function(t){return e.handleSelectTag(i,n)}},nativeOn:{click:function(e){e.stopPropagation()}}},[a("span")]):e._e(),e._v("\n        "+e._s(i.tagCnName)+"\n      ")],1)}),0)]:e._e()],2)}),0)},mt=[],ft=(a("a481"),a("bd86")),vt={data:function(){return{selected:[],selectedIndex:{},levels:[{parentId:"2167",activeId:void 0}],tags:{},cache:{}}},props:["selectionType"],methods:{getTagsByParentCode:function(e){var t=this;if(this.cache[e])return this.cache[e];this.$service.mediaGetInterestList({categoryId:e,page:1,rows:1e6}).then(function(a){t.cache[e]=a,t.$set(t.tags,e,a)})},handleActivateTag:function(e,t){var a=e.tagCode,n=this.levels.slice(0,t+1);n[t].activeId===a?n[t].activeId=void 0:(n[t].activeId=a,n.push(this.genLevel(a)),this.getTagsByParentCode(a)),this.levels=n},handleSelectTag:function(e,t){var a=e.tagCode,n=this.selected,i=this.selectedIndex;0!=e.nodeType&&("single"===this.selectionType?i[a]?(this.selectedIndex={},this.selected=[]):(this.selectedIndex=Object(ft["a"])({},a,e),this.selected=[e]):i[a]?(this.$set(i,a,void 0),this.selected=n.filter(function(t){return t!==e})):(this.$set(i,a,e),this.selected.push(e)),this.$emit("get-tag-nodes",this.selected))},handleRemoveTag:function(e){this.selected=this.selected.filter(function(t){return t!==e}),this.selectedIndex[e.tagCode]=void 0,this.$emit("get-tag-nodes",this.selected)},genLevel:function(e,t){return{parentId:e,activeId:t}},toChineseNumber:function(e){var t=["零","一","二","三","四","五","六","七","八","九"],a=["","十","百","千","万"],n=0,i=e.toString().split("").reduceRight(function(e,i,r){i=+i;var o=a[n++],l=t[i];return l+(i>0?o:"")+e},"");return i.replace(/零+/,"零").replace(/.+零$/,"")}},created:function(){this.getTagsByParentCode("2167")}},gt=vt,bt=(a("3830"),Object(w["a"])(gt,ht,mt,!1,null,"744243b6",null)),yt=bt.exports,wt={components:{MediaTagSelector:yt},data:function(){return{selectedTags:[],removingTags:[]}},props:["selectionType"],methods:{handleSelectEnd:function(){if(0===this.selectedTags.length)return this.$message({type:"error",message:"请选择至少一个标签"});this.$emit("select-end",this.selectedTags.slice())},handleSelectCancel:function(){this.$emit("select-cancel")},handleRemoveTag:function(e){var t=this.selectedTags.findIndex(function(t){return t.tagCode===e.tagCode});t>-1&&this.selectedTags.splice(t,1),this.$refs.mediaTag.handleRemoveTag(e)},handleInputTags:function(e){this.selectedTags=e}}},It=wt,Ct=(a("7255"),Object(w["a"])(It,dt,pt,!1,null,"328bee98",null)),Tt=Ct.exports,St={components:{InterestTagSelector:Tt},data:function(){return{showTagsDialog:!1}},props:["title","selectionType","disabled"],methods:{handleAddTagStart:function(){this.disabled||(this.showTagsDialog=!0)},handleAddTagEnd:function(e){this.$emit("select-end",e),this.showTagsDialog=!1},handleAddTagCancel:function(){this.showTagsDialog=!1}}},kt=St,_t=Object(w["a"])(kt,ct,ut,!1,null,null,null),Pt=_t.exports,xt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("RemoteSelectorWrapper",{ref:"wrapper",attrs:{title:e.title||"选择作者","custom-class":"resource-selector",disabled:e.disabled,"is-live":e.isLive},on:{"select-start":e.handleSelectStart},scopedSlots:e._u([{key:"content",fn:function(t){var n=t.isShow;return[e.isLive||n?a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"userId","selection-type":e.selectionType,table:e.table,pagination:e.pagination,selectEndOnDblClick:!0},on:{"pagination-change":e.fetchData,"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}},[a("el-form",{attrs:{slot:"filter",inline:!0},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.handleFilterChange(t))}},slot:"filter",model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("el-form-item",[a("el-input",{attrs:{clearable:"",placeholder:"作者ID"},model:{value:e.filter.userId,callback:function(t){e.$set(e.filter,"userId",t)},expression:"filter.userId"}})],1),a("el-form-item",[a("el-input",{attrs:{clearable:"",placeholder:"作者名称"},model:{value:e.filter.userName,callback:function(t){e.$set(e.filter,"userName",t)},expression:"filter.userName"}})],1),a("el-button",{attrs:{type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{attrs:{type:"warning"},on:{click:e.handleResetFilter}},[e._v("重置")])],1)],1):e._e()]}}])},[e._t("default")],2)},Ft=[],Dt={data:function(){return{pagination:{currentPage:1,pageSize:15,total:0},filter:this.genDefaultFilter(),efficientFilter:this.genDefaultFilter(),table:{data:[],selected:[],header:[{label:"作者ID",prop:"userId",width:200},{label:"名称",prop:"userName","show-overflow-tooltip":!0},{label:"作者头像",render:function(e,t){var a=t.row,n=a.userThumb;if(n)return e("img",{key:a.userId+n,style:{"border-radius":"25px"},attrs:{width:"50px",height:"50px",referrerpolicy:"no-referrer",src:n}})}}],selectionType:"multiple",props:{"tooltip-effect":"dark"}},selected:[],originSelected:[]}},props:["title","disabled","isLive","source","selectionType","category"],components:{RemoteSelectorWrapper:P["a"],BaseSelector:fe["a"]},methods:{handleSelectStart:function(){this.$emit("select-start"),this.isLive?this.fetchData():this.handleResetFilter()},handleSelectCancel:function(){this.$refs.wrapper.handleSelectCancel()},handleSelectEnd:function(e){this.$emit("select-end",e),this.$refs.wrapper.handleSelectEnd()},genDefaultFilter:function(){return{userId:void 0,userName:void 0}},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleResetFilter:function(){this.filter=this.genDefaultFilter(),this.efficientFilter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=JSON.parse(JSON.stringify(this.efficientFilter)),a=this.pagination;a&&(t.page=a.currentPage,t.rows=a.pageSize),this.$service.mediaGetAuthorList(t).then(function(t){e.table.data=t.rows,e.pagination.total=t.total})}},created:function(){}},Rt=Dt,Lt=Object(w["a"])(Rt,xt,Ft,!1,null,null,null),$t=Lt.exports,Nt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("RemoteSelectorWrapper",{ref:"wrapper",attrs:{title:e.title||"选择视频","custom-class":"resource-selector",disabled:e.disabled,"is-live":e.isLive},on:{"select-start":e.handleSelectStart},scopedSlots:e._u([{key:"content",fn:function(t){var n=t.isShow;return[e.isLive||n?a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"coocaaBVId","selection-type":e.selectionType,table:e.table,pagination:e.pagination,selectEndOnDblClick:!0},on:{"pagination-change":e.fetchData,"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}},[a("el-form",{attrs:{slot:"filter",inline:!0},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.handleFilterChange(t))}},slot:"filter",model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("el-form-item",[a("el-input",{attrs:{clearable:"",placeholder:"视频标题"},model:{value:e.filter.title,callback:function(t){e.$set(e.filter,"title",t)},expression:"filter.title"}})],1),e.userId?e._e():a("el-form-item",[a("el-input",{attrs:{clearable:"",placeholder:"作者名称"},model:{value:e.filter.userName,callback:function(t){e.$set(e.filter,"userName",t)},expression:"filter.userName"}})],1),e.categoryId?e._e():a("el-form-item",[a("KnowledgeTagSelector",{attrs:{"selection-type":"single"},on:{"select-end":function(t){return e.handleSetFilterCategory(t)}}},[a("el-input",{attrs:{value:e.filter.categoryName,placeholder:"所属知识"}},[a("el-button",{attrs:{slot:"append"},slot:"append"},[e.filter.categoryId?a("span",{on:{click:function(t){return t.stopPropagation(),e.handleSetFilterCategory()}}},[e._v("清除")]):a("span",[e._v("选择")])])],1)],1)],1),a("el-button",{attrs:{type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{attrs:{type:"warning"},on:{click:e.handleResetFilter}},[e._v("重置")])],1)],1):e._e()]}}])},[e._t("default")],2)},Et=[],Ot={components:{KnowledgeTagSelector:Pt,RemoteSelectorWrapper:P["a"],BaseSelector:fe["a"]},data:function(){return{options:[],pagination:{currentPage:1,pageSize:15,total:0},filter:this.genDefaultFilter(),efficientFilter:this.genDefaultFilter(),table:{data:[],selected:[],header:[{label:"视频ID",prop:"coocaaBVId",width:200},{label:"视频标题",prop:"title","show-overflow-tooltip":!0},{label:"作者名称",prop:"userName","show-overflow-tooltip":!0},{prop:"categoryName",label:"所属知识",width:190},{prop:"createdTime",label:"创建时间",width:190}],selectionType:"multiple",props:{"tooltip-effect":"dark"}},selected:[],originSelected:[]}},props:["title","disabled","isLive","source","selectionType","categoryId","userId"],methods:{handleSelectStart:function(){this.$emit("select-start"),this.isLive?this.fetchData():this.handleResetFilter()},handleSelectCancel:function(){this.$refs.wrapper.handleSelectCancel()},handleSelectEnd:function(e){this.$emit("select-end",e),this.$refs.wrapper.handleSelectEnd()},handleSetFilterCategory:function(e){var t=this.filter;e?(e=e[0],t.categoryId=e.tagCode,t.categoryName=e.tagCnName):(t.categoryId=void 0,t.categoryName=void 0)},genDefaultFilter:function(){return{title:void 0,userId:this.userId,categoryId:this.categoryId,categoryName:void 0}},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleResetFilter:function(){this.filter=this.genDefaultFilter(),this.efficientFilter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=JSON.parse(JSON.stringify(this.efficientFilter));t.categoryName=void 0;var a=this.pagination;a&&(t.page=a.currentPage,t.rows=a.pageSize),this.$service.mediaGetVideoList(t).then(function(t){e.table.data=t.rows,e.pagination.total=t.total})}},created:function(){}},At=Ot,Vt=Object(w["a"])(At,Nt,Et,!1,null,null,null),Bt=Vt.exports,Mt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("RemoteSelectorWrapper",{ref:"wrapper",attrs:{title:e.title,"custom-class":"resource-selector",disabled:e.disabled,"is-live":e.isLive},on:{"select-start":e.handleSelectStart},scopedSlots:e._u([{key:"content",fn:function(t){var n=t.isShow;return[e.isLive||n?a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":e.getId,"selection-type":e.selectionType,table:e.table,filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination,"select-end-on-dbl-click":!0},on:{"pagination-change":e.fetchData,"filter-change":e.handleFilterChange,"filter-reset":e.handleResetFilter,"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}},[a("div",{attrs:{slot:"filter"},slot:"filter"},[a("el-form",{attrs:{inline:!0,model:e.filter},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.handleFilterChange(t))}}},[a("el-form-item",[a("el-select",{attrs:{placeholder:"省份",filterable:"",clearable:""},model:{value:e.filter.provincesCode,callback:function(t){e.$set(e.filter,"provincesCode",t)},expression:"filter.provincesCode"}},e._l(e.provinceOptions,function(e){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})}),1)],1),a("el-form-item",[a("el-input",{attrs:{clearable:"",placeholder:"聚合频道名"},model:{value:e.filter.ccChannelTitle,callback:function(t){e.$set(e.filter,"ccChannelTitle","string"===typeof t?t.trim():t)},expression:"filter.ccChannelTitle"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{on:{click:e.handleResetFilter}},[e._v("重置")])],1)],1)],1)]):e._e(),a("GDScheduleSelector",{ref:"gdChannelSelector",attrs:{provincesCode:e.currentProvincesCode,channelId:e.currentChannelId},on:{"select-end":e.handleSelectScheduleEnd}},[a("span")])]}}])})},Ut=[],Gt=a("a1fe"),jt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("remote-selector-wrapper",{ref:"wrapper",attrs:{title:"选择节目"},on:{"select-start":e.handleSelectStart}},[a("BaseSelector",{ref:"baseSelector",attrs:{slot:"content","id-field":"thirdScheduleId","selection-type":e.selectionType,table:e.table,pagination:e.pagination,"select-end-on-dbl-click":!0},on:{"pagination-change":e.fetchData,"filter-reset":e.handleFilterReset,"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd},slot:"content"},[a("el-form",{attrs:{slot:"filter",inline:!0,"label-width":"72px"},slot:"filter",model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("el-form-item",{attrs:{label:"开始时间"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyyMMdd","picker-options":e.startTimePickerOptions},model:{value:e.filter.startTime,callback:function(t){e.$set(e.filter,"startTime",t)},expression:"filter.startTime"}})],1),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{attrs:{size:"small",type:"warning"},on:{click:e.handleFilterReset}},[e._v("重置")])],1)],1),e._t("default")],2)},zt=[],Wt={components:{BaseSelector:fe["a"],RemoteSelectorWrapper:P["a"]},data:function(){var e=this;return{pagination:{currentPage:1,pageSize:15},filter:this.getDefaultFilter(),efficientFilter:this.getDefaultFilter(),table:{props:{},header:[{label:"节目标题",prop:"thirdScheduleTitle"},{label:"节目id",prop:"thirdScheduleId",width:150},{label:"第三方频道Id",prop:"thirdChannelId",width:120},{label:"频道Id",prop:"ccChannelId",width:120},{label:"时长",width:120,render:function(t,a){var n=a.row;return e.secondToTimeStr(n.duration)}},{label:"节目开始时间",prop:"startTime"},{label:"节目结束时间",prop:"endTime"}],data:[],selected:[],selectionType:"single"},selected:[],startTimePickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()-864e5}}}},props:{selectionType:{type:String,default:function(){return"single"}},provincesCode:String,channelId:String},methods:{secondToTimeStr:function(e){if(e){var t=Math.floor(e/3600),a=Math.floor((e-3600*t)/60),n=e-3600*t-60*a;return"".concat(t,"小时").concat(a,"分").concat(n,"秒")}},handleSelectStart:function(){var e=this.$refs.baseSelector;e&&e.clearSelected(),this.handleFilterReset()},handleSelectCancel:function(){this.$refs.wrapper.handleSelectCancel()},getDefaultFilter:function(){var e=new Date(Date.now()-864e5).toISOString().slice(0,10).replace(/-/g,"");return{provincesCode:this.provincesCode,channelId:this.channelId,startTime:e}},getFilter:function(){var e=this.pagination,t=Object(l["a"])({},this.efficientFilter);return e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.efficientFilter=this.getDefaultFilter(),this.pagination.currentPage=1,this.table.data=[],this.fetchData()},fetchData:function(){var e=this,t=this.getFilter();this.$service.mediaGetGDSchedulelList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows||[]})},handleSelectEnd:function(){this.$refs.wrapper.handleSelectEnd(),this.$emit.apply(this,["select-end"].concat(Array.prototype.slice.call(arguments)))}},created:function(){}},qt=Wt,Jt=Object(w["a"])(qt,jt,zt,!1,null,"045537d8",null),Ht=Jt.exports,Kt={data:function(){var e=this;return{provinceOptions:[],pagination:{currentPage:1,pageSize:15,total:0},filter:this.genDefaultFilter(),effectiveFilter:this.genDefaultFilter(),filterSchema:null,table:{data:[],selected:[],header:[{label:"聚合频道ID",prop:"ccChannelId"},{label:"聚合频道名",prop:"ccChannelTitle"},{label:"聚合之中的省份",prop:"provincesName"},{prop:"segment",label:"已选节目",type:"specialBut",width:"105",mouseStyle:"hover",fixed:"right",render:function(t,a){var n=a.row,i=n.ccChannelId,r=e.selectedSchedules;if(r[i])return t("el-button",{attrs:{type:"primary",text:"已选节目",value:"已选节目",title:r[i].thirdScheduleTitle}},"已选节目")}},{prop:"but",label:"操作",width:"105",fixed:"right",render:function(t,a){var n=a.row;return t("el-button",{on:{click:function(t){t.stopPropagation(),e.handleSelectScheduleStart(n)}}},"选择节目")}}],selectionType:"single",props:{"tooltip-effect":"dark"}},currentChannelId:void 0,currentProvincesCode:void 0,selectedSchedules:{}}},props:["title","disabled","isLive","source","selectionType","initSelected","hasSchedule"],computed:{},components:{RemoteSelectorWrapper:Gt["a"],BaseSelector:fe["a"],GDScheduleSelector:Ht},methods:{getId:function(e){return e.ccChannelId},genDefaultFilter:function(){return{ccChannelTitle:"",provincesCode:""}},handleSelectStart:function(){var e=this;this.$emit("select-start"),this.isLive?this.fetchData():this.handleResetFilter();var t=this.initSelected;t&&this.$nextTick(function(){var a=e.$refs.baseSelector;a.selected=t.filter(function(t){return e.getId(t)}),a.updateTableSelected()})},handleSelectCancel:function(){this.$refs.wrapper.handleSelectCancel()},handleSelectEnd:function(e){var t=this;if(void 0!==this.hasSchedule){var a=e.some(function(e){return void 0===t.selectedSchedules[e.ccChannelId]});if(a)return this.$message.error("请选择节目")}e=e.map(function(e){return e.selectedSchedules=t.selectedSchedules[e.ccChannelId],e}),this.$emit("select-end",e),this.$refs.wrapper.handleSelectEnd()},handleSelectScheduleStart:function(e){var t=this;this.currentChannelId=e.ccChannelId,this.currentProvincesCode=e.provincesCode,this.$nextTick(function(){t.$refs.gdChannelSelector.$refs.wrapper.handleSelectStart()})},handleSelectScheduleEnd:function(e){var t=this.currentChannelId;this.$set(this.selectedSchedules,t,e[0]);var a=this.table.data,n=a.findIndex(function(e){return e.ccChannelId===t}),i=a[n],r=this.$refs.baseSelector;"single"===this.selectionType?r.tableSelected!==n&&r.handleTableRowSelectionChange(i,n):"multiple"===this.selectionType&&-1===r.tableSelected.indexOf(n)&&r.handleTableRowSelectionAdd(i,n)},handleRowSelectionRemove:function(e){this.$refs.baseSelector.handleTableRowSelectionRemove(e)},handleFilterChange:function(){this.effectiveFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleResetFilter:function(){this.filter=this.genDefaultFilter(),this.effectiveFilter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=JSON.parse(JSON.stringify(this.effectiveFilter)),a=this.pagination;a&&(t.page=a.currentPage,t.rows=a.pageSize),this.$service.mediaGetGDChannelList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},getProvinceOptions:function(){var e=this;this.$service.mediaGetChannelProvinceOptions().then(function(t){e.provinceOptions=t})}},created:function(){this.getProvinceOptions(),void 0===this.hasSchedule&&this.table.header.splice(this.table.header.length-1,1)}},Yt=Kt,Qt=(a("a0e0"),Object(w["a"])(Yt,Mt,Ut,!1,null,"8bf834d2",null)),Xt=Qt.exports,Zt={components:{Upload:_["Upload"],Price:K,AppParamsForm:te,Params:st["a"],CornerSelector:se["a"],GlobalPictureSelector:N["a"],ResourceSelector:ce["a"],CommonSelector:ue["a"],CrowdSelector:de["a"],TabSelector:pe["a"],ClickEventSelector:ye,AppParamsRead:le,TagFrame:Pe,InputPositiveInt:g["a"],RecommendStreamSelector:lt["a"],NewBlockRecStreamSelector:we["a"],KnowledgeTagSelector:Pt,MaskAuthorSelector:$t,MaskVideoSelector:Bt,GDChannelSelector:Xt},data:function(){var e=this,t=this.isReadonly,a=function(t,a,n){3===e.contentForm.contentType&&a.length>0&&a.length<7?n(new Error("教育版本号需为7位以上")):n()},n=function(e,t,a){t?-1===t.indexOf("https")&&-1===t.indexOf("http")?a(new Error("请输入https或http地址")):a():a(new Error("请输入网页地址"))},i=function(t,a,n){"specific"!==e.contentFormType||e.contentForm.attributeInfo||e.isReadonly?n():n(new Error("请选择人群"))},r=/^(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*))$/,o=function(e,t,a){r.test(t)?-1!==t.toString().indexOf(".")?a(new Error("只允许输入小数点后两位")):a():0===t&&""!==t?a():a(new Error("请输入合法的价格"))},l=function(e,t,a){var n=/^(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*))$/;n.test(t)?-1!==t.toString().indexOf(".")?a(new Error("只允许输入小数点后两位")):a():""===t?a():a(new Error("请输入合法的价格"))};return{isShowOrHide:!1,MASK_LIFE_TYPE_OPTIONS:xe,MASK_LIFE_TYPES:Fe,MASK_LIFE_RECOMMEND_TYPE_OPTIONS:De,MASK_LIFE_RECOMMEND_TYPES:Re,GD_LIVE_CLICK_TYPE_OPTIONS:Le,GD_LIVE_CLICK_TYPES:$e,showCrowdSelector:!1,showBlockTagDialog:!1,uploadImg:"/uploadHomeImg.html",isShowConfigBg:!1,recomStream:void 0,recomStreamTags:[],contentRule:{bgImgUrl:[{validator:function(t,a,n){var i=e.contentForm.bgParams;i&&i.id&&!a?n(new Error("选择背景视频之后必须选择背景图")):n()}},{required:!0,message:"当开关开启时必填"}],webpageUrl:[{required:!0,validator:n,trigger:"blur"}],videoName:[{required:!0,message:"请输入视频名称",trigger:"blur"}],videoUrl:[{required:!0,message:"请输入视频地址",trigger:"blur"}],tabId:[{required:!0,message:"请选择版面",trigger:"blur"}],moviePercent:[{type:"number",required:!0,message:"请输入进度",trigger:"blur"}],extraValue1:[{required:!0,message:"请选择资源",trigger:"blur"}],title:[{validator:function(e,t,a){this.contentForm.showTitle&&""===t.trim()?a(new Error("请输入标题")):a()}.bind(this)},{max:45,message:"不超过 45 个字符",trigger:"blur"}],subTitle:[{max:45,message:"不超过 45 个字符",trigger:"blur"}],pictureUrl:[{required:!0,message:"不能为空",trigger:"blur"}],alternativePictureUrl:[{required:!0,message:"请选择替补海报",trigger:"blur"},{validator:function(e,t,a){t&&"webp"===t.slice(-4).toLowerCase()?a(new Error("替补海报不能选择动图")):a()}}],vContentId:[{type:"number",required:!0,message:"请选择功能",trigger:"blur"}],attributeInfo:[{validator:i,trigger:"blur"}],versionCode:[{validator:function(e,t,a){if(!/^(-1|\d*)$/.test(t))return a(new Error("应用版本号只能是数字或者-1"));a()}},{validator:a,trigger:"blur"}],versioncode:[{required:!0,message:"请输入版本号",trigger:"blur"},{validator:function(e,t,a){if(!/^(-1|\d*)$/.test(t))return a(new Error("应用版本号只能是数字或者-1"));a()}}],price:[{required:!0,validator:o,trigger:"blur"}],secKillPrice:[{required:!1,validator:l,trigger:"blur"}],dmpRegistryInfo:[{required:!t,message:"请选择定向人群"}],"mediaAutomationBlockRls.refreshCal":[{required:!0,message:"当开关开启时必填",trigger:"blur"}],"bgParams.id":[{required:!0,message:"当开关开启时必填"}],authorId:[{required:!0,message:"请选择作者",trigger:"blur"}],categoryId:[{required:!0,message:"请选择知识",trigger:"blur"}],"tvLiveInfo.channelId":[{required:!0,message:"请选择频道/节目",trigger:"blur"}]},beforeSelectBlockCbs:{func:function(t){for(var a=0;a<t.length;a++){var n=t[a];if("REFERENCE_VIP_QRCODE"===n.pluginType||"REFERENCE_PLAY_VIDEO"===n.pluginType){var i=e.data.rlsTabInfo||[],r=i.some(function(e){return 2!==e.tabType});if(r)return"REFERENCE_VIP_QRCODE"===n.pluginType&&e.$message.error("【VIP二维码推荐位】只能配置在专题版面中"),"REFERENCE_PLAY_VIDEO"===n.pluginType&&e.$message.error("【视频播放推荐位】只能配置在专题版面中"),!1}}return!0}},scene:"2"}},props:["contentType","mode","contentForm","data","source","pannel","pannelGroupId","hideTitleOptions","checkCrowd","isInterveneBlock"],computed:{maskLifeInfo:function(){return this.contentForm.maskLifeInfo},isSpecific:function(){return"specific"===this.contentType},currentResourceId:function(){return this.contentForm.extraValue1},isReadonly:function(){return"read"===this.mode},resolution:function(){var e=this.data;return[e.blockInfo.width,e.blockInfo.height]},postSize:function(){var e=this.data.blockInfo||{},t=e.width||200,a=e.height||200,n=800,i=600,r=1;if(t<a){var o=200*a/t;return o>i&&(r=i/o),{height:o*r,width:200*r}}var l=200*t/a;return l>n&&(r=n/l),{height:200*r,width:l*r}},isMall:function(){return"Mall"===this.data.blockInfo.type},shouldHaveBackupPicture:function(){var e=this.contentForm,t=e.pictureUrl;return"block"!==e.coverType&&!this.isNormalPicture(t)},disabledCoverTypes:function(){return this.isMall?["block"]:[]},hiddenCoverTypes:function(){return"specific"===this.contentType?["block"]:[]},idType:function(){var e=this.pannel.fillType,t=this.$consts.panelFillTypes,a=e===t.recStream;return a?1:void 0}},watch:{isShowConfigBg:function(e){e||(this.contentForm.bgParams={id:"",title:""},this.contentForm.bgImgUrl="")}},methods:{handleDelTagClose:function(e){e.mediaAutomationId=void 0,e.mediaAutomationName=void 0,e.type=0,this.isShowOrHide=!1},handleSelectBlockRecStreamEnd:function(e){var t={mediaAutomationId:e[0].id,mediaAutomationName:e[0].recName,recCategory:e[0].recCategory,recFlag:e[0].userToken};this.isShowOrHide=!0,this.contentForm.mediaAutomationBlockRls=Object(l["a"])({},this.contentForm.mediaAutomationBlockRls,t),this.contentForm.mediaAutomationBlockRls.type=1},handleInputGDLiveClickType:function(e){this.contentForm.tvLiveInfo=He({clickType:e}),this.contentForm.extraValue1=void 0},handleSelectGDChannelEnd:function(e){var t=e[0],a=t.categoryIds,n=void 0===a?"":a,i=t.ccChannelId,r=t.ccChannelTitle,o=t.images,l=t.selectedSchedules,s=n.split(","),c=this.resolution,u=this.contentForm,d=u.tvLiveInfo;d.categoryId=s[0],d.channelId=i,u.title=r,u.pictureUrl=Ee(c,o),l&&(u.extraValue1=l.thirdScheduleId),l&&(u.extraValue1=l.thirdScheduleId,u.title=l.thirdScheduleTitle,d.startTime=l.startTime)},initVideoInfo:function(e){var t=this;e.videoInfo||this.getVideoInfoById(e.videoId).then(function(a){t.$set(e,"videoInfo",a)})},handleInputRecommendCategory:function(e,t){var a=this.getCategoryOptions(e),n=a.find(function(e){return e.value===t});e.categoryId=n.value,e.categoryName=n.label,e.filterValue=n.filterValue},getCategoryOptions:function(e){var t=e.videoInfo;return t?t.categoryOptions:[{label:e.categoryName,value:e.categoryId,filterValue:e.filterValue}]},getVideoInfoById:function(e){return this.$service.mediaGetVideoList({coocaaBVId:e}).then(function(e){var t=e.rows[0];if(t)return Ne(t)})},handleInputRecommendType:function(e){var t=this,a=this.contentForm,n=a.maskLifeInfo,i=n.videoId,r=n.videoInfo,o=n.recommendType;switch(n.recommendType=e,!i||e!==Re.category&&e!==Re.author||(r?e===Re.author&&(n.authorId=r.authorId,n.authorName=r.authorName):this.getVideoInfoById(i).then(function(t){n.videoInfo=t,e===Re.author&&(n.authorId=t.authorId,n.authorName=t.authorName)}).catch(function(){t.$message.error("或者视频信息视频，请重新设置视频点击跳转方式"),n.recommendType=o})),e){case Re.recommend:Object.assign(n,{categoryName:"",categoryId:"",filterValue:"",authorId:"",authorName:""});break;case Re.category:Object.assign(n,{authorId:"",authorName:""});break;case Re.author:Object.assign(n,{categoryName:"",categoryId:"",filterValue:""});break}},handleSelectMaskVideoEnd:function(e){var t=e[0],a=this.contentForm,n=a.maskLifeInfo;a.maskLifeInfo=Ke({lifeType:n.lifeType,videoId:t.coocaaBVId,recommendType:Re.recommend,videoInfo:Ne(t)}),a.title=t.title,a.pictureUrl=t.thumb},handleRemoveMaskVideo:function(){var e=this.maskLifeInfo;this.contentForm.maskLifeInfo=Ke({lifeType:e.lifeType,recommendType:Re.recommend})},handleSelectAuthorEnd:function(e){var t=e[0],a=this.contentForm,n=a.maskLifeInfo;a.maskLifeInfo=Ke({lifeType:n.lifeType,authorId:t.userId,authorName:t.userName}),a.title=t.userName,a.pictureUrl=t.userThumb},handleRemoveKnowledgeTag:function(){var e=this.maskLifeInfo;this.contentForm.maskLifeInfo=Ke({lifeType:e.lifeType})},handleSelectKnowledgeTagEnd:function(e){var t=e[0],a=this.contentForm,n=a.maskLifeInfo;a.maskLifeInfo=Ke({lifeType:n.lifeType,categoryId:t.tagCode,categoryName:t.tagCnName,filterValue:t.filterValue})},handleSelectRecommendKnowledgeTagEnd:function(e){var t=e[0];Object.assign(this.maskLifeInfo,{categoryId:t.tagCode,categoryName:t.tagCnName,filterValue:t.filterValue})},handleSelectRecommendAuthorEnd:function(e){var t=e[0];Object.assign(this.maskLifeInfo,{authorId:t.userId,authorName:t.userName})},handleInputMaskLifeType:function(e){this.contentForm.maskLifeInfo=Ke({lifeType:e})},handleAddTagStart:function(){this.showBlockTagDialog=!0,this.$sendEvent({type:"video_content_tag",payload:{panel_group_id:this.pannelGroupId||"new"}})},handleInputFlagSetRec:function(e){this.contentForm.flagSetRec=e?1:0,e||(this.contentForm.mediaAutomationBlockRls={refreshCal:1,mediaAutomationId:"",blockType:"normal",type:"1"})},handleInputFlagTagVector:function(e){return"media"!==this.contentForm.coverType?this.$message("推荐位的配置必须是影片"):this.hideTitleOptions?this.$message("推荐位不能是带标题的推荐位"):this.resolution[0]<410?this.$message("推荐位宽度必须>=410"):void(this.contentForm.flagTagVector=e?1:0)},genParams:function(e){return{openMode:e||"app",webpageUrl:"",webpageType:"2",videoName:"",videoUrl:"",pictureUrl:"",tabId:"",packagename:"",versioncode:"webpage"===e?"102007":"-1",dowhat:"startActivity",bywhat:"action",byvalue:"",data:void 0,params:[{key:"",value:""}]}},handleUpload:function(e,t){var a=this;this.$refs.upload.fileList=[t],t.status="uploading",this.$service.uploadImage({file:e,onUploadProgerss:function(e){e.lengthComputable&&(t.percentage=e.loaded/e.total)}}).then(function(e){if(e.success){var n=e.data[0];t.pictureName=n.fileName,t.pictureType=n.fileType,t.pictureUrl=n.url,t.status="success",a.contentForm.redundantParams.pictureUrl=n.url}else t.status="error",t.message=e.msg}).catch(function(){t.status="error",t.message="网络错误"})},handleRemovePicture:function(e){this.$refs.upload.handleRemove(e),this.contentForm.redundantParams.pictureUrl=""},handleSelectTabEnd:function(e){var t=e;t&&(this.$set(this.contentForm.redundantParams,"tabId",t.tabId+""),this.$set(this.contentForm.redundantParams,"tabType",t.tabType+""))},handleSelectCrowdStart:function(){this.showCrowdSelector=!0},handleSelectCrowdCancel:function(){this.showCrowdSelector=!1},handleSelectCrowdEnd:function(e,t){var a=this.checkCrowd(t);void 0!==a?this.$message({type:"error",message:"第"+(a+1)+"个精细化内容已关联该人群"}):(this.$set(this.contentForm,"dmpRegistryInfo",{dmpPolicyId:e.value,dmpCrowdId:t.value,dmpPolicyName:e.label,dmpCrowdName:t.label}),this.$sendEvent({type:"create_block_dmp",payload:{type:"common"}}),this.showCrowdSelector=!1)},handleOpenModeChange:function(e){this.contentForm.redundantParams=this.genParams(e),this.contentForm.appParams=[]},handleWebPageTypeChange:function(e){this.contentForm.redundantParams.versioncode="1"==e?"1":"102007"},handleSelectMediaEnd:function(e){var t=je(e),a=t.selectedType,n=t.selected[0],i=n._partner,r=t.selectedEpisode[n.coocaaVId],o=this.resolution;Ve(this.contentForm,{partner:i,selectedType:a,selected:n,selectedEpisode:r,blockSize:o}),this.$refs.resourceSelector.clearSelected()},handleSelectAppEnd:function(e){Be(this.contentForm,e.app[0])},handleSelectGoodEnd:function(e){Me(this.contentForm,e.good[0])},handleSelectClickEventEnd:function(e){var t=e[0],a=t.packagename,n=t.versioncode,i=t.dowhat,r=t.bywhat,o=t.byvalue,l=t.params,s=t.exception,c=this.contentForm,u=[];if(l){var d=JSON.parse(l);u=Object.keys(d).map(function(e){return{key:e,value:d[e]}})}0===u.length&&u.push({key:void 0,value:void 0}),c.redundantParams=Object.assign({},c.redundantParams,{packagename:a,versioncode:n,dowhat:i,bywhat:r,byvalue:o,params:u,exception:s})},isNormalPicture:function(e){return!e||"webp"!==e.slice(-4).toLowerCase()},handleSelectCornerIconEnd:function(e,t){var a={cornerIconId:e.cornerIconId,position:t,imgUrl:e.imgUrl};this.$set(this.contentForm.cornerList,t,a)},handleRemoveCornerIcon:function(e){this.$set(this.contentForm.cornerList,e,{})},handleSelectPostEnd:function(e){this.contentForm.pictureUrl=e.pictureUrl},handleSelectBackupPostEnd:function(e){this.contentForm.alternativePictureUrl=e.pictureUrl},handleSelectBgEnd:function(e){this.contentForm.bgImgUrl=e.pictureUrl},handleSelectBgMediaEnd:function(e){var t,a,n=je(e),i=n.selectedType,r=n.selected[0],o=r._partner,l=n.selectedEpisode[r.coocaaVId],s=this.contentForm;"video"===i?"tencent"===o?t="_otx_"+r.coocaaVId:"yinhe"===o?t="_oqy_"+r.coocaaVId:"youku"===o&&(t="_oyk_"+r.coocaaVId):"edu"===i?t="_otx_"+r.coocaaVId:"pptv"===i?t="pptv_tvsports://tvsports_detail?section_id="+r.pid+"&from_internal=1":"live"===i?t="_otx_"+r.vId:"topic"===i?t=r.id+"":"rotate"===i&&(t=r.id+""),a=l?l.urlTitle:r.title,s.bgParams={id:t,title:a},s.bgType="res"},handleRemoveBgMedia:function(){var e=this.contentForm;e.bgParams={id:""},e.bgType=""},handleSelectBlockEnd:function(e){var t=e.func[0],a=e.broadcast[0];if(t){var n=t;this.contentForm.videoContentType="sysPlugin",this.contentForm.title=n.pluginName,this.contentForm.vContentId=n.pluginId,this.contentForm.pictureUrl=n.globalPicture?n.globalPicture.pictureUrl:"",this.contentForm.pluginType=n.pluginType}if(a){var i=a;this.contentForm.videoContentType="specific",this.contentForm.title=i.containerName,this.contentForm.vContentId=i.id,this.contentForm.pictureUrl=i.poster.pictureUrl}this.$refs.blockSelector.clearSelected()},validate:function(e,t){var a=this,n=this.contentForm;this.$refs.contentForm.validate(function(e){if(e){if("custom"===n.coverType){if(n.price<n.secKillPrice)return t(Error("价格小于秒杀价，建议重新填写！"));if(1===n.flagSetRec&&(!n.mediaAutomationBlockRls.mediaAutomationId||!n.mediaAutomationBlockRls.refreshCal))return t(Error("已开启推荐位个性化推荐开关，但配置不完整!"));if(a.isShowConfigBg&&(!n.bgParams.id||!n.bgParams.title||!n.bgImgUrl))return t(Error("已开启配置高清背景图和视频开关，但配置不完整!"))}t()}else t(Error("请把表单填写完整"))})},handleSelectRecomStream:function(e){var t={refreshCal:1,mediaAutomationId:"",blockType:"rotate",type:"0"};this.contentForm.mediaAutomationBlockRls=Object(l["a"])({},t,this.contentForm.mediaAutomationBlockRls),this.contentForm.mediaAutomationBlockRls.mediaAutomationId=e.id,this.contentForm.mediaAutomationBlockRls.mediaAutomationName=e.mediaAutomationName,this.contentForm.mediaAutomationBlockRls.type=0,console.log(this.contentForm.mediaAutomationBlockRls,"----旧推荐流")}},mounted:function(){var e=this.contentForm,t=e.redundantParams;"picture"===t.openMode&&t.pictureUrl&&(this.$refs.upload.fileList=[{status:"success",dataUrl:t.pictureUrl}]),(e.bgImgUrl||e.bgParams.id||e.bgParams.title)&&(this.isShowConfigBg=!0)}},ea=Zt,ta=(a("0f48"),a("14d4"),a("87281"),Object(w["a"])(ea,U,G,!1,null,"768c4dad",null)),aa=ta.exports,na={components:{draggable:M.a,BlockForm:aa,CommonSelector:ue["a"],ResourceSelector:ce["a"]},data:function(){return{activeNames:["normal","specific"],activeType:"normal",activeIndex:0,normalContentWrapper:this.genDefaultNormalContentWrapper(),normalContentList:[this.genDefaultContentForm()],specificContentList:[]}},props:["mode","data","source","pannel","hideTitleOptions","pannelGroupId","isInterveneBlock"],computed:{title:function(){return"read"===this.mode?"推荐位内容查看":"推荐位内容设置"},isMall:function(){return"Mall"===this.data.blockInfo.type},contentForm:function(){return this[this.activeType+"ContentList"][this.activeIndex]},coverTypeEnums:function(){var e=[{label:"媒体资源",value:"media"},{label:"应用圈",value:"app"},{label:"自定义",value:"custom"},{label:"商品",value:"mall"},{label:"推荐位管理",value:"block",disabled:this.isMall}];return e}},methods:{error:function(e){return this.$message({type:"error",message:e})},handleSelectResourcesEnd:function(e){var t,a={coverType:this.isMall?"custom":"media",showTitle:this.hideTitleOptions?1:0},n=Qe(e,a);(t=this.normalContentList).splice.apply(t,[this.activeIndex,n.length].concat(Object(V["a"])(n)))},getPictureUrl:function(e){if(e){var t="block/sign.png";return"/themes/images/block/sign.png"===e?t:e}},handleDragConentStart:function(e){},handleDragConentEnd:function(e,t){var a=e.oldIndex,n=e.newIndex,i=this.activeIndex;this.activeType===t&&(a===i?this.activeIndex=n:a<i&&n>=i?this.activeIndex=i-1:a>i&&n<=i&&(this.activeIndex=i+1))},handleSave:function(){var e=this;this.validateCurrentContent(function(){var t=e.normalContentList,a=t.length,n={},i={media:"extraValue1",block:"vContentId",mall:"extraValue1"};if(a>100)return e.error("通用内容最多配 100 个, 当前 ".concat(a));for(var r=0,o=t.length;r<o;r++){var l=t[r],s=l.coverType,c="media"===s||"block"===s||"mall"===s,u=l[i[s]];if(u&&c){u=u+(l.extraValue4||"")+(l.extraValue5||"");var d=n[u];if(void 0!==d)return e.error("通用内容第 ".concat(d+1," 个资源与第 ").concat(r+1," 相同"));n[u]=r}if(!l.pictureUrl)return e.error("第 ".concat(r+1," 个通用内容缺少内容海报"))}e.$emit("save",{videoContentList:e.parseContentList(e.normalContentList),specificContentList:e.parseContentList(e.specificContentList)})})},genDefaultNormalContentWrapper:function(){return{selectionType:"manual",props:{}}},genDefaultContentForm:function(e){var t={coverType:this.isMall?"custom":"media",showTitle:this.hideTitleOptions?1:0};return Je(t)},handleCoverTypeChange:function(e){if("read"!==this.mode){var t=this.activeType,a=this.activeIndex,n=this[t+"ContentList"],i=n[a],r=this.genDefaultContentForm();r.coverType=e,"specific"===t?(r.resourceType=i.resourceType,r.dmpRegistryInfo=i.dmpRegistryInfo):"block"===e&&(this.specificContentList=[]),"maskLife"===e&&(r.videoContentType="maskLife"),"tvLive"===e&&(r.tvLiveInfo=He(),r.videoContentType="tvLive"),"media"!==e&&1===r.flagTagVector&&(r.flagTagVector=0),this.$set(n,a,r)}},handleRemoveContent:function(e,t){var a=this;this.$confirm("确认删除该内容","提示",{callback:function(n){if("confirm"===n){var i=a.activeType,r=a.activeIndex,o=a[t+"ContentList"];o.splice(e,1),i===t&&(o.length>0?void 0===o[r]&&a.handleActivate(t,e-1):a.handleActivate("normal"===t?"specific":"normal",0))}}})},handleAddContent:function(e){var t=this;if(this.isInterveneBlock)return this.$message.error("插入推荐位仅允许添加一个资源");this.$refs[this.activeType+"BlockForm"].validate(this.contentForm,function(a){if(a)t.$message({type:"error",message:a});else{var n=t[e+"ContentList"];"normal"===e?n.push(t.genDefaultContentForm(t.normalContentWrapper.props)):n.push(t.genDefaultContentForm()),t.activeType=e,t.activeIndex=n.length-1}})},handleActivate:function(e,t){var a=this;this[this.activeType+"ContentList"][this.activeIndex]?this.validateCurrentContent(function(){a.activeType=e,a.activeIndex=t}):(this.activeType=e,this.activeIndex=t)},validateCurrentContent:function(e){var t=this,a=this.contentForm;this.$refs[this.activeType+"BlockForm"].validate(a,function(n){return n?t.error(n):1!==a.flagSetRec||a.mediaAutomationBlockRls.mediaAutomationId?void e():t.$message.error("开关开启时，推荐流选择必须选择其一")})},setContentList:function(){var e=this,t=JSON.parse(JSON.stringify(this.data.block||"{}")),a=t.videoContentList||[],n=t.specificContentList||[],i=function(t){var a,n=e.genDefaultContentForm();if(t.cornerList=(t.cornerList||[]).reduce(function(e,t){return e[t.position]=t,e},n.cornerList),"custom"===t.coverType){var i=JSON.parse(t.onclick),r=t.params.split(",").reduce(function(e,t){var a=t.split("=="),n=Object(A["a"])(a,2),i=n[0],r=n[1];return e[i]=r,e},{}),o=r.openMode||"app";switch(o){case"webpage":i.webpageUrl=i.params.url,"coocaa.intent.action.browser"===i.byvalue&&(i.webpageType="1"),"coocaa.intent.action.browser.no_trans"===i.byvalue&&(i.webpageType="2");break;case"video":i.videoName=i.params.name,i.videoUrl=i.params.url;break;case"picture":i.pictureUrl=i.params.url;break;case"tab":i.tabId=i.params.id,i.tabType=r.tabType;break;case"app":var l=i.params;i.params=Object.keys(i.params).map(function(e){return{key:e,value:l[e]}});break;default:break}a=i,a.openMode=o,delete t.onclick}return a&&(t.redundantParams=a),t.bgParams&&(t.bgParams=JSON.parse(t.bgParams)),Object.assign({},n,t)};this.normalContentList=a.length>0?a.map(i):[this.genDefaultContentForm()],this.specificContentList=n.map(i)},parseContentList:function(e){e=JSON.parse(JSON.stringify(e));var t=function(e){var t=e.coverType,a="",n="";if("custom"===t&&(e.contentType=0),"block"===t&&(e.contentType=1),"custom"===t){var i=e.redundantParams,r=i.openMode;n="openMode=="+r;var o=i.webpageType;switch(r){case"webpage":"1"===o?a=JSON.stringify({packagename:"com.coocaa.app_browser",versioncode:i.versioncode,dowhat:"startActivity",bywhat:"action",byvalue:"coocaa.intent.action.browser",params:{url:i.webpageUrl},exception:{}}):"2"===o&&(a=JSON.stringify({packagename:"com.coocaa.app_browser",versioncode:i.versioncode,dowhat:"startActivity",bywhat:"action",byvalue:"coocaa.intent.action.browser.no_trans",params:{url:i.webpageUrl},exception:{}}));break;case"video":a=JSON.stringify({packagename:"com.tianci.movieplatform",versioncode:"-1",dowhat:"startService",bywhat:"action",byvalue:"coocaa.intent.player.video",params:{name:i.videoName,url:i.videoUrl,needParse:"false",url_type:"web"},exception:{}});break;case"picture":a=JSON.stringify({packagename:"com.tianci.movieplatform",versioncode:"",dowhat:"startService",bywhat:"action",byvalue:"coocaa.intent.player.image",params:{name:"",url:i.pictureUrl},exception:{}});break;case"tab":var l=i.tabType;n+=",tabType=="+l;var s="";s="1"===l?"coocaa.intent.action.HOME_COMMON_LIST":"13"===l?"coocaa.intent.action.HOME_SPECIAL_TOPIC_PAGE_EDU":"coocaa.intent.action.HOME_SPECIAL_TOPIC",a=JSON.stringify({packagename:"13"===l?"com.coocaa.educate":"com.tianci.movieplatform",versioncode:"",dowhat:"startActivity",bywhat:"action",byvalue:s,params:{id:i.tabId},exception:"13"===l?{name:"onclick_exception",value:{packagename:"com.tianci.appstore",dowhat:"startActivity",versioncode:"-1",params:{id:"com.coocaa.educate"},byvalue:"coocaa.intent.action.APP_STORE_DETAIL",bywhat:"action"}}:{}});break;case"app":for(var c={},u=i.params,d=0;d<u.length;d++){var p=u[d];""!==p.key&&""!==p.value&&(c[p.key]=p.value)}a=JSON.stringify({byvalue:i.byvalue,packagename:i.packagename,dowhat:i.dowhat,versioncode:i.versioncode,params:c,bywhat:i.bywhat,data:i.data,exception:{name:"onclick_exception",value:{packagename:"com.tianci.appstore",dowhat:"startActivity",versioncode:"-1",params:{id:i.packagename},byvalue:"coocaa.intent.action.APP_STORE_DETAIL",bywhat:"action"}}});break;default:break}}return e.onclick||(e.onclick=a),e.params=n,e.bgParams&&(delete e.bgParams.title,e.bgParams=JSON.stringify(e.bgParams)),this.isInterveneBlock&&delete e.redundantParams,e}.bind(this);return e.map(t)},checkCrowd:function(e){var t,a,n=this.specificContentList,i=n.length;while(--i>=0)if(a=n[i].dmpRegistryInfo,a&&a.dmpCrowdId===e.value){t=i;break}return t}},created:function(){this.setContentList()}},ia=na,ra=(a("b093"),a("4a60"),Object(w["a"])(ia,E,O,!1,null,"398a21dc",null)),oa=ra.exports,la=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-checkbox",{attrs:{disabled:e.disabled,value:e.boolValue},on:{input:e.handleInputValue}},[e._v("\n  "+e._s(e.label)+"\n")])},sa=[],ca={props:["value","label","disabled","isNegative"],computed:{boolValue:function(){var e=this.value;return void 0!==this.isNegative?!e:!!e}},methods:{handleInputValue:function(e){e=void 0!==this.isNegative?e?0:1:e?1:0,this.$emit("input",e)}}},ua=ca,da=Object(w["a"])(ua,la,sa,!1,null,null,null),pa=da.exports,ha=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{display:"inline-block"}},[a("div",{staticClass:"selector-wrapper"},[e._t("label",[e._v("标签跳转分类")]),a("el-button",{staticClass:"selector-button",attrs:{disabled:e.disabled,type:"primary"},on:{click:function(t){e.isShowDialog=!0}}},[e._v("分类选择")]),void 0!==e.value?a("el-tag",{attrs:{closable:!e.disabled},on:{close:function(t){return e.$emit("input")}}},[e._v("\n      "+e._s(e.valueTagName))]):e._e(),e._t("tip",[a("span",{staticStyle:{"margin-left":"10px"}},[e._v("本字段仅用于配置客户端上标签详情页的默认落焦，与其他逻辑无关")])])],2),a("el-dialog",{attrs:{title:"标签跳转分类选择",visible:e.isShowDialog,width:"800px"},on:{open:e.handleOpenDialog,"update:visible":function(t){e.isShowDialog=t}}},[a("CommonSelector",{attrs:{type:"radio",options:e.categoryEnums},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.isShowDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleComfirm}},[e._v("确 定")])],1)],1)],1)},ma=[],fa={components:{CommonSelector:ue["a"]},props:{value:String,disabled:Boolean},data:function(){return{isShowDialog:!1,selectTags:[],categoryEnums:[],inputValue:void 0}},computed:{valueTagName:function(){var e=this;return(this.categoryEnums.find(function(t){return t.value===e.value})||{}).label}},methods:{handleOpenDialog:function(){this.inputValue=this.value},handleComfirm:function(){this.$emit("input",this.inputValue),this.isShowDialog=!1}},created:function(){var e=this;this.$service.getFocusCategory().then(function(t){e.categoryEnums=(t||[]).map(function(e){return{label:e.dictCnName,value:e.dictEnName}})})}},va=fa,ga=(a("a4eb"),Object(w["a"])(va,ha,ma,!1,null,"2525e948",null)),ba=ga.exports,ya=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:"设置版块组信息",visible:e.showDialog,"close-on-click-modal":!0},on:{"update:visible":function(t){e.showDialog=t},close:e.handleSetCancel}},[a("el-form",{ref:"form",attrs:{"label-width":"140px",model:e.info,rules:e.rules},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.stopPropagation(),t.preventDefault(),e.handleSetEnd(t))}}},[a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{attrs:{disabled:"read"===e.mode,clearable:""},model:{value:e.info.title,callback:function(t){e.$set(e.info,"title",t)},expression:"info.title"}})],1),"timeSlot"===e.focusConfig?[a("el-form-item",{staticClass:"time-slot",attrs:{label:"时间段",prop:"startTime"}},[a("el-form-item",{attrs:{label:""}},[a("el-date-picker",{staticClass:"start-time",attrs:{disabled:"read"===e.mode,type:"datetime"},model:{value:e.info.startTime,callback:function(t){e.$set(e.info,"startTime",t)},expression:"info.startTime"}})],1),e._v("\n            -\n            "),a("el-form-item",{attrs:{label:""}},[a("el-date-picker",{staticClass:"end-time",attrs:{disabled:"read"===e.mode,type:"datetime"},model:{value:e.info.endTime,callback:function(t){e.$set(e.info,"endTime",t)},expression:"info.endTime"}})],1)],1),a("el-form-item",{attrs:{label:"",prop:"panelIsFocus"}},[a("el-checkbox",{attrs:{disabled:"read"===e.mode,value:!!e.info.panelIsFocus},on:{input:function(t){e.info.panelIsFocus=t?1:0}}},[e._v("空时间段默认落焦")])],1)]:e._e()],2),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleSetCancel}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSetEnd}},[e._v("确 定")])],1)],1)],1)},wa=[],Ia={data:function(){return{showDialog:!0,timeSlotError:"",rules:{title:[{required:!0,message:"请输入标题"}],startTime:[{validator:this.timeSlotValidator.bind(this)}]}}},props:["mode","info","panelList","focusConfig"],methods:{handleSetCancel:function(){this.$emit("set-cancel")},handleSetEnd:function(){var e=this;this.$refs.form.validate(function(t){t?e.$emit("set-end"):e.$message({type:"error",message:"请把表单填写完整"})})},timeSlotValidator:function(e,t,a){var n,i,r=this.panelList,o=this.info,l=o.index,s=r.length,c=o.startTime,u=o.endTime;if(c&&u){if(c>=u)return a(Error("开始时间必须小于结束时间"));while(--s>=0)if(s!==l){var d=r[s],p=d.startTime,h=d.endTime;if(p&&(c<=p&&u>=p||p<=c&&h>=c)){n=s,i=p.toISOString()+"-"+h.toISOString();break}}}else{if(c&&!u)return a(Error("请设置结束时间"));if(u&&!c)return a(Error("请设置开始时间"));if(1!==o.panelIsFocus)return a(Error("时间段和空时间段默认落焦至少设置一个"))}void 0!==n?a(Error("与第 "+(n+1)+" 个分组的时间段 "+i+" 重合")):a()}}},Ca=Ia,Ta=(a("980b"),Object(w["a"])(Ca,ya,wa,!1,null,"53dfafba",null)),Sa=Ta.exports,ka=a("c3da"),_a=a.n(ka),Pa=(a("95a8"),a("db0e"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"video-list"},[e._l(e.blocks,function(t,n){return[t.videoContentList[0]?a("Var",{key:n,class:{"video-item":!0,"video-item--duplicated":t.duplicated},attrs:{video:t.videoContentList[0]},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.video;return[a("img",{staticClass:"video-item__img",attrs:{referrerpolicy:"no-referrer",src:i.pictureUrl}}),a("div",{staticClass:"video-item__release",attrs:{title:i.title}},[e._v("\n          "+e._s(i.subscribeOnlineTime||"敬请期待")+"\n        ")]),a("div",{staticClass:"video-item__title",attrs:{title:i.title}},[e._v("\n          "+e._s(i.title)+"\n        ")]),a("div",{staticClass:"video-item__title video-item__title--sub",attrs:{title:i.subTitle}},[e._v("\n          "+e._s(i.subTitle)+"\n        ")]),"read"!==e.mode?a("i",{staticClass:"video-item__remove el-icon-circle-close",attrs:{title:"移除"},on:{click:function(t){return e.handleRemoveItem(n)}}}):e._e()]}}],null,!0)}):e._e()]})],2)}),xa=[],Fa=a("b6c7"),Da={components:{Var:Fa["a"]},props:["mode","blocks"],data:function(){return{}},computed:{videoContentList:function(){return(this.blocks||[]).map(function(e){return e.videoContentList[0]})}},methods:{handleRemoveItem:function(e){this.$emit("remove-block",e)}}},Ra=Da,La=(a("2252"),Object(w["a"])(Ra,Pa,xa,!1,null,"eb58df0e",null)),$a=La.exports,Na=a("2ef0"),Ea=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.isVisibleDialog=!0}}},[e._v("配置影片筛选规则")]),a("el-dialog",{attrs:{title:"配置影片筛选规则",width:"60%",visible:e.isVisibleDialog,"close-on-click-modal":!1},on:{"update:visible":function(t){e.isVisibleDialog=t},open:e.handleOpenDialog,closed:e.handleCloseDialog}},[a("div",{directives:[{name:"show",rawName:"v-show",value:0===e.stepCount,expression:"stepCount === 0"}]},[a("div",{staticClass:"step-title"},[e._v("选择内容源")]),a("el-checkbox-group",{staticClass:"items-group",attrs:{value:e.sourceList},on:{input:e.handleInputSourceList}},e._l(e.sourceListOptions,function(t,n){return a("el-checkbox",{key:n,attrs:{label:t.value}},[e._v(e._s(t.label))])}),1),a("el-button",{attrs:{type:"primary",disabled:0===e.sourceList.length},on:{click:e.handleOneStepNext}},[e._v("下一步")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:1===e.stepCount,expression:"stepCount === 1"}]},[a("div",{staticClass:"step-title"},[e._v("选择影视业务筛选条件")]),a("div",[e._v("(1) 影片分类")]),a("el-checkbox-group",{staticClass:"margin-bottom-20 items-group",model:{value:e.movieFilterForm.categorys,callback:function(t){e.$set(e.movieFilterForm,"categorys",t)},expression:"movieFilterForm.categorys"}},e._l(e.filmTypeOptions,function(t){return a("el-checkbox",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label))])}),1),a("div",[e._v("(2) 影片标签 \n        "),a("el-radio-group",{model:{value:e.movieFilterForm.tagsRelation,callback:function(t){e.$set(e.movieFilterForm,"tagsRelation",t)},expression:"movieFilterForm.tagsRelation"}},[a("el-radio",{attrs:{label:0}},[e._v("或")]),a("el-radio",{attrs:{label:1}},[e._v("且")])],1),a("TagLogicFilter",{ref:"movieTagLogicFilter",staticClass:"margin-bottom-20",attrs:{hiddenExtend:"",value:e.movieFilterForm.tagCodes},on:{input:e.handleInputMovieTag,"get-tag-entity":e.handleGetMovieTagEntity}})],1),a("div",[e._v("(3) 演员")]),a("div",{staticClass:"margin-bottom-20"},[e._l(e.movieFilterForm.actors,function(t,n){return a("el-tag",{key:n,attrs:{closable:""},on:{close:function(t){return e.handleDeleteTag(e.movieFilterForm.actors,n)}}},[e._v("\n          "+e._s(t)+"\n        ")])}),e.inputVisible.actor?a("el-input",{ref:"actorTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:function(t){return e.handleTagInputConfirm(e.movieFilterForm.actors,"actor")}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleTagInputConfirm(e.movieFilterForm.actors,"actor")}},model:{value:e.inputTagValue,callback:function(t){e.inputTagValue=t},expression:"inputTagValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:function(t){return e.showTagInput("actor")}}},[e._v("+ New Tag")])],2),a("div",[e._v("(4) 导演")]),a("div",{staticClass:"margin-bottom-20"},[e._l(e.movieFilterForm.directors,function(t,n){return a("el-tag",{key:n,attrs:{closable:""},on:{close:function(t){return e.handleDeleteTag(e.movieFilterForm.directors,n)}}},[e._v("\n          "+e._s(t)+"\n        ")])}),e.inputVisible.director?a("el-input",{ref:"directorTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:function(t){return e.handleTagInputConfirm(e.movieFilterForm.directors,"director")}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleTagInputConfirm(e.movieFilterForm.directors,"director")}},model:{value:e.inputTagValue,callback:function(t){e.inputTagValue=t},expression:"inputTagValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:function(t){return e.showTagInput("director")}}},[e._v("+ New Tag")])],2),a("div",[e._v("(5) 地区")]),a("el-checkbox-group",{staticClass:"margin-bottom-20 items-group",model:{value:e.movieFilterForm.areas,callback:function(t){e.$set(e.movieFilterForm,"areas",t)},expression:"movieFilterForm.areas"}},e._l(e.filmAreaOptions,function(t,n){return a("el-checkbox",{key:n,attrs:{label:t.value}},[e._v(e._s(t.label))])}),1),a("div",[e._v("(6) 付费类型")]),a("el-checkbox-group",{staticClass:"margin-bottom-20 items-group",model:{value:e.movieFilterForm.payTypes,callback:function(t){e.$set(e.movieFilterForm,"payTypes",t)},expression:"movieFilterForm.payTypes"}},e._l(e.filmPayTypeOptions,function(t){return a("el-checkbox",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label))])}),1),a("div",[e._v("(7) 影视视频特点")]),a("el-checkbox-group",{staticClass:"margin-bottom-20",model:{value:e.movieFilterForm.videoFeatures,callback:function(t){e.$set(e.movieFilterForm,"videoFeatures",t)},expression:"movieFilterForm.videoFeatures"}},[a("el-checkbox",{attrs:{label:"1"}},[e._v("具有4k")]),a("el-checkbox",{attrs:{label:"2"}},[e._v("具有杜比")])],1),a("div",[e._v("(8) 长短片区分"),a("span",{staticStyle:{"font-size":"12px","margin-left":"10px"}},[e._v("（左边是我们计算的长短片区分，右边是第三方给到的）")])]),a("div",[a("div",{staticClass:"inline-checkbox-group"},[a("el-checkbox-group",{staticClass:"margin-bottom-20",model:{value:e.movieFilterForm.longShortTypes,callback:function(t){e.$set(e.movieFilterForm,"longShortTypes",t)},expression:"movieFilterForm.longShortTypes"}},e._l(e.filmLongShortTypeOptions,function(t){return a("el-checkbox",{key:t.value,attrs:{label:t.value}},[e._v("\n              "+e._s(t.label)+"\n            ")])}),1)],1),a("div",{staticClass:"inline-checkbox-group"},[a("el-checkbox-group",{staticClass:"margin-bottom-20",model:{value:e.movieFilterForm.contentTypes,callback:function(t){e.$set(e.movieFilterForm,"contentTypes",t)},expression:"movieFilterForm.contentTypes"}},e._l(e.filmContentTypeOptions,function(t){return a("el-checkbox",{key:t.value,attrs:{label:t.value}},[e._v("\n              "+e._s(t.label)+"\n            ")])}),1)],1)]),a("div",[e._v("(9) 创建时间")]),a("el-row",{staticClass:"margin-bottom-20",staticStyle:{width:"100%"},attrs:{gutter:1}},[a("el-col",{attrs:{span:8}},[a("el-select",{attrs:{filterable:""},on:{change:e.handleResetFilmTime},model:{value:e.createdTimeSelect,callback:function(t){e.createdTimeSelect=t},expression:"createdTimeSelect"}},[a("el-option",{attrs:{value:1,label:"时间段选择"}}),a("el-option",{attrs:{value:2,label:"最近x个月"}})],1)],1),a("el-col",{attrs:{span:16}},[1===e.createdTimeSelect?a("el-date-picker",{attrs:{type:"daterange",align:"right","value-format":"yyyy-MM-dd","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.movieFilterForm.createdTime,callback:function(t){e.$set(e.movieFilterForm,"createdTime",t)},expression:"movieFilterForm.createdTime"}}):a("div",[a("InputPositiveInt",{staticStyle:{width:"100px"},attrs:{clearable:""},model:{value:e.movieFilterForm.createdMonthTime,callback:function(t){e.$set(e.movieFilterForm,"createdMonthTime",t)},expression:"movieFilterForm.createdMonthTime"}}),a("span",[e._v(" 个月")])],1)],1)],1),a("div",[e._v("(10) 热度")]),a("el-row",{staticClass:"margin-bottom-20",attrs:{gutter:1}},[a("el-col",{attrs:{span:8}},[a("el-select",{attrs:{filterable:""},model:{value:e.feverSelect,callback:function(t){e.feverSelect=t},expression:"feverSelect"}},[a("el-option",{attrs:{value:1,label:"一月热度"}}),a("el-option",{attrs:{value:2,label:"一周热度"}})],1)],1),a("el-col",{attrs:{span:16}},[e._v("\n          Top "),a("InputPositiveInt",{staticStyle:{width:"100px"},attrs:{clearable:""},model:{value:e.movieFilterForm.feverTop,callback:function(t){e.$set(e.movieFilterForm,"feverTop",t)},expression:"movieFilterForm.feverTop"}}),a("span",{staticClass:"tip-text"},[e._v("填写6及以上整数")])],1)],1),a("div",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleStepBack}},[e._v("上一步")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleTwoStepNext}},[e._v("下一步")])],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:2===e.stepCount,expression:"stepCount === 2"}]},[a("div",{staticClass:"step-title"},[e._v("选择教育业务筛选条件")]),a("div",[e._v("(1) 影片分类")]),a("el-checkbox-group",{staticClass:"margin-bottom-20 items-group",model:{value:e.eduFilterForm.teachCategory,callback:function(t){e.$set(e.eduFilterForm,"teachCategory",t)},expression:"eduFilterForm.teachCategory"}},e._l(e.teachCategoryOptions,function(t){return a("el-checkbox",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label))])}),1),a("div",[e._v("(2) 影片标签 \n        "),a("el-radio-group",{model:{value:e.eduFilterForm.tagsRelation,callback:function(t){e.$set(e.eduFilterForm,"tagsRelation",t)},expression:"eduFilterForm.tagsRelation"}},[a("el-radio",{attrs:{label:0}},[e._v("或")]),a("el-radio",{attrs:{label:1}},[e._v("且")])],1),a("TagLogicFilter",{ref:"eduTagLogicFilter",staticClass:"margin-bottom-20",attrs:{hiddenExtend:"",value:e.eduFilterForm.teachTagCodes},on:{input:e.handleInputEduTag,"get-tag-entity":e.handleGetEduTagEntity}})],1),a("div",[e._v("(3) CP名")]),a("div",{staticClass:"margin-bottom-20"},[e._l(e.eduFilterForm.company,function(t,n){return a("el-tag",{key:n,attrs:{closable:""},on:{close:function(t){return e.handleDeleteTag(e.eduFilterForm.company,n)}}},[e._v("\n          "+e._s(t)+"\n        ")])}),e.inputVisible.company?a("el-input",{ref:"companyTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:function(t){return e.handleTagInputConfirm(e.eduFilterForm.company,"company")}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleTagInputConfirm(e.eduFilterForm.company,"company")}},model:{value:e.inputTagValue,callback:function(t){e.inputTagValue=t},expression:"inputTagValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:function(t){return e.showTagInput("company")}}},[e._v("+ New Tag")])],2),a("div",[e._v("(4) 地区")]),a("el-checkbox-group",{staticClass:"margin-bottom-20 items-group",model:{value:e.eduFilterForm.teachCategory,callback:function(t){e.$set(e.eduFilterForm,"teachCategory",t)},expression:"eduFilterForm.teachCategory"}},e._l(e.teachAreaOptions,function(t,n){return a("el-checkbox",{key:n,attrs:{label:t.value}},[e._v(e._s(t.label))])}),1),a("div",[e._v("(5) 教育媒资特点")]),a("el-checkbox-group",{staticClass:"margin-bottom-20",staticStyle:{"margin-top":"10px"},attrs:{value:e.eduFilterForm.teachFeatures},on:{input:e.handleInputTeachFeatures}},[a("el-checkbox",{attrs:{label:1}},[e._v("仅选取绘本")]),a("el-checkbox",{attrs:{label:2}},[e._v("仅选取有声读物")]),a("el-checkbox",{attrs:{label:3}},[e._v("仅选取视频内容")])],1),a("div",[e._v("(6) 创建时间")]),a("el-row",{staticClass:"margin-bottom-20",staticStyle:{width:"100%"},attrs:{gutter:1}},[a("el-col",{attrs:{span:8}},[a("el-select",{on:{change:e.handleResetEduTime},model:{value:e.eduCreatedTimeSelect,callback:function(t){e.eduCreatedTimeSelect=t},expression:"eduCreatedTimeSelect"}},[a("el-option",{attrs:{value:1,label:"时间段选择"}}),a("el-option",{attrs:{value:2,label:"最近x个月"}})],1)],1),a("el-col",{attrs:{span:16}},[1===e.eduCreatedTimeSelect?a("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","value-format":"yyyy-MM-dd","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.eduFilterForm.teachCreatedTime,callback:function(t){e.$set(e.eduFilterForm,"teachCreatedTime",t)},expression:"eduFilterForm.teachCreatedTime"}}):a("div",[a("InputPositiveInt",{staticStyle:{width:"100px"},model:{value:e.eduFilterForm.teachCreatedMonthTime,callback:function(t){e.$set(e.eduFilterForm,"teachCreatedMonthTime",t)},expression:"eduFilterForm.teachCreatedMonthTime"}}),a("span",[e._v("个月")])],1)],1)],1),a("div",[e._v("(7) 热度")]),a("el-row",{staticClass:"margin-bottom-20",attrs:{gutter:1}},[a("el-col",{attrs:{span:8}},[a("el-select",{model:{value:e.eduFeverSelect,callback:function(t){e.eduFeverSelect=t},expression:"eduFeverSelect"}},[a("el-option",{attrs:{value:1,label:"一月热度"}}),a("el-option",{attrs:{value:2,label:"一周热度"}})],1)],1),a("el-col",{attrs:{span:16}},[e._v("\n          Top"),a("InputPositiveInt",{staticStyle:{width:"100px"},model:{value:e.eduFilterForm.feverTop,callback:function(t){e.$set(e.eduFilterForm,"feverTop",t)},expression:"eduFilterForm.feverTop"}}),a("span",{staticClass:"tip-text"},[e._v("填写6及以上整数")])],1)],1),a("div",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleStepBack}},[e._v("上一步")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleThreeStepNext}},[e._v("下一步")])],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:3===e.stepCount,expression:"stepCount === 3"}]},[a("div",{staticClass:"step-title"},[e._v("设置排序规则（"+e._s(e.filmFilterCount)+"部影片）")]),a("el-radio-group",{model:{value:e.homeOrderType,callback:function(t){e.homeOrderType=t},expression:"homeOrderType"}},[a("el-radio",{staticClass:"order-radio",attrs:{label:0}},[e._v("创建时间排序（越新的排越前面）")]),a("el-radio",{staticClass:"order-radio",attrs:{label:1}},[e._v("热度排序（越热的排越前面）")]),a("el-radio",{staticClass:"order-radio",attrs:{label:2}},[e._v("创建时间+热度排序（优先热度排序）")]),a("el-radio",{staticClass:"order-radio",attrs:{label:3}},[e._v("创建时间+热度排序（优先创建时间排序）")])],1),a("div",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleStepBack}},[e._v("上一步")]),a("el-button",{attrs:{type:"primary",disabled:e.filmFilterCount<12,title:"影片数量少于12，无法创建版块"},on:{click:e.handleStepEnd}},[e._v("完成")])],1)],1)])],1)},Oa=[],Aa=a("e32f"),Va=[{label:"创建时间排序",value:0},{label:"热度排序",value:1},{label:"创建时间+热度排序（优先热度）",value:2},{label:"创建时间+热度排序（优先创建时间）",value:3}],Ba={components:{InputPositiveInt:g["a"],TagLogicFilter:Aa["a"]},props:["source"],data:function(){return{isVisibleDialog:!1,stepCount:0,stepStack:[],sourceList:[],sourceListOptions:[],filmTypeOptions:[],filmAreaOptions:[],filmPayTypeOptions:[],filmContentTypeOptions:[],filmLongShortTypeOptions:[],movieFilterForm:{categorys:[],tagsRelation:1,tagCodes:[],actors:[],directors:[],areas:[],payTypes:[],videoFeatures:[],longShortTypes:["0"],contentTypes:[],createdTime:[],createdMonthTime:void 0,feverTop:void 0},createdTimeSelect:1,feverSelect:1,teachCategoryOptions:[],teachAreaOptions:[],teachFeatureOptions:[],eduFilterForm:{teachCategory:[],tagsRelation:1,teachTagCodes:[],company:[],teachAreas:[],teachFeatures:[],teachCreatedTime:[],teachCreatedMonthTime:void 0,feverTop:void 0},eduCreatedTimeSelect:1,eduFeverSelect:1,inputVisible:{actor:!1,director:!1,company:!1},inputTagValue:"",pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近两周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-12096e5),e.$emit("pick",[a,t])}},{text:"最近三周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-18144e5),e.$emit("pick",[a,t])}}]},isMovieFilter:!0,isEduFilter:!1,filmFilterCount:0,homeOrderType:0,homeOrderTypeOptions:Va}},methods:{handleInputSourceList:function(e){var t=this.sourceList||[],a=t.includes("teach"),n=e.includes("teach");!a&&n?this.sourceList=["teach"]:a&&e.length>1?this.sourceList=e.filter(function(e){return"teach"!==e}):this.sourceList=e},handleInputTeachFeatures:function(e){var t=this.eduFilterForm,a=t.teachFeatures;t.teachFeatures=e.filter(function(e){return!a.includes(e)})},handleOpenDialog:function(){var e=this;this.$service.getFilmFilterPartnerSource({partnerName:this.$consts.sourceToPartner[this.source]}).then(function(t){e.sourceListOptions=t.rows[0].source_List.map(function(e){return{label:e.source_title,value:e.source_code}})})},handleCloseDialog:function(){Object.assign(this.$data,this.$options.data()),this.$refs.movieTagLogicFilter.tags=[[]],this.$refs.eduTagLogicFilter.tags=[[]]},handleOneStepNext:function(){var e=this,t=this.sourceList,a=t.findIndex(function(e){return"teach"===e});this.isEduFilter=-1!==a,this.isEduFilter?this.$message.error("暂不支持教育筛选规则，期待下一期哦^-^"):(this.isEduFilter&&1===t.length?this.isMovieFilter=!1:this.isMovieFilter=!0,this.isMovieFilter?(this.stepStack.push(this.stepCount),this.stepCount++,this.$service.getFilmFilterOptions({businessType:0,type:"vod"}).then(function(t){var a=JSON.parse(t.replace("result(","").replace(/\)*$/,"")),n=a.vod||{},i=n.contentTypes,r=void 0===i?[]:i,o=n.longShortTypes,l=void 0===o?[]:o;e.filmTypeOptions=(a.vod.categoryList||[]).map(function(e){return{label:e.categoryName,value:e.categoryId}}),e.filmAreaOptions=(a.vod.areas||[]).map(function(e){return{label:e.tagCnName,value:e.tagCnName}}),e.filmPayTypeOptions=(a.vod.payTypes||[]).map(function(e){return{label:e.tagCnName,value:e.tagEnName}}),e.filmContentTypeOptions=r.map(function(e){return{label:e.contentType,value:e.contentTypeId}}),e.filmLongShortTypeOptions=l.map(function(e){return{label:e.tagCnName,value:e.tagEnName}})})):(this.stepStack.push(this.stepCount),this.stepCount+=2,this.stepIntoEduBusiness()))},stepIntoEduBusiness:function(){var e=this;this.$service.getFilmFilterOptions({businessType:1,type:"vod"}).then(function(t){var a=JSON.parse(t.replace("result(","").replace(/\)*$/,""));e.teachCategoryOptions=(a.vod.teachCategory||[]).map(function(e){return{label:e.tagCnName,value:e.tagEnName}}),e.teachAreaOptions=(a.vod.areas||[]).map(function(e){return{label:e.tagCnName,value:e.tagCnName}})})},handleTwoStepNext:function(){var e=this.movieFilterForm.feverTop;e&&e<6?this.$message.error("热度请填写6及以上整数"):(this.stepStack.push(this.stepCount),this.isEduFilter?this.stepCount++:(this.stepCount+=2,this.handleGetFilterResult()),this.scrollTop())},handleThreeStepNext:function(){this.stepStack.push(this.stepCount),this.stepCount++,this.handleGetFilterResult()},handleStepBack:function(){this.stepCount=this.stepStack.pop(),this.scrollTop()},handleGetFilterResult:function(e){var t=this,a=this.isMovieFilter,n=this.isEduFilter,i=this.sourceList,r=this.movieFilterForm,o=this.eduFilterForm,l={sources:i.join(","),homeOrderType:e,page:1,rows:30},s={};if(a){var c=["@","#"][r.tagsRelation];s={categorys:r.categorys.join(","),tagCodes:r.tagCodes.join(c),actors:r.actors.join(","),directors:r.directors.join(","),areas:r.areas.join(","),payTypes:r.payTypes.join(","),videoFeatures:r.videoFeatures.join(","),longShortTypes:r.longShortTypes.join(","),contentTypes:r.contentTypes.join(",")};var u=this.createdTimeSelect;1===u&&0!==r.createdTime.length?(s.createdTimeStart=r.createdTime[0],s.createdTimeEnd=r.createdTime[1]):s.recentMonths=r.createdMonthTime;var d=this.feverSelect;1===d?s.monthHotTop=r.feverTop:s.weekHotTop=r.feverTop}var p={};if(n){var h=["@","#"][o.tagsRelation];p={teachCategory:o.teachCategory.join(","),company:o.company.join(","),teachTagCodes:o.teachTagCodes.join(h),teachAreas:o.teachAreas.join(","),teachFeatures:o.teachFeatures.join(",")};var m=this.eduCreatedTimeSelect;1===m&&0!==o.teachCreatedTime.length?(p.teachCreatedTimeStart=o.teachCreatedTime[0],p.teachCreatedTimeEnd=o.teachCreatedTime[1]):p.teachRecentMonths=o.teachCreatedMonthTime;var f=this.eduFeverSelect;1===f?p.teachMonthHotTop=o.feverTop:p.teachWeekHotTop=o.feverTop}return a&&n?(Object.assign(l,s),Object.assign(l,p)):a?Object.assign(l,s):Object.assign(l,p),this.$service.getFilmFilterResult(l).then(function(a){if(t.filmFilterCount=a.data?a.data.total:0,t.filmFilterCount<12)return t.$message.error("该筛选规则仅获取".concat(t.filmFilterCount,"部影片，少于12部，不可创建版块影片数量少于12，无法创建版块"));if(void 0!==e){var n=t.parseRuleDesc();t.$emit("get-filter-result",{mediaRule:l,hasEdu:t.isEduFilter?1:0,mediaRuleDesc:n})}})},handleStepEnd:function(){var e=this;this.handleGetFilterResult(this.homeOrderType).then(function(){e.isVisibleDialog=!1})},scrollTop:function(){var e=this;this.$nextTick(function(){var t=e.$el.querySelector(".el-dialog__wrapper");t.scrollTop=0})},handleDeleteTag:function(e,t){e.splice(t,1)},handleTagInputConfirm:function(e,t){this.inputTagValue&&e.push(this.inputTagValue),this.inputVisible[t]=!1,this.inputTagValue=""},showTagInput:function(e){var t=this;this.inputVisible[e]=!0;var a=e+"TagInput";this.$nextTick(function(e){t.$refs[a].$refs.input.focus()})},handleResetFilmTime:function(){this.movieFilterForm.createdTime=void 0,this.movieFilterForm.createdMonthTime=void 0},handleResetEduTime:function(){this.eduFilterForm.teachCreatedTime=void 0,this.eduFilterForm.teachCreatedMonthTime=void 0},parseRuleDesc:function(){var e=this.sourceList,t=this.sourceListOptions,a=this.isMovieFilter,n=this.isEduFilter,i=this.movieFilterForm,r=this.eduFilterForm,o=function(e,t,a){return t.map(function(t){var a=e.find(function(e){return e.value==t});return a.label}).join(a)},l="内容源："+o(t,e," || ")+"\n";if(l+="\n",a){var s=this.filmTypeOptions,c=this.filmAreaOptions,u=this.filmPayTypeOptions,d=this.movieCodeTagDesc,p=this.filmLongShortTypeOptions,h=this.filmContentTypeOptions,m=i.categorys,f=i.tagsRelation,v=i.tagCodes,g=i.actors,b=i.directors,y=i.areas,w=i.payTypes,I=i.videoFeatures,C=i.longShortTypes,T=i.contentTypes,S=i.createdTime,k=i.createdMonthTime,_=i.feverTop;l+="影视业务规则：\n",0!==m.length&&(l+="分类："+o(s,m,"、")+"\n"),0!==v.length&&(l+="标签："+d+"("+["或","且"][f]+"关系)\n"),0!==g.length&&(l+="演员："+g.join("、")+"\n"),0!==b.length&&(l+="导演："+b.join("、")+"\n"),0!==y.length&&(l+="地区："+o(c,y,"、")+"\n"),0!==w.length&&(l+="付费类型："+o(u,w,"、")+"\n"),0!==I.length&&(l+="视频特点："+o([{label:"4k",value:1},{label:"杜比",value:2}],I,"、")+"\n"),C.length>0&&(l+="长短片：".concat(o(p,C,"、"),"\n")),T.length>0&&(l+="长短片（第三方）：".concat(o(h,T,"、"),"\n"));var P=this.createdTimeSelect;1===P&&0!==i.createdTime.length?l+="新度："+S.join("、")+"\n":k&&(l+="新度：最近"+k+"个月\n");var x=this.feverSelect;_&&(l+="热度："+x===1?"一月热度Top"+_:"一周热度Top"+_+"\n"),l+="\n"}if(n){var F=this.teachCategoryOptions,D=this.teachAreaOptions,R=this.eduCodeTagDesc,L=r.teachCategory,$=r.tagsRelation,N=r.teachTagCodes,E=r.company,O=r.teachAreas,A=r.teachFeatures,V=r.teachCreatedTime,B=r.teachRecentMonths,M=r.feverTop;l+="教育业务规则：\n",0!==L.length&&(l+=o(F,L,"、")+"\n"),0!==N.length&&(l+="标签："+R+"("+["或","且"][$]+"关系)\n"),0!==E.length&&(l+="CP名："+E.join("、")+"\n"),0!==O.length&&(l+="地区："+o(D,O,"、")+"\n"),0!==A.length&&(l+="视频特点："+o([{label:"绘本",value:1},{label:"有声读物",value:2},{label:"视频内容",value:3}],A,"、")+"\n");var U=this.eduCreatedTimeSelect;1===U&&0!==r.teachCreatedTime.length?l+="新度："+V.join("、")+"\n":B&&(l+="新度：最近"+B+"个月\n");var G=this.eduFeverSelect;M&&(l+="热度："+G===1?"一月热度Top"+M:"一周热度Top"+M+"\n"),l+="\n"}var j=this.homeOrderTypeOptions,z=this.homeOrderType;return l+="排序规则："+o(j,[z],""),l},handleGetMovieTagEntity:function(e){this.movieCodeTagDesc=(e[0]||[]).map(function(e){return e.tagCnName}).join("、")},handleInputMovieTag:function(e){this.movieFilterForm.tagCodes=(e[0]||"").split(",")},handleGetEduTagEntity:function(e){this.eduCodeTagDesc=(e[0]||[]).map(function(e){return e.tagCnName}).join("、")},handleInputEduTag:function(e){this.eduFilterForm.teachTagCodes=(e[0]||"").split(",")}},created:function(){}},Ma=Ba,Ua=(a("3125"),Object(w["a"])(Ma,Ea,Oa,!1,null,"2bc0cd9e",null)),Ga=Ua.exports,ja=a("056e"),za=a("4275"),Wa=12,qa=1,Ja=3,Ha={mixins:[h["a"]],components:{TabPage:s["a"],PageWrapper:c["a"],PageContentWrapper:u["a"],ContentCard:d["a"],CommonContent:p["a"],CommonSelector:ue["a"],VirtualPanel:m["a"],VirtualIntervenePanel:C,SourceRadioSelector:T["a"],LayoutSelector:$,GlobalPictureSelector:N["a"],BlockContent:oa,BinCheckBox:pa,ResourceSelector:ce["a"],PanelGroupInfoSetter:Sa,TagFrame:Pe,VeLine:_a.a,SubscribeVideos:$a,NewBlockRecStreamSelector:we["a"],ConfigureFilmFilterRule:Ga,ClickCopy:ja["a"],TagTypeSelector:ba},data:function(){var e={grid:{top:"10%",left:"5%",right:"5%",bottom:"10%",containLabel:!0},series:function(e){return e[0].smooth=!1,e},xAxis:{axisLabel:{rotate:45,formatter:function(e){var t=e.indexOf("(");if(-1===t)return e;var a=e.slice(t-e.length),n=e.slice(0,t);return["{a|".concat(a,"}"),n].join("")},rich:{a:{color:"red"}}}},color:["#1E90FF ","#2f4554"]};return this.markLine={data:[{name:"平均线",type:"average"}]},this.markPoint={data:[{name:"最大值",type:"max"},{name:"最小值",type:"min"}]},{scene:"1",extend:e,settings:{labelMap:{y:"曝光UV"}},isCollapseData:!0,panelUVCTR:{value:"",dailyGrowth:"",weeklyGrowth:""},panelUVCTRPercent:{value:"N/A",dailyGrowth:"N/A",weeklyGrowth:"N/A"},panelChartDataArr:[],mode:"create",activePage:"panel_info",PANNEL_STATUS:{draft:2,waiting:3,accepted:4,rejected:5},showResourceSelector:!1,selectedLayoutId:void 0,selectedLayout:null,blocks:[],selectedResources:[],selectedFocusImgUrl:void 0,copyToPanelDataType:this.panelDataType,blockContentProps:{},blockConetentInterveneProps:{},pannelType:1,pannel:{pannelGroupId:void 0,pannelName:"",panelGroupCategory:67,parentType:"normal",flagIs4k:0,pannelResource:"o_tencent",groupTitle:void 0,panelGroupType:void 0,showTitle:1,selectV:"",lucenyFlag:0,focusShape:0,focusImgUrl:void 0,focusConfig:"",currentVersion:"",flagThirdSourceCorner:1,pannelList:[]},isShowfocusImgUrl:!1,blockList:[],blockCountList:[0],blockCount:1,businessTypeEnums:[],currentBlockIndex:void 0,currentInterveneBlockIndex:void 0,activePannelIndex:"0",activePanelGroup:void 0,showAddTagDialog:!1,sharedTags:[],isResetingData:!1,allowRankBusinessTypes:[67,60,31],picDialogVisible:!1,reviewPicUrl:void 0,mediaRuleLayoutOptions:[],MAX_MEDIA_RULE_VIDEO_COUNT:30,isShowThirdCorner:!1,thirdSourcePrefixMap:ot,thirdSourceOptions:[]}},props:["id","initMode","version","panelDataType","initGroupIndex","initBlockIndex"],computed:{interveneHideTitle:function(){var e=+this.selectedLayoutId;if(e<=8||12===e)return e%2===0;if(11===e){var t=this.blockConetentInterveneProps,a=t.block.intervenePos;return a>3}return!1},showPannelTitleField:function(){var e=this.pannel;return"normal"===e.parentType||"subscribe"===e.parentType||"tag"===e.parentType},finalMediaRuleLayoutOptions:function(){this.pannelFillType;var e=this.PANEL_FILL_TYPE,t=this.mediaRuleLayoutOptions;return e.recStream,t},interveneMaxCount:function(){var e=this.selectedLayoutId;return[9,9,6,6,8,8,9,9][e-1]},filmNumOptions:function(){return Array.apply(null,{length:6}).map(function(e,t){return{label:t+5,value:t+5}})},resourceName:function(){return 3===this.currentPanelDataType?"业务专辑":"版块"},isFrozen:function(){return Object(za["a"])(this.pannel)},resourceInfo:function(){var e=this.pannel;if(e.pannelGroupId)return{id:e.pannelGroupId,version:e.currentVersion,status:e.pannelStatus,type:"pannel",menuElId:"pannelInfo"}},mediaResourceSelectors:function(){return["video","app","edu","pptv","live","topic","rotate","good"]},mediaResourceSelectionType:function(){return this.isFillWithRanking?"single":"multiple"},currentPanelDataType:function(){var e=this.pannel;return e.pannelGroupId?e.panelGroupType:this.panelDataType},hasSource:function(){var e=this.pannel.panelGroupCategory;return 31===e||67===e},isVideoOrEdu:function(){var e=this.pannel.panelGroupCategory;return 31===e||62===e||60===e},isReplica:function(){return"replicate"===this.mode||"yes"===this.pannel.duplicateVersion},isSelectMultiResource:function(){var e=this.selectedLayout.layoutJsonParsed;return!e||"Panel"!==e.type||1!==e.contents.length},alienFocusResolution:function(){var e=this.selectedLayout;if(e){var t=e.layoutJsonParsed.contents[0],a=t.width+15+15,n=t.height+20+79,i=a+"*"+n;return i}},panelResourceIds:function(){var e=[],t={movie:!0,edu:!0,shopping:!1,app:!1};return this.pannel.pannelList.forEach(function(a){a.contentList.forEach(function(a){a.videoContentList.forEach(function(a){var n=a.videoContentType,i=a.extraValue1||"";i&&t[n]&&e.push(i)})})}),e},isShowTagsField:function(){for(var e=this.pannel.pannelList,t=!!this.selectedLayout,a=0,n=e.length;a<n;a++)for(var i=e[a],r=i.contentList,o=0,l=r.length;o<l;o++){var s=r[o]||{};if(!s.videoContentList||0===s.videoContentList.length){t=!1;break}}return t},couldSetReleaseTime:function(){var e=this.mode,t=this.pannel.currentVersion,a="create"===e||"copy"===e,n="edit"===e&&"V1"===t,i="10"===this.$consts.idPrefix;return i&&!(a||n)},isFillWithRanking:function(){var e=+this.activePannelIndex,t=this.pannel.pannelList;return!!t[e].rankIsOpen},canFillWithRanking:function(){var e=this.allowRankBusinessTypes,t=this.pannel,a=+this.activePannelIndex,n=t.pannelList,i=n[a],r=e.includes(t.panelGroupCategory),o=rt(i.contentList);return r&&o},fillTypeOptions:function(){var e=this.pannel.panelGroupCategory,t=this.$consts.panelFillTypeOptions,a=this.PANEL_FILL_TYPE,n=31,i=60,r=67;return e===n?t:[r,i].includes(e)?t.filter(function(e){return e.value!==a.mediaRule}):t.filter(function(e){return e.value!==a.mediaRule&&e.value!==a.ranking})},interveneContentList:function(){var e=this.pannel.pannelList[0]||{},t=e.interveneContentList||[];return t},pannelFillType:function(){var e=this.pannel.pannelList[0]||{},t=e.fillType||1;return t},isFillWithMediaRule:function(){return this.pannelFillType===this.$consts.panelFillTypes.mediaRule},initActiveResoruceSelector:function(){var e=this.pannel.panelGroupCategory;if(60===e||65===e)return"edu"},panelGroup:function(){return this.pannel},panelList:function(){return this.panelGroup.pannelList},firstPanel:function(){return this.panelList[0]},PANEL_FILL_TYPE:function(){return this.$consts.panelFillTypes}},watch:{isShowfocusImgUrl:function(e){!1===e&&(this.pannel.focusImgUrl="")},"pannel.focusShape":function(e){1===e&&(this.isShowfocusImgUrl=!1)},"pannel.parentType":function(e){"group"===e&&(this.pannel.showTitle=1)},"pannel.focusConfig":"handleFocusConfigChange","firstPanel.flagTagVector":function(e){0===e&&(this.firstPanel.panelTagVectorInfo={categoryCode:void 0,focusCategory:void 0,categoryName:void 0})}},methods:{handleUpdatePostEnd:function(){var e=this;this.$message.info("更换海报后，海报更新可能有延迟，3 秒后自动为你刷新推荐位内容"),setTimeout(function(){e.handleRefreshMediaRuleContents()},3e3)},handleSelectBlockRecStreamEnd:function(e){var t=e[0],a=t.recId,n=t.recName,i=t.recCategory,r=t.flag;this.firstPanel.recStreamPanelRls={recId:a,recName:n,recCategory:i,recFlag:r}},handleSelectBlockRecNew:function(e){var t=e[0],a=t.id,n=t.recName,i=t.recCategory,r=t.userToken;this.firstPanel.recStreamPanelRls={recId:a,recName:n,recCategory:i,recFlag:r}},genPannel:function(e){return Object(l["a"])({rankIsOpen:0,rankChildId:void 0,pannelTitle:"",panelIsFocus:0,contentList:[],interveneContentList:[],selectedResources:[],fillType:1,filmNum:void 0,mediaRuleDesc:void 0,rankName:void 0,recStreamPanelRls:void 0,tagPanelInfo:{rowNum:1,focusCategory:void 0,algorithmType:1},flagTagVector:0,panelTagVectorInfo:{categoryCode:void 0,focusCategory:void 0,categoryName:void 0}},e)},handleToggleFillWithRanking:function(e){var t=this.pannel.pannelList,a=+this.activePannelIndex,n=t[a];if(e){if(!rt(n.contentList))return this.$message({type:"error",duration:8e3,message:"采用排行榜，布局必须满足：标题布局、不带价格、只有一行、每个推荐位都是260*364、推荐位数量6~11个"});t[a].rankIsOpen=1,this.clearBlocks()}else t[a].rankIsOpen=0,this.clearBlocks()},toPercent:function(e){return Math.round(1e4*e)/100+"%"},toArrowPercent:function(e){var t=this.toPercent(Math.abs(e));return t+(e>0?" ↑":" ↓")},handleChartData:function(e){return{title:e.title,unit:e.unit,columns:["x","y"],rows:e.data}},handleChartSettings:function(e){return{labelMap:{y:e.title}}},handleChartExtend:function(e){var t={axisLabel:{formatter:"{value}%"}},a=Object.assign({},this.extend);return"%"===e.unit?Object.assign(a,{yAxis:t}):a},handleChartEvents:function(e,t){var a=this;return{click:function(n){var i=a.$createElement;if("xAxis"===n.componentType&&"edit"===t){var r=a.panelChartDataArr[e].data.findIndex(function(e){return e.x===n.value}),o=a.panelChartDataArr[e].data[r].extra;if(o&&0!==o.length){a.$sendEvent({type:"album_version_show"});var l=o.map(function(e){return i("p",null,e)});a.$msgbox({title:"推荐位标题变化",message:i("div",null,l),confirmButtonText:"确定"})}}}}},handleBatchAddTag:function(){this.showAddTagDialog=!0,this.$sendEvent({type:"panel_tag",payload:{panel_group_id:this.pannel.pannelGroupId||"new"}})},handleBatchAddTagEnd:function(){this.getSharedTags(),1===this.firstPanel.flagTagVector&&this.getVectorTag(),this.showAddTagDialog=!1},handleInputTagWeight:function(e,t,a){this.$sendEvent({type:"tag_weight",payload:{panel_group_id:this.pannel.pannelGroupId||"new",type:e<=t?"minus":"plus"}}),this.$service.panelTagUpsert({panelId:this.pannel.pannelGroupId,tagId:a.tagId,tagName:a.tagName,tagWeight:a.tagWeight}).catch(function(e){a.tagWeight=t})},getSharedTags:function(){var e=this,t=this.pannel.pannelGroupId,a=this.panelResourceIds,n=a&&0===a.length;!this.isShowTagsField||n?this.sharedTags=[]:this.$service.getSharedTags({coocaaVIds:a.join(","),panelId:t}).then(function(t){e.sharedTags=t.tags||[]})},handleFocusConfigChange:function(e){if(!this.isResetingData){if("week"===e){var t=this.pannel,a=t.pannelList,n=7-a.length;while(n-- >0)this.addPannel();var i=["周一","周二","周三","周四","周五","周六","周日"];t.pannelList=a.map(function(e,t){return e.pannelTitle=i[t],e.panelIsFocus=0,e}),this.updateAllPosition()}if("timeSlot"===e){var r=this.pannel,o=r.pannelList,l=4-o.length;while(l-- >0)this.addPannel();r.pannelList=o.map(function(e,t){return e.pannelTitle="时间段分组",e}),this.updateAllPosition()}}},fetchData:function(e){var t=this;return this.$service.panelGetDetail({id:this.id,version:e}).then(function(e){t.setPanelInfoData(e)})},getPanelIndexListUsingRanking:function(){var e=this.pannel.pannelList;return e.reduce(function(e,t,a){return t.rankIsOpen&&e.push(a),e},[])},handleSelectVersion:function(){var e=this.pannel;window.location.href=this.urls.copy_pannel+"?id="+e.pannelGroupId+"&version="+e.currentVersion},handleCopy:function(e){var t=this.pannel.pannelList[0].fillType,a=this.copyToPanelDataType,n=this.$consts.panelFillTypes,i=[n.mediaRule,n.recStream];if(3===a&&i.includes(t))return this.$message.error("影片筛选规则或推荐流填充的版块不能复制到业务专辑哦！");this.pannel.panelGroupType=this.copyToPanelDataType;var r=this.$consts.status;e===r.waiting?this.handleSubmitAudit():this.handleSaveDraft()},handleSelectLayoutStart:function(){var e=this,t=this.getPanelIndexListUsingRanking();t.length>0?this.$confirm("当前有版块使用排行榜填充，切换布局后这些版块内容将被清空，确定要换布局？","提示").then(function(){e.$refs.layoutSelector.$refs.wrapper.handleSelectStart()}).catch(function(){}):this.$refs.layoutSelector.$refs.wrapper.handleSelectStart()},handleSetLayoutForSubscribeType:function(){var e=this;this.$service.getLayoutInforById({id:101142}).then(function(t){t.layoutJsonParsed=JSON.parse(t.layoutJson8),e.handleSelectLayoutEnd(t,1)})},handleClearLayoutForSubscribeType:function(){this.selectedLayout=null,this.blockCount=void 0,this.pannel.pannelList.forEach(function(e){e.contentList=[]})},handleSelectLayoutEnd:function(e,t){var a=this,n=this.getPanelIndexListUsingRanking();n.forEach(function(e){a.clearBlocks(e)}),this.selectedLayout=e,this.updateBlockCount(e,t);var i=this.pannel.pannelList.length;while(--i>=0)this.updatePosition(i);this.getSharedTags(),this.pannel.focusImgUrl=""},updateBlockCount:function(e,t){t=t||e.layoutJsonParsed.contents.length,this.blockCount=t,this.blockCountList=this.blockCountList.map(function(e){return t}),void 0!==t&&this.pannel.pannelList.forEach(function(e){var a=e.selectedResources;a&&(e.selectedResources=a.slice(0,t))})},handleSelectAlienFocusEnd:function(e){this.pannel.focusImgUrl=e.pictureUrl},handleClickBlock:function(e){var t=this.pannel,a=this.pannelFillType,n=this.$consts.panelFillTypes;if(this.isFillWithRanking)return this.$message.error("使用排行榜填充的版块里的推荐位不能查看或编辑");if("subscribe"===t.parentType)return this.$message.error("预约版块里的推荐位不可以查看或编辑详情");if(a===n.mediaRule)return this.$message.error("影片筛选规则填充版块的推荐位不能查看或编辑");if(a===n.recStream)return this.$message.error("推荐流填充版块的推荐位不能查看或编辑");var i=this.selectedLayout,r=+this.activePannelIndex,o=this.pannel.pannelList[r].selectedResources||[];this.blockContentProps={layoutType:i.layoutJsonParsed.type,layoutIsTitle:i.layoutIsTitle,pannelParentType:t.parentType,pannelCategory:this.pannel.panelGroupCategory,block:o[e],blockInfo:this.blockList[r][e],pannelResource:this.pannel.pannelResource,rlsTabInfo:this.pannel.rlsTabInfo||[]},this.currentBlockIndex=e,this.activePage="block_content"},handleClickInterveneBlock:function(e){var t=this.pannel;this.currentInterveneBlockIndex=e;var a=this.pannel.pannelList[0].interveneContentList||[];if(!a[e].intervenePos)return this.$message("为了匹配海报尺寸，请先确定插入位置哦！");var n=a[e].intervenePos;this.blockConetentInterveneProps={layoutType:"Panel",pannelParentType:t.parentType,pannelCategory:this.pannel.panelGroupCategory,block:a[e],blockInfo:this.getBlockInfo(n-1),pannelResource:this.pannel.pannelResource},this.activePage="block_content__intervene"},getBlockInfo:function(e){return this.blockList[0][e]},handleSetInterveneBlockContentCancle:function(){this.activePage="panel_info"},handleSetInterveneBlockContentEnd:function(e){var t=this,a=this.pannel.pannelList[0],n=this.currentInterveneBlockIndex,i=a.interveneContentList[n];i.videoContentList=e.videoContentList,i.specificContentList=e.specificContentList,i.intervenePos&&this.updateInterveneResources(),this.$nextTick(function(){t.activePage="panel_info"})},handleSetBlockContentCancle:function(){this.activePage="panel_info",this.getSharedTags()},handleSetBlockContentEnd:function(e){var t=+this.activePannelIndex,a=this.pannel.pannelList[t],n=a.selectedResources||[],i=this.currentBlockIndex,r=n[i]||{};n[i]=r,Object.assign(r,e),e.specificContentList.length>0&&(a.pannelType=7),this.updatePosition(),this.getSharedTags(),this.activePage="panel_info",1===this.firstPanel.flagTagVector&&this.getVectorTag()},handleSelectSubscribeStart:function(){this.$refs.subscribeSelector.$refs.wrapper.handleSelectStart()},handleSelectRankingStart:function(){var e=this,t=this.pannel,a=+this.activePannelIndex,n=t.pannelList[a],i=0===n.selectedResources.length;n.rankIsOpen||i?this.$refs.rankingSelector.$refs.wrapper.handleSelectStart():this.$confirm("使用排行榜填充之后，原来推荐位内容将被全部清除, 是否继续操作?","提示").then(function(){e.$refs.rankingSelector.$refs.wrapper.handleSelectStart()}).catch(function(){})},handleSelectRankingEnd:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal",n=this.pannel,i=+this.activePannelIndex,r=n.pannelList[i],o="rank"!==a?this.blockCountList[i]:this.pannel.pannelList[0].filmNum+1;"rank"===a&&(this.$service.getLayoutInforById({id:109}).then(function(e){e.layoutJsonParsed=JSON.parse(e.layoutJson8),t.handleSelectLayoutEnd(e,o)}),n.pannelList[0].rankName=e.ranking[0].title);var l=e.ranking[0],s=this.pannel.panelGroupCategory,c=this.$consts.sourceToPartner[n.pannelResource],u={code:l.code,businessType:s,partner:c};this.$service.mediaGetRankingInfoVideoList(u).then(function(a){r.rankIsOpen=1,r.rankChildId=l.id,r.selectedResources=[];var n=a.rankingVideoInfoEntities||[];return e.rankingCode=l.code,e.ranking=n.slice(0,o-1),t.insertResources({selectedResources:e,isFillWithRanking:!0})})},handleSelectResourceStart:function(){var e=this,t=this.pannel,a=+this.activePannelIndex,n=t.pannelList[a];n.rankIsOpen?this.$confirm("当前版块推荐位已使用排行榜填充，若选择其他资源填充，原来排行榜的内容将全部清除, 是否继续操作?","提示").then(function(){e.$refs.resourceSelector.$refs.wrapper.handleSelectStart()}).catch(function(){}):this.$refs.resourceSelector.$refs.wrapper.handleSelectStart()},handleSelectSubscribeEnd:function(e){var t=this.pannel,a=+this.activePannelIndex,n=t.pannelList[a];return this.insertResources({selectedResources:e,insertAfter:n.selectedResources.length+1})},handleSelectResourceEnd:function(e){var t=this,a=this.$refs.resourceSelector,n=this.pannel,i=+this.activePannelIndex,r=n.pannelList[i],o=0;r.contentList.forEach(function(e){var t=e.videoContentList;t&&t.length>0&&o++}),this.$prompt("请确认从第几个内容框开始填充","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"当前已填充 "+o+" 个， 默认为从第1位开始填充",inputValidator:function(e){if(null!==e&&!RegExp(/^[0-9]*[1-9][0-9]*$/).test(e))return"请正确填写位置"}}).then(function(n){return t.clearRank(r),a.clearSelected(),t.insertResources({insertAfter:n.value||1,selectedResources:e})}).catch(function(e){console.log(e),a.$refs.wrapper.handleSelectStart()})},clearRank:function(e){e.rankIsOpen&&(e.rankIsOpen=0,e.rankChildId=void 0,e.selectedResources=[])},insertResources:function(e){var t=e.insertAfter,a=void 0===t?1:t,n=e.selectedResources,i=e.isFillWithRanking,r=this.pannel,o=r.parentType,l="subscribe"===o?"subscribe":i?"ranking":"normal";3===r.pannelList[0].fillType&&(l="mediaRule");for(var s=3===r.pannelList[0].fillType,c={subscribe:it,ranking:nt,normal:Qe,mediaRule:Ze},u=+this.activePannelIndex,d=r.pannelList[u],p=c[l],h=p(n,{bgParams:void 0,cornerList:void 0,redundantParams:void 0,shouldFindFitestPicture:!0,isMediaRule:s}).map(function(e){return{contentPosition:null,blockMallPosition:null,focusImgUrl:"",lucenyFlag:0,resize:null,titleInfo:null,videoContentList:[e],specificContentList:[]}}),m=Math.max(a-1+h.length,d.selectedResources.length),f=Array.apply(null,{length:m}),v=0,g=a-1,b=g+h.length-1,y=m;v<y;v++)if(v>=g&&v<=b){f[v]=h[v-g];var w=f[v].videoContentList,I=d.selectedResources[v]||{},C=I.videoContentList;C&&C.length>1&&(f[v].videoContentList=w.concat(C.slice(1)))}else f[v]=d.selectedResources[v];if(d.selectedResources=f,"subscribe"===l){var T=function(e){return(e.videoContentList[0]||{}).subscribeOnlineTime||"Z"},S=function(e){return(e.videoContentList[0]||{}).extraValue1};d.selectedResources=Object(Na["sortBy"])(Object(Na["uniqBy"])(Object(Na["reverse"])(d.selectedResources),S),T)}this.updatePosition(),this.getSharedTags(),1===this.firstPanel.flagTagVector&&this.getVectorTag()},handleRemoveTab:function(e){this.$confirm("确认删除该子版块?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=this.pannel.pannelList;if(1===t.length)return this.$message({type:"error",message:"至少包含一个分组"});var a=+e;if(t.splice(a,1),this.activePannelIndex>=e){var n=a-1;this.activePannelIndex=-1===n?"0":n.toString()}}.bind(this)).catch(function(e){console.log(e)})},handleAddTab:function(){var e=this.validateBlocks();if(e.emptyBlock)return this.$message({type:"error",message:"请先把空推荐位填充完毕"});this.activePanelGroup={index:this.pannel.pannelList.length,title:"",startTime:void 0,endTime:void 0,panelIsFocus:0}},addPannel:function(){var e=this.pannel.pannelList,t=this.genPannel(),a=e.length;this.activePannelIndex=a.toString(),this.blockCountList.push(this.blockCount),e.push(t)},handleSetDefaultActiveTab:function(){var e=+this.activePannelIndex;this.pannel.pannelList.forEach(function(t,a){t.panelIsFocus=e===a?1:0})},handlePanelGroupCategoryChange:function(e){var t=this;this.$confirm("切换业务类型将清空推荐位内容, 确定切换?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=t.pannel;a.panelGroupCategory=e,t.hasSource?a.pannelResource="o_tencent":a.pannelResource="",t.handleInputFillType(t.$consts.panelFillTypes.manual),t.clearBlocks()}).catch(function(){})},handlePannelResourceChange:function(e){this.$confirm("切换内容源将清空推荐位内容, 确定切换?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){this.pannel.pannelResource=e,this.clearBlocks(),this.clearMediaInfo()}.bind(this)).catch(function(){})},clearMediaInfo:function(){var e=this.pannel.pannelList[0],t=e.fillType;1!==t&&this.handleInputFillType(t)},handleInputParentType:function(e){var t=this;this.$confirm("切换版块类型将清空推荐位内容, 确定切换?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=t.pannel,n=a.parentType,i=a.pannelList[0];switch(i.pannelTitle="",a.pannelList=[i],t.activePannelIndex=0,t.clearBlocks(),t.pannel.parentType=e,a.pannelList[0].fillType=1,i.flagTagVector=0,!0){case"normal"===e:a.focusConfig="","subscribe"===n&&t.handleClearLayoutForSubscribeType();break;case"group"===e:"subscribe"===n&&t.handleClearLayoutForSubscribeType();break;case"subscribe"===e:a.focusConfig="",a.lucenyFlag=0,a.focusShape=0,t.isShowfocusImgUrl=!1,t.handleSetLayoutForSubscribeType();break;case"tag"===e:t.$set(i,"tagPanelInfo",{}),t.$nextTick(function(){i.tagPanelInfo={rowNum:1,focusCategory:void 0,algorithmType:1}}),t.handleClearLayoutForSubscribeType();break}}).catch(function(e){console.log(e)})},handleSetPanelGroupInfoStart:function(e){var t=this.pannel.pannelList[e];this.activePanelGroup={index:e,title:t.pannelTitle,rankIsOpen:t.rankIsOpen,startTime:t.startTime,endTime:t.endTime,panelIsFocus:t.panelIsFocus}},handleSetPanelGroupInfoCancel:function(){this.activePanelGroup=void 0},handleSetPanelGroupInfoEnd:function(){var e=this.activePanelGroup,t=e.index,a=this.pannel.pannelList,n=a[t];n||(this.addPannel(),n=a[t]),n.pannelTitle=e.title,e.panelIsFocus?this.setPanelDefaultFocus(t):n.panelIsFocus=e.panelIsFocus;var i=n.rankIsOpen,r=e.rankIsOpen;r!==i&&(n.selectedResources=[]),n.rankIsOpen=r,n.startTime=e.startTime,n.endTime=e.endTime,this.activePanelGroup=void 0,this.updateAllPosition()},setPanelDefaultFocus:function(e){var t=this.pannel.pannelList,a=t[e];t.forEach(function(e){e.panelIsFocus=0}),a.panelIsFocus=1},handleClearCurrentBlocks:function(){var e=this;this.$confirm("确定清空当前版块推荐位？","提示").then(function(){var t=+e.activePannelIndex;e.clearBlocks(t),e.updatePosition(t)}).catch(function(){})},clearBlocks:function(e){var t=this.pannel,a=t.pannelList,n=function(e){var t=a[e];t.rankIsOpen=0,t.rankChildId=void 0,t.selectedResources=[]};void 0!==e?n(e):a.forEach(function(e,t){n(t)}),this.updateAllPosition()},updateAllPosition:function(){var e=this.pannel.pannelList.length;while(--e>=0)this.updatePosition(e)},updatePosition:function(e){var t=this.selectedLayout;if(t){var a=this.pannel,n=this.blockList,i=void 0===e?+this.activePannelIndex:e,r=a.pannelList[i],o=this.getBlocksAndResources(i),l=o.blocks,s=o.selectedBlocksAndResources;n[i]=l,r.contentList=s;var c="Mall"!==this.selectedLayout.layoutJsonParsed.contents[0].type,u=n[i];r.contentList.forEach(function(e,t){var a=u[t];[].concat(e.videoContentList||[],e.specificContentList||[]).forEach(function(e){(a.title_info||a.width<410)&&1===e.flagTagVector&&(e.flagTagVector=0),c&&(e.price=void 0,e.secKillPrice=void 0)})})}},getBlocksAndResources:function(e,t){var a=this.pannel,n=this.blockCountList,i=this.selectedLayout,r="v6"===t?i.layoutJson:i.layoutJson8,o=JSON.parse(r),l=o.type,s=o.contents,c=s.length,u=a.pannelList[e],d=u.selectedResources||[],p=n[e],h=s[c-1],m=h.x+h.width,f=h.resize||{},v=h.y+(f.height||h.height),g=function(){if("Expander"===l&&2===c){var e=o.extra.space;return function(t){var a=s[1],n=a.resize,i=a.title_info,r=a.mall_resize,o=m+(t-2)*e+(t-3)*a.width,l=a.y,c={height:a.height,width:a.width,x:o,y:l,isExtra:!0,title_info:i,mall_resize:r,loop:a.loop,type:a.type};return i&&n&&(c.resize={height:n.height,width:n.width,x:o,y:l}),c}}if("Expander"===l){var t=o.extra.space;return function(e){var a=Math.floor(e/c)-1,n=e%c,i=s[n],r=i.resize,o=i.title_info,l=i.mall_resize,u=i.x+a*m+a*t,d=i.y,p={height:i.height,width:i.width,x:u,y:d,isExtra:!0,title_info:o,mall_resize:l,loop:i.loop,type:i.type};return o&&r&&(p.resize={height:r.height,width:r.width,x:u,y:d}),p}}if("Lengthwise"===l){var a=40;return function(e){var t=Math.ceil(e/c)-1,n=e-c*t-1,i=s[n],r=i.resize,o=i.title_info,l=i.mall_resize,u=i.x,d=i.y+v*t+a*t,p={height:i.height,width:i.width,parents:i.parents,type:i.type,title_align:i.title_align,x:u,y:d,isExtra:!0,title_info:o,mall_resize:l};return o&&r&&(p.resize={height:r.height,width:r.width,x:u,y:d}),p}}};if("Expander"===l||"Lengthwise"===l){var b=g(),y="group"===a.parentType&&"Lengthwise"===l?p:Math.max(p,d.length);n[e]=y;var w=s.length;while(w++<y)s.push(b(w))}var I={},C=s.map(function(e,t){var a=d[t]||{},n=!!a.intervenePos,i=a.videoContentList||[],r=a.specificContentList||[];i.forEach(function(e,i){var r=e.coverType,o="media"===r||"block"===r||"mall"===r;if(o){var l=qe(r,e);if(l){l=l+(e.extraValue4||"")+(e.extraValue5||"");var s=I[l];s?(s.resource.duplicated={index:s.index,contentIndex:s.contentIndex,duplicatedIndex:t,duplicatedContentIndex:i},a.duplicated={index:t,contentIndex:i,duplicatedIndex:s.index,duplicatedContentIndex:s.contentIndex}):(a.duplicated=!1,I[l]={resource:a,index:t,contentIndex:i})}}else a.duplicated=!1;a.isInterveneBlock=n}),[].concat(i,r).forEach(function(t){e.title_info?(t.showTitle=1,t.forceTitle=!0):t.forceTitle=!1,void 0===t.showTitle&&(t.showTitle=0),void 0===t.showSubTitle&&(t.showSubTitle=0)});var o=i[0]||{},l=o.picturePreset;if(o.shouldFindFitestPicture&&l){var s=[e.width,e.height];o.pictureUrl=Oe(s,l),o.shouldFindFitestPicture=void 0}return a.videoContentList=i,a.contentPosition=Object.assign({},e,{resize:void 0}),a.titleInfo=e.title_info,a.mallResize=e.mall_resize,a.resize=e.resize,a.isExtra=e.isExtra,a});return{blocks:s,selectedBlocksAndResources:C}},handleDragBlock:function(e,t){if(this.isFillWithRanking)return this.$message.error("排行榜填充的推荐位不支持自定义位置");var a=this.pannel.pannelList[+this.activePannelIndex],n=a.selectedResources,i=n[e],r=n[t];n[t]=i,n[e]=r,this.updatePosition()},handleRemoveBlock:function(e){var t=+this.activePannelIndex,a=this.pannel.pannelList[t];if(a.rankIsOpen)return this.$message.error("使用排行榜填充的版块里的推荐位不能删除");this.blockCountList[t]--;var n=a.selectedResources;n.splice(e,1),this.updatePosition(),this.getSharedTags()},getFormData:function(){var e=JSON.parse(JSON.stringify(this.pannel)),t=this.mode;return"replicate"===t&&(e.currentVersion=""),"copy"===t&&(e.pannelGroupId=void 0,e.currentVersion=""),e},makeCompatibleV6:function(e){var t=e.pannelList,a=t.length;while(--a>=0){var n=this.getBlocksAndResources(a,"v6"),i=n.selectedBlocksAndResources;t[a].contentList=i}},parseDataToApi:function(e){var t=this,a=this.currentPanelDataType,n=this.selectedLayout,i=JSON.parse(JSON.stringify(e));i.panelGroupType=3!==i.pannelList[0].fillType?a:10;var r="tag"===i.parentType,l="normal"===i.parentType,s=i.flagThirdSourceCorner,c=this;if(i.pannelList=i.pannelList.map(function(e){var u,d,p=!1,h=e.contentList.map(function(e){var t=e.titleInfo,a=e.resize,r=e.mallResize,l=Object.assign({},e.contentPosition);l.resize=void 0,l.mall_resize=void 0,l.title_info=void 0,l.isExtra=void 0,"Expander"===n.layoutJsonParsed.type&&(l.x=0,l.y=0,t&&(t.x=0,t.y=0),a&&(a.x=0,a.y=0));var u=Object.assign({},e,{contentPosition:JSON.stringify(l),titleInfo:t?JSON.stringify(t):"",resize:a?JSON.stringify(a):"",blockMallPosition:r?JSON.stringify(r):""});return u.focusImgUrl=i.focusImgUrl,u.lucenyFlag=i.lucenyFlag,u.specificContentList&&u.specificContentList.length>0&&(p=!0),[].concat(u.videoContentList||[],u.specificContentList||[]).forEach(function(e){if(1===s&&"media"===e.coverType){var t=c.thirdSourceOptions,a=c.thirdSourcePrefixMap,n=e.extraValue1.split("_");if(n&&n[2]){var i=a[n[2]],r=t.find(function(e){return e.sourceCode===i});"object"===Object(o["a"])(r)&&(e.cornerList=(e.cornerList||[]).filter(function(e){return 0!==e.position}),e.cornerList.push({position:0,cornerIconId:r.pictureId,imgUrl:r.pictureUrl}))}}e.forceTitle=void 0,e.picturePreset=void 0,e.isMediaRule=void 0;var l=e.appParams;if(l&&"string"!==typeof l){var u=l.reduce(function(e,t){return e[t.key]=t.value,e},{});e.appParams=JSON.stringify(u)}var d=e.maskLifeInfo;d&&(d.videoInfo=void 0)}),delete u.mallResize,delete u.isExtra,delete u.duplicated,delete u.isInterveneBlock,u});if("timeSlot"===i.focusConfig){var m=e.startTime,f=e.endTime;m&&f&&(u=m+","+f)}var v=e.fillType;11!==i.pannelType&&(d=p?7:a,d=2===v?2:3===v?10:4===v?13:d);var g={pannelStatus:i.pannelStatus,pannelId:e.pannelId,pannelCategory:i.panelGroupCategory,pannelName:i.pannelName,pannelTitle:e.pannelTitle,pannelResource:i.pannelResource,pannelType:d,showTitle:i.showTitle,flagIs4k:i.flagIs4k,layoutId:r?void 0:n.layoutId,panelIsFocus:e.panelIsFocus,timeSlot:u,focusShape:i.focusShape,contentList:h,rankIsOpen:e.rankIsOpen,rankChildId:e.rankChildId,fillType:e.fillType,tagPanelInfo:r?e.tagPanelInfo:void 0,flagTagVector:l?e.flagTagVector:void 0,panelTagVectorInfo:1===e.flagTagVector?e.panelTagVectorInfo:void 0,filmNum:2===v?h.length-1:void 0,rankName:2===v?e.rankName:void 0,mediaRule:3===v?e.mediaRule:void 0,mediaRuleDesc:3===v?e.mediaRuleDesc:void 0,hasEdu:3===v?e.hasEdu:void 0,mediaFilmNum:3===v?e.mediaFilmNum:void 0,partner:3===v?t.$consts.sourceToPartner[i.pannelResource]:void 0,recStreamPanelRls:e.recStreamPanelRls},b=3===v||4===v;if(b){var y=JSON.parse(JSON.stringify(h)),w=(e.interveneContentList||[]).map(function(e){var t=e.intervenePos,a=y[t-1];return a.intervenePos=parseInt(t),a.videoContent=a.videoContentList[0],delete a.videoContentList,delete a.specificContentList,a}),I=w.length>0?1:0;Object.assign(g,{hasIntervene:I,interveneContentList:w})}return g}),delete i.pannelName,delete i.pannelResource,delete i.showTitle,delete i.flagIs4k,delete i.lucenyFlag,delete i.focusShape,delete i.focusImgUrl,"timeSlot"===i.focusConfig){var u=i.pannelList.findIndex(function(e){return 1===e.panelIsFocus});-1===u&&(i.pannelList[0].panelIsFocus=1)}return i},validate:function(e,t){var a=this,n=function(e){e?a.$message({type:"error",message:e.message||e}):t()},i=this.$consts.status,r=e.pannelStatus,o=e.parentType;if(!e.pannelName)return n(Error("请输入版块名称"));if(e.pannelName.length>45)return n(Error("版块名称长度不能大于 45 个字符"));if("group"!==o&&!e.pannelList[0].pannelTitle)return n(Error("请输入版块标题"));if("group"!==o&&e.pannelList[0].pannelTitle.length>45)return n(Error("版块标题长度不能大于 45 个字符"));if("group"===o&&!e.groupTitle)return n(Error("请输入版块标题"));if("group"===o&&e.groupTitle.length>45)return n(Error("版块标题长度不能大于 45 个字符"));var l,s,c=e.pannelList[0],u=c.fillType,d=this.$consts.panelFillTypes;if(2===u&&(!c.filmNum||!this.selectedLayout))return n(Error("请填写影片数量，并填充排行榜"));if(u===d.mediaRule&&!c.mediaRule)return n(Error("请配置筛选规则"));if(u===d.recStream&&!c.recStreamPanelRls)return n(Error("请选择推荐流"));if(!this.selectedLayout&&"tag"!==o)return n(Error("请选择布局"));if(this.isShowfocusImgUrl&&!e.focusImgUrl)return n(Error("请设置异形焦点"));if("subscribe"===o){var p=e.pannelList[0].contentList[0].videoContentList[0];if(!p)return n(Error("请至少选择一部预约影片"))}if(3===u||4===u){var h=this.validateInterveneContentList(),m=h.emptyInterveneContentIndex,f=h.emptyIntervenePosIndex,v=h.duplicatedContentIndex;if(void 0!==f)return n(Error("第 ".concat(f+1," 个插入位置位置信息为空")));if(void 0!==m)return n(Error("第 ".concat(m+1," 个插入位置内容为空")));if(v)return n(Error("第 ".concat(v[0]+1," 个插入位置与第 ").concat(v[1]+1," 个插入位置内容重复")))}if(r===i.accepted||r===i.waiting){var g=this.validateBlocks(),b=g.emptyPannelTitleIndex,y=g.duplicatedPannelTitleIndex,w=g.emptyTimeSlotIndex,I=g.emptyPostIndex,C=g.emptyPostBlockIndex,T=g.emptyPriceIndex,S=g.emptyPriceBlockIndex,k=g.emptyTitleIndex,_=g.emptyTitleBlockIndex,P=g.emptyBlock,x=g.duplicatedIndex,F=g.duplicatedInfo,D=g.focusIndex,R="group"===e.parentType;if(this.hasSource&&!e.pannelResource)return n(Error("请选择内容源"));if(void 0!==b)return n(Error("请填写第"+(b+1)+"分组的标题"));if(void 0!==y)return n(Error("第"+(y+1)+"分组的标题与别的分组重复"));if(void 0!==w)return n(Error("请设置第"+(w+1)+"分组的落焦时间"));if(void 0!==T&&void 0!==S)return"group"===e.parentType?n(Error("请设置第 "+(T+1)+" 个分组第 "+(S+1)+" 个推荐位的价格")):n(Error("请设置第 "+(S+1)+" 个推荐位的价格"));if(void 0!==k&&void 0!==_)return"group"===e.parentType?n(Error("请设置第 "+(k+1)+" 个分组第 "+(_+1)+" 个推荐位的标题")):n(Error("请设置第 "+(_+1)+" 个推荐位的标题"));if(void 0!==I&&void 0!==C)return"group"===e.parentType?n(Error("请设置第 "+(I+1)+" 个分组第 "+(C+1)+" 个推荐位的内容海报")):n(Error("请设置第 "+(C+1)+" 个推荐位的内容海报"));if(F){var L=R?"第 ".concat(x+1," 个分组"):"";return n(Error("".concat(L,"第 ").concat(F.index+1," 推荐位\n            第 ").concat(F.contentIndex+1," \n            个内容与第 ").concat(F.duplicatedIndex+1," 个推荐位第 \n            ").concat(F.duplicatedContentIndex+1," 个内容重复")))}if(P)return n(Error("含有空推荐位"));if(""===e.focusConfig&&void 0===D&&"group"===e.parentType)return n(Error("请选择默认落焦"))}var $=e.pannelList.some(function(e,t){var a=0;return e.contentList.forEach(function(e){"REFERENCE_PLAY_VIDEO"===(e.videoContentList[0]||{}).pluginType&&a++}),a>1&&(l=t,s=a),a>1});if($)return"group"===e.parentType?n(Error("第"+(l+1)+"个分组含有"+s+"个视频播放推荐位，一个版块只能有一个视频播放推荐位")):n(Error("版块含有"+s+"个视频播放推荐位，一个版块只能有一个视频播放推荐位"));n()},validateInterveneContentList:function(){for(var e,t,a,n=this.pannel.pannelList[0].interveneContentList,i={},r=function(r){var o=n[r],l=o.intervenePos,s=o.videoContentList||[];return l?0===s.length?(t=r,"break"):void s.forEach(function(e,t){var n=e.coverType,o="media"===n||"block"===n||"mall"===n;if(o){var l=qe(n,e);if(l){l=l+(e.extraValue4||"")+(e.extraValue5||"");var s=i[l];s?a=[r,s.interveneIndex]:i[l]={interveneIndex:r}}}}):(e=r,"break")},o=0;o<n.length;o++){var l=r(o);if("break"===l)break}return{emptyIntervenePosIndex:e,emptyInterveneContentIndex:t,duplicatedContentIndex:a}},validateBlocks:function(){var e,t,a,n,i,r,o,l,s,c,u,d,p,h=this.pannel.pannelList,m=this.pannelFillType,f=this.PANEL_FILL_TYPE,v=this.pannel.focusConfig,g={};e:for(var b=0,y=h.length;b<y;b++){var w=h[b];if(!w.pannelTitle){e=b;break e}var I=w.pannelTitle.trim();if(g[I]){t=b;break e}if(g[I]=!0,"timeSlot"===v&&(!w.startTime||!w.endTime)&&!w.panelIsFocus){a=b;break e}w.panelIsFocus&&(p=b);var C=w.contentList;if(m!==f.recStream)for(var T=0,S=C.length;T<S;T++){var k=C[T]||{};if(!k.videoContentList||0===k.videoContentList.length){c=k;break e}if(k.duplicated){u=b,d=k.duplicated;break e}var _=k.videoContentList[0].price;if("Mall"===k.contentPosition.type&&(void 0===_||-1===_||""===_)){n=b,i=T;break e}var P=k.videoContentList[0].title||"",x=k.videoContentList[0].forceTitle||!1;x&&""===P.trim()&&(l=b,s=T);var F=k.videoContentList[0].pictureUrl;F||(r=b,o=T)}}return{emptyPannelTitleIndex:e,duplicatedPannelTitleIndex:t,emptyTimeSlotIndex:a,emptyPostIndex:r,emptyPostBlockIndex:o,emptyPriceIndex:n,emptyPriceBlockIndex:i,emptyTitleIndex:l,emptyTitleBlockIndex:s,emptyBlock:c,duplicatedIndex:u,duplicatedInfo:d,focusIndex:p}},handleSaveDraft:function(){var e=this,t=this.getFormData();t.isTiming=void 0,t.releaseTime=void 0,t.pannelStatus=this.$consts.status.draft,console.log(t,"------da"),this.validate(t,function(){e.upsertPanelInfo(t)})},handleSubmitAudit:function(e){var t=this,a=this.getFormData();a.pannelStatus=this.$consts.status.waiting,this.validate(a,function(){t.couldSetReleaseTime?e?(a.isTiming=e.isTiming,a.releaseTime=e.releaseTime,t.upsertPanelInfo(a)):t.$refs.commonContent.showReleaseTimeSetter=!0:t.upsertPanelInfo(a)})},upsertPanelInfo:function(e){var t=this,a="tag"===e.parentType;!a&&this.makeCompatibleV6(e),this.$service.panelUpsert(this.parseDataToApi(e),"保存成功").then(function(e){t.$emit("upsert-end")})},resetingData:function(e){var t=this;this.isResetingData=!0,e(),this.$nextTick(function(){t.isResetingData=!1})},setPanelInfoData:function(e){var t=this;this.resetingData(function(){var a=e,n=t.pannel,i=a.pannelList||[],r=i[0],o=t.$consts.panelFillTypes;Object.assign(n,e),n.pannelName=e.pannelGroupRemark,n.flagThirdSourceCorner=e.flagThirdSourceCorner||0;var l=function(e){-1===+e.price&&(e.price=""),-1===+e.secKillPrice&&(e.secKillPrice="");var t=e.appParams;if(t){var a=JSON.parse(t);e.appParams=Object.keys(a).map(function(e){return{key:e,value:a[e]}})}else e.appParams=[]};if(r){r.contentList=r.contentList||[],t.blockCountList=i.map(function(e){return e.contentList.length}),t.blockCount=t.blockCountList[0]||1,n.pannelList=i.map(function(e){if(e.contentList=e.contentList.map(function(e){return e.contentPosition=JSON.parse(e.contentPosition),[].concat(e.videoContentList||[],e.specificContentList||[]).forEach(l),e}),e.interveneContentList=(e.interveneContentList||[]).map(function(e){var t=[].concat(e.videoContent);return t.forEach(l),{intervenePos:e.intervenePos,videoContentList:t}}),e.timeSlot){var t=e.timeSlot.split(",");e.startTime=new Date(t[0]),e.endTime=new Date(t[1])}return e.rankIsOpen=e.rankIsOpen||0,e.selectedResources=e.contentList,e.tagPanelInfo=e.tagPanelInfo||{},e.flagTagVector=e.flagTagVector||0,e.panelTagVectorInfo=e.panelTagVectorInfo||{categoryCode:void 0,focusCategory:void 0,categoryName:void 0},e.rlsTabInfo=e.rlsTabInfo||[],e}),n.pannelResource=r.pannelResource,n.flagIs4k=r.flagIs4k,n.showTitle=r.showTitle,n.focusShape=r.focusShape,n.pannelStatus=r.pannelStatus;var s=r.layoutInfo;void 0!==s&&(s.layoutJsonParsed=JSON.parse(s.layoutJson8),t.selectedLayout=s,t.selectedLayoutId=s.layoutId);var c=r.contentList[0];c&&(n.lucenyFlag=c.lucenyFlag,n.focusImgUrl=c.focusImgUrl,t.isShowfocusImgUrl=c.focusImgUrl);var u=r.fillType;u===o.mediaRule&&(t.reviewPicUrl=(t.mediaRuleLayoutOptions.find(function(e){return e.dictEnName===r.layoutId})||{}).dictUrl),u===o.recStream&&(0===r.contentList.length&&(t.updateBlockCount(s,Wa),t.updatePosition(0)),t.updateInterveneResources())}t.pannel=Object(Na["cloneDeep"])(n),t.updateAllPosition(),t.getSharedTags()})},clickBlock:function(){var e=this.initGroupIndex,t=this.initBlockIndex;void 0!==e&&(this.activePannelIndex=e),void 0!==t&&this.handleClickBlock(t)},getSimpleBrowseData:function(){var e=this;this.$service.getPanelSimpleBrowseData({id:this.id}).then(function(t){var a=t.rows[0].data[0]?t.rows[0].data[0].uvctr:"N/A";e.panelUVCTR=a,e.panelUVCTRPercent.dailyGrowth=a.dailyGrowth?e.toArrowPercent(a.dailyGrowth):"N/A",e.panelUVCTRPercent.weeklyGrowth=a.weeklyGrowth?e.toArrowPercent(a.weeklyGrowth):"N/A"})},handlePanelDataClick:function(){var e=this;this.isCollapseData=!this.isCollapseData,0===this.panelChartDataArr.length&&this.$service.getPanelChartData({id:this.id}).then(function(t){e.panelChartDataArr=t.rows})},handleAnalyzeData:function(e,t,a){var n=t.index;this.analyzeIsRealTime=t.isRealTime||!1,this.analyzeBtnCurrentIndex=void 0;var i=this.pannel;"group"===i.parentType?this.analyzeBtnCurrentIndex=a+"-"+n:this.analyzeBtnCurrentIndex=n,"dmp"===e?(this.isVisiAnalyzeDmpData=!0,this.$sendEvent({type:"block_data_show",payload:{type:"dmp"}})):(this.isVisiAnalyzeSimpleData=!0,this.$sendEvent({type:"block_data_show",payload:{type:"position"}}))},handleInputFillType:function(e){this.selectedLayoutId=void 0,this.selectedLayout=null;var t=this.pannel,a=this.$consts.panelFillTypes,n=this.genPannel({pannelTitle:t.pannelList[0].pannelTitle,fillType:e,panelGroupType:e===a.mediaRule?10:1,filmNum:e===a.ranking?6:void 0});t.pannelList=[n],e===a.mediaRule&&this.handleInputLayoutId(qa),e===a.recStream&&this.handleInputLayoutId(Ja)},handleInputFilmNum:function(e){var t=this.pannel.pannelList[0]||{};if(t.filmNum=e,t.rankChildId){var a={ranking:[{code:t.rankChildId,id:t.rankChildId}]};this.handleSelectRankingEnd(a,"rank")}},handleShowLayout:function(e){this.reviewPicUrl=e,this.picDialogVisible=!0},handleGetFilterResult:function(e){var t=e.mediaRule,a=e.hasEdu,n=e.mediaRuleDesc,i=this.pannel.pannelList[0];i.mediaRule=JSON.stringify(t),i.hasEdu=a,i.mediaRuleDesc=n,this.updateInterveneResources()},showMediaRuleDesc:function(e){var t=this.$createElement;this.$msgbox({title:"筛选规则",message:t("p",{style:"white-space: pre-line"},e),confirmButtonText:"确定",dangerouslyUseHTMLString:!0}).catch(function(){})},handleInputLayoutId:function(e){var t=this,a=this.pannel.pannelList[0];a.interveneContentList=[],this.selectedLayoutId=e,this.$service.getLayoutInforById({id:e}).then(function(e){e.layoutJsonParsed=JSON.parse(e.layoutJson8),t.selectedLayout=e,t.handleSelectLayoutEnd(e,Wa),a.mediaRule&&t.updateInterveneResources()})},handleAddIntervene:function(){var e=this.pannel.pannelList[0],t=this.pannelFillType,a=this.$consts.panelFillTypes;if(t===a.mediaRule&&!e.mediaRuleDesc)return this.$message.error("请先配置影片筛选规则");e.interveneContentList.push(this.genDefaultInterveneContent()),this.scollBottom()},scollBottom:function(){var e=this;this.$nextTick(function(){var t=e.$el.querySelector(".page-content-wrapper");t.scrollTop=t.scrollHeight})},genDefaultInterveneContent:function(){return{videoContentList:[],specificContentList:[],intervenePos:""}},handleRemoveIntervene:function(e){this.pannel.pannelList[0].interveneContentList.splice(e,1),this.updateInterveneResources()},handleEndIntervenePos:function(e){var t=this.pannel.pannelList[0],a=t.interveneContentList[e],n=a.intervenePos,i=(t.interveneContentList||[]).some(function(t,a){return a!==e&&t.intervenePos==n});if(""!==n&&i)return a.intervenePos="",this.$message.error("插入位置重复!");0!==a.videoContentList.length&&this.updateInterveneResources(!0)},handleRefreshMediaRuleContents:function(){var e=this.pannel,t=e.pannelList[0],a=this.pannelFillType,n=this.$consts.panelFillTypes;a===n.mediaRule&&t.mediaRuleDesc&&this.updateInterveneResources()},updateInterveneResources:function(e){var t=this,a=this.pannel,n=a.pannelList[0],i=this.pannelFillType,r=this.$consts.panelFillTypes,o=this.MAX_MEDIA_RULE_VIDEO_COUNT,l=function(){n.interveneContentList.sort(function(e,t){return e.intervenePos-t.intervenePos});var e=n.interveneContentList||[];e.forEach(function(e){if(e.intervenePos&&0!==e.videoContentList.length){var t=e.intervenePos-1,a={intervenePos:e.intervenePos,videoContentList:e.videoContentList,specificContentList:e.specificContentList};n.selectedResources.splice(t,0,a)}n.selectedResources=(n.selectedResources||[]).slice(0,o)}),t.updatePosition()};if(this.clearBlocks(),i===r.recStream){var s=n.interveneContentList.reduce(function(e,t){return Math.max(t.intervenePos,e)},-1),c=Math.max(s,n.selectedResources.length),u=Array.apply(null,{length:c});n.selectedResources=u,l()}if(i===r.mediaRule&&n.mediaRuleDesc){var d=JSON.parse(n.mediaRule),p=this.$consts.sourceToPartner[a.pannelResource];this.$service.getFilmFilterResult(d).then(function(a){if((a.data.rows||[]).forEach(function(e){e._partner=p}),t.filteredFilm=a.data,n.mediaFilmNum=a.data?a.data.total:0,n.mediaFilmNum<12)return t.$message.error("筛选影片数量不足12， 请重新配置筛选规则");t.updateBlockCount(t.selectedLayout,1),t.insertResources({selectedResources:t.filteredFilm.rows}),l(),t.updateMediaRuleBlockPosts(e)})}},updateMediaRuleBlockPosts:function(e){var t=0,a=this.getBlocksAndResources(t),n=a.blocks,i=a.selectedBlocksAndResources,r=this.pannel.pannelList[t];n.forEach(function(t,a){var n=i[a]||{},r=n.videoContentList[0]||{},o=r.picturePreset||[];if(o.length>0){var l=r.isMediaRule,s=[t.width,t.height];l?r.pictureUrl=Oe(s,o):e&&(r.pictureUrl=Oe(s,o))}}),r.contentList=i},updateSelectedResourcesPic:function(e){var t=this.getBlocksAndResources(e),a=t.blocks,n=t.selectedBlocksAndResources,i=this.pannel.pannelList[e];a.forEach(function(e,t){var a=n[t]||{},i=a.videoContentList[0]||{},r=i.picturePreset||[];if(0!==r.length){var o=[e.width,e.height];i.pictureUrl=Oe(o,r)}}),i.contentList=n},handleInputFlagTagVector:function(e){var t=this.firstPanel;e?this.getVectorTag().then(function(e){t.flagTagVector=e?1:0}):t.flagTagVector=0},fetchVectorTag:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,a,n,i,r,o,l,s,c,u=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.isShowTagsField&&"normal"===this.pannel.parentType){e.next=2;break}return e.abrupt("return",!1);case 2:t=this.firstPanel,a=t.contentList,n=[],i=0;case 6:if(!(i<a.length)){e.next=24;break}r=a[i].videoContentList,o=0;case 9:if(!(o<r.length)){e.next=21;break}if(l=r[o],"media"===l.coverType){e.next=16;break}return this.$message.info("每个推荐位都必须是媒体资源"),e.abrupt("return",!1);case 16:s=l.extraValue1,n.push(s);case 18:o++,e.next=9;break;case 21:i++,e.next=6;break;case 24:return e.next=26,this.$service.getVectorTag({coocaaVIds:n.join(",")}).then(function(e){return e=e||{},t.panelTagVectorInfo.categoryCode=e.tagCode,t.panelTagVectorInfo.categoryName=e.tagName,"{}"!==JSON.stringify(e)&&"string"!==typeof e||(u.firstPanel.flagTagVector=0,u.$message.error("无所有影片都具有的标签"),!1)});case 26:return c=e.sent,e.abrupt("return",c);case 28:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),getVectorTag:function(){var e=this;return this.fetchVectorTag().then(function(t){return t||(e.firstPanel.flagTagVector=0),t})},handleShowThirdSourceCorner:function(e){var t=this,a=this.pannel.pannelList;a.forEach(function(a){(a.contentList||[]).forEach(function(a){(a.videoContentList||[]).forEach(function(a){if(a.cornerList=(a.cornerList||[]).filter(function(e){return 0!==e.position}),e&&"media"===a.coverType){var n=a.extraValue1.split("_")[2],i=t.thirdSourceOptions,r=t.thirdSourcePrefixMap;if(n){var o=r[n],l=i.find(function(e){return e.sourceCode===o});a.cornerList.unshift({position:0,cornerIconId:l.pictureId,imgUrl:l.pictureUrl})}}})})})}},created:function(){var e=this;this.mode=this.initMode||"create",this.$service.getDictType({type:"businessType",isFilter:1}).then(function(t){e.businessTypeEnums=t.map(function(e){return{label:e.dictCnName,value:e.dictId,disabled:e.disabled}})}),"edit"!==this.mode&&"replicate"!==this.mode&&"copy"!==this.mode&&"read"!==this.mode||this.getSimpleBrowseData(),this.pannel.pannelList.push(this.genPannel()),this.$service.getMediaRuleLayout().then(function(t){e.mediaRuleLayoutOptions=t}),this.$service.getDictCorner({dictCategory:"thirdSource"}).then(function(t){e.thirdSourceOptions=t})},mounted:function(){var e=this;this.id&&(this.fetchData(this.version).then(function(){e.clickBlock()}),this.$sendEvent({type:"panel_show",payload:{panel_group_id:this.id}}))}},Ka=Ha,Ya=(a("9df1"),a("5bd3"),Object(w["a"])(Ka,n,i,!1,null,"1d8f8247",null));t["a"]=Ya.exports},4595:function(e,t,a){},"46eb":function(e,t,a){"use strict";var n=a("861b"),i=a.n(n);i.a},"474f":function(e,t,a){},"477b":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"cc-frame-dialog__dialog",attrs:{visible:!0,"append-to-body":!0,fullscreen:e.fullscreen,"before-close":e.handleClose}},[a("span",{staticClass:"el-dialog__title",attrs:{slot:"title"},slot:"title"},[e._t("title",[e._v("\n      "+e._s(e.title)+"\n    ")])],2),a("iframe",{staticClass:"cc-frame-dialog__frame",style:e.frameStyle,attrs:{src:e.url}})])},i=[],r={data:function(){return{}},props:["title","url","fullscreen","frameStyle"],methods:{handleClose:function(){this.$emit("close")}}},o=r,l=(a("1591"),a("2877")),s=Object(l["a"])(o,n,i,!1,null,null,null);t["a"]=s.exports},4903:function(e,t,a){},"493a":function(e,t,a){},4966:function(e,t,a){"use strict";var n=a("5eb9"),i=a.n(n);i.a},4982:function(e,t,a){},"4a60":function(e,t,a){"use strict";var n=a("cfc7"),i=a.n(n);i.a},"4a80":function(e,t,a){"use strict";var n=a("15a2"),i=a.n(n);i.a},"4ab5":function(e,t,a){},"4ab8":function(e,t,a){},"4b20":function(e,t,a){"use strict";var n=a("aa06"),i=a.n(n);i.a},"4b58":function(e,t,a){},"4bc7":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-wrapper"},[e._t("default")],2)},i=[],r={},o=r,l=(a("a166"),a("2877")),s=Object(l["a"])(o,n,i,!1,null,"0b8970cf",null);t["a"]=s.exports},"4c30":function(e,t,a){"use strict";var n=a("72f0"),i=a.n(n);i.a},"4c36":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-select",{attrs:{value:e.value,disabled:e.disabled,placeholder:e.placeholder},on:{input:function(t){return e.$emit("input",t)}}},e._l(e.sourceOptions,function(t,n){return a("el-option",{key:n,attrs:{disabled:e.freeze&&t.value!==e.value,label:t.label,value:t.value}})}),1)},i=[],r={props:["value","disabled","freeze","allowEmpty","placeholder"],computed:{sourceOptions:function(){var e=this.$consts;return this.allowEmpty?e.sourceOptionsWidthEmpty:e.sourceOptions}}},o=r,l=a("2877"),s=Object(l["a"])(o,n,i,!1,null,null,null);t["a"]=s.exports},"4c75":function(e,t,a){},"4cda":function(e,t,a){},"4ef5":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("RemoteSelectorWrapper",{ref:"selectorWrapper",attrs:{title:e.title||"选择角标",filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination,disabled:e.disabled},on:{"pagination-change":e.fetchData,"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset,"select-end":e.handleSelectEnd,"select-start":e.fetchData}},[a("CardList",{attrs:{slot:"item-list",data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-change":e.handleRowSelectionChange},slot:"item-list",scopedSlots:e._u([{key:"row",fn:function(t){var n=t.row;return[a("div",{staticClass:"list-item__img-wrapper"},[a("img",{key:n.imgUrl,staticClass:"list-item__img",attrs:{referrerpolicy:"no-referrer",src:n.imgUrl}})]),a("div",{staticClass:"list-item__info"},[e._v("\n          "+e._s(n.cornerIconName)+"\n          "),a("br"),e._v("\n          "+e._s(e.$consts.statusText[n.cornerStatus])+"\n        ")])]}}])}),"single"===e.table.selectionType?a("div",{attrs:{slot:"actions"},slot:"actions"}):e._e(),e._t("default")],2)},i=[],r=(a("ac6a"),a("f6e7")),o=a.n(r),l=a("5076"),s=a("59c7"),c={components:{CardList:s["CardList"],RemoteSelectorWrapper:l["a"]},props:["title","position","disabled"],data:function(){return{reviewPicUrl:null,filter:this.getDefaultFilter(),filterSchema:null,pagination:{currentPage:1,pageSize:30},selected:[],table:{props:{},data:[],selected:void 0,selectionType:"single"}}},methods:{getDefaultFilter:function(){var e=this.$consts.idPrefix;return{cornerStatus:this.$consts.status.accepted,cornerIconId:void 0,cornerIconName:void 0,typeId:void 0,idPrefix:"10"!==e?e:void 0}},handleRowSelectionChange:function(e,t){this.table.selected=t,this.$refs.selectorWrapper.handleSelectEnd()},handleFilterChange:function(){this.pagination.currentPage=1,this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination,a=this.position;return t&&(e.page=t.currentPage,e.rows=t.pageSize),void 0!==a&&(e.typePosition=a),e},fetchData:function(){var e=this;this.table.selected=void 0;var t=this.parseFilter();this.pictureResolution&&(t.pictureResolution=this.pictureResolution),this.$service.getCornerList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},getMaterialTypes:function(){var e=this;return this.$service.getMaterialTypes().then(function(t){t.forEach(function(t){e.materialTypes[t.label]=t.id})})},handleSelectEnd:function(){var e=this.table,t=e.data,a=e.selected;this.$emit("select-end",t[a]),this.table.selected=void 0}},created:function(){var e=this,t=this.$consts.status;this.$service.getCornerTypes().then(function(a){var n=a.reduce(function(e,t){return(e[t.typeName]=t.typeId)&&e},{}),i=o.a.map({cornerIconId:o.a.o.oneOf([o.a.value(""),o.a.number]).$msg("请输入数字").other("form",{component:"Input",label:" ",placeholder:"ID",cols:{item:3,wrapper:23}}),cornerIconName:o.a.o.string.other("form",{label:" ",placeholder:" 角标名称",cols:{item:3,wrapper:23}}),typeId:o.a.o.enum(n).other("form",{component:"Select",label:" ",placeholder:"角标类型",cols:{item:3,wrapper:23}}),cornerStatus:o.a.o.enum({"审核通过":t.accepted,"待审核":t.waiting}).other("form",{label:"",component:"Select",placeholder:"审核状态",cols:{item:3,label:0,wrapper:23}})}).other("form",{layout:"inline",footer:{cols:{item:3,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}}),r=e.$consts.idPrefix;"10"!==r&&i.map({idPrefix:o.a.o.enum(e.$consts.idPrefixEnums).other("form",{label:" ",placeholder:"数据来源",component:"Select",layout:"inline",cols:{item:3,wrapper:23}})}),e.filterSchema=i})}},u=c,d=(a("ea07"),a("2877")),p=Object(d["a"])(u,n,i,!1,null,"25384222",null);t["a"]=p.exports},"4fc2":function(e,t,a){},5076:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"remote-selector-wrapper"},[a("div",{on:{click:e.handleSelectStart}},[e._t("default",[a("el-button",{attrs:{type:"primary",disabled:e.disabled,plain:""}},[e._v(" "+e._s(e.title))])])],2),a("Dialog",{staticClass:"remote-selector-dialog",attrs:{"custom-class":e.customClass,"show-close":e.showClose,fullscreen:e.fullscreen,visible:e.showDialog,"append-to-body":!0},on:{"update:visible":function(t){e.showDialog=t}}},[a("div",{attrs:{slot:"title"},slot:"title"},[e._t("title",[e._v(" "+e._s(e.title)+" ")])],2),e._t("content",[a("div",{staticClass:"remote-selector-main"},[a("div",{staticClass:"remote-selector-main__prepend"},[e._t("prepend")],2),a("div",{staticClass:"remote-selector-main__filter"},[e._t("filter",[e.filterSchema?a("GateSchemaForm",{attrs:{schema:e.filterSchema},on:{submit:e.handleFilter,reset:e.handleResetFilterForm},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}}):e._e()])],2),a("div",{staticClass:"remote-selector-main__content"},[e._t("before-item-list"),e._t("item-list"),e._t("after-item-list")],2),e._t("footer",[a("div",{staticClass:"remote-selector-main__footer"},[a("div",{staticClass:"remote-selector-main__pagination"},[e._t("pagination",[e.pagination?a("el-pagination",{attrs:{"current-page":e.pagination.currentPage,"page-sizes":[15,20,30,50,100,200],"page-size":e.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pagination.total},on:{"size-change":e.handlePageSizeChange,"current-change":e.handlePageChange}}):e._e()])],2),a("div",{staticClass:"remote-selector-main__actions"},[e._t("actions",[e.hideSubmit?e._e():a("Button",{attrs:{type:"primary"},on:{click:e.handleSelectEnd}},[e._v("\n                    确定\n                  ")]),a("Button",{on:{click:e.handleSelectCancel}},[e._v("\n                    取消\n                  ")])])],2)])])],2)],{isShow:e.showDialog})],2)],1)},i=[],r=a("5c96"),o={components:{Button:r["Button"],Dialog:r["Dialog"]},props:{title:{type:String,default:function(){return"选择"}},hideSubmit:{type:Boolean},fullscreen:{type:Boolean,default:function(){return!0}},filter:Object,filterSchema:Object,pagination:Object,customClass:String,showClose:{type:Boolean,default:function(){return!0}},disabled:{type:Boolean,default:function(){return!1}}},data:function(){return{showDialog:!1,showContent:!1}},methods:{handleSelectStart:function(){this.disabled||(this.showDialog=!0,this.$emit("select-start"))},handleSelectEnd:function(){this.showDialog=!1,this.$emit("select-end")},handleSelectCancel:function(){this.showDialog=!1,this.$emit("select-cancel")},handleFilter:function(e){e&&0!==e.length||this.$emit("filter-change")},handlePageSizeChange:function(e){this.$set(this.pagination,"pageSize",e),this.$emit("pagination-change")},handlePageChange:function(e){this.$set(this.pagination,"currentPage",e),this.$emit("pagination-change")},handleResetFilterForm:function(){this.$emit("filter-reset")},emitFilterChange:function(e){this.$emit("filter-change",e)}},created:function(){}},l=o,s=(a("63d2"),a("2877")),c=Object(s["a"])(l,n,i,!1,null,"8973dea0",null);t["a"]=c.exports},"516d":function(e,t,a){"use strict";var n=a("4ab8"),i=a.n(n);i.a},"51bf":function(e,t,a){"use strict";var n=a("aff1"),i=a.n(n);i.a},5318:function(e,t,a){"use strict";var n=a("c48d"),i=a.n(n);i.a},"545a":function(e,t,a){},"546a":function(e,t,a){"use strict";var n=a("8390"),i=a.n(n);i.a},"55cf":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE8AAABACAYAAABbYipTAAAElUlEQVR4Xu2cTYgcRRTH3+sZZXZ6DkFl9mR0BQU/IOpBklzcKF68JApL0FM8Sbp7kmzEa6KHQJAkbuiqTW7mEg9eEj/wFEhyEwSjQkCFyPqBH4gkgZ2ZXba7X+hxVsIyM/W6a2qnJ1Nzff/36r1fve6aqeppBPvJTQBzexp2pEOHtqzE8bZ0mKkwvGp4uFzhCwevHQSzMcBRBJjdUNFFJ4rmp86eXcpVqQGnQsFb9rx96Dgf9auTAG5BkuyqLS5+a4BF5pCFgZd2XAJwWVVBCtAtl2dwYeGWSmvaXhh4Td+/CIi7OQUj0XxVygWO1qSmOPCCgLiFEsDVmhAb74lc96HpxhIeEC25Us4MjULOQOMJDwBcIUae+8gTWJ/0ZobLNvWx8O66XCy8nPeO1M3Cs/A0CGi42s6z8DQIaLjazrPwNAhouNrOs/A0CGi42s6z8DQIaLjazrPwNAj0cW03Gi+qoiZEV1Sau+0O4sDN0DiOb5s+6zC6JbXsec8i4gVAfDQLmGFpCeCKWy6/Zuq8wyy8ILjc4whxWGy4cd53hXiPK86iMwov6yKQJXGu1uR5h1l4vr8EiI9wCzWiI/rUlXKPidhG4akOsU0UtDEmJclzphYOo/DSQkYJkJLkrdri4jlTk2Qc3qgAmgaX1pUbXjsIZgBxK0bRb5UzZ35Wze5mdiAH3KrnPZmUSnUCuFENw99V+feyZ4a32mg8FREdA6LdgNjxJ6J/AeDLUhwfGfQU02YAVIFrNRrbE6JjCPDS/0CI/gKAz6hcPlI7ffpvLshM8NqetytB/AIQq70GIKKb6Dgvu2F4rV8CJgEqwQXBXiI6D4ilPvn96UTRTu5jbGx45PsPNgF+QMSHFDNzo4r4NIbh6mYCVIFb2b//sdhxrgNiRZH/V64QOzjdx4bX8v0PCPFdVlCid6pSnhqkHWYHqsB1Fq0g+BgB3mDmv7cq5ScqLRte0/d/BcSHVQE7dqKvXSlfUGmHAZADjubm7m/V68uAeJ8qp27+F1wpX1dpWfBobq7UqtfX1hcIVVAC+KcmRF2l0/0awwGXjtE+eHBrEse/cPLpaq65Qjyv0vPgzc9PtdbWWqpg63Yiul2TcgtXn7UD0/glxD1TQrC2sVYOHHg8TpKfuPkQ0fWalM+o9IWAl6UDU3BANJvlJ9c9D48DMA+4NO5EwBsEMC+4iYLXC6AOuImD11kh//trQeecwomic9xv/b1u8hNz2apWuDx2Cy8Pta6PhWfhaRDQcLWdNynwACDdjjquUe+wXR8AgAY36Eh/nnGTLKrOwtOYGQvPwtMgoOFqO68w8NJt7Onpvgc6GnkW0pWIvq9J2XmzxqAPazO0s9MRBDcRgL07rBq4yHYCuFQT4hVVjlngnUeAN1UB7wU7AhyuCvGhqhY2vO6TAt8BQFkVdMztf1QrlSfwxImmqg42vDRQy/cPE+JJVdCxtROtlRzn1UoYXuLUkAle597nefvAcY4jwDRngHHRENGPJcd5O8urlzLDS2F0z3G3AeJ2AGCdzxYc4jdVIT5HAPbrSdJ6csErOIhNS8/C00B9B08jCm6IhdIzAAAAAElFTkSuQmCC"},"55ef":function(e,t,a){"use strict";var n=a("181a"),i=a.n(n);i.a},"561d":function(e,t,a){"use strict";var n=a("41fc"),i=a.n(n);i.a},"565d":function(e,t,a){"use strict";var n=a("d4ff"),i=a.n(n);i.a},5662:function(e,t,a){},5663:function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"login",function(){return ne}),a.d(n,"logout",function(){return ie});var i={};a.r(i),a.d(i,"getMenu",function(){return re}),a.d(i,"getButtonGroupForPageList",function(){return oe});var r={};a.r(r),a.d(r,"uploadImage",function(){return le}),a.d(r,"uploadLayoutFile",function(){return se}),a.d(r,"uploadApk",function(){return ce}),a.d(r,"uploadZip",function(){return ue});var o={};a.r(o),a.d(o,"getDepts",function(){return de}),a.d(o,"userConfigMenuInfo",function(){return pe}),a.d(o,"userConfigPageList",function(){return he}),a.d(o,"getNotRolesByUserId",function(){return me}),a.d(o,"getRolesByUserId",function(){return fe}),a.d(o,"saveUserRoles",function(){return ve}),a.d(o,"userConfigEdit",function(){return ge}),a.d(o,"getDictCheckedByUserId",function(){return be}),a.d(o,"userConfigSave",function(){return ye}),a.d(o,"saveProfession",function(){return we}),a.d(o,"userConfigDelete",function(){return Ie}),a.d(o,"getDictList",function(){return Ce}),a.d(o,"SaveDictionary",function(){return Te}),a.d(o,"DeleteDict",function(){return Se}),a.d(o,"getDictCategoryList",function(){return ke}),a.d(o,"SaveDictCategory",function(){return _e}),a.d(o,"getLoginLogList",function(){return Pe}),a.d(o,"getSysMenuList",function(){return xe}),a.d(o,"saveSysMenu",function(){return Fe}),a.d(o,"editSysMenu",function(){return De}),a.d(o,"getNotMenuByRunId",function(){return Re}),a.d(o,"getMenuByRunId",function(){return Le}),a.d(o,"saveMenuRun",function(){return $e}),a.d(o,"getMenuInfo",function(){return Ne}),a.d(o,"deleteMenuById",function(){return Ee}),a.d(o,"modifyPwd",function(){return Oe});var l={};a.r(l),a.d(l,"getRoleList",function(){return Ae}),a.d(l,"userRoleList",function(){return Ve}),a.d(l,"saveRoleData",function(){return Be}),a.d(l,"deleteRole",function(){return Me}),a.d(l,"setCrowdAuthOfRole",function(){return Ue}),a.d(l,"getAuthList",function(){return Ge}),a.d(l,"saveAuthOfRole",function(){return je}),a.d(l,"updateSeq",function(){return ze}),a.d(l,"getRoleDetailById",function(){return We});var s={};a.r(s),a.d(s,"sysDeptPageList",function(){return qe}),a.d(s,"sysDeptRemove",function(){return Je}),a.d(s,"sysDeptSave",function(){return He}),a.d(s,"sysDeptDetailInfo",function(){return Ke}),a.d(s,"sysDeptUpdateSeq",function(){return Ye});var c={};a.r(c),a.d(c,"sysLogOpPageList",function(){return Qe});var u={};a.r(u),a.d(u,"broadcastBlockPageList",function(){return Xe}),a.d(u,"deleteBroadcastBlock",function(){return Ze}),a.d(u,"getCornerTypes",function(){return et}),a.d(u,"getMaterialTypes",function(){return tt}),a.d(u,"saveBlockInfo",function(){return at}),a.d(u,"getSysPlugin",function(){return nt}),a.d(u,"editSysPlugin",function(){return it}),a.d(u,"getPluginParentTypes",function(){return rt}),a.d(u,"getPluginTypes",function(){return ot}),a.d(u,"getMediaVideoInfos",function(){return lt}),a.d(u,"getPartnerSource",function(){return st}),a.d(u,"getCondition",function(){return ct}),a.d(u,"queryLiveVideoResult",function(){return ut}),a.d(u,"getPluginVersions",function(){return dt}),a.d(u,"getPluginType",function(){return pt}),a.d(u,"getResourceList",function(){return ht}),a.d(u,"getCornerList",function(){return mt}),a.d(u,"SavePlugin",function(){return ft}),a.d(u,"getMultiBlockList",function(){return vt}),a.d(u,"getData",function(){return gt}),a.d(u,"removeMulti",function(){return bt}),a.d(u,"getClickData",function(){return yt}),a.d(u,"getHistoryList",function(){return wt}),a.d(u,"getBroadcastBlockEditData",function(){return It}),a.d(u,"broadcastBlockDataList",function(){return Ct}),a.d(u,"getBlockSimpleBrowseData",function(){return Tt}),a.d(u,"getBlockChartData",function(){return St}),a.d(u,"getBlockRealTimeChartData",function(){return kt}),a.d(u,"getMediaAutomationDataList",function(){return _t}),a.d(u,"getMediaAutomationList",function(){return Pt}),a.d(u,"saveMediaAutomation",function(){return xt}),a.d(u,"getMediaAutomationDetial",function(){return Ft}),a.d(u,"deleteMediaAutomation",function(){return Dt}),a.d(u,"getBroadcastDataTitles",function(){return Rt}),a.d(u,"getMediaSence",function(){return Lt}),a.d(u,"getNewMediaAutomationList",function(){return $t}),a.d(u,"getMediaSceneList",function(){return Nt}),a.d(u,"removeMediaDmp",function(){return Et}),a.d(u,"saveMediaRecStreamDmp",function(){return Ot}),a.d(u,"getNewMediaAutomationDetial",function(){return At}),a.d(u,"dmpUpdatePriority",function(){return Vt});var d={};a.r(d),a.d(d,"getAdminMasterControllInfo",function(){return Bt}),a.d(d,"saveAdminMasterControll",function(){return Mt});var p={};a.r(p),a.d(p,"getMaterialPageList",function(){return Ut}),a.d(p,"materialBatchAudit",function(){return Gt}),a.d(p,"materialBatchDelete",function(){return jt}),a.d(p,"getCommonOnclickInfoMenu",function(){return zt}),a.d(p,"getCommonOnclickInfoList",function(){return Wt}),a.d(p,"commonOnclickInfoSave",function(){return qt}),a.d(p,"commonOnclickInfoDelete",function(){return Jt}),a.d(p,"getCommonOnclickInfoEdit",function(){return Ht});var h={};a.r(h),a.d(h,"tabInfoList",function(){return Yt}),a.d(h,"tabInfoDataList",function(){return Qt}),a.d(h,"getTabType",function(){return Xt}),a.d(h,"getMediaResourceInfo",function(){return Zt}),a.d(h,"filmDetailPageList",function(){return ea}),a.d(h,"saveFilmDetailPage",function(){return ta}),a.d(h,"removeFilmDetailPage",function(){return aa}),a.d(h,"tabIconList",function(){return na}),a.d(h,"tabInfoGet",function(){return ia}),a.d(h,"tabInfoGetBase",function(){return ra}),a.d(h,"tabInfoUpsert",function(){return oa}),a.d(h,"tabInfoRemove",function(){return la}),a.d(h,"editFilmDetailPage",function(){return sa}),a.d(h,"reviewFilmDetailPage",function(){return ca}),a.d(h,"getVipButtonSource",function(){return ua}),a.d(h,"getTabSimpleBrowseData",function(){return da}),a.d(h,"getTabChartData",function(){return pa}),a.d(h,"getThirdpartTabInfoDetail",function(){return ha}),a.d(h,"updateThirdPartTabAuditType",function(){return ma}),a.d(h,"updateThirdPartTabAudit",function(){return fa}),a.d(h,"getThirdpartTabLayout",function(){return va});var m={};a.r(m),a.d(m,"panelPageList",function(){return ga}),a.d(m,"panelDataList",function(){return ba}),a.d(m,"panelGetDetail",function(){return ya}),a.d(m,"panelGetDetailSilence",function(){return wa}),a.d(m,"panelUpsert",function(){return Ia}),a.d(m,"panelUpsertSilent",function(){return Ca}),a.d(m,"panelRemove",function(){return Ta}),a.d(m,"collectCancel",function(){return Sa}),a.d(m,"collect",function(){return ka}),a.d(m,"getSharedTags",function(){return _a}),a.d(m,"panelTagUpsert",function(){return Pa}),a.d(m,"panelRecommendList",function(){return xa}),a.d(m,"panelRecommendGetDetail",function(){return Fa}),a.d(m,"panelRecommendUpsert",function(){return Da}),a.d(m,"panelRecommendFlagUpsert",function(){return Ra}),a.d(m,"getPanelRecommandStat",function(){return La}),a.d(m,"getPanelRecommandChart",function(){return $a}),a.d(m,"getPanelRecommandFeedback",function(){return Na}),a.d(m,"getPanelSimpleBrowseData",function(){return Ea}),a.d(m,"getPanelChartData",function(){return Oa}),a.d(m,"getVideoChartData",function(){return Aa}),a.d(m,"getVideoRealTimeChartData",function(){return Va}),a.d(m,"getVideoDmpChartData",function(){return Ba}),a.d(m,"getVideoDmpRealTimeChartData",function(){return Ma}),a.d(m,"getVideoDmpTitles",function(){return Ua}),a.d(m,"getVideoDmpCrowds",function(){return Ga}),a.d(m,"getFilmFilterPartnerSource",function(){return ja}),a.d(m,"getFilmFilterOptions",function(){return za}),a.d(m,"getFilmFilterResult",function(){return Wa}),a.d(m,"getMediaRuleLayout",function(){return qa}),a.d(m,"getMediaFillType",function(){return Ja}),a.d(m,"getFocusCategory",function(){return Ha}),a.d(m,"getDictCorner",function(){return Ka}),a.d(m,"getVectorTag",function(){return Ya});var f={};a.r(f),a.d(f,"getHomePageInfoList",function(){return Qa}),a.d(f,"homePageInfoSave",function(){return Xa}),a.d(f,"homePageInfoDelete",function(){return Za}),a.d(f,"homePageGetDetail",function(){return en});var v={};a.r(v),a.d(v,"getMediaVideoInfos",function(){return tn}),a.d(v,"getPartnerSource",function(){return an}),a.d(v,"getCondition",function(){return nn}),a.d(v,"getSegmentList",function(){return rn}),a.d(v,"getAppManagementList",function(){return on});var g={};a.r(g),a.d(g,"getMarkPanelList",function(){return ln}),a.d(g,"MarkPanelSave",function(){return sn}),a.d(g,"deleteMarkPanel",function(){return cn}),a.d(g,"getViewData",function(){return un}),a.d(g,"getTimedInfo",function(){return dn}),a.d(g,"getHandlePerson",function(){return pn});var b={};a.r(b),a.d(b,"getGlobalCornerIconTypePageList",function(){return hn}),a.d(b,"globalCornerIconTypeBatchDel",function(){return mn}),a.d(b,"globalCornerIconTypeSave",function(){return fn}),a.d(b,"globalCornerIconTypeDetail",function(){return vn});var y={};a.r(y),a.d(y,"getLayoutInforPageList",function(){return gn}),a.d(y,"getLayoutInforBatchDel",function(){return bn}),a.d(y,"getLayoutInforSave",function(){return yn}),a.d(y,"getLayoutInforById",function(){return wn}),a.d(y,"getLayoutVersion6",function(){return In}),a.d(y,"getAuditDetailButton",function(){return Cn}),a.d(y,"auditTask",function(){return Tn}),a.d(y,"revokedAudit",function(){return Sn}),a.d(y,"putShelves",function(){return kn});var w={};a.r(w),a.d(w,"themeInfoPageList",function(){return _n}),a.d(w,"themeInfoRemove",function(){return Pn}),a.d(w,"themeInfoDetail",function(){return xn}),a.d(w,"savethemeInfo",function(){return Fn}),a.d(w,"checkThemeMd5",function(){return Dn});var I={};a.r(I),a.d(I,"globalPictureUpsert",function(){return Rn}),a.d(I,"globalPictureGet",function(){return Ln});var C={};a.r(C),a.d(C,"getGlobalMgrList",function(){return $n}),a.d(C,"getCornerTypes",function(){return Nn}),a.d(C,"getIconAttributes",function(){return En}),a.d(C,"globalCornerIconEdit",function(){return On}),a.d(C,"globalCornerIconSave",function(){return An}),a.d(C,"globalCornerIconRemove",function(){return Vn}),a.d(C,"batchAudit",function(){return Bn}),a.d(C,"revokedAudit",function(){return Mn}),a.d(C,"getDetailInfo",function(){return Un}),a.d(C,"changePriority",function(){return Gn});var T={};a.r(T),a.d(T,"advertisementList",function(){return jn}),a.d(T,"advertisementUpsert",function(){return zn});var S={};a.r(S),a.d(S,"getHistory",function(){return Wn}),a.d(S,"privatePanelRemove",function(){return qn});var k={};a.r(k),a.d(k,"getTotal",function(){return Jn}),a.d(k,"todoTaskPageList",function(){return Hn}),a.d(k,"getMoviePageList",function(){return Kn});var _={};a.r(_),a.d(_,"getPolicyManagePageList",function(){return Yn}),a.d(_,"getChildPolicyManagePageList",function(){return Qn}),a.d(_,"getTestPolicyManagePageList",function(){return Xn}),a.d(_,"getChipAndModelPageList",function(){return Zn}),a.d(_,"addChipAndModel",function(){return ei}),a.d(_,"getHomePageModelPageList",function(){return ti}),a.d(_,"policyConfSave",function(){return ai}),a.d(_,"testPolicyConfSave",function(){return ni}),a.d(_,"childPolicyConfSave",function(){return ii}),a.d(_,"policyConfRemove",function(){return ri}),a.d(_,"testPolicyConfRemove",function(){return oi}),a.d(_,"getPolicyConfDetail",function(){return li}),a.d(_,"getTestPolicyConfDetail",function(){return si}),a.d(_,"getChildPolicyConfDetail",function(){return ci});var P={};a.r(P),a.d(P,"floatWindowList",function(){return ui});var x={};a.r(x),a.d(x,"getVersionList",function(){return rr}),a.d(x,"revokeAudit",function(){return or}),a.d(x,"secondAudit",function(){return lr}),a.d(x,"getTimedTaskLimit",function(){return sr}),a.d(x,"getTimedTaskInfo",function(){return cr}),a.d(x,"timedTaskCancel",function(){return ur}),a.d(x,"putOnShelves",function(){return dr}),a.d(x,"deleteVersion",function(){return hr}),a.d(x,"deleteResource",function(){return fr}),a.d(x,"getAuditHistoryList",function(){return vr}),a.d(x,"getDictType",function(){return br}),a.d(x,"getEnv",function(){return yr}),a.d(x,"getRecommendStrategy",function(){return wr});var F={};a.r(F),a.d(F,"collectionGetList",function(){return Ir});var D={};a.r(D),a.d(D,"businessTabSave",function(){return Cr}),a.d(D,"businessTabDelete",function(){return Tr}),a.d(D,"businessTabEdit",function(){return Sr}),a.d(D,"businessTabCollect",function(){return kr}),a.d(D,"businessTabCancelCollect",function(){return _r});var R={};a.r(R),a.d(R,"mediaPPTVVideoList",function(){return Pr}),a.d(R,"mediaGetCondition",function(){return xr}),a.d(R,"mediaGetTagList",function(){return Fr}),a.d(R,"mediaGetInterestList",function(){return Dr}),a.d(R,"mediaGetAuthorList",function(){return Rr}),a.d(R,"mediaGetVideoList",function(){return Lr}),a.d(R,"mediaGetRankingInfoVideoList",function(){return $r}),a.d(R,"mediaGetGDChannelList",function(){return Nr}),a.d(R,"mediaGetGDSchedulelList",function(){return Er}),a.d(R,"mediaGetChannelProvinceOptions",function(){return Or});var L={};a.r(L),a.d(L,"crowdRelUpsert",function(){return Ar}),a.d(L,"crowdRelGet",function(){return Vr}),a.d(L,"crowdRelDel",function(){return Br}),a.d(L,"crowdRefresh",function(){return Mr}),a.d(L,"crowdRelList",function(){return Ur});var $={};a.r($),a.d($,"getCrowdOfPolicyWithCache",function(){return jr}),a.d($,"getTaglist",function(){return zr}),a.d($,"getPolicyList",function(){return Wr}),a.d($,"getCrowdOfPolicy",function(){return qr}),a.d($,"getCrowdPolicy",function(){return Jr});var N={};a.r(N),a.d(N,"getUserContentAuth",function(){return Hr}),a.d(N,"getResourceContentAuthList",function(){return Kr}),a.d(N,"upsertResourceContentAuthList",function(){return Yr});var E={};a.r(E),a.d(E,"desktopGetDataSyncInfo",function(){return Qr}),a.d(E,"desktopUpdateDataSyncInfo",function(){return Xr}),a.d(E,"desktopGetDataSyncGeneral",function(){return Zr}),a.d(E,"desktopGetDataSyncList",function(){return eo});var O={};a.r(O),a.d(O,"topicGetList",function(){return to}),a.d(O,"topicGetDetail",function(){return ao}),a.d(O,"topicUpsert",function(){return no});var A={};a.r(A),a.d(A,"topicConfigGetList",function(){return io}),a.d(A,"topicConfigGetDetail",function(){return ro}),a.d(A,"topicConfigUpsert",function(){return oo});var V={};a.r(V),a.d(V,"mallGetList",function(){return lo});var B={};a.r(B),a.d(B,"sendEvent",function(){return so});var M={};a.r(M),a.d(M,"tabInsertionTaskGetList",function(){return co}),a.d(M,"tabInsertionTaskGetDetail",function(){return uo}),a.d(M,"tabInsertionTaskUpsert",function(){return po}),a.d(M,"tabInsertionTaskStatusUpsert",function(){return ho});var U={};a.r(U),a.d(U,"deviceConfigGetList",function(){return mo}),a.d(U,"deviceConfigGetDetail",function(){return fo}),a.d(U,"deviceConfigUpsert",function(){return vo});var G={};a.r(G),a.d(G,"policyGroupList",function(){return go}),a.d(G,"policyGroupUpsert",function(){return bo}),a.d(G,"policyGroupGetDetail",function(){return yo}),a.d(G,"modelChipList",function(){return wo}),a.d(G,"policyGroupRemove",function(){return Io}),a.d(G,"homepageMatchingList",function(){return Co});var j={};a.r(j),a.d(j,"getBlockRecList",function(){return To});a("cadf"),a("551c"),a("f751"),a("097d");var z=a("2b0e"),W=a("519c"),q=a("5c96"),J=a.n(q),H=a("2819"),K=a.n(H),Y=(a("96cf"),a("3b8d")),Q=(a("456d"),a("ac6a"),a("cebc")),X=a("4328"),Z=a.n(X),ee=a("bc3a"),te=a.n(ee);function ae(e){var t,a=e.method,n=void 0===a?"get":a,i=e.url,r=e.data,o=e.params,l=e.isJSON,s=void 0!==l&&l,c=e.useLoading,u=void 0===c||c;u&&(t=z["default"].prototype.$loading({lock:!0,body:!0}));var d={method:n,url:i,data:s?r:"string"===typeof r?r:Z.a.stringify(r),params:o};return te()(d).then(function(e){var a=e.data;if(t&&t.close(),"undefined"!==typeof a.success&&"undefined"!==typeof a.msg){if(a.success)return"undefined"!==typeof a.data?"undefined"!==typeof a.total?{rows:a.data,total:a.total}:a.data:"undefined"!==typeof a.rows?"undefined"!==typeof a.total?{rows:a.rows,total:a.total}:a.rows:a;throw new Error(a.msg)}if("undefined"!==typeof a.rows&&"undefined"!==typeof a.total)return{rows:a.rows,total:a.total};if("undefined"!==typeof a.code&&"0"!=a.code)throw new Error(a.msg);return a}).catch(function(e){throw t&&t.close(),e})}function ne(e){var t=this;return this.fetch({method:"post",url:"api/v1/userlogin.html",data:e}).then(function(e){return t.state=e,e})}function ie(e){return this.fetch({method:"get",url:"api/logout.html"}).catch(function(){})}function re(e){return this.fetch({method:"post",url:"api/v1/getMenus.html",data:e}).then(function(e){return e})}function oe(e){return this.fetch({method:"get",url:"api/v1/"+e+"/getMenuInfo.html",params:""})}a("6762"),a("2fdb");function le(e){var t=e.file,a=e.onUploadProgress,n=new FormData;return n.append("file",t),te()({method:"post",url:"api/v1/upload/image.html",data:n,onUploadProgress:a}).then(function(e){var t=e.data;return t})}function se(e){var t=e.file,a=e.onUploadProgress,n=new FormData;return n.append("file",t),te()({method:"post",url:"api/v1/layout/getLayoutFile.html",data:n,onUploadProgress:a}).then(function(e){var t=e.data;if(void 0!==t.code&&"0"!=t.code)throw new Error(t.msg);t=t.data,t.content=JSON.parse(t.content);var a=t.content.type;if(!["Panel","Lengthwise","Expander"].includes(a))throw new Error("选择的文件不对，应该选择布局格式的文件");return t})}function ce(e){var t=e.file,a=e.onUploadProgress,n=new FormData;return n.append("file",t),te()({method:"post",url:"api/v1/upload/apk.html",data:n,onUploadProgress:a}).then(function(e){var t=e.data;return t})}function ue(e){var t=e.file,a=e.type,n=e.onUploadProgress,i=new FormData;return i.append("file",t),te()({method:"post",url:"api/v1/upload/zip.html?type="+a,data:i,onUploadProgress:n}).then(function(e){var t=e.data;return t})}function de(e){return this.fetch({method:"get",url:"api/v1/sysDept/listAllDept.html",params:e})}function pe(e){return this.fetch({method:"post",url:"api/v1/sysUser/getMenuInfo.html",data:e})}function he(e){return this.fetch({method:"post",url:"api/v1/sysUser/pageList.html",data:e})}function me(e){return this.fetch({method:"post",url:"api/v1/sysUser/getNotRolesByUserId.html",data:e})}function fe(e){return this.fetch({method:"post",url:"api/v1/sysUser/getRolesByUserId.html",data:e})}function ve(e){return this.fetch({method:"post",url:"api/v1/sysUser/saveUserRoles.html",data:e})}function ge(e){return this.fetch({method:"get",url:"api/v1/sysUser/getDetailInfo.html",params:e})}function be(e){return this.fetch({method:"get",url:"api/v1/sysUser/getDictCheckedByUserId.html",params:e})}function ye(e){return this.fetch({method:"post",url:"api/v1/sysUser/save.html",data:e})}function we(e){return this.fetch({method:"post",url:"api/v1/sysUser/saveProfession.html",data:e})}function Ie(e){return this.fetch({method:"get",url:"api/v1/sysUser/remove.html",params:e})}function Ce(e){return this.fetch({method:"post",url:"api/dict/pageList.html",data:e})}function Te(e){return this.fetch({method:"post",url:"api/dict/save.html",data:e,isJSON:!0})}function Se(e){return this.fetch({method:"post",url:"api/dict/remove.html",data:e})}function ke(){return this.fetch({method:"post",url:"api/dictCategory/list.html"})}function _e(e){return this.fetch({method:"post",url:"api/dictCategory/save.html",data:e,isJSON:!0})}function Pe(e){return this.fetch({method:"post",url:"api/v1/sysLogLogin/pageList.html",data:e})}function xe(e){return this.fetch({method:"get",url:"api/v1/sysMenu/pageList.html",params:e})}function Fe(e){return this.fetch({method:"post",url:"api/v1/sysMenu/save.html",data:e})}function De(e){return this.fetch({method:"get",url:"api/v1/sysMenu/getDetailInfo.html",params:e})}function Re(e){return this.fetch({method:"get",url:"api/v1/sysMenu/getNotRunByMenuId.html",params:e})}function Le(e){return this.fetch({method:"get",url:"api/v1/sysMenu/getRunByMenuId.html",params:e})}function $e(e){return this.fetch({method:"post",url:"api/v1/sysMenu/saveMenuRun.html",data:e})}function Ne(){return this.fetch({method:"post",url:"api/v1/sysMenu/getMenuInfo.html"})}function Ee(e){return this.fetch({method:"get",url:"api/v1/sysMenu/remove.html",params:e})}function Oe(e){return this.fetch({method:"get",url:"api/v1/updatePassword.html",params:e})}function Ae(e){return this.fetch({method:"post",url:"api/v1/sysRole/pageList.html",data:e})}function Ve(e){return this.fetch({method:"post",url:"api/v1/sysRole/userList.html",params:e})}function Be(e){return this.fetch({method:"post",url:"api/v1/sysRole/save.html",data:e})}function Me(e){return this.fetch({method:"get",url:"api/v1/sysRole/remove.html",params:e})}function Ue(e){return this.fetch({method:"post",url:"api/v1/tag/save.html",data:e,isJSON:!0})}function Ge(e){return this.fetch({method:"get",url:"api/v1/sysRole/modifyRoleAuthView.html",params:e})}function je(e){return this.fetch({method:"post",url:"api/v1/sysRole/modifyRoleAuthSave.html",data:e})}function ze(e){return this.fetch({method:"get",url:"api/v1/sysRole/updateSeq.html",params:e})}function We(e){return this.fetch({method:"get",url:"api/v1/sysRole/getDetailInfo.html",params:e})}function qe(e){return this.fetch({method:"post",url:"api/v1/sysDept/pageList.html",data:e})}function Je(e){return this.fetch({method:"get",url:"api/v1/sysDept/remove.html",params:e})}function He(e){return this.fetch({method:"post",url:"api/v1/sysDept/save.html",data:{jsonStr:JSON.stringify(e)}})}function Ke(e){return this.fetch({method:"get",url:"api/v1/sysDept/getDetailInfo.html",params:e})}function Ye(e){return this.fetch({method:"get",url:"api/v1/sysDept/updateSeq.html",params:e})}function Qe(e){return this.fetch({method:"post",url:"api/v1/sysLogOp/pageList.html",data:e})}function Xe(e){return this.fetch({method:"post",url:"api/v1/blockInfo/pageList.html",data:e})}function Ze(e){return this.fetch({method:"get",url:"api/v1/blockInfo/remove.html",params:e})}function et(e){return this.fetch({method:"get",url:"api/v1/cornerIconType/getCornerTypes.html",params:e})}function tt(e){return void 0===e&&(e="materialType"),this.fetch({method:"get",url:"api/v1/dict/getTypes/poster/".concat(e,".html")})}function at(e){return this.fetch({method:"post",url:"api/v1/blockInfo/save.html",data:e})}function nt(e){return this.fetch({method:"post",url:"api/v1/sysPlugin/pageList.html?pluginParentType=builtIn",data:e})}function it(e){return this.fetch({method:"get",url:"api/v1/sysPlugin/getDetailInfo.html",params:e})}function rt(e){return this.fetch({method:"post",url:"api/v1/dict/getTypes/sysPlugin/pluginParentType.html",data:e})}function ot(e){return this.fetch({method:"post",url:"api/v1/dict/getTypes/sysPlugin/pluginType.html",data:e})}function lt(e){return this.fetch({method:"get",url:"api/tvos/getMediaVideoInfos.html",params:e})}function st(e){return this.fetch({method:"get",url:"api/tvos/getPartnerSource.html",params:e})}function ct(e){return this.fetch({method:"get",url:"api/tvos/getCondition.html",params:e})}function ut(e){return this.fetch({method:"get",url:"api/tvos/queryLiveVideoResult.html",params:e})}function dt(e){return this.fetch({method:"post",url:"api/v1/dict/getTypes/sysPlugin/"+e+".html"})}function pt(e){return this.fetch({method:"post",url:"api/v1/dict/getTypes/sysPlugin/pluginType.html",data:e})}function ht(e){return this.fetch({method:"post",url:"api/v1/poster/dataList.html",data:e})}function mt(e){return this.fetch({method:"post",url:"api/v1/cornerIcon/pageList.html",data:e})}function ft(e){return e={jsonStr:JSON.stringify(e)},this.fetch({method:"post",url:"api/v1/sysPlugin/save.html",data:e})}function vt(e){return this.fetch({method:"post",url:"api/v1/sysPlugin/pageList.html?builtInNotShow=1",data:e})}function gt(e){return this.fetch({method:"get",url:"api/v1/sysPlugin/getDetailInfo.html",params:e})}function bt(e){return this.fetch({method:"get",url:"api/v1/sysPlugin/remove.html",params:e})}function yt(e){return this.fetch({method:"post",url:"api/v1/onclickInfo/pageList.html",data:e})}function wt(e){return this.fetch({method:"get",url:"api/v1/hvi/historyList.html",params:e})}function It(e){return this.fetch({method:"POST",url:"api/v1/blockInfo/getDetailInfo.html",data:e})}function Ct(e){return this.fetch({url:"api/v1/blockInfo/dataList.html",params:e})}function Tt(e){return this.fetch({method:"get",url:"api/v1/dataShow/block/getSimpleBrowseData.html",params:e})}function St(e){return this.fetch({method:"get",url:"api/v1/dataShow/block/getChartData.html",params:e})}function kt(e){return this.fetch({method:"get",url:"api/v1/dataShow/blockRealTime/getChartData.html",params:e})}function _t(e){return this.fetch({method:"get",url:"api/v1/mediaAutomation/dataList.html",params:e})}function Pt(e){return this.fetch({method:"get",url:"api/v1/mediaAutomation/pageList.html",params:e})}function xt(e){return this.fetch({method:"post",url:"api/v1/mediaAutomation/save.html",data:e})}function Ft(e){return this.fetch({method:"get",url:"api/v1/mediaAutomation/getDetailInfo.html",params:e})}function Dt(e){return this.fetch({method:"get",url:"api/v1/mediaAutomation/remove.html",params:e})}function Rt(e){return this.fetch({method:"get",url:"api/v1/dataShow/block/getAllTitles.html",params:e})}function Lt(e){return this.fetch({method:"get",url:"api/v1/dict/getTypes/scene.html",params:e})}function $t(e){return this.fetch({method:"get",url:"api/v1/recStream/dataList.html",params:e})}function Nt(e){return this.fetch({method:"get",url:"api/v1/recStreamDmp/pageList.html",params:e})}function Et(e){return this.fetch({method:"get",url:"api/v1/recStreamDmp/remove.html",params:e})}function Ot(e){return this.fetch({method:"post",url:"api/v1/recStreamDmp/save.html",data:{jsonStr:JSON.stringify(e)}})}function At(e){return this.fetch({method:"get",url:"api/v1/recStream/getDetailInfo.html",params:e})}function Vt(e){return this.fetch({method:"post",url:"api/v1/recStreamDmp/updatePriority.html",data:{jsonStr:JSON.stringify(e)}})}function Bt(e){return this.fetch({method:"post",url:"api/adminMasterControl/getDetailInfo.html",data:e})}function Mt(e){return this.fetch({method:"post",url:"api/adminMasterControl/save.html",data:e})}function Ut(e){return this.fetch({method:"post",url:"api/v1/poster/pageList.html",data:e})}function Gt(e){return this.fetch({method:"get",url:"api/v1/poster/batchAudit.html",params:e})}function jt(e){return this.fetch({method:"get",url:"api/v1/poster/remove.html",params:e})}function zt(){return this.fetch({method:"post",url:"api/v1/onclickInfo/getMenuInfo.html"})}function Wt(e){return this.fetch({method:"post",url:"api/v1/onclickInfo/pageList.html",data:e})}function qt(e){return this.fetch({method:"post",url:"api/v1/onclickInfo/save.html",data:e})}function Jt(e){return this.fetch({method:"get",url:"api/v1/onclickInfo/remove.html",params:e})}function Ht(e){return this.fetch({method:"get",url:"api/v1/onclickInfo/getDetailInfo.html",params:e}).then(function(e){return e})}a("28a5");var Kt=a("768b");a("4917");function Yt(e){return this.fetch({url:"api/v1/tab/pageList.html",params:e})}function Qt(e){return this.fetch({url:"api/v1/tab/dataList.html",params:e})}function Xt(e){return this.fetch({method:"post",url:"api/v1/dict/getTypes/tab/tabType.html",data:e})}function Zt(e){return this.fetch({method:"get",url:"api/v1/getMediaResourceInfoToPanel.html",params:e,isJSON:!0})}function ea(e){return this.fetch({method:"post",url:"api/filmDetailPage/pageList.html",data:e})}function ta(e){return this.fetch({method:"post",url:"api/filmDetailPage/save.html",data:e})}function aa(e){return this.fetch({method:"get",url:"api/filmDetailPage/remove.html",params:e})}function na(){return this.fetch({method:"get",url:"api/v1/tab/getIconList.html"})}function ia(e){var t=e.id;return/^\d+$/.test(t)?this.fetch({method:"post",url:"api/v1/tab/getDetailInfo.html",params:e}):this.getThirdpartTabInfoDetail(e)}function ra(e){return this.fetch({method:"post",url:"api/v1/tab/getSimpleInfo.html",params:e})}function oa(e){return this.fetch({method:"post",url:"api/v1/tab/save.html",data:{jsonStr:JSON.stringify(e)}})}function la(e){return this.fetch({method:"post",url:"api/v1/tab/remove.html",data:e})}function sa(e){return this.fetch({method:"get",url:"api/filmDetailPage/edit.html",params:e}).then(function(e){return JSON.parse(e.match(/param = (\{.+\})/)[1])})}function ca(e){return this.fetch({method:"get",url:"api/filmDetailPage/preview.html",params:e}).then(function(e){return JSON.parse(e.match(/param = (\{.+\})/)[1])})}function ua(e){return this.fetch({method:"get",url:"api/v1/tvos/getVipButtonSource.html",params:e})}function da(e){return te()({method:"get",url:"api/v1/dataShow/tab/getSimpleBrowseData.html",params:e}).then(function(e){var t=e.data;return t.data})}function pa(e){return this.fetch({method:"get",url:"api/v1/dataShow/tab/getChartData.html",params:e})}function ha(e){var t=e.id,a=t.split("-"),n=Object(Kt["a"])(a,2),i=n[0],r=n[1];return this.fetch({method:"get",url:"api/v1/third/getV6BoardInfo.html",params:{from:i,type:r}})}function ma(e){var t=e.id,a=t.split("-"),n=Object(Kt["a"])(a,1),i=n[0];return this.fetch({method:"get",url:"api/v1/third/switchAuditMode.html",params:{from:i,enableAuto:e.enableAuto}})}function fa(e){var t=e.id,a=t.split("-"),n=Object(Kt["a"])(a,1),i=n[0];return this.fetch({method:"get",url:"api/v1/third/execAudit.html",params:{from:i}})}function va(){return this.fetch({method:"get",url:"api/v1/third/getLayout.html?layoutModel=Expander&width=522&height=295"}).then(function(e){return JSON.parse(e)})}function ga(e){return this.fetch({method:"post",url:"api/v1/panel/pageList.html",data:e})}function ba(e){return this.fetch({method:"post",url:"api/v1/panel/dataList.html",data:e})}function ya(e){return this.fetch({url:"api/v1/panel/getDetailInfo.html",params:e})}function wa(e){return this.fetch({url:"api/v1/panel/getDetailInfo.html",params:e,useLoading:!1})}function Ia(e){return this.fetch({method:"post",url:"api/v1/panel/save.html",data:{jsonStr:JSON.stringify(e)}})}function Ca(e){return this.fetch({method:"post",url:"api/v1/panel/save.html",useLoading:!1,data:{jsonStr:JSON.stringify(e)}})}function Ta(e){return this.fetch({method:"post",url:"api/v1/panel/remove.html",data:e})}function Sa(e){return this.fetch({method:"post",url:"api/v1/collect/"+e.type+"/cancel.html",data:e.data})}function ka(e){return this.fetch({method:"post",url:"api/v1/collect/"+e.type+"/collect.html",data:e.data})}function _a(e){return this.fetch({method:"get",url:"api/tvos/getMediaCommonTags.html",params:e,useLoading:!1})}function Pa(e){return this.fetch({method:"post",url:"api/tvos/updateTagWeight.html",data:e})}function xa(e){return this.fetch({method:"post",url:"api/v1/panelRecommend/pageList.html",data:e})}function Fa(e){return this.fetch({url:"api/v1/panelRecommend/getDetailInfo.html",params:e})}function Da(e){return this.fetch({method:"post",url:"api/v1/panelRecommend/save.html",data:{jsonStr:JSON.stringify(e)}})}function Ra(e){return this.fetch({method:"post",url:"api/v1/panelRecommend/switchRecommend.html",data:{jsonStr:JSON.stringify(e)}})}function La(e){return this.fetch({method:"get",url:"api/v1/panelRecommendCoreData/getDataList.html",params:e})}function $a(e){return this.fetch({method:"get",url:"api/v1/panelRecommendCoreData/getCoreData.html",params:e})}function Na(e){return this.fetch({url:"api/v1/panelRecommendCoreData/getPanelFeedBack.html",params:e})}function Ea(e){return te()({method:"get",url:"api/v1/dataShow/panel/getSimpleBrowseData.html",params:e}).then(function(e){var t=e.data;return t.data})}function Oa(e){return this.fetch({method:"get",url:"api/v1/dataShow/panel/getChartData.html",params:e})}function Aa(e){return this.fetch({method:"get",url:"api/v1/dataShow/video/getChartData.html",params:e})}function Va(e){return this.fetch({method:"get",url:"api/v1/dataShow/videoRealTime/getChartData.html",params:e})}function Ba(e){return this.fetch({method:"get",url:"api/v1/dataShow/videoDmp/getChartData.html",params:e})}function Ma(e){return this.fetch({method:"get",url:"api/v1/dataShow/videoDmpRealTime/getChartData.html",params:e})}function Ua(e){return this.fetch({method:"get",url:"api/v1/dataShow/videoDmp/getAllTitles.html",params:e})}function Ga(e){return this.fetch({method:"get",url:"api/v1/dataShow/videoDmp/getAllCrowds.html",params:e})}function ja(e){return this.fetch({method:"get",url:"api/tvos/getPartnerSource",params:e})}function za(e){return this.fetch({method:"get",url:"api/tvos/getCondition",params:e})}function Wa(e){return this.fetch({method:"get",url:"api/tvos/getMediaBlockVideoList",params:e})}function qa(e){return this.fetch({method:"get",url:"api/v1/dict/getTypes/mediaRuleLayout.html",params:e})}function Ja(e){return this.fetch({method:"get",url:"api/v1/dict/getTypes/fillType.html",params:e})}function Ha(e){return this.fetch({method:"post",url:"api/v1/dict/getTypes/focusCategory",data:e})}function Ka(e){return this.fetch({method:"get",url:"api/v1/dict/getDictCorner",params:e})}function Ya(e){return this.fetch({method:"get",url:"api/tvos/getVectorTag",params:e})}function Qa(e){return this.fetch({method:"post",url:"api/v1/homepage/pageList.html",data:e})}function Xa(e){return this.fetch({method:"post",url:"api/v1/homepage/save.html",data:{jsonStr:JSON.stringify(e)}})}function Za(e){return this.fetch({url:"api/v1/homepage/remove.html",params:e})}function en(e){return this.fetch({method:"get",url:"api/v1/homepage/getDetailInfo.html",params:e})}a("a481");function tn(e){var t,a=e.tagCodes||[];if(a.length>0&&(delete e.tagCodes,t=a.map(function(e){return"tagCodes=".concat(e)}).join("&")),"coocaaRanking"===e.dataType){var n=e.businessType,i={60:1,61:2,32:3};[60,61,32].includes(n)&&(e.businessType=i[n]),1===e.businessType?e.partner="tencent":delete e.businessType}return this.fetch({methods:"get",url:"api/tvos/getMediaVideoInfos.html".concat(t?"?"+t:""),params:e}).then(function(e){return"string"===typeof e?JSON.parse(e.replace("result(","").replace(/\)*$/,"")):e})}function an(e){return this.fetch({methods:"get",url:"api/tvos/getPartnerSource.html",params:e})}function nn(){return this.fetch({methods:"get",url:"api/tvos/getCondition.html"}).then(function(e){return"string"===typeof e?JSON.parse(e.replace("result(","").replace(/\)*$/,"")):e})}function rn(e){return this.fetch({methods:"get",url:"api/tvos/getSegmentList.html",params:e}).then(function(e){return"string"===typeof e?JSON.parse(e.replace("result(","").replace(/\)*$/,"")):e})}function on(e){return this.fetch({methods:"get",url:"api/v1/appManagement/pageList.html",params:e})}function ln(e){return this.fetch({method:"post",url:"api/v1/panel/pageList.html",data:e})}function sn(e){return this.fetch({method:"post",url:"api/v1/panel/save.html",data:e})}function cn(e){return this.fetch({method:"get",url:"api/v1/panel/remove.html",params:e})}function un(e){return this.fetch({method:"get",url:"api/v1/panel/getDetailInfo.html",params:e})}function dn(e){return this.fetch({method:"post",url:"api/v1/timedTask/getTimedInfo.html",data:e})}function pn(e){return this.fetch({method:"get",url:"api/v1/audit/historyList.html",params:e})}function hn(e){return this.fetch({method:"post",url:"api/v1/cornerIconType/pageList.html",data:e})}function mn(e){return this.fetch({method:"post",url:"api/v1/cornerIconType/remove.html",data:e})}function fn(e){return this.fetch({method:"post",url:"api/v1/cornerIconType/save.html",data:{jsonStr:JSON.stringify(e)}})}function vn(e){return this.fetch({method:"get",url:"api/v1/cornerIconType/getDetailInfo.html",params:e})}function gn(e){return this.fetch({url:"api/v1/layout/pageList.html",params:e})}function bn(e){return this.fetch({method:"post",url:"api/v1/layout/remove.html",data:e})}function yn(e){return this.fetch({method:"post",url:"api/v1/layout/save.html",data:e})}function wn(e){return this.fetch({method:"get",url:"api/v1/layout/getDetailInfo.html",params:e})}function In(e){return this.fetch({method:"post",url:"api/v1/layout/getUI8ToUI6.html",data:e}).then(function(e){return JSON.parse(e)})}function Cn(e){return this.fetch({method:"post",url:"api/v1/buttonManage/getAuditDetailButton.html",data:e})}function Tn(e){return this.fetch({method:"post",url:"api/v1/audit/auditTask.html",data:e})}function Sn(e){return this.fetch({method:"post",url:"api/v1/audit/revokedAudit.html",data:e})}function kn(e){return this.fetch({method:"post",url:"api/v1/audit/putShelves.html",data:e})}function _n(e){return this.fetch({method:"post",url:"api/v1/theme/pageList.html",data:e})}function Pn(e){return this.fetch({method:"get",url:"api/v1/theme/remove.html",params:e})}function xn(e){return this.fetch({method:"get",url:"api/v1/theme/getDetailInfo.html",params:e})}function Fn(e){return this.fetch({method:"post",url:"api/v1/theme/save.html",data:e})}function Dn(e){return this.fetch({method:"post",url:"api/v1/theme/checkThemeMd5.html",data:e})}function Rn(e){return this.fetch({url:"api/v1/poster/save.html",method:"post",data:e})}function Ln(e){return this.fetch({url:"api/v1/poster/getDetailInfo.html",method:"get",params:e})}function $n(e){return this.fetch({method:"get",url:"api/v1/cornerIcon/pageList.html",params:e})}function Nn(e){return this.fetch({method:"get",url:"api/v1/cornerIconType/getCornerTypes.html",params:e})}function En(e){return this.fetch({method:"post",url:"api/v1/cornerIcon/getIconAttributes.html",params:e})}function On(e){return this.fetch({method:"get",url:"api/v1/cornerIcon/getDetailInfo.html",params:e})}function An(e){return this.fetch({method:"post",url:"api/v1/cornerIcon/save.html",data:{jsonStr:JSON.stringify(e)}})}function Vn(e){return this.fetch({method:"get",url:"api/v1/cornerIcon/remove.html",params:e})}function Bn(e){return this.fetch({method:"get",url:"api/v1/cornerIcon/batchAudit.html",params:e})}function Mn(e){return this.fetch({method:"post",url:"api/v1/audit/revokedAudit.html",data:e})}function Un(e){return this.fetch({method:"get",url:"api/v1/cornerIcon/getDetailInfo.html",params:e})}function Gn(e){return this.fetch({method:"get",url:"api/v1/cornerIcon/changePriority.html",params:e})}function jn(){return this.fetch({url:"api/v1/adBlock/pageList.html?rows=10000"})}function zn(e){return this.fetch({method:"post",url:"api/v1/adBlock/switchStatus.html",data:e})}function Wn(e){return this.fetch({method:"get",url:"api/v1/hvi/historyList.html",params:e})}function qn(e){return this.fetch({method:"get",url:"api/v1/panel/remove.html",params:e})}function Jn(e){return this.fetch({method:"post",url:"api/v1/"+e+"/getTotal.html"})}function Hn(e){return this.fetch({method:"post",url:"api/v1/"+e.type+"/pageList.html",data:e})}function Kn(e){return this.fetch({method:"post",url:"api/v1/msn/pageList.html",data:e})}function Yn(e){return this.fetch({method:"post",url:"api/v1/policyConf/pageList.html",data:e})}function Qn(e){return this.fetch({method:"post",url:"api/v1/childPolicy/pageList.html",data:e})}function Xn(e){return this.fetch({method:"post",url:"api/v1/testPolicyConf/pageList.html",data:e})}function Zn(e){return this.fetch({method:"post",url:"api/v1/device/dataList.html",data:e})}function ei(e){return this.fetch({method:"post",url:"api/v1/device/save.html",data:e})}function ti(e){return this.fetch({method:"post",url:"api/v1/homepage/dataList.html",data:e})}function ai(e){return this.fetch({method:"post",url:"api/v1/policyConf/save.html",data:e})}function ni(e){return this.fetch({method:"post",url:"api/v1/testPolicyConf/save.html",data:e})}function ii(e){return this.fetch({method:"post",url:"api/v1/childPolicy/save.html",data:e})}function ri(e){return this.fetch({method:"post",url:"api/v1/policyConf/remove.html",data:e})}function oi(e){return this.fetch({method:"post",url:"api/v1/testPolicyConf/remove.html",data:e})}function li(e){return this.fetch({method:"get",url:"api/v1/policyConf/getDetailInfo.html",params:e})}function si(e){return this.fetch({method:"get",url:"api/v1/testPolicyConf/getDetailInfo.html",params:e})}function ci(e){return this.fetch({method:"get",url:"api/v1/childPolicy/getDetailInfo.html",params:e})}function ui(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.fetch({url:"api/v1/sysPlugin/pageList.html",params:Object.assign({pluginStatus:4,pluginType:"REFERENCE_ACTIVITY"},e)})}function di(e){return e.reduce(function(e,t){var a=t.label,n=t.value;return e[n]=a,e},{})}function pi(e){return e.reduce(function(e,t){return e[t.label]=t.value,e},{})}var hi={offShelves:0,onShelves:1,draft:2,waiting:3,accepted:4,rejected:5,auditing:6,processing:7,waiting2:9},mi={0:"下架",1:"上架",2:"草稿",3:"待审核",4:"审核通过",5:"审核不通过",6:"审核中",7:"审核通过未上线",9:"待二次审核"},fi=Object.keys(mi).reduceRight(function(e,t){return t<6&&e.push({label:mi[t],value:t}),e},[]),vi=Object.keys(mi).reduceRight(function(e,t){return t<6&&(e[mi[t]]=t),e},{}),gi=[{label:"腾讯",value:"o_tencent"},{label:"爱奇艺",value:"o_iqiyi"},{label:"优酷",value:"o_youku"}],bi=pi(gi),yi=[{label:"无",value:""}].concat(gi),wi=[{label:"无",value:"none"}].concat(gi),Ii=pi(wi),Ci={o_tencent:"tencent",o_iqiyi:"yinhe",o_youku:"youku"},Ti={tencent:"o_tencent",yinhe:"o_iqiyi",youku:"o_youku"},Si={o_tencent:"腾讯",o_iqiyi:"爱奇艺",o_youku:"优酷"},ki={none:"无",o_tencent:"腾讯",o_iqiyi:"爱奇艺",o_youku:"优酷"},_i=[{label:"无",value:0},{label:"腾讯",value:1},{label:"爱奇艺",value:2},{label:"优酷",value:3}],Pi=di(_i),xi=pi(_i),Fi={o_tencent:"_otx_",o_iqiyi:"_oqy_",o_youku:"_oyk_"},Di=[{label:"腾讯",value:"tencent"},{label:"爱奇艺",value:"yinhe"},{label:"优酷",value:"youku"}],Ri=di(Di),Li=pi(Di),$i=[{label:"腾讯",value:"tencent"},{label:"爱奇艺",value:"yinhe"},{label:"优酷",value:"youku"},{label:"优朋",value:"voole"}],Ni=di($i),Ei=pi($i),Oi=[{label:"普通版块",value:"normal"},{label:"分组版块",value:"group"},{label:"预约版块",value:"subscribe"},{label:"标签流版块",value:"tag"}],Ai=di(Oi),Vi=[{label:"运营手动填充",value:1},{label:"用排行榜填充",value:2},{label:"用影片筛选规则填充",value:3},{label:"用推荐流填充",value:4}],Bi=di(Vi),Mi={manual:1,ranking:2,mediaRule:3,recStream:4},Ui=[{label:"面落焦",value:1},{label:"线落焦",value:0}],Gi=di(Ui),ji=[{label:"标签页访问历史",value:1},{label:"常规标签推荐算法（不区分分类）",value:2},{label:"常规标签推荐算法（电影）",value:3},{label:"常规标签推荐算法（电视剧）",value:4},{label:"常规标签推荐算法（综艺）",value:5},{label:"常规标签推荐算法（动漫）",value:6}],zi=di(ji),Wi=[{label:"左上",value:0},{label:"右上",value:1},{label:"右下",value:2},{label:"左下",value:3}],qi=pi(Wi),Ji=di(Wi),Hi=[{label:"标记话题",value:1},{label:"普通话题",value:2}],Ki=di(Hi),Yi=pi(Hi),Qi="10",Xi=[{label:"酷开",value:"10"},{label:"江苏有线",value:"11"}],Zi=pi(Xi),er=[{label:"普通",value:"normal"},{label:"少儿",value:"child"},{label:"电影",value:"movie"},{label:"电视剧",value:"series"}],tr=di(er),ar=[{label:"媒体资源",value:"media"},{label:"应用圈",value:"app"},{label:"自定义",value:"custom"},{label:"商品",value:"mall"},{label:"推荐位管理",value:"block"},{label:"生活方式资源",value:"maskLife"},{label:"广电直播app",value:"tvLive"}],nr=di(ar),ir={status:hi,statusText:mi,statusOptions:fi,statusEnums:vi,sourceOptions:gi,sourceEnums:bi,sourceOptionsWithNoneEnums:Ii,sourceOptionsWithEmpty:yi,sourceOptionsWithNone:wi,sourceToPartner:Ci,partnerToSource:Ti,sourceText:Si,sourceTextWithNone:ki,sourceNumberOptions:_i,sourceNumberText:Pi,sourceNumberEnums:xi,partnerOptions:Di,partnerText:Ri,partnerEnums:Li,panelFocusOptions:Ui,panelFocusText:Gi,panelTypeOptions:Oi,panelTypeText:Ai,panelFillTypeOptions:Vi,panelFillTypeText:Bi,panelFillTypes:Mi,panelTagAlgorithmOptions:ji,panelTagAlgorithmText:zi,cornerIconPositionOptions:Wi,cornerIconPositionEnums:qi,cornerIconPositionText:Ji,topicTypesOptions:Hi,topicTypesText:Ki,topicTypesEnum:Yi,idPrefix:Qi,idPrefixOptions:Xi,idPrefixEnums:Zi,optionsToEnums:pi,optionsToText:di,sourcePrefix:Fi,platformOptions:$i,platformText:Ni,platformEnums:Ei,blockRecStreamTypeOptions:er,blockRecStreamTypeText:tr,panelCoverTypeOptions:ar,panelCoverTypeText:nr};function rr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.rows=e.rows||100,this.fetch({method:"get",url:"api/v1/hvi/historyList.html",params:e}).then(function(e){var t=e.rows||[];return t.map(function(e){var t=e.version,a=e.createdDate,n=e.launchDate,i=e.modifierName,r=e.status,o="string"===typeof a?"创建："+a.slice(a.indexOf("-")+1):"创建：",l="string"===typeof n?"上线："+n.slice(n.indexOf("-")+1):"未上线";return{row:e,value:e.version,label:"".concat(t,"/").concat(o,"/").concat(l,"/").concat(i,"/").concat(ir.statusText[r])}})})}function or(e){return this.fetch({method:"post",url:"api/v1/audit/revokedAudit.html",data:e})}function lr(e){return this.fetch({method:"post",url:"api/secondAudit/audit.html",data:e})}function sr(){return this.fetch({url:"api/v1/timedTask/taskLimit.html"})}function cr(e){return this.fetch({url:"api/v1/timedTask/getTimedInfo.html",params:e})}function ur(e){return this.fetch({url:"api/v1/timedTask/cancelTimedTask.html",params:e})}function dr(e){return this.fetch({method:"post",url:"api/v1/audit/putShelves.html",data:e})}var pr={homepage:"api/v1/homepage/delHistory.html",pannel:"api/v1/panel/delHistory.html",tab:"api/v1/tab/delHistory.html",theme:"api/v1/theme/delHistory.html",policy:"api/v1/policyConf/delHistory.html",testPolicy:"api/v1/testPolicyConf/delHistory.html",childPolicy:"api/v1/childPolicyConf/delHistory.html",material:"",layout:"",block:"api/v1/blockInfo/delHistory.html",systemPlugin:"api/v1/sysPlugin/delHistory.html",topic:"api/v1/topic/delHistory.html",topicConfig:"api/v1/topicConfig/delHistory.html",mediaAutomation:"api/v1/mediaAutomation/delHistory.html",icon:"api/v1/cornerIcon/remove.html",policyGroup:"api/v1/policyGroup/delHistory.html"};function hr(e){return this.fetch({url:pr[e.type],params:{id:e.id,version:e.version}})}var mr={homepage:"api/v1/homepage/remove.html",markPanel:"api/v1/panel/remove.html",multiFunctionBlock:"api/v1/sysPlugin/remove.html",sysPlugin:"api/v1/sysPlugin/remove.html",crowdRel:"api/v1/dmpMgr/remove.html",topic:"api/v1/topic/remove.html",topicConfig:"api/v1/topicConfig/remove.html",mediaAutomation:"/v1/mediaAutomation/remove.html",icon:"api/v1/cornerIcon/remove.html",policyGroup:"api/v1/policyGroup/remove.html"};function fr(e){return this.fetch({url:mr[e.type],params:{id:e.id}})}function vr(e){return this.fetch({url:"api/v1/audit/historyList.html",params:e})}var gr={};function br(e){var t=e.type,a=e.isFilter,n=a?"".concat(t,"_filtered"):t,i=gr[n];return i?Promise.resolve(i):this.fetch({method:"post",url:"api/v1/dict/getTypes/"+t+".html",data:{isFilter:a}}).then(function(e){return gr[n]=e,e})}function yr(){return this.fetch({method:"get",url:"api/v1/getEnvironment.html"})}function wr(){return this.fetch({url:"api/dict/recommendStrategy.html"})}function Ir(e){return this.fetch({method:"post",url:"api/v1/collect/".concat(e.type,"/pageList.html"),data:e.data}).then(function(e){return e.rows&&e.rows.forEach(function(e){e.collected=1}),e})}function Cr(e){return this.fetch({method:"post",url:"api/v1/tab/save.html",data:e})}function Tr(e){return this.fetch({method:"post",url:"api/v1/tab/remove.html",data:e})}function Sr(e){return this.fetch({method:"get",url:"api/v1/tab/getDetailInfo.html",params:e})}function kr(e){return this.fetch({method:"post",url:"api/v1/commonResourceUser/tab/collectResource.html",data:e})}function _r(e){return this.fetch({method:"post",url:"api/v1/commonResourceUser/tab/cancelCollectResource.html",data:e})}function Pr(e){return this.fetch({method:"get",url:"api/tvos/queryPPTVVideoResult.html?callbackparam=result",params:e}).then(function(e){return"string"===typeof e?JSON.parse(e.replace("result(","").replace(/\)*$/,"")):e})}function xr(e){return this.fetch({url:"api/tvos/getCondition.html",params:e}).then(function(e){return"string"===typeof e?JSON.parse(e.replace("result(","").replace(/\)*$/,"")):e})}function Fr(e){return this.fetch({method:"get",url:"api/tvos/getMediaTagList.html?tagCode=",params:e}).then(function(e){var t=e.data;return t})}function Dr(e){return this.fetch({method:"get",url:"api/tvos/getMediaCategoryList.html",params:e}).then(function(e){var t=e.data;return t})}function Rr(e){return this.fetch({method:"get",url:"api/tvos/getMediaAuthorList.html",params:e}).then(function(e){var t=e.data;return t=t||{},{rows:t.authors||[],total:t.total,page:t.pageIndex}})}function Lr(e){return this.fetch({method:"get",url:"api/tvos/getMediaBriefVideoList.html",params:e}).then(function(e){var t=e.data;return t=t||{},{rows:t.videos||[],total:t.total,page:t.pageIndex}})}function $r(e){return 60===e.businessType&&(e.partner="tencent"),this.fetch({method:"get",url:"api/tvos/getRankInfoVideoList.html",params:{code:e.code,partner:e.partner}}).then(function(e){var t=e.data;return t})}function Nr(e){var t=e.page,a=void 0===t?1:t,n=e.rows;return e.pageIndex=a-1,e.pageSize=n,delete e.page,delete e.rows,this.fetch({method:"get",url:"api/live/tvos/getChannelInfos",params:e}).then(function(e){var t=e.data;return t=t||{},{rows:t.channelList||[],total:t.channelTotal,page:t.pageIndex}})}function Er(e){var t=e.page,a=void 0===t?1:t,n=e.rows;return e.pageIndex=a-1,e.pageSize=n,delete e.page,delete e.rows,this.fetch({method:"get",url:"api/live/tvos/getScheduleInfos",params:e}).then(function(e){var t=e.data;return t=t||{},{rows:t.scheduleList||[],total:t.scheduleTotal,page:t.pageIndex}})}function Or(){return Promise.resolve([{value:11,label:"北京市"},{value:12,label:"天津市"},{value:13,label:"河北省"},{value:14,label:"山西省"},{value:15,label:"内蒙古自治区"},{value:21,label:"辽宁省"},{value:22,label:"吉林省"},{value:23,label:"黑龙江省"},{value:31,label:"上海市"},{value:32,label:"江苏省"},{value:33,label:"浙江省"},{value:34,label:"安徽省"},{value:35,label:"福建省"},{value:36,label:"江西省"},{value:37,label:"山东省"},{value:41,label:"河南省"},{value:42,label:"湖北省"},{value:43,label:"湖南省"},{value:44,label:"广东省"},{value:45,label:"广西壮族自治区"},{value:46,label:"海南省"},{value:50,label:"重庆市"},{value:51,label:"四川省"},{value:52,label:"贵州省"},{value:53,label:"云南省"},{value:54,label:"西藏自治区"},{value:61,label:"陕西省"},{value:62,label:"甘肃省"},{value:63,label:"青海省"},{value:64,label:"宁夏回族自治区"},{value:65,label:"新疆维吾尔自治区"},{value:71,label:"中国台湾"},{value:81,label:"中国香港"},{value:82,label:"中国澳门"}])}function Ar(e){var t=new FormData;return t.append("jsonStr",JSON.stringify(e)),this.fetch({method:"post",url:"api/v1/dmpMgr/save.html",data:t,isJSON:!0})}function Vr(e){return this.fetch({url:"api/v1/dmpMgr/getDetailInfo.html",params:e})}function Br(e){return this.fetch({url:"api/v1/dmpMgr/remove.html",params:e})}function Mr(){return this.fetch({url:"api/v1/dmpMgr/loadDmpData.html"})}function Ur(e){return this.fetch({url:"api/v1/dmpMgr/listCrowdRelationship.html",params:e})}var Gr={fetchPolicyPromise:void 0,fetchCrowdPromise:{}};function jr(e){var t=e.id;return Gr.fetchCrowdPromise[t]||(Gr.fetchCrowdPromise[t]=this.getCrowdOfPolicy({id:t})),Gr.fetchCrowdPromise[t]}function zr(e){return this.fetch({method:"get",url:"api/v1/tag/list.html",params:e})}function Wr(e){return this.fetch({method:"get",url:"api/v1/tag/listCrowdPolicy.html",params:e})}function qr(e){var t=e.id;return this.getTaglist({id:t,type:"crowd"})}function Jr(){return this.getTaglist({type:"crowdPolicy"})}function Hr(e){return this.fetch({url:"api/v1/sysContentAuthMgr/getUserContentAuth.html",params:e})}function Kr(e){return this.fetch({url:"api/v1/sysContentAuthMgr/listResourceContentAuth.html",params:e})}function Yr(e){var t=new FormData;return t.append("jsonStr",JSON.stringify(e)),this.fetch({method:"post",url:"api/v1/sysContentAuthMgr/save.html",data:t,isJSON:!0})}function Qr(){return this.fetch({method:"post",url:"api/dataSync/getSwitcherInfo.html"}).then(function(e){var t=e.isOn;return{isOn:!t}})}function Xr(e){return this.fetch({url:"api/dataSync/manualIsOn.html",params:{enableManualOn:e.enableManualOn?"false":"true"}})}function Zr(){return this.fetch({url:"api/secondAudit/getTotalInfo.html"})}function eo(e){return this.fetch({url:"api/secondAudit/pageList.html",params:e})}function to(e){return this.fetch({url:"api/v1/topic/pageList.html",params:e})}function ao(e){return this.fetch({url:"api/v1/topic/getDetailInfo.html",params:e})}function no(e){return this.fetch({method:"post",url:"api/v1/topic/save.html",data:{jsonStr:JSON.stringify(e)}})}function io(e){return this.fetch({url:"api/v1/topicConfig/pageList.html",params:e})}function ro(e){return this.fetch({url:"api/v1/topicConfig/getDetailInfo.html",params:e})}function oo(e){return this.fetch({method:"post",url:"api/v1/topicConfig/save.html",data:{jsonStr:JSON.stringify(e)}})}function lo(e){return this.fetch({url:"api/v1/mall/pageList.html",params:e})}function so(e){return e=Z.a.stringify({jsonStr:JSON.stringify({type:"click",name:e.type,data:e.payload})}),te()({method:"post",url:"api/v1/syslog/addLog.html",data:e}).catch(function(){})}function co(e){return this.fetch({url:"api/v1/tabForceInsert/pageList.html",params:e})}function uo(e){return this.fetch({url:"api/v1/tabForceInsert/getDetailInfo.html",params:e})}function po(e){return this.fetch({method:"post",url:"api/v1/tabForceInsert/save.html",data:{jsonStr:JSON.stringify(e)}})}function ho(e){return this.fetch({method:"post",url:"api/v1/tabForceInsert/enableTask.html",data:{jsonStr:JSON.stringify(e)}})}function mo(e){return this.fetch({url:"api/v1/deviceConfig/pageList.html",params:e})}function fo(e){return this.fetch({url:"api/v1/deviceConfig/getDetailInfo.html",params:e})}function vo(e){return this.fetch({method:"post",url:"api/v1/deviceConfig/save.html",data:{jsonStr:JSON.stringify(e)}})}function go(e){return this.fetch({url:"api/v1/policyGroup/pageList.html",params:e})}function bo(e){return this.fetch({method:"post",url:"api/v1/policyGroup/save.html",data:{jsonStr:JSON.stringify(e)}})}function yo(e){return this.fetch({url:"api/v1/policyGroup/getDetailInfo.html",params:e})}function wo(e){return this.fetch({url:"api/v1/policyGroup/listPolicyGroupByModelChip.htm",params:e})}function Io(e){return this.fetch({method:"post",url:"api/v1/policyGroup/remove.html",data:e})}function Co(e){return this.fetch({url:"api/v1/policyGroup/matchHomepage.html",params:e})}function To(e){return this.fetch({url:"api/v1/bigDataRec/getRecList",params:e})}var So=Object(Q["a"])({state:{},fetch:ae},n,i,T,r,o,l,s,c,u,p,h,m,f,v,g,b,y,w,I,C,d,S,k,_,P,x,F,D,R,L,$,N,E,O,A,V,B,M,U,G,j);function ko(e){var t={};Object.keys(So).forEach(function(a){"function"===typeof So[a]?t[a]=function(){var t=Object(Y["a"])(regeneratorRuntime.mark(function t(n,i){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",So[a](n).then(function(t){return i&&e.prototype.$notify({title:"操作成功",type:"success",message:i}),t}).catch(function(t){if(!t.request||401!==t.request.status)return e.prototype.$notify({title:"操作失败",type:"error",message:t.message}),Promise.reject(t);location.href=location.origin+location.pathname}));case 1:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}():t[a]=So[a]}),e.prototype.$service=t}a("0fae");var _o=new z["default"];Object.defineProperties(z["default"].prototype,{$bus:{get:function(){return _o}}}),Object.defineProperties(z["default"].prototype,{$getMenu:{get:function(){}}});var Po={};function xo(){var e;do{e=""+Date.now()+Math.random()}while(Po[e]);return e}function Fo(e){e.stopPropagation();var t=e.currentTarget,a=t.dataset.shadowDragId,n=Po[a],i=n.binding,r=i.value;e.dataTransfer.setData("text/plain",JSON.stringify(r)),t.dispatchEvent(new Event("shadow-drag-start"))}function Do(e){e.currentTarget.dispatchEvent(new Event("shadow-drag-end"))}var Ro={bind:function(e,t,a){if(t){var n=xo();Po[n]={binding:t,vnode:a},e.dataset.shadowDragId=n,e.addEventListener("dragstart",Fo),e.addEventListener("dragend",Do),e.setAttribute("draggable",!0)}},inserted:function(e,t,a){},update:function(e,t,a){var n=e.dataset.shadowDragId,i=Po[n];i.binding=t},unbind:function(e,t,a){var n=e.dataset.shadowDragId;delete Po[n],e.removeEventListener("dragstart",Fo),e.removeEventListener("dragend",Do)}};function Lo(e,t){var a=e.value,n=e.arg,i=void 0===n?"input":n,r="string"===typeof a?{title:"提示",message:a}:a,o=t.componentInstance,l=o.$listeners[i],s=o.$attrs["no-input-confirm"],c=l.fns;l.fns=function(){var e=this,t=arguments;s?c.apply(this,arguments):q["MessageBox"].confirm(void 0,void 0,r).then(function(){c.apply(e,t)}).catch(function(){})}}var $o={bind:function(e,t,a){Lo(t,a)},update:function(e,t,a){Lo(t,a)}};a("7f7f");function No(e,t){var a=document.createElement("iframe");a.setAttribute("name",e),a.setAttribute("src",t),a.style.display="none",document.body.appendChild(a)}function Eo(e,t){return{bind:function(a,n,i){var r=i.elm;"FORM"!==r.tagName&&(r=r.querySelector("form")),r&&(r.setAttribute("target",e),r.setAttribute("action",t))}}}var Oo={install:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.name,n=void 0===a?"form-autocomplete-iframe":a,i=t.target,r=void 0===i?"blank.html":i;No(n,r),e.directive("form-autocomplete",Eo(n,r))}},Ao=a("0754"),Vo=a.n(Ao),Bo=(a("616e"),a("59c7"));a("ed2c");function Mo(e){return e.$service.getEnv().then(function(t){if(e.$consts.idPrefix=t.idPrefix,t.userInfo){var a=t.userInfo.loginName;e.$appState.user={name:a}}})}z["default"].prototype.$isLoggedIn=Object(Y["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.$appState,!t.user){e.next=3;break}return e.abrupt("return");case 3:return e.abrupt("return",Mo(this).then(function(){if(!t.user)throw new Error("ERR_NOT_LOGIN")}));case 4:case"end":return e.stop()}},e,this)})),z["default"].prototype.$login=function(){var e=Object(Y["a"])(regeneratorRuntime.mark(function e(t){var a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.$service.login(t).then(function(e){var n={name:t.username};return a.$service.state=n,a.$appState.user=n,a.$appState.$set("user",n),Mo(a)}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),z["default"].prototype.$logout=Object(Y["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.$appState.user=void 0,this.$appState.$remove("user"),e.abrupt("return",this.$service.logout());case 3:case"end":return e.stop()}},e,this)}));var Uo=a("7618"),Go=a("2ef0"),jo=a.n(Go),zo={};z["default"].prototype.$utils=zo,zo.cloneDeep=jo.a.cloneDeep,z["default"].prototype.$isAllowEdit=function(e){return 1===e.length||(this.$message("请选择一条数据进行编辑"),!1)},z["default"].prototype.$isAllowDelete=function(e){return 0!==e.length||(this.$message("请选择数据后进行操作"),!1)},z["default"].prototype.$status=function(){return{"草稿":2,"待审核":3,"审核通过":4,"审核不通过":5}},z["default"].prototype.$baseStatus=function(){return{"待审核":3,"审核通过":4,"审核不通过":5}},z["default"].prototype.$numToAuditStatus=function(e){var t="";if("number"===typeof e)switch(e){case 0:t="下架";break;case 1:t="上架";break;case 2:t="草稿";break;case 3:t="待审核";break;case 4:t="审核通过";break;case 5:t="审核不通过";break;case 6:t="审核中";break;case 7:t="审核通过未上线";break;case 9:t="待二次审核";break;default:t="未知"}return t},z["default"].prototype.$regParenthesesContent=function(e){return e.match(/([^\(\)]+)(?=\))/g)},z["default"].prototype.deepClone=function(e){var t,a=this;switch(Object(Uo["a"])(e)){case"undefined":break;case"string":t=e+"";break;case"number":t=e-0;break;case"boolean":t=e;break;case"object":if(null===e)t=null;else if(e instanceof Array){t=[];for(var n=0,i=e.length;n<i;n++)t.push(a.deepClone(e[n]))}else for(var r in t={},e)t[r]=a.deepClone(e[r]);break;default:t=e;break}return t},z["default"].prototype.$numToReviewPriority=function(e){var t;if("number"===typeof e)switch(e){case 1:t="一般";break;case 2:t="重要";break;case 3:t="紧急";break;default:t="未知"}return t},z["default"].prototype.$numToTaskStatus=function(e){var t;if("number"===typeof e)switch(e){case 1:t="进行中";break;case 2:t="终止";break;case 3:t="结束";break;case 4:t="失效";break;default:t="未知"}return t},z["default"].prototype.$platform=function(e){switch(e){case"yinhe":return"爱奇艺";case"tencent":return"腾讯";case"voole":return"优朋";case"youku":return"优酷"}},z["default"].prototype.$checkMacType=function(e,t,a){""===t&&a(),t=t.replace(/(^\s*)|(\s*$)/g,"");var n=/^[a-zA-Z0-9]{12}$/;n.test(t)?a():a(new Error("请输入12位的MAC地址"))},z["default"].prototype.$getFilterSelectField=function(e,t,a){return e.reduce(function(e,n){return e[n[t]]=n[a],e},{})},z["default"].prototype.$sourceName=function(e){var t={yinhe:"爱奇艺",o_iqiyi:"爱奇艺",qq:"腾讯",o_tencent:"腾讯",o_youku:"优酷",tencent:"腾讯",o_voole:"优朋",voole:"优朋",voolesohu:"优朋搜狐"};return t[e]},z["default"].prototype.$changeKeyToValue=function(e){var t=Object.keys(e);return t.reduce(function(t,a){return t[e[a]]=a,t},{})},z["default"].prototype.$validateId=function(e){var t=/^\+?[1-9][0-9]*$/,a="";return e instanceof Array?(e.forEach(function(n){void 0===n.value||""===jo.a.trim(e)||t.test(n.value)||(""===a?a=n.label:a+=","+n.label)}),""!==a&&(a+="只能是正数字")):void 0===e||""===jo.a.trim(e)||t.test(e)||(a="ID只能是正数字"),""===a||(this.$message({type:"error",message:a}),!1)},z["default"].prototype.$sendEvent=function(e){this.$service.sendEvent(e)};var Wo=a("5eb0");z["default"].use(J.a,{size:"small",zIndex:3e3}),z["default"].use(K.a),z["default"].use(J.a),z["default"].use(Vo.a),z["default"].use(ko),z["default"].use(Oo),z["default"].component("GateSchemaForm",Bo["GateSchemaForm"]),z["default"].component("ContentCard",Wo["a"]),z["default"].component("DataForm",Bo["DataForm"]),z["default"].component("DataBoolean",Bo["Boolean"]),z["default"].component("DataString",Bo["String"]),z["default"].component("DataNumber",Bo["Number"]),z["default"].component("DataEnum",Bo["Enum"]),z["default"].component("DataEnumList",Bo["EnumList"]),z["default"].component("DataAny",Bo["Any"]),z["default"].directive("shadow-drag",Ro),z["default"].directive("input-confirm",$o),z["default"].prototype.$consts=ir;var qo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},Jo=[],Ho={name:"app"},Ko=Ho,Yo=a("2877"),Qo=Object(Yo["a"])(Ko,qo,Jo,!1,null,null,null),Xo=Qo.exports,Zo=a("8c4f"),el=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-row",{staticStyle:{margin:"auto"}},[n("el-col",{staticClass:"login-form",attrs:{span:6,offset:9}},[n("div",{staticClass:"log_center"},[n("div",{staticClass:"log_bj"},[n("div",{staticClass:"log_logo"},["11"==e.$consts.idPrefix?n("img",{attrs:{src:a("7efd")}}):n("img",{attrs:{src:a("a82c")}}),n("span",[e._v("内容运营平台")])]),n("div",{staticClass:"log-box"},[n("div",{attrs:{id:"accout"}},[n("el-row",[n("el-col",{attrs:{span:11}},[n("el-button",{class:{active:e.isNormalActive},on:{click:function(t){return e.changAccoutType("normal")}}},[e._v("普通账号")])],1),n("el-col",{attrs:{span:11,offset:2}},[n("el-button",{class:{active:e.isDomainActive},on:{click:function(t){return e.changAccoutType("domain")}}},[e._v("域账号")])],1)],1)],1),n("GateSchemaForm",{ref:"loginForm",attrs:{schema:e.formSchema},on:{submit:e.handleLogin},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.$refs.loginForm.handleSubmit()}},model:{value:e.user,callback:function(t){e.user=t},expression:"user"}}),n("el-button",{staticClass:"login-form__btn",attrs:{type:"primary"},on:{click:function(t){return e.$refs.loginForm.handleSubmit()}}},[e._v("登 录")])],1)])])]),n("div",{staticStyle:{width:"100%",height:"700px"},attrs:{id:"container"}},[n("div",{attrs:{id:"anitOut"}})])],1)},tl=[],al=(a("8449"),a("1157")),nl=a.n(al),il=(a("6c7b"),a("6b54"),a("63d9"),window.CAV={FRONT:0,BACK:1,DOUBLE:2,SVGNS:"http://www.w3.org/2000/svg"});function rl(){nl()(function(){if(nl()("#container").css({width:nl()(window).width(),height:nl()(window).height()}),nl()(window).bind("resize",function(){nl()("#container").css({width:nl()(window).width(),height:nl()(window).height()})}),!window.ActiveXObject&&document.createElement("canvas").getContext){var e,t,a,n,i,r,o,l=function(){s(),u(),d(),p(),g(),h(_.offsetWidth,_.offsetHeight),m()},s=function(){o=new CAV.CanvasRenderer,c(C.renderer)},c=function(e){switch(t&&P.removeChild(t.element),e){case I:t=o;break}t.setSize(_.offsetWidth,_.offsetHeight),P.appendChild(t.element)},u=function(){a=new CAV.Scene},d=function(){var e,o;for(a.remove(n),t.clear(),i=new CAV.Plane(y.width*t.width,y.height*t.height,y.segments,y.slices),r=new CAV.Material(y.ambient,y.diffuse),n=new CAV.Mesh(i,r),a.add(n),e=i.vertices.length-1;e>=0;e--)o=i.vertices[e],o.anchor=CAV.Vector3.clone(o.position),o.step=CAV.Vector3.create(Math.randomInRange(.2,1),Math.randomInRange(.2,1),Math.randomInRange(.2,1)),o.time=Math.randomInRange(0,Math.PIM2)},p=function(){var e,n;for(e=a.lights.length-1;e>=0;e--)n=a.lights[e],a.remove(n);for(t.clear(),e=0;e<w.count;e++)n=new CAV.Light(w.ambient,w.diffuse),n.ambientHex=n.ambient.format(),n.diffuseHex=n.diffuse.format(),a.add(n),n.mass=Math.randomInRange(10,100),n.velocity=CAV.Vector3.create(),n.acceleration=CAV.Vector3.create(),n.force=CAV.Vector3.create()},h=function(e,a){t.setSize(e,a),CAV.Vector3.set(S,t.halfWidth,t.halfHeight),d()},m=function t(){e=Date.now()-T,f(),v(),requestAnimationFrame(t)},f=function(){var t,n,r,o,l,s,c,u=y.depth/2;for(CAV.Vector3.copy(w.bounds,S),CAV.Vector3.multiplyScalar(w.bounds,w.xyScalar),CAV.Vector3.setZ(k,w.zOffset),o=a.lights.length-1;o>=0;o--){l=a.lights[o],CAV.Vector3.setZ(l.position,w.zOffset);var d=Math.clamp(CAV.Vector3.distanceSquared(l.position,k),w.minDistance,w.maxDistance),p=w.gravity*l.mass/d;CAV.Vector3.subtractVectors(l.force,k,l.position),CAV.Vector3.normalise(l.force),CAV.Vector3.multiplyScalar(l.force,p),CAV.Vector3.set(l.acceleration),CAV.Vector3.add(l.acceleration,l.force),CAV.Vector3.add(l.velocity,l.acceleration),CAV.Vector3.multiplyScalar(l.velocity,w.dampening),CAV.Vector3.limit(l.velocity,w.minLimit,w.maxLimit),CAV.Vector3.add(l.position,l.velocity)}for(s=i.vertices.length-1;s>=0;s--)c=i.vertices[s],t=Math.sin(c.time+c.step[0]*e*y.speed),n=Math.cos(c.time+c.step[1]*e*y.speed),r=Math.sin(c.time+c.step[2]*e*y.speed),CAV.Vector3.set(c.position,y.xRange*i.segmentWidth*t,y.yRange*i.sliceHeight*n,y.zRange*u*r-u),CAV.Vector3.add(c.position,c.anchor);i.dirty=!0},v=function(){t.render(a)},g=function(){window.addEventListener("resize",b)},b=function(e){h(_.offsetWidth,_.offsetHeight),v()},y={width:1.5,height:1.5,depth:10,segments:12,slices:6,xRange:.8,yRange:.1,zRange:1,ambient:"#ca652f",diffuse:"#FFFFFF",speed:2e-4},w={count:2,xyScalar:1,zOffset:100,ambient:"#ad5935",diffuse:"#ff4a00",speed:.001,gravity:1200,dampening:.95,minLimit:10,maxLimit:null,minDistance:20,maxDistance:400,autopilot:!1,draw:!1,bounds:CAV.Vector3.create(),step:CAV.Vector3.create(Math.randomInRange(.2,1),Math.randomInRange(.2,1),Math.randomInRange(.2,1))},I="canvas",C={renderer:I},T=Date.now(),S=CAV.Vector3.create(),k=CAV.Vector3.create(),_=document.getElementById("container"),P=document.getElementById("anitOut");l()}else alert("发生错误，请重试！")})}il.Array="function"===typeof Float32Array?Float32Array:Array,il.Utils={isNumber:function(e){return!isNaN(parseFloat(e))&&isFinite(e)}},function(){for(var e=0,t=["ms","moz","webkit","o"],a=0;a<t.length&&!window.requestAnimationFrame;++a)window.requestAnimationFrame=window[t[a]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[a]+"CancelAnimationFrame"]||window[t[a]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var a=(new Date).getTime(),n=Math.max(0,16-(a-e)),i=window.setTimeout(function(){t(a+n)},n);return e=a+n,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),Math.PIM2=2*Math.PI,Math.PID2=Math.PI/2,Math.randomInRange=function(e,t){return e+(t-e)*Math.random()},Math.clamp=function(e,t,a){return e=Math.max(e,t),Math.min(e,a)},il.Vector3={create:function(e,t,a){var n=new il.Array(3);return this.set(n,e,t,a),n},clone:function(e){var t=this.create();return this.copy(t,e),t},set:function(e,t,a,n){return e[0]=t||0,e[1]=a||0,e[2]=n||0,this},setX:function(e,t){return e[0]=t||0,this},setY:function(e,t){return e[1]=t||0,this},setZ:function(e,t){return e[2]=t||0,this},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],this},add:function(e,t){return e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],this},addVectors:function(e,t,a){return e[0]=t[0]+a[0],e[1]=t[1]+a[1],e[2]=t[2]+a[2],this},addScalar:function(e,t){return e[0]+=t,e[1]+=t,e[2]+=t,this},subtract:function(e,t){return e[0]-=t[0],e[1]-=t[1],e[2]-=t[2],this},subtractVectors:function(e,t,a){return e[0]=t[0]-a[0],e[1]=t[1]-a[1],e[2]=t[2]-a[2],this},subtractScalar:function(e,t){return e[0]-=t,e[1]-=t,e[2]-=t,this},multiply:function(e,t){return e[0]*=t[0],e[1]*=t[1],e[2]*=t[2],this},multiplyVectors:function(e,t,a){return e[0]=t[0]*a[0],e[1]=t[1]*a[1],e[2]=t[2]*a[2],this},multiplyScalar:function(e,t){return e[0]*=t,e[1]*=t,e[2]*=t,this},divide:function(e,t){return e[0]/=t[0],e[1]/=t[1],e[2]/=t[2],this},divideVectors:function(e,t,a){return e[0]=t[0]/a[0],e[1]=t[1]/a[1],e[2]=t[2]/a[2],this},divideScalar:function(e,t){return 0!==t?(e[0]/=t,e[1]/=t,e[2]/=t):(e[0]=0,e[1]=0,e[2]=0),this},cross:function(e,t){var a=e[0],n=e[1],i=e[2];return e[0]=n*t[2]-i*t[1],e[1]=i*t[0]-a*t[2],e[2]=a*t[1]-n*t[0],this},crossVectors:function(e,t,a){return e[0]=t[1]*a[2]-t[2]*a[1],e[1]=t[2]*a[0]-t[0]*a[2],e[2]=t[0]*a[1]-t[1]*a[0],this},min:function(e,t){return e[0]<t&&(e[0]=t),e[1]<t&&(e[1]=t),e[2]<t&&(e[2]=t),this},max:function(e,t){return e[0]>t&&(e[0]=t),e[1]>t&&(e[1]=t),e[2]>t&&(e[2]=t),this},clamp:function(e,t,a){return this.min(e,t),this.max(e,a),this},limit:function(e,t,a){var n=this.length(e);return null!==t&&n<t?this.setLength(e,t):null!==a&&n>a&&this.setLength(e,a),this},dot:function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},normalise:function(e){return this.divideScalar(e,this.length(e))},negate:function(e){return this.multiplyScalar(e,-1)},distanceSquared:function(e,t){var a=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return a*a+n*n+i*i},distance:function(e,t){return Math.sqrt(this.distanceSquared(e,t))},lengthSquared:function(e){return e[0]*e[0]+e[1]*e[1]+e[2]*e[2]},length:function(e){return Math.sqrt(this.lengthSquared(e))},setLength:function(e,t){var a=this.length(e);return 0!==a&&t!==a&&this.multiplyScalar(e,t/a),this}},il.Vector4={create:function(e,t,a){var n=new il.Array(4);return this.set(n,e,t,a),n},set:function(e,t,a,n,i){return e[0]=t||0,e[1]=a||0,e[2]=n||0,e[3]=i||0,this},setX:function(e,t){return e[0]=t||0,this},setY:function(e,t){return e[1]=t||0,this},setZ:function(e,t){return e[2]=t||0,this},setW:function(e,t){return e[3]=t||0,this},add:function(e,t){return e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e[3]+=t[3],this},multiplyVectors:function(e,t,a){return e[0]=t[0]*a[0],e[1]=t[1]*a[1],e[2]=t[2]*a[2],e[3]=t[3]*a[3],this},multiplyScalar:function(e,t){return e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,this},min:function(e,t){return e[0]<t&&(e[0]=t),e[1]<t&&(e[1]=t),e[2]<t&&(e[2]=t),e[3]<t&&(e[3]=t),this},max:function(e,t){return e[0]>t&&(e[0]=t),e[1]>t&&(e[1]=t),e[2]>t&&(e[2]=t),e[3]>t&&(e[3]=t),this},clamp:function(e,t,a){return this.min(e,t),this.max(e,a),this}},il.Color=function(e,t){this.rgba=il.Vector4.create(),this.hex=e||"#000000",this.opacity=il.Utils.isNumber(t)?t:1,this.set(this.hex,this.opacity)},il.Color.prototype={set:function(e,t){e=e.replace("#","");var a=e.length/3;return this.rgba[0]=parseInt(e.substring(0*a,1*a),16)/255,this.rgba[1]=parseInt(e.substring(1*a,2*a),16)/255,this.rgba[2]=parseInt(e.substring(2*a,3*a),16)/255,this.rgba[3]=il.Utils.isNumber(t)?t:this.rgba[3],this},hexify:function(e){return e=Math.ceil(255*e).toString(16),1===e.length&&(e="0"+e),e},format:function(){var e=this.hexify(this.rgba[0]),t=this.hexify(this.rgba[1]),a=this.hexify(this.rgba[2]);return this.hex="#"+e+t+a}},il.Object=function(){this.position=il.Vector3.create()},il.Object.prototype={setPosition:function(e,t,a){return il.Vector3.set(this.position,e,t,a),this}},il.Light=function(e,t){il.Object.call(this),this.ambient=new il.Color(e||"#FFFFFF"),this.diffuse=new il.Color(t||"#FFFFFF"),this.ray=il.Vector3.create()},il.Light.prototype=Object.create(il.Object.prototype),il.Vertex=function(e,t,a){this.position=il.Vector3.create(e,t,a)},il.Vertex.prototype={setPosition:function(e,t,a){return il.Vector3.set(this.position,e,t,a),this}},il.Triangle=function(e,t,a){this.a=e||new il.Vertex,this.b=t||new il.Vertex,this.c=a||new il.Vertex,this.vertices=[this.a,this.b,this.c],this.u=il.Vector3.create(),this.v=il.Vector3.create(),this.centroid=il.Vector3.create(),this.normal=il.Vector3.create(),this.color=new il.Color,this.polygon=document.createElementNS(il.SVGNS,"polygon"),this.polygon.setAttributeNS(null,"stroke-linejoin","round"),this.polygon.setAttributeNS(null,"stroke-miterlimit","1"),this.polygon.setAttributeNS(null,"stroke-width","1"),this.computeCentroid(),this.computeNormal()},il.Triangle.prototype={computeCentroid:function(){return this.centroid[0]=this.a.position[0]+this.b.position[0]+this.c.position[0],this.centroid[1]=this.a.position[1]+this.b.position[1]+this.c.position[1],this.centroid[2]=this.a.position[2]+this.b.position[2]+this.c.position[2],il.Vector3.divideScalar(this.centroid,3),this},computeNormal:function(){return il.Vector3.subtractVectors(this.u,this.b.position,this.a.position),il.Vector3.subtractVectors(this.v,this.c.position,this.a.position),il.Vector3.crossVectors(this.normal,this.u,this.v),il.Vector3.normalise(this.normal),this}},il.Geometry=function(){this.vertices=[],this.triangles=[],this.dirty=!1},il.Geometry.prototype={update:function(){if(this.dirty){var e,t;for(e=this.triangles.length-1;e>=0;e--)t=this.triangles[e],t.computeCentroid(),t.computeNormal();this.dirty=!1}return this}},il.Plane=function(e,t,a,n){var i,r,o;il.Geometry.call(this),this.width=e||100,this.height=t||100,this.segments=a||4,this.slices=n||4,this.segmentWidth=this.width/this.segments,this.sliceHeight=this.height/this.slices;a=[];for(i=-.5*this.width,r=.5*this.height,e=0;e<=this.segments;e++)for(a.push([]),t=0;t<=this.slices;t++)n=new il.Vertex(i+e*this.segmentWidth,r-t*this.sliceHeight),a[e].push(n),this.vertices.push(n);for(e=0;e<this.segments;e++)for(t=0;t<this.slices;t++)n=a[e+0][t+0],i=a[e+0][t+1],r=a[e+1][t+0],o=a[e+1][t+1],window.t0=new il.Triangle(n,i,r),window.t1=new il.Triangle(r,i,o),this.triangles.push(window.t0,window.t1)},il.Plane.prototype=Object.create(il.Geometry.prototype),il.Material=function(e,t){this.ambient=new il.Color(e||"#444444"),this.diffuse=new il.Color(t||"#FFFFFF"),this.slave=new il.Color},il.Mesh=function(e,t){il.Object.call(this),this.geometry=e||new il.Geometry,this.material=t||new il.Material,this.side=il.FRONT,this.visible=!0},il.Mesh.prototype=Object.create(il.Object.prototype),il.Mesh.prototype.update=function(e,t){var a,n,i,r,o;if(this.geometry.update(),t)for(a=this.geometry.triangles.length-1;a>=0;a--){for(n=this.geometry.triangles[a],il.Vector4.set(n.color.rgba),i=e.length-1;i>=0;i--)r=e[i],il.Vector3.subtractVectors(r.ray,r.position,n.centroid),il.Vector3.normalise(r.ray),o=il.Vector3.dot(n.normal,r.ray),this.side===il.FRONT?o=Math.max(o,0):this.side===il.BACK?o=Math.abs(Math.min(o,0)):this.side===il.DOUBLE&&(o=Math.max(Math.abs(o),0)),il.Vector4.multiplyVectors(this.material.slave.rgba,this.material.ambient.rgba,r.ambient.rgba),il.Vector4.add(n.color.rgba,this.material.slave.rgba),il.Vector4.multiplyVectors(this.material.slave.rgba,this.material.diffuse.rgba,r.diffuse.rgba),il.Vector4.multiplyScalar(this.material.slave.rgba,o),il.Vector4.add(n.color.rgba,this.material.slave.rgba);il.Vector4.clamp(n.color.rgba,0,1)}return this},il.Scene=function(){this.meshes=[],this.lights=[]},il.Scene.prototype={add:function(e){return e instanceof il.Mesh&&!~this.meshes.indexOf(e)?this.meshes.push(e):e instanceof il.Light&&!~this.lights.indexOf(e)&&this.lights.push(e),this},remove:function(e){return e instanceof il.Mesh&&~this.meshes.indexOf(e)?this.meshes.splice(this.meshes.indexOf(e),1):e instanceof il.Light&&~this.lights.indexOf(e)&&this.lights.splice(this.lights.indexOf(e),1),this}},il.Renderer=function(){this.halfHeight=this.halfWidth=this.height=this.width=0},il.Renderer.prototype={setSize:function(e,t){if(this.width!==e||this.height!==t)return this.width=e,this.height=t,this.halfWidth=.5*this.width,this.halfHeight=.5*this.height,this},clear:function(){return this},render:function(){return this}},il.CanvasRenderer=function(){il.Renderer.call(this),this.element=document.createElement("canvas"),this.element.style.display="block",this.context=this.element.getContext("2d"),this.setSize(this.element.width,this.element.height)},il.CanvasRenderer.prototype=Object.create(il.Renderer.prototype),il.CanvasRenderer.prototype.setSize=function(e,t){return il.Renderer.prototype.setSize.call(this,e,t),this.element.width=e,this.element.height=t,this.context.setTransform(1,0,0,-1,this.halfWidth,this.halfHeight),this},il.CanvasRenderer.prototype.clear=function(){return il.Renderer.prototype.clear.call(this),this.context.clearRect(-this.halfWidth,-this.halfHeight,this.width,this.height),this},il.CanvasRenderer.prototype.render=function(e){var t,a,n,i,r;for(il.Renderer.prototype.render.call(this,e),this.clear(),this.context.lineJoin="round",this.context.lineWidth=1,t=e.meshes.length-1;t>=0;t--)if(a=e.meshes[t],a.visible)for(a.update(e.lights,!0),n=a.geometry.triangles.length-1;n>=0;n--)i=a.geometry.triangles[n],r=i.color.format(),this.context.beginPath(),this.context.moveTo(i.a.position[0],i.a.position[1]),this.context.lineTo(i.b.position[0],i.b.position[1]),this.context.lineTo(i.c.position[0],i.c.position[1]),this.context.closePath(),this.context.strokeStyle=r,this.context.fillStyle=r,this.context.stroke(),this.context.fill();return this};var ol=a("f6e7"),ll=a.n(ol),sl=ll.a.map({username:ll.a.required.$msg("请输入登录名").string.other("form",{placeholder:"登录名"}),password:ll.a.required.$msg("请输入密码").string.other("form",{placeholder:"密码",type:"password"})}).other("form",{cols:{label:0,wrapper:24}}),cl={data:function(){return{user:{username:"",password:""},codeUrl:"captcha.jpg",isNormalActive:!0,isDomainActive:!1}},components:{},computed:{formSchema:function(){return this.schema||sl}},props:["schema"],methods:{keyupSubmit:function(e){13===e.keyCode&&this.$refs.loginForm.handleSubmit()},changAccoutType:function(e){"normal"===e?(this.isNormalActive=!0,this.isDomainActive=!1):(this.isNormalActive=!1,this.isDomainActive=!0)},createCav:function(){!window.ActiveXObject&&document.createElement("canvas").getContext},handleLogin:function(e){var t=this;0===e.length&&(this.isDomainActive?(this.user.ldapName=this.user.username,delete this.user.username):delete this.user.ldapName,window.localStorage&&window.localStorage.setItem("loginType",this.isDomainActive?"domain":"normal"),this.$login(this.user).then(function(e){console.log("redirect="+t.$route.query.redirect),t.$router.push({path:t.$route.query.redirect||"/desktop"})},function(){t.isDomainActive&&(t.user.username=t.user.ldapName)}))},updateValicode:function(){this.codeUrl+="?_="+(new Date).getTime()}},created:function(){rl();var e=window.localStorage.getItem("loginType");this.changAccoutType("domain"===e?"domain":"normal")}},ul=cl,dl=(a("27be"),Object(Yo["a"])(ul,el,tl,!1,null,"a9e082a6",null)),pl=dl.exports,hl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isKeepAlive?a("keep-alive",[e.isKeepAlive?a("router-view"):e._e()],1):a("router-view")},ml=[],fl={computed:{isKeepAlive:function(){var e=this.$route.meta;return e&&!1!==e.isCache}}},vl=fl,gl=Object(Yo["a"])(vl,hl,ml,!1,null,null,null),bl=gl.exports,yl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("TabPage",[a("BroadcastBlockList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,read:e.handleRead,edit:e.handleEdit,delete:e.handleDelete}}),e.isShowList?e._e():a("broadcast"===e.configModel?"BroadcastBlockInfoLegacy":"BroadcastBlockInfo",{tag:"component",attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},wl=[],Il=a("bbf7"),Cl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{ref:"contentCard",staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"blockInfo"},on:{add:e.handleCreate,edit:e.handleEdit}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1),a("BroadcastSimpleData",{attrs:{show:e.isVisibleDialog,id:e.currentId,isRealTime:e.isRealTime},on:{"update:show":function(t){e.isVisibleDialog=t}}})],1)},Tl=[],Sl=a("3912"),kl=a("2df9"),_l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{staticClass:"content",attrs:{width:"70%",visible:e.visible,"append-to-body":!0,show:e.show},on:{"update:visible":function(t){e.visible=t},open:e.handleDialogOpen,close:function(t){return e.$emit("update:show",!1)}}},[a("el-form",{staticClass:"form",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"标题筛选"}},[a("el-select",{attrs:{filterable:""},model:{value:e.filter.title,callback:function(t){e.$set(e.filter,"title",t)},expression:"filter.title"}},e._l(e.allTitles,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})}),1)],1),a("el-form-item",{attrs:{label:"类型"}},[a("el-select",{attrs:{placeholder:"类型"},model:{value:e.filter.type,callback:function(t){e.$set(e.filter,"type",t)},expression:"filter.type"}},e._l(e.typeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.fetchData}},[e._v("查询")])],1)],1),e._l(e.broadcastChartDataArr,function(t,n){return a("div",{key:n,staticClass:"chart--wrapper"},[a("div",{staticClass:"chart-box--title"},[e._v(e._s(t.title))]),a("VeLine",{attrs:{data:e.handleChartData(t),"legend-visible":!1,extend:e.handleChartExtend(t),settings:e.handleChartSettings(t),"mark-line":e.markLine,"mark-point":e.markPoint}})],1)})],2)],1)},Pl=[],xl=(a("c5f6"),a("c3da")),Fl=a.n(xl),Dl=(a("95a8"),a("db0e"),[{label:"整体数据",value:"total"},{label:"视频窗数据",value:"video"},{label:"静态图数据",value:"static"}]),Rl={components:{VeLine:Fl.a},data:function(){this.markLine={data:[{name:"平均线",type:"average"}]},this.markPoint={data:[{name:"最大值",type:"max"},{name:"最小值",type:"min"}]};var e={grid:{top:"10%",left:"5%",right:"5%",bottom:"10%",containLabel:!0},series:function(e){return e[0].smooth=!1,e},xAxis:{axisLabel:{rotate:45,formatter:function(e){var t=e.indexOf("(");if(-1===t)return e;var a=e.slice(t-e.length),n=e.slice(0,t);return["{a|".concat(a,"}"),n].join("")},rich:{a:{color:"red"}}}},color:["#1E90FF ","#2f4554"]};return{filter:this.genDefaultFilter(),allTitles:[],visible:this.show,broadcastChartDataArr:[],extend:e,typeOptions:Dl}},props:{id:Number,selectedType:String,selectedTitle:String,show:{type:Boolean,default:function(){return!1}},isRealTime:{type:Boolean,default:function(){return!1}}},computed:{},watch:{show:function(){this.visible=this.show}},methods:{genDefaultFilter:function(){return{title:"",type:this.selectedType||Dl[0].value}},fetchData:function(){var e=this,t=this.isRealTime?"getBlockRealTimeChartData":"getBlockChartData";this.$service[t](Object(Q["a"])({id:this.id},this.filter)).then(function(t){e.broadcastChartDataArr=t.rows,0===t.rows.length&&e.$message("暂无数据")})},handleDialogOpen:function(){var e=this;this.broadcastChartDataArr=[],this.filter=this.genDefaultFilter(),this.$service.getBroadcastDataTitles({id:this.id}).then(function(t){var a=e.filter,n=t.rows||[],i=e.selectedTitle;if(e.allTitles=n,i){var r=n.some(function(e){return e===i});r&&(a.title=i,e.fetchData())}})},handleChartData:function(e){return{title:e.title,unit:e.unit,columns:["x","y"],rows:e.data}},handleChartSettings:function(e){return{labelMap:{y:e.title}}},handleChartExtend:function(e){var t={axisLabel:{formatter:"{value}%"}},a=Object.assign({},this.extend);return"%"===e.unit?Object.assign(a,{yAxis:t}):a}},mounted:function(){}},Ll=Rl,$l=(a("3c39"),Object(Yo["a"])(Ll,_l,Pl,!1,null,"60cadfd8",null)),Nl=$l.exports,El={extends:Sl["a"],components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"],ButtonGroupForListPage:kl["a"],BroadcastSimpleData:Nl},data:function(){var e=this;return{isVisibleDialog:!1,currentId:void 0,isRealTime:!1,resourceType:"broadcastBlock",filter:this.genDefaultFilter(),filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",width:70,prop:"id",sortable:!0},{label:"轮播名称",prop:"containerName",sortable:!0,render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n)}}},n.containerName)}},{label:"数据表现",width:200,render:function(t,a){var n=a.row;return t("div",[t("el-button",{props:{type:"text"},on:{click:e.handleClickDataShow(n)}},"看数据")])}},{label:"待审核的版本",prop:"duplicateVersion",width:130,sortable:!0,render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(n,n.duplicateVersion)}}},n.duplicateVersion)}},{label:"版本/状态",prop:"status",formatter:function(t){var a=t.status,n=t.currentVersion;return n+"/"+e.$consts.statusText[a]}},{label:"内容源",prop:"source",render:function(t,a){var n=a.row;return e.$consts.sourceTextWithNone[n.source]}},{label:"更新时间",prop:"lastUpdateDate",sortable:!0},{label:"操作",render:function(t,a){var n=a.row;if(n.showContentAuthSettingBtn)return t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleOpenContentAuthManager(n)}}},"内容权限")}}],data:[],selected:[],selectionType:"multiple"}}},methods:{handleOpenContentAuthManager:function(e){this.$refs.contentCard.handleShowContentAuthManager({id:e.id,type:"block",menuElId:"broadcastBlock"})},genDefaultFilter:function(){return{}},handleFilterChange:function(e,t){t&&(this.filter=t),"query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData()},handleFilterReset:function(){this.filter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();this.$service.broadcastBlockPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},toPercent:function(e){return Math.round(1e4*e)/100+"%"},getSimpleBrowseData:function(e){var t=this,a={};return this.$service.getBlockSimpleBrowseData({id:e}).then(function(e){var n=e.rows[0].data[0].uvctr;a={value:t.toPercent(n.value),dailyGrowth:t.toPercent(n.dailyGrowth),weeklyGrowth:t.toPercent(n.weeklyGrowth)},console.log("data2",a)}),a},handleClickDataShow:function(e,t){var a=this;return function(){a.currentId=e.id,a.isVisibleDialog=!0,a.isRealTime=t||!1,a.$sendEvent({type:"broadcast_data_search"})}}},created:function(){var e=ll.a.map({id:ll.a.o.oneOf([ll.a.number,ll.a.value("")]).$msg("请输入数字").other("form",{component:"Input",placeholder:"推荐位ID"}),containerName:ll.a.o.string.other("form",{component:"Input",placeholder:"推荐位名称"}),status:ll.a.o.enum(this.$consts.statusEnums).other("form",{component:"Select",placeholder:"审核状态",clearable:!0}),source:ll.a.o.enum(this.$consts.sourceOptionsWithNoneEnums).other("form",{component:"Select",placeholder:"内容源",clearable:!0})}).other("form",{layout:"inline",cols:{item:5,label:0,wrapper:20},footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},Ol=El,Al=(a("8f58"),Object(Yo["a"])(Ol,Cl,Tl,!1,null,"fe4c649e",null)),Vl=Al.exports,Bl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("TabPage",[a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("CommonContent",{ref:"commonContent",attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{replicate:e.replicate,edit:e.edit,unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,"submit-audit":e.handleSubmitAudit,"save-draft":e.handleSaveDraft,audit:function(t){return e.$emit("upsert-end")},"select-version":e.fetchData,"cancel-timing":function(t){return e.fetchData(e.basicForm.currentVersion)},delete:function(t){return e.$emit("upsert-end",t)}}},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"basicForm",staticClass:"el-form-add",attrs:{model:e.basicForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"推荐位名称",prop:"containerName",rules:[{required:!0,message:"请输入推荐位名称",trigger:"blur"}]}},[a("el-input",{attrs:{disabled:e.disabled},model:{value:e.basicForm.containerName,callback:function(t){e.$set(e.basicForm,"containerName",t)},expression:"basicForm.containerName"}})],1),a("el-form-item",{attrs:{label:"推荐位类型"}},[a("el-select",{attrs:{disabled:e.disabled},model:{value:e.basicForm.containerType,callback:function(t){e.$set(e.basicForm,"containerType",t)},expression:"basicForm.containerType"}},[a("el-option",{attrs:{label:"视频列表",value:"REFERENCE_BROADCASTING"}})],1)],1),a("el-form-item",{attrs:{label:"配置模式"}},[a("el-radio-group",{attrs:{value:e.basicForm.configModel},on:{input:e.handleInputConfigModel}},[a("el-radio",{attrs:{label:"purePoster",disabled:e.disabled}},[e._v("纯图模式")]),a("el-radio",{attrs:{label:"group",disabled:e.disabled}},[e._v("窗口模式")]),a("el-radio",{attrs:{label:"sign",disabled:e.disabled}},[e._v("信号源")])],1)],1),a("el-form-item",{attrs:{label:"内容源"}},[a("el-radio-group",{attrs:{disabled:e.isReplica,value:e.basicForm.source},on:{input:e.handleSourceChange}},e._l(e.$consts.sourceOptionsWithNone,function(t){return a("el-radio",{key:t.value,attrs:{label:t.value,disabled:e.disabled}},[e._v("\n              "+e._s(t.label)+"\n            ")])}),1)],1)],1),a("div",{staticClass:"split-bar"},[e._v("内容配置")]),a("div",{staticClass:"version-title"},[a("h4",{staticClass:"version-title__h"},[e._v("正常版本")]),"group"===e.basicForm.configModel||"purePoster"===e.basicForm.configModel?a("el-tag",{staticClass:"version-title__tag",attrs:{type:"warning"}},[e._v("短标题模式需至少运营四个资源，长标题模式至少6个，才能填满布局哦~")]):e._e(),e.isGroupModel&&!e.disabled?a("ResourceSelector",{ref:"resourceSelector",staticStyle:{float:"right"},attrs:{"disable-partner":!!e.source,source:e.source,selectors:e.resourceOptions,"is-live":!1,"id-type":1,"selection-type":"multiple"},on:{"select-end":e.handleSelectNormalmultipleResourceEnd}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("批量选择资源")])],1):e._e()],1),a("div",{staticClass:"form-wrap"},[e.isGroupModel?a("el-row",{staticClass:"normal-left-list",style:e.classObject,attrs:{gutter:4}},[e.disabled?e._l(e.normalVersionContent,function(t,n){return a("el-card",{key:n,staticClass:"normal-version-wrap",class:{active:n===e.currentIndex},nativeOn:{click:function(t){return e.handleActivateContent(n)}}},[t.poster.pictureUrl?a("img",{attrs:{referrerpolicy:"no-referrer",src:t.poster.pictureUrl}}):e._e(),a("span",[e._v(e._s(t.title))])])}):a("draggable",{attrs:{options:{group:"normalVersion"}},on:{start:function(t){return e.onDragStart(t)},end:function(t){return e.onDragtEnd(t)}},model:{value:e.normalVersionContent,callback:function(t){e.normalVersionContent=t},expression:"normalVersionContent"}},e._l(e.normalVersionContent,function(t,n){return a("el-card",{key:n,staticClass:"normal-version-wrap",class:{active:n===e.currentIndex},nativeOn:{click:function(t){return e.handleActivateContent(n)}}},[e.normalVersionContent.length>1&&!e.disabled?a("i",{staticClass:"el-icon-close",on:{click:function(t){return t.stopPropagation(),e.handleDeleteNormalContent(n)}}}):e._e(),t.poster.pictureUrl?a("img",{attrs:{referrerpolicy:"no-referrer",src:t.poster.pictureUrl}}):e._e(),a("span",[e._v(e._s(t.title))])])}),1),e.disabled?e._e():a("el-card",{staticClass:"add-version-card"},[a("span",{staticClass:"add-version",on:{click:e.handleAddNormalContent}},[e._v("+添加资源")])])],2):e._e(),"group"===e.basicForm.configModel?a("div",{staticClass:"content-wrapper"},[a("div",{staticClass:"content-type-switcher"},[a("el-radio-group",{attrs:{value:e.normalForm.showContentType},on:{input:e.handleSwitchShowContentType}},[a("el-radio",{staticClass:"conten-type-switcher__item",attrs:{label:"general"}},[e._v("通用推荐位版本")]),a("el-radio",{staticClass:"conten-type-switcher__item",attrs:{label:"dmp"}},[e._v("分人群推荐位"+e._s(e.dmpContentList.length>0?"("+e.dmpContentList.length+"个)":""))])],1)],1),"general"===e.normalForm.showContentType?a("div",[a("BroadcastBlockForm",{ref:"broadcastBlockForm",attrs:{id:e.id,"config-model":e.basicForm.configModel,"normal-form":e.normalForm,"normal-rules":e.normalRules,"is-readonly":e.disabled,"is-group-model":e.isGroupModel,source:e.source,"show-resource-tip":0===e.currentIndex},on:{"toggle-use-short-video":e.handleToggleUseShortVideo,"toggle-manaulset-resource":function(t){return e.handleToggleManualSetResource(t,"general")}}})],1):e._e(),"dmp"===e.normalForm.showContentType?a("div",[a("div",{staticClass:"added-contents-wrapper",attrs:{gutter:8}},[a(e.disabled?"div":"draggable",{tag:"component",staticClass:"added-contents-list",on:{start:e.handleDragDmpConentStart,end:e.handleDragDmpConentEnd},model:{value:e.normalForm.dmpContentList,callback:function(t){e.$set(e.normalForm,"dmpContentList",t)},expression:"normalForm.dmpContentList"}},e._l(e.dmpContentList,function(t,n){return a("el-card",{key:n,class:{active:n===e.activeDmpIndex},attrs:{"body-style":{padding:"0px"}},nativeOn:{click:function(t){return e.handleActivateDmpContent(n)}}},[e.dmpContentList[n].poster.pictureUrl?a("img",{attrs:{referrerpolicy:"no-referrer",src:e.dmpContentList[n].poster.pictureUrl}}):e._e(),e.disabled?e._e():a("i",{staticClass:"remove-handle el-icon-close",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleRemoveDmpContent(n)}}})])}),1),"read"!==e.mode?a("el-card",{nativeOn:{click:function(t){return e.handleAddDmpContent(t)}}},[a("i",{staticClass:"el-icon-plus"},[e._v("添加资源")])]):e._e()],1),e.normalForm.dmpContentList[e.normalForm.activeIndex]?a("BroadcastBlockForm",{ref:"broadcastBlockForm",attrs:{id:e.id,"config-model":e.basicForm.configModel,"normal-form":e.normalForm.dmpContentList[e.normalForm.activeIndex],"normal-rules":e.normalRules,"is-readonly":e.disabled,"is-group-model":e.isGroupModel,source:e.source,checkCrowd:e.checkCrowd},on:{"toggle-use-short-video":function(t){return e.handleToggleUseShortVideo(t,"dmp")},"toggle-manaulset-resource":function(t){return e.handleToggleManualSetResource(t,"dmp")}}}):e._e()],1):e._e()]):e._e(),"purePoster"===e.basicForm.configModel||"sign"===e.basicForm.configModel?a("div",{staticClass:"content-wrapper",class:"purePoster"===e.basicForm.configModel?"min-height":""},["sign"===e.basicForm.configModel?[a("BroadcastBlockForm",{ref:"broadcastBlockForm",attrs:{id:e.id,"config-model":e.basicForm.configModel,"normal-form":e.normalForm,"normal-rules":e.normalRules,"is-readonly":e.disabled,"is-group-model":e.isGroupModel,source:e.source,"show-resource-tip":0===e.currentIndex},on:{"toggle-use-short-video":e.handleToggleUseShortVideo,"toggle-manaulset-resource":function(t){return e.handleToggleManualSetResource(t,"general")}}})]:e._e(),"purePoster"===e.basicForm.configModel?[a("BroadcastBlockFormSpe",{ref:"broadcastBlockFormSpe",attrs:{id:e.id,"config-model":e.basicForm.configModel,"normal-form":e.normalForm,"normal-rules":e.normalRules,"is-readonly":e.disabled,"is-group-model":e.isGroupModel,source:e.source,"show-resource-tip":0===e.currentIndex},on:{"toggle-use-short-video":e.handleToggleUseShortVideo,"toggle-manaulset-resource":function(t){return e.handleToggleManualSetResource(t,"general")},"cover-type-change":e.handleCoverTypeChange}})]:e._e()],2):e._e()],1),a("div",{staticClass:"version-title",staticStyle:{"margin-top":"25px"}},[a("h4",{staticStyle:{float:"left","margin-top":"7px"}},[e._v("兼容低版本")]),e.isGroupModel?a("div",{staticStyle:{display:"inline-block","margin-left":"14px"}},[a("el-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary",plain:"",disabled:e.disabled},on:{click:e.lowerFill}},[e._v("快速填充\n          ")]),a("span",[e._v("使用正常版本的第一个资源，快速配置")])],1):e._e()]),a("div",{staticClass:"form-wrap"},[a("el-form",{ref:"lowerForm",staticClass:"el-form-add",attrs:{model:e.lowerForm,rules:e.lowerRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"资源类别",prop:"coverType"}},[a("el-radio-group",{attrs:{value:e.lowerForm.coverType},on:{input:e.handleInputLowerFormCoverType}},[a("el-radio",{attrs:{label:"media",disabled:e.disabled}},[e._v("媒体资源")]),a("el-radio",{attrs:{label:"app",disabled:e.disabled}},[e._v("应用")]),a("el-radio",{attrs:{label:"custom",disabled:e.disabled}},[e._v("自定义")])],1)],1),"media"===e.lowerForm.coverType||"app"===e.lowerForm.coverType?a("el-form-item",{attrs:{label:"内容资源",prop:"thirdIdOrPackageName"}},[e.disabled?e._e():a("ResourceSelector",{ref:"resourceSelector",attrs:{"disable-partner":!!e.source,source:e.source,selectors:e.resourceOptionsLowerForm,"is-live":!1,"selection-type":"single"},on:{"select-end":e.handleSelectLowerSingleResourceEnd}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("选择资源")])],1),e.lowerForm.thirdIdOrPackageName?a("el-tag",{staticClass:"marginL",attrs:{type:"success",closable:!e.disabled},on:{close:e.handleCloseLowerFormTag}},[e._v("已选择："+e._s(e.lowerForm.thirdIdOrPackageName))]):e._e(),e.lowerForm.thirdIdOrPackageName&&e.singleEpisodeNum?a("el-tag",{staticClass:"marginL",attrs:{type:"success"}},[e._v("单集："+e._s(e.singleEpisodeNum))]):e._e()],1):e._e(),e.lowerForm.subchannelIs?a("el-form-item",{attrs:{label:"指定子频道",prop:"subchannelId"}},[a("el-input",{attrs:{disabled:e.disabled},model:{value:e.lowerForm.subchannelId,callback:function(t){e.$set(e.lowerForm,"subchannelId",t)},expression:"lowerForm.subchannelId"}})],1):e._e(),e.lowerForm.smallTopicsIs?a("el-form-item",{attrs:{label:"指定小专题",prop:"smallTopicsId"}},[a("el-input",{attrs:{disabled:e.disabled},on:{blur:e.smallTopicsLower},model:{value:e.lowerForm.smallTopicsId,callback:function(t){e.$set(e.lowerForm,"smallTopicsId",t)},expression:"lowerForm.smallTopicsId"}})],1):e._e(),a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{attrs:{disabled:e.disabled},model:{value:e.lowerForm.title,callback:function(t){e.$set(e.lowerForm,"title",t)},expression:"lowerForm.title"}})],1),a("el-form-item",{attrs:{label:"副标题",prop:"subTitle"}},[a("el-input",{attrs:{disabled:e.disabled},model:{value:e.lowerForm.subTitle,callback:function(t){e.$set(e.lowerForm,"subTitle",t)},expression:"lowerForm.subTitle"}})],1),a("el-form-item",{attrs:{label:"海报",prop:"poster.pictureUrl"}},[a("GlobalPictureSelector",{attrs:{disabled:e.isReadonly,"picture-resolution":"1210*449"},on:{"select-end":e.handleSelectPostEnd}},[a("el-card",{staticClass:"post-box",staticStyle:{height:"180px"},attrs:{disabled:e.disabled}},[e.lowerForm.poster.pictureUrl?a("img",{staticStyle:{height:"180px"},attrs:{referrerpolicy:"no-referrer",src:e.lowerForm.poster.pictureUrl}}):e._e()])],1)],1),a("el-form-item",{attrs:{label:"角标"}},[a("el-card",{staticClass:"corner-box"},e._l(e.lowerForm.cornerIconList,function(t,n){return a("span",{key:n,staticClass:"corner",class:"corner-"+n},[a("CornerSelector",{attrs:{disabled:e.isReadonly,position:n},on:{"select-end":function(t){return e.handleSelectCornerIconEnd(t,n)}}},[t.imgUrl?a("span",{staticClass:"corner-img-wrapper"},[a("img",{attrs:{referrerpolicy:"no-referrer",src:t.imgUrl}}),e.disabled?e._e():a("i",{staticClass:"el-icon-delete",on:{click:function(t){return t.stopPropagation(),e.deleteCorner(e.lowerForm,n)}}})]):a("el-tag",{attrs:{type:"success"}},[a("i",{staticClass:"el-icon-plus"})])],1)],1)}),0)],1),"media"===e.lowerForm.coverType||"app"===e.lowerForm.coverType?a("div",[a("el-form-item",{attrs:{label:"应用版本号",prop:"versionCode"}},[a("el-input",{attrs:{disabled:e.disabled},model:{value:e.lowerForm.versionCode,callback:function(t){e.$set(e.lowerForm,"versionCode",t)},expression:"lowerForm.versionCode"}})],1)],1):e._e(),"custom"===e.lowerForm.coverType?a("div",[a("el-form-item",{attrs:{label:"打开方式"}},[a("el-select",{attrs:{value:"第三方应用",disabled:e.disabled}},[a("el-option",{attrs:{value:"app"}},[e._v("第三方应用")])],1),a("el-button",{staticClass:"marginL",attrs:{type:"primary",plain:"",disabled:e.disabled},on:{click:function(t){e.onclickEventVisible=!0,e.onclickEventVisibleFlag="lower"}}},[e._v("快速填充")])],1),e.disabled?e._e():a("AppParams",{ref:"openWayLower",attrs:{"prop-prefix":"onclick."},model:{value:e.lowerForm.onclick,callback:function(t){e.$set(e.lowerForm,"onclick",t)},expression:"lowerForm.onclick"}},[e._v(e._s(e.lowerForm.onclick)+"\n            ")]),e.disabled?a("AppParamsRead",{attrs:{value:e.lowerForm.onclick}}):e._e()],1):e._e()],1)],1),a("el-dialog",{attrs:{visible:e.onclickEventVisible,width:"1200px"},on:{"update:visible":function(t){e.onclickEventVisible=t}}},[a("selectClick",{on:{"row-click":e.getClickData}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.onclickEventVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onclickEventVisible=!1,e.clickThirdpartSubmit()}}},[e._v("确 定")])],1)],1)],1)],1)],1)},Ml=[],Ul=a("310e"),Gl=a.n(Ul),jl=a("cc30"),zl=a("4ef5"),Wl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType},on:{"row-click":e.rowClick,"row-selection-change":e.rowClick}})],1)],1)},ql=[],Jl={components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"]},data:function(){return{filter:{sort:void 0,order:void 0},filterSchema:null,pagination:{},selected:void 0,table:{props:{},header:[{label:"ID",prop:"commonOnclickId",width:"70"},{label:"点击事件名称",prop:"onlickName"},{label:"备注",prop:"remark"},{label:"修改人",prop:"modifierName"},{label:"修改时间",prop:"lastUpdateDate",width:"170"}],data:[],selected:[],selectionType:"single"}}},methods:{rowClick:function(e){this.$emit("row-click",e)},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.getClickData(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},handleRowSelectionAdd:function(e){this.selected.push(e.commonOnclickId),this.updateTableSelected()},handleRowSelectionRemove:function(e){this.selected=this.selected.filter(function(t){return t!==e.commonOnclickId}),this.updateTableSelected()},handleAllRowSelectionRemove:function(){this.selected=[],this.table.selected=[]},updateTableSelected:function(){var e=this.table,t=this.selected;e.selected=e.data.reduce(function(e,a,n){return t.indexOf(a.commonOnclickId)>-1&&e.push(n),e},[])},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.commonOnclickId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e}},created:function(){var e=ll.a.map({commonOnclickId:ll.a.o.string.other("form",{component:"Input",placeholder:"ID  "}),onlickName:ll.a.o.string.other("form",{component:"Input",placeholder:"点击事件名称"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},Hl=Jl,Kl=(a("1b36"),Object(Yo["a"])(Hl,Wl,ql,!1,null,"e715e7da",null)),Yl=Kl.exports,Ql=a("c3d5"),Xl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.onlyParams?e._e():[a("el-form-item",{attrs:{label:"应用包名",prop:e.formProp("packagename"),rules:e.rules.packagename}},[a("el-input",{model:{value:e.inputValue.packagename,callback:function(t){e.$set(e.inputValue,"packagename","string"===typeof t?t.trim():t)},expression:"inputValue.packagename"}})],1),a("el-form-item",{attrs:{label:"应用版本号",prop:e.formProp("versioncode"),rules:e.rules.versioncode}},[a("el-input",{model:{value:e.inputValue.versioncode,callback:function(t){e.$set(e.inputValue,"versioncode","string"===typeof t?t.trim():t)},expression:"inputValue.versioncode"}})],1),a("el-form-item",{attrs:{label:"启动动作",prop:e.formProp("dowhat"),rules:e.rules.dowhat}},[a("el-select",{model:{value:e.inputValue.dowhat,callback:function(t){e.$set(e.inputValue,"dowhat",t)},expression:"inputValue.dowhat"}},e._l(e.dowhatOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"启动方式",prop:e.formProp("bywhat"),rules:e.rules.bywhat}},[a("el-select",{model:{value:e.inputValue.bywhat,callback:function(t){e.$set(e.inputValue,"bywhat",t)},expression:"inputValue.bywhat"}},e._l(e.bywhatOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"启动参数",prop:e.formProp("byvalue"),rules:e.rules.byvalue}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.inputValue.byvalue,callback:function(t){e.$set(e.inputValue,"byvalue","string"===typeof t?t.trim():t)},expression:"inputValue.byvalue"}})],1),a("el-form-item",{attrs:{label:"数据配置",prop:e.formProp("data")}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.inputValue.data,callback:function(t){e.$set(e.inputValue,"data","string"===typeof t?t.trim():t)},expression:"inputValue.data"}})],1)],a("el-form-item",{attrs:{label:"扩展参数"}},[e._l(e.inputValue.defaultParams,function(t,n){return a("div",{key:"default"+n,staticClass:"app-extend-params"},[t.hide?e._e():[a("el-form-item",{attrs:{label:"key:","label-width":"60px",prop:e.formProp("defaultParams."+n+".key"),rules:e.rules.params.key}},[a("div",{staticStyle:{width:"100px"}},[e._v(e._s(t.key))])]),a("el-form-item",{attrs:{label:"value:","label-width":"60px",prop:e.formProp("defaultParams")&&e.formProp("defaultParams."+n+".value"),rules:e.rules.params.value}},[t.type?a("CommonSelector",{attrs:{type:t.type,options:t.valueOptions},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"param.value"}}):["number"===t.ValueType?a("el-input",{model:{value:t.value,callback:function(a){e.$set(t,"value",e._n("string"===typeof a?a.trim():a))},expression:"param.value"}}):a("el-input",{model:{value:t.value,callback:function(a){e.$set(t,"value","string"===typeof a?a.trim():a)},expression:"param.value"}})]],2),a("span",{staticClass:"tips"},[e._v(e._s(t.tip))])]],2)}),e._l(e.inputValue.params,function(t,n){return a("div",{key:n,staticClass:"app-extend-params"},[a("el-form-item",{attrs:{label:"key:","label-width":"60px",prop:e.formProp("params."+n+".key"),rules:e.rules.params.key}},[a("el-input",{model:{value:t.key,callback:function(a){e.$set(t,"key","string"===typeof a?a.trim():a)},expression:"param.key"}})],1),a("el-form-item",{attrs:{label:"value:","label-width":"60px",prop:e.formProp("params."+n+".value"),rules:e.rules.params.value}},[a("el-input",{model:{value:t.value,callback:function(a){e.$set(t,"value","string"===typeof a?a.trim():a)},expression:"param.value"}})],1),a("a",{staticClass:"app-params__remove-param",on:{click:function(t){return e.handleRemoveParam(n)}}},[a("i",{staticClass:"el-icon-minus"})])],1)}),a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleAddParam}},[a("i",{staticClass:"el-icon-plus"}),e._v(" 添加\n    ")])],2)],2)},Zl=[],es=a("ea3f"),ts={components:{CommonSelector:es["a"]},data:function(){var e=this,t=function(t,a,n){if(/[！￥……（）——【】：；“”‘’、《》，。？\s+]/.test(a))return n(new Error("请勿输入特殊或空白字符"));var i=e.inputValue.params.filter(function(e){var t=e.key;return t===a}).length>1;if(i)return n(new Error("key 不能重复"));n()},a=function(e,t,a){/[！￥……（）——【】：；“”‘’、《》，。？\s+]/.test(t)?a(new Error("请勿输入特殊或空白字符")):a()};return{inputValue:this.genDefaultValue(),rules:{packagename:[{required:!0,message:"请输入应用包名",trigger:"blur"}],versioncode:[{required:!0,message:"请输入应用版本号",trigger:"blur"},{validator:function(e,t,a){if(t&&!/^(-1|\d*)$/.test(t))return a(new Error("应用版本号只能是数字或者-1"));a()}}],dowhat:[{required:!0,message:"请选择启动动作",trigger:"blur"}],bywhat:[{required:!0,message:"请选择启动方式",trigger:"blur"}],byvalue:[{required:!0,message:"请输入启动参数",trigger:"blur"}],params:{key:[{required:!0,message:"不能为空",trigger:"blur"},{validator:t,trigger:"blur"}],value:[{required:!0,message:"不能为空",trigger:"blur"},{validator:a,trigger:"blur"}]}}}},props:{value:{},onlyParams:Boolean,propPrefix:{},dowhatOptions:{default:function(){return[{label:"startActivity",value:"startActivity"},{label:"startService",value:"startService"},{label:"sendBroadcast",value:"sendBroadcast"}]}},bywhatOptions:{default:function(){return[{label:"action",value:"action"},{label:"class",value:"class"},{label:"uri",value:"uri"},{label:"activity",value:"activity"}]}}},watch:{value:"setInputValue"},methods:{formProp:function(e){return(this.propPrefix||"")+e},genDefaultValue:function(){return{packagename:void 0,versioncode:void 0,dowhat:void 0,bywhat:void 0,byvalue:void 0,params:[],defaultParams:void 0}},setInputValue:function(e){e!==this.inputValue&&(this.inputValue=Object.assign(this.genDefaultValue(),e))},emitInputValue:function(e){this.$emit("input",this.inputValue)},handleAddParam:function(){this.inputValue.params.push({key:void 0,value:void 0})},handleRemoveParam:function(e){this.inputValue.params.splice(e,1)}},created:function(){this.value&&this.setInputValue(this.value),this.$watch("inputValue",this.emitInputValue,{deep:!0})}},as=ts,ns=(a("60d4"),Object(Yo["a"])(as,Xl,Zl,!1,null,"2c2c5dac",null)),is=ns.exports,rs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.onlyParams?e._e():[a("el-form-item",{attrs:{label:"应用包名"}},[e._v(e._s(e.value.packagename))]),a("el-form-item",{attrs:{label:"应用版本号"}},[e._v(e._s(e.value.versioncode))]),a("el-form-item",{attrs:{label:"启动动作"}},[e._v(e._s(e.value.dowhat))]),a("el-form-item",{attrs:{label:"启动方式"}},[e._v(e._s(e.value.bywhat))]),a("el-form-item",{attrs:{label:"启动参数"}},[e._v(e._s(e.value.byvalue))]),a("el-form-item",{attrs:{label:"数据配置"}},[e._v(e._s(e.value.data))])],a("el-form-item",{attrs:{label:"扩展参数"}},e._l(["defaultParams","params"],function(t,n){return a("div",{key:n},e._l(e.value[t],function(t,n){return a("div",{key:n,staticClass:"app-extend-params"},[a("el-form-item",{attrs:{label:"","label-width":"0px"}},[a("el-tag",[e._v("key")]),e._v(" \n          "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.key,placement:"top"}},[a("span",[e._v(e._s(t.key))])])],1),a("el-form-item",{attrs:{label:"","label-width":"0px"}},[a("el-tag",[e._v("value")]),e._v(" \n          "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.value+"",placement:"top"}},[a("span",[e._v(e._s(t.value))])])],1)],1)}),0)}),0)],2)},os=[],ls={template:"#cc-app-params-read",data:function(){return{}},props:["value","onlyParams"],created:function(){}},ss=ls,cs=(a("adc0"),Object(Yo["a"])(ss,rs,os,!1,null,"57485bc4",null)),us=cs.exports,ds=a("363f"),ps=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"normalForm",staticClass:"el-form-add",staticStyle:{float:"left",width:"75%"},attrs:{model:e.normalForm,rules:e.normalRules,"label-width":"140px"}},[e.normalForm.isDmpContent?a("el-form-item",{attrs:{label:"关联定向人群",prop:"dmpRegistryInfo"}},[a("el-button",{attrs:{type:"primary",disabled:e.isReadonly},on:{click:e.handleSelectCrowdStart}},[e._v("添加人群")]),e.normalForm.dmpRegistryInfo?a("el-tag",{attrs:{type:"primary"}},[e._v("已选择: "+e._s(e.normalForm.dmpRegistryInfo.dmpPolicyName)+"("+e._s(e.normalForm.dmpRegistryInfo.dmpPolicyId)+") / "+e._s(e.normalForm.dmpRegistryInfo.dmpCrowdName)+"("+e._s(e.normalForm.dmpRegistryInfo.dmpCrowdId)+")")]):e._e()],1):e._e(),e._e(),e.normalForm.shortVideoSwitch?e._e():a("el-form-item",{attrs:{label:e.normalResourceBtn,prop:"thirdIdOrPackageName"}},[e.isManualSetResource||"轮播资源"!==e.normalResourceBtn||e.disabled?e._e():a("ResourceSelector",{ref:"resourceSelector",attrs:{"disable-partner":!!e.source,source:e.source,selectors:["rotate"],"is-live":!1,"selection-type":"single"},on:{"select-end":function(t){return e.handleSelectNormalSingleResourceEnd(t,"single")}}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("选择资源")])],1),e.isManualSetResource||"播放资源"!==e.normalResourceBtn||e.disabled?e._e():a("ResourceSelector",{ref:"resourceSelector",attrs:{source:e.source,"disable-partner":!!e.source,selectors:e.resourceOptionsNormalForm,"is-live":!1,"id-type":1,"selection-type":"single"},on:{"select-end":function(t){return e.handleSelectNormalSingleResourceEnd(t,"Multiple")}}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("选择资源")])],1),e.isManualSetResource?a("el-input",{staticStyle:{float:"left"},attrs:{disabled:e.disabled},model:{value:e.normalForm.thirdIdOrPackageName,callback:function(t){e.$set(e.normalForm,"thirdIdOrPackageName",t)},expression:"normalForm.thirdIdOrPackageName"}}):e._e(),e.normalForm.thirdIdOrPackageName&&!e.isManualSetResource?a("el-tag",{staticClass:"marginL",attrs:{type:"success",closable:!e.disabled},on:{close:function(t){e.normalForm.thirdIdOrPackageName=void 0}}},[e._v("已选择："+e._s(e.normalForm.thirdIdOrPackageName))]):e._e(),e.normalForm.thirdIdOrPackageName&&e.singleEpisodeNum?a("el-tag",{staticClass:"marginL",attrs:{type:"success"}},[e._v("单集："+e._s(e.singleEpisodeNum))]):e._e(),e.isManualSetResource||!e.isGroupModel||e.disabled?e._e():a("a",{staticClass:"write-play",attrs:{href:"#"},on:{click:function(t){return e.$emit("toggle-manaulset-resource",!0)}}},[e._v("手动填写播放串")]),e.isManualSetResource&&e.isGroupModel&&!e.disabled?a("a",{staticClass:"write-play",staticStyle:{float:"left"},attrs:{href:"#"},on:{click:function(t){return e.$emit("toggle-manaulset-resource",!1)}}},[e._v("自动配置播放资源")]):e._e(),"sign"===e.configModel&&e.showResourceTip?a("div",{staticClass:"sign-tip"},[e._v("\n        信号源模式的第一个资源必须是轮播资源\n      ")]):e._e()],1),e.normalForm.shortVideoSwitch?a("el-form-item",{attrs:{label:"跳转话题",prop:"shortVideoParams.topicId"}},[e.disabled?e._e():a("ResourceSelector",{attrs:{"disable-partner":!!e.source,source:e.source,selectors:["shortVideoTopic"],"selection-type":"single"},on:{"select-end":e.handleSelectVideoTopicEnd}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("\n          选择话题\n        ")])],1),e.normalForm.shortVideoParams.topicId?a("el-tag",{staticClass:"marginL",attrs:{type:"success",closable:!e.disabled},on:{close:function(t){e.normalForm.shortVideoParams.topicId=void 0}}},[e._v("已选择："+e._s(e.normalForm.shortVideoParams.topicId))]):e._e()],1):e._e(),e.normalForm.shortVideoSwitch?a("el-form-item",{attrs:{label:"开头短视频"}},[e.disabled?e._e():a("ResourceSelector",{attrs:{source:e.source,selectors:["shortVideo"],"disable-partner":!!e.source,"auto-fetch-selectors":["shortVideo"],"selection-type":"single"},on:{"select-end":e.handleSelectVideoEnd}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("\n          选择短视频\n        ")])],1),e.normalForm.shortVideoParams.shortVideoId?a("el-tag",{staticClass:"marginL",attrs:{type:"success",closable:!e.disabled},on:{close:function(t){e.normalForm.shortVideoParams.shortVideoId=void 0}}},[e._v("已选择："+e._s(e.normalForm.shortVideoParams.shortVideoId))]):e._e()],1):e._e(),e.isGroupModel?a("div",[e.normalForm.subchannelIs?a("el-form-item",{attrs:{label:"指定子频道",prop:"subchannelId"}},[a("el-input",{attrs:{disabled:e.disabled},model:{value:e.normalForm.subchannelId,callback:function(t){e.$set(e.normalForm,"subchannelId",t)},expression:"normalForm.subchannelId"}})],1):e._e(),a("el-form-item",{attrs:{label:"开启个性化推荐"}},[a("el-switch",{attrs:{disabled:e.judegeRecomStreamDisabled(),value:!!e.normalForm.flagSetRec,"active-color":"#13ce66","inactive-color":"grey"},on:{input:e.handleInputFlagSetRec}})],1),e.normalForm.flagSetRec?[a("RecommendStreamSelector",{attrs:{value:0==e.normalForm.mediaAutomationBlockRls.type?e.normalForm.mediaAutomationBlockRls.mediaAutomationId:"",disabled:e.isReadonly,source:e.source,show:e.showTitle,resolution:"797*449"},on:{"select-end":e.handleSelectRecomStream,"del-select":function(t){e.normalForm.mediaAutomationBlockRls.mediaAutomationId=void 0}}}),a("NewBlockRecStreamSelector",{staticStyle:{margin:"0 0 10px 140px"},attrs:{title:"选择新推荐流","selection-type":"single",source:e.source,disabled:e.isReadonly},on:{"select-end":e.handleSelectBlockRecStreamEnd}}),!1===e.isReadonly&&1===e.normalForm.mediaAutomationBlockRls.type?[e._v("\n          已选择\n          "),1===e.normalForm.mediaAutomationBlockRls.type?a("el-tag",{attrs:{closable:"",disabled:e.isReadonly},on:{close:function(t){return e.handleDelTagClose(e.normalForm.mediaAutomationBlockRls)}}},[e._v("\n          "+e._s(e.normalForm.mediaAutomationBlockRls.mediaAutomationId)+"("+e._s(e.normalForm.mediaAutomationBlockRls.mediaAutomationName)+")\n          ")]):e._e()]:e._e(),!0===e.isReadonly&&1===e.normalForm.mediaAutomationBlockRls.type?[e._v("\n          已选择"),a("el-tag",[e._v("\n          "+e._s(e.normalForm.mediaAutomationBlockRls.mediaAutomationId)+"("+e._s(e.normalForm.mediaAutomationBlockRls.mediaAutomationName)+")\n          ")])]:e._e()]:e._e(),e.normalForm.flagSetRec?a("el-form-item",{attrs:{label:"刷新机制",prop:"mediaAutomationBlockRls.refreshCal"}},[a("InputPositiveInt",{staticClass:"flash-count-input",attrs:{disabled:e.isReadonly},model:{value:e.normalForm.mediaAutomationBlockRls.refreshCal,callback:function(t){e.$set(e.normalForm.mediaAutomationBlockRls,"refreshCal",t)},expression:"normalForm.mediaAutomationBlockRls.refreshCal"}}),e._v("\n        客户端曝光X次之后刷新推荐位\n      ")],1):e._e(),a("el-form-item",{staticStyle:{width:"890px"},attrs:{label:"标题",prop:"title"}},[a("el-input",{attrs:{disabled:e.disabled},model:{value:e.normalForm.title,callback:function(t){e.$set(e.normalForm,"title",t)},expression:"normalForm.title"}}),a("div",{staticClass:"block-stat-viewer"},[a("BroadcastBlockStatChartViewer",{staticClass:"margin-right-10 margin-left-10",attrs:{id:e.id,"selected-title":e.normalForm.title,"selected-type":"total"}},[a("el-button",{attrs:{type:"primary"}},[e._v("整体数据")])],1),a("BroadcastBlockStatChartViewer",{staticClass:"margin-right-10",attrs:{id:e.id,"selected-title":e.normalForm.title,"selected-type":"video"}},[a("el-button",{attrs:{type:"primary"}},[e._v("视频窗数据")])],1),a("BroadcastBlockStatChartViewer",{staticClass:"margin-right-10",attrs:{id:e.id,"selected-title":e.normalForm.title,"selected-type":"static"}},[a("el-button",{attrs:{type:"primary"}},[e._v("静态数据")])],1)],1)],1),a("el-form-item",{attrs:{label:"副标题",prop:"subTitle"}},[a("el-input",{attrs:{disabled:e.disabled},model:{value:e.normalForm.subTitle,callback:function(t){e.$set(e.normalForm,"subTitle",t)},expression:"normalForm.subTitle"}})],1)],2):e._e(),a("el-form-item",{attrs:{label:"海报",prop:"poster.pictureUrl"}},[a("GlobalPictureSelector",{attrs:{disabled:e.isReadonly,"picture-resolution":"797*449"},on:{"select-end":e.handleSelectPostEnd}},[a("el-card",{staticClass:"post-box",staticStyle:{height:"180px"}},[e.normalForm.poster.pictureUrl?a("img",{staticStyle:{height:"180px"},attrs:{referrerpolicy:"no-referrer",src:e.normalForm.poster.pictureUrl}}):e._e()])],1)],1),a("el-form-item",{attrs:{label:"角标"}},[a("el-card",{staticClass:"corner-box"},e._l(e.normalForm.cornerIconList,function(t,n){return a("span",{key:n,staticClass:"corner",class:"corner-"+n},[a("CornerSelector",{attrs:{disabled:e.isReadonly,position:n},on:{"select-end":function(t){return e.handleSelectCornerIconEnd(t,n)}}},[t.imgUrl?a("span",{staticClass:"corner-img-wrapper"},[a("img",{attrs:{referrerpolicy:"no-referrer",src:t.imgUrl}}),e.disabled?e._e():a("i",{staticClass:"el-icon-delete",on:{click:function(t){return t.stopPropagation(),e.handleRemoveCorner(n)}}})]):a("el-tag",{attrs:{type:"success"}},[a("i",{staticClass:"el-icon-plus"})])],1)],1)}),0)],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"play-fullscreen"===e.normalForm.clickType,expression:"normalForm.clickType === 'play-fullscreen'"}],attrs:{label:"正片引导"}},[e.disabled?e._e():a("ResourceSelector",{ref:"resourceSelector",attrs:{"disable-partner":!!e.source,source:e.source,selectors:e.resourceOptionsManualResource,"is-live":!1,"selection-type":"single"},on:{"select-end":function(t){return e.handleSelectGuideByMovie(t)}}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("选择正片引导资源")])],1),e.normalForm.guideConfig.id?a("el-tag",{staticClass:"marginL",attrs:{type:"success",closable:!e.disabled},on:{close:e.handleDelSelectGuideMovie}},[e._v("已选择: "+e._s(e.normalForm.guideConfig.id))]):e._e(),e.normalForm.guideConfig.id&&e.normalForm.guideConfig.vid?a("el-tag",{staticClass:"marginL",attrs:{type:"success"}},[e._v("单集："+e._s(e.normalForm.guideConfig.vid))]):e._e()],1),e.isGroupModel?a("el-form-item",{attrs:{label:"播放完成后"}},[a("el-radio-group",{attrs:{value:e.normalForm.guideConfig.after_play.operation,disabled:e.isReadonly},on:{input:e.handleChooseRecommend,change:e.handleChangeOperation}},[a("el-radio",{attrs:{label:"nextBlock",disabled:e.disabled}},[e._v("播放下一个推荐位")]),a("el-radio",{attrs:{label:"nextFilm",disabled:e.disabled}},[e._v("播放下一集或者相关推荐")]),a("el-radio",{attrs:{label:"theFilm",disabled:e.disabled}},[e._v("播放指定影片")])],1)],1):e._e(),a("el-form-item",["theFilm"===e.normalForm.guideConfig.after_play.operation?a("div",[e.disabled?e._e():a("ResourceSelector",{ref:"resourceSelector",attrs:{"disable-partner":!!e.source,source:e.source,selectors:e.resourceOptionsManualResource,"is-live":!1,"selection-type":"single"},on:{"select-end":function(t){return e.handleSelectGuideResource(t)}}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("选择资源")])],1),e.normalForm.guideConfig.after_play.id?a("el-tag",{staticClass:"marginL",attrs:{type:"success",closable:!e.disabled},on:{close:function(t){e.normalForm.guideConfig.after_play.id=void 0}}},[e._v("已选择: "+e._s(e.normalForm.guideConfig.after_play.id))]):e._e(),e.normalForm.guideConfig.after_play.id&&e.normalForm.guideConfig.after_play.vid?a("el-tag",{staticClass:"marginL",attrs:{type:"success"}},[e._v("单集："+e._s(e.normalForm.guideConfig.after_play.vid))]):e._e()],1):e._e()]),e.isGroupModel?a("el-form-item",{attrs:{label:"点击跳转"}},[a("el-radio-group",{attrs:{value:e.normalForm.clickType},on:{input:e.handleInputClickType}},[a("el-radio",{directives:[{name:"show",rawName:"v-show",value:!e.normalForm.shortVideoSwitch,expression:"!normalForm.shortVideoSwitch"}],attrs:{label:"detail",disabled:e.disabled}},[e._v("点击进详情页")]),a("el-radio",{directives:[{name:"show",rawName:"v-show",value:e.couldFullscreen,expression:"couldFullscreen"}],attrs:{label:"play-fullscreen",disabled:e.disabled}},[e._v("\n          点击直接全屏播放\n        ")])],1)],1):e._e(),e.isGroupModel?a("el-form-item",{attrs:{label:"点击事件",prop:"sign"}},[a("el-radio-group",{attrs:{value:e.normalForm.sign,disabled:e.isManualSetResource},on:{input:e.handleChangeSign}},[a("el-radio",{attrs:{label:"autoSet",disabled:e.disabled}},[e._v("跳转本播放资源")]),"detail"===e.normalForm.clickType?[a("el-radio",{attrs:{label:"manualResource",disabled:e.disabled}},[e._v("跳转其他播放资源")]),a("el-radio",{attrs:{label:"manualSet",disabled:e.disabled}},[e._v("手动设置")])]:e._e()],2)],1):e._e(),a("el-form-item",{attrs:{label:"",prop:"clickParams"}},["manualResource"===e.normalForm.sign?a("div",[e.disabled?e._e():a("ResourceSelector",{ref:"resourceSelector",attrs:{"disable-partner":!!e.source,source:e.source,selectors:e.resourceOptionsManualResource,"is-live":!1,"selection-type":"single"},on:{"select-end":function(t){return e.handleSelectNormalSingleOtherResourceEnd(t)}}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("选择资源")])],1),a("span",{directives:[{name:"show",rawName:"v-show",value:e.changeOneMovie,expression:"changeOneMovie"}]},[e._v("已选择: "+e._s(e.changeOneMovie))])],1):e._e()]),"manualSet"===e.normalForm.sign?a("div",[a("el-form-item",{staticStyle:{width:"890px"},attrs:{label:"打开方式"}},[a("el-select",{attrs:{value:"第三方应用",disabled:e.disabled}},[a("el-option",{attrs:{value:"app"}},[e._v("第三方应用")])],1),a("el-button",{staticClass:"marginL",attrs:{type:"primary",plain:"",disabled:e.disabled},on:{click:e.handleSelectClickEventStart}},[e._v("快速填充")])],1),e.disabled?e._e():a("AppParams",{attrs:{"prop-prefix":"onclick."},model:{value:e.normalForm.onclick,callback:function(t){e.$set(e.normalForm,"onclick",t)},expression:"normalForm.onclick"}}),e.disabled?a("AppParamsRead",{attrs:{value:e.normalForm.onclick}}):e._e()],1):e._e()],1),e.showCrowdSelector?a("CrowdSelector",{on:{"select-cancel":e.handleSelectCrowdCancel,"select-end":e.handleSelectCrowdEnd}}):e._e(),a("el-dialog",{attrs:{visible:e.onclickEventVisible,width:"1200px"},on:{"update:visible":function(t){e.onclickEventVisible=t}}},[a("selectClick",{on:{"row-click":e.handleSelectClickEvent}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.onclickEventVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSelectClickEventEnd}},[e._v("确 定")])],1)],1)],1)},hs=[],ms=a("b1cd"),fs=a("ce06"),vs=a("2149"),gs=a("99eb"),bs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.id?a("div",{staticClass:"chart-viewer"},[a("div",{on:{click:e.handleShowChart}},[e._t("default")],2),e.mountDialog?a("BroadcastSimpleData",{attrs:{show:e.showChart,id:e.id,"selected-title":e.selectedTitle,"selected-type":e.selectedType,isRealTime:e.isRealTime},on:{"update:show":function(t){e.showChart=t}}}):e._e()],1):e._e()},ys=[],ws={components:{BroadcastSimpleData:Nl},props:["id","selectedTitle","selectedType","isRealTime"],data:function(){return{mountDialog:!1,showChart:!1}},computed:{},methods:{handleShowChart:function(){var e=this;this.mountDialog||(this.mountDialog=!0),this.$nextTick(function(){e.showChart=!0,e.$sendEvent({type:"broadcast_data_search"})})}}},Is=ws,Cs=(a("0ea4"),Object(Yo["a"])(Is,bs,ys,!1,null,"14c4d6b8",null)),Ts=Cs.exports,Ss=a("5b59");a("7514");function ks(e){var t=Object.keys(e).find(function(t){return e[t].length>0});return _s(e,t)}function _s(e,t){var a=e[t],n=e.episode||{};return a.forEach(function(e){var t=n[e.coocaaVId];t&&(e.selectedEpisode=t)}),{selectedType:t,selected:a}}function Ps(e,t){if(e.type=t.type,e.coverType=t.coverType,e.subchannelIs="rotate"===t.contentType,e.smallTopicsIs="bigTopic"===t.contentType,e.title=t.title,e.contentType=t.contentType,e.subTitle=t.subTitle,e.thirdIdOrPackageName=t.thirdIdOrPackageName,t.pictureUrl){var a=Object(Go["cloneDeep"])(e.poster);a.pictureUrl=t.pictureUrl,e.poster=a}else e.poster={pictureUrl:""};var n=xs(t);e.params=n,"autoSet"===e.sign&&(e.clickParams=Object(Go["cloneDeep"])(n),e.clickTemplateType=t.contentType)}function xs(e){var t;return"movie"===e.contentType?(t={id:e.thirdIdOrPackageName},e.vid&&(t.vid=e.vid),e.sid&&(t.sid=e.sid)):"app"===e.contentType||"edu"===e.contentType||"txLive"===e.contentType?t={id:e.thirdIdOrPackageName}:"bigTopic"===e.contentType?t={pTopicCode:e.thirdIdOrPackageName}:"topic"===e.contentType?t={topicCode:e.thirdIdOrPackageName}:"rotate"===e.contentType&&(t={rotateId:e.thirdIdOrPackageName}),t}function Fs(e,t){var a={type:"",contentType:"",thirdIdOrPackageName:""},n={tencent:"_otx_",o_tencent:"_otx_",yinhe:"_oqy_",o_iqiyi:"_oqy_",youku:"_oyk_"},i=t._partner;switch(e){case"video":var r=t.selectedEpisodes,o=n[i]||"";r?(6===r.urlIsTrailer&&r.thirdVId?(a.thirdIdOrPackageName=o+r.thirdVId,a.sid=r.coocaaMId):(a.thirdIdOrPackageName=o+t.coocaaVId,a.vid=r.coocaaMId),a.pictureUrl=r.thumb,a.title=r.urlTitle,a.subTitle=r.urlSubTitle):(a.thirdIdOrPackageName=o+t.coocaaVId,a.pictureUrl=t.thumb,a.title=t.title,a.subTitle=t.subTitle),a.contentType="movie",a.type="res",a.coverType="media";break;case"app":a.contentType="app",a.thirdIdOrPackageName=t.appPackageName,a.pictureUrl=t.appImageUrl,a.title=t.appName,a.type="app",a.coverType="app";break;case"edu":a.contentType="edu",a.coverType="media",a.thirdIdOrPackageName="_otx_"+t.coocaaVId,a.platformId=t.source,a.pictureUrl=t.thumb,a.title=t.title,a.subTitle=t.subTitle,a.type="res";break;case"pptv":a.contentType="pptv",a.coverType="media",a.thirdIdOrPackageName="pptv_tvsports://tvsports_detail?section_id="+t.pid+"&from_internal=1",a.title=t.pTitle,a.type="";break;case"live":a.contentType="txLive",a.coverType="media",a.thirdIdOrPackageName="_otx_"+t.vId,a.platformId=t.source,a.pictureUrl=t.thumb,a.title=t.title,a.subTitle=t.subTitle,a.type="live";break;case"topic":"parentTopic"===t.dataSign?a.contentType="bigTopic":a.contentType="topic",a.thirdIdOrPackageName=t.id+"",a.pictureUrl=t.picture,a.title=t.title,a.subTitle=t.subTitle,a.type="topic",a.coverType="media";break;case"rotate":a.contentType="rotate",a.coverType="media",a.thirdIdOrPackageName=t.id+"",a.pictureUrl=t.picture,a.title=t.title,a.subTitle=t.subTitle,a.type="rotate";break;default:break}return a}var Ds=[{label:"影片ID",key:"movie_id",value:void 0,tip:"影片ID，类似：_oqy_84lrco980400，即内容源前缀加酷开ID",default:!0},{label:"影片名称",key:"movie_name",value:void 0,tip:"即影片名称",default:!0},{label:"付费类型",key:"movie_type",value:0,valueType:"number",tip:"付费类型，免费0、单点2、会员1",default:!0},{label:"权益类型",key:"source_sign",value:"yinhe",tip:"权益类型，即产品包后台的权益标识。奇异果VIP是yinhe，腾讯超级影视是6",default:!0},{label:"业务类型",key:"business_type",value:0,tip:"业务类型，影视=0，教育=1",default:!0},{label:"轮播或者点播",key:"live_or_online",value:"online",hide:!0},{label:"影片类型",key:"node_type",value:"res",hide:!0},{label:"鉴权方式",key:"auth_type",value:"0",hide:!0}],Rs={components:{ResourceSelector:jl["a"],GlobalPictureSelector:ms["a"],CornerSelector:zl["a"],AppParams:is,AppParamsRead:us,CrowdSelector:fs["a"],selectClick:Yl,InputPositiveInt:vs["a"],RecommendStreamSelector:gs["a"],BroadcastBlockStatChartViewer:Ts,NewBlockRecStreamSelector:Ss["a"]},data:function(){return{isShowOrHide:!1,onclickEventVisible:!1,showCrowdSelector:!1,showTitle:"选择推荐流"}},mounted:function(){},props:["id","configModel","normalForm","normalRules","isGroupModel","isReadonly","source","checkCrowd","showResourceTip"],computed:{isManualSetResource:function(){return"url"===this.normalForm.type},normalResourceBtn:function(){return this.isGroupModel?"播放资源":"轮播资源"},disabled:function(){return this.isReadonly},resourceOptionsManualResource:function(){return["video","edu","live","rotate"]},resourceOptionsNormalForm:function(){return this.showResourceTip&&"sign"===this.configModel?["rotate"]:["video","edu","live","rotate"]},couldFullscreen:function(){var e=this.normalForm.contentType;return this.normalForm.shortVideoSwitch||["movie","custom","edu","txLive"].indexOf(e)>-1},changeGuideByMovie:function(){return this.getThirdId(this.normalForm.clickParams)},changeOneMovie:function(){return this.getThirdId(this.normalForm.clickParams)},thirdIdOrPackageNameForClick:function(){return this.getThirdId(this.normalForm.clickParams)},singleEpisodeNum:function(){var e=this.normalForm.clickParams;return e.vid||e.sid}},methods:{handleChangeOperation:function(e){"theFilm"!==e&&(this.normalForm.guideConfig.after_play.id="",this.normalForm.guideConfig.after_play.vid="")},handleDelTagClose:function(e){e.type=0,e.mediaAutomationId=void 0,e.mediaAutomationName=void 0,this.isShowOrHide=!1},handleSelectBlockRecStreamEnd:function(e){this.normalForm.mediaAutomationBlockRls.type=1;var t={mediaAutomationId:e[0].id,mediaAutomationName:e[0].recName,recCategory:e[0].recCategory,recFlag:e[0].userToken};this.isShowOrHide=!0,this.normalForm.mediaAutomationBlockRls=Object(Q["a"])({},this.normalForm.mediaAutomationBlockRls,t),console.log(this.normalForm.mediaAutomationBlockRls,this.isShowOrHide,"====")},getThirdId:function(e){if(e){var t=e.id||e.rotateId||e.pTopicCode||e.url;return t}},judegeShortVideoDisabled:function(){var e=this.normalForm,t=this.isReadonly;if(!1===t){if(!e.thirdIdOrPackageName)return!1;if("rotate"===e.clickTemplateType)return!0}return t},judegeRecomStreamDisabled:function(){var e=this.normalForm,t=this.isReadonly;if(!1===t){if(e.shortVideoSwitch)return!0;if(!e.thirdIdOrPackageName)return!1;if("rotate"===e.clickTemplateType)return!0}return t},handleInputClickType:function(e){var t=this.normalForm;t.clickType=e,t.guideConfig.id=void 0,this.handleChangeSign("autoSet")},handleSelectClickEventStart:function(e){this.onclickEventVisible=!0},handleSelectClickEvent:function(e){this.onclickEventVisible=!1,this.clickData=e;var t=JSON.parse(e.params),a=Object.keys(t),n=a.reduce(function(e,a,n){var i={};return i.key=a,i.value=t[a],e.push(i),e},[]),i={packagename:e.packagename,versioncode:e.versioncode,dowhat:e.dowhat,bywhat:e.bywhat,byvalue:e.byvalue,params:n,exception:e.exception?e.exception:{name:"onclick_exception",value:{packagename:"com.tianci.appstore",dowhat:"startActivity",versioncode:"-1",params:{id:e.packagename},byvalue:"coocaa.intent.action.APP_STORE_DETAIL",bywhat:"action"}}};this.normalForm.onclick=i},handleSelectClickEventEnd:function(){},handleSelectNormalSingleResourceEnd:function(e,t){var a=ks(e),n=Fs(a.selectedType,a.selected[0]);Ps(this.normalForm,n),"rotate"===this.normalForm.clickTemplateType&&(this.handleInputFlagSetRec(!1),this.normalForm.clickType="detail"),this.normalForm.shortVideoSwitch=!1},handleSelectNormalSingleOtherResourceEnd:function(e){var t=ks(e),a=Fs(t.selectedType,t.selected[0]);this.normalForm.clickParams=xs(a),this.normalForm.clickTemplateType=a.contentType},handleSelectPostEnd:function(e){this.normalForm.poster={pictureUrl:e.pictureUrl,pictureId:e.pictureId}},handleSelectCornerIconEnd:function(e){var t=e.cornerIconType.typePosition,a={cornerIconId:e.cornerIconId,position:t,imgUrl:e.imgUrl};this.$set(this.normalForm.cornerIconList,t,a)},handleChooseRecommend:function(e){var t=this.normalForm;t.guideConfig.after_play.operation=e},handleChangeSign:function(e){var t=this.normalForm;"autoSet"===e&&(t.onclick="",t.clickParams=t.params,t.clickTemplateType=t.contentType),"manualResource"===e&&(t.onclick="",t.clickParams={},t.clickTemplateType=""),"manualSet"===e&&(t.clickTemplateType="custom",t.onclick="",t.clickParams={}),t.sign=e},handleRemoveCorner:function(e){var t={cornerIconId:"",position:e,imgUrl:""};this.$set(this.normalForm.cornerIconList,e,t)},handleSelectCrowdStart:function(){this.showCrowdSelector=!0},handleSelectCrowdCancel:function(){this.showCrowdSelector=!1},handleSelectCrowdEnd:function(e,t){var a=this.checkCrowd(t);void 0!==a?this.$message({type:"error",message:"第"+(a+1)+"个人群内容已关联该人群"}):(this.$set(this.normalForm,"dmpRegistryInfo",{dmpPolicyId:e.value,dmpCrowdId:t.value,dmpPolicyName:e.label,dmpCrowdName:t.label}),this.$sendEvent({type:"create_block_dmp",payload:{type:"broadcast"}}),this.showCrowdSelector=!1)},handleInputFlagSetRec:function(e){this.normalForm.flagSetRec=e?1:0,e||(this.normalForm.mediaAutomationBlockRls={refreshCal:1,mediaAutomationId:"",blockType:"rotate"})},handleSelectRecomStream:function(e){var t={refreshCal:1,mediaAutomationId:"",blockType:"rotate",type:"0"};this.normalForm.mediaAutomationBlockRls=Object(Q["a"])({},t,this.normalForm.mediaAutomationBlockRls),console.log(e,"---d"),this.normalForm.mediaAutomationBlockRls.mediaAutomationId=e.id,this.normalForm.mediaAutomationBlockRls.mediaAutomationName=e.mediaAutomationName,this.normalForm.mediaAutomationBlockRls.type="0",console.log(this.normalForm.mediaAutomationBlockRls,"----")},handleSwitchShortVideo:function(e){var t=this,a=this.normalForm;a.thirdIdOrPackageName=void 0,a.title=void 0,a.subTitle=void 0,a.poster.pictureUrl=void 0,a.cornerIconList.forEach(function(e,a){t.handleRemoveCorner(a)}),a.shortVideoParams={topicId:void 0,shortVideoId:void 0},e?(a.clickType="play-fullscreen",this.handleChangeSign("autoSet")):a.clickType="detail",a.shortVideoSwitch=e,this.handleInputFlagSetRec(!1),this.$emit("toggle-use-short-video",e)},handleSelectVideoTopicEnd:function(e){var t=e.shortVideoTopic;this.normalForm.shortVideoParams.topicId=t[0].id,this.normalForm.title=t[0].topicName},handleSelectVideoEnd:function(e){var t=e.shortVideo,a=this.$consts.sourcePrefix[this.source]||"";if(!a){var n=this.$consts.partnerToSource[t[0].source];a=this.$consts.sourcePrefix[n]}this.normalForm.shortVideoParams.shortVideoId=a+t[0].sCoocaaMId},handleSelectGuideByMovie:function(e){var t=ks(e),a=Fs(t.selectedType,t.selected[0]),n=this.normalForm.guideConfig;n.id=a.thirdIdOrPackageName,n.vid=a.vid},handleDelSelectGuideMovie:function(){this.normalForm.guideConfig.id=void 0,this.normalForm.guideConfig.vid=void 0},handleSelectGuideResource:function(e){var t=this,a=ks(e),n=Fs(a.selectedType,a.selected[0]);this.$set(this.normalForm.guideConfig.after_play,"id",""),this.$set(this.normalForm.guideConfig.after_play,"vid",""),this.$nextTick(function(){t.normalForm.guideConfig.after_play.id=n.thirdIdOrPackageName,t.normalForm.guideConfig.after_play.vid=n.vid})}},created:function(){void 0===this.normalForm.guideConfig.id&&(this.normalForm.guideConfig={id:"",vid:"",after_play:{operation:"nextFilm",id:"",vid:""}}),console.log(this.normalForm.mediaAutomationBlockRls,"-----获取详23情数据")}},Ls=Rs,$s=(a("f239"),Object(Yo["a"])(Ls,ps,hs,!1,null,"7e63fbab",null)),Ns=$s.exports,Es=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"normalForm",staticClass:"el-form-add",staticStyle:{float:"left",width:"75%"},attrs:{model:e.normalForm,rules:e.normalRules,"label-width":"140px"}},[a("el-form-item",{attrs:{label:"资源类别",prop:"coverType"}},[a("CommonSelector",{attrs:{disabled:e.isReadonly,type:"radio-button",value:e.normalForm.coverType,disabledItems:e.disabledCoverTypes,hiddenItems:e.hiddenCoverTypes,options:e.pannelCoverTypeTwo},on:{input:function(t){return e.$emit("cover-type-change",t)}}})],1),a("el-form-item",{attrs:{label:"海报",prop:"poster.pictureUrl"}},[a("GlobalPictureSelector",{attrs:{disabled:e.isReadonly,"picture-resolution":"797*449"},on:{"select-end":e.handleSelectPostEnd}},[a("el-card",{staticClass:"post-box",staticStyle:{height:"180px"}},[e.normalForm.poster.pictureUrl?a("img",{staticStyle:{height:"180px"},attrs:{referrerpolicy:"no-referrer",src:e.normalForm.poster.pictureUrl}}):e._e()])],1)],1),"custom"!==e.normalForm.coverType?a("el-form-item",{attrs:{label:"选择媒体资源",prop:"thirdIdOrPackageName"}},[e.isManualSetResource||"媒体资源"!==e.normalResourceBtn||e.disabled?e._e():a("ResourceSelector",{ref:"resourceSelector",attrs:{source:e.source,"disable-partner":!!e.source,selectors:e.resourceOptionsNormalForm,"is-live":!1,"id-type":1,"selection-type":"single"},on:{"select-end":function(t){return e.handleSelectNormalSingleResourceEnd(t,"Multiple")}}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("选择资源")])],1),e.isManualSetResource?a("el-input",{staticStyle:{float:"left"},attrs:{disabled:e.disabled},model:{value:e.normalForm.thirdIdOrPackageName,callback:function(t){e.$set(e.normalForm,"thirdIdOrPackageName",t)},expression:"normalForm.thirdIdOrPackageName"}}):e._e(),e.normalForm.thirdIdOrPackageName&&!e.isManualSetResource?a("el-tag",{staticClass:"marginL",attrs:{type:"success",closable:!e.disabled},on:{close:function(t){e.normalForm.thirdIdOrPackageName=void 0}}},[e._v("已选择："+e._s(e.normalForm.thirdIdOrPackageName))]):e._e(),e.normalForm.thirdIdOrPackageName&&e.singleEpisodeNum?a("el-tag",{staticClass:"marginL",attrs:{type:"success"}},[e._v("单集："+e._s(e.singleEpisodeNum))]):e._e(),e.isManualSetResource&&e.isGroupModel&&!e.disabled?a("a",{staticClass:"write-play",staticStyle:{float:"left"},attrs:{href:"#"},on:{click:function(t){return e.$emit("toggle-manaulset-resource",!1)}}},[e._v("自动配置播放资源")]):e._e(),"sign"===e.configModel&&e.showResourceTip?a("div",{staticClass:"sign-tip"},[e._v("\n        信号源模式的第一个资源必须是轮播资源\n      ")]):e._e()],1):e._e(),e.isGroupModel?a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{attrs:{disabled:e.isReadonly},model:{value:e.normalForm.title,callback:function(t){e.$set(e.normalForm,"title",t)},expression:"normalForm.title"}})],1):e._e(),a("el-form-item",{attrs:{prop:"clickParams"}},["manualResource"===e.normalForm.sign?a("div",[e.disabled?e._e():a("ResourceSelector",{ref:"resourceSelector",attrs:{"disable-partner":!!e.source,source:e.source,selectors:e.resourceOptionsManualResource,"is-live":!1,"selection-type":"single"},on:{"select-end":function(t){return e.handleSelectNormalSingleOtherResourceEnd(t)}}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("选择资源")])],1),a("span",{directives:[{name:"show",rawName:"v-show",value:e.thirdIdOrPackageNameForClick,expression:"thirdIdOrPackageNameForClick"}]},[e._v("已选择: "+e._s(e.thirdIdOrPackageNameForClick))])],1):e._e()]),"custom"===e.normalForm.coverType?a("div",{attrs:{pop:"guideConfig.after_play.operation"}},[a("el-form-item",{attrs:{label:"打开方式"}},[a("el-select",{attrs:{value:"第三方应用",disabled:e.disabled}},[a("el-option",{attrs:{value:"app"}},[e._v("第三方应用")])],1),a("el-button",{staticClass:"marginL",attrs:{type:"primary",plain:"",disabled:e.disabled},on:{click:e.handleSelectClickEventStart}},[e._v("快速填充")])],1),e.disabled?e._e():a("AppParams",{ref:"formProp",attrs:{"prop-prefix":"onclick."},model:{value:e.normalForm.onclick,callback:function(t){e.$set(e.normalForm,"onclick",t)},expression:"normalForm.onclick"}}),e.disabled?a("AppParamsRead",{attrs:{value:e.normalForm.onclick}}):e._e()],1):e._e()],1),e.showCrowdSelector?a("CrowdSelector",{on:{"select-cancel":e.handleSelectCrowdCancel,"select-end":e.handleSelectCrowdEnd}}):e._e(),a("el-dialog",{attrs:{visible:e.onclickEventVisible,width:"1200px"},on:{"update:visible":function(t){e.onclickEventVisible=t}}},[a("selectClick",{on:{"row-click":e.handleSelectClickEvent}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.onclickEventVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSelectClickEventEnd}},[e._v("确 定")])],1)],1)],1)},Os=[],As={components:{ResourceSelector:jl["a"],GlobalPictureSelector:ms["a"],AppParams:is,AppParamsRead:us,CrowdSelector:fs["a"],selectClick:Yl,CommonSelector:es["a"]},data:function(){return{onclickEventVisible:!1,showCrowdSelector:!1,pannelCoverTypeTwo:[]}},props:["id","configModel","normalForm","normalRules","isGroupModel","isReadonly","source","checkCrowd","showResourceTip"],computed:{isManualSetResource:function(){return"url"===this.normalForm.type},normalResourceBtn:function(){return this.isGroupModel?"媒体资源":""},disabled:function(){return this.isReadonly},resourceOptionsManualResource:function(){return["video","edu","live","rotate"]},resourceOptionsNormalForm:function(){return this.showResourceTip&&"sign"===this.configModel?["rotate"]:["video","edu","live","rotate"]},couldFullscreen:function(){var e=this.normalForm.contentType;return this.normalForm.shortVideoSwitch||["movie","custom","edu","txLive"].indexOf(e)>-1},thirdIdOrPackageNameForClick:function(){return this.getThirdId(this.normalForm.clickParams)},singleEpisodeNum:function(){var e=this.normalForm.clickParams;return e.vid||e.sid},hiddenCoverTypes:function(){return"specific"===this.contentType?["block"]:[]},disabledCoverTypes:function(){return this.isMall?["block"]:[]}},mounted:function(){var e=this;this.$consts.panelCoverTypeOptions.map(function(t,a){0!==a&&2!==a||e.pannelCoverTypeTwo.push(t)})},methods:{getThirdId:function(e){if(e){var t=e.id||e.rotateId||e.pTopicCode||e.url;return t}},judegeShortVideoDisabled:function(){var e=this.normalForm,t=this.isReadonly;if(!1===t){if(!e.thirdIdOrPackageName)return!1;if("rotate"===e.clickTemplateType)return!0}return t},judegeRecomStreamDisabled:function(){var e=this.normalForm,t=this.isReadonly;if(!1===t){if(e.shortVideoSwitch)return!0;if(!e.thirdIdOrPackageName)return!1;if("rotate"===e.clickTemplateType)return!0}return t},handleInputClickType:function(e){var t=this.normalForm;t.clickType=e,this.handleChangeSign("autoSet")},handleSelectClickEventStart:function(e){this.onclickEventVisible=!0},handleSelectClickEvent:function(e){this.onclickEventVisible=!1,this.clickData=e;var t=JSON.parse(e.params),a=Object.keys(t),n=a.reduce(function(e,a,n){var i={};return i.key=a,i.value=t[a],e.push(i),e},[]),i={packagename:e.packagename,versioncode:e.versioncode,dowhat:e.dowhat,bywhat:e.bywhat,byvalue:e.byvalue,params:n,exception:e.exception?e.exception:{name:"onclick_exception",value:{packagename:"com.tianci.appstore",dowhat:"startActivity",versioncode:"-1",params:{id:e.packagename},byvalue:"coocaa.intent.action.APP_STORE_DETAIL",bywhat:"action"}}};this.normalForm.onclick=i},handleSelectClickEventEnd:function(){},handleSelectNormalSingleResourceEnd:function(e,t){var a=ks(e),n=Fs(a.selectedType,a.selected[0]);Ps(this.normalForm,n),"rotate"===this.normalForm.clickTemplateType&&(this.handleInputFlagSetRec(!1),this.normalForm.clickType="detail"),this.normalForm.shortVideoSwitch=!1},handleSelectNormalSingleOtherResourceEnd:function(e){var t=ks(e),a=Fs(t.selectedType,t.selected[0]);this.normalForm.clickParams=xs(a),this.normalForm.clickTemplateType=a.contentType},handleSelectPostEnd:function(e){this.normalForm.poster={pictureUrl:e.pictureUrl,pictureId:e.pictureId}},handleSelectCornerIconEnd:function(e){var t=e.cornerIconType.typePosition,a={cornerIconId:e.cornerIconId,position:t,imgUrl:e.imgUrl};this.$set(this.normalForm.cornerIconList,t,a)},handleChangeSign:function(e){var t=this.normalForm;"autoSet"===e&&(t.onclick="",t.clickParams=t.params,t.clickTemplateType=t.contentType),"manualResource"===e&&(t.onclick="",t.clickParams={},t.clickTemplateType=""),"manualSet"===e&&(t.clickTemplateType="custom",t.clickParams={}),t.sign=e},handleRemoveCorner:function(e){var t={cornerIconId:"",position:e,imgUrl:""};this.$set(this.normalForm.cornerIconList,e,t)},handleSelectCrowdStart:function(){this.showCrowdSelector=!0},handleSelectCrowdCancel:function(){this.showCrowdSelector=!1},handleSelectCrowdEnd:function(e,t){var a=this.checkCrowd(t);void 0!==a?this.$message({type:"error",message:"第"+(a+1)+"个人群内容已关联该人群"}):(this.$set(this.normalForm,"dmpRegistryInfo",{dmpPolicyId:e.value,dmpCrowdId:t.value,dmpPolicyName:e.label,dmpCrowdName:t.label}),this.$sendEvent({type:"create_block_dmp",payload:{type:"broadcast"}}),this.showCrowdSelector=!1)},handleInputFlagSetRec:function(e){this.normalForm.flagSetRec=e?1:0,e||(this.normalForm.mediaAutomationBlockRls={refreshCal:1,mediaAutomationId:"",blockType:"rotate"})},handleSelectRecomStream:function(e){this.normalForm.mediaAutomationBlockRls.mediaAutomationId=e.id},handleSwitchShortVideo:function(e){var t=this,a=this.normalForm;a.thirdIdOrPackageName=void 0,a.title=void 0,a.subTitle=void 0,a.poster.pictureUrl=void 0,a.cornerIconList.forEach(function(e,a){t.handleRemoveCorner(a)}),a.shortVideoParams={topicId:void 0,shortVideoId:void 0},e?(a.clickType="play-fullscreen",this.handleChangeSign("autoSet")):a.clickType="detail",a.shortVideoSwitch=e,this.handleInputFlagSetRec(!1),this.$emit("toggle-use-short-video",e)},handleSelectVideoTopicEnd:function(e){var t=e.shortVideoTopic;this.normalForm.shortVideoParams.topicId=t[0].id,this.normalForm.title=t[0].topicName},handleSelectVideoEnd:function(e){var t=e.shortVideo,a=this.$consts.sourcePrefix[this.source]||"";if(!a){var n=this.$consts.partnerToSource[t[0].source];a=this.$consts.sourcePrefix[n]}this.normalForm.shortVideoParams.shortVideoId=a+t[0].sCoocaaMId}}},Vs=As,Bs=(a("04b2"),Object(Yo["a"])(Vs,Es,Os,!1,null,"3a8b89fc",null)),Ms=Bs.exports,Us={mixins:[ds["a"]],components:{TabPage:Il["a"],draggable:Gl.a,ResourceSelector:jl["a"],GlobalPictureSelector:ms["a"],CornerSelector:zl["a"],selectClick:Yl,AppParams:is,AppParamsRead:us,CommonContent:Ql["a"],BroadcastBlockForm:Ns,BroadcastBlockStatChartViewer:Ts,BroadcastBlockFormSpe:Ms},props:["id","initMode","version"],data:function(){var e=this;return{mode:"create",resourceName:"轮播推荐位",pictureResolution:"797*449",type:"block",menuElId:"broadcastBlock",onclickEventVisibleFlag:"",clickData:void 0,onclickEventVisible:!1,cornerIconTypeOptions:{},cornerTypes:[],materialTypes:null,basicForm:{id:void 0,containerName:"",containerType:"REFERENCE_BROADCASTING",configModel:"purePoster",currentVersion:void 0,status:void 0,source:"none"},normalForm:{},lowerForm:{coverType:"media"},auditDisabled:!1,normalRules:{title:[{required:!0,message:"请填写标题",trigger:"blur"}],"poster.pictureUrl":[{required:!0,message:"请上传海报",trigger:"blur"}],thirdIdOrPackageName:[{required:!0,message:"请填选择资源",trigger:"blur"}],clickParams:[{validator:function(t,a,n){var i=e.normalForm;if("manualResource"===i.sign&&(!a||"{}"===JSON.stringify(a)))return n(Error("请选择资源"));n()}}],dmpRegistryInfo:[{required:!0,message:"请选择定向人群"}],"mediaAutomationBlockRls.refreshCal":[{required:!0,message:"当开关开启时必填",trigger:"blur"}],"shortVideoParams.topicId":[{required:!0,message:"请选择跳转话题"}]},lowerRules:{title:[{required:!0,message:"请填写标题",trigger:"blur"}],"poster.pictureUrl":[{required:!0,message:"请上传海报",trigger:"blur"}],thirdIdOrPackageName:[{required:!0,message:"请填选择资源",trigger:"blur"}],versionCode:[{validator:function(e,t,a){if(!/^(-1|\d*)$/.test(t))return a(new Error("应用版本号只能是数字或者-1"));a()}}]},currentIndex:0,pictureListOptions:{poster:{idField:"pictureId",searchParams:{pictureId:{label:"素材ID"},pictureName:{label:"素材名称"},pictureCategory:{label:"素材类别",options:[]},pictureStatus:{label:"素材状态",options:[{label:"审核通过",value:"1"},{label:"待审核",value:"2"}]}},picField:"pictureUrl",textItems:[{field:"pictureName"},{field:"pictureStatus",customFormatter:function(e,t){return["","审核通过","待审核"][t]}}]},corner:{idField:"cornerIconId",searchParams:{cornerIconId:{label:"角标ID"},cornerIconName:{label:"角标名称"},"cornerIconType.typeId":{label:"角标类别",options:[]}},picField:"imgUrl",textItems:[{field:"cornerIconName"},{field:"cornerStatus",customFormatter:function(e,t){return["","审核通过","待审核"][t]}}]}},versionForm:this.genDefaultContentForm(),pictureType:"",currentForm:"",pannelResource:"",normalVersionContent:[],openModeArray:[{name:"第三方应用",value:"app"}],referenceData:[],noPreview:"noPreview",referenceOptions:{picture:!1},layoutOptions:{contentDataNew:[]},selectPicture:"",resourceSeq:"",layoutparam:{},layouttypenew:"",checkresourceis:!0,singleEpisodeNum:void 0}},computed:{disabled:function(){return"read"===this.mode},isReadonly:function(){return this.disabled},dmpContentList:function(){return this.normalForm.dmpContentList||[]},activeDmpIndex:function(){return this.normalForm.activeIndex},resourceOptionsLowerForm:function(){return"app"===this.lowerForm.coverType?["app"]:["video","edu","live","rotate"]},resourceOptionsManualResource:function(){return["video","edu","live","rotate"]},resourceOptionsNormalForm:function(){return 0===this.currentIndex&&"sign"===this.basicForm.configModel?["rotate"]:["video","edu","live","rotate"]},resourceOptions:function(){return["video","edu","live","rotate"]},isManualSetResource:function(){return"url"===this.normalForm.type},normalResourceBtn:function(){return this.isGroupModel?"播放资源":"轮播资源"},isGroupModel:function(){var e=this.basicForm.configModel;return e},source:function(){return"none"===this.basicForm.source?"":this.basicForm.source},thirdIdOrPackageNameForClick:function(){return this.getThirdId(this.normalForm.clickParams)},couldFullscreen:function(){var e=this.normalForm.contentType;return["movie","custom","edu","txLive"].indexOf(e)>-1},classObject:function(){return this.normalForm.sign,{height:"600px"}},resourceInfo:function(){var e=this.basicForm;if(e.id)return{id:e.id,type:this.type,menuElId:this.menuElId,version:e.currentVersion,status:e.status}},couldSetReleaseTime:function(){var e=this.mode,t=this.basicForm.currentVersion,a="create"===e||"copy"===e,n="edit"===e&&"V1"===t,i="10"===this.$consts.idPrefix;return i&&!(a||n)},isReplica:function(){return"replicated"===this.mode||"yes"===this.basicForm.duplicateVersion}},watch:{},methods:{handleActivateDmpContent:function(e){var t=this;this.dmpContentList[this.activeDmpIndex]?this.checkNormalForm(function(){t.normalForm.activeIndex=e}):this.normalForm.activeIndex=e},handleCoverTypeChange:function(e){var t=this.normalVersionContent,a=Object.assign({},this.versionForm);a.coverType=e,"custom"===e&&(a.sign="openMode==app",a.contentType="custom",a.params={},a.clickTemplateType="custom"),this.normalForm=a,t.splice(this.currentIndex,1,a)},handleRemoveDmpContent:function(e){var t=this;this.$confirm("确认删除该内容","提示",{callback:function(a){if("confirm"===a){var n=t.activeDmpIndex,i=t.dmpContentList;i.splice(e,1),i.length>0?void 0===i[n]&&t.handleActivateDmpContent(e-1):t.handleActivateDmpContent(0)}}})},handleSwitchShowContentType:function(e){var t=this;"general"===e&&0===this.dmpContentList.length?this.normalForm.showContentType=e:this.checkNormalForm(function(){t.normalForm.showContentType=e})},handleAddDmpContent:function(){var e=this,t=this.normalForm,a=t.dmpContentList;a.length>0?this.checkNormalForm(function(){a.push(e.genDefaultContentForm({isDmpContent:!0})),t.activeIndex=a.length-1}):(a.push(this.genDefaultContentForm({isDmpContent:!0})),t.activeIndex=a.length-1)},handleDragDmpConentStart:function(e){},handleDragDmpConentEnd:function(e){var t=this.normalForm,a=t.activeIndex,n=e.oldIndex,i=e.newIndex;n===a?t.activeIndex=i:n<a&&i>=a?t.activeIndex=a-1:n>a&&i<=a&&(t.activeIndex=a+1)},checkCrowd:function(e){var t,a,n=this.dmpContentList,i=n.length;while(--i>=0)if(a=n[i].dmpRegistryInfo,a&&a.dmpCrowdId===e.value){t=i;break}return t},handleSourceChange:function(e){this.$confirm("切换内容源将清空内容, 确定切换?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){this.normalForm=this.genDefaultContentForm(),this.normalVersionContent=[this.normalForm],this.currentIndex=0,this.cleanLowerForm("media"),this.basicForm.source=e}.bind(this)).catch(function(e){})},getThirdId:function(e){if(e){var t=e.id||e.rotateId||e.pTopicCode||e.url;return t}},replicate:function(){this.mode="replicate"},edit:function(){this.mode="edit"},clickThirdpartSubmit:function(){var e=this.onclickEventVisibleFlag;if("lower"===e){var t=this.$refs.openWayLower.inputValue;this.parseOnclick(t)}else{var a=this.$refs.openWayNormal.inputValue;this.parseOnclick(a)}},parseOnclick:function(e){var t=this.clickData;Object.keys(e).map(function(a){if("params"===a){var n=JSON.parse(t[a]);e[a]=Object.keys(n).map(function(e){return{key:e,value:n[e]}})}else e[a]=t[a]})},getClickData:function(e){this.onclickEventVisible=!1,this.clickData=e;var t=JSON.parse(e.params),a=Object.keys(t),n=a.reduce(function(e,a,n){var i={};return i.key=a,i.value=t[a],e.push(i),e},[]),i={packagename:e.packagename,versioncode:e.versioncode,dowhat:e.dowhat,bywhat:e.bywhat,byvalue:e.byvalue,params:n,exception:e.exception};this[this.onclickEventVisibleFlag+"Form"]["onclick"]=i},handleChangeSign:function(e){var t=this.normalForm;"autoSet"===e&&(t.onclick="",t.clickParams=t.params,t.clickTemplateType=t.contentType),"manualResource"===e&&(t.onclick="",t.clickParams={},t.clickTemplateType=""),"manualSet"===e&&(t.clickTemplateType="custom",t.clickParams={}),t.sign=e},handleToggleManualSetResource:function(e,t){var a=this.genDefaultContentForm();if(e?(a.sign="manualSet",a.type="url",a.params={url:"",source:"",name:"",needParse:"false",url_type:"web"},a.clickTemplateType="custom",a.clickParams={}):(a.sign="autoSet",a.onclick="",a.clickParams=a.params,a.clickTemplateType=a.contentType),"dmp"===t){a.isDmpContent=!0;var n=this.normalForm;this.$set(n.dmpContentList,n.activeIndex,a)}else this.$set(this.normalVersionContent,this.currentIndex,a),this.normalForm=a},handleToggleUseShortVideo:function(e,t){var a;a="dmp"===t?this.normalForm.dmpContentList[this.normalForm.activeIndex]:this.normalForm,e&&(a.type="shortVideo"),a.shortVideoSwitch=e,a.sign="autoSet",a.onclick="",a.clickParams=a.params,a.clickTemplateType=a.contentType},deleteCorner:function(e,t){var a=e.cornerIconList.slice();a[t]={cornerIconId:"",imgUrl:"",position:t},e.cornerIconList=a},handleInputConfigModel:function(e){var t=this;this.$confirm("切换后配置数据将被清空, 是否确认切换?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$message({type:"success",message:"模式切换成功!"}),t.basicForm.configModel=e,t.currentIndex=0,t.clearFormAll()}).catch(function(){t.$message({type:"info",message:"已取消切换"})})},clearFormAll:function(){var e=Object(Go["cloneDeep"])(this.versionForm),t=Object(Go["cloneDeep"])(this.versionForm);this.lowerForm=t,this.normalForm=e,this.normalVersionContent=[e]},handleSelectNormalmultipleResourceEnd:function(e){var t,a=this,n=this.resourceOptions,i=[];n.forEach(function(t){e[t].forEach(function(e){var n=a.genDefaultContentForm(),r=Fs(t,e);Ps(n,r),i.push(n)})}),(t=this.normalVersionContent).splice.apply(t,[this.currentIndex,i.length].concat(i)),this.normalForm=this.genDefaultContentForm(),this.normalForm=Object.assign(this.normalVersionContent[this.currentIndex])},handleSelectLowerSingleResourceEnd:function(e){var t=ks(e),a=Fs(t.selectedType,t.selected[0]);Ps(this.lowerForm,a)},checkNormalForm:function(e){var t=this,a=this.$refs.broadcastBlockForm,n=this.$refs.broadcastBlockFormSpe;if(this.$refs.broadcastBlockForm){var i=this.$refs.broadcastBlockForm.normalForm;if("theFilm"===i.guideConfig.after_play.operation&&!i.guideConfig.after_play.id&&!i.guideConfig.after_play.vid)return this.$message.error("请指定播放资源！");if(1===i.flagSetRec){if(!i.mediaAutomationBlockRls.mediaAutomationId&&!i.mediaAutomationBlockRls.recId)return this.$message.error("开关开启时，推荐流选择必须选择其一");if(i.mediaAutomationBlockRls.mediaAutomationId&&i.mediaAutomationBlockRls.recId)return this.$message.error("开关开启时，推荐流只能保存其一")}a.$refs.normalForm.validate(function(a){a?e():t.$message.error("请将表单填写完整")})}else n?n.$refs.normalForm.validate(function(a){a?e():t.$message.error("请将表单填写完整")}):e()},genDefaultContentForm:function(e){return Object(Q["a"])({flagSetRec:0,mediaAutomationBlockRls:{refreshCal:1,mediaAutomationId:"",blockType:"rotate",type:"0"},title:"",subTitle:"",type:"",coverType:"media",thirdIdOrPackageName:"",subchannelId:"",subchannelIs:"",params:{},clickType:"detail",onclick:{},sign:"autoSet",guideConfig:{id:"",vid:"",after_play:{operation:"nextFilm",id:"",vid:""}},contentType:"",clickParams:{},poster:{},cornerIconList:[{},{},{},{}],showContentType:"general",dmpContentList:[],activeIndex:0,isDmpContent:!1,shortVideoParams:{topicId:void 0,shortVideoId:void 0},shortVideoSwitch:!1},e)},handleAddNormalContent:function(){var e=this;this.checkNormalForm(function(){e.normalForm=e.genDefaultContentForm(),e.normalVersionContent.push(e.normalForm),e.currentIndex=e.normalVersionContent.length-1,console.log(e.currentIndex,"----currentIndex")})},handleDeleteNormalContent:function(e){var t=this;this.$confirm("是否删除当前选中项?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.normalVersionContent.splice(e,1),t.currentIndex=0,t.normalForm=t.normalVersionContent[0],t.$message({type:"success",message:"删除成功!"})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleActivateContent:function(e){var t=this;this.checkNormalForm(function(){t.currentIndex=e,t.normalForm=t.normalVersionContent[e]})},handleSelectPostEnd:function(e){this.lowerForm.poster={pictureUrl:e.pictureUrl,pictureId:e.pictureId}},handleSelectCornerIconEnd:function(e){var t=e.cornerIconType.typePosition,a={cornerIconId:e.cornerIconId,position:t,imgUrl:e.imgUrl};this.$set(this.lowerForm.cornerIconList,t,a)},onDragStart:function(e){console.log(e)},onDragtEnd:function(e){var t=e.oldIndex,a=e.newIndex,n=this.currentIndex;t===n?this.currentIndex=e.newIndex:t<n&&a>=n?this.currentIndex=n-1:t>n&&a<=n&&(this.currentIndex=n+1)},lowerFill:function(){var e=this,t=Object(Go["cloneDeep"])(this.normalVersionContent[0]);!0!==t.shortVideoSwitch?(t.dmpContentList=void 0,"manualSet"!==t.sign?(this.lowerForm.coverType=t.coverType,this.$nextTick(function(){e.lowerForm=t})):this.$message({type:"error",message:"手动填写的资源不能填充，请填充自动配置的播放资源，资源填充使用的是正常版本的第一个资源。"})):this.$message({type:"error",message:"第一个资源是短视频资源，无法快速填充。"})},handleInputLowerFormCoverType:function(e){this.cleanLowerForm(e)},cleanLowerForm:function(e){var t=Object.assign({},this.versionForm);t.type=e,t.coverType=e,"custom"===e&&(t.sign="openMode==app",t.contentType="custom",t.params={},t.clickTemplateType="custom"),this.lowerForm=t},validate:function(e,t){var a=this,n=e.normalVersionContent[0],i=n.guideConfig,r=n.contentType;this.$refs.basicForm.validate(function(o){o?a.checkNormalForm(function(){if("theFilm"===i.after_play.operation&&!i.after_play.id&&!i.after_play.vid)return a.$message.error("请指定播放资源！");if(""===r&&"url"!==n.type)return a.$message.error("请选择资源！");if(n.mediaAutomationBlockRls.recId){var o=n.mediaAutomationBlockRls.recId;n.mediaAutomationBlockRls.mediaAutomationId=o}a.$refs.lowerForm.validate(function(n){if(n){var i=e.configModel,r=e.normalVersionContent;if("group"===i&&r.length<4)return a.$message.error("组合模式下，正常版本的配置资源至少4个，才可以进行保存！");if("sign"===i){var o=r[0];if("rotate"!==o.contentType)return a.$message.error("信号源模式下，第一个资源必须是轮播资源")}for(var l=0;l<r.length;l++)if(!r[l].poster.pictureUrl)return a.$message.error("请设置第 ".concat(l+1," 个内容的海报"));t()}else a.$message.error("请将表单填写完整3")})}):a.$message.error("请将表单填写完整4")})},getFormData:function(){var e=Object(Go["cloneDeep"])(this.basicForm);return e.normalVersionContent=this.isGroupModel?Object(Go["cloneDeep"])(this.normalVersionContent):[Object(Go["cloneDeep"])(this.normalForm)],e.lowerVersionContent=Object(Go["cloneDeep"])(this.lowerForm),e},handleSaveDraft:function(){var e=this,t=this.getFormData();t.isTiming=void 0,t.releaseTime=void 0,t.status=this.$consts.status.draft,this.validate(t,function(){e.doSave(t)})},handleSubmitAudit:function(e){var t=this,a=this.getFormData();console.log(a),a.status=this.$consts.status.waiting,this.validate(a,function(){t.couldSetReleaseTime?e?(a.isTiming=e.isTiming,a.releaseTime=e.releaseTime,t.doSave(a)):t.$refs.commonContent.showReleaseTimeSetter=!0:t.doSave(a)})},doSave:function(e){var t=this,a=function(e){var t=e.params||[];e.params=t.reduce(function(e,t){return e[t.key]=t.value,e},{})};"replicate"===this.mode&&(e.currentVersion="");var n=function e(t){return!0===t.shortVideoSwitch&&(t.type="shortVideo",t.params=Object(Q["a"])({},t.shortVideoParams),"autoSet"===t.sign&&(t.clickParams={},t.clickTemplateType="shortVideo"),t.coverType="shortVideo",t.contentType="shortVideo"),"url"===t.type&&(t.params={url:t.thirdIdOrPackageName,source:"",name:t.title,needParse:"false",url_type:"web"}),t.onclick&&("custom"!==t.coverType&&"purePoster"===t.configModel?t.onclick="":(a(t.onclick),t.onclick=JSON.stringify(t.onclick||""))),t.subchannelId&&(t.params.stationId=t.subchannelId,delete t.subchannelId),"custom"===t.coverType&&(t.contentType="custom"),t.params=JSON.stringify(t.params),t.clickParams=JSON.stringify(t.clickParams),t.guideConfig=JSON.stringify(t.guideConfig),t.dmpContentList.length>0?t.dmpContentList=t.dmpContentList.map(e):t.dmpContentList=void 0,delete t.shortVideoSwitch,delete t.shortVideoParams,delete t.thirdIdOrPackageName,delete t.activeIndex,delete t.showContentType,delete t.isDmpContent,delete t.mediaAutomationBlockRls.type,t};e.normalVersionContent=e.normalVersionContent.map(n);var i=e.lowerVersionContent;i.coverType&&a(i.onclick),i.smallTopicsId&&(i.params.topicCode=i.smallTopicsId,delete i.smallTopicsId),i.subchannelId&&(i.params.stationId=i.subchannelId,delete i.subchannelId),i.params=JSON.stringify(i.params),"custom"!==i.coverType?i.onclick="":i.onclick=JSON.stringify(i.onclick),e.parentType="Block",this.$service.saveBlockInfo({jsonStr:JSON.stringify(e)},"提交成功").then(function(){t.$emit("upsert-end")})},fetchData:function(e){var t=this;this.$service.getBroadcastBlockEditData({id:this.id,version:e}).then(function(e){var a=t.basicForm;a.containerName=e.containerName,a.containerType="REFERENCE_BROADCASTING",a.configModel=e.configModel,a.source=e.source,a.status=e.status,a.id=e.id,a.currentVersion=e.currentVersion,a.duplicateVersion=e.duplicateVersion;var n=function(e){if(e){var t=e.params||{};e.params=Object.keys(t).map(function(e){return{key:e,value:t[e]}})}},i=function(e){e.cornerIconList=(e.cornerIconList||[]).reduce(function(e,t){return e[t.position]=t,e},[{},{},{},{}])},r={id:"",vid:"",after_play:{operation:"",id:"",vid:""}},o={mediaAutomationId:"",mediaAutomationName:"",refreshCal:"1",type:""},l=function e(a,l){return a.onclick=JSON.parse(a.onclick),a.params=JSON.parse(a.params||"{}"),a.clickParams=JSON.parse(a.clickParams||"{}"),a.guideConfig=JSON.parse(a.guideConfig||JSON.stringify(r)),a.mediaAutomationBlockRls=a.mediaAutomationBlockRls||o,i(a),n(a.onclick),a.params.topicId&&(a.shortVideoSwitch=!0,a.shortVideoParams={topicId:void 0,shortVideoId:void 0},Object.assign(a.shortVideoParams,a.params)),a.thirdIdOrPackageName=t.getThirdId(a.params),a.subchannelIs="rotate"===a.contentType,a.subchannelIs&&(a.subchannelId=a.params.stationId),a.dmpContentList&&(a.dmpContentList=a.dmpContentList.map(function(t){return e(t,!0)})),a=t.genDefaultContentForm(Object(Q["a"])({},a,{isDmpContent:l})),a};t.normalVersionContent=e.normalVersionContent.map(function(e){return l(e,!1)}),t.normalForm=t.normalVersionContent[0];var s=Object(Go["cloneDeep"])(e.lowerVersionContent);s.onclick=JSON.parse(s.onclick),s.params=JSON.parse(s.params||"{}"),s.thirdIdOrPackageName=t.getThirdId(s.params),s.smallTopicsIs="bigTopic"===s.contentType,s.smallTopicsIs&&(s.smallTopicsId=s.params.topicCode),s.subchannelIs="rotate"===s.contentType,s.subchannelIs&&(s.subchannelId=s.params.stationId),n(s.onclick),i(s),t.lowerForm=s})},handleCloseLowerFormTag:function(){this.lowerForm.thirdIdOrPackageName=void 0,this.singleEpisodeNum=void 0}},created:function(){var e=this;this.normalForm=Object(Go["cloneDeep"])(this.versionForm),this.normalVersionContent.push(this.normalForm),this.lowerForm=Object(Go["cloneDeep"])(this.versionForm),this.lowerForm.smallTopicsId="",this.lowerForm.smallTopicsIs=!1,this.mode=this.initMode||"create",this.id&&(this.fetchData(this.version),this.$sendEvent({type:"broadcast_show",payload:{broadcast_id:this.id}})),this.$service.getDictType({type:"materialType"}).then(function(t){for(var a=[],n=0;n<t.length;n++){var i={label:t[n].dictCnName,value:t[n].dictId};a.push(i),e.pictureListOptions.poster.searchParams.pictureCategory.options=a}}),this.$service.getCornerTypes().then(function(t){for(var a={},n=0;n<t.length;n++){var i=t[n].typeName,r=t[n].typeId;a[i]=r}e.cornerIconTypeOptions=a})}},Gs=Us,js=(a("83ac"),Object(Yo["a"])(Gs,Bl,Ml,!1,null,"c9aa91fc",null)),zs=js.exports,Ws=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("TabPage",[a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("CommonContent",{ref:"commonContent",attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{replicate:e.replicate,edit:e.edit,unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,"submit-audit":e.handleSubmitAudit,"save-draft":e.handleSaveDraft,audit:function(t){return e.$emit("upsert-end")},"select-version":e.fetchData,"cancel-timing":function(t){return e.fetchData(e.basicForm.currentVersion)},delete:function(t){return e.$emit("upsert-end",t)}}},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"basicForm",staticClass:"el-form-add",attrs:{model:e.basicForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"推荐位名称",prop:"containerName",rules:[{required:!0,message:"请输入推荐位名称",trigger:"blur"}]}},[a("el-input",{attrs:{disabled:e.disabled},model:{value:e.basicForm.containerName,callback:function(t){e.$set(e.basicForm,"containerName",t)},expression:"basicForm.containerName"}})],1),a("el-form-item",{attrs:{label:"推荐位类型"}},[a("el-select",{attrs:{disabled:e.disabled},model:{value:e.basicForm.containerType,callback:function(t){e.$set(e.basicForm,"containerType",t)},expression:"basicForm.containerType"}},[a("el-option",{attrs:{label:"视频列表",value:"REFERENCE_BROADCASTING"}})],1)],1),a("el-form-item",{attrs:{label:"配置模式"}},[a("el-radio-group",{attrs:{value:e.basicForm.configModel},on:{input:e.handleInputConfigModel}},[a("el-radio",{attrs:{label:"broadcast",disabled:e.disabled}},[e._v("轮播模式")]),a("el-radio",{attrs:{label:"group",disabled:e.disabled}},[e._v("组合模式")]),a("el-radio",{attrs:{label:"sign",disabled:e.disabled}},[e._v("信号源")])],1)],1),a("el-form-item",{attrs:{label:"内容源"}},[a("el-radio-group",{attrs:{disabled:e.isReplica,value:e.basicForm.source},on:{input:e.handleSourceChange}},e._l(e.$consts.sourceOptionsWithNone,function(t){return a("el-radio",{key:t.value,attrs:{label:t.value,disabled:e.disabled}},[e._v("\n              "+e._s(t.label)+"\n            ")])}),1)],1)],1),a("div",{staticClass:"split-bar"},[e._v("内容配置")]),a("div",{staticClass:"version-title"},[a("h4",{staticClass:"version-title__h"},[e._v("正常版本")]),"group"===e.basicForm.configModel?a("el-tag",{staticClass:"version-title__tag",attrs:{type:"warning"}},[e._v("短标题模式需至少运营四个资源，长标题模式至少6个，才能填满布局哦~")]):e._e(),e.isGroupModel&&!e.disabled?a("ResourceSelector",{ref:"resourceSelector",staticStyle:{float:"right"},attrs:{"disable-partner":!!e.source,source:e.source,selectors:e.resourceOptions,"is-live":!1,"id-type":1,"selection-type":"multiple"},on:{"select-end":e.handleSelectNormalmultipleResourceEnd}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("批量选择资源")])],1):e._e()],1),a("div",{staticClass:"form-wrap"},[e.isGroupModel?a("el-row",{staticClass:"normal-left-list",style:e.classObject,attrs:{gutter:4}},[e.disabled?e._l(e.normalVersionContent,function(t,n){return a("el-card",{key:n,staticClass:"normal-version-wrap",class:{active:n===e.currentIndex},nativeOn:{click:function(t){return e.handleActivateContent(n)}}},[t.poster.pictureUrl?a("img",{attrs:{referrerpolicy:"no-referrer",src:t.poster.pictureUrl}}):e._e(),a("span",[e._v(e._s(t.title))])])}):a("draggable",{attrs:{options:{group:"normalVersion"}},on:{start:function(t){return e.onDragStart(t)},end:function(t){return e.onDragtEnd(t)}},model:{value:e.normalVersionContent,callback:function(t){e.normalVersionContent=t},expression:"normalVersionContent"}},e._l(e.normalVersionContent,function(t,n){return a("el-card",{key:n,staticClass:"normal-version-wrap",class:{active:n===e.currentIndex},nativeOn:{click:function(t){return e.handleActivateContent(n)}}},[e.normalVersionContent.length>1&&!e.disabled?a("i",{staticClass:"el-icon-close",on:{click:function(t){return t.stopPropagation(),e.handleDeleteNormalContent(n)}}}):e._e(),t.poster.pictureUrl?a("img",{attrs:{referrerpolicy:"no-referrer",src:t.poster.pictureUrl}}):e._e(),a("span",[e._v(e._s(t.title))])])}),1),e.disabled?e._e():a("el-card",{staticClass:"add-version-card"},[a("span",{staticClass:"add-version",on:{click:e.handleAddNormalContent}},[e._v("+添加资源")])])],2):e._e(),"group"===e.basicForm.configModel?a("div",{staticClass:"content-wrapper"},[a("div",{staticClass:"content-type-switcher"},[a("el-radio-group",{attrs:{value:e.normalForm.showContentType},on:{input:e.handleSwitchShowContentType}},[a("el-radio",{staticClass:"conten-type-switcher__item",attrs:{label:"general"}},[e._v("通用推荐位版本")]),a("el-radio",{staticClass:"conten-type-switcher__item",attrs:{label:"dmp"}},[e._v("分人群推荐位"+e._s(e.dmpContentList.length>0?"("+e.dmpContentList.length+"个)":""))])],1)],1),"general"===e.normalForm.showContentType?a("div",[a("BroadcastBlockForm",{ref:"broadcastBlockForm",attrs:{id:e.id,"config-model":e.basicForm.configModel,"normal-form":e.normalForm,"normal-rules":e.normalRules,"is-readonly":e.disabled,"is-group-model":e.isGroupModel,source:e.source,"show-resource-tip":0===e.currentIndex},on:{"toggle-use-short-video":e.handleToggleUseShortVideo,"toggle-manaulset-resource":function(t){return e.handleToggleManualSetResource(t,"general")}}})],1):e._e(),"dmp"===e.normalForm.showContentType?a("div",[a("div",{staticClass:"added-contents-wrapper",attrs:{gutter:8}},[a(e.disabled?"div":"draggable",{tag:"component",staticClass:"added-contents-list",on:{start:e.handleDragDmpConentStart,end:e.handleDragDmpConentEnd},model:{value:e.normalForm.dmpContentList,callback:function(t){e.$set(e.normalForm,"dmpContentList",t)},expression:"normalForm.dmpContentList"}},e._l(e.dmpContentList,function(t,n){return a("el-card",{key:n,class:{active:n===e.activeDmpIndex},attrs:{"body-style":{padding:"0px"}},nativeOn:{click:function(t){return e.handleActivateDmpContent(n)}}},[e.dmpContentList[n].poster.pictureUrl?a("img",{attrs:{referrerpolicy:"no-referrer",src:e.dmpContentList[n].poster.pictureUrl}}):e._e(),e.disabled?e._e():a("i",{staticClass:"remove-handle el-icon-close",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleRemoveDmpContent(n)}}})])}),1),"read"!==e.mode?a("el-card",{nativeOn:{click:function(t){return e.handleAddDmpContent(t)}}},[a("i",{staticClass:"el-icon-plus"},[e._v("添加资源")])]):e._e()],1),e.normalForm.dmpContentList[e.normalForm.activeIndex]?a("BroadcastBlockForm",{ref:"broadcastBlockForm",attrs:{id:e.id,"config-model":e.basicForm.configModel,"normal-form":e.normalForm.dmpContentList[e.normalForm.activeIndex],"normal-rules":e.normalRules,"is-readonly":e.disabled,"is-group-model":e.isGroupModel,source:e.source,checkCrowd:e.checkCrowd},on:{"toggle-use-short-video":function(t){return e.handleToggleUseShortVideo(t,"dmp")},"toggle-manaulset-resource":function(t){return e.handleToggleManualSetResource(t,"dmp")}}}):e._e()],1):e._e()]):e._e(),"broadcast"===e.basicForm.configModel||"sign"===e.basicForm.configModel?a("div",{class:"sign"===e.basicForm.configModel?"content-wrapper":""},[a("BroadcastBlockForm",{ref:"broadcastBlockForm",attrs:{id:e.id,"config-model":e.basicForm.configModel,"normal-form":e.normalForm,"normal-rules":e.normalRules,"is-readonly":e.disabled,"is-group-model":e.isGroupModel,source:e.source,"show-resource-tip":0===e.currentIndex},on:{"toggle-use-short-video":e.handleToggleUseShortVideo,"toggle-manaulset-resource":function(t){return e.handleToggleManualSetResource(t,"general")}}})],1):e._e()],1),a("div",{staticClass:"version-title",staticStyle:{"margin-top":"25px"}},[a("h4",{staticStyle:{float:"left","margin-top":"7px"}},[e._v("兼容低版本")]),e.isGroupModel?a("div",{staticStyle:{display:"inline-block","margin-left":"14px"}},[a("el-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary",plain:"",disabled:e.disabled},on:{click:e.lowerFill}},[e._v("快速填充\n          ")]),a("span",[e._v("使用正常版本的第一个资源，快速配置")])],1):e._e()]),a("div",{staticClass:"form-wrap"},[a("el-form",{ref:"lowerForm",staticClass:"el-form-add",attrs:{model:e.lowerForm,rules:e.lowerRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"资源类别",prop:"coverType"}},[a("el-radio-group",{attrs:{value:e.lowerForm.coverType},on:{input:e.handleInputLowerFormCoverType}},[a("el-radio",{attrs:{label:"media",disabled:e.disabled}},[e._v("媒体资源")]),a("el-radio",{attrs:{label:"app",disabled:e.disabled}},[e._v("应用")]),a("el-radio",{attrs:{label:"custom",disabled:e.disabled}},[e._v("自定义")])],1)],1),"media"===e.lowerForm.coverType||"app"===e.lowerForm.coverType?a("el-form-item",{attrs:{label:"内容资源",prop:"thirdIdOrPackageName"}},[e.disabled?e._e():a("ResourceSelector",{ref:"resourceSelector",attrs:{"disable-partner":!!e.source,source:e.source,selectors:e.resourceOptionsLowerForm,"is-live":!1,"selection-type":"single"},on:{"select-end":e.handleSelectLowerSingleResourceEnd}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("选择资源")])],1),e.lowerForm.thirdIdOrPackageName?a("el-tag",{staticClass:"marginL",attrs:{type:"success",closable:!e.disabled},on:{close:e.handleCloseLowerFormTag}},[e._v("已选择："+e._s(e.lowerForm.thirdIdOrPackageName))]):e._e(),e.lowerForm.thirdIdOrPackageName&&e.singleEpisodeNum?a("el-tag",{staticClass:"marginL",attrs:{type:"success"}},[e._v("单集："+e._s(e.singleEpisodeNum))]):e._e()],1):e._e(),e.lowerForm.subchannelIs?a("el-form-item",{attrs:{label:"指定子频道",prop:"subchannelId"}},[a("el-input",{attrs:{disabled:e.disabled},model:{value:e.lowerForm.subchannelId,callback:function(t){e.$set(e.lowerForm,"subchannelId",t)},expression:"lowerForm.subchannelId"}})],1):e._e(),e.lowerForm.smallTopicsIs?a("el-form-item",{attrs:{label:"指定小专题",prop:"smallTopicsId"}},[a("el-input",{attrs:{disabled:e.disabled},on:{blur:e.smallTopicsLower},model:{value:e.lowerForm.smallTopicsId,callback:function(t){e.$set(e.lowerForm,"smallTopicsId",t)},expression:"lowerForm.smallTopicsId"}})],1):e._e(),a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{attrs:{disabled:e.disabled},model:{value:e.lowerForm.title,callback:function(t){e.$set(e.lowerForm,"title",t)},expression:"lowerForm.title"}})],1),a("el-form-item",{attrs:{label:"副标题",prop:"subTitle"}},[a("el-input",{attrs:{disabled:e.disabled},model:{value:e.lowerForm.subTitle,callback:function(t){e.$set(e.lowerForm,"subTitle",t)},expression:"lowerForm.subTitle"}})],1),a("el-form-item",{attrs:{label:"海报",prop:"poster.pictureUrl"}},[a("GlobalPictureSelector",{attrs:{disabled:e.isReadonly,"picture-resolution":"1210*449"},on:{"select-end":e.handleSelectPostEnd}},[a("el-card",{staticClass:"post-box",staticStyle:{height:"180px"},attrs:{disabled:e.disabled}},[e.lowerForm.poster.pictureUrl?a("img",{staticStyle:{height:"180px"},attrs:{referrerpolicy:"no-referrer",src:e.lowerForm.poster.pictureUrl}}):e._e()])],1)],1),a("el-form-item",{attrs:{label:"角标"}},[a("el-card",{staticClass:"corner-box"},e._l(e.lowerForm.cornerIconList,function(t,n){return a("span",{key:n,staticClass:"corner",class:"corner-"+n},[a("CornerSelector",{attrs:{disabled:e.isReadonly,position:n},on:{"select-end":function(t){return e.handleSelectCornerIconEnd(t,n)}}},[t.imgUrl?a("span",{staticClass:"corner-img-wrapper"},[a("img",{attrs:{referrerpolicy:"no-referrer",src:t.imgUrl}}),e.disabled?e._e():a("i",{staticClass:"el-icon-delete",on:{click:function(t){return t.stopPropagation(),e.deleteCorner(e.lowerForm,n)}}})]):a("el-tag",{attrs:{type:"success"}},[a("i",{staticClass:"el-icon-plus"})])],1)],1)}),0)],1),"media"===e.lowerForm.coverType||"app"===e.lowerForm.coverType?a("div",[a("el-form-item",{attrs:{label:"应用版本号",prop:"versionCode"}},[a("el-input",{attrs:{disabled:e.disabled},model:{value:e.lowerForm.versionCode,callback:function(t){e.$set(e.lowerForm,"versionCode",t)},expression:"lowerForm.versionCode"}})],1)],1):e._e(),"custom"===e.lowerForm.coverType?a("div",[a("el-form-item",{attrs:{label:"打开方式"}},[a("el-select",{attrs:{value:"第三方应用",disabled:e.disabled}},[a("el-option",{attrs:{value:"app"}},[e._v("第三方应用")])],1),a("el-button",{staticClass:"marginL",attrs:{type:"primary",plain:"",disabled:e.disabled},on:{click:function(t){e.onclickEventVisible=!0,e.onclickEventVisibleFlag="lower"}}},[e._v("快速填充")])],1),e.disabled?e._e():a("AppParams",{ref:"openWayLower",attrs:{"prop-prefix":"onclick."},model:{value:e.lowerForm.onclick,callback:function(t){e.$set(e.lowerForm,"onclick",t)},expression:"lowerForm.onclick"}},[e._v(e._s(e.lowerForm.onclick)+"\n            ")]),e.disabled?a("AppParamsRead",{attrs:{value:e.lowerForm.onclick}}):e._e()],1):e._e()],1)],1),a("el-dialog",{attrs:{visible:e.onclickEventVisible,width:"1200px"},on:{"update:visible":function(t){e.onclickEventVisible=t}}},[a("selectClick",{on:{"row-click":e.getClickData}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.onclickEventVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onclickEventVisible=!1,e.clickThirdpartSubmit()}}},[e._v("确 定")])],1)],1)],1)],1)],1)},qs=[],Js=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"normalForm",staticClass:"el-form-add",staticStyle:{float:"left",width:"75%"},attrs:{model:e.normalForm,rules:e.normalRules,"label-width":"140px"}},[e.normalForm.isDmpContent?a("el-form-item",{attrs:{label:"关联定向人群",prop:"dmpRegistryInfo"}},[a("el-button",{attrs:{type:"primary",disabled:e.isReadonly},on:{click:e.handleSelectCrowdStart}},[e._v("添加人群")]),e.normalForm.dmpRegistryInfo?a("el-tag",{attrs:{type:"primary"}},[e._v("已选择: "+e._s(e.normalForm.dmpRegistryInfo.dmpPolicyName)+"("+e._s(e.normalForm.dmpRegistryInfo.dmpPolicyId)+") / "+e._s(e.normalForm.dmpRegistryInfo.dmpCrowdName)+"("+e._s(e.normalForm.dmpRegistryInfo.dmpCrowdId)+")")]):e._e()],1):e._e(),e._e(),e.normalForm.shortVideoSwitch?e._e():a("el-form-item",{attrs:{label:e.normalResourceBtn,prop:"thirdIdOrPackageName"}},[e.isManualSetResource||"轮播资源"!==e.normalResourceBtn||e.disabled?e._e():a("ResourceSelector",{ref:"resourceSelector",attrs:{"disable-partner":!!e.source,source:e.source,selectors:["rotate"],"is-live":!1,"selection-type":"single"},on:{"select-end":function(t){return e.handleSelectNormalSingleResourceEnd(t,"single")}}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("选择资源")])],1),e.isManualSetResource||"播放资源"!==e.normalResourceBtn||e.disabled?e._e():a("ResourceSelector",{ref:"resourceSelector",attrs:{source:e.source,"disable-partner":!!e.source,selectors:e.resourceOptionsNormalForm,"is-live":!1,"id-type":1,"selection-type":"single"},on:{"select-end":function(t){return e.handleSelectNormalSingleResourceEnd(t,"Multiple")}}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("选择资源")])],1),e.isManualSetResource?a("el-input",{staticStyle:{float:"left"},attrs:{disabled:e.disabled},model:{value:e.normalForm.thirdIdOrPackageName,callback:function(t){e.$set(e.normalForm,"thirdIdOrPackageName",t)},expression:"normalForm.thirdIdOrPackageName"}}):e._e(),e.normalForm.thirdIdOrPackageName&&!e.isManualSetResource?a("el-tag",{staticClass:"marginL",attrs:{type:"success",closable:!e.disabled},on:{close:function(t){e.normalForm.thirdIdOrPackageName=void 0}}},[e._v("已选择："+e._s(e.normalForm.thirdIdOrPackageName))]):e._e(),e.normalForm.thirdIdOrPackageName&&e.singleEpisodeNum?a("el-tag",{staticClass:"marginL",attrs:{type:"success"}},[e._v("单集："+e._s(e.singleEpisodeNum))]):e._e(),e.isManualSetResource||!e.isGroupModel||e.disabled?e._e():a("a",{staticClass:"write-play",attrs:{href:"#"},on:{click:function(t){return e.$emit("toggle-manaulset-resource",!0)}}},[e._v("手动填写播放串")]),e.isManualSetResource&&e.isGroupModel&&!e.disabled?a("a",{staticClass:"write-play",staticStyle:{float:"left"},attrs:{href:"#"},on:{click:function(t){return e.$emit("toggle-manaulset-resource",!1)}}},[e._v("自动配置播放资源")]):e._e(),"sign"===e.configModel&&e.showResourceTip?a("div",{staticClass:"sign-tip"},[e._v("\n        信号源模式的第一个资源必须是轮播资源\n      ")]):e._e()],1),e.normalForm.shortVideoSwitch?a("el-form-item",{attrs:{label:"跳转话题",prop:"shortVideoParams.topicId"}},[e.disabled?e._e():a("ResourceSelector",{attrs:{"disable-partner":!!e.source,source:e.source,selectors:["shortVideoTopic"],"selection-type":"single"},on:{"select-end":e.handleSelectVideoTopicEnd}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("\n          选择话题\n        ")])],1),e.normalForm.shortVideoParams.topicId?a("el-tag",{staticClass:"marginL",attrs:{type:"success",closable:!e.disabled},on:{close:function(t){e.normalForm.shortVideoParams.topicId=void 0}}},[e._v("已选择："+e._s(e.normalForm.shortVideoParams.topicId))]):e._e()],1):e._e(),e.normalForm.shortVideoSwitch?a("el-form-item",{attrs:{label:"开头短视频"}},[e.disabled?e._e():a("ResourceSelector",{attrs:{source:e.source,selectors:["shortVideo"],"disable-partner":!!e.source,"auto-fetch-selectors":["shortVideo"],"selection-type":"single"},on:{"select-end":e.handleSelectVideoEnd}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("\n          选择短视频\n        ")])],1),e.normalForm.shortVideoParams.shortVideoId?a("el-tag",{staticClass:"marginL",attrs:{type:"success",closable:!e.disabled},on:{close:function(t){e.normalForm.shortVideoParams.shortVideoId=void 0}}},[e._v("已选择："+e._s(e.normalForm.shortVideoParams.shortVideoId))]):e._e()],1):e._e(),e.isGroupModel?a("div",[e.normalForm.subchannelIs?a("el-form-item",{attrs:{label:"指定子频道",prop:"subchannelId"}},[a("el-input",{attrs:{disabled:e.disabled},model:{value:e.normalForm.subchannelId,callback:function(t){e.$set(e.normalForm,"subchannelId",t)},expression:"normalForm.subchannelId"}})],1):e._e(),a("el-form-item",{attrs:{label:"开启个性化推荐"}},[a("el-switch",{attrs:{disabled:e.judegeRecomStreamDisabled(),value:!!e.normalForm.flagSetRec,"active-color":"#13ce66","inactive-color":"grey"},on:{input:e.handleInputFlagSetRec}})],1),e.normalForm.flagSetRec?a("RecommendStreamSelector",{attrs:{value:e.normalForm.mediaAutomationBlockRls.mediaAutomationId,disabled:e.isReadonly,source:e.source,resolution:"797*449"},on:{"select-end":e.handleSelectRecomStream,"del-select":function(t){e.normalForm.mediaAutomationBlockRls.mediaAutomationId=void 0}}}):e._e(),e.normalForm.flagSetRec?a("el-form-item",{attrs:{label:"刷新机制",prop:"mediaAutomationBlockRls.refreshCal"}},[a("InputPositiveInt",{staticClass:"flash-count-input",attrs:{disabled:e.isReadonly},model:{value:e.normalForm.mediaAutomationBlockRls.refreshCal,callback:function(t){e.$set(e.normalForm.mediaAutomationBlockRls,"refreshCal",t)},expression:"normalForm.mediaAutomationBlockRls.refreshCal"}}),e._v("\n        客户端曝光X次之后刷新推荐位\n      ")],1):e._e(),a("el-form-item",{staticStyle:{width:"890px"},attrs:{label:"标题",prop:"title"}},[a("el-input",{attrs:{disabled:e.disabled},model:{value:e.normalForm.title,callback:function(t){e.$set(e.normalForm,"title",t)},expression:"normalForm.title"}}),a("div",{staticClass:"block-stat-viewer"},[a("BroadcastBlockStatChartViewer",{staticClass:"margin-right-10 margin-left-10",attrs:{id:e.id,"selected-title":e.normalForm.title,"selected-type":"total"}},[a("el-button",{attrs:{type:"primary"}},[e._v("整体数据")])],1),a("BroadcastBlockStatChartViewer",{staticClass:"margin-right-10",attrs:{id:e.id,"selected-title":e.normalForm.title,"selected-type":"video"}},[a("el-button",{attrs:{type:"primary"}},[e._v("视频窗数据")])],1),a("BroadcastBlockStatChartViewer",{staticClass:"margin-right-10",attrs:{id:e.id,"selected-title":e.normalForm.title,"selected-type":"static"}},[a("el-button",{attrs:{type:"primary"}},[e._v("静态数据")])],1)],1)],1),a("el-form-item",{attrs:{label:"副标题",prop:"subTitle"}},[a("el-input",{attrs:{disabled:e.disabled},model:{value:e.normalForm.subTitle,callback:function(t){e.$set(e.normalForm,"subTitle",t)},expression:"normalForm.subTitle"}})],1)],1):e._e(),a("el-form-item",{attrs:{label:"海报",prop:"poster.pictureUrl"}},[a("GlobalPictureSelector",{attrs:{disabled:e.isReadonly,"picture-resolution":"797*449"},on:{"select-end":e.handleSelectPostEnd}},[a("el-card",{staticClass:"post-box",staticStyle:{height:"180px"}},[e.normalForm.poster.pictureUrl?a("img",{staticStyle:{height:"180px"},attrs:{referrerpolicy:"no-referrer",src:e.normalForm.poster.pictureUrl}}):e._e()])],1)],1),a("el-form-item",{attrs:{label:"角标"}},[a("el-card",{staticClass:"corner-box"},e._l(e.normalForm.cornerIconList,function(t,n){return a("span",{key:n,staticClass:"corner",class:"corner-"+n},[a("CornerSelector",{attrs:{disabled:e.isReadonly,position:n},on:{"select-end":function(t){return e.handleSelectCornerIconEnd(t,n)}}},[t.imgUrl?a("span",{staticClass:"corner-img-wrapper"},[a("img",{attrs:{referrerpolicy:"no-referrer",src:t.imgUrl}}),e.disabled?e._e():a("i",{staticClass:"el-icon-delete",on:{click:function(t){return t.stopPropagation(),e.handleRemoveCorner(n)}}})]):a("el-tag",{attrs:{type:"success"}},[a("i",{staticClass:"el-icon-plus"})])],1)],1)}),0)],1),e.isGroupModel?a("el-form-item",{attrs:{label:"点击跳转"}},[a("el-radio-group",{attrs:{value:e.normalForm.clickType},on:{input:e.handleInputClickType}},[a("el-radio",{directives:[{name:"show",rawName:"v-show",value:!e.normalForm.shortVideoSwitch,expression:"!normalForm.shortVideoSwitch"}],attrs:{label:"detail",disabled:e.disabled}},[e._v("点击进详情页")]),a("el-radio",{directives:[{name:"show",rawName:"v-show",value:e.couldFullscreen,expression:"couldFullscreen"}],attrs:{label:"play-fullscreen",disabled:e.disabled}},[e._v("\n          点击直接全屏播放\n        ")])],1)],1):e._e(),e.isGroupModel?a("el-form-item",{attrs:{label:"点击事件",prop:"sign"}},[a("el-radio-group",{attrs:{value:e.normalForm.sign,disabled:e.isManualSetResource},on:{input:e.handleChangeSign}},[a("el-radio",{attrs:{label:"autoSet",disabled:e.disabled}},[e._v("跳转本播放资源")]),"detail"===e.normalForm.clickType?[a("el-radio",{attrs:{label:"manualResource",disabled:e.disabled}},[e._v("跳转其他播放资源")]),a("el-radio",{attrs:{label:"manualSet",disabled:e.disabled}},[e._v("手动设置")])]:e._e()],2)],1):e._e(),a("el-form-item",{attrs:{label:"",prop:"clickParams"}},["manualResource"===e.normalForm.sign?a("div",[e.disabled?e._e():a("ResourceSelector",{ref:"resourceSelector",attrs:{"disable-partner":!!e.source,source:e.source,selectors:e.resourceOptionsManualResource,"is-live":!1,"selection-type":"single"},on:{"select-end":function(t){return e.handleSelectNormalSingleOtherResourceEnd(t)}}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("选择资源")])],1),a("span",{directives:[{name:"show",rawName:"v-show",value:e.thirdIdOrPackageNameForClick,expression:"thirdIdOrPackageNameForClick"}]},[e._v("已选择: "+e._s(e.thirdIdOrPackageNameForClick))])],1):e._e()]),"manualSet"===e.normalForm.sign?a("div",[a("el-form-item",{attrs:{label:"打开方式"}},[a("el-select",{attrs:{value:"第三方应用",disabled:e.disabled}},[a("el-option",{attrs:{value:"app"}},[e._v("第三方应用")])],1),a("el-button",{staticClass:"marginL",attrs:{type:"primary",plain:"",disabled:e.disabled},on:{click:e.handleSelectClickEventStart}},[e._v("快速填充")])],1),e.disabled?e._e():a("AppParams",{attrs:{"prop-prefix":"onclick."},model:{value:e.normalForm.onclick,callback:function(t){e.$set(e.normalForm,"onclick",t)},expression:"normalForm.onclick"}}),e.disabled?a("AppParamsRead",{attrs:{value:e.normalForm.onclick}}):e._e()],1):e._e()],1),e.showCrowdSelector?a("CrowdSelector",{on:{"select-cancel":e.handleSelectCrowdCancel,"select-end":e.handleSelectCrowdEnd}}):e._e(),a("el-dialog",{attrs:{visible:e.onclickEventVisible,width:"1200px"},on:{"update:visible":function(t){e.onclickEventVisible=t}}},[a("selectClick",{on:{"row-click":e.handleSelectClickEvent}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.onclickEventVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSelectClickEventEnd}},[e._v("确 定")])],1)],1)],1)},Hs=[];function Ks(e){var t=Object.keys(e).find(function(t){return e[t].length>0});return Ys(e,t)}function Ys(e,t){var a=e[t],n=e.episode||{};return a.forEach(function(e){var t=n[e.coocaaVId];t&&(e.selectedEpisode=t)}),{selectedType:t,selected:a}}function Qs(e,t){if(e.type=t.type,e.coverType=t.coverType,e.subchannelIs="rotate"===t.contentType,e.smallTopicsIs="bigTopic"===t.contentType,e.title=t.title,e.contentType=t.contentType,e.subTitle=t.subTitle,e.thirdIdOrPackageName=t.thirdIdOrPackageName,t.pictureUrl){var a=Object(Go["cloneDeep"])(e.poster);a.pictureUrl=t.pictureUrl,e.poster=a}else e.poster={pictureUrl:""};var n=Xs(t);e.params=n,"autoSet"===e.sign&&(e.clickParams=Object(Go["cloneDeep"])(n),e.clickTemplateType=t.contentType)}function Xs(e){var t;return"movie"===e.contentType?(t={id:e.thirdIdOrPackageName},e.vid&&(t.vid=e.vid),e.sid&&(t.sid=e.sid)):"app"===e.contentType||"edu"===e.contentType||"txLive"===e.contentType?t={id:e.thirdIdOrPackageName}:"bigTopic"===e.contentType?t={pTopicCode:e.thirdIdOrPackageName}:"topic"===e.contentType?t={topicCode:e.thirdIdOrPackageName}:"rotate"===e.contentType&&(t={rotateId:e.thirdIdOrPackageName}),t}function Zs(e,t){var a={type:"",contentType:"",thirdIdOrPackageName:""},n={tencent:"_otx_",o_tencent:"_otx_",yinhe:"_oqy_",o_iqiyi:"_oqy_",youku:"_oyk_"},i=t._partner;switch(e){case"video":var r=t.selectedEpisodes,o=n[i]||"";r?(6===r.urlIsTrailer&&r.thirdVId?(a.thirdIdOrPackageName=o+r.thirdVId,a.sid=r.coocaaMId):(a.thirdIdOrPackageName=o+t.coocaaVId,a.vid=r.coocaaMId),a.pictureUrl=r.thumb,a.title=r.urlTitle,a.subTitle=r.urlSubTitle):(a.thirdIdOrPackageName=o+t.coocaaVId,a.pictureUrl=t.thumb,a.title=t.title,a.subTitle=t.subTitle),a.contentType="movie",a.type="res",a.coverType="media";break;case"app":a.contentType="app",a.thirdIdOrPackageName=t.appPackageName,a.pictureUrl=t.appImageUrl,a.title=t.appName,a.type="app",a.coverType="app";break;case"edu":a.contentType="edu",a.coverType="media",a.thirdIdOrPackageName="_otx_"+t.coocaaVId,a.platformId=t.source,a.pictureUrl=t.thumb,a.title=t.title,a.subTitle=t.subTitle,a.type="res";break;case"pptv":a.contentType="pptv",a.coverType="media",a.thirdIdOrPackageName="pptv_tvsports://tvsports_detail?section_id="+t.pid+"&from_internal=1",a.title=t.pTitle,a.type="";break;case"live":a.contentType="txLive",a.coverType="media",a.thirdIdOrPackageName="_otx_"+t.vId,a.platformId=t.source,a.pictureUrl=t.thumb,a.title=t.title,a.subTitle=t.subTitle,a.type="live";break;case"topic":"parentTopic"===t.dataSign?a.contentType="bigTopic":a.contentType="topic",a.thirdIdOrPackageName=t.id+"",a.pictureUrl=t.picture,a.title=t.title,a.subTitle=t.subTitle,a.type="topic",a.coverType="media";break;case"rotate":a.contentType="rotate",a.coverType="media",a.thirdIdOrPackageName=t.id+"",a.pictureUrl=t.picture,a.title=t.title,a.subTitle=t.subTitle,a.type="rotate";break;default:break}return a}var ec,tc,ac,nc,ic,rc,oc,lc,sc,cc,uc,dc,pc,hc,mc,fc,vc={components:{ResourceSelector:jl["a"],GlobalPictureSelector:ms["a"],CornerSelector:zl["a"],AppParams:is,AppParamsRead:us,CrowdSelector:fs["a"],selectClick:Yl,InputPositiveInt:vs["a"],RecommendStreamSelector:gs["a"],BroadcastBlockStatChartViewer:Ts},data:function(){return{onclickEventVisible:!1,showCrowdSelector:!1}},props:["id","configModel","normalForm","normalRules","isGroupModel","isReadonly","source","checkCrowd","showResourceTip"],computed:{isManualSetResource:function(){return"url"===this.normalForm.type},normalResourceBtn:function(){return this.isGroupModel?"播放资源":"轮播资源"},disabled:function(){return this.isReadonly},resourceOptionsManualResource:function(){return["video","edu","live","rotate"]},resourceOptionsNormalForm:function(){return this.showResourceTip&&"sign"===this.configModel?["rotate"]:["video","edu","live","rotate"]},couldFullscreen:function(){var e=this.normalForm.contentType;return this.normalForm.shortVideoSwitch||["movie","custom","edu","txLive"].indexOf(e)>-1},thirdIdOrPackageNameForClick:function(){return this.getThirdId(this.normalForm.clickParams)},singleEpisodeNum:function(){var e=this.normalForm.clickParams;return e.vid||e.sid}},methods:{getThirdId:function(e){if(e){var t=e.id||e.rotateId||e.pTopicCode||e.url;return t}},judegeShortVideoDisabled:function(){var e=this.normalForm,t=this.isReadonly;if(!1===t){if(!e.thirdIdOrPackageName)return!1;if("rotate"===e.clickTemplateType)return!0}return t},judegeRecomStreamDisabled:function(){var e=this.normalForm,t=this.isReadonly;if(!1===t){if(e.shortVideoSwitch)return!0;if(!e.thirdIdOrPackageName)return!1;if("rotate"===e.clickTemplateType)return!0}return t},handleInputClickType:function(e){var t=this.normalForm;t.clickType=e,this.handleChangeSign("autoSet")},handleSelectClickEventStart:function(){this.onclickEventVisible=!0},handleSelectClickEvent:function(e){this.onclickEventVisible=!1,this.clickData=e;var t=JSON.parse(e.params),a=Object.keys(t),n=a.reduce(function(e,a,n){var i={};return i.key=a,i.value=t[a],e.push(i),e},[]),i={packagename:e.packagename,versioncode:e.versioncode,dowhat:e.dowhat,bywhat:e.bywhat,byvalue:e.byvalue,params:n,exception:e.exception};this.normalForm.onclick=i},handleSelectClickEventEnd:function(){},handleSelectNormalSingleResourceEnd:function(e,t){var a=Ks(e),n=Zs(a.selectedType,a.selected[0]);Qs(this.normalForm,n),"rotate"===this.normalForm.clickTemplateType&&(this.handleInputFlagSetRec(!1),this.normalForm.clickType="detail"),this.normalForm.shortVideoSwitch=!1},handleSelectNormalSingleOtherResourceEnd:function(e){var t=Ks(e),a=Zs(t.selectedType,t.selected[0]);this.normalForm.clickParams=Xs(a),this.normalForm.clickTemplateType=a.contentType},handleSelectPostEnd:function(e){this.normalForm.poster={pictureUrl:e.pictureUrl,pictureId:e.pictureId}},handleSelectCornerIconEnd:function(e){var t=e.cornerIconType.typePosition,a={cornerIconId:e.cornerIconId,position:t,imgUrl:e.imgUrl};this.$set(this.normalForm.cornerIconList,t,a)},handleChangeSign:function(e){var t=this.normalForm;"autoSet"===e&&(t.onclick="",t.clickParams=t.params,t.clickTemplateType=t.contentType),"manualResource"===e&&(t.onclick="",t.clickParams={},t.clickTemplateType=""),"manualSet"===e&&(t.clickTemplateType="custom",t.clickParams={}),t.sign=e},handleRemoveCorner:function(e){var t={cornerIconId:"",position:e,imgUrl:""};this.$set(this.normalForm.cornerIconList,e,t)},handleSelectCrowdStart:function(){this.showCrowdSelector=!0},handleSelectCrowdCancel:function(){this.showCrowdSelector=!1},handleSelectCrowdEnd:function(e,t){var a=this.checkCrowd(t);void 0!==a?this.$message({type:"error",message:"第"+(a+1)+"个人群内容已关联该人群"}):(this.$set(this.normalForm,"dmpRegistryInfo",{dmpPolicyId:e.value,dmpCrowdId:t.value,dmpPolicyName:e.label,dmpCrowdName:t.label}),this.$sendEvent({type:"create_block_dmp",payload:{type:"broadcast"}}),this.showCrowdSelector=!1)},handleInputFlagSetRec:function(e){this.normalForm.flagSetRec=e?1:0,e||(this.normalForm.mediaAutomationBlockRls={refreshCal:1,mediaAutomationId:"",blockType:"rotate"})},handleSelectRecomStream:function(e){this.normalForm.mediaAutomationBlockRls.mediaAutomationId=e.id},handleSwitchShortVideo:function(e){var t=this,a=this.normalForm;a.thirdIdOrPackageName=void 0,a.title=void 0,a.subTitle=void 0,a.poster.pictureUrl=void 0,a.cornerIconList.forEach(function(e,a){t.handleRemoveCorner(a)}),a.shortVideoParams={topicId:void 0,shortVideoId:void 0},e?(a.clickType="play-fullscreen",this.handleChangeSign("autoSet")):a.clickType="detail",a.shortVideoSwitch=e,this.handleInputFlagSetRec(!1),this.$emit("toggle-use-short-video",e)},handleSelectVideoTopicEnd:function(e){var t=e.shortVideoTopic;this.normalForm.shortVideoParams.topicId=t[0].id,this.normalForm.title=t[0].topicName},handleSelectVideoEnd:function(e){var t=e.shortVideo,a=this.$consts.sourcePrefix[this.source]||"";if(!a){var n=this.$consts.partnerToSource[t[0].source];a=this.$consts.sourcePrefix[n]}this.normalForm.shortVideoParams.shortVideoId=a+t[0].sCoocaaMId}}},gc=vc,bc=(a("4257"),Object(Yo["a"])(gc,Js,Hs,!1,null,"21cc4d6c",null)),yc=bc.exports,wc={mixins:[ds["a"]],components:{TabPage:Il["a"],draggable:Gl.a,ResourceSelector:jl["a"],GlobalPictureSelector:ms["a"],CornerSelector:zl["a"],selectClick:Yl,AppParams:is,AppParamsRead:us,CommonContent:Ql["a"],BroadcastBlockForm:yc,BroadcastBlockStatChartViewer:Ts},props:["id","initMode","version"],data:function(){var e=this;return{mode:"create",resourceName:"轮播推荐位",pictureResolution:"797*449",type:"block",menuElId:"broadcastBlock",onclickEventVisibleFlag:"",clickData:void 0,onclickEventVisible:!1,cornerIconTypeOptions:{},cornerTypes:[],materialTypes:null,basicForm:{id:void 0,containerName:"",containerType:"REFERENCE_BROADCASTING",configModel:"broadcast",currentVersion:void 0,status:void 0,source:"none"},normalForm:{},lowerForm:{coverType:"media"},auditDisabled:!1,normalRules:{title:[{required:!0,message:"请填写标题",trigger:"blur"}],"poster.pictureUrl":[{required:!0,message:"请上传海报",trigger:"blur"}],thirdIdOrPackageName:[{required:!0,message:"请填选择资源",trigger:"blur"}],clickParams:[{validator:function(t,a,n){var i=e.normalForm;if("manualResource"===i.sign&&(!a||"{}"===JSON.stringify(a)))return n(Error("请选择资源"));n()}}],dmpRegistryInfo:[{required:!0,message:"请选择定向人群"}],"mediaAutomationBlockRls.mediaAutomationId":[{required:!0,message:"当开关开启时必填"}],"mediaAutomationBlockRls.refreshCal":[{required:!0,message:"当开关开启时必填",trigger:"blur"}],"shortVideoParams.topicId":[{required:!0,message:"请选择跳转话题"}]},lowerRules:{title:[{required:!0,message:"请填写标题",trigger:"blur"}],"poster.pictureUrl":[{required:!0,message:"请上传海报",trigger:"blur"}],thirdIdOrPackageName:[{required:!0,message:"请填选择资源",trigger:"blur"}],versionCode:[{validator:function(e,t,a){if(!/^(-1|\d*)$/.test(t))return a(new Error("应用版本号只能是数字或者-1"));a()}}]},currentIndex:0,pictureListOptions:{poster:{idField:"pictureId",searchParams:{pictureId:{label:"素材ID"},pictureName:{label:"素材名称"},pictureCategory:{label:"素材类别",options:[]},pictureStatus:{label:"素材状态",options:[{label:"审核通过",value:"1"},{label:"待审核",value:"2"}]}},picField:"pictureUrl",textItems:[{field:"pictureName"},{field:"pictureStatus",customFormatter:function(e,t){return["","审核通过","待审核"][t]}}]},corner:{idField:"cornerIconId",searchParams:{cornerIconId:{label:"角标ID"},cornerIconName:{label:"角标名称"},"cornerIconType.typeId":{label:"角标类别",options:[]}},picField:"imgUrl",textItems:[{field:"cornerIconName"},{field:"cornerStatus",customFormatter:function(e,t){return["","审核通过","待审核"][t]}}]}},versionForm:this.genDefaultContentForm(),pictureType:"",currentForm:"",pannelResource:"",normalVersionContent:[],openModeArray:[{name:"第三方应用",value:"app"}],referenceData:[],noPreview:"noPreview",referenceOptions:{picture:!1},layoutOptions:{contentDataNew:[]},selectPicture:"",resourceSeq:"",layoutparam:{},layouttypenew:"",checkresourceis:!0,singleEpisodeNum:void 0}},computed:{disabled:function(){return"read"===this.mode},isReadonly:function(){return this.disabled},dmpContentList:function(){return this.normalForm.dmpContentList||[]},activeDmpIndex:function(){return this.normalForm.activeIndex},resourceOptionsLowerForm:function(){return"app"===this.lowerForm.coverType?["app"]:["video","edu","live","rotate"]},resourceOptionsManualResource:function(){return["video","edu","live","rotate"]},resourceOptionsNormalForm:function(){return 0===this.currentIndex&&"sign"===this.basicForm.configModel?["rotate"]:["video","edu","live","rotate"]},resourceOptions:function(){return["video","edu","live","rotate"]},isManualSetResource:function(){return"url"===this.normalForm.type},normalResourceBtn:function(){return this.isGroupModel?"播放资源":"轮播资源"},isGroupModel:function(){var e=this.basicForm.configModel;return"group"===e||"sign"===e},source:function(){return"none"===this.basicForm.source?"":this.basicForm.source},thirdIdOrPackageNameForClick:function(){return this.getThirdId(this.normalForm.clickParams)},couldFullscreen:function(){var e=this.normalForm.contentType;return["movie","custom","edu","txLive"].indexOf(e)>-1},classObject:function(){return this.normalForm.sign,{height:"600px"}},resourceInfo:function(){var e=this.basicForm;if(e.id)return{id:e.id,type:this.type,menuElId:this.menuElId,version:e.currentVersion,status:e.status}},couldSetReleaseTime:function(){var e=this.mode,t=this.basicForm.currentVersion,a="create"===e||"copy"===e,n="edit"===e&&"V1"===t,i="10"===this.$consts.idPrefix;return i&&!(a||n)},isReplica:function(){return"replicated"===this.mode||"yes"===this.basicForm.duplicateVersion}},watch:{},methods:{handleActivateDmpContent:function(e){var t=this;this.dmpContentList[this.activeDmpIndex]?this.checkNormalForm(function(){t.normalForm.activeIndex=e}):this.normalForm.activeIndex=e},handleRemoveDmpContent:function(e){var t=this;this.$confirm("确认删除该内容","提示",{callback:function(a){if("confirm"===a){var n=t.activeDmpIndex,i=t.dmpContentList;i.splice(e,1),i.length>0?void 0===i[n]&&t.handleActivateDmpContent(e-1):t.handleActivateDmpContent(0)}}})},handleSwitchShowContentType:function(e){var t=this;"general"===e&&0===this.dmpContentList.length?this.normalForm.showContentType=e:this.checkNormalForm(function(){t.normalForm.showContentType=e})},handleAddDmpContent:function(){var e=this,t=this.normalForm,a=t.dmpContentList;a.length>0?this.checkNormalForm(function(){a.push(e.genDefaultContentForm({isDmpContent:!0})),t.activeIndex=a.length-1}):(a.push(this.genDefaultContentForm({isDmpContent:!0})),t.activeIndex=a.length-1)},handleDragDmpConentStart:function(e){},handleDragDmpConentEnd:function(e){var t=this.normalForm,a=t.activeIndex,n=e.oldIndex,i=e.newIndex;n===a?t.activeIndex=i:n<a&&i>=a?t.activeIndex=a-1:n>a&&i<=a&&(t.activeIndex=a+1)},checkCrowd:function(e){var t,a,n=this.dmpContentList,i=n.length;while(--i>=0)if(a=n[i].dmpRegistryInfo,a&&a.dmpCrowdId===e.value){t=i;break}return t},handleSourceChange:function(e){this.$confirm("切换内容源将清空内容, 确定切换?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){this.normalForm=this.genDefaultContentForm(),this.normalVersionContent=[this.normalForm],this.currentIndex=0,this.cleanLowerForm("media"),this.basicForm.source=e}.bind(this)).catch(function(e){})},getThirdId:function(e){if(e){var t=e.id||e.rotateId||e.pTopicCode||e.url;return t}},replicate:function(){this.mode="replicate"},edit:function(){this.mode="edit"},clickThirdpartSubmit:function(){var e=this.onclickEventVisibleFlag;if("lower"===e){var t=this.$refs.openWayLower.inputValue;this.parseOnclick(t)}else{var a=this.$refs.openWayNormal.inputValue;this.parseOnclick(a)}},parseOnclick:function(e){var t=this.clickData;Object.keys(e).map(function(a){if("params"===a){var n=JSON.parse(t[a]);e[a]=Object.keys(n).map(function(e){return{key:e,value:n[e]}})}else e[a]=t[a]})},getClickData:function(e){this.onclickEventVisible=!1,this.clickData=e;var t=JSON.parse(e.params),a=Object.keys(t),n=a.reduce(function(e,a,n){var i={};return i.key=a,i.value=t[a],e.push(i),e},[]),i={packagename:e.packagename,versioncode:e.versioncode,dowhat:e.dowhat,bywhat:e.bywhat,byvalue:e.byvalue,params:n,exception:e.exception};this[this.onclickEventVisibleFlag+"Form"]["onclick"]=i},handleChangeSign:function(e){var t=this.normalForm;"autoSet"===e&&(t.onclick="",t.clickParams=t.params,t.clickTemplateType=t.contentType),"manualResource"===e&&(t.onclick="",t.clickParams={},t.clickTemplateType=""),"manualSet"===e&&(t.clickTemplateType="custom",t.clickParams={}),t.sign=e},handleToggleManualSetResource:function(e,t){var a=this.genDefaultContentForm();if(e?(a.sign="manualSet",a.type="url",a.params={url:"",source:"",name:"",needParse:"false",url_type:"web"},a.clickTemplateType="custom",a.clickParams={}):(a.sign="autoSet",a.onclick="",a.clickParams=a.params,a.clickTemplateType=a.contentType),"dmp"===t){a.isDmpContent=!0;var n=this.normalForm;this.$set(n.dmpContentList,n.activeIndex,a)}else this.$set(this.normalVersionContent,this.currentIndex,a),this.normalForm=a},handleToggleUseShortVideo:function(e,t){var a;a="dmp"===t?this.normalForm.dmpContentList[this.normalForm.activeIndex]:this.normalForm,e&&(a.type="shortVideo"),a.shortVideoSwitch=e,a.sign="autoSet",a.onclick="",a.clickParams=a.params,a.clickTemplateType=a.contentType},deleteCorner:function(e,t){var a=e.cornerIconList.slice();a[t]={cornerIconId:"",imgUrl:"",position:t},e.cornerIconList=a},handleInputConfigModel:function(e){var t=this;this.$confirm("切换后配置数据将被清空, 是否确认切换?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$message({type:"success",message:"模式切换成功!"}),t.basicForm.configModel=e,t.currentIndex=0,t.clearFormAll()}).catch(function(){t.$message({type:"info",message:"已取消切换"})})},clearFormAll:function(){var e=Object(Go["cloneDeep"])(this.versionForm),t=Object(Go["cloneDeep"])(this.versionForm);this.lowerForm=t,this.normalForm=e,this.normalVersionContent=[e]},handleSelectNormalmultipleResourceEnd:function(e){var t,a=this,n=this.resourceOptions,i=[];n.forEach(function(t){e[t].forEach(function(e){var n=a.genDefaultContentForm(),r=Zs(t,e);Qs(n,r),i.push(n)})}),(t=this.normalVersionContent).splice.apply(t,[this.currentIndex,i.length].concat(i)),this.normalForm=this.genDefaultContentForm(),this.normalForm=Object.assign(this.normalVersionContent[this.currentIndex])},handleSelectLowerSingleResourceEnd:function(e){var t=Ks(e),a=Zs(t.selectedType,t.selected[0]);Qs(this.lowerForm,a)},checkNormalForm:function(e){var t=this,a=this.$refs.broadcastBlockForm;a?a.$refs.normalForm.validate(function(a){a?e():t.$message.error("请将表单填写完整")}):e()},genDefaultContentForm:function(e){return Object(Q["a"])({flagSetRec:0,mediaAutomationBlockRls:{refreshCal:1,mediaAutomationId:"",blockType:"rotate"},title:"",subTitle:"",type:"",coverType:"media",thirdIdOrPackageName:"",subchannelId:"",subchannelIs:"",params:{},clickType:"detail",onclick:{},sign:"autoSet",contentType:"",clickParams:{},poster:{},cornerIconList:[{},{},{},{}],showContentType:"general",dmpContentList:[],activeIndex:0,isDmpContent:!1,shortVideoParams:{topicId:void 0,shortVideoId:void 0},shortVideoSwitch:!1},e)},handleAddNormalContent:function(){var e=this;this.checkNormalForm(function(){e.normalForm=e.genDefaultContentForm(),e.normalVersionContent.push(e.normalForm),e.currentIndex=e.normalVersionContent.length-1})},handleDeleteNormalContent:function(e){var t=this;this.$confirm("是否删除当前选中项?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.normalVersionContent.splice(e,1),t.currentIndex=0,t.normalForm=t.normalVersionContent[0],t.$message({type:"success",message:"删除成功!"})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleActivateContent:function(e){var t=this;this.checkNormalForm(function(){t.currentIndex=e,t.normalForm=t.normalVersionContent[e]})},handleSelectPostEnd:function(e){this.lowerForm.poster={pictureUrl:e.pictureUrl,pictureId:e.pictureId}},handleSelectCornerIconEnd:function(e){var t=e.cornerIconType.typePosition,a={cornerIconId:e.cornerIconId,position:t,imgUrl:e.imgUrl};this.$set(this.lowerForm.cornerIconList,t,a)},onDragStart:function(e){console.log(e)},onDragtEnd:function(e){var t=e.oldIndex,a=e.newIndex,n=this.currentIndex;t===n?this.currentIndex=e.newIndex:t<n&&a>=n?this.currentIndex=n-1:t>n&&a<=n&&(this.currentIndex=n+1)},lowerFill:function(){var e=this,t=Object(Go["cloneDeep"])(this.normalVersionContent[0]);!0!==t.shortVideoSwitch?(t.dmpContentList=void 0,"manualSet"!==t.sign?(this.lowerForm.coverType=t.coverType,this.$nextTick(function(){e.lowerForm=t})):this.$message({type:"error",message:"手动填写的资源不能填充，请填充自动配置的播放资源，资源填充使用的是正常版本的第一个资源。"})):this.$message({type:"error",message:"第一个资源是短视频资源，无法快速填充。"})},handleInputLowerFormCoverType:function(e){this.cleanLowerForm(e)},cleanLowerForm:function(e){var t=Object.assign({},this.versionForm);t.type=e,t.coverType=e,"custom"===e&&(t.sign="openMode==app",t.contentType="custom",t.params={},t.clickTemplateType="custom"),this.lowerForm=t},validate:function(e,t){var a=this;this.$refs.basicForm.validate(function(n){n?a.checkNormalForm(function(){a.$refs.lowerForm.validate(function(n){if(n){var i=e.configModel,r=e.normalVersionContent;if("group"===i&&r.length<4)return a.$message.error("组合模式下，正常版本的配置资源至少4个，才可以进行保存！");if("sign"===i){var o=r[0];if("rotate"!==o.contentType)return a.$message.error("信号源模式下，第一个资源必须是轮播资源")}for(var l=0;l<r.length;l++)if(!r[l].poster.pictureUrl)return a.$message.error("请设置第 ".concat(l+1," 个内容的海报"));t()}else a.$message.error("请将表单填写完整")})}):a.$message.error("请将表单填写完整")})},getFormData:function(){var e=Object(Go["cloneDeep"])(this.basicForm);return e.normalVersionContent=this.isGroupModel?Object(Go["cloneDeep"])(this.normalVersionContent):[Object(Go["cloneDeep"])(this.normalForm)],e.lowerVersionContent=Object(Go["cloneDeep"])(this.lowerForm),e},handleSaveDraft:function(){var e=this,t=this.getFormData();t.isTiming=void 0,t.releaseTime=void 0,t.status=this.$consts.status.draft,this.validate(t,function(){e.doSave(t)})},handleSubmitAudit:function(e){var t=this,a=this.getFormData();a.status=this.$consts.status.waiting,this.validate(a,function(){t.couldSetReleaseTime?e?(a.isTiming=e.isTiming,a.releaseTime=e.releaseTime,t.doSave(a)):t.$refs.commonContent.showReleaseTimeSetter=!0:t.doSave(a)})},doSave:function(e){var t=this,a=function(e){var t=e.params||[];e.params=t.reduce(function(e,t){return e[t.key]=t.value,e},{})};"replicate"===this.mode&&(e.currentVersion="");var n=function e(t){return!0===t.shortVideoSwitch&&(t.type="shortVideo",t.params=Object(Q["a"])({},t.shortVideoParams),"autoSet"===t.sign&&(t.clickParams={},t.clickTemplateType="shortVideo"),t.coverType="shortVideo",t.contentType="shortVideo"),"url"===t.type&&(t.params={url:t.thirdIdOrPackageName,source:"",name:t.title,needParse:"false",url_type:"web"}),t.onclick&&(a(t.onclick),t.onclick=JSON.stringify(t.onclick)),t.subchannelId&&(t.params.stationId=t.subchannelId,delete t.subchannelId),t.params=JSON.stringify(t.params),t.clickParams=JSON.stringify(t.clickParams),t.dmpContentList.length>0?t.dmpContentList=t.dmpContentList.map(e):t.dmpContentList=void 0,delete t.shortVideoSwitch,delete t.shortVideoParams,delete t.thirdIdOrPackageName,delete t.activeIndex,delete t.showContentType,delete t.isDmpContent,t};e.normalVersionContent=e.normalVersionContent.map(n);var i=e.lowerVersionContent;i.onclick&&a(i.onclick),i.smallTopicsId&&(i.params.topicCode=i.smallTopicsId,delete i.smallTopicsId),i.subchannelId&&(i.params.stationId=i.subchannelId,delete i.subchannelId),i.params=JSON.stringify(i.params),i.onclick=JSON.stringify(i.onclick),e.parentType="Block",console.log("save",e),this.$service.saveBlockInfo({jsonStr:JSON.stringify(e)},"提交成功").then(function(){t.$emit("upsert-end")})},fetchData:function(e){var t=this;this.$service.getBroadcastBlockEditData({id:this.id,version:e}).then(function(e){console.log("detail",e);var a=t.basicForm;a.containerName=e.containerName,a.containerType="REFERENCE_BROADCASTING",a.configModel=e.configModel,a.source=e.source,a.status=e.status,a.id=e.id,a.currentVersion=e.currentVersion,a.duplicateVersion=e.duplicateVersion;var n=function(e){if(e){var t=e.params||{};e.params=Object.keys(t).map(function(e){return{key:e,value:t[e]}})}},i=function(e){e.cornerIconList=(e.cornerIconList||[]).reduce(function(e,t){return e[t.position]=t,e},[{},{},{},{}])},r=function e(a,r){return a.onclick="manualSet"===a.sign?JSON.parse(a.onclick):{},a.params=JSON.parse(a.params||"{}"),a.clickParams=JSON.parse(a.clickParams||"{}"),i(a),n(a.onclick),a.params.topicId&&(a.shortVideoSwitch=!0,a.shortVideoParams={topicId:void 0,shortVideoId:void 0},Object.assign(a.shortVideoParams,a.params)),a.thirdIdOrPackageName=t.getThirdId(a.params),a.subchannelIs="rotate"===a.contentType,a.subchannelIs&&(a.subchannelId=a.params.stationId),a.dmpContentList&&(a.dmpContentList=a.dmpContentList.map(function(t){return e(t,!0)})),a=t.genDefaultContentForm(Object(Q["a"])({},a,{isDmpContent:r})),a};t.normalVersionContent=e.normalVersionContent.map(function(e){return r(e,!1)}),t.normalForm=t.normalVersionContent[0];var o=Object(Go["cloneDeep"])(e.lowerVersionContent);o.onclick=JSON.parse(o.onclick),o.params=JSON.parse(o.params||"{}"),o.thirdIdOrPackageName=t.getThirdId(o.params),o.smallTopicsIs="bigTopic"===o.contentType,o.smallTopicsIs&&(o.smallTopicsId=o.params.topicCode),o.subchannelIs="rotate"===o.contentType,o.subchannelIs&&(o.subchannelId=o.params.stationId),n(o.onclick),i(o),t.lowerForm=o})},handleCloseLowerFormTag:function(){this.lowerForm.thirdIdOrPackageName=void 0,this.singleEpisodeNum=void 0}},created:function(){var e=this;this.normalForm=Object(Go["cloneDeep"])(this.versionForm),this.lowerForm=Object(Go["cloneDeep"])(this.versionForm),this.lowerForm.smallTopicsId="",this.lowerForm.smallTopicsIs=!1,this.mode=this.initMode||"create",this.id&&(this.fetchData(this.version),this.$sendEvent({type:"broadcast_show",payload:{broadcast_id:this.id}})),this.$service.getDictType({type:"materialType"}).then(function(t){for(var a=[],n=0;n<t.length;n++){var i={label:t[n].dictCnName,value:t[n].dictId};a.push(i),e.pictureListOptions.poster.searchParams.pictureCategory.options=a}}),this.$service.getCornerTypes().then(function(t){for(var a={},n=0;n<t.length;n++){var i=t[n].typeName,r=t[n].typeId;a[i]=r}e.cornerIconTypeOptions=a})}},Ic=wc,Cc=(a("46eb"),Object(Yo["a"])(Ic,Ws,qs,!1,null,"2d24fc9c",null)),Tc=Cc.exports,Sc={components:{TabPage:Il["a"],BroadcastBlockInfo:zs,BroadcastBlockInfoLegacy:Tc,BroadcastBlockList:Vl},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0,configModel:""}},methods:{handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0),this.configModel=""},handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e.id,this.mode="edit",this.isShowList=!1,this.configModel=e.configModel},handleRead:function(e,t){this.id=e.id,this.mode="read",this.version=t,this.isShowList=!1,this.configModel=e.configModel},handleDelete:function(e){var t=this;this.$service.deleteBroadcastBlock({id:e.map(function(e){return e.id}).join(",")},"删除成功").then(function(e){t.$refs.list.fetchData()})},handleCopy:function(e){this.id=e.id,this.mode="copy",this.isShowList=!1,this.configModel=e.configModel},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0,this.configModel=""}}},kc=Sc,_c=Object(Yo["a"])(kc,yl,wl,!1,null,"ffa73552",null),Pc=_c.exports,xc=a("9840"),Fc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{ref:"contentCard",staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.fetchData,"filter-reset":e.handleFilterReset}},[a("el-form",{ref:"form",staticClass:"form",attrs:{inline:"","label-width":"0px"},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("el-form-item",{staticClass:"el-col-6"},[a("el-input",{attrs:{placeholder:"ID"},model:{value:e.filter.pluginId,callback:function(t){e.$set(e.filter,"pluginId",t)},expression:"filter.pluginId"}})],1),a("el-form-item",{staticClass:"el-col-6"},[a("el-input",{attrs:{placeholder:"功能名称"},model:{value:e.filter.pluginName,callback:function(t){e.$set(e.filter,"pluginName",t)},expression:"filter.pluginName"}})],1),a("el-form-item",{staticClass:"el-col-6"},[a("el-select",{attrs:{placeholder:"父功能分类"},on:{change:e.getPluginType},model:{value:e.filter.pluginParentType,callback:function(t){e.$set(e.filter,"pluginParentType",t)},expression:"filter.pluginParentType"}},e._l(e.parentTypes,function(e,t){return a("el-option",{key:t,attrs:{label:e.dictCnName,value:e.dictEnName}})}),1)],1),a("el-form-item",{staticClass:"el-col-6"},[a("el-select",{attrs:{placeholder:"功能分类"},model:{value:e.filter.pluginType,callback:function(t){e.$set(e.filter,"pluginType",t)},expression:"filter.pluginType"}},e._l(e.pluginType,function(e,t){return a("el-option",{key:t,attrs:{label:e.dictCnName,value:e.dictEnName}})}),1)],1),a("el-form-item",{staticClass:"el-col-6"},[a("el-select",{attrs:{placeholder:"状态"},model:{value:e.filter.pluginStatus,callback:function(t){e.$set(e.filter,"pluginStatus",t)},expression:"filter.pluginStatus"}},e._l(e.$consts.statusOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{staticClass:"el-col-6"},[a("el-select",{attrs:{placeholder:"内容源"},model:{value:e.filter.source,callback:function(t){e.$set(e.filter,"source",t)},expression:"filter.source"}},e._l(e.$consts.sourceNumberOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{staticClass:"el-form-item-submit"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{on:{click:e.handleFilterReset}},[e._v("重置")])],1)],1),a("div"),a("ButtonGroupForListPage",{attrs:{pageName:"multiFunctionBlock"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},Dc=[],Rc={extends:Sl["a"],components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"],ButtonGroupForListPage:kl["a"]},data:function(){var e=this;return{resourceType:"blockInfo",pluginType:[],parentTypes:[],childTypes:{},filter:{},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"pluginId",width:"70"},{label:"功能名称",prop:"pluginName",render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(n)}}},n.pluginName)}},{label:"待审核的版本",prop:"duplicateVersion",sortable:!0,render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(n,n.duplicateVersion)}}},n.duplicateVersion)}},{label:"内容源",prop:"source",render:function(t,a){var n=a.row;return e.$consts.sourceNumberText[n.source]}},{label:"状态",prop:"pluginStatus",render:function(t,a){var n=a.row;return e.$consts.statusText[n.pluginStatus]}},{label:"更新时间",prop:"lastUpdateDate"},{label:"操作",render:function(t,a){var n=a.row;if(n.showContentAuthSettingBtn)return t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleOpenContentAuthManager(n)}}},"内容权限")}}],data:[],selected:[],selectionType:"multiple"}}},methods:{handleOpenContentAuthManager:function(e){this.$refs.contentCard.handleShowContentAuthManager({id:e.pluginId,menuElId:"multiFunctionBlock",type:"systemPlugin"})},getPluginType:function(){var e=this;this.$service.getPluginType({pluginParentType:this.filter.pluginParentType}).then(function(t){e.pluginType=t})},fetchData:function(){var e=this,t=this.parseFilter();this.$service.getMultiBlockList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},getPluginParentTypes:function(){var e=this;this.$service.getPluginParentTypes().then(function(t){e.parentTypes=t})},handleFilterChange:function(){this.$validateId(this.filter.pluginId)&&(this.pagination.currentPage=1,this.fetchData())},handleFilterReset:function(){this.filter={},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e}},created:function(){this.getPluginParentTypes(),this.fetchData()}},Lc=Rc,$c=(a("ad1b"),Object(Yo["a"])(Lc,Fc,Dc,!1,null,"7d08b1e5",null)),Nc=$c.exports,Ec=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PageWrapper",{staticClass:"tab-info-wrapper"},[a("PageContentWrapper",[a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("div",{staticClass:"multi-func-block-upsert"},[a("CommonContent",{attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{replicate:function(t){e.mode="replicate",e.title="创建副本"},edit:function(t){e.mode="edit",e.title="编辑"},unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,"submit-audit":function(t){return e.handleSubmitAudit(t,e.$consts.status.waiting)},"save-draft":function(t){return e.handleSubmitAudit(t,e.$consts.status.draft)},audit:function(t){return e.$emit("upsert-end")},"select-version":e.fetchData,delete:function(t){return e.$emit("upsert-end",t)}}},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),"read"!==e.mode?a("div",[a("el-form",{ref:"blockForm",attrs:{rules:e.rules,model:e.block,"label-width":"150px"}},[a("el-form-item",{attrs:{label:"系统功能名称",prop:"pluginInfo.pluginName",rules:e.rules.pluginInfo.pluginName}},[a("el-input",{model:{value:e.block.pluginInfo.pluginName,callback:function(t){e.$set(e.block.pluginInfo,"pluginName","string"===typeof t?t.trim():t)},expression:"block.pluginInfo.pluginName"}})],1),"builtIn"===e.block.pluginInfo.pluginParentType?a("div",[a("el-form-item",{attrs:{label:"固定刷新时间",prop:"pluginInfo.refreshTime"}},[a("InputMinute",{attrs:{min:5,max:1439},model:{value:e.block.pluginInfo.refreshTime,callback:function(t){e.$set(e.block.pluginInfo,"refreshTime",t)},expression:"block.pluginInfo.refreshTime"}})],1)],1):e._e(),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"builtIn"!==e.block.pluginInfo.pluginParentType,expression:"block.pluginInfo.pluginParentType !== 'builtIn'"}],attrs:{label:"类型",prop:"pluginInfo.pluginParentType",rules:e.rules.pluginInfo.pluginParentType}},[a("CommonSelector",{directives:[{name:"input-confirm",rawName:"v-input-confirm",value:{title:"提示",message:"切换类型将清空版本等相关数据，确定切换？",confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"},expression:"{\n                    title: '提示',\n                    message: '切换类型将清空版本等相关数据，确定切换？',\n                    confirmButtonText: '确定',\n                    cancelButtonText: '取消',\n                    type: 'warning'\n                  }"}],staticClass:"plugin-parent-type-selector",attrs:{filterable:"","no-input-confirm":!e.block.pluginInfo.pluginParentType,value:e.block.pluginInfo.pluginParentType,options:e.pluginParentTypes,labelKey:"dictCnName",valueKey:"dictEnName",disabled:"edit"===e.mode||"replicate"===e.mode,placeholder:"请选择"},on:{input:e.handleInputPluginParentType}})],1),"builtIn"!==e.block.pluginInfo.pluginParentType&&"secKill"!==e.pluginParentType?a("el-form-item",{attrs:{label:"内容源",prop:"pluginInfo.source",rules:e.rules.pluginInfo.source}},[a("el-radio-group",{attrs:{value:e.block.pluginInfo.source,disabled:e.isDisabledSource},on:{input:e.handleChangeSource}},e._l(e.$consts.sourceNumberOptions,function(t,n){return a("el-radio",{key:n,attrs:{label:t.value}},[e._v(e._s(t.label))])}),1)],1):e._e(),"sign"===e.pluginParentType?a("div",[a("el-form-item",{attrs:{label:"标记推荐位类型",prop:"pluginInfo.pluginType",rules:e.rules.pluginInfo.pluginType}},[a("el-input",{attrs:{disabled:e.isReplica},model:{value:e.block.pluginInfo.pluginType,callback:function(t){e.$set(e.block.pluginInfo,"pluginType","string"===typeof t?t.trim():t)},expression:"block.pluginInfo.pluginType"}})],1)],1):e._e(),"sign"!==e.pluginParentType&&e.pluginTypes.length>0?a("el-form-item",{attrs:{filterable:"",label:"多功能推荐位类型",prop:"pluginInfo.pluginType",rules:e.rules.pluginInfo.pluginType}},[a("CommonSelector",{directives:[{name:"input-confirm",rawName:"v-input-confirm",value:{title:"提示",message:"切换类型将清空版本等相关数据，确定切换？",confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"},expression:"{\n                    title: '提示',\n                    message: '切换类型将清空版本等相关数据，确定切换？',\n                    confirmButtonText: '确定',\n                    cancelButtonText: '取消',\n                    type: 'warning'\n                  }"}],staticStyle:{width:"300px"},attrs:{filterable:"","no-input-confirm":!e.block.pluginInfo.pluginType,value:e.block.pluginInfo.pluginType,options:e.pluginTypes,labelKey:"dictCnName",valueKey:"dictEnName",disabled:"edit"===e.mode||"replicate"===e.mode,placeholder:"请选择"},on:{input:e.handleInputPluginType}})],1):e._e(),"builtIn"===e.pluginParentType?a("el-form-item",{attrs:{label:"关联版面"}},[a("TabSelector",{on:{"select-end":e.handleSelectRelatedTabsEnd}}),e.block.pluginInfo.rlsTabs?a("div",{staticClass:"related-tabs"},e._l(e.block.pluginInfo.rlsTabs,function(t){return a("el-tag",{key:t.tabId,attrs:{closable:""},on:{close:function(a){return e.handleRemoveRelatedTab(t)}}},[e._v("\n                    "+e._s(t.tabName)+"\n                  ")])}),1):e._e()],1):e._e(),"builtIn"===e.pluginParentType?a("el-form-item",{attrs:{label:"会员展示"}},[a("el-select",{attrs:{filterable:"",clearable:!0},on:{clear:e.clearAll},model:{value:e.block.pluginInfo.sourceId,callback:function(t){e.$set(e.block.pluginInfo,"sourceId",t)},expression:"block.pluginInfo.sourceId"}},e._l(e.vipEnums,function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})}),1)],1):e._e(),e.baseHasTitle?a("div",[a("el-form-item",{attrs:{label:"标题",prop:"helper.title",rules:e.rules.title}},[a("el-input",{model:{value:e.block.helper.title,callback:function(t){e.$set(e.block.helper,"title","string"===typeof t?t.trim():t)},expression:"block.helper.title"}})],1),a("el-form-item",{attrs:{label:"副标题",prop:"helper.subTitle",rules:e.rules.subTitle}},[a("el-input",{model:{value:e.block.helper.subTitle,callback:function(t){e.$set(e.block.helper,"subTitle","string"===typeof t?t.trim():t)},expression:"block.helper.subTitle"}})],1)],1):e._e(),"sign"===e.pluginParentType?a("div",[a("Params",{attrs:{"prop-prefix":"helper.appParams.",params:e.block.helper.appParams}})],1):e._e(),e.pluginParentType&&"sign"!==e.pluginParentType?a("div",[a("div",{staticClass:"form-legend-header"},[a("span",[e._v("多版本信息")])]),a("Gallery",{staticClass:"gallery",attrs:{mode:e.mode,"active-index":e.currentIndex},on:{"active-index-change":function(t){e.currentIndex=t},activate:e.handleActivatePluginVersion},scopedSlots:e._u([{key:"item",fn:function(t){var n=t.item,i=t.index;return a("div",{},[n.dmpRegistryInfo?a("p",{staticClass:"ellipsis"},[e._v("\n                      人群: "+e._s(n.dmpRegistryInfo.dmpPolicyName)+"("+e._s(n.dmpRegistryInfo.dmpPolicyId)+")/"+e._s(n.dmpRegistryInfo.dmpCrowdName)+"("+e._s(n.dmpRegistryInfo.dmpCrowdId)+")\n                    ")]):a("p",{staticClass:"ellipsis",attrs:{title:n.label}},[e._v("\n                      "+e._s(n.label)+"\n                    ")]),a("p",{staticClass:"ellipsis",attrs:{title:e.getVersionTitle(n)}},[e._v(e._s(e.getVersionTitle(n)))]),a("i",{directives:[{name:"show",rawName:"v-show",value:7===n.dataType||4===n.dataType,expression:"item.dataType === 7 || item.dataType === 4"}],staticClass:"el-icon el-icon-close",attrs:{title:"移除"},on:{click:function(t){return t.stopPropagation(),e.handleRemovePluginVersion(i)}}})])}}],null,!1,2709139298),model:{value:e.block.rlsInfo,callback:function(t){e.$set(e.block,"rlsInfo",t)},expression:"block.rlsInfo"}},[a("div",{staticClass:"gallery-add",attrs:{slot:"add"},slot:"add"},[a("el-button",{attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),e.handleAddPluginVersion("dmp")}}},[e._v("+ 添加DMP")]),a("br"),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.canAddActivity,expression:"canAddActivity"}],attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),e.handleAddPluginVersion("activity")}}},[e._v("+ 添加活动")])],1),a("PluginContent",{ref:"pluginContent",attrs:{slot:"detail",source:e.source,mode:e.mode,plugin:e.currentPlugin,"plugin-type":e.pluginType,"plugin-list":e.block.rlsInfo,"parent-type":e.block.pluginInfo.pluginParentType},slot:"detail"})],1)],1):e._e()],1)],1):e._e(),"read"===e.mode?a("div",[a("el-form",{ref:"blockForm",attrs:{"label-width":"140px"}},[a("el-form-item",{attrs:{label:"系统功能名称",prop:"pluginInfo.pluginName"}},[e._v(e._s(e.block.pluginInfo.pluginName))]),"builtIn"===e.block.pluginInfo.pluginParentType?[a("el-form-item",{attrs:{label:"固定刷新时间",prop:"pluginInfo.refreshTime"}},[e._v("\n                  "+e._s(e.parseMinToStr(e.block.pluginInfo.refreshTime))+"\n                ")])]:e._e(),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"builtIn"!==e.block.pluginInfo.pluginParentType,expression:"block.pluginInfo.pluginParentType !== 'builtIn'"}],attrs:{label:"类型",prop:"pluginInfo.pluginParentType"}},[e._v(e._s(e.pluginParentTypeText))]),"builtIn"!==e.block.pluginInfo.pluginParentType&&"secKill"!==e.pluginParentType?a("el-form-item",{attrs:{label:"内容源"}},[e._v("\n                "+e._s(e.$consts.sourceNumberText[e.block.pluginInfo.source])+"\n              ")]):e._e(),"sign"===e.pluginParentType?a("div",[a("el-form-item",{attrs:{label:"标记推荐位类型",prop:"pluginInfo.pluginType"}},[e._v(e._s(e.block.pluginInfo.pluginType))])],1):e._e(),"sign"!==e.pluginParentType&&e.pluginTypes.length>0&&e.pluginTypeText?a("el-form-item",{attrs:{label:"多功能推荐位类型",prop:"pluginInfo.pluginType"}},[e._v("\n                "+e._s(e.pluginTypeText)+"\n              ")]):e._e(),"builtIn"===e.pluginParentType?a("el-form-item",{attrs:{label:"关联版面"}},[e.block.pluginInfo.rlsTabs?a("div",{staticClass:"related-tabs"},e._l(e.block.pluginInfo.rlsTabs,function(t){return a("el-tag",{key:t.tabId},[e._v("\n                    "+e._s(t.tabName)+"\n                  ")])}),1):e._e()]):e._e(),"builtIn"===e.pluginParentType?a("el-form-item",{attrs:{label:"会员展示"}},[e._v("\n                  "+e._s(e.block.pluginInfo.sourceName)+"\n                ")]):e._e(),e.baseHasTitle?[a("el-form-item",{attrs:{label:"标题",prop:"helper.title"}},[e._v(e._s(e.block.helper.title))]),a("el-form-item",{attrs:{label:"副标题",prop:"helper.subTitle"}},[e._v(e._s(e.block.helper.subTitle))])]:e._e(),"sign"===e.pluginParentType?a("div",[a("Params",{attrs:{params:e.block.helper.appParams,readonly:!0}})],1):e._e(),"sign"!==e.pluginParentType?[a("div",{staticClass:"form-legend-header"},[a("span",[e._v("多版本信息")])]),a("Gallery",{staticClass:"gallery",attrs:{"active-index":e.currentIndex,mode:e.mode},on:{activate:e.handleActivatePluginVersion},scopedSlots:e._u([{key:"item",fn:function(t){var n=t.item;return a("div",{},[n.dmpRegistryInfo?a("p",{staticClass:"ellipsis"},[e._v("\n                      人群: "+e._s(n.dmpRegistryInfo.dmpPolicyName)+"("+e._s(n.dmpRegistryInfo.dmpPolicyId)+")/"+e._s(n.dmpRegistryInfo.dmpCrowdName)+"("+e._s(n.dmpRegistryInfo.dmpCrowdId)+")\n                    ")]):a("p",{staticClass:"ellipsis",attrs:{title:n.label}},[e._v("\n                      "+e._s(n.label)+"\n                    ")]),a("p",{staticClass:"ellipsis",attrs:{title:e.getVersionTitle(n)}},[e._v(e._s(e.getVersionTitle(n)))])])}}],null,!1,1490121113),model:{value:e.block.rlsInfo,callback:function(t){e.$set(e.block,"rlsInfo",t)},expression:"block.rlsInfo"}},[a("PluginContent",{attrs:{slot:"detail",source:e.source,mode:e.mode,addable:!1,plugin:e.currentPlugin,"plugin-type":e.pluginType,"parent-type":e.block.pluginInfo.pluginParentType},slot:"detail"})],1)]:e._e()],2)],1):e._e()])],1)])],1)],1)},Oc=[],Ac=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"plugin-content"},[e.form?a("el-form",{ref:"form",attrs:{model:e.formWithComputedVal,rules:e.rules,"label-width":"120px"}},["read"!==e.mode?["REFERENCE_VOTE"===e.pluginType?[7===e.form.dataType?[a("el-form-item",{attrs:{label:"人群",prop:"dmpRegistryInfo"}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleSelectCrowdStart}},[e._v("\n              选择人群\n            ")]),e.form.dmpRegistryInfo?a("span",[e._v("\n              已选择: "+e._s(e.form.dmpRegistryInfo.dmpPolicyName)+"("+e._s(e.form.dmpRegistryInfo.dmpPolicyId)+")/"+e._s(e.form.dmpRegistryInfo.dmpCrowdName)+"("+e._s(e.form.dmpRegistryInfo.dmpCrowdId)+")\n            ")]):e._e()],1)]:e._e(),a("el-form-item",{attrs:{label:"活动id",prop:"voteActiveId"}},[a("InputPositiveInt",{attrs:{placeholder:"activeId"},model:{value:e.voteActiveId,callback:function(t){e.voteActiveId=t},expression:"voteActiveId"}})],1),a("div",[a("el-form-item",{attrs:{label:"海报",prop:"poster.pictureUrl",rules:e.rules.poster.pictureUrl}},[a("GlobalPictureSelector",{staticClass:"poster",attrs:{disabled:"read"===e.mode},on:{"select-end":e.handleSelectPosterEnd}},[e.form.poster.pictureUrl?a("img",{staticClass:"poster__img",attrs:{src:e.form.poster.pictureUrl}}):a("div",{staticClass:"poster__placeholder"})])],1)],1)]:["builtIn"===e.parentType?[a("el-form-item",{attrs:{label:"状态栏文字"}},[a("el-row",{staticStyle:{"max-width":"450px"}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{rules:e.rules.barText,prop:"title"}},[a("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title","string"===typeof t?t.trim():t)},expression:"form.title"}})],1)],1),a("el-col",{staticClass:"textAlignCenter",attrs:{span:2}},[e._v("|")]),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"subTitle"}},[a("el-input",{model:{value:e.form.subTitle,callback:function(t){e.$set(e.form,"subTitle","string"===typeof t?t.trim():t)},expression:"form.subTitle"}})],1)],1)],1)],1)]:e._e(),e.versionHasTitle?[a("el-form-item",{attrs:{label:"标题",prop:"title",rules:e.rules.title}},[a("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title","string"===typeof t?t.trim():t)},expression:"form.title"}})],1),a("el-form-item",{attrs:{label:"副标题",prop:"subTitle",rules:e.rules.subTitle}},[a("el-input",{model:{value:e.form.subTitle,callback:function(t){e.$set(e.form,"subTitle","string"===typeof t?t.trim():t)},expression:"form.subTitle"}})],1)]:e._e(),"secKill"===e.parentType?[a("el-form-item",{attrs:{label:"商品ID",prop:"goodsId",rules:e.rules.goodsId}},[a("el-input",{model:{value:e.form.goodsId,callback:function(t){e.$set(e.form,"goodsId","string"===typeof t?t.trim():t)},expression:"form.goodsId"}})],1),a("el-form-item",{attrs:{label:"商品名称",prop:"title",rules:e.rules.goodsId}},[a("el-input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title","string"===typeof t?t.trim():t)},expression:"form.title"}})],1)]:e._e(),7===e.form.dataType?[a("el-form-item",{attrs:{label:"人群",prop:"dmpRegistryInfo"}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleSelectCrowdStart}},[e._v("\n              选择人群\n            ")]),e.form.dmpRegistryInfo?a("span",[e._v("\n              已选择: "+e._s(e.form.dmpRegistryInfo.dmpPolicyName)+"("+e._s(e.form.dmpRegistryInfo.dmpPolicyId)+")/"+e._s(e.form.dmpRegistryInfo.dmpCrowdName)+"("+e._s(e.form.dmpRegistryInfo.dmpCrowdId)+")\n            ")]):e._e()],1)]:e._e(),a("div",[a("el-form-item",{attrs:{label:"海报",prop:"poster.pictureUrl",rules:e.rules.poster.pictureUrl}},[a("GlobalPictureSelector",{staticClass:"poster",attrs:{disabled:"read"===e.mode},on:{"select-end":e.handleSelectPosterEnd}},[e.form.poster.pictureUrl?a("img",{staticClass:"poster__img",attrs:{src:e.form.poster.pictureUrl}}):a("div",{staticClass:"poster__placeholder"})])],1)],1),"REFERENCE_ACTIVITY"===e.pluginType?[a("el-form-item",{attrs:{label:"异形焦点",prop:"extendInfo.focusImgUrl",rules:e.rules.focusImgUrl}},[a("GlobalPictureSelector",{staticClass:"poster",attrs:{disabled:"read"===e.mode},on:{"select-end":e.handleSelectFocusImgEnd}},[e.form.extendInfo.focusImgUrl?a("img",{staticClass:"poster__img",attrs:{src:e.form.extendInfo.focusImgUrl}}):a("div",{staticClass:"poster__placeholder"})])],1),a("el-form-item",{attrs:{label:"存活时间",prop:"extendInfo.aliveTime",rules:e.rules.aliveTime}},[a("InputMinute",{attrs:{max:1439,min:5},model:{value:e.form.extendInfo.aliveTime,callback:function(t){e.$set(e.form.extendInfo,"aliveTime",t)},expression:"form.extendInfo.aliveTime"}})],1),a("el-form-item",{attrs:{label:"点击次数",prop:"extendInfo.clickCount",rules:e.rules.clickCount}},[a("el-input",{model:{value:e.form.extendInfo.clickCount,callback:function(t){e.$set(e.form.extendInfo,"clickCount",e._n(t))},expression:"form.extendInfo.clickCount"}})],1)]:e._e(),"multi"===e.parentType||"secKill"===e.parentType||"builtIn"===e.parentType?a("el-form-item",{attrs:{label:"打开方式",prop:"openMode",rules:e.rules.openMode}},[a("el-select",{attrs:{disabled:e.VIP_QRCODE_MODE||e.PLAY_VIDEO_MODE,value:e.form.openMode},on:{input:function(t){return e.handleChangeOpenMode(e.form,t)}}},[a("el-option",{attrs:{label:"网页",value:"webpage"}}),a("el-option",{attrs:{label:"视频",value:"video"}}),a("el-option",{attrs:{label:"图片",value:"picture"}}),a("el-option",{attrs:{label:"版面",value:"tab"}}),a("el-option",{attrs:{label:"第三方应用",value:"app"}})],1),"app"===e.form.openMode?a("el-button",{staticClass:"marginL",attrs:{type:"primary",plain:""},on:{click:function(t){return e.handleSelectClickStart()}}},[e._v("快速填充")]):e._e()],1):e._e(),"webpage"===e.form.openMode?[a("el-form-item",{attrs:{label:"网页地址",prop:"onclick.webpageUrl",rules:e.rules.webpageUrl}},[a("el-input",{model:{value:e.form.onclick.webpageUrl,callback:function(t){e.$set(e.form.onclick,"webpageUrl","string"===typeof t?t.trim():t)},expression:"form.onclick.webpageUrl"}})],1),a("el-form-item",{attrs:{label:"网页类型",prop:"onclick.webpageType"}},[a("el-radio-group",{model:{value:e.form.onclick.webpageType,callback:function(t){e.$set(e.form.onclick,"webpageType",t)},expression:"form.onclick.webpageType"}},[a("el-radio",{attrs:{label:"1"}},[e._v("浮窗网页")]),a("el-radio",{attrs:{label:"2"}},[e._v("全屏网页")])],1)],1),a("el-form-item",{key:"webpageAppVersion",attrs:{label:"应用版本号",prop:"onclick.webpageAppVersion",rules:e.rules.webpageAppVersion}},[a("el-input",{model:{value:e.form.onclick.webpageAppVersion,callback:function(t){e.$set(e.form.onclick,"webpageAppVersion","string"===typeof t?t.trim():t)},expression:"form.onclick.webpageAppVersion"}})],1)]:e._e(),"video"===e.form.openMode?[a("el-form-item",{attrs:{label:"视频名称",prop:"onclick.videoName",rules:e.rules.videoName}},[a("el-input",{model:{value:e.form.onclick.videoName,callback:function(t){e.$set(e.form.onclick,"videoName","string"===typeof t?t.trim():t)},expression:"form.onclick.videoName"}})],1),a("el-form-item",{attrs:{label:"视频地址",prop:"onclick.videoUrl",rules:e.rules.videoUrl}},[a("el-input",{model:{value:e.form.onclick.videoUrl,callback:function(t){e.$set(e.form.onclick,"videoUrl","string"===typeof t?t.trim():t)},expression:"form.onclick.videoUrl"}})],1)]:e._e(),"tab"===e.form.openMode?[a("el-form-item",{attrs:{label:"版面",prop:"onclick.tab",rules:e.rules.tab}},[a("TabSelector",{attrs:{source:e.finalSource,selectionType:"single"},on:{"select-end":function(t){return e.handleSelectTabEnd(t,e.form)}}}),e.form.onclick.tab?a("el-tag",{attrs:{type:"primary"}},[e._v("已选择: "+e._s(e.form.onclick.tab.tabId))]):e._e()],1)]:e._e(),"picture"===e.form.openMode?[a("el-form-item",{attrs:{label:"选择图片",prop:"onclick.picture",rules:e.rules.picture}},[a("el-upload",{attrs:{action:e.urls.uploadImg,"on-success":e.handleUploadSuccess,"on-remove":e.handleUploadRemove,multiple:!1,"file-list":e.form.onclick.picture,accept:"image/png, image/gif, image/jpeg, image/bmp","list-type":"picture"}},[a("el-button",{attrs:{type:"primary"}},[e._v("点击上传")]),a("span",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("提示:只能上传png/gif/jpg/bmp文件")])],1)],1)]:e._e(),"app"===e.form.openMode?a("AppParams",{attrs:{"prop-prefix":"onclick."},model:{value:e.form.onclick,callback:function(t){e.$set(e.form,"onclick",t)},expression:"form.onclick"}}):e._e(),e.form.appParams?a("Params",{attrs:{params:e.form.appParams,"prop-prefix":"appParams."}}):e._e()]]:["REFERENCE_VOTE"===e.pluginType?[7===e.form.dataType?[a("el-form-item",{attrs:{label:"人群",prop:"dmpRegistryInfo"}},[e.form.dmpRegistryInfo?a("span",[e._v("\n              已选择: "+e._s(e.form.dmpRegistryInfo.dmpPolicyName)+"("+e._s(e.form.dmpRegistryInfo.dmpPolicyId)+")/"+e._s(e.form.dmpRegistryInfo.dmpCrowdName)+"("+e._s(e.form.dmpRegistryInfo.dmpCrowdId)+")\n            ")]):e._e()])]:e._e(),a("el-form-item",{attrs:{label:"活动id"}},[e._v(e._s(e.voteActiveId))]),a("el-form-item",{attrs:{label:"海报"}},[a("div",{staticClass:"poster"},[e.form.poster.pictureUrl?a("img",{staticClass:"poster__img",attrs:{src:e.form.poster.pictureUrl}}):e._e()])])]:[e.versionHasTitle?[a("el-form-item",{attrs:{label:"标题"}},[e._v(e._s(e.form.title))]),a("el-form-item",{attrs:{label:"副标题"}},[e._v(e._s(e.form.subTitle))])]:e._e(),"builtIn"===e.parentType?[a("el-form-item",{attrs:{label:"状态栏文字"}},[e._v(e._s(e.form.title)+" "+e._s(e.form.subTitle?" | "+e.form.subTitle:""))])]:e._e(),"secKill"===e.parentType?[a("el-form-item",{attrs:{label:"商品ID"}},[e._v(e._s(e.form.goodsId))]),a("el-form-item",{attrs:{label:"商品名称"}},[e._v(e._s(e.form.title))])]:e._e(),7===e.form.dataType?[a("el-form-item",{attrs:{label:"人群",prop:"dmpRegistryInfo"}},[e.form.dmpRegistryInfo?a("span",[e._v("\n              已选择: "+e._s(e.form.dmpRegistryInfo.dmpPolicyName)+"("+e._s(e.form.dmpRegistryInfo.dmpPolicyId)+")/"+e._s(e.form.dmpRegistryInfo.dmpCrowdName)+"("+e._s(e.form.dmpRegistryInfo.dmpCrowdId)+")\n            ")]):e._e()])]:e._e(),a("el-form-item",{attrs:{label:"海报"}},[a("div",{staticClass:"poster"},[e.form.poster.pictureUrl?a("img",{staticClass:"poster__img",attrs:{src:e.form.poster.pictureUrl}}):e._e()])]),"REFERENCE_ACTIVITY"===e.pluginType?[a("el-form-item",{attrs:{label:"异形焦点"}},[e.form.extendInfo.focusImgUrl?a("div",{staticClass:"focus-transition"},[a("img",{staticClass:"focus-transition__img",attrs:{src:e.form.extendInfo.focusImgUrl}})]):a("span",[e._v("无")])]),a("el-form-item",{attrs:{label:"存活时间"}},[e._v(e._s(e.parseMinToStr(e.form.extendInfo.aliveTime)))]),a("el-form-item",{attrs:{label:"点击次数"}},[e._v(e._s(e.form.extendInfo.clickCount))])]:e._e(),"multi"!==e.parentType&&"secKill"!==e.parentType&&"builtIn"!==e.parentType||e.VIP_QRCODE_MODE||e.PLAY_VIDEO_MODE?e._e():a("el-form-item",{attrs:{label:"打开方式"}},[e._v(e._s(e.OPEN_MODE_TEXT[e.form.openMode]))]),"webpage"===e.form.openMode?[a("el-form-item",{attrs:{label:"网页地址"}},[e._v(e._s(e.form.onclick.webpageUrl))]),a("el-form-item",{attrs:{label:"网页类型"}},[e._v(e._s(["","浮窗网页","全屏网页"][+e.form.onclick.webpageType]))]),a("el-form-item",{attrs:{label:"应用版本号"}},[e._v(e._s(e.form.onclick.webpageAppVersion))])]:e._e(),"video"===e.form.openMode?[a("el-form-item",{attrs:{label:"视频名称"}},[e._v(e._s(e.form.onclick.videoName))]),a("el-form-item",{attrs:{label:"视频地址"}},[e._v(e._s(e.form.onclick.videoUrl))])]:e._e(),"picture"===e.form.openMode?[a("el-form-item",{attrs:{label:"图片"}},[a("div",{staticClass:"open-picture"},[a("img",{staticClass:"open-picture__img",attrs:{src:e.form.onclick.picture[0].url}})])])]:e._e(),"tab"===e.form.openMode?[a("el-form-item",{attrs:{label:"版面"}},[e._v(e._s(e.form.onclick.tab.tabId))])]:e._e(),"app"===e.form.openMode?a("AppParamsRead",{attrs:{"label-width":"140px"},model:{value:e.form.onclick,callback:function(t){e.$set(e.form,"onclick",t)},expression:"form.onclick"}}):e._e(),e.form.appParams?a("Params",{attrs:{params:e.form.appParams,readonly:!0}}):e._e()]]],2):e._e(),a("el-dialog",{attrs:{visible:e.showClickSelector,width:"1200px"},on:{"update:visible":function(t){e.showClickSelector=t}}},[a("ClickSelector",{on:{"row-click":e.handleSelectClickEnd}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showClickSelector=!1}}},[e._v("取 消")])],1)],1),e.showCrowdSelector?a("CrowdSelector",{on:{"select-cancel":e.handleSelectCrowdCancel,"select-end":e.handleSelectCrowdEnd}}):e._e()],1)},Vc=[],Bc=a("5794"),Mc=a("8353"),Uc=a("8bca"),Gc={sign:"sign",multi:"multi",builtIn:"builtIn",secKill:"secKill"},jc={webpage:"网页",app:"第三方应用",video:"视频",tab:"版面",picture:"图片"},zc={components:{AppParams:is,AppParamsRead:us,Params:Bc["a"],ClickSelector:Yl,TabSelector:Mc["a"],CrowdSelector:fs["a"],InputMinute:Uc["a"],GlobalPictureSelector:ms["a"],InputPositiveInt:vs["a"]},data:function(){return{form:null,showCrowdSelector:!1,showClickSelector:!1,showFocusImgSelectorVisible:!1,PARENT_TYPES:Gc,OPEN_MODE_TEXT:jc,urls:{uploadImg:"api/v1/upload/image.html"},rules:{barText:[{max:45,message:"不超过 45 个字符",trigger:"blur"},{required:!0,message:"请输入状态栏文字",trigger:"blur"}],title:[{required:!0,message:"请输入标题",trigger:"blur"},{max:45,message:"不超过 45 个字符",trigger:"blur"}],subTitle:[{max:100,message:"不超过 100 个字符",trigger:"blur"}],openMode:[{required:!0,message:"请选择打开方式",trigger:"blur"}],goodsId:[{required:!0,message:"请填写商品ID",trigger:"blur"},{max:45,message:"不超过 45 个字符",trigger:"blur"}],webpageUrl:[{required:!0,message:"请填写网页地址",trigger:"blur"}],webpageAppVersion:[{required:!0,message:"请填写应用版本号",trigger:"blur"},{validator:function(e,t,a){if(t&&!/^(-1|\d*)$/.test(t))return a(new Error("应用版本号只能是数字或者-1"));a()}}],videoName:[{required:!0,message:"请填写视频名称",trigger:"blur"}],videoUrl:[{required:!0,message:"请填写视频地址",trigger:"blur"}],picture:[{trigger:"change",validator:function(e,t,a){a(t&&t.length>0?void 0:new Error("请上传图片"))}},{required:!0,message:"请上传图片"}],tab:[{trigger:"change",validator:function(e,t,a){a(t?void 0:new Error("请选择版面"))}},{required:!0,message:"请选择版面"}],clickCount:[{required:!0,message:"请填入点击次数"},{type:"number",message:"请填入数字"},{validator:function(e,t,a){/^[1-9][0-9]*$/.test(t)?a():a(new Error("请输入正整数"))}}],aliveTime:[{required:!0,message:"请填入存活时间"},{type:"number",message:"请填入数字"}],focusImgUrl:[{required:!0,message:"请选择异形焦点"}],poster:{pictureUrl:[{required:!0,message:"请选择海报",trigger:"blur"}]},dmpRegistryInfo:[{required:!0,message:"请选择人群",trigger:"blur"}],voteActiveId:[{required:!0,message:"请输入活动id (activeId)",trigger:"blur"}]}}},props:["mode","plugin","pluginList","pluginType","parentType","source"],computed:{VIP_QRCODE_MODE:function(){return"REFERENCE_VIP_QRCODE"===this.pluginType},PLAY_VIDEO_MODE:function(){return"REFERENCE_PLAY_VIDEO"===this.pluginType},formWithComputedVal:function(){return Object(Q["a"])({},this.form,{voteActiveId:this.voteActiveId})},versionHasTitle:function(){return"REFERENCE_MOVIE_VIP"===this.pluginType},voteActiveId:{get:function(){var e=(this.plugin.appParams||[])[0]||{};return e.value},set:function(e){this.plugin.appParams[0].value=e}},finalSource:function(){return"builtIn"===this.parentType?void 0:this.source}},methods:{validate:function(e){var t=this,a=this.$refs.form;a?a.validate(function(a){a?e():t.$message({type:"error",message:"请填写完整表单"})}):e()},handlePluginChange:function(e){this.form=e;var t=this.$refs.form;t&&t.clearValidate()},handleSelectPosterEnd:function(e){this.form.poster={pictureId:e.pictureId,pictureStatus:e.pictureStatus,pictureUrl:e.pictureUrl}},handleSelectClickStart:function(){this.showClickSelector=!0},handleSelectClickEnd:function(e){this.showClickSelector=!1;var t=JSON.parse(e.params),a=Object.keys(t),n=a.reduce(function(e,a,n){var i={};return i.key=a,i.value=t[a],e.push(i),e},[]),i={packagename:e.packagename,versioncode:e.versioncode,dowhat:e.dowhat,bywhat:e.bywhat,byvalue:e.byvalue,params:n,exception:e.exception,defaultParams:this.VIP_QRCODE_MODE?(this.form.onclick||{}).defaultParams:void 0};this.form.onclick=i},handleChangeOpenMode:function(e,t){this.$refs["form"].clearValidate(),e.openMode=t,e.onclick="webpage"===t?{webpageType:"1",webpageUrl:void 0,webpageAppVersion:""}:{}},handleUploadSuccess:function(e){if(e.success){var t=this.form;this.$set(t.onclick,"picture",[{name:"已上传",url:e.data[0].url}])}else this.$message(e.msg)},handleUploadRemove:function(e){var t=this.form;t.onclick.picture=[]},handleSelectTabEnd:function(e,t){this.$set(t.onclick,"tab",e)},handleSelectCrowdStart:function(){this.showCrowdSelector=!0},handleSelectCrowdCancel:function(){this.showCrowdSelector=!1},handleSelectCrowdEnd:function(e,t){var a=this.form,n=e.value,i=e.label,r=t.value,o=t.label,l=this.pluginList.find(function(e){return e.dmpRegistryInfo&&e.dmpRegistryInfo.dmpCrowdId===r&&e!==a});l?this.$message({type:"error",message:"该人群已被选择"}):(this.$set(this.form,"dmpRegistryInfo",{dmpPolicyId:n,dmpCrowdId:r,dmpPolicyName:i,dmpCrowdName:o}),this.showCrowdSelector=!1)},parseMinToStr:function(e){var t=Math.floor(e/60),a=e%60,n=t>9?""+t:"0"+t,i=a>9?""+a:"0"+a;return n+":"+i},handleTime:function(){},handleSelectFocusImgEnd:function(e){this.$set(this.form.extendInfo,"focusImgUrl",e.pictureUrl)},selectImgSubmit:function(){}},created:function(){this.$watch("plugin",this.handlePluginChange,{immediate:!0})}},Wc=zc,qc=(a("e9b8"),Object(Yo["a"])(Wc,Ac,Vc,!1,null,"8b7b7c6a",null)),Jc=qc.exports,Hc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"gallery__wrapper"},[a("div",{staticClass:"gallery__list"},[a("read"===e.mode?"div":"draggable",{tag:"component",attrs:{value:e.value},on:{input:function(t){return e.$emit("input",t)},start:e.handleDragStart,end:e.handleDragEnd}},e._l(e.value,function(t,n){return a("div",{key:n,class:["gallery__item",n===e.activeIndex?"active":""],on:{click:function(t){return e.handleActivate(n)}}},[e._t("item",null,{item:t,index:n})],2)}),0),"read"!==e.mode?a("div",{staticClass:"gallery__item",on:{click:e.handleAdd}},[e._t("add",[a("div",{staticClass:"gallery__add"},[e._v("\n          +\n        ")])])],2):e._e()],1),a("div",{staticClass:"gallery__detail"},[e._t("detail")],2)])},Kc=[],Yc={components:{draggable:Gl.a},props:["value","activeIndex","mode"],methods:{handleActivate:function(e){this.$emit("activate",e)},handleAdd:function(e){e.stopPropagation(),this.$emit("add")},handleDragStart:function(e){return e.preventDefault(),!1},handleDragEnd:function(e){var t,a=e.oldIndex,n=e.newIndex,i=this.activeIndex;a===i?t=n:a<i&&n>=i?t=i-1:a>i&&n<=i&&(t=i+1),void 0!==t&&this.$emit("active-index-change",t)}}},Qc=Yc,Xc=(a("60a9"),Object(Yo["a"])(Qc,Hc,Kc,!1,null,"d64cb3d0",null)),Zc=Xc.exports,eu=a("4bc7"),tu=a("5f87"),au={sign:"sign",multi:"multi",builtIn:"builtIn",secKill:"secKill"},nu={components:{CommonContent:Ql["a"],PluginContent:Jc,Gallery:Zc,PageWrapper:eu["a"],PageContentWrapper:tu["a"],InputMinute:Uc["a"],Params:Bc["a"],TabSelector:Mc["a"],CommonSelector:es["a"]},props:["id","initMode","version","contentProps"],data:function(){return{vipEnums:[],vipEnumsData:[],currentIndex:0,title:null,dialogTableVisible:!1,dialogClickTableVisible:!1,showFocusImgSelectorVisible:!1,clickData:{},selectImgData:{},urls:{uploadImg:"api/v1/upload/image.html"},PARENT_TYPES:au,mode:"create",pluginParentTypes:[],pluginTypes:[],pluginVersions:{},selectingPostForIndex:void 0,showClickSelector:!1,selectingClickForIndex:void 0,showTabSelector:!1,selectingTabForIndex:void 0,showFocusImgSelector:!1,selectingFocusImgForIndex:void 0,block:{helper:{title:void 0,subTitle:void 0,appParams:[],webpageUrl:void 0,webpageType:"1",webpageAppVersion:void 0},pluginInfo:{pluginId:void 0,pluginName:"",pluginParentType:void 0,source:0,channel:"",pluginType:void 0,enableEdit:1,pluginStatus:void 0,refreshTime:"sysPlugin"===this.contentProps.menuElId?240:"",rlsTabs:[],sourceId:"",sourceName:"",sourceSign:""},rlsInfo:[]},rules:{pluginInfo:{pluginName:[{required:!0,message:"请输入系统功能名称",trigger:"blur"},{max:45,message:"不超过 45 个字符",trigger:"blur"}],refreshTime:[{required:!0,message:"请选择固定刷新时间",trigger:"blur"}],pluginParentType:[{required:!0,message:"请选择类型",trigger:"blur"}],pluginType:[{required:!0,message:"不能为空",trigger:"blur"}]},title:[{required:!0,message:"请输入标题",trigger:"blur"},{max:45,message:"不超过 45 个字符",trigger:"blur"}],subTitle:[{max:45,message:"不超过 45 个字符",trigger:"blur"}]}}},computed:{currentPlugin:function(){return this.block.rlsInfo[this.currentIndex]},source:function(){var e=["","o_tencent","o_iqiyi","o_youku"];return e[this.block.pluginInfo.source]},resourceInfo:function(){var e=this.block.pluginInfo;if(e.pluginId)return{id:e.pluginId,type:"systemPlugin",menuElId:this.contentProps.menuElId,version:e.currentVersion,status:e.pluginStatus}},canAddActivity:function(){if("sysPlugin"===this.contentProps.menuElId)return!this.block.rlsInfo.find(function(e){var t=e.dataType;return 4===t})},pluginTypeText:function(){var e=this.pluginType,t=this.pluginTypes;if(t.length>0){var a=t.find(function(t){return t.dictEnName===e});if(a)return a.dictCnName}},pluginParentTypeText:function(){var e=this.pluginParentType,t=this.pluginParentTypes;if(t.length>0){var a=t.find(function(t){return t.dictEnName===e});if(a)return a.dictCnName}},pluginParentType:function(){return this.block.pluginInfo.pluginParentType},pluginType:function(){return this.block.pluginInfo.pluginType},isDisabledSource:function(){return"edit"===this.mode},versionHasTitle:function(){var e=this.pluginType;return"REFERENCE_MOVIE_VIP"===e},baseHasTitle:function(){var e=this.pluginParentType,t=this.pluginType;return"secKill"!==e&&"builtIn"!==e&&t&&"REFERENCE_MOVIE_VIP"!==t},isReplica:function(){return"replicate"===this.mode||"yes"===this.block.duplicateVersion}},watch:{},methods:{clearAll:function(){this.block.pluginInfo.sourceName="",this.block.pluginInfo.sourceSign=""},getVipButtonSource:function(){var e=this;this.$service.getVipButtonSource().then(function(t){e.vipEnumsData=t,e.vipEnums=t.map(function(e){return{value:e.sourceId,label:e.sourceName}})})},handleRemoveRelatedTab:function(e){var t=e.tabId,a=this.block.pluginInfo;a.rlsTabs=a.rlsTabs.filter(function(e){return e.tabId!==t})},handleSelectRelatedTabsEnd:function(e){var t=this.block.pluginInfo,a=t.rlsTabs||[],n=a.reduce(function(e,t){return e[t.tabId]=t,e},{}),i=e.reduce(function(e,t){return e[t.tabId]=t,e},{}),r=Object(Q["a"])({},n,i),o=Object.keys(r).map(function(e){return{tabId:e,tabName:r[e].tabName}});this.$set(t,"rlsTabs",o)},getVersionTitle:function(e){return"".concat(e.title).concat(e.subTitle?" | "+e.subTitle:"")},handleActivatePluginVersion:function(e){var t=this;this.currentIndex!==e&&("read"===this.mode?this.currentIndex=e:this.$refs.pluginContent.validate(function(){t.currentIndex=e}))},handleAddPluginVersion:function(e){var t=this;this.$refs.pluginContent.validate(function(){var a="activity"===e?{label:"活动形式",dataType:4}:{label:"",dataType:7},n=t.block.rlsInfo;n.push(t.genRlsInfo(a,t.block.pluginInfo.pluginType)),t.currentIndex=n.length-1})},handleRemovePluginVersion:function(e){var t=this.block.rlsInfo;t.splice(e,1);var a=this.currentIndex,n=t.length;if(a===e&&n>0){while(!t[a])a=0===a?n-1:a-1;this.currentIndex=a}},parseStrToMin:function(e){var t=e.split(":"),a=parseInt(t[0]),n=parseInt(t[1]);return 60*a+n},parseMinToStr:function(e){var t=Math.floor(e/60),a=e%60,n=t>9?""+t:"0"+t,i=a>9?""+a:"0"+a;return n+":"+i},fetchData:function(e){var t=this;this.$service.editSysPlugin({id:this.id,version:e}).then(function(e){e&&(t.setData(e),t.pluginType&&t.getPluginVersions(t.pluginType).then(function(e){var t=this;if(e){var a=this.block.rlsInfo,n=e.reduce(function(e,t){return e[t.dictEnName]=t,e},{});a.forEach(function(e){var a=n[e.dataType];a&&t.$set(e,"label",a.dictCnName)})}}.bind(t)))})},getPluginParentTypes:function(){var e=this;this.$service.getPluginParentTypes().then(function(t){console.log(t),t&&(e.pluginParentTypes=t.filter(function(e){return"builtIn"!==e.dictEnName}))})},getPluginTypes:function(e){var t=this;this.$service.getPluginTypes({pluginParentType:e}).then(function(e){console.log(e),e&&(t.pluginTypes=e)})},getPluginVersions:function(e){var t=this,a=this.pluginVersions;return new Promise(function(n,i){a[e]?n(a[e]):t.$service.getPluginVersions(e).then(function(t){t&&(a[e]=t,n(a[e]))})})},handleChangeSource:function(e){this.$confirm("确定切换内容源？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){this.$refs["blockForm"].clearValidate(),this.block.pluginInfo.source=e}.bind(this)).catch(function(e){throw e})},handleInputPluginParentType:function(e){this.$refs["blockForm"].clearValidate(),this.pluginTypes=[],this.setPluginParentType(e),this.getPluginTypes(e),"secKill"===e&&this.setPluginType("REFERENCE_MALL_SECKILL")},setPluginParentType:function(e){var t=this.block,a=t.pluginInfo,n=t.helper;t.rlsInfo=[],a.source=0,a.pluginType=void 0,a.pluginParentType=e,n.title="",n.subTitle="",n.appParams=[]},handleInputPluginType:function(e){this.$refs["blockForm"].clearValidate(),this.setPluginType(e)},setPluginType:function(e){var t=this,a=this.block,n=a.helper;this.getPluginVersions(e).then(function(i){a.pluginInfo.pluginType=e,n.title="",n.subTitle="",a.rlsInfo=i.map(function(a){return t.genRlsInfo({label:a.dictCnName,dataType:+a.dictEnName},e)}),t.currentIndex=0}).then(function(){})},genRlsInfo:function(e,t){var a,n={};"REFERENCE_ACTIVITY"===t&&(n={focusImgUrl:void 0,aliveTime:60,clickCount:5}),this.pluginParentType===au.multi&&(a=[]);var i=Object.assign({openMode:"app",pluginDataId:void 0,dataType:5,onclick:{},appParams:a,params:0,title:"",subTitle:"",goodsId:void 0,webpageUrl:void 0,poster:{pictureId:void 0,pictureUrl:void 0}},{extendInfo:n},e);return"REFERENCE_VOTE"===t&&Object.assign(i,{openMode:"app",appParams:[{key:"activeId",value:""}],onclick:{packagename:"com.tianci.movieplatform",versioncode:"-1",dowhat:"startActivity",bywhat:"action",byvalue:"coocaa.intent.movie.ranking",params:[{key:"rankingCode",value:"23"}]}}),"REFERENCE_VIP_QRCODE"===t&&Object.assign(i,{appParams:Object(Go["cloneDeep"])(Ds)}),"REFERENCE_PLAY_VIDEO"===t&&Object.assign(i,{appParams:[{key:"id",value:void 0,default:!0,tip:"用酷开自有ID"},{key:"type",value:"res",hide:!0}]}),i},selectSubmit:function(){},clickSubmit:function(){},parseAppParams:function(e,t){return"REFERENCE_PLAY_VIDEO"===t?Object.keys(e).map(function(t){var a={};return"id"===t&&(a={default:!0,tip:"用酷开自有ID"}),"type"===t&&(a={hide:!0}),Object(Q["a"])({key:t,value:e[t]},a)}):"REFERENCE_VIP_QRCODE"===t?Object.keys(e).map(function(t){var a=Object(Go["cloneDeep"])(Ds.find(function(e){return e.key===t}));return a?(a.value=e[t],a):{key:t,value:e[t]}}):Object.keys(e).map(function(t){return{key:t,value:e[t]}})},parseOnclick:function(e,t){if(e.params){var a=Object(Go["cloneDeep"])(e.params);e.params=Object.keys(e.params).map(function(e){return{key:e,value:a[e]}})}return e},getData:function(e){console.log(this.block.pluginInfo,"-----ehehe");var t=JSON.parse(JSON.stringify(this.block));return"replicate"===this.mode&&(t.pluginInfo.currentVersion=""),t.pluginInfo.pluginStatus=e,t},validateData:function(e,t){var a=this,n=function(e){a.$message({type:"error",message:e})},i=function(t){if(e.rlsInfo&&e.rlsInfo.length>0){var a=e.rlsInfo.find(function(e){return e.poster&&!e.poster.pictureUrl});if(a)return n("请把每个版本都信息填写完整")}t()};this.$refs.blockForm.validate(function(a){if(a){var r=this.$refs.pluginContent;r?r.validate(function(){i(function(){t(e)})}):i(function(){t(e)})}else n("请把表单填写完整")}.bind(this))},setData:function(e){var t=this.block.helper,a=JSON.parse(JSON.stringify(e)),n=a.pluginInfo.pluginParentType,i=a.pluginInfo.pluginType;a.pluginInfo.sourceId&&(a.pluginInfo.sourceId=1*a.pluginInfo.sourceId),a.rlsInfo.forEach(function(e){if(e.openMode=e.params.split(",")[0].split("==")[1],e.appParams){var t=JSON.parse(e.appParams);e.appParams=this.parseAppParams(t,i)}if(e.onclick){e.onclick=this.parseOnclick(JSON.parse(e.onclick),i);var a=e.onclick,n=a.params.reduce(function(e,t){return e[t.key]=t.value,e},{});switch(e.openMode){case"webpage":e.onclick={webpageType:"coocaa.intent.action.browser"===a.byvalue?"1":"2",webpageUrl:n.url,webpageAppVersion:a.versioncode};break;case"video":e.onclick={videoName:n.name,videoUrl:n.url};break;case"picture":e.onclick={picture:[{name:"已上传",url:n.url}]};break;case"tab":e.onclick={tab:{tabId:n.id}}}}e.extendInfo=e.extendInfo||{}}.bind(this)),n&&this.getPluginTypes(n);var r=a.rlsInfo[0]||{};"secKill"!==n&&i&&"REFERENCE_MOVIE_VIP"!==i&&(t.title=r.title,t.subTitle=r.subTitle),n===au.sign&&r.appParams&&(t.appParams=r.appParams),this.block=Object(Q["a"])({},this.block,a),console.log("block",this.block)},parseData:function(e){var t=e.helper,a=this.baseHasTitle,n=this.pluginParentType;return console.log(this.vipEnumsData,"-="),"sign"===n&&(e.rlsInfo=e.rlsInfo||[],e.rlsInfo[0]=e.rlsInfo[0]||{dataType:5,title:void 0,subTitle:void 0},e.rlsInfo[0].appParams=t.appParams),e.rlsInfo.forEach(function(e){var n=e.onclick;switch(e.openMode&&(e.params="openMode=="+e.openMode),e.openMode){case"webpage":"1"===n.webpageType?e.onclick={packagename:"com.coocaa.app_browser",versioncode:n.webpageAppVersion,dowhat:"startActivity",bywhat:"action",byvalue:"coocaa.intent.action.browser",params:[{key:"url",value:n.webpageUrl}],exception:{}}:"2"===n.webpageType&&(e.onclick={packagename:"com.coocaa.app_browser",versioncode:n.webpageAppVersion,dowhat:"startActivity",bywhat:"action",byvalue:"coocaa.intent.action.browser.no_trans",params:[{key:"url",value:n.webpageUrl}],exception:{}});break;case"video":e.onclick={packagename:"com.tianci.movieplatform",versioncode:"-1",dowhat:"startService",bywhat:"action",byvalue:"coocaa.intent.player.video",params:[{key:"name",value:n.videoName},{key:"url",value:n.videoUrl},{key:"needParse",value:"false"},{key:"url_type",value:"web"}],exception:{}};break;case"picture":e.onclick={packagename:"com.tianci.movieplatform",versioncode:"",dowhat:"startService",bywhat:"action",byvalue:"coocaa.intent.player.image",params:[{key:"name",value:""},{key:"url",value:n.picture[0].url}],exception:{}};break;case"tab":e.params+=",tabType=="+n.tab.tabType,e.onclick={packagename:"com.tianci.movieplatform",versioncode:"",dowhat:"startActivity",bywhat:"action",byvalue:1==n.tab.tabType?"coocaa.intent.action.HOME_COMMON_LIST":"coocaa.intent.action.HOME_SPECIAL_TOPIC",params:[{key:"id",value:n.tab.tabId}],exception:{}};break;case"app":e.onclick.exception={name:"onclick_exception",value:{packagename:"com.tianci.appstore",dowhat:"startActivity",versioncode:"-1",params:[{key:"id",value:n.packagename}],byvalue:"coocaa.intent.action.APP_STORE_DETAIL",bywhat:"action"}};break}if(a&&(e.title=t.title,e.subTitle=t.subTitle),e.onclick&&e.onclick.params){if(e.onclick.params=e.onclick.params.reduce(function(e,t){return e[t.key]=t.value,e},{}),e.onclick.defaultParams&&0!==e.onclick.defaultParams.length){var i=e.onclick.defaultParams.reduce(function(e,t){return e[t.key]=t.value,e},{});Object.assign(e.onclick.params,i)}delete e.onclick.defaultParams,e.onclick=JSON.stringify(e.onclick)}e.appParams&&(e.appParams=e.appParams.reduce(function(e,t){return e[t.key]=t.value,e},{}),e.appParams=JSON.stringify(e.appParams)),delete e.openMode}),delete e.helper,e},handleSubmitAudit:function(e,t){var a=this.getData(t);console.log(a,"----dd"),this.validateData(a,function(){this.submit(a)}.bind(this))},submit:function(e){this.validateData(e,function(){var t=this;e=this.parseData(e),e.pluginInfo.sourceId&&this.vipEnumsData.map(function(t){t.sourceId===e.pluginInfo.sourceId&&(e.pluginInfo.sourceName=t.sourceName,e.pluginInfo.sourceSign=t.sourceSign)}),console.log(e,"========保存"),this.$service.SavePlugin(e,"保存成功").then(function(e){t.$emit("upsert-end")})}.bind(this))}},mounted:function(){this.getVipButtonSource()},created:function(){switch(this.getPluginParentTypes(),this.mode=this.initMode||"create",this.mode){case"create":this.title="新增";break;case"copy":this.title="复制";break;case"edit":this.title="编辑";break;case"replica":this.title="创建副本";break;case"read":this.title="预览";break}this.id&&this.fetchData(this.version)}},iu=nu,ru=(a("5318"),Object(Yo["a"])(iu,Ec,Oc,!1,null,"5f691aca",null)),ou=ru.exports,lu={extends:xc["a"],components:{ResourceList:Nc,ResourceContent:ou},data:function(){return{}},computed:{resourceInfo:function(){return{type:"multiFunctionBlock",idField:"pluginId"}},contentProps:function(){return{menuElId:"multiFunctionBlock"}}}},su=lu,cu=Object(Yo["a"])(su,ec,tc,!1,null,null,null),uu=cu.exports,du=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{ref:"contentCard",staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:null,pagination:e.pagination},on:{"filter-change":e.fetchData}},[a("el-form",{attrs:{inline:!0},nativeOn:{submit:function(t){return t.preventDefault(),e.handleFilterChange(t)},reset:function(t){return t.preventDefault(),e.handleFilterReset(t)}}},[a("el-form-item",[a("InputPositiveInt",{attrs:{clearable:"",placeholder:"状态栏ID",title:"状态栏ID"},model:{value:e.filter.pluginId,callback:function(t){e.$set(e.filter,"pluginId",t)},expression:"filter.pluginId"}})],1),a("el-form-item",[a("el-input",{attrs:{clearable:"",placeholder:"状态栏名称",title:"状态栏名称"},model:{value:e.filter.pluginName,callback:function(t){e.$set(e.filter,"pluginName",t)},expression:"filter.pluginName"}})],1),a("el-form-item",[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"状态",title:"状态"},model:{value:e.filter.pluginStatus,callback:function(t){e.$set(e.filter,"pluginStatus",t)},expression:"filter.pluginStatus"}},e._l(e.$consts.statusOptions,function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})}),1)],1),a("el-form-item",{staticClass:"el-form-item-submit"},[a("el-button",{attrs:{type:"primary","native-type":"submit"}},[e._v("查询")]),a("el-button",{attrs:{"native-type":"reset"}},[e._v("重置")])],1)],1),a("ButtonGroupForListPage",{attrs:{pageName:"sysPlugin"},on:{edit:e.handleEdit}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},pu=[],hu={extends:Sl["a"],components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"],ButtonGroupForListPage:kl["a"],InputPositiveInt:vs["a"]},data:function(){var e=this;return{resourceType:"sysPlugin",channelOptions:[{label:"影视",value:"movie"},{label:"体育",value:"sport"},{label:"教育",value:"edu"},{label:"少儿",value:"child"}],channel:{"影视":"movie","体育":"sport","教育":"edu","少儿":"child"},filterSchema:null,pagination:{},selected:[],filter:this.genDefaultFilter(),efficientFilter:this.genDefaultFilter(),table:{props:{},header:[{label:"状态栏ID",prop:"pluginId",width:"100"},{label:"状态栏名称",prop:"pluginName",render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(n)}}},n.pluginName)}},{label:"待审核的版本",prop:"duplicateVersion",sortable:!0,width:140,render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(n,n.duplicateVersion)}}},n.duplicateVersion)}},{label:"状态",prop:"pluginStatus",width:100,render:function(t,a){var n=a.row;return e.$consts.statusText[n.pluginStatus]}},{label:"版面",render:function(e,t){var a=t.row,n=a.rlsTabs||[];return n.map(function(e){return"".concat(e.tabName,"(").concat(e.tabId,")")}).join("、")}},{label:"更新时间",width:140,prop:"lastUpdateDate"},{label:"操作",width:100,render:function(t,a){var n=a.row;if(n.showContentAuthSettingBtn)return t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleOpenContentAuthManager(n)}}},"内容权限")}}],data:[],selected:[],selectionType:"multiple"}}},methods:{handleOpenContentAuthManager:function(e){this.$refs.contentCard.handleShowContentAuthManager({id:e.pluginId,menuElId:"sysPlugin",type:"systemPlugin"})},genDefaultFilter:function(){return{pluginId:"",pluginName:"",pluginStatus:""}},fetchData:function(){var e=this,t=this.parseFilter();this.$service.getSysPlugin(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},handleFilterChange:function(e,t){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleFilterReset:function(){this.filter=this.genDefaultFilter(),this.efficientFilter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.pagination,t=JSON.parse(JSON.stringify(this.efficientFilter));return e&&(t.page=e.currentPage,t.rows=e.pageSize),t}},created:function(){this.fetchData()}},mu=hu,fu=(a("b679"),Object(Yo["a"])(mu,du,pu,!1,null,"3355a6e6",null)),vu=fu.exports,gu={extends:xc["a"],components:{ResourceList:vu,ResourceContent:ou},data:function(){return{}},computed:{resourceInfo:function(){return{type:"sysPlugin",idField:"pluginId"}},contentProps:function(){return{menuElId:"sysPlugin"}}}},bu=gu,yu=Object(Yo["a"])(bu,ac,nc,!1,null,null,null),wu=yu.exports,Iu=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("TabPage",[a("AlbumPannelInfoList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,read:e.handleRead,edit:e.handleEdit,copy:e.handleCopy,delete:e.handleDelete}}),e.isShowList?e._e():a("PanelInfo",{attrs:{id:e.id,"panel-data-type":3,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},Cu=[],Tu=a("43f4"),Su=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{ref:"contentCard",staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[void 0===e.dataList?a("ButtonGroupForListPage",{attrs:{pageName:"albumPanel"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}):e._e(),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},ku=[],_u={extends:Sl["a"],components:{ContentWrapper:Bo["ContentWrapper"],Table:Bo["Table"],ButtonGroupForListPage:kl["a"]},props:{dataList:{type:Object}},data:function(){var e=this;return{canAdd:!1,resourceType:"panelInfo",businessType:{},pannelStatus:{},filter:this.genDefaultFilter(),filterSchema:null,pagination:{currentPage:1},table:{props:{},data:[],header:[{label:"ID",prop:"pannelGroupId"},{label:"名称",prop:"pannelGroupRemark",minWidth:180,"show-overflow-tooltip":!0,render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n)}}},n.pannelGroupRemark)}},{label:"布局",width:"150",prop:"fullLayoutName"},{label:"业务分类",prop:"categoryName"},{label:"内容源",prop:"pannelResource",formatter:function(t){return e.$consts.sourceText[t.pannelList[0].pannelResource]}},{label:"引用状态",prop:"fullTabName","show-overflow-tooltip":!0},{label:"版本/状态",prop:"pannelStatus",width:"130",formatter:function(t){var a=t.pannelStatus,n=t.currentVersion;return n+"/"+e.$consts.statusText[a]}},{label:"待审核副本",width:"100",prop:"duplicateVersion",render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(n,n.duplicateVersion)}}},n.duplicateVersion)}},{label:"更新时间",prop:"lastUpdateDate",width:"140","show-overflow-tooltip":!0},{label:"审核人",prop:"auditor",width:"100"},{label:"更新人",prop:"userName",width:"100"},{label:"操作",fixed:"right",width:140,render:function(t,a){var n=a.row;return t("div",[e.canAdd&&t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleCopy(n)}}},"复制"),t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleToggleCollect(n)}}},[t("el-icon",{class:n.collected?"el-icon-star-on":"el-icon-star-off"}),n.collected?"取消":"收藏"]),!!n.showContentAuthSettingBtn&&t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleOpenContentAuthManager(n)}}},"内容权限")])}}],selected:[],selectionType:"multiple"},selected:[]}},watch:{selected:{handler:function(e,t){var a=this.table,n=[];a.data.map(function(t){if(e.indexOf(t.pannelGroupId)>-1){var a={pannelGroupId:t.pannelGroupId,pannelGroupRemark:t.pannelGroupRemark,duplicateVersion:t.duplicateVersion,pannelType:t.pannelType};console.log("AlbumPannelInfo"),n.push(a)}}),this.$emit("input",n)}}},methods:{handleOpenContentAuthManager:function(e){this.$refs.contentCard.handleShowContentAuthManager({id:e.pannelGroupId,menuElId:"albumPannelInfo",type:"pannel"})},genDefaultFilter:function(){return{idPrefix:this.$consts.idPrefix,pannelType:3}},fetchData:function(){var e=this,t=this.parseFilter();this.dataList?this.$service.panelDataList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows}):this.$service.panelPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.pannelId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){console.log(this.dataList),this.dataList?(this.filter=Object.assign({},this.dataList.filter),console.log(this.filter)):this.filter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},getBusinessType:function(){var e=this;return this.$service.getDictType({type:"businessType"}).then(function(t){t.forEach(function(t){e.businessType[t.dictCnName]=t.dictId})})},handleToggleCollect:function(e){var t=this;e.collected?this.$service.collectCancel({type:"pannel",data:{resourceId:e.pannelGroupId}},"取消收藏成功").then(function(){t.$set(e,"collected",!1)}):this.$service.collect({type:"pannel",data:{resourceId:e.pannelGroupId}},"收藏成功").then(function(){t.$set(e,"collected",!0)})}},created:function(){var e=this,t=ll.a.map({pannelCategory:ll.a.o.enum(this.businessType).other("form",{placeholder:"业务分类",component:"Select"}),pannelId:ll.a.o.string.other("form",{placeholder:"ID",component:"Input"}),pannelName:ll.a.o.string.other("form",{placeholder:"版块名称",component:"Input"}),pannelTitle:ll.a.o.string.other("form",{placeholder:"版块标题",component:"Input"}),vDataListName:ll.a.o.string.other("form",{placeholder:"关联专辑名",component:"Input"}),tabName:ll.a.o.string.other("form",{placeholder:"引用状态",component:"Input"}),pannelResource:ll.a.o.enum(this.$consts.sourceEnums).other("form",{placeholder:"内容源",component:"Select"}),pannelStatus:ll.a.o.enum(this.$consts.statusEnums).other("form",{placeholder:"状态",component:"Select"}),type:ll.a.o.enum({"默认":-1,"置顶":1,"下沉":0}).other("form",{placeholder:"智能化推荐",component:"Select"})}).other("form",{cols:{item:6,label:0,wrapper:18},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});"10"!==this.$consts.idPrefix&&t.map({idPrefix:ll.a.o.enum({"酷开":"10","江苏广电":"11"}).other("form",{component:"Select",placeholder:"数据来源"})}),this.getBusinessType().then(function(){e.dataList?e.filterSchema=a.filterSchema:e.filterSchema=t});var a=this.dataList;a&&(this.filter=Object.assign({},a.filter),this.table=a.table),this.fetchData(),this.$service.getButtonGroupForPageList("albumPanel").then(function(t){e.canAdd=t.some(function(e){return"add"===e.runComm})})}},Pu=_u,xu=Object(Yo["a"])(Pu,Su,ku,!1,null,"6e8ad0ac",null),Fu=xu.exports,Du="pannelGroupId",Ru={components:{TabPage:Il["a"],PanelInfo:Tu["a"],AlbumPannelInfoList:Fu},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0}},methods:{handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e[Du],this.mode="edit",this.isShowList=!1},handleRead:function(e,t){this.id=e[Du],this.mode="read",this.version=t,this.isShowList=!1},handleCopy:function(e){this.id=e[Du],this.mode="copy",this.isShowList=!1},handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},handleDelete:function(e){var t=this;this.$service.panelRemove({id:e.map(function(e){return e.pannelGroupId}).join(",")},"删除成功").then(function(){t.$refs.list.fetchData()})},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},Lu=Ru,$u=(a("e736"),Object(Yo["a"])(Lu,Iu,Cu,!1,null,"318620ee",null)),Nu=$u.exports,Eu=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"markPanel"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},Ou=[],Au={extends:Sl["a"],components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"],ButtonGroupForListPage:kl["a"]},data:function(){var e=this;return{resourceType:"panelInfo",businessTypes:{},filter:this.genDefaultFilter(),filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"pannelGroupId",width:"90"},{label:"名称",prop:"pannelGroupRemark",minWidth:"100","show-overflow-tooltip":!0,render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(n)}}},n.pannelGroupRemark)}},{label:"业务分类",prop:"categoryName",width:"90"},{label:"内容源",prop:"pannelList",width:"90",render:function(t,a){var n=a.row,i=n.pannelList;if(i.length>0)return e.$consts.sourceText[i[0].pannelResource]}},{label:"引用状态",prop:"fullTabName","min-width":"90"},{label:"版本/状态",prop:"pannelStatus",width:"120",render:function(t,a){var n=a.row;return n.currentVersion+"/"+e.$consts.statusText[n.pannelStatus]}},{label:"待审核副本",prop:"duplicateVersion",width:"90",render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(n,n.duplicateVersion)}}},n.duplicateVersion)}},{label:"更新时间",prop:"lastUpdateDate",width:"140"}],data:[],selected:[],selectionType:"multiple"}}},methods:{genDefaultFilter:function(){return{idPrefix:this.$consts.idPrefix,pannelType:8}},fetchData:function(){var e=this,t=this.parseFilter();this.$service.getMarkPanelList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},getBusinessType:function(){var e=this;return this.$service.getDictType({type:"businessType"}).then(function(t){t.forEach(function(t){e.businessTypes[t.dictCnName]=t.dictId}),console.log(e.businessTypes)})},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.pannelId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()}},created:function(){var e=this,t=ll.a.map({pannelId:ll.a.o.string.other("form",{component:"Input",placeholder:"ID"}),pannelName:ll.a.o.string.other("form",{component:"Input",placeholder:"名称"}),pannelCategory:ll.a.o.enum(this.businessTypes).other("form",{component:"Select",placeholder:"业务分类"}),pannelResource:ll.a.o.enum(this.$consts.sourceEnums).other("form",{component:"Select",placeholder:"内容源"}),tabName:ll.a.o.string.other("form",{component:"Input",placeholder:"引用状态"}),pannelStatus:ll.a.o.enum(this.$consts.statusEnums).other("form",{component:"Select",placeholder:"状态"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});"10"!==this.$consts.idPrefix&&t.map({idPrefix:ll.a.o.enum({"酷开":"10","江苏广电":"11"}).other("form",{component:"Select",placeholder:"数据来源"})}),this.fetchData(),this.getBusinessType().then(function(){e.filterSchema=t})}},Vu=Au,Bu=(a("5a57"),Object(Yo["a"])(Vu,Eu,Ou,!1,null,"55d85b14",null)),Mu=Bu.exports,Uu=a("6857"),Gu={extends:xc["a"],components:{ResourceList:Mu,ResourceContent:Uu["a"]},data:function(){return{}},computed:{resourceInfo:function(){return{type:"markPanel",idField:"pannelGroupId"}}}},ju=Gu,zu=Object(Yo["a"])(ju,ic,rc,!1,null,null,null),Wu=zu.exports,qu=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("TabPage",[a("PanelInfoList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,read:e.handleRead,edit:e.handleEdit,copy:e.handleCopy,delete:e.handleDelete}}),e.isShowList?e._e():a("PanelInfo",{attrs:{id:e.id,"panel-data-type":1,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},Ju=[],Hu=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{ref:"contentCard",staticClass:"content"},[a("ContentWrapper",{attrs:{pagination:e.pagination},on:{"filter-change":e.fetchData}},[a("el-form",{directives:[{name:"form-autocomplete",rawName:"v-form-autocomplete"}],staticClass:"form el-row",attrs:{model:e.filter,inline:!0,"label-width":"0px"},nativeOn:{submit:function(t){return e.handleFilterChange(t)},reset:function(t){return e.handleFilterReset(t)}}},[a("el-form-item",{staticClass:"el-col-6",attrs:{label:""}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"业务分类"},model:{value:e.filter.pannelCategory,callback:function(t){e.$set(e.filter,"pannelCategory",t)},expression:"filter.pannelCategory"}},e._l(e.businessTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{staticClass:"el-col-6",attrs:{label:""}},[a("InputPositiveInt",{attrs:{placeholder:"ID",clearable:"",name:"pannelId",autocomplete:"on"},model:{value:e.filter.pannelId,callback:function(t){e.$set(e.filter,"pannelId",t)},expression:"filter.pannelId"}})],1),a("el-form-item",{staticClass:"el-col-6",attrs:{label:""}},[a("el-input",{attrs:{placeholder:"版块名称",clearable:"",name:"pannelName",autocomplete:"on"},model:{value:e.filter.pannelName,callback:function(t){e.$set(e.filter,"pannelName",t)},expression:"filter.pannelName"}})],1),a("el-form-item",{staticClass:"el-col-6",attrs:{label:""}},[a("el-input",{attrs:{placeholder:"版块标题",clearable:"",name:"pannelTitle",autocomplete:"on"},model:{value:e.filter.pannelTitle,callback:function(t){e.$set(e.filter,"pannelTitle",t)},expression:"filter.pannelTitle"}})],1),a("el-form-item",{staticClass:"el-col-6",attrs:{label:""}},[a("el-input",{attrs:{placeholder:"引用状态",clearable:"",name:"tabName",autocomplete:"on"},model:{value:e.filter.tabName,callback:function(t){e.$set(e.filter,"tabName",t)},expression:"filter.tabName"}})],1),a("el-form-item",{staticClass:"el-col-6",attrs:{label:""}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"内容源"},model:{value:e.filter.pannelResource,callback:function(t){e.$set(e.filter,"pannelResource",t)},expression:"filter.pannelResource"}},e._l(e.$consts.sourceOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{staticClass:"el-col-6",attrs:{label:""}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"状态"},model:{value:e.filter.pannelStatus,callback:function(t){e.$set(e.filter,"pannelStatus",t)},expression:"filter.pannelStatus"}},e._l(e.$consts.statusOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{staticClass:"el-col-6",attrs:{label:""}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"版块类别"},model:{value:e.filter.pannelType,callback:function(t){e.$set(e.filter,"pannelType",t)},expression:"filter.pannelType"}},e._l(e.panelTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{staticClass:"el-col-6",attrs:{label:""}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"版块内容来源"},model:{value:e.filter.fillType,callback:function(t){e.$set(e.filter,"fillType",t)},expression:"filter.fillType"}},e._l(e.fillTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),"10"!==e.$consts.idPrefix?a("el-form-item",{staticClass:"el-col-6",attrs:{label:""}},[a("el-select",{attrs:{filterable:"",placeholder:"数据来源"},model:{value:e.filter.idPrefix,callback:function(t){e.$set(e.filter,"idPrefix",t)},expression:"filter.idPrefix"}},e._l(e.$consts.idPrefixOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1):e._e(),a("el-form-item",{staticClass:"el-col-6"},[a("el-button",{attrs:{type:"primary","native-type":"submit"}},[e._v("查询")]),a("el-button",{attrs:{"native-type":"reset"}},[e._v("重置")])],1)],1),a("ButtonGroupForListPage",{attrs:{pageName:"panel"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},Ku=[],Yu=a("4275"),Qu={extends:Sl["a"],components:{ContentWrapper:Bo["ContentWrapper"],Table:Bo["Table"],ButtonGroupForListPage:kl["a"],InputPositiveInt:vs["a"]},props:{dataList:{type:Object}},data:function(){var e=this;return{canAdd:!1,resourceType:"panelInfo",filter:this.genDefaultFilter(),efficientFilter:this.genDefaultFilter(),filterSchema:null,pagination:{currentPage:1},businessTypeOptions:[],panelTypeOptions:[{label:"影视推荐版块",value:6},{label:"定向版块",value:7},{label:"常规版块",value:1}],table:{props:{},data:[],header:[{label:"ID",prop:"pannelGroupId"},{label:"名称",minWidth:"180","show-overflow-tooltip":!0,render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(n)}}},n.pannelGroupRemark)}},{label:"布局",width:"150",prop:"fullLayoutName"},{label:"业务分类",prop:"categoryName"},{label:"内容源",prop:"pannelResource",formatter:function(t){return e.$consts.sourceText[t.pannelList[0].pannelResource]}},{label:"引用状态",prop:"fullTabName","show-overflow-tooltip":!0},{label:"版本/状态",prop:"pannelStatus",width:"130",formatter:function(t){var a=t.pannelStatus,n=t.currentVersion;return n+"/"+e.$consts.statusText[a]}},{label:"版块内容来源",formatter:function(t){return e.$consts.panelFillTypeText[t.pannelList[0].fillType]}},{label:"待审核副本",width:"100",render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(n,n.duplicateVersion)}}},n.duplicateVersion)}},{label:"更新时间",prop:"lastUpdateDate",width:"140","show-overflow-tooltip":!0},{label:"审核人",prop:"auditor",width:"100"},{label:"更新人",width:"100",prop:"userName"},{label:"操作",fixed:"right",width:180,render:function(t,a){var n=a.row;return t("div",[e.canAdd&&t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleCopy(n)}}},"复制"),t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleToggleCollect(n)}}},[t("el-icon",{class:n.collected?"el-icon-star-on":"el-icon-star-off"}),n.collected?"取消":"收藏"]),!!n.showContentAuthSettingBtn&&t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleOpenContentAuthManager(n)}}},"内容权限")])}}],selected:[],selectionType:"multiple"},selected:[],fillTypeOptions:[]}},watch:{selected:{handler:function(e,t){var a=this.table,n=[];a.data.map(function(t){if(e.indexOf(t.pannelGroupId)>-1){var a={pannelGroupId:t.pannelGroupId,pannelGroupRemark:t.pannelGroupRemark,duplicateVersion:t.duplicateVersion};n.push(a)}}),this.$emit("input",n)}}},methods:{checkAction:function(e,t,a){var n=Array.isArray(e)?e:[e],i=n.find(Yu["a"]);if(["edit","delete","copy"].includes(t)&&i)return this.$message.error("版块 ".concat(i.pannelGroupRemark," 为保留版块，不能进行当前操作"));a()},handleOpenContentAuthManager:function(e){this.$refs.contentCard.handleShowContentAuthManager({id:e.pannelGroupId,menuElId:"pannelInfo",type:"pannel"})},genDefaultFilter:function(){return{idPrefix:this.$consts.idPrefix}},fetchData:function(){var e=this,t=this.parseFilter();this.dataList?this.$service.panelDataList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows}):this.$service.panelPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.pagination,t=JSON.parse(JSON.stringify(this.efficientFilter));return e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleFilterReset:function(){this.filter=this.genDefaultFilter(),this.efficientFilter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},getBusinessType:function(){var e=this;return this.$service.getDictType({type:"businessType"}).then(function(t){e.businessTypeOptions=t.map(function(e){return{label:e.dictCnName,value:e.dictId}})})},getFillType:function(){var e=this;return this.$service.getMediaFillType().then(function(t){e.fillTypeOptions=t.map(function(e){return{label:e.dictCnName,value:e.dictEnName}})})},handleToggleCollect:function(e){var t=this;e.collected?this.$service.collectCancel({type:"pannel",data:{resourceId:e.pannelGroupId}},"取消收藏成功").then(function(){t.$set(e,"collected",!1)}):this.$service.collect({type:"pannel",data:{resourceId:e.pannelGroupId}},"收藏成功").then(function(){t.$set(e,"collected",!0)})}},created:function(){var e=this;this.getBusinessType(),this.getFillType(),this.fetchData(),this.$service.getButtonGroupForPageList("panel").then(function(t){e.canAdd=t.some(function(e){return"add"===e.runComm})})}},Xu=Qu,Zu=(a("90f9"),Object(Yo["a"])(Xu,Hu,Ku,!1,null,"50c0f2a6",null)),ed=Zu.exports,td="pannelGroupId",ad={components:{TabPage:Il["a"],PanelInfo:Tu["a"],PanelInfoList:ed},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0}},methods:{handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e[td],this.mode="edit",this.isShowList=!1},handleRead:function(e,t){this.id=e[td],this.mode="read",this.version=t,this.isShowList=!1},handleCopy:function(e){this.id=e[td],this.mode="copy",this.isShowList=!1},handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},handleDelete:function(e){var t=this;this.$service.panelRemove({id:e.map(function(e){return e.pannelGroupId}).join(",")},"删除成功").then(function(){t.$refs.list.fetchData()})},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},nd=ad,id=(a("657a"),Object(Yo["a"])(nd,qu,Ju,!1,null,"e421895e",null)),rd=id.exports,od=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("TabPage",[a("RuleCreatePanel",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,read:e.handleRead,edit:e.handleEdit,copy:e.handleCopy,delete:e.handleDelete}}),e.isShowList?e._e():a("PanelInfo",{attrs:{id:e.id,"panel-data-type":1,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},ld=[],sd=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ab-list-layout",{attrs:{pagination:e.pagination},on:{"pagingation-change":e.fetchData}},[a("div",{attrs:{slot:"filter"},slot:"filter"},[a("DataForm",{directives:[{name:"form-autocomplete",rawName:"v-form-autocomplete"}],attrs:{model:e.filter,inline:!0},nativeOn:{submit:function(t){return e.handleFilterChange(t)},reset:function(t){return e.handleResetFilter(t)}}},[a("FormEnum",{attrs:{filterable:"",placeholder:"是否有教育业务",options:e.zeroOneOptions,clearable:""},model:{value:e.filter.hasEdu,callback:function(t){e.$set(e.filter,"hasEdu",t)},expression:"filter.hasEdu"}}),a("FormEnum",{attrs:{filterable:"",placeholder:"是否运营插入",options:e.zeroOneOptions,clearable:""},model:{value:e.filter.hasIntervene,callback:function(t){e.$set(e.filter,"hasIntervene",t)},expression:"filter.hasIntervene"}}),a("FormEnum",{attrs:{filterable:"",placeholder:"版块状态",options:e.$consts.statusOptions,clearable:""},model:{value:e.filter.pannelStatus,callback:function(t){e.$set(e.filter,"pannelStatus",t)},expression:"filter.pannelStatus"}}),a("FormString",{attrs:{clearable:"",placeholder:"版块名称"},model:{value:e.filter.pannelName,callback:function(t){e.$set(e.filter,"pannelName",t)},expression:"filter.pannelName"}}),a("FormString",{attrs:{clearable:"",placeholder:"版块ID"},model:{value:e.filter.pannelId,callback:function(t){e.$set(e.filter,"pannelId",t)},expression:"filter.pannelId"}}),a("FormEnum",{attrs:{filterable:"",placeholder:"版块内容源",options:e.$consts.sourceOptions,clearable:""},model:{value:e.filter.pannelResource,callback:function(t){e.$set(e.filter,"pannelResource",t)},expression:"filter.pannelResource"}}),a("br"),a("FormEnum",{attrs:{type:"radio",label:"影片数量",options:e.filmNumOptions},model:{value:e.filter.filmNumSelect,callback:function(t){e.$set(e.filter,"filmNumSelect",t)},expression:"filter.filmNumSelect"}}),a("div",[a("el-form-item",[a("el-button",{attrs:{type:"primary","native-type":"submit"}},[e._v("查询")]),a("el-button",{attrs:{"native-type":"reset"}},[e._v("重置")])],1)],1)],1)],1),a("Table",{attrs:{slot:"table",props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange},slot:"table"})],1)],1)},cd=[],ud=[{label:"未定义",value:void 0},{label:"10部及以下",value:1},{label:"11~30",value:2},{label:"31~100",value:3},{label:"100以上",value:4}],dd=[{label:"否",value:0},{label:"是",value:1}],pd={extends:W["a"].ResourceBaseList,components:{Table:Bo["Table"],DataForm:Bo["DataForm"],FormEnum:Bo["Enum"],FormString:Bo["String"]},props:{idField:{default:"pannelGroupId"}},data:function(){var e=this;return{resourceType:"ruleCreatePanel",filter:this.getDefaultFilter(),efficientFilter:this.getDefaultFilter(),pagination:{currentPage:1},selected:[],table:{props:{},selected:[],selectionType:"multiple",header:[{prop:"pannelGroupId",label:"版块ID"},{label:"版块名称","show-overflow-tooltip":!0,render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(n)}}},n.pannelGroupRemark)}},{prop:"pannelStatus",label:"版块状态",formatter:function(t){var a=t.pannelStatus,n=t.currentVersion;return n+"/"+e.$consts.statusText[a]}},{label:"是否运营插入",formatter:function(e){var t=e.pannelList[0]?e.pannelList[0].hasIntervene:void 0;return["否","是"][t]}},{label:"筛选规则",render:function(e,t){var a=t.row,n=a.pannelList[0]?a.pannelList[0].mediaRuleDesc:void 0;return e("div",{style:{"white-space":"pre-line"}},n)}},{label:"筛选影片数量",formatter:function(e){var t=e.pannelList[0]?e.pannelList[0].mediaFilmNum:void 0;return t}}],data:[]},filmNumOptions:ud,zeroOneOptions:dd,fillTypeOptions:[]}},methods:{fetchData:function(){var e=this,t=this.getFilter(),a=this.parseFilmNum(t.filmNumSelect),n=a.mediaFilmNumStart,i=a.mediaFilmNumEnd;delete t.filmNumSelect,t.mediaFilmNumStart=n,t.mediaFilmNumEnd=i,this.$service.panelPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},handleFilterChange:function(){this.efficientFilter=Object(Go["cloneDeep"])(this.filter),this.pagination.currentPage=1,this.fetchData()},handleResetFilter:function(){this.filter=this.getDefaultFilter(),this.efficientFilter=this.getDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},getFilter:function(){var e=this.pagination,t=Object(Go["cloneDeep"])(this.efficientFilter);return e&&(t.page=e.currentPage,t.rows=e.pageSize),t},parseFilmNum:function(e){var t,a;switch(e){case 1:a=10;break;case 2:t=11,a=30;break;case 3:t=31,a=100;break;case 4:t=100;break;default:break}return{mediaFilmNumStart:t,mediaFilmNumEnd:a}},getDefaultFilter:function(){return{idPrefix:this.$consts.idPrefix,fillType:3,hasEdu:void 0,hasIntervene:void 0,pannelStatus:void 0,pannelName:void 0,pannelId:void 0,pannelResource:void 0,filmNumSelect:void 0}}},created:function(){this.fetchData()}},hd=pd,md=Object(Yo["a"])(hd,sd,cd,!1,null,"3d350930",null),fd=md.exports,vd="pannelGroupId",gd={components:{TabPage:Il["a"],PanelInfo:Tu["a"],RuleCreatePanel:fd},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0}},methods:{handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e[vd],this.mode="edit",this.isShowList=!1},handleRead:function(e,t){this.id=e[vd],this.mode="read",this.version=t,this.isShowList=!1},handleCopy:function(e){this.id=e[vd],this.mode="copy",this.isShowList=!1},handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},handleDelete:function(e){var t=this;this.$service.panelRemove({id:e.map(function(e){return e.pannelGroupId}).join(",")},"删除成功").then(function(){t.$refs.list.fetchData()})},goBack:function(){this.isShowList=!0,this.$refs.list.fetchData(),this.mode="list",this.version=void 0}}},bd=gd,yd=(a("5bc4"),Object(Yo["a"])(bd,od,ld,!1,null,"1ae8c078",null)),wd=yd.exports,Id=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("PrivatePannelInfoList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,read:e.handleRead,edit:e.handleEdit,copy:e.handleCopy,delete:e.handleDelete}}),e.isShowList?e._e():a("PrivatePannelInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},Cd=[],Td=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[void 0===e.dataList?a("ButtonGroupForListPage",{attrs:{pageName:"privatePanel"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}):e._e(),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},Sd=[],kd={extends:Sl["a"],components:{ContentWrapper:Bo["ContentWrapper"],Table:Bo["Table"],ButtonGroupForListPage:kl["a"]},props:{dataList:{type:Object}},data:function(){var e=this;return{resourceType:"panelInfo",pannelCategories:{},pannelStatus:{},filter:{sort:void 0,order:void 0,pannelType:5},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"pannelGroupId",width:"90"},{label:"名称",prop:"pannelGroupRemark",minWidth:180,"show-overflow-tooltip":!0,render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(n)}}},n.pannelGroupRemark)}},{label:"业务分类",prop:"categoryName",width:"70"},{label:"引用状态",prop:"fullTabName",width:300,"show-overflow-tooltip":!0},{label:"版本/状态",prop:"pannelStatus",formatter:function(t){var a=t.pannelStatus,n=t.currentVersion;return"".concat(n,"/").concat(e.$consts.statusText[a])}},{label:"待审核副本",prop:"duplicateVersion",width:"90",render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(n,n.duplicateVersion)}}},n.duplicateVersion)}},{label:"更新时间",width:140,prop:"lastUpdateDate"},{label:"审核人",prop:"auditor"},{label:"更新人",prop:"userName"}],data:[],selected:[],selectionType:"multiple"}}},watch:{selected:{handler:function(e,t){var a=this.table,n=[];a.data.map(function(t){if(e.indexOf(t.pannelGroupId)>-1){var a={pannelGroupId:t.pannelGroupId,pannelGroupRemark:t.pannelGroupRemark,duplicateVersion:t.duplicateVersion,pannelType:t.pannelType};console.log("PrivatePannelInfo"),n.push(a)}}),this.$emit("input",n)}}},methods:{fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.dataList,this.$service.panelPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.pannelId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.dataList?this.filter=Object.assign({},this.dataList.filter):this.filter={sort:void 0,order:void 0,pannelType:5},this.pagination.currentPage=1,this.fetchData()},getDictType:function(){var e=this;return this.$service.getDictType({type:"businessType"}).then(function(t){t.forEach(function(t){e.pannelCategories[t.dictCnName]=t.dictId})})}},created:function(){var e=this,t=ll.a.map({pannelId:ll.a.o.string.other("form",{component:"Input",placeholder:"ID"}),pannelName:ll.a.o.string.other("form",{component:"Input",placeholder:"名称"}),pannelTitle:ll.a.o.string.other("form",{component:"Input",placeholder:"标题"}),pannelResource:ll.a.o.enum(this.$consts.sourceEnums).other("form",{component:"Select",placeholder:"内容源"}),pannelCategory:ll.a.o.enum(this.pannelCategories).other("form",{component:"Select",placeholder:"业务分类"}),tabName:ll.a.o.string.other("form",{component:"Input",placeholder:"引用状态"}),pannelStatus:ll.a.o.enum(this.$consts.statusEnums).other("form",{component:"Select",placeholder:"状态"})}).other("form",{cols:{item:6,label:0,wrapper:18},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}}),a=this.dataList;a&&(this.filter=Object.assign({},a.filter),this.table=a.table),this.getDictType().then(function(){e.dataList?e.filterSchema=a.filterSchema:e.filterSchema=t}),this.fetchData()}},_d=kd,Pd=Object(Yo["a"])(_d,Td,Sd,!1,null,"73098aee",null),xd=Pd.exports,Fd=a("99ad"),Dd={components:{PrivatePannelInfoList:xd,PrivatePannelInfo:Fd["a"]},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0}},methods:{handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e.pannelGroupId,this.mode="edit",this.isShowList=!1},handleRead:function(e,t){this.id=e.pannelGroupId,this.mode="read",this.version=t,this.isShowList=!1},handleCopy:function(e){this.id=e.pannelGroupId,this.mode="copy",this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.privatePanelRemove({id:e.map(function(e){return e.pannelGroupId}).join(",")},"删除成功").then(function(e){t.$refs.list.fetchData()})},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},Rd=Dd,Ld=Object(Yo["a"])(Rd,Id,Cd,!1,null,"db574d84",null),$d=Ld.exports,Nd=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("CommonOnclickInfoList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}),e.isShowList?e._e():a("CommonOnclickInfo",{attrs:{editId:e.id},on:{openListPage:e.handleUpsertEnd,"go-back":e.goBack}})],1)},Ed=[],Od=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitBtn}},[e._v("保存")]),a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{model:e.form,rules:e.formRules,"label-width":"160px"}},[a("el-form-item",{attrs:{label:"点击事件名称",prop:"onlickName"}},[a("el-input",{attrs:{placeholder:"点击事件名称"},model:{value:e.form.onlickName,callback:function(t){e.$set(e.form,"onlickName",t)},expression:"form.onlickName"}})],1),a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{attrs:{placeholder:"备注"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),a("AppParams",{attrs:{"prop-prefix":"onclick."},model:{value:e.form.onclick,callback:function(t){e.$set(e.form,"onclick",t)},expression:"form.onclick"}}),a("el-form-item",{attrs:{label:"异常处理(exception)",prop:"exception"}},[a("el-input",{attrs:{type:"textarea",placeholder:"异常处理(exception)"},model:{value:e.form.exception,callback:function(t){e.$set(e.form,"exception",t)},expression:"form.exception"}})],1)],1)],1)},Ad=[],Vd={components:{AppParams:Bo["AppParams"]},props:{editId:Number,default:null},data:function(){return{title:null,form:{onlickName:null,remark:null,onlickJson:null,onclick:{packagename:null,versioncode:"-1",dowhat:"startActivity",bywhat:"action",byvalue:null,params:[]},exception:null},formRules:{onlickName:[{required:!0,message:"请输入点击事件名称",trigger:"blur"}],packagename:[{required:!0,message:"请输入应用包名",trigger:"blur"}],byvalue:[{required:!0,message:"请输入启动参数",trigger:"blur"}]},paramsList:[{key:"",value:""}]}},methods:{paramsAddBtn:function(){this.paramsList.push({key:"",value:""})},paramsRedBtn:function(e){this.paramsList.splice(e,1)},submitBtn:function(){var e=this;this.$refs.form.validate(function(t){if(t){var a={};e.form.onclick.params.forEach(function(e){a[e.key]=e.value}),e.form.onclick.params=a,e.form=Object.assign({},e.form,e.form.onclick),e.form.onlickJson=JSON.stringify(e.form.onclick),delete e.form.onclick,e.$service.commonOnclickInfoSave({jsonStr:JSON.stringify(e.form)},"保存成功").then(function(t){e.$emit("openListPage")})}})},getEditData:function(){var e=this;this.$service.getCommonOnclickInfoEdit({id:this.editId}).then(function(t){var a=JSON.parse(t.params||"{}");t.params=Object.keys(a).map(function(e){return{key:e,value:a[e]}}),t.onclick={packagename:t.packagename,versioncode:t.versioncode,dowhat:t.dowhat,bywhat:t.bywhat,byvalue:t.byvalue,params:t.params},delete t.packagename,delete t.versioncode,delete t.dowhat,delete t.bywhat,delete t.byvalue,delete t.params,e.form=Object.assign({},e.form,t)})}},created:function(){null!==this.editId&&void 0!==this.editId?(this.title="编辑",this.getEditData()):this.title="新增"}},Bd=Vd,Md=(a("394f"),Object(Yo["a"])(Bd,Od,Ad,!1,null,"bc94b658",null)),Ud=Md.exports,Gd=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"onclickInfo"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},jd=[],zd={extends:Sl["a"],components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"],ButtonGroupForListPage:kl["a"]},data:function(){return{resourceType:"clickEvent",resourceName:"点击事件",filter:{},filterSchema:null,pagination:{},setDialogVisible:!1,selected:[],table:{props:{},header:[{label:"ID",prop:"commonOnclickId"},{label:"点击事件名称",prop:"onlickName"},{label:"备注",prop:"remark"},{label:"应用包名",prop:"packagename"},{label:"应用版本号",prop:"versioncode"},{label:"启动动作",prop:"dowhat"},{label:"启动方式",prop:"bywhat"},{label:"启动参数",prop:"byvalue"},{label:"扩展参数",prop:"params"},{label:"异常处理",prop:"exception"},{label:"创建人",prop:"modifierName"},{label:"创建时间",prop:"createdDate"},{label:"修改人",fixed:"modifierName"},{label:"修改时间",fixed:"lastUpdateDate"}],data:[],selected:[],selectionType:"multiple"}}},methods:{handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.commonOnclickId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();this.$service.getCommonOnclickInfoList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=ll.a.map({commonOnclickId:ll.a.o.string.other("form",{component:"Input",placeholder:"ID"}),onlickName:ll.a.o.string.other("form",{component:"Input",placeholder:"点击事件名"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},Wd=zd,qd=(a("c49f"),Object(Yo["a"])(Wd,Gd,jd,!1,null,"77e27bee",null)),Jd=qd.exports,Hd={components:{CommonOnclickInfo:Ud,CommonOnclickInfoList:Jd},data:function(){return{isShowList:!0,mode:"list",id:null}},methods:{handleCreate:function(){this.mode="create",this.id=void 0,this.isShowList=!1},handleEdit:function(e){this.id=e.commonOnclickId,this.mode="edit",this.isShowList=!1},handleRead:function(e){this.id=e.commonOnclickId,this.mode="read",this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.commonOnclickInfoDelete({id:e.map(function(e){return e.commonOnclickId}).join(",")},"删除成功").then(function(e){t.$refs.list.fetchData()})},handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},Kd=Hd,Yd=Object(Yo["a"])(Kd,Nd,Ed,!1,null,null,null),Qd=Yd.exports,Xd=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("GlobalCornerIconList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,edit:e.handleEdit,read:e.handleRead,delete:e.handleDelete}}),e.isShowList?e._e():a("GlobalCornerIcon",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},Zd=[],ep=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("div",{staticClass:"control-button-group"},[a("ButtonGroupForListPage",{staticClass:"auth-button-group",attrs:{pageName:"cornerIcon"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete,"batch-audit":e.batchAudit}}),a("GlobalIconBatchAudit",{on:{"audit-end":e.fetchData}}),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleAllRowSelectionChange(e.checkAll=!e.checkAll)}}},[e._v("全选/全不选")])],1),a("CardList",{staticClass:"img-list",attrs:{data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove},scopedSlots:e._u([{key:"row",fn:function(t){var n=t.row;return a("div",{staticClass:"img-item",on:{click:function(t){return t.stopPropagation(),e.handleRead(n)}}},[a("img",{key:n.imgUrl,attrs:{referrerpolicy:"no-referrer",src:n.imgUrl}}),a("a",{staticClass:"img-preview",on:{click:function(t){return t.stopPropagation(),e.reviewPic(n)}}},[e._v("预览")]),a("div",{staticClass:"img-detail"},[a("span",[e._v("角标id："+e._s(n.cornerIconId))]),a("span",[e._v("角标标题："+e._s(n.cornerIconName)+" ")]),a("span",[e._v("角标分类："+e._s(n.cornerIconType.typeName))]),a("span",[e._v("角标类别："+e._s(n.attributeCode)+" ")]),a("span",[e._v("角标位置："+e._s(e.typePositionText[n.cornerIconType.typePosition]))])]),a("div",{staticClass:"img-info"},[a("span",{staticClass:"img-title"},[e._v(e._s(n.cornerIconName))]),a("span",{staticClass:"img-status"},[e._v(e._s(e.$consts.statusText[n.cornerStatus]))])])])}}])})],1),a("el-dialog",{attrs:{title:"预览图片",visible:e.picDialogVisible,width:"30%"},on:{"update:visible":function(t){e.picDialogVisible=t}}},[a("span",{staticClass:"pics"},[a("img",{staticStyle:{width:"400px"},attrs:{referrerpolicy:"no-referrer",src:e.reviewPicUrl,alt:"图片"}})])]),a("el-dialog",{attrs:{title:"审核",visible:e.auditDialogVisible,"before-close":e.handleDialogClose},on:{"update:visible":function(t){e.auditDialogVisible=t}}},[a("GlobalIconAudit",{ref:"auditForm",on:{auditForm:e.handleDoBatchAudit,cancle:e.cancle}})],1),a("el-dialog",{attrs:{title:"调整优先级",visible:e.dialogLevelVisible},on:{"update:visible":function(t){e.dialogLevelVisible=t}}},[a("GlobelIconLevel"),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogLevelVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogLevelVisible=!1}}},[e._v("确 定")])],1)],1)],1)},tp=[],ap=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"auditForm",staticClass:"demo-ruleForm",attrs:{model:e.auditForm,"status-icon":"",rules:e.auditFormRule,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"审核意见",prop:"auditFlag"}},[a("el-radio",{attrs:{label:"4"},model:{value:e.auditForm.auditFlag,callback:function(t){e.$set(e.auditForm,"auditFlag",t)},expression:"auditForm.auditFlag"}},[e._v("通过")]),a("el-radio",{attrs:{label:"5"},model:{value:e.auditForm.auditFlag,callback:function(t){e.$set(e.auditForm,"auditFlag",t)},expression:"auditForm.auditFlag"}},[e._v("打回")])],1),a("el-form-item",{attrs:{label:"意见说明",prop:"auditDesc"}},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入意见说明"},model:{value:e.auditForm.auditDesc,callback:function(t){e.$set(e.auditForm,"auditDesc",t)},expression:"auditForm.auditDesc"}})],1),a("el-form-item",[a("el-button",{on:{click:function(t){return e.cancle("auditForm")}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("auditForm")}}},[e._v("确定")])],1)],1)],1)},np=[],ip={data:function(){return{auditForm:{auditFlag:"4",auditDesc:""},auditFormRule:{auditDesc:[{required:!0,message:"请输入审核意见",trigger:"blur"}]}}},methods:{onSubmit:function(e){var t=this;this.$refs.auditForm.validate(function(e){if(e){var a=t.auditForm;t.$emit("auditForm",a)}})},cancle:function(e){this.$refs.auditForm.resetFields();var t=!1;this.$emit("cancle",t)}},created:function(){}},rp=ip,op=Object(Yo["a"])(rp,ap,np,!1,null,null,null),lp=op.exports,sp=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("el-table",{staticStyle:{"margin-top":"20px","max-width":"80%"},attrs:{data:e.tab.pannelList,border:""}},[a("el-table-column",{attrs:{prop:"cornerIconId",label:"版块ID"}}),a("el-table-column",{attrs:{prop:"cornerIconName",label:"版块名称"}}),a("el-table-column",{attrs:{label:"图片",prop:""},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{attrs:{src:e.row.imgUrl,width:"70px"}})]}}])}),a("el-table-column",{attrs:{prop:"",label:"优先级",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("OrderInput",{key:Math.random().toString(),attrs:{value:t.$index+1},on:{input:function(a){return e.handleChangePannelOrderStart(t.$index,a)},blur:function(a){return e.handleChangePannelOrderEnd(t.$index)}}})]}}])})],1)],1)],1)},cp=[],up=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-input",{on:{blur:function(t){return e.$emit("blur")}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}})},dp=[],pp=void 0,hp={data:function(){return{inputValue:void 0}},props:["value"],watch:{inputValue:"handleInputValue",value:function(e){pp.inputValue=e}},methods:{handleInputValue:function(e){this.$emit("input",e)}},created:function(){this.inputValue=this.value}},mp=hp,fp=Object(Yo["a"])(mp,up,dp,!1,null,null,null),vp=fp.exports,gp={components:{OrderInput:vp,ContentWrapper:Bo["ContentWrapper"]},data:function(){return{tab:{cornerIconId:void 0,cornerIconName:void 0,imgUrl:void 0,pannelList:[]},globalTypes:{test1:"1010",test2:"1011","付费属性":"101","排行榜":"103","教育角标":"105","策划类":"104","素材播出属性":"102"},attributeTypes:{},dialogPLVisible:!1,dialogLevelVisible:!1,typePositions:{"左上":0,"右上":1,"左下":3,"右下":2},reviewPicUrl:null,filter:{sort:void 0,order:void 0},filterSchema:null,pagination:{},selected:[]}},methods:{fetchData:function(){var e=this,t=this.parseFilter();this.$service.getGlobalMgrList(t).then(function(t){console.log(t),e.pagination.total=t.total,e.tab.pannelList=t.rows})},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.idPrefix="10",e.page=t.currentPage,e.rows=t.pageSize),e},handleChangePannelOrderStart:function(e,t){if(""!==t){t=parseInt(t);var a=this.tab.pannelList;isNaN(t)||t>a.length||t<=0?(this.currentPannelIndex=void 0,this.$message({type:"error",message:"序号必须大于0且不能大于总数量"}),this.tab.pannelList=a.slice()):(this.currentPannelIndex=e,this.currentPannelOrder=t)}},handleChangePannelOrderEnd:function(e){if(this.currentPannelIndex===e){var t=this.currentPannelOrder-1,a=e,n=this.tab.pannelList,i=n[a];n.splice(a,1),this.tab.pannelList=[].concat(n.slice(0,t),i,n.slice(t)),this.currentPannelIndex=void 0,this.currentPannelOrder=void 0}},handleFilterChange:function(e,t){t&&(this.filter=t),"query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData()},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},handleRowSelectionAdd:function(e){this.selected.push(e.cornerIconId),this.updateTableSelected()},handleRowSelectionRemove:function(e){this.selected=this.selected.filter(function(t){return t!==e.cornerIconId}),this.updateTableSelected()},handleAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleRowSelectionAdd):(this.selected=[],this.table.selected=[])},handleAllRowSelectionRemove:function(){this.selected=[],this.table.selected=[]},updateTableSelected:function(){var e=this.table,t=this.selected;e.selected=e.data.reduce(function(e,a,n){return t.indexOf(a.cornerIconId)>-1&&e.push(n),e},[])},getCornerTypes:function(){var e=this;return this.$service.getCornerTypes().then(function(t){t.forEach(function(t){e.globalTypes[t.typeName]=t.typeId}),console.log(e.globalTypes)})},getIconAttributes:function(){var e=this;return this.$service.getIconAttributes().then(function(t){t.attributes.forEach(function(t){e.attributeTypes[t.attributeName]=t.attributeCode}),console.log(e.attributeTypes)})}},created:function(){var e=this,t=ll.a.map({typeId:ll.a.o.enum(this.globalTypes).other("form",{component:"Select",placeholder:"角标分类",cols:{item:3,label:0}})}).other("form",{layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.fetchData(),this.getCornerTypes().then(function(){e.getIconAttributes().then(function(){e.filterSchema=t})})}},bp=gp,yp=(a("6871"),Object(Yo["a"])(bp,sp,cp,!1,null,"47ad7bfd",null)),wp=yp.exports,Ip=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("RemoteSelectorWrapper",{ref:"selectorWrapper",attrs:{title:"批量审核下面所有素材(一次最多审核50个)",pagination:e.pagination},on:{"select-start":e.handleSelectStart}},[a("el-button",{attrs:{type:"primary"}},[e._v("一键审核")]),a("div",{attrs:{slot:"filter"},slot:"filter"},[a("el-form",{ref:"auditForm",attrs:{inline:!0,model:e.auditForm,rules:e.auditFormRules,"label-width":"80px"},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.handleAudit(t))}}},[a("el-form-item",{attrs:{label:"审核意见",prop:"auditFlag"}},[a("el-radio",{attrs:{label:"4"},model:{value:e.auditForm.auditFlag,callback:function(t){e.$set(e.auditForm,"auditFlag",t)},expression:"auditForm.auditFlag"}},[e._v("通过")]),a("el-radio",{attrs:{label:"5"},model:{value:e.auditForm.auditFlag,callback:function(t){e.$set(e.auditForm,"auditFlag",t)},expression:"auditForm.auditFlag"}},[e._v("打回")])],1),a("el-form-item",{attrs:{label:"意见说明",prop:"auditDesc"}},[a("el-input",{ref:"auditDesc",staticStyle:{width:"400px"},attrs:{autofocus:""},model:{value:e.auditForm.auditDesc,callback:function(t){e.$set(e.auditForm,"auditDesc",t)},expression:"auditForm.auditDesc"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleAudit}},[e._v("确定")]),a("el-button",{on:{click:e.handleCancel}},[e._v("取消")])],1)],1)],1),a("CardList",{attrs:{slot:"item-list",data:e.table.data,selected:e.table.selected,"selection-type":"none"},slot:"item-list",scopedSlots:e._u([{key:"row",fn:function(t){var n=t.row;return a("div",{staticClass:"img-item"},[a("img",{key:n.imgUrl,attrs:{src:n.imgUrl}}),a("div",{staticClass:"img-detail"},[a("span",[e._v("角标id："+e._s(n.cornerIconId))]),a("span",[e._v("角标标题："+e._s(n.cornerIconName)+" ")]),a("span",[e._v("角标分类："+e._s(n.cornerIconType.typeName))]),a("span",[e._v("角标类别："+e._s(n.attributeCode)+" ")]),a("span",[e._v("角标位置："+e._s(e.typePositionText[n.cornerIconType.typePosition]))])]),a("div",{staticClass:"img-info"},[a("span",{staticClass:"img-title"},[e._v(e._s(n.cornerIconName))]),a("span",{staticClass:"img-status"},[e._v(e._s(e.$consts.statusText[n.cornerStatus]))])])])}}])}),a("div",{attrs:{slot:"footer"},slot:"footer"})],1)},Cp=[],Tp=a("5076"),Sp={components:{CardList:Bo["CardList"],RemoteSelectorWrapper:Tp["a"]},data:function(){return{table:{props:{},data:[],selected:void 0,selectionType:"single"},pagination:{currentPage:1,pageSize:50},filter:{cornerStatus:3},auditForm:{idStr:null,auditFlag:"4",auditDesc:""},auditFormRules:{auditDesc:[{required:!0,message:"请输入意见说明",trigger:"blur"}],auditFlag:[{required:!0,message:"请输入审核意见",trigger:"blur"}]},globalTypes:{test1:"1010",test2:"1011","付费属性":"101","排行榜":"103","教育角标":"105","策划类":"104","素材播出属性":"102"},typePositionText:["左上","右上","左下","右下"]}},methods:{handleSelectStart:function(){var e=this;this.fetchData(),this.$nextTick(function(){var t=e.$refs.auditForm,a=e.$refs.auditDesc;t&&(t.clearValidate(),a.focus())})},handleAudit:function(){var e=this;this.$refs.auditForm.validate(function(t){t&&(e.auditForm.idStr=e.table.data.map(function(e){var t=e.cornerIconId;return t}).join(","),e.$service.batchAudit(e.auditForm,"操作成功").then(function(t){e.$refs.selectorWrapper.handleSelectCancel(),e.$emit("audit-end")}))})},handleCancel:function(){this.$refs.selectorWrapper.handleSelectCancel()},getFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),Object(Q["a"])({},e)},fetchData:function(){var e=this,t=this.getFilter();this.$service.getGlobalMgrList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows,0===t.rows.length&&(e.$message.warning("没有待审核素材"),setTimeout(function(){e.handleCancel()},1e3))})}}},kp=Sp,_p=(a("1ffc"),Object(Yo["a"])(kp,Ip,Cp,!1,null,"e58c633a",null)),Pp=_p.exports,xp={extends:Sl["a"],components:{CardList:Bo["CardList"],ContentWrapper:Bo["ContentWrapper"],GlobalIconAudit:lp,GlobelIconLevel:wp,ButtonGroupForListPage:kl["a"],GlobalIconBatchAudit:Pp},data:function(){var e=this;return{resourceType:"cornerIcon",checkAll:!1,globalTypes:{test1:"1010",test2:"1011","付费属性":"101","排行榜":"103","教育角标":"105","策划类":"104","素材播出属性":"102"},attributeTypes:{},auditDialogVisible:!1,dialogLevelVisible:!1,typePositions:{"左上":0,"右上":1,"左下":3,"右下":2},typePositionText:["左上","右上","左下","右下"],picDialogVisible:!1,reviewPicUrl:null,filter:this.genDefaultFilter(),filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"cornerIconId"},{label:"角标名称",prop:"cornerIconName",render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(n)}}},n.cornerIconName)}},{label:"图片",prop:"imgUrl",render:function(t,a){var n=a.row;return t("img",{attrs:{src:n.imgUrl,width:"50px",height:"50px",class:"imgs"},on:{click:function(t){t.stopPropagation(),e.reviewPic(n)}}})}},{label:"审核状态",prop:"cornerStatus",render:function(t,a){var n=a.row;return e.$consts.statusText[n.cornerStatus]}}],data:[],selected:[],selectionType:"multiple"}}},methods:{genDefaultFilter:function(){return{idPrefix:this.$consts.idPrefix}},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.getGlobalMgrList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows,e.checkAll=!1})},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},batchAudit:function(){if(0===this.selected.length)return this.$message.error("请选择再审批");var e=this.$consts.status.waiting,t=this.selected.filter(function(t){return t.cornerStatus===e}).length;if(0===t)return this.$message.error("选中的素材里没有待审核素材");this.auditForm={idStr:null,auditFlag:"4",auditDesc:""},this.auditDialogVisible=!0},handleDoBatchAudit:function(e){var t=this,a=this.$consts.status.waiting;e.idStr=this.selected.filter(function(e){return e.cornerStatus===a}).map(function(e){var t=e.cornerIconId;return t}).join(","),this.$service.batchAudit(e,"审核成功").then(function(e){t.fetchData(),t.$refs.auditForm.cancle(),t.auditDialogVisible=!1})},cancle:function(e){this.auditDialogVisible=e},handleDialogClose:function(){this.$refs.auditForm.cancle()},changePriority:function(){this.dialogLevelVisible=!0},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.cornerIconId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},getCornerTypes:function(){var e=this;return this.$service.getCornerTypes().then(function(t){t.forEach(function(t){e.globalTypes[t.typeName]=t.typeId}),console.log(e.globalTypes)})},getIconAttributes:function(){var e=this;return this.$service.getIconAttributes().then(function(t){t.attributes.forEach(function(t){e.attributeTypes[t.attributeName]=t.attributeCode}),console.log(e.attributeTypes)})},reviewPic:function(e){this.reviewPicUrl=e.imgUrl,this.picDialogVisible=!0}},created:function(){var e=this,t=ll.a.map({cornerIconName:ll.a.o.string.other("form",{component:"Input",placeholder:"角标名称  "}),cornerIconId:ll.a.o.string.other("form",{component:"Input",placeholder:"ID"}),typeId:ll.a.o.enum(this.globalTypes).other("form",{component:"Select",placeholder:"角标分类"}),typePosition:ll.a.o.enum(this.typePositions).other("form",{component:"Select",placeholder:"角标位置"}),attributeCode:ll.a.o.enum(this.attributeTypes).other("form",{component:"Select",placeholder:"角标类别"}),cornerStatus:ll.a.o.enum(this.$consts.statusEnums).other("form",{component:"Select",placeholder:"审核状态"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});"10"!==this.$consts.idPrefix&&t.map({idPrefix:ll.a.o.enum({"酷开":"10","江苏广电":"11"}).other("form",{component:"Select",placeholder:"数据来源"})}),this.fetchData(),this.getCornerTypes().then(function(){e.getIconAttributes().then(function(){e.filterSchema=t})})}},Fp=xp,Dp=(a("f153"),Object(Yo["a"])(Fp,ep,tp,!1,null,"bc8e3b86",null)),Rp=Dp.exports,Lp=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"global-picture",attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("CommonContent",{attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{edit:function(t){e.mode="edit"},unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,audit:function(t){return e.$emit("upsert-end")},"select-version":e.fetchData,delete:function(t){return e.$emit("upsert-end",t)}}},[a("div",{attrs:{slot:"auditAndDraft"},slot:"auditAndDraft"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("提交审核")])],1),"read"!==e.mode?a("div",{staticClass:"layout-upsert"},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"form",attrs:{"label-width":"120px",model:this}},[a("div",{staticClass:"global-picture__label"},[e._v("角标图片")]),a("Upload",{ref:"upload",staticClass:"global-picture__uploader",attrs:{multiple:!0},on:{upload:e.handleUpload}},[a("template",{slot:"preview"},[e._l(e.fileInfo,function(t,n){return a("div",{key:n,staticClass:"upload-pic-list__item-wrapper"},[a("div",{staticClass:"upload-pic-list__item"},["error"===t.upload.status?a("div",{staticClass:"upload-pic-list__error"},[e._v("上传失败: "+e._s(t.upload.message))]):e._e(),"uploading"===t.upload.status?a("div",{staticClass:"upload-pic-list__progress"},[a("el-progress",{attrs:{width:180,type:"circle",percentage:t.upload.percentage}})],1):a("img",{attrs:{src:t.upload.dataUrl}})]),a("div",{staticClass:"pic-info"},[a("el-form-item",{attrs:{prop:"fileInfo."+n+".cornerIconName",rules:e.rules.title,label:"角标标题"}},[a("el-input",{model:{value:t.cornerIconName,callback:function(a){e.$set(t,"cornerIconName",a)},expression:"file.cornerIconName"}})],1),a("el-form-item",{attrs:{prop:"fileInfo."+n+".typeRls.typeId",rules:e.rules.type,label:"角标分类"}},[a("el-select",{model:{value:t.typeRls.typeId,callback:function(a){e.$set(t.typeRls,"typeId",a)},expression:"file.typeRls.typeId"}},e._l(e.attributes,function(e,t){return a("el-option",{key:t,attrs:{value:e.typeId,label:e.typeName}})}),1)],1),a("el-form-item",{attrs:{prop:"fileInfo."+n+".attributeCode",rules:e.rules.code,label:"角标类别"}},[a("el-radio-group",{model:{value:t.attributeCode,callback:function(a){e.$set(t,"attributeCode",a)},expression:"file.attributeCode"}},[a("el-radio",{attrs:{label:"0"}},[e._v("其他")]),a("el-radio",{attrs:{label:"1"}},[e._v("VIP")])],1)],1)],1),"uploading"!==t.status?a("i",{staticClass:"upload-pic-list__remove el-icon el-icon-close",attrs:{title:"移除"},on:{click:function(a){return e.handleRemoveFile(t,n)}}}):e._e()])}),a("el-button",{staticClass:"upload-pic-list__add",attrs:{disabled:"edit"===e.mode&&e.fileInfo.length>=1,type:"primary"},on:{click:function(t){return e.$refs.upload.handleSelectFile()}}},[e._v("\n              点击选择图片\n            ")]),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){e.showPicTypeSelector=!0}}},[e._v("批量设置分类")])],2)],2)],1)],1):e._e(),"read"===e.mode?a("div",{staticClass:"layout-read"},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),e.fileInfo.length>0?a("el-form",{ref:"form",attrs:{"label-width":"120px"}},[a("el-form-item",{attrs:{label:"角标标题",prop:"cornerIconName"}},[e._v("\n          "+e._s(e.fileInfo[0].cornerIconName)+"\n        ")]),a("el-form-item",{attrs:{label:"角标图片",prop:"imgUrl"}},[a("img",{staticStyle:{width:"200px"},attrs:{src:e.fileInfo[0].imgUrl}})]),a("el-form-item",{attrs:{label:"角标类别",prop:"attributeName"}},[e._v("\n          "+e._s(e.fileInfo[0].attributeName)+"\n        ")]),a("el-form-item",{attrs:{label:"角标分类",prop:"attributeName"}},[e._v("\n          "+e._s(e.fileInfo[0].cornerIconType.typeName)+"\n        ")])],1):e._e()],1):e._e(),a("el-dialog",{staticClass:"global-pic-type-selector",attrs:{title:"选择素材类型",size:"tiny",visible:e.showPicTypeSelector},on:{"update:visible":function(t){e.showPicTypeSelector=t}}},e._l(e.attributes,function(t,n){return a("el-tag",{key:n,nativeOn:{click:function(a){return e.handleBatchSetPicType(t)}}},[e._v("\n        "+e._s(t.typeName)+"\n      ")])}),1)],1)],1)},$p=[],Np={mixins:[ds["a"]],components:{CommonContent:Ql["a"],Upload:Bo["Upload"]},data:function(){return{mode:"create",resourceName:"角标",showPicTypeSelector:!1,fileInfo:[],attributes:[],attributesIndexed:[],form:{},rules:{title:[{required:!0,message:"请填写素材标题"},{max:45,message:"不超过 45 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择角标类别"}],code:[{required:!0,message:"请选择角标分类"}]}}},props:["initMode","id"],computed:{resourceInfo:function(){var e=this.fileInfo[0];if(e&&e.cornerIconId)return{id:e.cornerIconId,type:"icon",menuElId:"globalCornerIcon",version:e.currentVersion,status:e.cornerStatus}}},methods:{fetchData:function(e){this.$service.globalCornerIconEdit({id:this.id}).then(this.setFormData)},handleSave:function(){var e=this;this.validateFormData(function(t){if(!t){var a=e.getFormData();e.$service.globalCornerIconSave(a,"保存成功").then(function(){e.$emit("upsert-end")})}})},getFormData:function(){var e=this,t=this.getUploadedFiles().map(function(t){return{cornerIconId:e.id,cornerIconName:t.cornerIconName,imgUrl:t.imgUrl,attributeCode:t.attributeCode,typeRls:t.typeRls}});return t},setFormData:function(e){this.fileInfo=[Object(Q["a"])({upload:{status:"success",dataUrl:e.imgUrl},typeRls:{typeId:e.cornerIconType.typeId}},e)]},validateFormData:function(e){this.$refs.form.validate(function(t){if(t){var a=this.getUploadedFiles();0===a.length?(this.$message({type:"error",message:"最少要上传一个角标素材，才能保存"}),e(Error())):e()}else this.$message({type:"error",message:"请把表单填写完整"}),e(Error())}.bind(this))},getUploadedFiles:function(){return this.fileInfo.filter(function(e){return void 0!==e.imgUrl})},getCornerTypes:function(){var e=this;this.$service.getCornerTypes().then(function(t){e.attributes=t||[],e.attributesIndexed=e.attributes.reduce(function(e,t){return e[t.typeName]=t,e},{})})},handleUpload:function(e,t){this.$refs.upload.getImageInfo(t.dataUrl).then(function(a){var n={upload:t,typeRls:{typeId:void 0},cornerIconName:void 0,attributeCode:"0",imgUrl:void 0,pictureType:void 0};this.fileInfo.push(n),t.status="uploading",this.$service.uploadImage({file:e,onUploadProgress:function(e){e.lengthComputable&&(t.percentage=e.loaded/e.total)}}).then(function(e){if(0==e.code){var a=e.data[0];n.cornerIconName=a.originFileName,n.pictureType=a.fileType,n.imgUrl=a.url,t.status="success"}else t.status="error",t.message=e.msg}).catch(function(){t.status="error",t.message="网络错误"})}.bind(this))},handleRemoveFile:function(e,t){this.$refs.upload.handleRemove(e.upload),this.fileInfo=this.fileInfo.filter(function(e,a){return a!==t})},handleBatchSetPicType:function(e){var t=e.typeId;this.fileInfo.forEach(function(e){e.typeRls.typeId=t}),this.showPicTypeSelector=!1}},created:function(){this.mode=this.initMode||"create",this.id&&this.fetchData(this.version),this.getCornerTypes()}},Ep=Np,Op=(a("e2657"),Object(Yo["a"])(Ep,Lp,$p,!1,null,"8a7d1ba0",null)),Ap=Op.exports,Vp={components:{GlobalCornerIconList:Rp,GlobalCornerIcon:Ap},data:function(){return{isShowList:!0,mode:"list",id:void 0,version:void 0}},methods:{handleCreate:function(){this.mode="create",this.id=void 0,this.isShowList=!1},handleEdit:function(e){this.id=e.cornerIconId,this.mode="edit",this.isShowList=!1},handleRead:function(e){this.id=e.cornerIconId,this.mode="read",this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.globalCornerIconRemove({id:e.map(function(e){return e.cornerIconId}).join(",")},"删除成功").then(function(e){t.$refs.list.fetchData()})},handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},Bp=Vp,Mp=Object(Yo["a"])(Bp,Xd,Zd,!1,null,null,null),Up=Mp.exports,Gp=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("GlobalCornerIconTypeList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,edit:e.handleEdit,read:e.handleRead,delete:e.handleDelete}}),e.isShowList?e._e():a("GlobalCornerIconType",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},jp=[],zp=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"cornerIconType"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete,"batch-audit":e.batchAudit}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},Wp=[],qp={extends:Sl["a"],components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"],ButtonGroupForListPage:kl["a"]},data:function(){var e=this;return{resourceType:"cornerIconType",materialTypes:{},picDialogVisible:!1,auditDialogVisible:!1,auditForm:{idStr:null,auditFlag:"4",auditDesc:""},auditFormRules:{auditDesc:[{required:!0,message:"请输入意见说明",trigger:"blur"}],auditFlag:[{required:!0,message:"请输入审核意见",trigger:"blur"}]},filter:{sort:void 0,order:void 0},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"typeId",width:"70"},{label:"分类名称",width:"120",prop:"typeName",sortable:!0},{label:"角标位置",prop:"typePosition",width:"110",sortable:!0,render:function(t,a){var n=a.row;return e.$consts.cornerIconPositionText[n.typePosition]}},{label:"优先级(越小越靠前)",prop:"typePriority",width:"150",sortable:!0},{label:"修改人",prop:"modifierName",width:"90"},{label:"创建时间",prop:"createdDate",sortable:!0},{label:"修改时间",prop:"lastUpdateDate",sortable:!0}],data:[],selected:[],selectionType:"multiple"}}},methods:{batchAudit:function(){this.selected.length>0?this.auditDialogVisible=!0:this.$message({type:"error",message:"请选择再审核"})},submitAudit:function(){var e=this;this.$refs.auditForm.validate(function(t){t&&(e.auditForm.idStr=e.selected.join(","),e.$service.materialBatchAudit(e.auditForm,"审批成功").then(function(t){e.fetchData(),e.auditDialogVisible=!1}))})},handleChange:function(e,t,a){for(var n=[],i=0;i<e.length;i++)n.push(["roleIds",e[i]]);this.selectedRole=this.user.concat(n)},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.typeId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.getGlobalCornerIconTypePageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=ll.a.map({typeId:ll.a.o.string.other("form",{component:"Input",placeholder:"ID"}),typeName:ll.a.o.string.other("form",{component:"Input",placeholder:"角标名称"}),typePosition:ll.a.o.enum(this.$consts.cornerIconPositionEnums).other("form",{component:"Select",placeholder:"角标位置"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},Jp=qp,Hp=(a("c41c"),Object(Yo["a"])(Jp,zp,Wp,!1,null,"034c3d50",null)),Kp=Hp.exports,Yp=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"global-picture",attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("CommonContent",{attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{edit:function(t){e.mode="edit"},unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,audit:function(t){return e.$emit("upsert-end")},"select-version":e.fetchData,delete:function(t){return e.$emit("upsert-end",t)}}},[a("div",{attrs:{slot:"auditAndDraft"},slot:"auditAndDraft"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("保存")])],1),"read"!==e.mode?a("div",{staticClass:"layout-upsert"},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{model:e.form,rules:e.formRules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"角标分类名称",prop:"typeName"}},[a("el-input",{attrs:{placeholder:"角标名称"},model:{value:e.form.typeName,callback:function(t){e.$set(e.form,"typeName",t)},expression:"form.typeName"}})],1),a("el-form-item",{attrs:{label:"角标位置",prop:"typePosition"}},[a("el-select",{attrs:{placeholder:"角标位置"},model:{value:e.form.typePosition,callback:function(t){e.$set(e.form,"typePosition",t)},expression:"form.typePosition"}},e._l(e.$consts.cornerIconPositionOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"优先级",prop:"typePriority"}},[a("el-input-number",{attrs:{min:1,label:"优先级"},model:{value:e.form.typePriority,callback:function(t){e.$set(e.form,"typePriority",t)},expression:"form.typePriority"}})],1)],1)],1):e._e(),"read"===e.mode?a("div",{staticClass:"layout-read"}):e._e()])],1)},Qp=[],Xp={mixins:[ds["a"]],components:{CommonContent:Ql["a"]},data:function(){return{mode:"create",resourceName:"角标分类",form:{typeId:void 0,typeName:null,typePosition:null,typePriority:null},formRules:{typeName:[{required:!0,message:"请输入角标名称",trigger:"blur"},{max:45,message:"不能超过45个字符",trigger:"blur"}],typePosition:[{required:!0,message:"请输入角标位置",trigger:"blur"}],typePriority:[{required:!0,message:"请输入角标优先级",trigger:"blur"}]}}},props:["initMode","id"],computed:{resourceInfo:function(){var e=this.form;if(e.typeId)return{id:e.typeId,type:"icon",menuElId:"globalCornerIcon",version:e.currentVersion,status:e.typeStatus}}},methods:{fetchData:function(e){var t=this;this.$service.globalCornerIconTypeDetail({id:this.id}).then(function(e){t.form=Object.assign({},t.form,e)})},handleSave:function(){var e=this;this.$refs.form.validate(function(t){t&&e.$service.globalCornerIconTypeSave(e.form,"保存成功").then(function(t){e.$emit("upsert-end")})})}},created:function(){this.mode=this.initMode||"create",this.id&&this.fetchData(this.version)}},Zp=Xp,eh=(a("00b2"),Object(Yo["a"])(Zp,Yp,Qp,!1,null,"06bf3ff3",null)),th=eh.exports,ah={components:{GlobalCornerIconTypeList:Kp,GlobalCornerIconType:th},data:function(){return{isShowList:!0,mode:"list",id:void 0,version:void 0}},methods:{handleCreate:function(){this.mode="create",this.id=void 0,this.isShowList=!1},handleEdit:function(e){this.id=e.typeId,this.mode="edit",this.isShowList=!1},handleRead:function(e){this.id=e.typeId,this.mode="read",this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.globalCornerIconTypeBatchDel({id:e.map(function(e){return e.typeId}).join(",")},"删除成功").then(function(e){t.$refs.list.fetchData()})},handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},nh=ah,ih=Object(Yo["a"])(nh,Gp,jp,!1,null,null,null),rh=ih.exports,oh=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("GlobalPictureList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,edit:e.handleEdit,read:e.handleRead,delete:e.handleDelete}}),e.isShowList?e._e():a("GlobalPictureUpsert",{attrs:{"edit-id":e.editId,initMode:e.mode},on:{"show-list":e.openListPage,"go-back":e.goBack}})],1)},lh=[],sh=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},["read"!==e.mode?a("div",{staticClass:"global-picture"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("保存")]),a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"form",attrs:{"label-width":"120px",model:this}},[a("div",{staticClass:"global-picture__label"},[e._v("素材图片")]),a("Upload",{ref:"upload",staticClass:"global-picture__uploader",attrs:{multiple:!0},on:{upload:e.handleUpload}},[a("template",{slot:"preview"},[e._l(e.fileInfo,function(t,n){return a("div",{key:n,staticClass:"upload-pic-list__item-wrapper"},[a("div",{staticClass:"upload-pic-list__item"},["error"===t.upload.status?a("div",{staticClass:"upload-pic-list__error"},[e._v("上传失败: "+e._s(t.upload.message))]):e._e(),"uploading"===t.upload.status?a("div",{staticClass:"upload-pic-list__progress"},[a("el-progress",{attrs:{width:180,type:"circle",percentage:t.upload.percentage}})],1):a("img",{attrs:{src:t.upload.dataUrl}})]),a("div",{staticClass:"pic-info"},[a("el-form-item",{attrs:{prop:"fileInfo."+n+".pictureName",rules:e.rules.title,label:"素材标题"}},[a("el-input",{model:{value:t.pictureName,callback:function(a){e.$set(t,"pictureName",a)},expression:"file.pictureName"}})],1),a("el-form-item",{attrs:{label:"素材分辨率"}},[e._v(e._s(t.pictureResolution))]),a("el-form-item",{attrs:{prop:"fileInfo."+n+".materialTypeDictEnName",rules:e.rules.type,label:"素材类型"}},[a("el-select",{model:{value:e.fileInfo[n].materialTypeDictEnName,callback:function(t){e.$set(e.fileInfo[n],"materialTypeDictEnName",t)},expression:"fileInfo[index].materialTypeDictEnName"}},e._l(e.picTypeOptions,function(e,t){return a("el-option",{key:t,attrs:{value:e.dictEnName,label:e.dictCnName}})}),1)],1)],1),"uploading"!==t.status?a("i",{staticClass:"upload-pic-list__remove el-icon el-icon-close",attrs:{title:"移除"},on:{click:function(a){return e.handleRemoveFile(t,n)}}}):e._e()])}),a("el-button",{staticClass:"upload-pic-list__add",attrs:{disabled:"edit"===e.mode&&e.fileInfo.length>=1,type:"primary"},on:{click:function(t){return e.$refs.upload.handleSelectFile()}}},[e._v("点击选择图片")]),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){e.showPicTypeSelector=!0}}},[e._v("批量设置类型")])],2)],2)],1),a("el-dialog",{staticClass:"global-pic-type-selector",attrs:{title:"选择素材类型",size:"tiny",visible:e.showPicTypeSelector},on:{"update:visible":function(t){e.showPicTypeSelector=t}}},e._l(e.picTypeOptions,function(t,n){return a("el-tag",{key:n,nativeOn:{click:function(a){return e.handleBatchSetPicType(t)}}},[e._v(e._s(t.dictCnName))])}),1)],1):e._e(),"read"===e.mode?a("div",{staticClass:"global-picture"},[a("div",{staticClass:"global-picture__actions"},[3===e.status?a("el-button",{attrs:{type:"primary"},on:{click:e.audit}},[e._v("审核")]):e._e(),a("el-button",{on:{click:e.handleCancel}},[e._v("关闭")])],1),a("el-form",{ref:"form",attrs:{"label-width":"120px",model:this}},[a("div",{staticClass:"global-picture__label"},[e._v("素材图片")]),a("Upload",{ref:"upload",staticClass:"global-picture__uploader",attrs:{multiple:!0},on:{upload:e.handleUpload}},[a("template",{slot:"preview"},e._l(e.fileInfo,function(t,n){return a("div",{key:n,staticClass:"upload-pic-list__item-wrapper"},[a("div",{staticClass:"upload-pic-list__item"},["error"===t.upload.status?a("div",{staticClass:"upload-pic-list__error"},[e._v("上传失败: "+e._s(t.upload.message))]):e._e(),"uploading"===t.upload.status?a("div",{staticClass:"upload-pic-list__progress"},[a("el-progress",{attrs:{width:180,type:"circle",percentage:t.upload.percentage}})],1):a("img",{attrs:{src:t.upload.dataUrl}})]),a("div",{staticClass:"pic-info"},[a("el-form-item",{attrs:{prop:"fileInfo."+n+".pictureName",rules:e.rules.title,label:"素材标题"}},[e._v(e._s(t.pictureName))]),a("el-form-item",{attrs:{label:"素材分辨率"}},[e._v(e._s(t.pictureResolution))]),a("el-form-item",{attrs:{prop:"fileInfo."+n+".materialTypeDictEnName",rules:e.rules.type,label:"素材类型"}},[a("el-select",{attrs:{disabled:!0},model:{value:e.fileInfo[n].materialTypeDictEnName,callback:function(t){e.$set(e.fileInfo[n],"materialTypeDictEnName",t)},expression:"fileInfo[index].materialTypeDictEnName"}},e._l(e.picTypeOptions,function(e,t){return a("el-option",{key:t,attrs:{value:e.dictEnName,label:e.dictCnName}})}),1)],1)],1)])}),0)],2)],1)],1):e._e(),a("el-dialog",{attrs:{title:"预览图片",visible:e.auditDialogVisible,width:"30%"},on:{"update:visible":function(t){e.auditDialogVisible=t}}},[a("span",[a("el-form",{ref:"auditForm",attrs:{model:e.auditForm,rules:e.auditFormRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"审核意见",prop:"auditFlag"}},[a("el-radio",{attrs:{label:"4"},model:{value:e.auditForm.auditFlag,callback:function(t){e.$set(e.auditForm,"auditFlag",t)},expression:"auditForm.auditFlag"}},[e._v("通过")]),a("el-radio",{attrs:{label:"5"},model:{value:e.auditForm.auditFlag,callback:function(t){e.$set(e.auditForm,"auditFlag",t)},expression:"auditForm.auditFlag"}},[e._v("打回")])],1),a("el-form-item",{attrs:{label:"意见说明",prop:"auditDesc"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.auditForm.auditDesc,callback:function(t){e.$set(e.auditForm,"auditDesc",t)},expression:"auditForm.auditDesc"}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.auditDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitAudit}},[e._v("确 定")])],1)])],1)},ch=[],uh={components:{Upload:Bo["Upload"]},data:function(){return{mode:"create",status:void 0,showPicTypeSelector:!1,pictureId:void 0,fileInfo:[],title:"",auditDialogVisible:!1,picTypeOptions:[],picTypeOptionsIndexed:[],rules:{title:[{required:!0,message:"请填写素材标题"},{max:45,message:"不超过 45 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择素材类型"}]},auditForm:{idStr:null,auditFlag:"4",auditDesc:""},auditFormRules:{auditDesc:[{required:!0,message:"请输入意见说明",trigger:"blur"}],auditFlag:[{required:!0,message:"请输入审核意见",trigger:"blur"}]}}},props:["editId","initMode"],methods:{audit:function(){this.auditDialogVisible=!0},submitAudit:function(){var e=this;this.$refs.auditForm.validate(function(t){t&&(e.auditForm.idStr=e.editId,e.$service.materialBatchAudit(e.auditForm,"审批成功").then(function(t){e.auditDialogVisible=!1,e.$emit("show-list")}))})},handleUpload:function(e,t){this.$refs.upload.getImageInfo(t.dataUrl).then(function(a){var n={upload:t,materialTypeDictEnName:void 0,pictureId:void 0,pictureName:void 0,pictureResolution:a.width+"*"+a.height,pictureStatus:void 0,pictureType:void 0,pictureUrl:void 0};this.fileInfo.push(n),t.status="uploading",this.$service.uploadImage({file:e,onUploadProgerss:function(e){e.lengthComputable&&(t.percentage=e.loaded/e.total)}}).then(function(e){if(0==e.code){var a=e.data[0];n.pictureName=a.originFileName,n.pictureType=a.fileType,n.pictureUrl=a.url,t.status="success"}else t.status="error",t.message=e.msg}).catch(function(){t.status="error",t.message="网络错误"})}.bind(this))},handleRemoveFile:function(e,t){this.$refs.upload.handleRemove(e.upload),this.fileInfo=this.fileInfo.filter(function(e,a){return a!==t})},handleSelectPicTypeStart:function(){this.showPicTypeSelector=!0},handleBatchSetPicType:function(e){this.fileInfo.forEach(function(t){t.materialTypeDictEnName=e.dictEnName}),this.showPicTypeSelector=!1},getFormData:function(){var e=this,t=this.pictureId,a=this.picTypeOptionsIndexed,n=this.getUploadedFiles().map(function(n){return{pictureId:t,pictureType:n.pictureType,pictureResolution:n.pictureResolution,pictureUrl:n.pictureUrl,pictureStatus:n.pictureStatus,pictureName:n.pictureName,materialTypes:e.parseMaterialType(a[n.materialTypeDictEnName])}}),i={jsonStr:JSON.stringify(n)};return i},setFormData:function(e){this.status=e.pictureStatus,e=JSON.parse(JSON.stringify(e));var t=e.materialTypes;e.materialTypeDictEnName=t[0].dictEnName,e.upload={status:"success",dataUrl:e.pictureUrl},this.pictureId=e.pictureId,this.fileInfo.push(e)},parseMaterialType:function(e){return{dictId:e.dictId,dictEnName:e.dictEnName,dictCnName:e.dictCnName}},validateFormData:function(e){this.$refs.form.validate(function(t){if(t){var a=this.getUploadedFiles();0===a.length?(this.$message({type:"error",message:"最少要上传一个素材，才能保存"}),e(Error())):e()}else this.$message({type:"error",message:"请把表单填写完整"}),e(Error())}.bind(this))},getUploadedFiles:function(){return this.fileInfo.filter(function(e){return void 0!==e.pictureUrl})},handleSubmit:function(){var e=this;this.validateFormData(function(t){if(!t){var a=e.getFormData();e.$service.globalPictureUpsert(a,"保存成功").then(function(){e.$emit("show-list")})}})},handleCancel:function(){this.$emit("go-back")},getMaterialTypes:function(){var e=this;this.$service.getDictType({type:"materialType"}).then(function(t){e.picTypeOptions=t||[],e.picTypeOptionsIndexed=e.picTypeOptions.reduce(function(e,t){return e[t.dictEnName]=t,e},{})})}},created:function(){this.editId?(this.title="编辑",this.$service.globalPictureGet({id:this.editId}).then(this.setFormData)):this.title="新增",this.mode=this.initMode,this.getMaterialTypes()}},dh=uh,ph=(a("6b22"),Object(Yo["a"])(dh,sh,ch,!1,null,null,null)),hh=ph.exports,mh=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("div",{staticClass:"control-button-group"},[a("ButtonGroupForListPage",{staticClass:"auth-button-group",attrs:{pageName:"poster"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete,"batch-audit":e.batchAudit}}),a("GlobalPictureBatchAudit",{on:{"audit-end":e.fetchData}}),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleAllRowSelectionChange(e.checkAll=!e.checkAll)}}},[e._v("全选/全不选")])],1),a("CardList",{staticClass:"img-list",attrs:{data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove},scopedSlots:e._u([{key:"row",fn:function(t){var n=t.row;return a("div",{staticClass:"img-item",on:{click:function(t){return t.stopPropagation(),e.handleRead(n)}}},[a("img",{key:n.pictureUrl,attrs:{referrerpolicy:"no-referrer",src:n.pictureUrl}}),a("a",{staticClass:"img-preview",on:{click:function(t){return t.stopPropagation(),e.reviewPic(n)}}},[e._v("预览")]),a("div",{staticClass:"img-detail"},[a("span",[e._v("素材id："+e._s(n.pictureId))]),a("span",[e._v("素材标题: "+e._s(n.pictureName))]),a("span",[e._v("素材类型："+e._s(n.materialTypes?n.materialTypes[0].dictCnName:""))]),a("span",[e._v("分辨率："+e._s(n.pictureResolution))])]),a("div",{staticClass:"img-info"},[a("span",{staticClass:"img-title"},[e._v(e._s(n.pictureName))]),a("span",{staticClass:"img-status"},[e._v(e._s(e.$consts.statusText[n.pictureStatus]))])])])}}])})],1),a("el-dialog",{attrs:{title:"预览图片",visible:e.picDialogVisible,width:"30%"},on:{"update:visible":function(t){e.picDialogVisible=t}}},[a("span",{staticClass:"pics"},[a("img",{attrs:{referrerpolicy:"no-referrer",src:e.reviewPicUrl,alt:"图片","max-width":"500"}})]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.picDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.picDialogVisible=!1}}},[e._v("确 定")])],1)]),a("el-dialog",{attrs:{title:"审核",visible:e.auditDialogVisible,width:"30%"}},[a("span",[a("el-form",{ref:"auditForm",attrs:{model:e.auditForm,rules:e.auditFormRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"审核意见",prop:"auditFlag"}},[a("el-radio",{attrs:{label:"4"},model:{value:e.auditForm.auditFlag,callback:function(t){e.$set(e.auditForm,"auditFlag",t)},expression:"auditForm.auditFlag"}},[e._v("通过")]),a("el-radio",{attrs:{label:"5"},model:{value:e.auditForm.auditFlag,callback:function(t){e.$set(e.auditForm,"auditFlag",t)},expression:"auditForm.auditFlag"}},[e._v("打回")])],1),a("el-form-item",{attrs:{label:"意见说明",prop:"auditDesc"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.auditForm.auditDesc,callback:function(t){e.$set(e.auditForm,"auditDesc",t)},expression:"auditForm.auditDesc"}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.auditDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitAudit}},[e._v("确 定")])],1)])],1)},fh=[],vh=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("RemoteSelectorWrapper",{ref:"selectorWrapper",attrs:{title:"批量审核下面所有素材(一次最多审核50个)",pagination:e.pagination},on:{"select-start":e.handleSelectStart}},[a("el-button",{attrs:{type:"primary"}},[e._v("一键审核")]),a("div",{attrs:{slot:"filter"},slot:"filter"},[a("el-form",{ref:"auditForm",attrs:{inline:!0,model:e.auditForm,rules:e.auditFormRules,"label-width":"80px"},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.handleAudit(t))}}},[a("el-form-item",{attrs:{label:"审核意见",prop:"auditFlag"}},[a("el-radio",{attrs:{label:"4"},model:{value:e.auditForm.auditFlag,callback:function(t){e.$set(e.auditForm,"auditFlag",t)},expression:"auditForm.auditFlag"}},[e._v("通过")]),a("el-radio",{attrs:{label:"5"},model:{value:e.auditForm.auditFlag,callback:function(t){e.$set(e.auditForm,"auditFlag",t)},expression:"auditForm.auditFlag"}},[e._v("打回")])],1),a("el-form-item",{attrs:{label:"意见说明",prop:"auditDesc"}},[a("el-input",{ref:"auditDesc",staticStyle:{width:"400px"},attrs:{autofocus:""},model:{value:e.auditForm.auditDesc,callback:function(t){e.$set(e.auditForm,"auditDesc",t)},expression:"auditForm.auditDesc"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleAudit}},[e._v("确定")]),a("el-button",{on:{click:e.handleCancel}},[e._v("取消")])],1)],1)],1),a("CardList",{attrs:{slot:"item-list",data:e.table.data,selected:e.table.selected,"selection-type":"none"},slot:"item-list",scopedSlots:e._u([{key:"row",fn:function(t){var n=t.row;return a("div",{staticClass:"picture-item"},[a("div",{staticClass:"img-wrapper"},[a("img",{key:n.pictureUrl,staticClass:"list-img",attrs:{src:n.pictureUrl}})]),a("div",[e._v(e._s(n.pictureName))]),a("div",[e._v("\n        "+e._s(n.pictureId)+" / "+e._s(e.$consts.statusText[n.pictureStatus])+" / "+e._s(n.pictureResolution)+"\n      ")])])}}])}),a("div",{attrs:{slot:"footer"},slot:"footer"})],1)},gh=[],bh={components:{CardList:Bo["CardList"],RemoteSelectorWrapper:Tp["a"]},data:function(){return{table:{props:{},data:[],selected:void 0,selectionType:"single"},pagination:{currentPage:1,pageSize:50},filter:{pictureStatus:3},auditForm:{idStr:null,auditFlag:"4",auditDesc:""},auditFormRules:{auditDesc:[{required:!0,message:"请输入意见说明",trigger:"blur"}],auditFlag:[{required:!0,message:"请输入审核意见",trigger:"blur"}]}}},methods:{handleSelectStart:function(){var e=this;this.fetchData(),this.$nextTick(function(){var t=e.$refs.auditForm,a=e.$refs.auditDesc;t&&(t.clearValidate(),a.focus())})},handleAudit:function(){var e=this;this.$refs.auditForm.validate(function(t){t&&(e.auditForm.idStr=e.table.data.map(function(e){var t=e.pictureId;return t}).join(","),e.$service.materialBatchAudit(e.auditForm,"4"===e.auditForm.auditFlag?"审批成功":"打回成功").then(function(t){e.$refs.selectorWrapper.handleSelectCancel(),e.$emit("audit-end")}))})},handleCancel:function(){this.$refs.selectorWrapper.handleSelectCancel()},getFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),Object(Q["a"])({},e)},fetchData:function(){var e=this,t=this.getFilter();this.$service.getResourceList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows,0===t.rows.length&&(e.$message.warning("没有待审核素材"),setTimeout(function(){e.handleCancel()},1e3))})}}},yh=bh,wh=(a("d224"),Object(Yo["a"])(yh,vh,gh,!1,null,"338ecbdf",null)),Ih=wh.exports,Ch={extends:Sl["a"],components:{ContentWrapper:Bo["ContentWrapper"],ButtonGroupForListPage:kl["a"],GlobalPictureBatchAudit:Ih,CardList:Bo["CardList"]},data:function(){var e=this;return{resourceType:"picture",checkAll:!1,materialTypes:{},picDialogVisible:!1,auditDialogVisible:!1,reviewPicUrl:null,auditForm:{idStr:null,auditFlag:"4",auditDesc:""},auditFormRules:{auditDesc:[{required:!0,message:"请输入意见说明",trigger:"blur"}],auditFlag:[{required:!0,message:"请输入审核意见",trigger:"blur"}]},filter:{sort:void 0,order:void 0},filterSchema:null,pagination:{},selected:[],status:[],table:{props:{},header:[{label:"ID",prop:"pictureId",width:"90"},{label:"ID",prop:"pictureUrl",width:"70",render:function(t,a){var n=a.row;return t("img",{attrs:{width:"50px",height:"50px",class:"imgs",referrerpolicy:"no-referrer",src:n.pictureUrl},on:{click:function(){e.reviewPic(n)}}})}},{label:"素材名称",width:"120",prop:"pictureName",sortable:!0,render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n)}}},n.pictureName)}},{label:"分辨率",prop:"pictureResolution",width:"110",sortable:!0},{label:"状态",prop:"pictureStatus",width:"90",render:function(t,a){var n=a.row;return e.$const.statusText[n.pictureStatus]}},{label:"素材类型",prop:"materialTypes",width:"70",render:function(e,t){var a=t.row;return a.materialTypes.length>0?a.materialTypes[0].dictCnName:""}},{label:"创建时间",prop:"createdDate",sortable:!0},{label:"修改时间",prop:"lastUpdateDate",sortable:!0}],data:[],selected:[],selectionType:"multiple"}}},methods:{submitAudit:function(){var e=this,t=this.auditForm,a=this.$consts.status.waiting;this.$refs.auditForm.validate(function(n){n&&(t.idStr=e.selected.filter(function(e){return e.pictureStatus===a}).map(function(e){var t=e.pictureId;return t}).join(","),e.$service.materialBatchAudit(t,"4"===t.auditFlag?"审批成功":"打回成功").then(function(t){e.fetchData(),e.auditDialogVisible=!1}))})},handleChange:function(e,t,a){for(var n=[],i=0;i<e.length;i++)n.push(["roleIds",e[i]]);this.selectedRole=this.user.concat(n)},batchAudit:function(){if(0===this.selected.length)return this.$message.error("请选择再审批");var e=this.$consts.status.waiting,t=this.selected.filter(function(t){return t.pictureStatus===e}).length;if(0===t)return this.$message.error("选中的素材里没有待审核素材");this.auditForm={idStr:null,auditFlag:"4",auditDesc:""},this.auditDialogVisible=!0},reviewPic:function(e){this.reviewPicUrl=e.pictureUrl,this.picDialogVisible=!0},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.pictureId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.getMaterialPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows,e.checkAll=!1})},getMaterialTypes:function(){var e=this;return this.$service.getDictType({type:"materialType"}).then(function(t){t.forEach(function(t){e.materialTypes[t.dictCnName]=t.dictId})})}},created:function(){var e=this,t=ll.a.map({pictureId:ll.a.o.string.other("form",{component:"Input",placeholder:"ID"}),pictureName:ll.a.o.string.other("form",{component:"Input",placeholder:"素材名称"}),pictureCategory:ll.a.o.enum(this.materialTypes).other("form",{component:"Select",placeholder:"素材类别"}),pictureResolution:ll.a.o.string.other("form",{component:"Input",placeholder:"分辨率"}),pictureStatus:ll.a.o.enum(this.$baseStatus()).other("form",{component:"Select",placeholder:"审核状态"})}).other("form",{cols:{item:5,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.getMaterialTypes().then(function(){e.filterSchema=t}),this.fetchData()}},Th=Ch,Sh=(a("c797"),a("741b"),Object(Yo["a"])(Th,mh,fh,!1,null,"213894e7",null)),kh=Sh.exports,_h={components:{GlobalPictureUpsert:hh,GlobalPictureList:kh},data:function(){return{isShowList:!0,editId:null,mode:void 0}},methods:{goBack:function(){this.isShowList=!0},handleCreate:function(e){this.editId=void 0,this.isShowList=!1,this.mode="create"},handleEdit:function(e){this.editId=e.pictureId,this.isShowList=!1,this.mode="edit"},handleRead:function(e){this.editId=e.pictureId,this.mode="read",this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.materialBatchDelete({id:e.map(function(e){return e.pictureId}).join(",")},"删除成功").then(function(e){t.$refs.list.fetchData()})},openListPage:function(){this.isShowList=!0,this.$refs.list.fetchData()}}},Ph=_h,xh=Object(Yo["a"])(Ph,oh,lh,!1,null,null,null),Fh=xh.exports,Dh=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"resource-manager-wrapper"},[a("LayoutInfoList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,edit:e.handleEdit,read:e.handleRead,delete:e.handleDelete}}),e.isShowList?e._e():a("LayoutInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},Rh=[],Lh=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("div",{staticClass:"btns"},[a("ButtonGroupForListPage",{attrs:{pageName:"layout","not-contain-btns":e.notContainBtns},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}})],1),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},$h=[],Nh={extends:Sl["a"],components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"],ButtonGroupForListPage:kl["a"]},data:function(){var e=this;return{resourceType:"layout",notContainBtns:["audit","batchAudit"],layoutType:{"主页6.0":1,"影视V2":2},layoutIsTitle:{"带标题":1,"不带标题":0},layoutTypeText:{},filter:this.genDefaultFilter(),filterSchema:null,pagination:{},selected:[],selectedRows:{},table:{props:{},header:[{label:"ID",prop:"layoutId",width:"70"},{label:"名称",width:"200",prop:"layoutName",sortable:!0,render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(n)}}},n.layoutName)}},{label:"分类",prop:"layoutType",width:"80",render:function(t,a){var n=a.row;return e.layoutTypeText[n.layoutType]}},{label:"布局标题",prop:"layoutIsTitle",width:"80",render:function(e,t){var a=t.row;return 1===a.layoutIsTitle?"带标题":"不带标题"}},{label:"扩展方式",prop:"layoutModel",width:"80",render:function(e,t){var a=t.row,n=a.layoutModel;return"Expandar"===n?"横向拓展":"Lengthwise"===n?"纵向拓展":"无"}},{label:"状态",prop:"layoutStatus",width:70,render:function(t,a){var n=a.row;return e.$consts.statusText[n.layoutStatus]}},{label:"更新时间",prop:"lastUpdateDate",sortable:!0},{label:"更新人",prop:"modifierName",render:function(e,t){var a=t.row;return a.modifierName}}],data:[],selected:[],selectionType:"multiple"}}},methods:{genDefaultFilter:function(){return{}},handleFilterChange:function(e,t){t&&(this.filter=t),"query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData()},handleFilterReset:function(){this.filter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();this.$service.getLayoutInforPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},fetchLayoutTypeOptions:function(){var e=this;this.$service.getDictType({type:"layoutType"}).then(function(t){e.layoutTypeOptions=t,e.layoutTypeText=t.reduce(function(e,t){return e[t.dictId]=t.dictCnName,e},{})})}},created:function(){var e=ll.a.map({layoutId:ll.a.o.oneOf([ll.a.number,ll.a.value("")]).$msg("请输入数字").other("form",{component:"Input",placeholder:"布局ID"}),layoutName:ll.a.o.string.other("form",{component:"Input",placeholder:"布局名称"}),layoutType:ll.a.o.enum(this.layoutType).other("form",{component:"Select",placeholder:"布局分类"}),layoutIsTitle:ll.a.o.enum(this.layoutIsTitle).other("form",{component:"Select",placeholder:"布局标题"}),layoutStatus:ll.a.o.enum(this.$consts.statusEnums).other("form",{component:"Select",placeholder:"状态"})}).other("form",{cols:{item:4,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchLayoutTypeOptions(),this.fetchData()}},Eh=Nh,Oh=(a("3cad"),Object(Yo["a"])(Eh,Lh,$h,!1,null,"130d0ad9",null)),Ah=Oh.exports,Vh=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PageWrapper",[a("PageContentWrapper",{directives:[{name:"show",rawName:"v-show",value:"layout"===e.activePage,expression:"activePage === 'layout'"}]},[a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("CommonContent",{attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{edit:function(t){e.mode="edit"},unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,audit:function(t){return e.$emit("upsert-end")},"select-version":e.fetchData,delete:function(t){return e.$emit("upsert-end",t)}}},[a("div",{attrs:{slot:"auditAndDraft"},slot:"auditAndDraft"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("提交审核")])],1),"read"!==e.mode?a("div",{staticClass:"layout-upsert"},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{model:e.form,rules:e.formRules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"布局名称(中文)",prop:"layoutName"}},[a("el-input",{attrs:{placeholder:"布局名称"},model:{value:e.form.layoutName,callback:function(t){e.$set(e.form,"layoutName",t)},expression:"form.layoutName"}})],1),a("el-form-item",{attrs:{label:"布局类别",prop:"layoutType"}},[a("el-select",{attrs:{placeholder:"布局类别"},model:{value:e.form.layoutType,callback:function(t){e.$set(e.form,"layoutType",t)},expression:"form.layoutType"}},e._l(e.layoutTypeOptions,function(e){return a("el-option",{key:e.id,attrs:{label:e.dictCnName,value:e.dictId}})}),1)],1),a("el-form-item",{attrs:{label:"布局",prop:"layoutJson8"}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.$refs.upload.handleSelectFile()}}},[e._v("上传布局文件")]),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){e.activePage="layout-generate"}}},[e._v("生成布局")]),a("el-button",{attrs:{type:"primary",plain:"",disabled:!e.form.layoutJson8},on:{click:function(t){return e.handleDownloadLayout(e.form.layoutJson8)}}},[e._v("下载")]),a("Upload",{ref:"upload",on:{upload:function(t){return e.handleUpload(arguments[0],arguments[1],"v8")}},scopedSlots:e._u([{key:"preview",fn:function(t){var n=t.fileList;return[n&&n.length>0?a("div",[a("div",{staticClass:"upload-pic-list__item"},["uploading"===e.getLastFile(n).status?a("div",{staticClass:"upload-pic-list__progress"},[a("el-progress",{staticStyle:{width:"250px"},attrs:{percentage:e.getLastFile(n).percentage}})],1):e._e()])]):e._e()]}}],null,!1,1242494890)}),e.form.layoutJson8?a("LayoutPreview",{staticClass:"layout-preview",attrs:{content:e.form.layoutJson8.contents}}):e._e()],1),a("el-form-item",{attrs:{label:"6.0布局生成方式",prop:"layout6GenMode"}},[a("el-radio-group",{attrs:{value:e.form.layout6GenMode},on:{input:e.handleInputLayout6GenMode}},[a("el-radio",{attrs:{label:"auto"}},[e._v("自动")]),a("el-radio",{attrs:{label:"manual"}},[e._v("手动")])],1)],1),a("el-form-item",{attrs:{label:"布局6.0",prop:"layoutJson"}},[a("el-button",{attrs:{type:"primary",disabled:"auto"===e.form.layout6GenMode,plain:""},on:{click:function(t){return e.$refs.uploadV6.handleSelectFile()}}},[e._v("上传布局文件")]),a("el-button",{attrs:{type:"primary",disabled:"auto"===e.form.layout6GenMode,plain:""},on:{click:function(t){e.activePage="layout-generate-v6"}}},[e._v("生成布局")]),a("el-button",{attrs:{type:"primary",plain:"",disabled:!e.form.layoutJson},on:{click:function(t){return e.handleDownloadLayout(e.form.layoutJson)}}},[e._v("下载")]),a("Upload",{ref:"uploadV6",on:{upload:function(t){return e.handleUpload(arguments[0],arguments[1],"v6")}},scopedSlots:e._u([{key:"preview",fn:function(t){var n=t.fileList;return[n&&n.length>0?a("div",[a("div",{staticClass:"upload-pic-list__item"},["uploading"===e.getLastFile(n).status?a("div",{staticClass:"upload-pic-list__progress"},[a("el-progress",{staticStyle:{width:"250px"},attrs:{percentage:e.getLastFile(n).percentage}})],1):e._e()])]):e._e()]}}],null,!1,1242494890)}),e.form.layoutJson?a("LayoutPreview",{staticClass:"layout-preview",attrs:{content:e.form.layoutJson.contents}}):e._e()],1)],1)],1):e._e(),"read"===e.mode?a("div",{staticClass:"layout-read"},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"布局名称(中文)",prop:"layoutName"}},[a("div",[e._v(e._s(e.form.layoutName))])]),a("el-form-item",{attrs:{label:"布局类别",prop:"layoutType"}},[a("div",[e._v(e._s(e.layoutTypeText[e.form.layoutType]))])]),a("el-form-item",{attrs:{label:"布局"}},[a("el-button",{attrs:{type:"primary",plain:"",disabled:!e.form.layoutJson8},on:{click:function(t){return e.handleDownloadLayout(e.form.layoutJson8)}}},[e._v("下载")]),e.form.layoutJson8?a("LayoutPreview",{staticClass:"layout-preview",attrs:{content:e.form.layoutJson8.contents}}):e._e()],1),a("el-form-item",{attrs:{label:"6.0布局生成方式",prop:"layout6GenMode"}},[e._v("\n              "+e._s("manual"===e.form.layout6GenMode?"手动":"自动")+"\n            ")]),a("el-form-item",{attrs:{label:"布局6.0",prop:"layoutJson"}},[a("el-button",{attrs:{type:"primary",plain:"",disabled:!e.form.layoutJson},on:{click:function(t){return e.handleDownloadLayout(e.form.layoutJson)}}},[e._v("下载")]),e.form.layoutJson?a("LayoutPreview",{staticClass:"layout-preview",attrs:{content:e.form.layoutJson.contents}}):e._e()],1)],1)],1):e._e()])],1)],1),"layout-generate"===e.activePage?a("PageContentWrapper",[a("LayoutInfoGenerator",{attrs:{"layout-version":"v8","layout-spacing":40,"layout-width":1760},on:{"go-back":function(t){e.activePage="layout"},"gen-end":function(t){return e.handleGenLayoutEnd(t,"v8")}}})],1):e._e(),"layout-generate-v6"===e.activePage?a("PageContentWrapper",[a("LayoutInfoGenerator",{attrs:{"layout-version":"v6","layout-spacing":28,"layout-width":1622},on:{"go-back":function(t){e.activePage="layout"},"gen-end":function(t){return e.handleGenLayoutEnd(t,"v6")}}})],1):e._e()],1)},Bh=[],Mh=a("b1fe"),Uh=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:"生成布局"},on:{"go-back":function(t){return e.$emit("go-back","add")}}},[a("el-form",{ref:"dynamicValidateForm",staticClass:"layout-dynamic",attrs:{model:e.dynamicValidateForm,"label-width":"100px"}},[a("el-form-item",{staticClass:"spacing",attrs:{prop:"spacing",label:"间距",rules:[{required:!0,message:"间距不能为空",trigger:"blur"},{type:"number",message:"请输入数字",trigger:"blur"}]}},[a("el-input-number",{attrs:{min:10,max:e.totalWidth,placeholder:"间距"},on:{change:e.setAllBlockWidth},model:{value:e.dynamicValidateForm.spacing,callback:function(t){e.$set(e.dynamicValidateForm,"spacing",t)},expression:"dynamicValidateForm.spacing"}})],1),a("el-form-item",{attrs:{label:"附加条件"}},[a("el-checkbox",{model:{value:e.dynamicValidateForm.hasPrice,callback:function(t){e.$set(e.dynamicValidateForm,"hasPrice",t)},expression:"dynamicValidateForm.hasPrice"}},[e._v("价格")]),a("el-checkbox",{attrs:{value:e.dynamicValidateForm.lengthwiseIs},on:{input:e.handleToggleLengthwise}},[e._v("纵向扩展布局")]),a("el-checkbox",{attrs:{value:e.dynamicValidateForm.isExpander},on:{input:e.handleToggleExpander}},[e._v("横向扩展布局")])],1),e._l(e.dynamicValidateForm.rows,function(t,n){return a("el-form-item",{key:t.key,staticClass:"blockList",attrs:{label:"第"+(n+1)+"行有几块"}},[a("el-form-item",{staticClass:"el-form-item__select",attrs:{prop:"rows."+n+".blockNum",rules:[{required:!0,message:"请选择行数",trigger:"blur"}]}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(a){return e.setBlockWidth(t)}},model:{value:t.blockNum,callback:function(a){e.$set(t,"blockNum",a)},expression:"row.blockNum"}},e._l(e.blockCount,function(t,n){return a("el-option",{key:n,attrs:{label:n+1+"块",value:n+1}},[e._v("\n            "+e._s(n+1)+" 块\n          ")])}),1)],1),a("el-form-item",{staticClass:"el-form-item__select el-form-item__height",attrs:{prop:"rows."+n+".height",rules:[{required:!0,message:"请输入高度",trigger:"blur"},{type:"number",min:0,message:"请输入不小于 0 的数字",trigger:"blur"}]}},[a("span",{staticClass:"title"},[e._v("高度")]),a("el-col",{attrs:{span:9}},[a("el-select",{attrs:{"allow-create":"",filterable:"","default-first-option":"",placeholder:"请选择"},model:{value:t.height,callback:function(a){e.$set(t,"height",e._n(a))},expression:"row.height"}},e._l(e.heightInit,function(t,n){return a("el-option",{key:n,attrs:{label:t,value:t}},[e._v(e._s(t))])}),1)],1)],1),a("el-form-item",{staticStyle:{"margin-right":"10px"}},[a("el-checkbox",{model:{value:t.hasTitle,callback:function(a){e.$set(t,"hasTitle",a)},expression:"row.hasTitle"}},[e._v("标题")])],1),t.blockWidth.length>0?a("el-form-item",{staticClass:"el-form-item__block-width"},[a("span",[e._v(" 宽度")]),e._l(t.blockWidth,function(i,r){return a("el-form-item",{key:r,attrs:{prop:"rows."+n+".blockWidth."+r,rules:[{required:!0,message:"请输入宽度",trigger:"blur"},{type:"number",min:0,message:"请输入不小于 0 的数字",trigger:"blur"}]}},[a("el-input",{on:{change:function(a){return e.handleCalSurplusWidth(t)}},model:{value:t.blockWidth[r],callback:function(a){e.$set(t.blockWidth,r,e._n(a))},expression:"row.blockWidth[i]"}})],1)}),a("span",[e._v("剩余的宽度="+e._s(t.surplusWidth)+"px")])],2):e._e(),a("el-form-item",{staticClass:"el-form-item__delete"},[a("el-col",{attrs:{span:2}},[n>0?a("el-button",{on:{click:function(t){return t.preventDefault(),e.handleRemoveRow(n)}}},[e._v("删除")]):e._e()],1)],1)],1)}),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handlePreviewLayout}},[e._v("预览布局")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleGenLayoutEnd}},[e._v("生成布局")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleDownloadLayout}},[e._v("导出布局文件")]),e.canHasMultiRow?a("el-button",{attrs:{type:"primary"},on:{click:e.handleAddRow}},[e._v("添加行数")]):e._e(),a("el-button",{attrs:{type:"primary"},on:{click:e.handleResetForm}},[e._v("重置")])],1)],2),a("section",[e.layoutForPreview.content.contents.length>0?a("LayoutBlock",{staticClass:"layoutBloack",attrs:{content:e.layoutForPreview.content.contents},on:{"change-width":e.changeWidth}}):e._e()],1)],1)},Gh=[],jh={components:{LayoutBlock:Mh["a"]},props:["layoutVersion","layoutSpacing","layoutWidth"],data:function(){return{dynamicValidateForm:{rows:[this.genRow()],spacing:this.layoutSpacing||40,hasPrice:!1,lengthwiseIs:!1,isExpander:!1},totalWidth:this.layoutWidth||1760,titleHeight:58,priceHeight:52,titleSize:32,x:0,y:0,heightInit:[130,150,200,247,300,346,360,365,398,423,448],layoutForPreview:this.genDefaultLayout()}},computed:{blockCount:function(){return this.dynamicValidateForm.isExpander?2:8},canHasMultiRow:function(){var e=this.dynamicValidateForm,t=e.isExpander,a=e.lengthwiseIs;return!(t||a)}},methods:{handleToggleExpander:function(e){var t=this.dynamicValidateForm,a=t.rows||[];e&&(t.lengthwiseIs=!1),t.isExpander=e,t.rows=a.slice(0,1);var n=t.rows[0];e&&n&&n.blockNum>2&&(n.blockNum=1,this.setBlockWidth(n))},handleToggleLengthwise:function(e){var t=this.dynamicValidateForm,a=t.rows||[];e&&(t.isExpander=!1),t.lengthwiseIs=e,t.rows=a.slice(0,1)},handleGenLayoutEnd:function(){var e=this;this.validateAndGenLayout(function(t){e.$emit("gen-end",{fileName:t.fileName,content:JSON.stringify(t.content)})})},genDefaultLayout:function(){return{fileName:"",content:{type:"Panel",parents:"",contents:[]}}},validateAndGenLayout:function(e){var t=this;this.$refs.dynamicValidateForm.validate(function(a){a?e(t.genLayout()):t.$message.error("请把表单填写完整")})},genLayout:function(){var e=this,t=this.layoutVersion||"v8",a=["A","B","C","D"],n=this.dynamicValidateForm,i=n.rows,r=n.hasPrice,o=n.spacing,l=n.lengthwiseIs,s=n.isExpander,c=i.length-1,u=i.reduce(function(e,t,n){return e+=a[n]+t.blockNum+"-"+t.height,t.hasTitle&&(e+="-title"),r&&(e+="-price"),e+=n<c?"-":".txt",e},""),d=i.reduce(function(t,a,n){var i=0,l=a.blockWidth.map(function(l,s){var c=parseInt(l),u={};return u.height=a.height,u.title_align=0,r?(u.parents="Block",u.type="Mall",u.mall_resize={x:i,y:parseInt(t.height),width:c,height:a.height+e.priceHeight}):(u.parents="",u.type="Block"),a.hasTitle&&(u.resize={x:i,y:parseInt(t.height),width:c,height:a.height+e.titleHeight},u.title_info={width:c,height:e.titleHeight,size:e.titleSize}),u.width=c,u.x=i,u.y=parseInt(t.height),u.whichRow=n,u.whichBlock=s,i=i+c+o,u}),s=a.hasTitle?a.height+e.titleHeight:a.height;return t.height=parseInt(t.height)+s+o,t.contents=t.contents.concat(l),t},{height:0,contents:[]}).contents,p=s?"Expander":l?"Lengthwise":"Panel",h={fileName:u,content:{type:p,contents:d,parents:"",version:t}};if("Expander"===p){var m=h.content.contents[0];h.content.extra={width:m.width,height:m.resize?m.resize.height:m.height,orientation:0,space:40}}return h},handleResetForm:function(){this.$refs.dynamicValidateForm.resetFields()},handleCalSurplusWidth:function(e){var t=+this.dynamicValidateForm.spacing,a=this.totalWidth,n=e.blockWidth.length,i=(n-1)*t,r=e.blockWidth.reduce(function(e,t){return e+parseInt(t)},0);e.surplusWidth=a-r-i},setBlockWidth:function(e){e.blockWidth=[],e.surplusWidth=0;for(var t=this.getBlockWidth(e.blockNum),a=0;a<e.blockNum;a++)e.blockWidth.push(t)},setAllBlockWidth:function(){var e=this;this.dynamicValidateForm.rows.forEach(function(t){e.setBlockWidth(t)})},changeLayout:function(){var e=this.dynamicValidateForm,t=e.rows||[];e.rows=t.slice(0,1)},changeWidth:function(e,t,a,n){},handlePreviewLayout:function(){var e=this;this.validateAndGenLayout(function(t){e.layoutForPreview=t})},onLayoutParamsChange:function(){var e=this.dynamicValidateForm,t=e.rows.every(function(e){return!(!e.blockNum||!e.height)&&e.blockWidth.every(function(e){return!!+e})});this.layoutForPreview=t?this.genLayout():this.genDefaultLayout()},getBlockWidth:function(e){return Math.floor((this.totalWidth-this.dynamicValidateForm.spacing*(e-1))/e)},genRow:function(){return{value:"",key:Date.now(),blockNum:null,height:null,hasTitle:!1,blockWidth:[],surplusWidth:0}},handleRemoveRow:function(e){this.dynamicValidateForm.rows.splice(e,1)},handleAddRow:function(){if(4===this.dynamicValidateForm.rows.length)return this.$message("最多添加4行");this.dynamicValidateForm.rows.push(this.genRow())},handleDownloadLayout:function(){this.validateAndGenLayout(function(e){var t=window.URL||window.webkitURL||window,a=new Blob([JSON.stringify(e.content)]),n=document.createElement("a");n.href=t.createObjectURL(a),n.download=e.fileName,n.click()})}},created:function(){this.onLayoutParamsChange=Object(Go["debounce"])(this.onLayoutParamsChange,300),this.$watch("dynamicValidateForm",{handler:this.onLayoutParamsChange,deep:!0})}},zh=jh,Wh=(a("8297"),Object(Yo["a"])(zh,Uh,Gh,!1,null,"1a71fecb",null)),qh=Wh.exports,Jh={mixins:[ds["a"]],components:{PageWrapper:eu["a"],PageContentWrapper:tu["a"],CommonContent:Ql["a"],Upload:Bo["Upload"],LayoutPreview:Mh["a"],LayoutInfoGenerator:qh},data:function(){return{activePage:"layout",mode:"create",resourceName:"布局",layoutTypeOptions:[],layoutTypeText:{},form:{layoutId:void 0,layoutName:null,layoutType:null,layout6GenMode:"auto",layoutJson:null,layoutJson8:null,layoutModel:null,layoutStatus:2},formRules:{layoutName:[{required:!0,message:"请输入布局名称",trigger:"blur"},{max:45,message:"不超过 45 个字符"}],layoutType:[{required:!0,message:"请输入布局类别",trigger:"blur"}],layoutJson8:[{required:!0,message:"请设置布局",trigger:"blur"}],layoutJson:[{required:!0,message:"请设置布局6.0",trigger:"blur"}]},content:[]}},props:["initMode","id"],computed:{resourceInfo:function(){var e=this.form;if(e.layoutId)return{id:e.layoutId,type:"layout",menuElId:"layoutInfo",version:e.currentVersion,status:e.layoutStatus}}},methods:{handleDownloadLayout:function(e){var t=window.URL||window.webkitURL||window,a=new Blob([JSON.stringify(e)]),n=document.createElement("a");n.href=t.createObjectURL(a),n.download=this.form.layoutName||"layout",n.click()},handleInputLayout6GenMode:function(e){var t=this.form;t.layout6GenMode=e,"manual"===e?t.layoutJson=null:this.setLayout6()},fetchData:function(e){this.$service.getLayoutInforById({id:this.id}).then(this.setLayoutInfo)},setLayoutInfo:function(e){this.form=Object.assign({},e,{layoutJson:JSON.parse(e.layoutJson),layoutJson8:JSON.parse(e.layoutJson8)})},handleSave:function(){var e=this;this.$refs.form.validate(function(t){if(t){var a=Object(Go["cloneDeep"])(e.form),n=a.layoutJson,i=a.layoutJson8,r="auto"===a.layout6GenMode;if(!r){var o=n.contents,l=i.contents,s=o.every(function(e,t){var a=l[t],n=a.width/a.height,i=e.width/e.height,r=Math.abs(n-i),o=r/n;return o<.005}),c=o.length===l.length;if(!s||!c)return e.$message({type:"error",message:"6.0布局和8.0布局推荐位数量必须相同，相同位置的推荐位长宽比例必须相同",duration:5e3})}a.layoutModel=n.type,a.layoutJson=JSON.stringify(n),a.layoutJson8=JSON.stringify(i),e.$service.getLayoutInforSave({jsonStr:JSON.stringify(a)},"保存成功").then(function(t){e.$emit("upsert-end")})}})},getLastFile:function(e){return e[e.length-1]},handleUpload:function(e,t,a){var n=this;this.$service.uploadLayoutFile({file:e,onUploadProgress:function(e){e.lengthComputable&&(t.percentage=e.loaded/e.total*100)}}).then(function(e){n.handleUploadEnd(e,a),t.status="success",t.percentage=0}).catch(function(e){t.status="error",t.message=e.message})},handleGenLayoutEnd:function(e,t){var a=this.form,n=e.fileName,i=e.content;i=JSON.parse(i),"v8"===t&&(a.layoutName=n.replace(".txt",""),this.form.layoutJson8=i,this.setLayout6()),"v6"===t&&(this.form.layoutJson=i),this.activePage="layout"},handleUploadEnd:function(e,t){var a=e.fileName,n=e.content,i=this.form;"v6"===t?i.layoutJson=n:(i.layoutName=a,i.layoutJson8=n,this.setLayout6())},setLayout6:function(){var e=this.form,t=e.layoutJson8;if(t&&"auto"===e.layout6GenMode)return this.$service.getLayoutVersion6({layoutJson8:JSON.stringify(t)}).then(function(t){e.layoutJson=t})},fetchLayoutTypeOptions:function(){var e=this;this.$service.getDictType({type:"layoutType"}).then(function(t){e.layoutTypeOptions=t,e.layoutTypeText=t.reduce(function(e,t){return e[t.dictId]=t.dictCnName,e},{})})}},created:function(){this.mode=this.initMode||"create",this.id&&this.fetchData(this.version),this.fetchLayoutTypeOptions()}},Hh=Jh,Kh=(a("5a82"),Object(Yo["a"])(Hh,Vh,Bh,!1,null,"552f8386",null)),Yh=Kh.exports,Qh={components:{LayoutInfoList:Ah,LayoutInfo:Yh},data:function(){return{mode:"list",isShowList:!0,id:void 0,version:void 0,editData:{},reviewData:{}}},methods:{handleCreate:function(){this.mode="create",this.id=void 0,this.isShowList=!1},handleEdit:function(e){this.id=e.layoutId,this.mode="edit",this.isShowList=!1},handleRead:function(e){this.id=e.layoutId,this.mode="read",this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.getLayoutInforBatchDel({id:e.map(function(e){return e.layoutId}).join(",")},"删除成功").then(function(e){t.$refs.list.fetchData()})},handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},Xh=Qh,Zh=(a("516d"),Object(Yo["a"])(Xh,Dh,Rh,!1,null,"1894eca0",null)),em=Zh.exports,tm=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("TabPage",[a("CommonPannelUserList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,read:e.handleRead,edit:e.handleEdit,copy:e.handleCopy}}),e.isShowList?e._e():a("PanelInfo",{attrs:{id:e.id,"panel-data-type":3,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},am=[],nm=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},im=[],rm={components:{ContentWrapper:Bo["ContentWrapper"],Table:Bo["Table"]},props:{dataList:{type:Object}},data:function(){var e=this;return{pannelStatusOption:[{label:"下架",value:"0"},{label:"上架",value:"1"},{label:"草稿",value:"2"},{label:"待审核",value:"3"},{label:"审核通过",value:"4"},{label:"审核不通过",value:"5"}],pannelStatus:{},filter:this.genDefaultFilter(),filterSchema:null,pagination:{currentPage:1},businessType:{},table:{props:{},data:[],header:[{label:"ID",prop:"pannelGroupId",width:100},{label:"名称",prop:"pannelGroupRemark",width:220,render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n)}}},n.pannelGroupRemark)}},{label:"布局",prop:"fullLayoutName"},{label:"业务分类",prop:"categoryName"},{label:"引用状态",prop:"fullTabName","show-overflow-tooltip":!0},{label:"版本/状态",prop:"pannelStatus",formatter:function(t){var a=t.pannelStatus,n=t.currentVersion;return n+"/"+e.pannelStatusOption.map(function(e){if(a.toString()===e.value)return e.label}).join("")}},{label:"待审核副本",prop:"duplicateVersion",render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n,n.duplicateVersion)}}},n.duplicateVersion)}},{label:"更新时间",prop:"lastUpdateDate","show-overflow-tooltip":!0},{label:"审核人",prop:"auditor"},{label:"更新人",prop:"userName"},{label:"操作",width:"100",fixed:"right",render:Bo["utils"].component.createOperationRender(this,{handleCopy:"复制",cancalCollect:"取消收藏"})}],selected:[],selectionType:"multiple"},selected:[]}},watch:{selected:{handler:function(e,t){var a=this.table,n=[];a.data.map(function(t){if(e.indexOf(t.pannelGroupId)>-1){var a={pannelGroupId:t.pannelGroupId,pannelGroupRemark:t.pannelGroupRemark,duplicateVersion:t.duplicateVersion};n.push(a)}}),this.$emit("input",n)}}},methods:{genDefaultFilter:function(){return{idPrefix:this.$consts.idPrefix}},handleCopy:function(e){var t=e.row;this.$emit("copy",t.pannelGroupId)},cancalCollect:function(e){var t=this,a=e.row;this.$service.collectCancel({type:"pannel",data:{resourceId:a.pannelGroupId}},"取消成功").then(function(){t.fetchData()})},handleRead:function(e,t){this.$emit("read",e.pannelGroupId,t)},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.collectionGetList({data:t,type:"albumPannel"}).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.pannelId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.dataList?this.filter=Object.assign({},this.dataList.filter):this.filter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},getBusinessType:function(){var e=this;return this.$service.getDictType({type:"businessType"}).then(function(t){t.forEach(function(t){e.businessType[t.dictCnName]=t.dictId})})},handleRowSelectionAdd:function(e){this.selected.push(e.pannelGroupId),this.updateTableSelected()},handleRowSelectionRemove:function(e){this.selected=this.selected.filter(function(t){return t!==e.pannelGroupId}),this.updateTableSelected()},handleAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleRowSelectionAdd):(this.selected=[],this.table.selected=[])},handleAllRowSelectionRemove:function(){this.selected=[],this.table.selected=[]},updateTableSelected:function(){var e=this.table,t=this.selected;e.selected=e.data.reduce(function(e,a,n){return t.indexOf(a.pannelGroupId)>-1&&e.push(n),e},[])}},created:function(){var e=this;this.pannelStatus=this.pannelStatusOption.reduce(function(e,t){return e[t.label]=t.value,e},{});var t=ll.a.map({pannelCategory:ll.a.o.enum(this.businessType).other("form",{placeholder:"业务分类",component:"Select"}),pannelId:ll.a.o.string.other("form",{placeholder:"ID",component:"Input"}),pannelName:ll.a.o.string.other("form",{placeholder:"版块名称",component:"Input"}),pannelTitle:ll.a.o.string.other("form",{placeholder:"版块标题",component:"Input"}),tabName:ll.a.o.string.other("form",{placeholder:"引用状态",component:"Input"}),pannelResource:ll.a.o.enum({"腾讯":"o_tencent","爱奇艺":"o_iqiyi","优酷":"o_youku"}).other("form",{placeholder:"内容源",component:"Select"}),pannelStatus:ll.a.o.enum(this.pannelStatus).other("form",{placeholder:"状态",component:"Select"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.getBusinessType().then(function(){e.dataList?e.filterSchema=a.filterSchema:e.filterSchema=t});var a=this.dataList;a&&(this.filter=Object.assign({},a.filter),this.table=a.table),this.fetchData()}},om=rm,lm=(a("2e70"),Object(Yo["a"])(om,nm,im,!1,null,"21848a22",null)),sm=lm.exports,cm={components:{TabPage:Il["a"],PanelInfo:Tu["a"],CommonPannelUserList:sm},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0}},methods:{handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e,this.mode="edit",this.isShowList=!1},handleRead:function(e,t){this.id=e,this.mode="read",this.version=t,this.isShowList=!1},handleCopy:function(e){this.id=e,this.mode="copy",this.isShowList=!1},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},um=cm,dm=Object(Yo["a"])(um,tm,am,!1,null,null,null),pm=dm.exports,hm=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("TabPage",[a("CommonPannelUserList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,read:e.handleRead,edit:e.handleEdit,copy:e.handleCopy}}),e.isShowList?e._e():a("PanelInfo",{attrs:{id:e.id,"panel-data-type":1,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},mm=[],fm=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},vm=[],gm={components:{ContentWrapper:Bo["ContentWrapper"],Table:Bo["Table"]},props:{dataList:{type:Object}},data:function(){var e=this;return{pannelStatusOption:[{label:"下架",value:"0"},{label:"上架",value:"1"},{label:"草稿",value:"2"},{label:"待审核",value:"3"},{label:"审核通过",value:"4"},{label:"审核不通过",value:"5"}],pannelStatus:{},filter:{sort:void 0,order:void 0,idPrefix:10},filterSchema:null,pagination:{currentPage:1},businessType:{},table:{props:{},data:[],header:[{label:"ID",prop:"pannelGroupId",width:100},{label:"名称",prop:"pannelGroupRemark",width:220,render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n)}}},n.pannelGroupRemark)}},{label:"布局",prop:"fullLayoutName"},{label:"业务分类",prop:"categoryName"},{label:"引用状态",prop:"fullTabName","show-overflow-tooltip":!0},{label:"版本/状态",prop:"pannelStatus",formatter:function(t){var a=t.pannelStatus,n=t.currentVersion;return n+"/"+e.$consts.statusText[a]}},{label:"待审核副本",prop:"duplicateVersion",render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n,n.duplicateVersion)}}},n.duplicateVersion)}},{label:"更新时间",prop:"lastUpdateDate","show-overflow-tooltip":!0},{label:"审核人",prop:"auditor"},{label:"更新人",prop:"userName"},{label:"操作",width:"120",fixed:"right",render:Bo["utils"].component.createOperationRender(this,{handleCopy:"复制",cancalCollect:"取消收藏"})}],selected:[],selectionType:"multiple"},selected:[]}},watch:{selected:{handler:function(e,t){var a=this.table,n=[];a.data.map(function(t){if(e.indexOf(t.pannelGroupId)>-1){var a={pannelGroupId:t.pannelGroupId,pannelGroupRemark:t.pannelGroupRemark,duplicateVersion:t.duplicateVersion};n.push(a)}}),this.$emit("input",n)}}},methods:{handleCopy:function(e){var t=e.row;this.$emit("copy",t.pannelGroupId)},cancalCollect:function(e){var t=this,a=e.row;this.$service.collectCancel({type:"pannel",data:{resourceId:a.pannelGroupId}},"取消成功").then(function(){t.fetchData()})},handleRead:function(e,t){this.$emit("read",e.pannelGroupId,t)},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.collectionGetList({data:t,type:"pannel"}).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.pannelId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){console.log(this.dataList),this.dataList?(this.filter=Object.assign({},this.dataList.filter),console.log(this.filter)):this.filter={sort:void 0,order:void 0,idPrefix:10},this.pagination.currentPage=1,this.fetchData()},getBusinessType:function(){var e=this;return this.$service.getDictType({type:"businessType"}).then(function(t){t.forEach(function(t){e.businessType[t.dictCnName]=t.dictId})})},handleRowSelectionAdd:function(e){this.selected.push(e.pannelGroupId),this.updateTableSelected()},handleRowSelectionRemove:function(e){this.selected=this.selected.filter(function(t){return t!==e.pannelGroupId}),this.updateTableSelected()},handleAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleRowSelectionAdd):(this.selected=[],this.table.selected=[])},handleAllRowSelectionRemove:function(){this.selected=[],this.table.selected=[]},updateTableSelected:function(){var e=this.table,t=this.selected;e.selected=e.data.reduce(function(e,a,n){return t.indexOf(a.pannelGroupId)>-1&&e.push(n),e},[])},addTabInfo:function(){},editData:function(){},batchDel:function(){}},created:function(){var e=this;this.pannelStatus=this.pannelStatusOption.reduce(function(e,t){return e[t.label]=t.value,e},{});var t=ll.a.map({pannelCategory:ll.a.o.enum(this.businessType).other("form",{placeholder:"业务分类",component:"Select"}),pannelId:ll.a.o.string.other("form",{placeholder:"ID",component:"Input"}),pannelName:ll.a.o.string.other("form",{placeholder:"版块名称",component:"Input"}),pannelTitle:ll.a.o.string.other("form",{placeholder:"版块标题",component:"Input"}),tabName:ll.a.o.string.other("form",{placeholder:"引用状态",component:"Input"}),pannelResource:ll.a.o.enum({"腾讯":"o_tencent","爱奇艺":"o_iqiyi","优酷":"o_youku"}).other("form",{placeholder:"内容源",component:"Select"}),pannelStatus:ll.a.o.enum(this.pannelStatus).other("form",{placeholder:"状态",component:"Select"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.getBusinessType().then(function(){e.dataList?e.filterSchema=a.filterSchema:e.filterSchema=t});var a=this.dataList;a&&(this.filter=Object.assign({},a.filter),this.table=a.table),this.fetchData()}},bm=gm,ym=Object(Yo["a"])(bm,fm,vm,!1,null,null,null),wm=ym.exports,Im={components:{TabPage:Il["a"],PanelInfo:Tu["a"],CommonPannelUserList:wm},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0}},methods:{handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e,this.mode="edit",this.isShowList=!1},handleRead:function(e,t){this.id=e,this.mode="read",this.version=t,this.isShowList=!1},handleCopy:function(e){this.id=e,this.mode="copy",this.isShowList=!1},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},Cm=Im,Tm=Object(Yo["a"])(Cm,hm,mm,!1,null,null,null),Sm=Tm.exports,km=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("TabInfo",{attrs:{"list-props":{isCollectionPage:!0}}})},_m=[],Pm=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("TabPage",[a("TabInfoList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",attrs:{"list-props":e.listProps},on:{create:e.handleCreate,read:e.handleRead,edit:e.handleEdit,copy:e.handleCopy,delete:e.handleDelete}}),e.isShowList?e._e():a(e.tabInfoComponent,{tag:"component",attrs:{"content-props":e.contentProps,id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},xm=[],Fm=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{ref:"contentCard",staticClass:"content"},[a("ContentWrapper",{attrs:{pagination:e.pagination},on:{"filter-change":e.fetchData}},[a("el-form",{directives:[{name:"form-autocomplete",rawName:"v-form-autocomplete"}],ref:"form",staticClass:"form",attrs:{inline:"","label-width":"90px"},nativeOn:{submit:function(t){return e.handleFilterChange(t)},reset:function(t){return e.handleFilterReset(t)}},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("el-form-item",{staticClass:"el-col-6"},[a("InputPositiveInt",{attrs:{clearable:"",name:"tabId",autocomplete:"on",placeholder:"版面ID"},model:{value:e.filter.tabId,callback:function(t){e.$set(e.filter,"tabId",t)},expression:"filter.tabId"}})],1),a("el-form-item",{staticClass:"el-col-6"},[a("el-input",{attrs:{clearable:"",name:"tabName",autocomplete:"on",placeholder:"版面标题"},model:{value:e.filter.tabName,callback:function(t){e.$set(e.filter,"tabName",t)},expression:"filter.tabName"}})],1),a("el-form-item",{staticClass:"el-col-6"},[a("el-select",{attrs:{filterable:"",placeholder:"版面属性",clearable:""},model:{value:e.filter.tabType,callback:function(t){e.$set(e.filter,"tabType",t)},expression:"filter.tabType"}},e._l(e.tabTypeOption,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{staticClass:"el-col-6"},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"是否二级tab"},model:{value:e.filter.hasSubTab,callback:function(t){e.$set(e.filter,"hasSubTab",t)},expression:"filter.hasSubTab"}},[a("el-option",{attrs:{value:"1",label:"是"}}),a("el-option",{attrs:{value:"0",label:"否"}})],1)],1),a("el-form-item",{staticClass:"el-col-6"},[a("el-select",{attrs:{filterable:"",placeholder:"业务分类",clearable:""},model:{value:e.filter.tabCategory,callback:function(t){e.$set(e.filter,"tabCategory",t)},expression:"filter.tabCategory"}},e._l(e.businessType,function(e,t){return a("el-option",{key:t,attrs:{label:e.dictCnName,value:e.dictId}})}),1)],1),a("el-form-item",{staticClass:"el-col-6"},[a("el-select",{attrs:{filterable:"",placeholder:"AppId",clearable:""},model:{value:e.filter.tabAppid,callback:function(t){e.$set(e.filter,"tabAppid",t)},expression:"filter.tabAppid"}},e._l(e.appIdType,function(e){return a("el-option",{key:e.dictEnName,attrs:{label:e.dictCnName,value:e.dictEnName}})}),1)],1),a("el-form-item",{staticClass:"el-col-6"},[a("el-select",{attrs:{filterable:"",placeholder:"状态",clearable:""},model:{value:e.filter.tabStatus,callback:function(t){e.$set(e.filter,"tabStatus",t)},expression:"filter.tabStatus"}},e._l(e.tabStatusOption,function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1),"10"!=e.$consts.idPrefix?a("el-form-item",{staticClass:"el-col-6"},[a("el-select",{attrs:{filterable:"",placeholder:"数据来源"},model:{value:e.filter.idPrefix,callback:function(t){e.$set(e.filter,"idPrefix",t)},expression:"filter.idPrefix"}},[a("el-option",{attrs:{value:"10",label:"酷开"}}),a("el-option",{attrs:{value:"11",label:"江苏广电"}})],1)],1):e._e(),a("el-form-item",{staticClass:"el-form-item-submit"},[a("el-button",{attrs:{type:"primary","native-type":"submit"}},[e._v("查询")]),a("el-button",{attrs:{"native-type":"reset"}},[e._v("重置")])],1)],1),e.listProps.isCollectionPage?e._e():a("ButtonGroupForListPage",{attrs:{pageName:"tab"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},Dm=[],Rm={extends:Sl["a"],components:{ContentWrapper:Bo["ContentWrapper"],Table:Bo["Table"],ButtonGroupForListPage:kl["a"],InputPositiveInt:vs["a"]},data:function(){var e=this;return{canAdd:!1,resourceType:"tabInfo",selected:[],tabTypeOption:[{label:"第三方版面",value:"4"},{label:"专题版面",value:"2"},{label:"普通版面",value:"1"},{label:"分页专题版面",value:"13"}],tabStatusOption:[{label:"下架",value:"0"},{label:"上架",value:"1"},{label:"草稿",value:"2"},{label:"待审核",value:"3"},{label:"审核通过",value:"4"},{label:"审核不通过",value:"5"}],businessType:[],filter:this.genDefaultFilter(),efficientFilter:this.genDefaultFilter(),appIdType:[],filterSchema:null,pagination:{currentPage:1},table:{props:{},data:[],header:[{label:"ID",prop:"tabId"},{label:"名称",prop:"tabName","show-overflow-tooltip":!0,render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n)}}},n.tabName)}},{label:"版面属性",prop:"tabType",formatter:function(e){var t=e.tabType;return{1:"普通版面",2:"专题版面",4:"第三方版面",5:"信号源版面",13:"分页专题版面"}[t+""]||"未知版面"}},{label:"业务分类",prop:"businessCategoryName"},{label:"内容源",prop:"tabResource",formatter:function(t){return e.$consts.sourceText[t.tabResource]||""}},{label:"AppId",prop:"tabAppid",formatter:function(t){return e.appIdType.map(function(e){if(t.tabAppid.toString()===e.dictEnName)return e.dictCnName})}},{label:"版本/状态",prop:"tabStatus",formatter:function(t){var a=t.tabStatus,n=t.currentVersion;return n+"/"+e.tabStatusOption.map(function(e){if(a.toString()===e.value)return e.label}).join("")}},{label:"待审核副本",prop:"duplicateVersion",render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n,n.duplicateVersion)}}},n.duplicateVersion)}},{label:"更新时间",prop:"lastUpdateDate",width:140},{label:"审核人",prop:"auditor",width:100},{label:"更新人",prop:"modifierName",width:100},{label:"操作",width:180,fixed:"right",render:function(t,a){var n=a.row;return t("div",[e.canAdd&&t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleCopy(n)}}},"复制"),t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleToggleCollect(n)}}},[t("el-icon",{class:n.collected?"el-icon-star-on":"el-icon-star-off"}),n.collected?"取消":"收藏"]),!!n.showContentAuthSettingBtn&&t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleOpenContentAuthManager(n)}}},"内容权限")])}}],selected:[],selectionType:"multiple"}}},props:{listProps:{type:Object,default:function(){return{isCollectionPage:!1}}}},methods:{preventSubmit:function(e){e.preventDefault()},handleOpenContentAuthManager:function(e){this.$refs.contentCard.handleShowContentAuthManager({id:e.tabId,type:"tab",menuElId:"tabInfo"})},genDefaultFilter:function(){return{idPrefix:this.$consts.idPrefix}},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();if(t.tabId&&!/^\d+$/.test(t.tabId))return this.$message({type:"error",message:"ID 必须为正整数"});this.listProps.isCollectionPage?this.$service.collectionGetList({type:"tab",data:t}).then(function(t){e.pagination.total=t.total,e.table.data=t.rows}):this.$service.tabInfoList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.pagination,t=JSON.parse(JSON.stringify(this.efficientFilter));return e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(){this.pagination.currentPage=1,this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.fetchData()},handleFilterReset:function(){this.filter=this.genDefaultFilter(),this.efficientFilter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},addTabInfo:function(){this.$emit("create")},editData:function(){var e=this.table,t=this.table.selected,a=e.data[t[0]];this.$emit("edit",a)},getBusinessType:function(){var e=this;this.$service.getDictType({type:"businessType"}).then(function(t){e.businessType=t})},handleToggleCollect:function(e){var t=this;e.collected?this.$service.collectCancel({type:"tab",data:{resourceId:e.tabId}},"取消收藏成功").then(function(){t.$set(e,"collected",!1)}):this.$service.collect({type:"tab",data:{resourceId:e.tabId}},"收藏成功").then(function(){t.$set(e,"collected",!0)})}},created:function(){var e=this;this.$service.getDictType({type:"appIdType"}).then(function(t){e.appIdType=t,e.fetchData()}),this.getBusinessType(),this.$service.getButtonGroupForPageList("tab").then(function(t){e.canAdd=t.some(function(e){return"add"===e.runComm})})}},Lm=Rm,$m=(a("1443"),Object(Yo["a"])(Lm,Fm,Dm,!1,null,"0d6f9ee4",null)),Nm=$m.exports,Em=a("2956"),Om=a("a36a"),Am={components:{TabPage:Il["a"],TabInfoList:Nm,TabInfo:Em["a"],JDTabInfo:Om["a"]},data:function(){return{isShowList:!0,id:null,mode:"create",version:void 0}},props:["listProps","contentProps"],computed:{tabInfoComponent:function(){var e=this.id;return e&&0===e.toString().indexOf("JD")?"JDTabInfo":"TabInfo"}},methods:{handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e.tabId,this.mode="edit",this.isShowList=!1,4===e.tabType&&(this.id=e.tabRemark)},handleRead:function(e,t){this.id=e.tabId,this.mode="read",this.version=t,this.isShowList=!1,4===e.tabType&&(this.id=e.tabRemark)},handleCopy:function(e){this.id=e.tabId,this.mode="copy",this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.tabInfoRemove({id:e.map(function(e){return e.tabId}).join(",")},"删除成功").then(function(){t.$refs.list.fetchData()})},handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},goBack:function(){this.isShowList=!0,this.mode="list"}}},Vm=Am,Bm=Object(Yo["a"])(Vm,Pm,xm,!1,null,null,null),Mm=Bm.exports,Um={components:{TabInfo:Mm}},Gm=Um,jm=Object(Yo["a"])(Gm,km,_m,!1,null,"432a3f76",null),zm=jm.exports,Wm={},qm=Object(Yo["a"])(Wm,oc,lc,!1,null,null,null),Jm=qm.exports,Hm=a("ce71"),Km=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PageWrapper",[a("PageContentWrapper",{directives:[{name:"show",rawName:"v-show",value:"homepage_list"==e.activePage,expression:"activePage == 'homepage_list'"}]},[a("ContentCard",{ref:"contentCard",staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"homepage"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}}),a("el-dialog",{attrs:{title:"机型机芯",visible:e.showChipDialog},on:{"update:visible":function(t){e.showChipDialog=t}}},[a("div",{staticClass:"tag-list tag-list__chip"},e._l(e.chips,function(t,n){return a("span",{key:n,staticClass:"tag-item"},[e._v("\n                "+e._s(t)+"\n            ")])}),0)]),a("el-dialog",{attrs:{title:"关联策略",visible:e.showPolicyNameDialog},on:{"update:visible":function(t){e.showPolicyNameDialog=t}}},[a("div",{staticClass:"tag-list tag-list__policy-name"},e._l(e.policyNames,function(t,n){return a("span",{key:n,staticClass:"tag-item",on:{click:function(a){return e.handleShowPolicy(t)}}},[e._v("\n                "+e._s(t)+"\n            ")])}),0)])],1)],1)],1),"policy"==e.activePage?a("PageContentWrapper",[a("Policy",{attrs:{"init-mode":"read",id:e.policyId},on:{"upsert-end":e.handleShowPolicyEnd,"go-back":e.handleShowPolicyEnd}})],1):e._e()],1)},Ym=[],Qm=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PageWrapper",{staticClass:"policy-info-wrapper"},[a("PageContentWrapper",{directives:[{name:"show",rawName:"v-show",value:"policy_info"===e.activePage,expression:"activePage === 'policy_info'"}]},[a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("CommonContent",{attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{replicate:function(t){e.mode="replicate"},edit:function(t){e.mode="edit"},unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,"submit-audit":function(t){return e.submitBtn(3)},"save-draft":function(t){return e.submitBtn(2)},audit:function(t){return e.$emit("upsert-end")},"select-version":e.fetchData,delete:function(t){return e.$emit("upsert-end",t)}}},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),"read"!==e.mode?a("div",[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:24}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.formRules,"label-width":"160px"}},[a("el-form-item",{attrs:{label:"策略名称",prop:"policyName"}},[e.isChildPolicy?[e._v("\n                    "+e._s(e.form.policyName)+"\n                  ")]:a("el-input",{attrs:{placeholder:"策略名称"},model:{value:e.form.policyName,callback:function(t){e.$set(e.form,"policyName",t)},expression:"form.policyName"}})],2),a("el-form-item",{attrs:{label:"机型机芯",prop:"chipModel"}},[a("DeviceSelector",{attrs:{title:"选择机芯机型","init-selected":e.form.deviceInfos,platform:e.form.platform||"tencent","selection-type":"create"===e.mode?"multiple":"single"},on:{"select-end":e.handleSelectChipEnd}}),e.form.deviceInfos.length>0?a("SelectedTag",[a("ul",e._l(e.form.deviceInfos,function(t,n){return a("li",{key:n},[a("el-tag",{attrs:{type:"success",closable:""},on:{close:function(a){return e.modelChipSelectedRemove(t)}}},[e._v(e._s(t.model)+"_"+e._s(t.chip))])],1)}),0)]):e._e()],1),a("el-form-item",{staticClass:"linkwork",attrs:{label:"首页版本号",required:""}},[a("el-col",{staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:11}},[a("el-form-item",{attrs:{prop:"homePageVerStart"}},[a("el-input-number",{attrs:{min:0,max:9999999},model:{value:e.form.homePageVerStart,callback:function(t){e.$set(e.form,"homePageVerStart",t)},expression:"form.homePageVerStart"}})],1)],1),a("el-col",{staticClass:"line",staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:2}},[e._v("-")]),a("el-col",{staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:11}},[a("el-form-item",{attrs:{prop:"homePageVerEnd"}},[a("el-input-number",{attrs:{min:0,max:9999999},model:{value:e.form.homePageVerEnd,callback:function(t){e.$set(e.form,"homePageVerEnd",t)},expression:"form.homePageVerEnd"}})],1)],1)],1),e.isTestPolicy?a("el-form-item",{staticClass:"linkwork",attrs:{label:"Mac地址",prop:"macStart"}},[a("el-input",{attrs:{placeholder:"Mac地址"},model:{value:e.form.macStart,callback:function(t){e.$set(e.form,"macStart",t)},expression:"form.macStart"}})],1):a("el-form-item",{staticClass:"linkwork",attrs:{label:"Mac地址"}},[a("el-col",{staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:11}},[a("el-form-item",{attrs:{prop:"macStart"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"Mac地址起始"},model:{value:e.form.macStart,callback:function(t){e.$set(e.form,"macStart",t)},expression:"form.macStart"}})],1)],1),a("el-col",{staticClass:"line",staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:2}},[e._v("-")]),a("el-col",{staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:11}},[a("el-form-item",{attrs:{prop:"macEnd"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"Mac地址结尾"},model:{value:e.form.macEnd,callback:function(t){e.$set(e.form,"macEnd",t)},expression:"form.macEnd"}})],1)],1)],1),a("el-form-item",{attrs:{label:"策略优先级",prop:"priority"}},[a("el-input-number",{attrs:{placeholder:"策略优先级",min:1,max:9999},model:{value:e.form.priority,callback:function(t){e.$set(e.form,"priority",t)},expression:"form.priority"}}),a("span",{staticClass:"tip"},[e._v("注：数值越大优先级越高，数值越小优先级越低")])],1),a("el-form-item",{attrs:{label:"关联首页方案"}},[a("HomepageSelector",{attrs:{title:"选择首页方案",homepageModel:"normal","selection-type":"single"},on:{"select-end":e.handleSelectNormalHomepageEnd}}),e.form.normalHpList[0]?a("span",{staticClass:"tip"},[e._v("\n                    已选首页：\n                    "),a("el-tag",{staticClass:"el-tag",attrs:{type:"success"},nativeOn:{click:function(t){return e.showHomePageDetail(e.form.normalHpList[0])}}},[e._v("\n                      "+e._s(e.form.normalHpList[0].homepageName)+"\n                    ")])],1):e._e()],1),a("el-form-item",{attrs:{label:"关联儿童首页方案"}},[a("HomepageSelector",{attrs:{title:"选择儿童首页方案",homepageModel:"child"},on:{"select-end":e.handleSelectChildHomepageEnd}}),a("div",{staticClass:"child-homepage-list"},e._l(e.form.childHpList,function(t,n){return a("div",{key:n,staticClass:"child-homepage-item"},[a("el-form-item",{attrs:{label:"首页方案","label-width":"80px"}},[e._v("\n                        "+e._s(t.homepageName)+"\n                      ")]),a("el-form-item",{attrs:{label:"年龄","label-width":"80px"}},[a("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:t.age,callback:function(a){e.$set(t,"age",a)},expression:"item.age"}},e._l(e.ageOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("i",{staticClass:"el-icon-close",on:{click:function(t){return e.handleRemoveChildHpItem(n)}}})],1)}),0)],1),a("el-form-item",{attrs:{label:"定向首页方案"}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.addHomePage("normal")}}},[e._v("添加")]),a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleRemoveAllSpecHomePage}},[e._v("解绑所有方案")]),e.form.specialNormalHp.length>0?a("SelectedHomePage",{attrs:{dataArr:e.form.specialNormalHp,title:"标准模式",mode:e.mode},on:{"edit-item":e.editHomePage,"remove-item":e.removeHomePage}}):e._e()],1)],1)],1)],1)],1):e._e(),"read"===e.mode?a("div",[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:24}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"160px"}},[a("el-form-item",{attrs:{label:"策略名称",prop:"policyName"}},[e._v(e._s(e.form.policyName))]),a("el-form-item",{attrs:{label:"机型机芯",prop:"chipModel"}},[e.form.deviceInfos.length>0?a("SelectedTag",[a("ul",e._l(e.form.deviceInfos,function(t,n){return a("li",{key:n},[a("el-tag",{attrs:{type:"success"}},[e._v(e._s(t.model)+"_"+e._s(t.chip))])],1)}),0)]):e._e()],1),a("el-form-item",{staticClass:"linkwork",attrs:{label:"首页版本号",required:""}},[a("el-col",{staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:11}},[a("el-form-item",{attrs:{prop:"homePageVerStart"}},[a("el-input-number",{attrs:{disabled:"disabled",min:0,max:9999999},model:{value:e.form.homePageVerStart,callback:function(t){e.$set(e.form,"homePageVerStart",t)},expression:"form.homePageVerStart"}})],1)],1),a("el-col",{staticClass:"line",staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:2}},[e._v("-")]),a("el-col",{staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:11}},[a("el-form-item",{attrs:{prop:"homePageVerEnd"}},[a("el-input-number",{attrs:{disabled:"disabled",min:0,max:9999999},model:{value:e.form.homePageVerEnd,callback:function(t){e.$set(e.form,"homePageVerEnd",t)},expression:"form.homePageVerEnd"}})],1)],1)],1),a("el-form-item",{staticClass:"linkwork",attrs:{label:"Mac地址",required:""}},[a("el-col",{staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:11}},[a("el-form-item",{attrs:{prop:"macStart"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"Mac地址起始",disabled:"disabled"},model:{value:e.form.macStart,callback:function(t){e.$set(e.form,"macStart",t)},expression:"form.macStart"}})],1)],1),a("el-col",{staticClass:"line",staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:2}},[e._v("-")]),a("el-col",{staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:11}},[a("el-form-item",{attrs:{prop:"macEnd"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"Mac地址起始",disabled:"disabled"},model:{value:e.form.macEnd,callback:function(t){e.$set(e.form,"macEnd",t)},expression:"form.macEnd"}})],1)],1)],1),a("el-form-item",{attrs:{label:"策略优先级",prop:"priority"}},[e._v("\n                  "+e._s(e.form.priority)+"\n                  "),a("span",{staticClass:"tip"},[e._v("注：数值越大优先级越高，数值越小优先级越低")])]),a("el-form-item",{attrs:{label:"关联首页方案"}},[e.form.normalHpList[0]?a("span",{staticClass:"tip"},[e._v("\n                    已选首页：\n                    "),a("el-tag",{staticClass:"el-tag",attrs:{type:"success"},nativeOn:{click:function(t){return e.showHomePageDetail(e.form.normalHpList[0])}}},[e._v("\n                      "+e._s(e.form.normalHpList[0].homepageName)+"\n                    ")])],1):e._e()]),a("el-form-item",{attrs:{label:"关联儿童首页方案"}},[a("div",{staticClass:"child-homepage-list"},e._l(e.form.childHpList,function(t,n){return a("div",{key:n,staticClass:"child-homepage-item"},[a("el-form-item",{attrs:{label:"首页方案","label-width":"80px"}},[e._v("\n                        "+e._s(t.homepageName)+"\n                      ")]),a("el-form-item",{attrs:{label:"年龄","label-width":"80px"}},[e._v("\n                        "+e._s(e.ageEnums[t.age])+"\n                      ")])],1)}),0)]),a("el-form-item",{attrs:{label:"定向首页方案"}},[e.form.specialNormalHp.length>0?a("SelectedHomePage",{attrs:{dataArr:e.form.specialNormalHp,mode:e.mode,title:"标准模式"},on:{"edit-item":e.editHomePage,"remove-item":e.removeHomePage}}):e._e()],1)],1)],1)],1)],1):e._e()]),e.addHomePageDialogVisible?a("PolicyManageAddHomePage",{attrs:{itemType:e.dialogType,"selected-crowds":e.selectedCrowds,editHomePageData:e.editHomePageData},on:{"add-home-page-close":e.addHomePageClose,"create-home-page":e.createHomePage}}):e._e()],1)],1),"showHomePageDetail"===e.activePage?a("PageContentWrapper",[a("HomePageInfo",{attrs:{id:e.homePageId,"init-mode":"read",version:e.homePageVersion,"title-prefix":e.title},on:{"upsert-end":function(t){e.activePage="policy_info"},"go-back":function(t){e.activePage="policy_info"}}})],1):e._e()],1)},Xm=[],Zm=a("75fc"),ef=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("RemoteSelectorWrapper",{ref:"wrapper",attrs:{title:e.title,"custom-class":"resource-selector",disabled:e.disabled,"is-live":e.isLive},on:{"select-start":e.handleSelectStart},scopedSlots:e._u([{key:"content",fn:function(t){var n=t.isShow;return[e.isLive||n?a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"devParId","selection-type":e.selectionType,"select-end-on-click":!0,table:e.table,filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"pagination-change":e.fetchData,"filter-change":e.handleFilterChange,"filter-reset":e.handleResetFilter,"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd},scopedSlots:e._u([{key:"filter",fn:function(t){var n=t.selected;return a("div",{},[a("el-form",{attrs:{inline:!0,model:e.filter}},[a("el-form-item",[a("el-select",{attrs:{value:e.filter.platform,placeholder:"内容源"},on:{input:e.handleInputPlatform}},[a("el-option",{attrs:{label:"爱奇艺",value:"yinhe"}}),a("el-option",{attrs:{label:"腾讯",value:"tencent"}}),a("el-option",{attrs:{label:"优朋",value:"voole"}}),a("el-option",{attrs:{label:"优酷",value:"youku"}})],1)],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"机型"},model:{value:e.filter.model,callback:function(t){e.$set(e.filter,"model","string"===typeof t?t.trim():t)},expression:"filter.model"}},[e._v(">")])],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"机芯"},model:{value:e.filter.chip,callback:function(t){e.$set(e.filter,"chip","string"===typeof t?t.trim():t)},expression:"filter.chip"}},[e._v(">")])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleResetFilter}},[e._v("重置")])],1)],1),a("el-form",{ref:"form",staticClass:"chip-add",attrs:{inline:!0,model:e.form,rules:e.formRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"内容源",prop:"platform"}},[a("el-select",{attrs:{placeholder:"内容源"},model:{value:e.form.platform,callback:function(t){e.$set(e.form,"platform",t)},expression:"form.platform"}},[a("el-option",{attrs:{label:"爱奇艺",value:"yinhe"}}),a("el-option",{attrs:{label:"腾讯",value:"tencent"}}),a("el-option",{attrs:{label:"优朋",value:"voole"}}),a("el-option",{attrs:{label:"优酷",value:"youku"}})],1)],1),a("el-form-item",{attrs:{label:"机型",prop:"model"}},[a("el-input",{attrs:{placeholder:"机型"},model:{value:e.form.model,callback:function(t){e.$set(e.form,"model","string"===typeof t?t.trim():t)},expression:"form.model"}},[e._v(">")])],1),a("el-form-item",{attrs:{label:"机芯",prop:"chip"}},[a("el-input",{attrs:{placeholder:"机芯"},model:{value:e.form.chip,callback:function(t){e.$set(e.form,"chip","string"===typeof t?t.trim():t)},expression:"form.chip"}},[e._v(">")])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.addModelChip}},[e._v("添加机芯")])],1)],1),a("div",[e._v("\n            选中的机型机芯\n            "),e._l(n,function(t){return a("el-tag",{key:t.chip+t.devParId,staticClass:"selected-item",attrs:{type:"success",closable:""},on:{close:function(a){return e.handleRowSelectionRemove(t)}}},[e._v("\n              "+e._s(t.model)+"_"+e._s(t.chip)+"\n            ")])})],2)],1)}}],null,!0)}):e._e()]}}])})},tf=[],af=a("a1fe"),nf=a("42f0"),rf={data:function(){var e=this;return{options:[],pagination:{currentPage:1,pageSize:15,total:0},form:this.genDefaultFormData(),formRules:{platform:[{required:!0,message:"请选择",trigger:"blur"}],model:[{required:!0,message:"请输入机型",trigger:"blur"}],chip:[{required:!0,message:"请输入机芯",trigger:"blur"}]},filter:this.genDefaultFilter(),effectiveFilter:this.genDefaultFilter(),filterSchema:null,table:{data:[],selected:[],header:[{label:"ID",prop:"devParId"},{label:"内容源",prop:"platform",render:function(t,a){var n=a.row;return e.$platform(n.platform)}},{label:"机芯",prop:"chip"},{label:"机型",prop:"model"}],selectionType:"multiple",props:{"tooltip-effect":"dark"}}}},props:["title","disabled","isLive","source","selectionType","platform","initSelected"],computed:{},components:{RemoteSelectorWrapper:af["a"],BaseSelector:nf["a"]},methods:{genDefaultFormData:function(){return{platform:void 0,model:void 0,chip:void 0}},handleInputPlatform:function(e){var t=this;this.$confirm("是否要切换内容源，切换内容源之后，首页方案数据将会清除掉","提示").then(function(){t.filter.platform=e,t.$refs.baseSelector.clearSelected()}).catch(function(){})},addModelChip:function(){var e=this;this.$refs.form.validate(function(t){t&&e.$service.addChipAndModel(e.form,"添加成功").then(function(t){e.fetchData(),e.form=e.genDefaultFormData()})})},handleSelectStart:function(){var e=this;this.$emit("select-start"),this.isLive?this.fetchData():this.handleResetFilter();var t=this.initSelected;t&&this.$nextTick(function(){var a=e.$refs.baseSelector;a.selected=t.filter(function(e){return e.devParId}),a.updateTableSelected()})},handleSelectCancel:function(){this.$refs.wrapper.handleSelectCancel()},handleSelectEnd:function(e){this.$emit("select-end",e),this.$refs.wrapper.handleSelectEnd()},genDefaultFilter:function(){return{platform:this.platform,chip:void 0,model:void 0}},handleFilterChange:function(){this.effectiveFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleResetFilter:function(){this.filter=this.genDefaultFilter(),this.effectiveFilter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=JSON.parse(JSON.stringify(this.effectiveFilter)),a=this.pagination;a&&(t.page=a.currentPage,t.rows=a.pageSize),this.$service.getChipAndModelPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){}},of=rf,lf=(a("03ee"),Object(Yo["a"])(of,ef,tf,!1,null,"47e4c60d",null)),sf=lf.exports,cf=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"selectedItem",style:{maxHeight:e.maxHeight}},[e._t("default")],2)},uf=[],df={props:{maxHeight:String},data:function(){return{}}},pf=df,hf=(a("8108"),Object(Yo["a"])(pf,cf,uf,!1,null,"6f88692e",null)),mf=hf.exports,ff=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:"添加定向首页方案",visible:e.dialogVisible,width:"80%","before-close":e.addHomePageClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{attrs:{"label-width":"120px"}},[a("el-form-item",{attrs:{label:"模式"}},[e._v(e._s("normal"===e.itemType?"标准模式":"儿童模式"))]),a("el-form-item",{attrs:{label:"人群"}},[a("el-button",{on:{click:e.handleSelectCrowdStart}},[e._v("选择人群")]),a("span",{directives:[{name:"show",rawName:"v-show",value:e.form.attribute&&e.form.attribute.crowdIds,expression:"form.attribute && form.attribute.crowdIds"}],staticClass:"marginL"},[e._v("已选择: "+e._s(e.form.attribute.crowdName)+"\n       ")])],1),a("el-form-item",{attrs:{label:"首页方案"}},[a("el-button",{on:{click:function(t){return e.handleSelectHomePageStart()}}},[e._v("选择首页")]),a("span",{directives:[{name:"show",rawName:"v-show",value:e.form.homepageName,expression:"form.homepageName"}],staticClass:"marginL"},[e._v("已选择: "+e._s(e.form.homepageName))])],1),a("el-form-item",{attrs:{label:"AB测试"}},[a("el-switch",{attrs:{"on-text":"开启","off-text":"关闭"},model:{value:e.form.useABTest,callback:function(t){e.$set(e.form,"useABTest",t)},expression:"form.useABTest"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.form.useABTest,expression:"form.useABTest"}],attrs:{label:"测试组"}},[e._l(e.form.testHomeList,function(t,n){return a("el-form",{key:n,staticClass:"test-group",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"编号"}},[a("el-select",{model:{value:t.distributeModel,callback:function(a){e.$set(t,"distributeModel",a)},expression:"testItem.distributeModel"}},[a("el-option",{attrs:{label:"A",value:"A"}}),a("el-option",{attrs:{label:"B",value:"B"}}),a("el-option",{attrs:{label:"C",value:"C"}}),a("el-option",{attrs:{label:"D",value:"D"}})],1)],1),a("el-form-item",{attrs:{label:"首页方案"}},[a("el-button",{on:{click:function(a){return e.handleSelectHomePageStart(t)}}},[e._v("选择首页")]),a("span",{directives:[{name:"show",rawName:"v-show",value:t.homepageName,expression:"testItem.homepageName"}],staticClass:"marginL"},[e._v("已选择: "+e._s(t.homepageName))])],1),a("el-button",{staticClass:"test-group__remove",attrs:{type:"text"},on:{click:function(a){return e.handleRemoveTestItem(t)}}},[a("i",{staticClass:"el-icon-close"})])],1)}),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.form.testHomeList&&e.form.testHomeList.length<4,expression:"form.testHomeList && form.testHomeList.length < 4"}],attrs:{type:"primary"},on:{click:e.handleAddTestItem}},[e._v("添加组")])],2)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.addHomePageClose}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.addHomePageSubmit}},[e._v("确 定")])],1)],1),e.showSelectCrowdDialog?a("CrowdSelector",{on:{"select-cancel":e.handleSelectCrowdCancel,"select-end":e.handleSelectCrowdEnd}}):e._e(),a("el-dialog",{attrs:{title:"选择首页",visible:e.showHomePageDialogVisible,width:"80%","append-to-body":""},on:{"update:visible":function(t){e.showHomePageDialogVisible=t}}},[a("HomePageModel",{attrs:{homepageModel:e.itemType},on:{"row-click":e.rowClick}})],1)],1)},vf=[],gf=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType},on:{"row-click":e.rowClick,"row-selection-change":e.rowClick}})],1)],1)},bf=[],yf={components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"]},props:{homepageModel:String,homepageResource:String,homepageStatusArray:String},data:function(){return{filter:{},filterSchema:null,pagination:{pageSize:5},selected:[],table:{props:{},header:[{label:"ID",prop:"homepageId",width:"100"},{label:"名称",width:"130",prop:"homepageName",sortable:!0},{label:"关联版面名称",prop:"relationTabName",render:function(e,t){var a=t.row,n=a.relationTabName;return n.length>40&&(n=n.substring(0,40)+"..."),e("div",{attrs:{title:a.relationTabName}},n)}},{label:"首页模式",prop:"homepageModel",render:function(e,t){var a=t.row;return"child"===a.homepageModel?"儿童模式":"标准模式"}},{label:"更新时间",prop:"lastUpdateDate",width:150,sortable:!0}],data:[],selected:[],selectionType:"single"}}},watch:{homepageModel:function(){this.fetchData()}},methods:{rowClick:function(e){this.$emit("row-click",e)},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.homepageId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();t.homepageModel=this.homepageModel,t.homepageResource=this.homepageResource,t.homepageStatusArray=this.homepageStatusArray,this.$service.getHomePageModelPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=ll.a.map({homepageId:ll.a.o.string.other("form",{component:"Input",placeholder:"ID"}),homepageName:ll.a.o.string.other("form",{component:"Input",placeholder:"名称"})}).other("form",{cols:{item:6,label:0,wrapper:22},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},wf=yf,If=Object(Yo["a"])(wf,gf,bf,!1,null,null,null),Cf=If.exports,Tf={components:{CrowdSelector:fs["a"],HomePageModel:Cf},props:{itemType:String,editHomePageData:Object,selectedCrowds:Array},watch:{"form.useABTest":"handleToggleABTest"},data:function(){return{form:{},dialogVisible:!0,showSelectCrowdDialog:!1,showHomePageDialogVisible:!1,specialNormalHp:[],specialChildHp:[],crowdsIndexed:{},useABTestHomePage:void 0,activeItem:void 0,activeGroup:void 0}},methods:{addHomePageClose:function(){this.$emit("add-home-page-close")},addHomePageSubmit:function(){var e=this.form,t=e.attribute.crowdIds;if(!t||0===t.length)return this.$message.error("请选择人群");if(!e.homepageId)return this.$message.error("请选择首页");if(e.useABTest){for(var a,n,i,r,o,l=e.testHomeList,s=[],c=[],u=0,d=l.length;u<d;u++){o=l[u];var p=o.distributeModel,h=o.homepageId;if(s.indexOf(p)>-1){i=p;break}if(!p){a=u;break}if(s.push(p),c.indexOf(h)>-1){r=o.homepageName;break}if(!h){n=p;break}c.push(h)}if(void 0!==a)return this.$message("请选择第"+(a+1)+"测试组的编号");if(n)return this.$message("请选择测试组"+n+"的首页");if(r)return this.$message("测试组含有重复首页: "+r);if(i)return this.$message("含有重复测试组编号: "+i)}e.testHomeList=e.useABTest?e.testHomeList:[],"{}"!==JSON.stringify(this.editHomePageData)?this.$emit("create-home-page",this.form,!0):this.$emit("create-home-page",this.form,!1)},rowClick:function(e){void 0!==this.useABTestHomePage?(this.useABTestHomePage.homepageId=e.homepageId,this.useABTestHomePage.homepageStatus=e.homepageStatus,this.useABTestHomePage.homepageName=e.homepageName):(this.form.homepageId=e.homepageId,this.form.homepageVersion=e.homepageVersion,this.form.homepageStatus=e.homepageStatus,this.form.homepageName=e.homepageName),this.showHomePageDialogVisible=!1},handleSelectCrowdStart:function(){var e=JSON.parse(JSON.stringify(this.form.attribute||{}));this.selectedPolicyIds=e.crowdPolicyIds||[],this.selectedCrowdIds=e.crowdIds||[],this.showSelectCrowdDialog=!0},handleSelectHomePageStart:function(e){this.useABTestHomePage=e,this.showHomePageDialogVisible=!0},handleSelectCrowdCancel:function(){this.showSelectCrowdDialog=!1},handleSelectCrowdEnd:function(e,t){this.isContainCrowdName(t.value)?this.$message({type:"error",message:"已经存在相同的人群"}):(this.$set(this.crowdsIndexed,t.value,t),this.form.attribute={crowdIds:[t.value],crowdName:t.label,crowdPolicyName:e.label,crowdPolicyIds:[e.value]},this.showSelectCrowdDialog=!1)},isContainCrowdName:function(e){return this.selectedCrowds.some(function(t){return t.attribute.crowdIds[0]===e})},getSelectedCrowdNames:function(e){console.log(e);var t=e.attribute||{},a=this.crowdsIndexed,n=t.crowdIds;if(n)return n.map(function(e){return a[e]?a[e].label:"加载中..."})},handleRemoveTestItem:function(e){var t=this.form.testHomeList;t.splice(t.indexOf(e),1)},handleAddTestItem:function(){this.form.testHomeList.push(this.getInitTestItem())},getInitTestItem:function(){return{distributeModel:void 0,homepageId:void 0,homepageName:void 0,homepageStatus:void 0}},handleToggleABTest:function(e){e&&0===this.form.testHomeList.length&&this.handleAddTestItem()},getInitSpecialNormal:function(){return{homepageId:void 0,homepageVersion:"",homepageModel:"normal",homepageStatus:void 0,distributeModel:"default",attribute:{},useABTest:!1,testHomeList:[]}},getInitSpecialChild:function(){return{homepageId:void 0,homepageVersion:"",homepageModel:"child",homepageStatus:void 0,distributeModel:"default",attribute:{},useABTest:!1,testHomeList:[]}},setFormData:function(){if("{}"!==JSON.stringify(this.editHomePageData)){var e=Object(Go["cloneDeep"])(this.editHomePageData);e.testHomeList&&e.testHomeList.length>0&&(e.useABTest=!0),this.form=e}}},created:function(){this.form="child"===this.itemType?this.getInitSpecialChild():this.getInitSpecialNormal(),this.setFormData()}},Sf=Tf,kf=(a("feee"),Object(Yo["a"])(Sf,ff,vf,!1,null,"d6d90c28",null)),_f=kf.exports,Pf=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h4",[e._v(e._s(e.title))]),a("section",{staticClass:"content"},e._l(e.dataArr,function(t,n){return a("div",{key:n,staticClass:"homePageView"},[a("el-form",{attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"人群"}},[a("el-tag",{attrs:{type:"success",size:"medium"}},[e._v("\n           "+e._s(t.attribute.crowdName)+"\n          ")])],1),a("el-form-item",{attrs:{label:"首页方案"}},[a("el-tag",{attrs:{type:"success",size:"medium"}},[e._v(e._s(t.homepageName))])],1),t.testHomeList.length>0?a("el-form-item",{attrs:{label:"AB测试"}},[a("el-table",{attrs:{data:t.testHomeList,border:""}},[a("el-table-column",{attrs:{prop:"distributeModel",label:"编号"}}),a("el-table-column",{attrs:{prop:"homepageName",label:"首页方案"}})],1)],1):e._e()],1),"read"!==e.mode?a("div",{staticClass:"homePageView__action"},[a("i",{staticClass:"el-icon-edit",on:{click:function(a){return e.edit(t.homepageModel,n)}}}),a("i",{staticClass:"el-icon-close",on:{click:function(a){return e.remove(t.homepageModel,n)}}})]):e._e()],1)}),0)])},xf=[],Ff={props:{dataArr:Array,title:String,mode:String},data:function(){return{}},methods:{edit:function(e,t){this.$emit("edit-item",e,t)},remove:function(e,t){this.$emit("remove-item",e,t)}}},Df=Ff,Rf=(a("2c71"),Object(Yo["a"])(Df,Pf,xf,!1,null,"03dacd02",null)),Lf=Rf.exports,$f=a("07d0"),Nf={mixins:[ds["a"]],components:{DeviceSelector:sf,SelectedTag:mf,PolicyManageAddHomePage:_f,SelectedHomePage:Lf,CommonContent:Ql["a"],HomePageInfo:Hm["a"],PageWrapper:eu["a"],PageContentWrapper:tu["a"],HomepageSelector:$f["a"]},props:["id","initMode","version","policyType"],data:function(){var e=this.isTestPolicy;function t(e,t,a){if(""===t)return a();t=t.replace(/(^\s*)|(\s*$)/g,"");var n=/^[a-zA-Z0-9]{12}$/;n.test(t)?a():a(new Error("请请输入12位以字母数字组成的MAC地址"))}return{homePageId:void 0,homePageVersion:void 0,homePageReadDialogVisible:!1,activePage:"policy_info",mode:void 0,dialogType:void 0,addHomePageDialogVisible:!1,selectedCrowds:[],editHomePageData:{},editHomePageIndex:void 0,form:{policyId:null,policyName:null,macStart:e?"":"000000000000",macEnd:"ffffffffffff",homePageVerEnd:"9999999",homePageVerStart:"",priority:null,policyStatus:3,deviceInfos:[],normalHpList:[],childHpList:[],partner:"tencent",regionCityPairs:[],specialNormalHp:[],specialChildHp:[]},formRules:{policyName:[{required:!0,message:"请输入策略名称",trigger:"blur"}],macStart:[{required:e,message:"请输入12位以字母数字组成的MAC地址"},{validator:t,trigger:"blur"}],macEnd:[{validator:t,message:"请输入12位以字母数字组成的MAC地址",trigger:"blur"}],homePageVerStart:[{required:!0,message:"请输入首页版本起始值",trigger:"blur"}],homePageVerEnd:[{required:!0,message:"请输入首页版本结束值",trigger:"blur"}]},ageOptions:[],ageEnums:{}}},computed:{resourceInfo:function(){var e=this.form,t=this.isTestPolicy,a=this.isChildPolicy,n=t?"testPolicyConf":a?"childPolicy":"policyConf";if(e.policyId)return{id:e.policyId,type:"policy",menuElId:n,version:e.currentVersion,status:e.policyStatus}},isChildPolicy:function(){return"child"===this.policyType},isTestPolicy:function(){return"test"===this.policyType},resourceName:function(){var e={normal:"策略",test:"测试策略"};return e[this.policyType]}},methods:{handleInputPlatform:function(e){var t=this.form;t.platform!==e&&(t.platform=e,t.childHpList=[],t.normalHpList=[],t.specialNormalHp=[],t.specialChildHp=[])},mergeSelected:function(e){var t=e.idField,a=e.parse,n=e.selectedList,i=e.originSelectedList,r=i.reduce(function(e,a,n){return e[a[t]]=n,e},{}),o=n.filter(function(e){return void 0===r[e[t]]}).map(a);return[].concat(Object(Zm["a"])(i),Object(Zm["a"])(o))},handleRemoveChildHpItem:function(e){this.form.childHpList.splice(e,1)},getHomepageInfo:function(e,t){return Object(Q["a"])({homepageId:e.homepageId,homepageModel:e.homepageModel,homepageName:e.homepageName,homepageVersion:e.homepageVersion},t)},handleSelectNormalHomepageEnd:function(e){var t=Object(Kt["a"])(e,1),a=t[0];this.form.normalHpList=[this.getHomepageInfo(a)]},handleSelectChildHomepageEnd:function(e){var t=this;this.form.childHpList=this.mergeSelected({idField:"homepageId",parse:function(e){return t.getHomepageInfo(e,{age:0})},selectedList:e,originSelectedList:this.form.childHpList})},showHomePageDetail:function(e){this.homePageId=e.homepageId,this.homePageVersion=e.currentVersion,this.activePage="showHomePageDetail"},handleRemoveAllSpecHomePage:function(){this.form.specialNormalHp=[],this.form.specialChildHp=[]},addHomePageClose:function(){this.addHomePageDialogVisible=!1},editHomePage:function(e,t){this.addHomePageDialogVisible=!0,this.dialogType=e,this.editHomePageIndex=t,"normal"===e?(this.selectedCrowds=this.form.specialNormalHp,this.editHomePageData=this.form.specialNormalHp[t]):(this.selectedCrowds=this.form.specialChildHp,this.editHomePageData=this.form.specialChildHp[t])},removeHomePage:function(e,t){this.editHomePageData="normal"===e?this.form.specialNormalHp.splice(t,1):this.form.specialChildHp.splice(t,1)},createHomePage:function(e,t){var a=this,n=e.attribute.crowdPolicyIds[0],i=e.attribute.crowdIds[0];this.$service.getTaglist({id:n,type:"crowd"}).then(function(n){for(var r=0;r<n.length;r++)if(n[r].value===i){e.attribute.crowdName=n[r].label;break}"normal"===a.dialogType?t?a.$set(a.form.specialNormalHp,a.editHomePageIndex,e):a.isContainCrowdName(a.form.specialNormalHp,i)?a.$message({type:"error",message:"已经存在相同的人群"}):a.form.specialNormalHp.push(e):t?a.$set(a.form.specialChildHp,a.editHomePageIndex,e):a.isContainCrowdName(a.form.specialChildHp,i)?a.$message({type:"error",message:"已经存在相同的人群"}):a.form.specialChildHp.push(e)}),this.addHomePageDialogVisible=!1},isContainCrowdName:function(e,t){return e.some(function(e){return e.attribute.crowdIds[0]===t})},getCrowdNames:function(e){var t=this,a=e.map(function(e){var a=e.attribute.crowdPolicyIds[0],n=e.attribute.crowdIds[0];return t.$service.getTaglist({id:a,type:"crowd"}).then(function(a){for(var i=0;i<a.length;i++)if(a[i].value===n){t.$set(e.attribute,"crowdName",a[i].label);break}}),e});return a},addHomePage:function(e){this.addHomePageDialogVisible=!0,this.dialogType=e,this.selectedCrowds="normal"===e?this.form.specialNormalHp:this.form.specialChildHp,this.editHomePageData={}},modelChipSelectedRemove:function(e){this.form.deviceInfos.splice(e,1)},handleSelectChipEnd:function(e){var t=e[0].platform;t&&this.handleInputPlatform(t),this.form.deviceInfos=e.map(function(e){return{devParId:e.devParId,chip:e.chip,model:e.model}})},getFormData:function(){var e=Object(Go["cloneDeep"])(this.form);return e.deviceInfos=e.deviceInfos.map(function(e){return{chip:e.chip,model:e.model}}),e},validateFormData:function(e,t){var a=this;this.$refs.form.validate(function(n){if(n){var i=e.normalHpList,r=e.childHpList,o=e.macStart,l=e.macEnd,s=e.deviceInfos,c=o&&l;if(0===s.length&&!c)return a.$message({type:"error",message:"mac地址或者机型机芯至少选择一项"});if(0===i.length)return a.$message({type:"error",message:"请选择标准模式首页"});if(0===r.length)return a.$message({type:"error",message:"请选择儿童模式首页"});var u=r.reduce(function(e,t){return e[t.age]=t,e},{});if(!u["0"])return a.$message({type:"error",message:"至少要有一个不限年龄的儿童模式首页"});if(Object.keys(u).length<r.length)return a.$message({type:"error",message:"存在重复年龄或多个不限年龄的儿童模式首页"});t()}else a.$message({type:"error",message:"请把表单填写完整"})})},parseDataToApi:function(e){return e.childHpList=e.childHpList.map(function(e){return{homepageId:e.homepageId,age:e.age}}),e.normalHpList=e.normalHpList.map(function(e){return{homepageId:e.homepageId}}),this.isTestPolicy?e.macEnd=e.macStart:e.macStart&&e.macEnd||(e.macStart=e.macEnd=""),"replicate"===this.mode&&(e.currentVersion=""),e},submitBtn:function(e){var t=this,a=this.getFormData();a.policyStatus=e,this.validateFormData(a,function(){var e={jsonStr:JSON.stringify(t.parseDataToApi(a))},n={normal:"policyConfSave",test:"testPolicyConfSave"};t.$service[n[t.policyType]](e,"保存成功").then(function(e){t.$emit("upsert-end")})})},setData:function(e){e=Object(Go["cloneDeep"])(e),this.form={currentVersion:e.currentVersion,policyId:e.policyId,policyName:e.policyName,macStart:e.macStart,macEnd:e.macEnd,homePageVerEnd:e.homePageVerEnd,homePageVerStart:e.homepageVerStart,priority:e.priority,policyStatus:e.policyStatus,deviceInfos:e.chip?[{chip:e.chip,model:e.model}]:[],normalHpList:e.normalHpList,childHpList:e.childHpList,platform:e.platform,regionCityPairs:[],specialNormalHp:this.getCrowdNames(e.specialNormalHp),specialChildHp:this.getCrowdNames(e.specialChildHp)}},fetchData:function(e){var t={id:this.id,version:e};this.isTestPolicy?this.$service.getPolicyConfDetail(t).then(this.setData):this.$service.getTestPolicyConfDetail(t).then(this.setData)}},created:function(){var e=this;this.mode=this.initMode||"create",this.id&&this.fetchData(this.version),this.$service.getDictType({type:"childAge"}).then(function(t){e.ageOptions=t.map(function(e){return{label:e.dictCnName,value:+e.dictEnName,disabled:e.disabled}}),e.ageEnums=t.reduce(function(e,t){return e[t.dictEnName]=t.dictCnName,e},{})})}},Ef=Nf,Of=(a("d3df"),Object(Yo["a"])(Ef,Qm,Xm,!1,null,"59943074",null)),Af=Of.exports,Vf={extends:Sl["a"],components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"],ButtonGroupForListPage:kl["a"],Policy:Af,PageWrapper:eu["a"],PageContentWrapper:tu["a"]},data:function(){var e=this;return{canAdd:!1,resourceType:"homepage",activePage:"homepage_list",showChipDialog:!1,showPolicyNameDialog:!1,policyId:void 0,policyNames:[],chips:[],filter:{sort:void 0,order:void 0},filterSchema:null,pagination:{},setDialogVisible:!1,selected:[],buttonList:[],table:{props:{"row-key":"homepageId"},header:[{label:"ID",prop:"homepageId"},{label:"首页名称",prop:"homepageName",minWidth:150,"show-overflow-tooltip":!0,render:function(t,a){var n=a.row;return t(q["Button"],{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(n)}}},n.homepageName)}},{label:"关联策略",prop:"relationPolicyName",align:"center",render:function(t,a){var n=a.row,i=n.relationPolicyName;if("--"!==i)return t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleShowPolicyNames(i)}}},"查看")}},{label:"版本/状态",prop:"homepageStatus",align:"center",render:function(t,a){var n=a.row,i=e.$consts.statusText;return t("span","".concat(n.currentVersion,"/").concat(i[n.homepageStatus]))}},{label:"待审核副本",prop:"duplicateVersion",align:"center",render:function(t,a){var n=a.row;return""===n.duplicateVersion?"":t(q["Button"],{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(n,n.duplicateVersion)}}},n.duplicateVersion)}},{label:"机型机芯",prop:"chipModel",align:"center",render:function(t,a){var n=a.row,i=n.chipModel;if("--"!==i)return t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleShowChips(i)}}},"查看")}},{label:"更新时间",prop:"lastUpdateDate",width:140},{label:"更新人",prop:"modiferName"},{label:"操作",width:"140",fixed:"right",render:function(t,a){var n=a.row;return t("div",[e.canAdd&&t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleCopy(n)}}},"复制"),!!n.showContentAuthSettingBtn&&t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleOpenContentAuthManager(n)}}},"内容权限")])}}],data:[],selected:[],selectionType:"multiple"}}},computed:{},methods:{handleOpenContentAuthManager:function(e){this.$refs.contentCard.handleShowContentAuthManager({id:e.homepageId,type:"homepage",menuElId:"homepageInfo"})},handleShowChips:function(e){this.chips=e.split(","),this.showChipDialog=!0},handleShowPolicyNames:function(e){this.policyNames=e.split(","),this.showPolicyNameDialog=!0},handleShowPolicy:function(e){var t=e.match(/\((.+)\)/)[1];this.policyId=+t,this.activePage="policy",this.showPolicyNameDialog=!1},handleShowPolicyEnd:function(){this.showPolicyNameDialog=!0,this.activePage="homepage_list"},handleFilterChange:function(e,t){t&&(this.filter=t),"query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData()},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();this.$service.getHomePageInfoList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=this,t=ll.a.map({homepageId:ll.a.o.oneOf([ll.a.value(""),ll.a.number]).$msg("请输入数字").other("form",{component:"InputPositiveInt",placeholder:"ID"}),homepageName:ll.a.o.string.other("form",{component:"Input",placeholder:"名称"}),homepageStatus:ll.a.o.enum({"下架":"0","上架":"1","草稿":"2","待审核":"3","审核通过":"4","审核不通过":"5"}).other("form",{component:"Select",placeholder:"状态"}),chipModel:ll.a.o.string.other("form",{component:"Input",placeholder:"机型/机芯"})}).other("form",{cols:{item:5,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=t,this.fetchData(),this.$service.getButtonGroupForPageList("homepage").then(function(t){e.canAdd=t.some(function(e){return"add"===e.runComm})})}},Bf=Vf,Mf=(a("7e3c"),Object(Yo["a"])(Bf,Km,Ym,!1,null,"3b0d748d",null)),Uf=Mf.exports,Gf={extends:xc["a"],components:{ResourceList:Uf,ResourceContent:Hm["a"]},data:function(){return{}},computed:{resourceInfo:function(){return{type:"homepage",idField:"homepageId"}}}},jf=Gf,zf=Object(Yo["a"])(jf,sc,cc,!1,null,null,null),Wf=zf.exports,qf=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("TabPage",[a("PolicyManageList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,read:e.handleRead,edit:e.handleEdit,delete:e.handleDelete}}),e.isShowList?e._e():a("PolicyManageInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version,"policy-type":"normal"},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},Jf=[],Hf=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{ref:"contentCard",staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"policyConf"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}),a("Table",{staticClass:"policy-list",attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},Kf=[],Yf={extends:Sl["a"],components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"],ButtonGroupForListPage:kl["a"]},data:function(){var e=this;return{resourceType:"policy",filter:{},filterSchema:null,pagination:{pageSize:10},selected:[],selectedItems:[],table:{props:{rowKey:"policyId",treeProps:{children:"children"}},header:[{label:"ID",prop:"policyId",width:70},{label:"策略名称",prop:"policyName",minWidth:150,"show-overflow-tooltip":!0,render:function(t,a){var n=a.row,i=t("i",{class:n.children?"el-icon-folder":"el-icon-document"}),r=t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n)}}},n.policyName);return t("div",null,[i,r])}},{label:"策略优先级",prop:"priority"},{label:"关联首页方案",width:150,prop:"relationHomepageName"},{label:"机型",prop:"model"},{label:"机芯",prop:"chip"},{label:"版本",prop:"currentVersion"},{label:"状态",prop:"policyStatus",render:function(t,a){var n=a.row;return e.$numToAuditStatus(n.policyStatus)}},{label:"待审核副本",prop:"duplicateVersion",align:"center",render:function(t,a){var n=a.row;return""===n.duplicateVersion?"":t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n,n.duplicateVersion)}}},n.duplicateVersion)}},{label:"更新时间",prop:"lastUpdateDate",width:140},{label:"更新人",prop:"modifierName"},{label:"操作",render:function(t,a){var n=a.row;if(n.showContentAuthSettingBtn)return t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleOpenContentAuthManager(n)}}},"内容权限")}}],data:[],selected:[],selectionType:"multiple"}}},methods:{handleOpenContentAuthManager:function(e){this.$refs.contentCard.handleShowContentAuthManager({id:e.policyId,type:"policy",menuElId:"policyConf"})},handleFilterChange:function(e,t){t&&(this.filter=t),"query"===e&&(this.pagination.currentPage=1),this.fetchData()},handleFilterReset:function(){this.filter={},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();this.$service.getPolicyManagePageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows||[]})},expandItem:function(e){return e.children?[e].concat(Object(Zm["a"])(e.children)):[e]},handleRowSelectionAdd:function(e){this.selected=this.selected.concat(this.expandItem(e)),this.updateTableSelected()},handleRowSelectionRemove:function(e){var t="policyId",a=this.expandItem(e).reduce(function(e,a){return e[a[t]]=!0,e},{});this.selected=this.selected.filter(function(e){return!a[e[t]]}),this.updateTableSelected()},handleAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleRowSelectionAdd):(this.selected=[],this.table.selected=[])},updateTableSelected:function(){var e=this,t="policyId",a=this.table,n=this.selected.reduce(function(e,a){return e[a[t]]=!0,e},{}),i=a.data.reduce(function(t,a){return t.concat(e.expandItem(a))},[]);a.selected=i.reduce(function(e,a,i){return n[a[t]]&&e.push(i),e},[])}},created:function(){var e=ll.a.map({policyId:ll.a.o.oneOf([ll.a.value(""),ll.a.number]).$msg("请输入数字").other("form",{component:"InputPositiveInt",placeholder:"ID"}),policyName:ll.a.o.string.other("form",{component:"Input",placeholder:"策略名称"}),policyStatus:ll.a.o.enum({"下架":"0","上架":"1","草稿":"2","待审核":"3","审核通过":"4","审核不通过":"5"}).other("form",{component:"Select",placeholder:"状态"}),chipModel:ll.a.o.string.other("form",{component:"Input",placeholder:"机型/机芯"})}).other("form",{cols:{item:5,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},Qf=Yf,Xf=(a("76f3"),Object(Yo["a"])(Qf,Hf,Kf,!1,null,"fd227690",null)),Zf=Xf.exports,ev={components:{TabPage:Il["a"],PolicyManageInfo:Af,PolicyManageList:Zf},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0}},methods:{handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e.policyId,this.mode="edit",this.isShowList=!1},handleRead:function(e,t){this.id=e.policyId,this.mode="read",this.version=t,this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.policyConfRemove({id:e.map(function(e){return e.policyId}).join(",")},"删除成功").then(function(){t.$refs.list.fetchData()})},handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},tv=ev,av=Object(Yo["a"])(tv,qf,Jf,!1,null,null,null),nv=av.exports,iv=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("TabPage",[a("TestPolicyManageList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,read:e.handleRead,edit:e.handleEdit,delete:e.handleDelete}}),e.isShowList?e._e():a("PolicyManageInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version,"policy-type":"test"},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},rv=[],ov=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{ref:"contentCard",staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"policyConf"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}),a("Table",{staticClass:"policy-list",attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},lv=[],sv={extends:Sl["a"],components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"],ButtonGroupForListPage:kl["a"]},data:function(){var e=this;return{resourceType:"policy",filter:{},filterSchema:null,pagination:{pageSize:10},selected:[],selectedItems:[],table:{props:{rowKey:"policyId"},header:[{label:"ID",prop:"policyId",width:70},{label:"策略名称",prop:"policyName",minWidth:150,"show-overflow-tooltip":!0,render:function(t,a){var n=a.row,i=t("i",{class:n.children?"el-icon-folder":"el-icon-document"}),r=t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n)}}},n.policyName);return t("div",null,[i,r])}},{label:"策略优先级",prop:"priority"},{label:"关联首页方案",width:150,prop:"relationHomepageName"},{label:"机型",prop:"model"},{label:"机芯",prop:"chip"},{label:"版本",prop:"currentVersion"},{label:"状态",prop:"policyStatus",render:function(t,a){var n=a.row;return e.$numToAuditStatus(n.policyStatus)}},{label:"待审核副本",prop:"duplicateVersion",align:"center",render:function(t,a){var n=a.row;return""===n.duplicateVersion?"":t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n,n.duplicateVersion)}}},n.duplicateVersion)}},{label:"更新时间",prop:"lastUpdateDate",width:140},{label:"更新人",prop:"modifierName"},{label:"操作",render:function(t,a){var n=a.row;if(n.showContentAuthSettingBtn)return t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleOpenContentAuthManager(n)}}},"内容权限")}}],data:[],selected:[],selectionType:"multiple"}}},methods:{handleOpenContentAuthManager:function(e){this.$refs.contentCard.handleShowContentAuthManager({id:e.policyId,type:"policy",menuElId:"policyConf"})},handleFilterChange:function(e,t){t&&(this.filter=t),"query"===e&&(this.pagination.currentPage=1),this.fetchData()},handleFilterReset:function(){this.filter={},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.getTestPolicyManagePageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},expandItem:function(e){return e.children?[e].concat(Object(Zm["a"])(e.children)):[e]},handleRowSelectionAdd:function(e){this.selected=this.selected.concat(this.expandItem(e)),this.updateTableSelected()},handleRowSelectionRemove:function(e){var t="policyId",a=this.expandItem(e).reduce(function(e,a){return e[a[t]]=!0,e},{});this.selected=this.selected.filter(function(e){return!a[e[t]]}),this.updateTableSelected()},handleAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleRowSelectionAdd):(this.selected=[],this.table.selected=[])},updateTableSelected:function(){var e=this,t="policyId",a=this.table,n=this.selected.reduce(function(e,a){return e[a[t]]=!0,e},{}),i=a.data.reduce(function(t,a){return t.concat(e.expandItem(a))},[]);a.selected=i.reduce(function(e,a,i){return n[a[t]]&&e.push(i),e},[])}},created:function(){var e=ll.a.map({policyId:ll.a.o.oneOf([ll.a.value(""),ll.a.number]).$msg("请输入数字").other("form",{component:"InputPositiveInt",placeholder:"ID"}),policyName:ll.a.o.string.other("form",{component:"Input",placeholder:"策略名称"}),policyStatus:ll.a.o.enum({"下架":"0","上架":"1","草稿":"2","待审核":"3","审核通过":"4","审核不通过":"5"}).other("form",{component:"Select",placeholder:"状态"}),chipModel:ll.a.o.string.other("form",{component:"Input",placeholder:"机型/机芯"})}).other("form",{cols:{item:5,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},cv=sv,uv=(a("3cff"),Object(Yo["a"])(cv,ov,lv,!1,null,"01025baf",null)),dv=uv.exports,pv={components:{TabPage:Il["a"],PolicyManageInfo:Af,TestPolicyManageList:dv},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0}},methods:{handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e.policyId,this.mode="edit",this.isShowList=!1},handleRead:function(e,t){this.id=e.policyId,this.mode="read",this.version=t,this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.policyConfRemove({id:e.map(function(e){return e.policyId}).join(",")},"删除成功").then(function(){t.$refs.list.fetchData()})},handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},hv=pv,mv=Object(Yo["a"])(hv,iv,rv,!1,null,null,null),fv=mv.exports,vv=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"resource-manager-wrapper"},[a("BusinessTabList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,read:e.handleRead,edit:e.handleEdit,copy:e.handleCopy,delete:e.handleDelete}}),e.isShowList?e._e():a("BusinessTabInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},gv=[],bv=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{ref:"contentCard",staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"businessTab"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},yv=[],wv={extends:Sl["a"],components:{ContentWrapper:Bo["ContentWrapper"],Table:Bo["Table"],ButtonGroupForListPage:kl["a"]},data:function(){var e=this;return{canAdd:!1,resourceType:"tabInfo",tabTypeOption:[{label:"第三方版面",value:"4"},{label:"专题版面",value:"2"},{label:"普通版面",value:"1"}],tabStatusOption:[{label:"下架",value:"0"},{label:"上架",value:"1"},{label:"草稿",value:"2"},{label:"待审核",value:"3"},{label:"审核通过",value:"4"},{label:"审核不通过",value:"5"}],tabStatus:{},filter:this.genDefaultFilter(),filterSchema:null,pagination:{currentPage:1},appIdType:[],businessType:[],tabType:{},tabTypeReverse:{},selected:[],selectedItems:[],table:{props:{},data:[],header:[{label:"ID",prop:"tabId"},{label:"名称",prop:"tabName","show-overflow-tooltip":!0,minWidth:180,render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n)}}},n.tabName)}},{label:"版面属性",prop:"tabType",width:120,render:function(t,a){var n=a.row;return e.tabTypeReverse[n.tabType]}},{label:"业务分类",prop:"businessCategoryName"},{label:"内容源",prop:"tabResource",render:function(t,a){var n=a.row;return e.$sourceName(n.tabResource)}},{label:"AppId",prop:"tabAppid",formatter:function(t){return e.appIdType.map(function(e){if(t.tabAppid.toString()===e.dictEnName)return e.dictCnName})}},{label:"版本/状态",prop:"tabStatus",width:110,formatter:function(t){var a=t.tabStatus,n=t.currentVersion;return n+"/"+e.tabStatusOption.map(function(e){if(a.toString()===e.value)return e.label}).join("")}},{label:"待审核副本",prop:"duplicateVersion",width:90,render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n,n.duplicateVersion)}}},n.duplicateVersion)}},{label:"更新时间",prop:"lastUpdateDate",width:140},{label:"审核人",prop:"auditor",width:100},{label:"更新人",prop:"modifierName",width:100},{label:"操作",width:180,fixed:"right",render:this.createOperationRender(this)}],selected:[],selectionType:"multiple"}}},methods:{handleOpenContentAuthManager:function(e){this.$refs.contentCard.handleShowContentAuthManager({id:e.tabId,type:"tab",menuElId:"tabInfo"})},createOperationRender:function(e){var t=this;return function(a,n){var i=n.row,r=t.canAdd&&a("el-button",{props:{type:"text"},on:{click:function(){e.handleCopy(i)}}},"复制"),o=null;o=i.collected?a("el-button",{props:{type:"text"},on:{click:function(){e.cancalCollect(i)}}},"取消"):a("el-button",{props:{type:"text"},on:{click:function(){e.collect(i)}}},"收藏");var l=!!i.showContentAuthSettingBtn&&a("el-button",{props:{type:"text"},on:{click:function(e){e.stopPropagation(),t.handleOpenContentAuthManager(i)}}},"内容权限");return[r,o,l]}},collect:function(e){var t=this;this.$service.collect({type:"tab",data:{resourceId:e.tabId}},"收藏成功").then(function(){t.fetchData()})},cancalCollect:function(e){var t=this;this.$service.collectCancel({type:"tab",data:{resourceId:e.tabId}},"取消成功").then(function(){t.fetchData()})},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.tabInfoList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},genDefaultFilter:function(){return{tabParentType:"biz",idPrefix:this.$consts.idPrefix}},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},handleFilterChange:function(e,t){t&&(this.filter=t),"query"===e&&(this.pagination.currentPage=1),this.fetchData()},handleFilterReset:function(){this.filter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},getTabType:function(){var e=this;return this.$service.getTabType({tabParentType:"biz"}).then(function(t){t.forEach(function(t){e.tabType[t.dictCnName]=t.dictEnName,e.tabTypeReverse[t.dictEnName]=t.dictCnName})})},getBusinessType:function(){var e=this;this.$service.getDictType({type:"businessType"}).then(function(t){e.businessType=t})}},created:function(){var e=this;this.tabStatus=this.tabStatusOption.reduce(function(e,t){return e[t.label]=t.value,e},{});var t=ll.a.map({tabId:ll.a.o.oneOf([ll.a.value(""),ll.a.number]).$msg("请输入数字").other("form",{component:"InputPositiveInt",placeholder:"ID"}),tabName:ll.a.o.string.other("form",{placeholder:"版面标题"}),tabType:ll.a.o.enum(this.tabType).other("form",{component:"Select",placeholder:"版面属性"}),tabStatus:ll.a.o.enum(this.tabStatus).other("form",{component:"Select",placeholder:"状态"})}).other("form",{cols:{item:5,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});"10"!==this.$consts.idPrefix&&t.map({idPrefix:ll.a.o.enum({"酷开":"10","江苏广电":"11"}).other("form",{component:"Select",placeholder:"数据来源"})}),this.getTabType().then(function(){e.filterSchema=t}),this.$service.getDictType({type:"appIdType"}).then(function(t){e.appIdType=t,e.fetchData()}),this.getBusinessType(),this.$service.getButtonGroupForPageList("businessTab").then(function(t){e.canAdd=t.some(function(e){return"add"===e.runComm})})}},Iv=wv,Cv=Object(Yo["a"])(Iv,bv,yv,!1,null,"420e7326",null),Tv=Cv.exports,Sv=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PageWrapper",{staticClass:"tab-info-wrapper"},[a("PageContentWrapper",{directives:[{name:"show",rawName:"v-show",value:"tab_info"===e.activePage,expression:"activePage === 'tab_info'"}]},[a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("CommonContent",{ref:"commonContent",attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{replicate:function(t){e.mode="replicate"},edit:function(t){e.mode="edit"},unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,"submit-audit":e.handleSubmitAudit,"save-draft":e.handleSaveDraft,audit:function(t){return e.$emit("upsert-end")},copy:function(t){return e.handleCopy(t)},"select-version":e.fetchData,delete:function(t){return e.$emit("upsert-end",t)}}},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),"read"!==e.mode?a("div",[a("el-form",{ref:"tabForm",staticClass:"el-form-add",attrs:{rules:e.rules,model:e.tab,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"版面名称",prop:"tabName"}},[a("el-input",{model:{value:e.tab.tabName,callback:function(t){e.$set(e.tab,"tabName","string"===typeof t?t.trim():t)},expression:"tab.tabName"}})],1),a("el-form-item",{attrs:{label:"标题(中文)",prop:"tabCnTitle"}},[a("el-input",{model:{value:e.tab.tabCnTitle,callback:function(t){e.$set(e.tab,"tabCnTitle","string"===typeof t?t.trim():t)},expression:"tab.tabCnTitle"}})],1),a("el-form-item",{attrs:{label:"标题(英文)",prop:"tabEnTitle"}},[a("el-input",{model:{value:e.tab.tabEnTitle,callback:function(t){e.$set(e.tab,"tabEnTitle","string"===typeof t?t.trim():t)},expression:"tab.tabEnTitle"}})],1),a("el-form-item",{attrs:{label:"内容源",prop:"tabResource"}},[a("el-radio-group",{attrs:{value:e.tab.tabResource,disabled:e.isReplica},on:{input:e.handleChangeTabResource}},[a("el-radio",{attrs:{label:""}},[e._v("不限")]),a("el-radio",{attrs:{label:"o_tencent"}},[e._v("腾讯")]),a("el-radio",{attrs:{label:"o_iqiyi"}},[e._v("爱奇艺")]),a("el-radio",{attrs:{label:"o_youku"}},[e._v("优酷")])],1)],1),a("el-form-item",{attrs:{label:"刷新时间间隔",prop:"interval"}},[a("SelectHourAndMinute",{staticClass:"selectHourAndMinute",attrs:{"hour-option":e.hourOption,"minute-option":e.minuteOption,initSumTime:e.initSumTime,min:"5",max:"360"},model:{value:e.tab.timeCycle,callback:function(t){e.$set(e.tab,"timeCycle",t)},expression:"tab.timeCycle"}},[e._v(e._s(e.initSumTime))]),a("span",{staticClass:"hint remarks"},[e._v("设置范围:5分钟-6小时")])],1),a("el-form-item",{attrs:{label:"类型",prop:"tabType"}},[a("el-select",{attrs:{placeholder:"请选择类型",disabled:e.isDisableTabType},model:{value:e.tab.tabType,callback:function(t){e.$set(e.tab,"tabType",t)},expression:"tab.tabType"}},e._l(e.tabTypes,function(e,t){return a("el-option",{key:"tabTypes"+t,attrs:{value:e.value,label:e.label,disabled:e.disabled}})}),1)],1),a("el-form-item",{attrs:{label:"选择版块",prop:"tags"}},[e.isSignalTab?e._e():[a("cc-panel-selector-el",{ref:"panelSelector",attrs:{source:e.tab.tabResource},on:{"select-end":e.handleSelectPanelEnd}}),a("el-dropdown",[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("\n                    新建\n                    "),a("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(t){e.activePage="panel"}}},[e._v("常规版块")]),a("el-dropdown-item",{nativeOn:{click:function(t){e.activePage="album_panel"}}},[e._v("业务专辑")]),a("el-dropdown-item",{nativeOn:{click:function(t){e.activePage="private_panel"}}},[e._v("专属影院")])],1)],1)],a("OrderableTable",{staticClass:"orderableTable",attrs:{header:e.tabGroupTableHeader,"hide-action":!0,readonly:e.isSignalTab},model:{value:e.tab.pannelList,callback:function(t){e.$set(e.tab,"pannelList",t)},expression:"tab.pannelList"}})],2)],1)],1):e._e(),"read"===e.mode?a("div",[a("el-form",{ref:"tabForm",staticClass:"el-form-add",attrs:{rules:e.rules,model:e.tab,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"版面名称",prop:"tabName"}},[e._v(e._s(e.tab.tabName))]),a("el-form-item",{attrs:{label:"标题(中文)",prop:"tabCnTitle"}},[e._v(e._s(e.tab.tabCnTitle))]),a("el-form-item",{attrs:{label:"标题(英文)",prop:"tabEnTitle"}},[e._v(e._s(e.tab.tabEnTitle))]),a("el-form-item",{attrs:{label:"内容源",prop:"tabResource"}},[a("el-radio-group",{attrs:{value:e.tab.tabResource,disabled:!0}},[a("el-radio",{attrs:{label:""}},[e._v("不限")]),a("el-radio",{attrs:{label:"o_tencent"}},[e._v("腾讯")]),a("el-radio",{attrs:{label:"o_iqiyi"}},[e._v("爱奇艺")]),a("el-radio",{attrs:{label:"o_youku"}},[e._v("优酷")])],1)],1),a("el-form-item",{attrs:{label:"刷新时间间隔",prop:"interval"}},[a("SelectHourAndMinute",{staticClass:"selectHourAndMinute",attrs:{"hour-option":e.hourOption,"minute-option":e.minuteOption,initSumTime:e.initSumTime,disabled:!0,min:5,max:360},model:{value:e.tab.timeCycle,callback:function(t){e.$set(e.tab,"timeCycle",t)},expression:"tab.timeCycle"}})],1),a("el-form-item",{attrs:{label:"类型",prop:"tabType"}},[a("el-select",{attrs:{placeholder:"请选择类型",disabled:!e.isDisableTabType},model:{value:e.tab.tabType,callback:function(t){e.$set(e.tab,"tabType",t)},expression:"tab.tabType"}},e._l(e.tabTypes,function(e,t){return a("el-option",{key:"tabTypes"+t,attrs:{value:e.value,label:e.label,disabled:e.disabled}})}),1)],1),a("el-form-item",{attrs:{label:"选择的版块",prop:"tags"}},[a("OrderableTable",{staticClass:"orderableTable",attrs:{header:e.tabGroupTableHeader,"hide-action":!0,readonly:!0},model:{value:e.tab.pannelList,callback:function(t){e.$set(e.tab,"pannelList",t)},expression:"tab.pannelList"}})],1)],1)],1):e._e()])],1)],1),"panel_preview"===e.activePage?a("PageContentWrapper",[[5,9,10].indexOf(e.panelPreview.dataType)>-1?a("PrivatePanelInfo",{attrs:{"title-prefix":e.title,"init-mode":e.panelPreview.initMode,id:e.panelPreview.id,version:e.panelPreview.version},on:{"upsert-end":e.handlePreviewPanelEnd,"go-back":e.handlePreviewPanelEnd}}):a("PanelInfo",{attrs:{"title-prefix":e.title,"init-mode":e.panelPreview.initMode,id:e.panelPreview.id,version:e.panelPreview.version,"panel-data-type":e.panelPreview.dataType,"init-group-index":e.panelPreview.initGroupIndex,"init-block-index":e.panelPreview.initBlockIndex},on:{"upsert-end":e.handlePreviewPanelEnd,"go-back":e.handlePreviewPanelEnd}})],1):e._e(),"panel"===e.activePage?a("PageContentWrapper",[a("PanelInfo",{attrs:{"title-prefix":e.title,"init-mode":"create","panel-data-type":1},on:{"upsert-end":function(t){e.activePage="tab_info"},"go-back":function(t){e.activePage="tab_info"}}})],1):e._e(),"album_panel"===e.activePage?a("PageContentWrapper",[a("PanelInfo",{attrs:{"title-prefix":e.title,"init-mode":"create","panel-data-type":3},on:{"upsert-end":function(t){e.activePage="tab_info"},"go-back":function(t){e.activePage="tab_info"}}})],1):e._e(),"private_panel"===e.activePage?a("PageContentWrapper",[a("PrivatePanelInfo",{attrs:{"title-prefix":e.title,"init-mode":"create"},on:{"upsert-end":function(t){e.activePage="tab_info"},"go-back":function(t){e.activePage="tab_info"}}})],1):e._e()],1)},kv=[],_v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",[a("el-col",{attrs:{span:7}},[a("el-time-select",{attrs:{disabled:e.disabled,"picker-options":e.hourOption,placeholder:"选择小时"},model:{value:e.hour,callback:function(t){e.hour=t},expression:"hour"}})],1),a("el-col",{staticClass:"marginL",attrs:{span:2}},[e._v("小时")]),a("el-col",{attrs:{span:7}},[a("el-time-select",{attrs:{disabled:e.disabled,"picker-options":e.minuteOption,placeholder:"选择分钟"},model:{value:e.minute,callback:function(t){e.minute=t},expression:"minute"}})],1),a("el-col",{staticClass:"marginL",attrs:{span:1}},[e._v("分")]),a("el-col",{staticClass:"marginL",attrs:{span:5}},[e._v("总共："+e._s(e.sumTime)+"分")])],1)],1)},Pv=[],xv={props:["hourOption","minuteOption","initSumTime","min","max","disabled"],data:function(){return{hour:null,minute:null}},computed:{sumTime:function(){return 60*parseInt(null===this.hour?0:this.hour)+parseInt(null===this.minute?0:this.minute.toString().replace("00:",""))}},methods:{limit:function(){return this.sumTime>this.max?(this.$message({type:"error",message:"不能超过"+this.max+"分钟"}),!1):!(this.sumTime<this.min)||(this.$message({type:"error",message:"不能小于"+this.min+"分钟"}),!1)},setHourAndMinute:function(){var e=Math.floor(this.initSumTime/60),t=this.initSumTime-60*e;this.hour="0"+e+":00",this.hour=e>9?e+":00":"0"+e+":00",this.minute=t>9?"00:"+t:"00:0"+t}},watch:{hour:function(e,t){this.limit()?this.$emit("input",this.sumTime):this.hour=t},minute:function(e,t){this.limit()?this.$emit("input",this.sumTime):this.minute=t},initSumTime:function(e){this.setHourAndMinute()}},created:function(){this.setHourAndMinute()}},Fv=xv,Dv=Object(Yo["a"])(Fv,_v,Pv,!1,null,"5e124744",null),Rv=Dv.exports,Lv=a("03df"),$v=a("9311"),Nv={mixins:[ds["a"]],components:{PageWrapper:eu["a"],PageContentWrapper:tu["a"],PanelInfo:Tu["a"],PrivatePanelInfo:Fd["a"],"cc-panel-selector-el":$v["a"],OrderableTable:Lv["a"],SelectHourAndMinute:Rv,CommonContent:Ql["a"]},props:{id:Number,initMode:String,version:{type:String,default:function(){return""}}},data:function(){return{resourceName:"业务版面",hourOption:{start:"00:00",step:"1:00",end:"06:00"},minuteOption:{start:"00:00",step:"00:01",end:"00:59"},activePage:"tab_info",panelPreview:{panel:null,id:void 0,version:void 0,initMode:void 0,initGroupIndex:void 0,initBlockIndex:void 0},initSumTime:120,showTimeShelf:!1,tabTypes:[],status:void 0,mode:"create",tab:{tabId:void 0,currentVersion:void 0,tabParentType:"biz",tabType:"6",hasSubTab:0,tabName:void 0,tabCnTitle:void 0,tabEnTitle:void 0,tabCategory:67,tabAppid:-1,tabResource:"",pictureName:void 0,tabTitleIcons:void 0,tabParams:{},tabStatus:void 0,tabOnclick:void 0,systemDefault:0,timeCycle:120,cornerIconName:void 0,flagIsRecord:0,isTiming:0,releaseTime:void 0,tabExtArr:void 0,pannelList:[],specificPannelList:void 0,tabList:void 0},rules:{tabName:[{required:!0,message:"请输入版面名称",trigger:"blur"}],tabCnTitle:[{required:!0,message:"请输入中文标题",trigger:"blur"}],tabEnTitle:[{required:!0,message:"请输入英文标题",trigger:"blur"}]}}},computed:{resourceInfo:function(){var e=this.tab;if(e.tabId)return{id:e.tabId,type:"tab",menuElId:"tabInfo",version:e.currentVersion,status:e.tabStatus}},isDisableTabType:function(){var e=this.mode;return"edit"===e||"replicate"===e||"copy"===e},isSignalTab:function(){return 5==this.tab.tabType},tabGroupTableHeader:function(){var e=this,t=[{label:"版块ID",prop:"pannelGroupId"},{label:"版块名称",width:180,render:function(t,a){a.$index;var n=a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handlePreviewPanel(n)}}},n.pannelGroupRemark)}},{prop:"duplicateVersion",label:"待审核副本",width:180,render:function(t,a){a.$index;var n=a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handlePreviewPanel(n,n.duplicateVersion)}}},n.duplicateVersion)}}];return"read"===this.mode||this.isSignalTab||t.push({label:"操作",width:80,render:function(t,a){var n=a.$index;a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handleRemovePannel(n)}}},"删除")}}),t},couldSetReleaseTime:function(){var e=this.mode,t=this.tab.currentVersion,a="create"===e||"copy"===e,n="edit"===e&&"V1"===t,i="10"===this.$consts.idPrefix;return i&&!(a||n)},isReplica:function(){return"replicate"===this.mode||"yes"===this.tab.duplicateVersion}},methods:{handleCopy:function(e){var t=this.getFormData();t.tabStatus=e,t.tabId=void 0,t.currentVersion="",this.validateFormData(t,function(){3===e?this.$refs.commonContent.showReleaseTimeSetter=!0:this.submit(t)}.bind(this))},validateFormData:function(e,t){var a,n=e.tabStatus,i=function(e){this.$message({type:"error",message:e})}.bind(this);n===this.$consts.draft?(e.tabName||(a="请填写版面名称"),a?i(a):t()):this.$refs.tabForm.validate(function(n){n?(0===e.pannelList.length&&(a="请选择版块"),a?i(a):t()):i("请把表单填写完整123")})},handleSubmitAudit:function(e){var t=this,a=this.getFormData();a.tabStatus=this.$consts.status.waiting,this.validateFormData(a,function(){t.couldSetReleaseTime?e?(a.isTiming=e.isTiming,a.releaseTime=e.releaseTime,t.submit(a)):t.$refs.commonContent.showReleaseTimeSetter=!0:t.submit(a)})},handleSaveDraft:function(){var e=this.getFormData();e.isTiming=void 0,e.releaseTime=void 0,e.tabStatus=this.$consts.status.draft,this.validateFormData(e,function(){this.submit(e)}.bind(this))},submit:function(e){var t=this;e=this.parseFormData(e),this.$service.businessTabSave({jsonStr:JSON.stringify(e)},"保存成功").then(function(e){t.showTimeShelf=!1,t.$emit("upsert-end")})},parseFormData:function(e){return e.tabParams&&(e.tabParams=JSON.stringify(e.tabParams)),e.pannelList&&(e.panelInfoList=e.pannelList.map(function(e,t){return{pannelGroupId:e.pannelGroupId,pannelSequence:t,isDmpPanel:!1}}),e.pannelList=void 0),e.tabList&&(e.tabJson=JSON.stringify(e.tabList),e.tabList=void 0),e},getFormData:function(){var e=JSON.parse(JSON.stringify(this.tab)),t=this.mode;return"replicate"===t&&(e.currentVersion=""),"copy"===t&&(e.tabId=void 0,e.currentVersion=""),e},handlePreviewPanel:function(e,t){var a=e,n=t||a.currentVersion;this.activePage="panel_preview",this.panelPreview={panel:a,initMode:"read",id:a.pannelGroupId,dataType:a.pannelType,version:n}},handlePreviewPanelEnd:function(){var e=this.panelPreview.panel;this.updatePanelVersion(e),this.panelPreview=null,this.activePage="tab_info"},handleSelectPanelEnd:function(e){var t=e||[],a=this.tab.pannelList||[],n=a.reduce(function(e,t,a){return e[t.pannelGroupId]=a,e},{}),i=[];t.forEach(function(e){var t=n[e.pannelGroupId];void 0===t&&i.push(e)}),this.tab.pannelList=a.concat(i)},handleRemovePannel:function(e){this.tab.pannelList.splice(e,1)},handleChangeTabResource:function(e){this.$confirm("是否要切换内容源，切换内容源之后所选择的版块数据将会清除掉！","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){this.tab.tabResource=e,this.tab.pannelList=[]}.bind(this)).catch(function(){})},updatePanelVersion:function(e,t){this.$service.panelPageList({pannelType:e.pannelType,pannelId:e.pannelGroupId}).then(function(a){var n=a.rows[0];Object.assign(e,n),t&&t()})},getTabType:function(){var e=this;return this.$service.getTabType({tabParentType:"biz"}).then(function(t){e.tabTypes=t.reduce(function(e,t){return e.push({label:t.dictCnName,value:t.dictEnName,disabled:"6"!==t.dictEnName}),e},[])})},fetchData:function(e){var t=this;this.$service.businessTabEdit({id:this.id,version:e}).then(function(e){t.tab.pannelList=e.panelInfoList.map(function(e){return e.pannelGroupRemark=e.pannelName,e}),e.tabType=e.tabType.toString(),t.initSumTime=e.timeCycle,t.tab=Object.assign({},t.tab,e)})}},created:function(){this.getTabType(),this.mode=this.initMode||"create",this.id&&this.fetchData(this.version)}},Ev=Nv,Ov=(a("ccbd"),Object(Yo["a"])(Ev,Sv,kv,!1,null,"2939d506",null)),Av=Ov.exports,Vv={components:{BusinessTabList:Tv,BusinessTabInfo:Av},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0}},methods:{handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e.tabId,this.mode="edit",this.isShowList=!1},handleRead:function(e,t){this.id=e.tabId,this.mode="read",this.version=t,this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.businessTabDelete({id:e.map(function(e){return e.tabId}).join(",")},"删除成功").then(function(e){t.$refs.list.fetchData()})},handleCopy:function(e){this.id=e.tabId,this.mode="copy",this.isShowList=!1},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},Bv=Vv,Mv=(a("c4ef"),Object(Yo["a"])(Bv,vv,gv,!1,null,"55014bd8",null)),Uv=Mv.exports,Gv=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"resource-manager-wrapper"},[a("FilmDetailPageList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,read:e.handleRead,edit:e.handleEdit,delete:e.handleDelete}}),e.isShowList?e._e():a("FilmDetailPageAdd",{attrs:{id:e.id,initMode:e.mode,version:e.version},on:{"upsert-end":e.openListPage,"go-back":e.goBack}})],1)},jv=[],zv=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{pagination:e.pagination},on:{"filter-change":e.fetchData}},[a("div",{staticClass:"el-row"},[a("el-form",{ref:"filterForm",attrs:{rules:e.filterFormRules,model:e.filter,inline:"","label-width":"90px"}},[a("el-form-item",{staticClass:"el-col el-col-6",attrs:{prop:"tabId"}},[a("div",{staticClass:"el-col-20"},[a("InputPositiveInt",{attrs:{placeholder:"版面ID"},model:{value:e.filter.tabId,callback:function(t){e.$set(e.filter,"tabId",t)},expression:"filter.tabId"}})],1)]),a("el-form-item",{staticClass:"el-col el-col-6"},[a("div",{staticClass:"el-col-20"},[a("el-input",{attrs:{placeholder:"版面名称"},model:{value:e.filter.tabName,callback:function(t){e.$set(e.filter,"tabName",t)},expression:"filter.tabName"}})],1)]),a("el-form-item",{staticClass:"el-col el-col-6"},[a("div",{staticClass:"el-col-20"},[a("el-select",{attrs:{placeholder:"内容源",clearable:""},on:{change:function(t){e.pannelValue=[],e.filter["filmDetailPageInfo.channel"]=[]}},model:{value:e.filter["filmDetailPageInfo.source"],callback:function(t){e.$set(e.filter,"filmDetailPageInfo.source",t)},expression:"filter['filmDetailPageInfo.source']"}},[a("el-option",{attrs:{value:"qq",label:"腾讯"}}),a("el-option",{attrs:{value:"iqiyi",label:"爱奇艺"}}),a("el-option",{attrs:{value:"youku",label:"优酷"}})],1)],1)]),a("el-form-item",{staticClass:"el-col el-col-6"},[a("div",{staticClass:"el-col-20"},[a("el-select",{attrs:{clearable:"",placeholder:"状态"},model:{value:e.filter.tabStatus,callback:function(t){e.$set(e.filter,"tabStatus",t)},expression:"filter.tabStatus"}},e._l(e.tabStatusOption,function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1)]),a("el-form-item",{staticClass:"el-col el-col-6"},[a("div",{staticClass:"el-col-20"},[a("el-select",{attrs:{clearable:"",placeholder:"业务分类"},model:{value:e.filter["filmDetailPageInfo.category"],callback:function(t){e.$set(e.filter,"filmDetailPageInfo.category",t)},expression:"filter['filmDetailPageInfo.category']"}},[a("el-option",{attrs:{value:"0",label:"影视"}}),a("el-option",{attrs:{value:"1",label:"教育"}})],1)],1)]),a("el-form-item",{staticClass:"el-col el-col-6"},[a("div",{staticClass:"el-col-20"},[a("el-cascader",{attrs:{placeholder:"频道",value:e.filter["filmDetailPageInfo.channel"],options:e.channelOptions,"expand-trigger":"hover",clearable:""},on:{change:e.handleChannelChange}})],1)]),a("el-form-item",{staticClass:"el-col el-col-6"},[a("div",{staticClass:"el-col-20"},[a("el-select",{attrs:{clearable:"",placeholder:"产品包"},model:{value:e.filter["filmDetailPageInfo.product"],callback:function(t){e.$set(e.filter,"filmDetailPageInfo.product",t)},expression:"filter['filmDetailPageInfo.product']"}},[a("el-option",{attrs:{value:"0",label:"不限"}}),e._l(e.productOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.source_name,value:e.source_sign}})})],2)],1)]),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{on:{click:e.handleFilterReset}},[e._v("重置")])],1)],1)],1),a("ButtonGroupForListPage",{attrs:{pageName:"filmDetailPage"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},Wv=[],qv={extends:Sl["a"],components:{ContentWrapper:Bo["ContentWrapper"],ButtonGroupForListPage:kl["a"],Table:Bo["Table"],InputPositiveInt:vs["a"]},data:function(){var e=this;return{resourceType:"film",pannelValue:[],filter:this.genDefaultFilter(),efficientFilter:this.genDefaultFilter(),pagination:{currentPage:1},tabStatusOption:[{label:"下架",value:"0"},{label:"上架",value:"1"},{label:"草稿",value:"2"},{label:"待审核",value:"3"},{label:"审核通过",value:"4"},{label:"审核不通过",value:"5"}],productOptions:[],channelOptions:[],table:{props:{},data:[],header:[{prop:"tabId",label:"ID",sortable:!0},{prop:"tabName",label:"版面名称",minWidth:180,"show-overflow-tooltip":!0,render:function(t,a){var n=a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handleRead(n)}}},n.tabName)}},{prop:"filmDetailPageInfo.priority",label:"优先级",sortable:!0},{prop:"tabCategory",label:"业务分类",sortable:!0,formatter:function(e){return 0===e.tabCategory||67===e.tabCategory?"影视":1===e.tabCategory?"教育":""}},{prop:"filmDetailPageInfo.source",label:"内容源",sortable:!0,formatter:function(e){if(0!==e.tabCategory&&67!==e.tabCategory)return"";switch(e.filmDetailPageInfo.source){case"qq":return"腾讯";case"iqiyi":return"爱奇艺";case"youku":return"优酷"}}},{prop:"tabStatus",label:"版本/状态",sortable:!0,formatter:function(e){return e.currentVersion+"/"+["下架","上架","草稿","待审核","审核通过","审核不通过"][e.tabStatus]}},{prop:"duplicateVersion",label:"待审核副本",sortable:!0,render:function(t,a){var n=a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handleRead(n,n.duplicateVersion)}}},n.duplicateVersion)}},{prop:"lastUpdateDate",label:"更新时间",sortable:!0,width:140},{prop:"modifierName",label:"更新人",sortable:!0},{prop:"auditor",label:"审核人",sortable:!0}],selected:[],selectionType:"multiple"},selected:[],filterFormRules:{tabId:[{validator:function(e,t,a){if(t&&!/^\d+$/.test(t))return a(Error("请输入数字"));a()}}]}}},methods:{genDefaultFilter:function(){return{tabType:3,tabId:void 0,tabName:void 0,tabStatus:void 0,"filmDetailPageInfo.source":void 0,"filmDetailPageInfo.channel":[],"filmDetailPageInfo.category":void 0,"filmDetailPageInfo.product":void 0}},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.tabInfoList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows,e.table.selected=[],e.selected=[]})},parseFilter:function(){var e=this.pagination,t=JSON.parse(JSON.stringify(this.efficientFilter));e&&(t.page=e.currentPage,t.rows=e.pageSize);var a=t["filmDetailPageInfo.channel"][1];return a&&(t["filmDetailPageInfo.channel"]=a),t},handleFilterChange:function(){var e=this;this.$refs.filterForm.validate(function(t){t&&(e.pagination.currentPage=1,e.efficientFilter=Object(Go["cloneDeep"])(e.filter),e.fetchData())})},handleFilterReset:function(){this.filter=this.genDefaultFilter(),this.efficientFilter=this.genDefaultFilter(),this.pannelValue=[],this.pagination.currentPage=1,this.fetchData()},getMediaResourceInfo:function(){var e=this;return this.$service.getMediaResourceInfo().then(function(t){var a=JSON.parse(decodeURI(t.slice(5,-1))),n=a.videoItemModels,i=n.reduce(function(e,t){return e.push(t.productList),e},[]),r=[].concat.apply([],i);e.productOptions=r;var o={label:"爱奇艺",value:"iqiyi",children:[]};o.children=n[0].categoryList.reduce(function(e,t){return e.concat({label:t.category_name,value:t.cc_category_id})},[]);var l={label:"腾讯",value:"qq",children:[]};l.children=n[1].categoryList.reduce(function(e,t){return e.concat({label:t.category_name,value:t.cc_category_id})},[]);var s={label:"优酷",value:"youku",children:[]};s.children=n[2].categoryList.reduce(function(e,t){return e.concat({label:t.category_name,value:t.cc_category_id})},[]),e.channelOptions.push(o),e.channelOptions.push(l),e.channelOptions.push(s)})},handleChannelChange:function(e){this.filter["filmDetailPageInfo.source"]="",this.filter["filmDetailPageInfo.source"]=e[0]}},created:function(){this.getMediaResourceInfo().then(function(){}),this.fetchData()}},Jv=qv,Hv=(a("7b32"),Object(Yo["a"])(Jv,zv,Wv,!1,null,"5b9a30ea",null)),Kv=Hv.exports,Yv=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PageWrapper",[a("PageContentWrapper",{directives:[{name:"show",rawName:"v-show",value:"tab_info"===e.activePage,expression:"activePage === 'tab_info'"}]},[a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("CommonContent",{ref:"commonContent",attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{edit:function(t){e.mode="edit"},replicate:function(t){e.mode="replicate"},"submit-audit":e.btnAudit,"save-draft":e.btnSave,"select-version":e.fetchData,unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,audit:function(t){return e.$emit("upsert-end")},delete:function(t){return e.$emit("upsert-end",t)}}},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),"read"!==e.mode?[a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{rules:e.rules,model:e.form,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"版面名称",prop:"tabName"}},[a("el-input",{model:{value:e.form.tabName,callback:function(t){e.$set(e.form,"tabName",t)},expression:"form.tabName"}})],1),a("el-form-item",{attrs:{label:"业务分类"}},[a("el-select",{attrs:{disabled:e.categoryEdit},model:{value:e.form.tabCategory,callback:function(t){e.$set(e.form,"tabCategory",t)},expression:"form.tabCategory"}},[a("el-option",{attrs:{label:"影视",value:0}}),a("el-option",{attrs:{label:"教育",value:1}})],1)],1),0==e.form.tabCategory?a("el-form-item",{attrs:{label:"内容源"}},[a("el-radio-group",{attrs:{value:e.form.tabResource},on:{input:e.changeResource}},[a("el-radio",{attrs:{label:"qq"}},[e._v("腾讯")]),a("el-radio",{attrs:{label:"iqiyi"}},[e._v("爱奇艺")]),a("el-radio",{attrs:{label:"youku"}},[e._v("优酷")])],1)],1):e._e(),a("el-form-item",{attrs:{label:"频道"}},[a("el-select",{model:{value:e.pannel,callback:function(t){e.pannel=t},expression:"pannel"}},[a("el-option",{attrs:{value:"0",label:"不限"}}),e._l(e.pannelItems,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})],2)],1),a("el-form-item",{attrs:{label:"产品包"}},[a("el-select",{model:{value:e.product,callback:function(t){e.product=t},expression:"product"}},[a("el-option",{attrs:{value:"0",label:"不限"}}),e._l(e.productItems,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})],2)],1),a("el-form-item",{attrs:{label:"优先级"}},[a("el-input-number",{attrs:{min:1},model:{value:e.form.priority,callback:function(t){e.$set(e.form,"priority",t)},expression:"form.priority"}}),a("span",{staticClass:"remarks marginL"},[e._v("注：数值越大优先级越高，数值越小优先级越低")])],1),a("el-form-item",{attrs:{label:"选择版块",prop:"tags"}},[a("cc-panel-selector-el",{ref:"panelSelector",attrs:{source:e.form.tabResource},on:{"select-end":e.handleSelectPanelEnd}}),a("el-dropdown",[a("el-button",{staticClass:"marginL",attrs:{type:"primary",plain:""}},[e._v("\n                    添加版块\n                    "),a("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(t){e.activePage="panel"}}},[e._v("常规版块")]),a("el-dropdown-item",{nativeOn:{click:function(t){e.activePage="album_panel"}}},[e._v("业务专辑")]),a("el-dropdown-item",{nativeOn:{click:function(t){e.activePage="private_panel"}}},[e._v("专属影院")])],1)],1),a("OrderableTable",{staticClass:"orderableTable",attrs:{header:e.tabGroupTableHeader,"hide-action":!0},model:{value:e.form.panelInfoList,callback:function(t){e.$set(e.form,"panelInfoList",t)},expression:"form.panelInfoList"}})],1)],1)]:e._e(),"read"===e.mode?[a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{rules:e.rules,model:e.form,"label-width":"90px"}},[a("el-form-item",{attrs:{label:"版面名称",prop:"tabName"}},[e._v(e._s(e.form.tabName))]),a("el-form-item",{attrs:{label:"业务分类",prop:"tabCategory"}},[e._v(e._s(0==e.form.tabCategory?"影视":"教育"))]),0==e.form.tabCategory?a("el-form-item",{attrs:{label:"内容源",prop:"tabResource"}},[e._v(e._s(e.sourceText[e.form.tabResource]))]):e._e(),a("el-form-item",{attrs:{label:"频道"}},[a("el-select",{attrs:{disabled:!0},model:{value:e.pannel,callback:function(t){e.pannel=t},expression:"pannel"}},[a("el-option",{attrs:{value:"0",label:"不限"}}),e._l(e.pannelItems,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})],2)],1),a("el-form-item",{attrs:{label:"产品包"}},[a("el-select",{attrs:{disabled:!0},model:{value:e.product,callback:function(t){e.product=t},expression:"product"}},[a("el-option",{attrs:{value:"0",label:"不限"}}),e._l(e.productItems,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})],2)],1),a("el-form-item",{attrs:{label:"优先级",prop:"priority"}},[e._v("\n              "+e._s(e.form.priority)+"\n            ")]),a("el-form-item",{attrs:{label:"选择的版块",prop:"tags"}},[a("OrderableTable",{staticClass:"orderableTable",attrs:{header:e.tabGroupTableHeader,"hide-action":!0,readonly:!0},model:{value:e.form.panelInfoList,callback:function(t){e.$set(e.form,"panelInfoList",t)},expression:"form.panelInfoList"}})],1)],1)]:e._e()],2)],1)],1),"panel_preview"===e.activePage?a("PageContentWrapper",[[5,9,10].indexOf(e.panelPreview.dataType)>-1?a("PrivatePanelInfo",{attrs:{"title-prefix":e.title,"init-mode":e.panelPreview.initMode,id:e.panelPreview.id,version:e.panelPreview.version},on:{"upsert-end":e.handlePreviewPanelEnd,"go-back":e.handlePreviewPanelEnd}}):a("PanelInfo",{attrs:{"title-prefix":e.title,"init-mode":e.panelPreview.initMode,id:e.panelPreview.id,version:e.panelPreview.version,"panel-data-type":e.panelPreview.dataType,"init-group-index":e.panelPreview.initGroupIndex,"init-block-index":e.panelPreview.initBlockIndex},on:{"upsert-end":e.handlePreviewPanelEnd,"go-back":e.handlePreviewPanelEnd}})],1):e._e(),"panel"===e.activePage?a("PageContentWrapper",[a("PanelInfo",{attrs:{"title-prefix":e.title,"init-mode":"create","panel-data-type":1},on:{"upsert-end":function(t){e.activePage="tab_info"},"go-back":function(t){e.activePage="tab_info"}}})],1):e._e(),"album_panel"===e.activePage?a("PageContentWrapper",[a("PanelInfo",{attrs:{"title-prefix":e.title,"init-mode":"create","panel-data-type":3},on:{"upsert-end":function(t){e.activePage="tab_info"},"go-back":function(t){e.activePage="tab_info"}}})],1):e._e(),"private_panel"===e.activePage?a("PageContentWrapper",[a("PrivatePanelInfo",{attrs:{"title-prefix":e.title,"init-mode":"create"},on:{"upsert-end":function(t){e.activePage="tab_info"},"go-back":function(t){e.activePage="tab_info"}}})],1):e._e()],1)},Qv=[],Xv={mixins:[ds["a"]],components:{PageWrapper:eu["a"],PageContentWrapper:tu["a"],"cc-panel-selector-el":$v["a"],PrivatePanelInfo:Fd["a"],PanelInfo:Tu["a"],OrderableTable:Lv["a"],CommonContent:Ql["a"]},props:{id:Number,initMode:String,version:{type:String,default:function(){return""}}},watch:{"form.tabCategory":{deep:!0,handler:function(e,t){1===e?(this.pannelItems=this.eduProductItems.categoryList,this.productItems=this.eduProductItems.productList,0===this.eduProductItems.categoryList.length&&(this.pannel="不限"),0===this.tabResourceFlag?this.tabResourceFlag=1:(this.pannel="",this.product="")):0===e&&this.handleTabResourceChange(this.form.tabResource)}},"form.tabResource":function(e,t){this.handleTabResourceChange(e)}},data:function(){return{activePage:"tab_info",panelPreview:{panel:null,id:void 0,version:void 0,initMode:void 0,initGroupIndex:void 0,initBlockIndex:void 0},resourceName:"影片详情页",mode:"create",rules:{tabName:[{required:!0,message:"请输入主题名称",trigger:"blur"}]},sourceText:{qq:"腾讯",iqiyi:"爱奇艺",youku:"优酷"},form:{tabId:void 0,tabName:"",tabParentType:"special",tabCategory:0,tabResource:"qq",priority:1,currentVersion:"",currentStatus:"",panelInfoList:[]},globalTabResource:"",parentResource:"",tabResourceFlag:1,iqiyiSource:[],qqSource:[],youkuSource:[],pannel:"0",pannelItems:[],product:"0",productItems:[],eduProductItems:[],blockTable:[],categoryEdit:!1}},computed:{resourceInfo:function(){var e=this.form;if(e.tabId)return{id:e.tabId,version:e.currentVersion,status:e.currentStatus,type:"tab",menuElId:"tabInfo"}},isDisableTabType:function(){var e=this.mode;return"edit"===e||"replicate"===e||"copy"===e},tabGroupTableHeader:function(){var e=this,t=[{label:"版块ID",prop:"pannelGroupId"},{label:"版块名称",width:180,render:function(t,a){a.$index;var n=a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handlePreviewPanel(n)}}},n.pannelGroupRemark)}},{prop:"duplicateVersion",label:"待审核副本",width:180,render:function(t,a){a.$index;var n=a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handlePreviewPanel(n,n.duplicateVersion)}}},n.duplicateVersion)}}];return"read"!==this.mode&&t.push({label:"操作",width:80,render:function(t,a){var n=a.$index;a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handleRemovePanel(n)}}},"删除")}}),t}},methods:{handlePreviewPanel:function(e,t){var a=e,n=t||a.currentVersion;a.pannelGroupId>0?(this.activePage="panel_preview",this.panelPreview={panel:a,initMode:"read",id:a.pannelGroupId,dataType:a.pannelType,version:n}):this.$message({type:"error",message:"版块来自第三方数据，无法预览"})},handlePreviewPanelEnd:function(){var e=this.panelPreview.panel;this.updatePanelVersion(e),this.panelPreview=null,this.activePage="tab_info"},handleSelectPanelEnd:function(e){var t=this.form.panelInfoList||[];0===t.length&&(t=[{pannelGroupId:"-1002",pannelGroupRemark:"花絮"},{pannelGroupId:"-1001",pannelGroupRemark:"相关推荐"},{pannelGroupId:"-1003",pannelGroupRemark:"相关明星"},{pannelGroupId:"-1004",pannelGroupRemark:"系列剧"}]);var a=e||[],n=t.reduce(function(e,t,a){return e[t.pannelGroupId]=a,e},{}),i=[];a.forEach(function(e){var t=n[e.pannelGroupId];void 0===t&&i.push(e)}),this.form.panelInfoList=t.concat(i)},updatePanelVersion:function(e,t){this.$service.panelPageList({pannelType:e.pannelType,pannelId:e.pannelGroupId}).then(function(a){var n=a.rows[0];Object.assign(e,n),t&&t()})},btnAudit:function(){this.save(3)},btnSave:function(){this.save(2)},save:function(e){var t=this;if(0===this.form.panelInfoList.length)return this.$message("请添加版块"),!1;var a=this.mode,n=this.form;this.$refs.form.validate(function(i){if(i){n.panelInfoList&&(n.panelInfoList=n.panelInfoList.map(function(e,t){return{pannelGroupId:e.pannelGroupId,pannelSequence:t,isDmpPanel:!1}}));var r={tabParentType:"special",tabId:n.tabId,tabName:n.tabName,tabType:3,tabStatus:e,tabResource:0===n.tabCategory?n.tabResource:"",currentVersion:"replicate"===a?"":n.currentVersion,tabCategory:n.tabCategory,hasSubTab:0,tabCnTitle:n.tabName,filmDetailPageInfo:{source:0===n.tabCategory?n.tabResource:"",product:t.product||"0",channel:t.pannel||"0",category:n.tabCategory,priority:n.priority},panelInfoList:n.panelInfoList};console.log(r),t.$service.tabInfoUpsert(r,"保存成功").then(function(e){t.$emit("upsert-end")})}else t.$message("请将表单填写完整")})},changeResource:function(e){var t=this;this.$confirm("是否要切换内容源，切换内容源之后所选择的版块数据将会清除掉！","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$message({type:"success",message:"内容源切换成功!"}),t.form.tabResource=e,t.form.panelInfoList=[]}).catch(function(){t.$message({type:"info",message:"已取消切换"})})},handleRemovePanel:function(e){this.form.panelInfoList.splice(e,1)},getMediaResourceInfos:function(){var e=this,t=function(e,t,a){return e.map(function(e){return{label:e[t],value:e[a]}})};return this.$service.getMediaResourceInfo().then(function(a){var n=JSON.parse(decodeURI(a.slice(5,-1))),i=n.videoItemModels,r={categoryList:[],productList:[]};r.categoryList=t(i[0].categoryList,"category_name","cc_category_id"),r.productList=t(i[0].productList,"source_name","source_sign"),e.iqiyiSource=r;var o={categoryList:[],productList:[]};o.categoryList=t(i[1].categoryList,"category_name","cc_category_id"),o.productList=t(i[1].productList,"source_name","source_sign"),e.qqSource=o;var l={categoryList:[],productList:[]};l.categoryList=t(i[2].categoryList,"category_name","cc_category_id"),l.productList=t(i[2].productList,"source_name","source_sign"),e.youkuSource=l;var s={categoryList:[],productList:[]};s.categoryList=t(i[3].categoryList,"category_name","cc_category_id"),s.productList=t(i[3].productList,"source_name","source_sign"),e.eduProductItems=s})},handleTabResourceChange:function(e){var t=this.qqSource,a=this.iqiyiSource,n=this.youkuSource;switch(0===this.tabResourceFlag&&this.globalTabResource===e?this.tabResourceFlag=1:(this.pannel="0",this.product="0"),e){case"qq":this.pannelItems=t.categoryList,this.productItems=t.productList;break;case"iqiyi":this.pannelItems=a.categoryList,this.productItems=a.productList;break;case"youku":this.pannelItems=n.categoryList,this.productItems=n.productList;break;default:this.pannelItems=[],this.productItems=[]}},setFormInfo:function(e){this.form.tabId=e.tabId,this.form.tabName=e.tabName,this.form.tabCategory=e.tabCategory,this.form.priority=e.filmDetailPageInfo.priority,this.form.tabResource=e.tabResource,this.form.currentVersion=e.currentVersion,this.form.currentStatus=e.tabStatus,this.globalTabResource=e.tabResource,this.pannel=e.filmDetailPageInfo.channel,this.product=e.filmDetailPageInfo.product,this.form.panelInfoList=e.panelInfoList.map(function(e){return e.pannelGroupRemark=e.pannelName,e}),this.tabResourceFlag=0},fetchData:function(e){var t=this;this.$service.tabInfoGet({id:this.id,version:e,tabType:3}).then(function(e){t.setFormInfo(e)})}},created:function(){var e=this;this.mode=this.initMode||"create",this.getMediaResourceInfos().then(function(){e.handleTabResourceChange(e.form.tabResource),e.id&&(e.categoryEdit=!0,e.form.tabResource="",e.fetchData(e.version))})}},Zv=Xv,eg=(a("f618"),Object(Yo["a"])(Zv,Yv,Qv,!1,null,"4596e715",null)),tg=eg.exports,ag={components:{FilmDetailPageList:Kv,FilmDetailPageAdd:tg},data:function(){return{isShowList:!0,id:void 0,mode:"",version:""}},methods:{handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e.tabId,this.mode="edit",this.isShowList=!1},handleRead:function(e,t){this.id=e.tabId,this.mode="read",this.version=t,this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.businessTabDelete({id:e.map(function(e){return e.tabId}).join(",")},"删除成功").then(function(e){t.$refs.list.fetchData()})},goBack:function(){this.isShowList=!0},openListPage:function(){this.isShowList=!0,this.$refs.list.fetchData()}}},ng=ag,ig=(a("748c"),Object(Yo["a"])(ng,Gv,jv,!1,null,"20d3c755",null)),rg=ig.exports,og=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("VideoSelector",{ref:"video-selector",attrs:{"selection-type":"none"}})],1)},lg=[],sg=a("25d0"),cg={components:{VideoSelector:sg["a"]}},ug=cg,dg=(a("adca"),Object(Yo["a"])(ug,og,lg,!1,null,"5daded01",null)),pg=dg.exports,hg=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("DepartmentManageList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{"open-add-page":e.openAddPage}}),e.isShowList?e._e():a("DepartmentManageAdd",{attrs:{editId:e.editId},on:{"open-list-page":e.openListPage,"go-back":e.goBack}})],1)},mg=[],fg=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"sysDept"},on:{add:e.addDep,edit:e.editData,delete:e.batchDel}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},vg=[],gg={components:{ContentWrapper:Bo["ContentWrapper"],Table:Bo["Table"],ButtonGroupForListPage:kl["a"]},data:function(){var e=this;return{canEdit:!1,filterSchema:null,filter:{sort:void 0,order:void 0},pagination:{},selected:[],table:{props:{},header:[{label:"部门名称",prop:"deptName",fit:!0,sortable:!0},{label:"部门电话",prop:"deptTel",fit:!0,sortable:!0},{label:"部门传真",prop:"deptFax",fit:!0,sortable:!0},{label:"是否禁用",prop:"disabled",fit:!0,sortable:!0,render:function(e,t){var a=t.row;return e("div",{style:{color:["red","green"][a.disabled]}},["否","是"][a.disabled])}},{label:"备注",prop:"remark",fit:!0,sortable:!0},{label:"排序",prop:"seq",width:100,sortable:!0,render:function(t,a){var n=a.row;return e.canEdit?t(q["Input"],{ref:"input",props:{value:n.seq},on:{input:function(e){n.seq=e},blur:function(t){e.$service.sysDeptUpdateSeq({id:n.deptId,seq:n.seq})}}}):n.seq}},{label:"部门父编号",prop:"pid",fit:!0,sortable:!0}],data:[],selected:[],selectionType:"multiple"}}},methods:{fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.sysDeptPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},addDep:function(){this.$emit("open-add-page",null)},editData:function(){this.$isAllowEdit(this.selected)&&this.$emit("open-add-page",this.selected[0])},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},handleFilterChange:function(e,t){t&&(this.filter=t),"query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData()},batchDel:function(){var e=this;0!==this.selected.length?this.$confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$service.sysDeptRemove({id:e.selected.join(",")},"删除成功").then(function(t){e.handleAllRowSelectionRemove(),e.fetchData()})}):this.$message("请选择再删除")},handleRowSelectionAdd:function(e){this.selected.push(e.deptId),this.updateTableSelected()},handleRowSelectionRemove:function(e){this.selected=this.selected.filter(function(t){return t!==e.deptId}),this.updateTableSelected()},handleAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleRowSelectionAdd):(this.selected=[],this.table.selected=[])},handleAllRowSelectionRemove:function(){this.selected=[],this.table.selected=[]},updateTableSelected:function(){var e=this.table,t=this.selected;e.selected=e.data.reduce(function(e,a,n){return t.indexOf(a.deptId)>-1&&e.push(n),e},[])}},created:function(){var e=this,t=ll.a.map({deptName:ll.a.o.string.other("form",{placeholder:"部门名称"}),deptTel:ll.a.o.string.other("form",{placeholder:"部门电话"}),deptFax:ll.a.o.string.other("form",{placeholder:"部门传真"}),remark:ll.a.o.string.other("form",{placeholder:"备注"}),pid:ll.a.o.number.other("form",{placeholder:"部门父编号"}),disabled:ll.a.o.enum({"否":0,"是":1}).other("form",{component:"Select",placeholder:"是否禁用"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=t,this.fetchData(),this.$service.getButtonGroupForPageList("sysDept").then(function(t){e.canEdit=t.some(function(e){return"edit"===e.runComm})})}},bg=gg,yg=(a("d8c0"),Object(Yo["a"])(bg,fg,vg,!1,null,"12eef77a",null)),wg=yg.exports,Ig=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitBtn}},[e._v("保存")]),a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{model:e.formData,rules:e.formRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"部门名称",prop:"deptName"}},[a("el-input",{attrs:{placeholder:"部门名称"},model:{value:e.formData.deptName,callback:function(t){e.$set(e.formData,"deptName",t)},expression:"formData.deptName"}})],1),a("el-form-item",{attrs:{label:"部门电话",prop:"deptTel"}},[a("el-input",{attrs:{placeholder:"部门电话"},model:{value:e.formData.deptTel,callback:function(t){e.$set(e.formData,"deptTel",t)},expression:"formData.deptTel"}})],1),a("el-form-item",{attrs:{label:"部门传真",prop:"deptFax"}},[a("el-input",{attrs:{placeholder:"部门传真"},model:{value:e.formData.deptFax,callback:function(t){e.$set(e.formData,"deptFax",t)},expression:"formData.deptFax"}})],1),a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{attrs:{placeholder:"备注"},model:{value:e.formData.remark,callback:function(t){e.$set(e.formData,"remark",t)},expression:"formData.remark"}})],1),a("el-form-item",{attrs:{label:"排序",prop:"seq"}},[a("el-input",{attrs:{placeholder:"排序"},model:{value:e.formData.seq,callback:function(t){e.$set(e.formData,"seq",t)},expression:"formData.seq"}})],1),a("el-form-item",{attrs:{label:"上级部门",prop:"pid"}},[a("el-select",{attrs:{placeholder:"所在部门"},model:{value:e.formData.pid,callback:function(t){e.$set(e.formData,"pid",t)},expression:"formData.pid"}},[a("el-option",{attrs:{label:"无",value:"0"}}),e._l(e.pidList,function(e){return a("el-option",{key:e.deptId+"",attrs:{label:e.deptName,value:e.deptId}})})],2)],1),a("el-form-item",{attrs:{label:"是否禁用",prop:"disabled"}},[a("el-radio",{attrs:{label:"0"},model:{value:e.formData.disabled,callback:function(t){e.$set(e.formData,"disabled",t)},expression:"formData.disabled"}},[e._v("否")]),a("el-radio",{attrs:{label:"1"},model:{value:e.formData.disabled,callback:function(t){e.$set(e.formData,"disabled",t)},expression:"formData.disabled"}},[e._v("是")])],1)],1)],1)},Cg=[],Tg={props:{editId:Number,default:null},data:function(){return{title:null,pidList:[],formData:{deptName:"",deptTel:"",deptFax:"",remark:"",seq:null,disabled:"0",pid:"0"},formRules:{deptName:[{required:!0,message:"请输入部门名称",trigger:"blur"}],deptTel:[{required:!0,message:"请输入部门电话",trigger:"blur"}],deptFax:[{required:!0,message:"请输入部门传真",trigger:"blur"}],remark:[{required:!0,message:"请输入备注",trigger:"blur"}],seq:[{required:!0,message:"请输入序号",trigger:"blur"}]}}},methods:{submitBtn:function(){var e=this;this.$refs.form.validate(function(t){if(t){var a=e.formData;e.editId&&(a.deptId=e.editId),e.$service.sysDeptSave(a,"保存成功").then(function(){e.$emit("open-list-page")})}})},getDepts:function(){var e=this;return this.$service.getDepts().then(function(t){e.pidList=t})},getEditData:function(){var e=this;this.$service.sysDeptDetailInfo({id:this.editId}).then(function(t){Object.keys(e.formData).forEach(function(a){e.formData[a]="disabled"===a?t[a]+"":t[a]})})}},created:function(){this.getDepts(),this.editId?(this.title="编辑",this.getEditData()):this.title="新增"}},Sg=Tg,kg=(a("6483"),Object(Yo["a"])(Sg,Ig,Cg,!1,null,"a4d45264",null)),_g=kg.exports,Pg={components:{DepartmentManageList:wg,DepartmentManageAdd:_g},data:function(){return{isShowList:!0,editId:null}},methods:{openAddPage:function(e){this.editId=e,this.isShowList=!1},openListPage:function(){this.isShowList=!0,this.$refs.list.fetchData()},goBack:function(){this.isShowList=!0}}},xg=Pg,Fg=Object(Yo["a"])(xg,hg,mg,!1,null,"31b2cce4",null),Dg=Fg.exports,Rg=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("RoleConfigList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{"open-add-page":e.openAddPage}}),e.isShowList?e._e():a("RoleConfigAdd",{attrs:{editId:e.editId},on:{"open-list-page":e.openListPage,"go-back":e.goBack}})],1)},Lg=[],$g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("el-button",{attrs:{type:"primary"},on:{click:e.saveRoleInfo}},[e._v("保存")]),a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{model:e.formData,rules:e.formRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[a("el-input",{attrs:{placeholder:"用户名称"},model:{value:e.formData.roleName,callback:function(t){e.$set(e.formData,"roleName",t)},expression:"formData.roleName"}})],1),a("el-form-item",{attrs:{label:"排序号",prop:"seq"}},[a("el-input",{attrs:{placeholder:"用户名称"},model:{value:e.formData.seq,callback:function(t){e.$set(e.formData,"seq",t)},expression:"formData.seq"}})],1),a("el-form-item",{attrs:{label:"说明",prop:"roleDesc"}},[a("el-input",{attrs:{placeholder:"用户名称"},model:{value:e.formData.roleDesc,callback:function(t){e.$set(e.formData,"roleDesc",t)},expression:"formData.roleDesc"}})],1)],1)],1)},Ng=[],Eg={name:"RoleConfigAdd",props:{editId:void 0,index:void 0},data:function(){return{title:"",formData:{roleName:"",seq:"",roleDesc:""},formRules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"}],seq:[{required:!0,message:"请输入排序号",trigger:"blur"}],roleDesc:[{required:!0,message:"请输入角色说明",trigger:"blur"}]}}},methods:{saveRoleInfo:function(){var e=this;this.$refs.form.validate(function(t){t&&e.$service.saveRoleData({jsonStr:JSON.stringify(e.formData)},"保存成功").then(function(t){e.$emit("open-list-page")})})},getEditData:function(){var e=this;this.$service.getRoleDetailById({id:this.editId}).then(function(t){Object.keys(e.formData).forEach(function(a){e.formData[a]=t[a]})})}},created:function(){null!==this.editId&&void 0!==this.editId?(this.title="编辑",this.formData.roleId=this.editId,this.getEditData()):this.title="新增"}},Og=Eg,Ag=Object(Yo["a"])(Og,$g,Ng,!1,null,"a6e1bc36",null),Vg=Ag.exports,Bg=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"sysRole"},on:{add:e.handleCreate,edit:e.editData,delete:e.handleBatchDelete}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1),a("el-dialog",{attrs:{title:"查看用户",visible:e.viewUserDialogVisible},on:{"update:visible":function(t){e.viewUserDialogVisible=t}}},[a("el-table",{attrs:{data:e.userRoleData,border:""}},[a("el-table-column",{attrs:{label:"用户ID",property:"userId"}}),a("el-table-column",{attrs:{label:"用户名",property:"userName"}}),a("el-table-column",{attrs:{label:"公司部门",property:"deptName"}}),a("el-table-column",{attrs:{label:"电子邮箱",property:"email"}})],1)],1),a("el-dialog",{staticClass:"auth-set-window",attrs:{title:"权限设置",visible:e.setAuthDialogVisible,fullscreen:!0},on:{"update:visible":function(t){e.setAuthDialogVisible=t}}},[a("div",{staticClass:"auth-set-window__buttons"},[a("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAllValue,callback:function(t){e.checkAllValue=t},expression:"checkAllValue"}},[e._v("全选")]),a("el-button",{staticClass:"button--position",attrs:{type:"primary"},on:{click:function(t){return e.updateAuth()}}},[e._v("保存修改")]),a("el-button",{attrs:{type:"info"},on:{click:function(t){e.setAuthDialogVisible=!1}}},[e._v("关闭")])],1),a("div",{staticClass:"auth-set-window__header"},e._l(e.headerItems,function(t,n){return a("span",{key:n,staticClass:"auth-set-window__header-item"},[e._v(e._s(t))])}),0),a("div",{staticClass:"auth-set-window__content"},[a("el-tree",{attrs:{data:e.AuthList,"node-key":"menuId","default-expand-all":"","expand-on-click-node":""},scopedSlots:e._u([{key:"default",fn:function(t){t.node;var n=t.data;return a("span",{},[a("span",{staticClass:"tree-data tree-data--big-size"},[e._v(e._s(n.title))]),e._l(e.dataItems,function(e,t){return a("span",{key:t,staticClass:"tree-data",on:{click:function(e){e.stopPropagation()}}},[a("el-checkbox",{key:n.menuId+t+Math.random(),attrs:{value:1==n[e],disabled:-1==n[e]},on:{input:function(t){n[e]=t?"1":"0"}}})],1)})],2)}}])})],1)]),a("el-dialog",{attrs:{title:"数据权限设置",visible:e.showAuthOfCrowdDialog},on:{"update:visible":function(t){e.showAuthOfCrowdDialog=t}}},[a("div",{directives:[{name:"show",rawName:"v-show",value:0===e.policies.length,expression:"policies.length === 0"}]},[e._v("加载中...")]),e._l(e.policies,function(t){return a("div",{key:t.value,staticClass:"crowd-selector"},[a("span",{staticClass:"crowd-selector__policy ellipsis",attrs:{title:t.label}},[e._v(e._s(t.label))]),a("div",{staticClass:"crowd-selector__crowd-list"},e._l(t.crowds,function(t,n){return a("el-tag",{key:n,class:{ellipsis:!0,"crowd-selector__crowd":!0,"crowd-selector__crowd--disabled":1==t.disable},attrs:{type:"info",title:t.label},nativeOn:{click:function(a){return e.handleSelectCrowd(t)}}},[e._v(e._s(t.label))])}),1)])}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showAuthOfCrowdDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSaveAuth}},[e._v("确 定")])],1)],2)],1)},Mg=[],Ug=(a("55dd"),{components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"],ButtonGroupForListPage:kl["a"]},data:function(){var e=this;return{canEdit:!1,filter:{},filterSchema:ll.a.map({roleName:ll.a.o.string.other("form",{label:"角色名称",placeholder:"请输入角色名称",cols:{item:6,label:0,wrapper:18}})}).other("form",{layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}}),pagination:{},selected:[],table:{props:{},header:[{label:"角色名称",prop:"roleName"},{label:"排序号",prop:"seq",sortable:!0,render:function(t,a){var n=a.row;return e.canEdit?t("el-input",{props:{value:n.seq,type:"text"},on:{input:function(e){n.seq=e},blur:function(){e.$service.updateSeq({id:n.roleId,seq:n.seq})}}}):n.seq}},{label:"说明",prop:"roleDesc"},{label:"创建人",prop:"creatorName"},{label:"创建时间",width:"180",sortable:!0,prop:"createDate"},{label:"修改人",prop:"modifierName"},{label:"修改时间",width:"180",sortable:!0,prop:"modifyDate"},{label:"操作",fixed:"right",width:"350",render:function(t,a){var n=a.row,i=t("el-button",{attrs:{type:"text"},on:{click:function(){e.setAuth({row:n})}}},"设置权限"),r=t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleSetAuthOfCrowd({row:n})}}},"设置人群权限"),o=t("el-button",{attrs:{type:"text"},on:{click:function(){e.sysRoleView({row:n})}}},"查看用户"),l=[o];return e.canEdit&&(l.unshift(r),l.unshift(i)),t("div",null,l)}}],data:[],selected:[],selectionType:"multiple"},viewUserDialogVisible:!1,userRoleData:[],showAuthOfCrowdDialog:!1,policies:[],roleId:void 0,setAuthDialogVisible:!1,AuthList:[],isIndeterminate:!0,checkAllValue:!1,headerItems:[],dataItems:[],accessItemToRunId:{},accessList:[{label:"浏览",value:"browser",runId:1},{label:"新增",value:"add",runId:2},{label:"编辑",value:"edit",runId:3},{label:"删除",value:"delete",runId:4},{label:"内容权限",value:"contentAuthSetting",runId:17},{label:"搜索",value:"search",runId:5},{label:"刷新",value:"refresh",runId:6},{label:"打印",value:"print",runId:7},{label:"导入",value:"inport",runId:8},{label:"导出",value:"export",runId:9},{label:"审核",value:"audit",runId:10},{label:"认领",value:"claim",runId:11},{label:"撤销认领",value:"unclaim",runId:12},{label:"撤销审核",value:"unaudit",runId:13},{label:"上架",value:"shelves",runId:14},{label:"创建副本",value:"copy",runId:15},{label:"批量审核",value:"batchAudit",runId:16}]}},methods:{parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},handleCreate:function(){this.$emit("open-add-page",null)},handleBatchDelete:function(){var e=this;0!==this.selected.length?this.$confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$service.deleteRole({id:e.selected.join(",")},"删除成功").then(function(t){e.handleAllRowSelectionRemove(),e.fetchData()})}):this.$message("请选择再删除")},editData:function(){this.$isAllowEdit(this.selected)&&this.$emit("open-add-page",this.selected[0])},handleFilterChange:function(e,t){t&&(this.filter=t),"query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData()},handleFilterReset:function(){this.filter={roleName:void 0},this.pagination.currentPage=1,this.fetchData()},handleRowSelectionAdd:function(e){this.selected.push(e.roleId),this.updateTableSelected()},handleRowSelectionRemove:function(e){this.selected=this.selected.filter(function(t){return t!==e.roleId}),this.updateTableSelected()},handleAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleRowSelectionAdd):(this.selected=[],this.table.selected=[])},handleAllRowSelectionRemove:function(){this.selected=[],this.table.selected=[]},updateTableSelected:function(){var e=this.table,t=this.selected;e.selected=e.data.reduce(function(e,a,n){return t.indexOf(a.roleId)>-1&&e.push(n),e},[])},handleCheckAllChange:function(e){this.checkAllValue=e,this.isIndeterminate=!1;var t=this.dataItems;function a(n){n.forEach(function(n){t.forEach(function(t){"-1"!==n[t]&&(n[t]=e?"1":"0")}),n.children&&a(n.children)})}a(this.AuthList)},updateAuth:function(){var e=this,t=this.roleId,a=this.dataItems,n=this.accessItemToRunId,i=[];function r(e){e.forEach(function(e){a.forEach(function(t,a){"1"===e[t]&&i.push({menuId:e["menuId"],runId:n[t]})}),e.children&&r(e.children)})}r(this.AuthList),this.$service.saveAuthOfRole({roleId:t,mrs:JSON.stringify(i)},"设置成功").then(function(){e.setAuthDialogVisible=!1})},setAuth:function(e){var t=this,a=e.row;this.$service.getAuthList({roleId:a.roleId}).then(function(e){console.log(e),t.setAuthDialogVisible=!0,t.AuthList=e,t.roleId=a.roleId})},fetchPolicies:function(e){var t=this;this.$service.getTaglist({roleId:e,type:"crowdPolicy"}).then(function(a){t.policies=a,a.forEach(function(a){t.$service.getTaglist({id:a.value,roleId:e,type:"crowd"}).then(function(e){console.log(e),t.$set(a,"crowds",e)})})})},handleSelectCrowd:function(e){e.disable=1===e.disable?0:1},handleSetAuthOfCrowd:function(e){var t=e.row;this.showAuthOfCrowdDialog=!0,this.policies=[],this.roleId=t.roleId,this.fetchPolicies(t.roleId)},handleSaveAuth:function(){var e=this,t=this.roleId,a=[],n=[],i=this.policies;i.forEach(function(e){var t=!0;e.crowds.forEach(function(e){1===e.disable?a.push(e.value):t=!1}),!1!==t&&e.crowds.length>0&&n.push(e.value)}),this.$service.setCrowdAuthOfRole({roleId:t,disableTagInfoList:[{type:"crowd",tagIds:a},{type:"crowdPolicy",tagIds:n}]},"设置成功").then(function(){e.showAuthOfCrowdDialog=!1})},sysRoleView:function(e){var t=this,a=e.row;this.viewUserDialogVisible=!0;var n=a.roleId;this.$service.userRoleList({roleId:n}).then(function(e){t.userRoleData=e})},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.getRoleList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=this,t=this.accessList.sort(function(e,t){return e.runId>t.runId?1:-1});this.accessItemToRunId=this.accessList.reduce(function(e,t){return e[t.value]=t.runId,e},{}),this.headerItems=["菜单名称"].concat(t.map(function(e){return e.label})),this.dataItems=t.map(function(e){return e.value}),this.fetchData(),this.$service.getButtonGroupForPageList("sysRole").then(function(t){e.canEdit=t.some(function(e){return"edit"===e.runComm})})}}),Gg=Ug,jg=(a("c67a"),Object(Yo["a"])(Gg,Bg,Mg,!1,null,"54988414",null)),zg=jg.exports,Wg={components:{RoleConfigAdd:Vg,RoleConfigList:zg},data:function(){return{isShowList:!0,editId:void 0,index:void 0}},methods:{openAddPage:function(e){this.editId=e,this.isShowList=!1},openListPage:function(){this.isShowList=!0,this.$refs.list.fetchData()},goBack:function(){this.isShowList=!0}}},qg=Wg,Jg=Object(Yo["a"])(qg,Rg,Lg,!1,null,null,null),Hg=Jg.exports,Kg=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},Yg=[],Qg={components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"]},data:function(){return{filter:{sort:void 0,order:void 0},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"id",width:"70"},{label:"用户名",width:"130",prop:"userName"},{label:"用户编号",prop:"userId",width:"90"},{label:"登录时间",prop:"loginTime",width:"150"},{label:"用户IP",prop:"loginIp",width:"150"},{label:"用户浏览器信息",prop:"userAgent","min-width":"100"},{label:"登录类型",prop:"loginType",width:"100"},{label:"说明",prop:"remark",width:"100"}],data:[],selected:[],selectionType:"multiple"}}},methods:{handleCreate:function(){this.$router.push({name:"prize-create"})},handleRowSelectionAdd:function(e){this.selected.push(e.id),this.updateTableSelected()},handleRowSelectionRemove:function(e){this.selected=this.selected.filter(function(t){return t!==e.id}),this.updateTableSelected()},handleAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleRowSelectionAdd):(this.selected=[],this.table.selected=[])},handleAllRowSelectionRemove:function(){this.selected=[],this.table.selected=[]},updateTableSelected:function(){var e=this.table,t=this.selected;e.selected=e.data.reduce(function(e,a,n){return t.indexOf(a.id)>-1&&e.push(n),e},[])},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.id)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();this.$service.getLoginLogList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=ll.a.map({userName:ll.a.o.string.other("form",{component:"Input",placeholder:"用户名  "}),id:ll.a.o.string.other("form",{component:"Input",placeholder:"ID  "}),loginIp:ll.a.o.string.other("form",{component:"Input",placeholder:"用户登陆IP"}),loginType:ll.a.o.string.other("form",{component:"Input",placeholder:"登陆类型"})}).other("form",{cols:{item:5,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},Xg=Qg,Zg=(a("3377"),Object(Yo["a"])(Xg,Kg,Yg,!1,null,"4de84716",null)),eb=Zg.exports,tb=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data}})],1)],1)},ab=[],nb={components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"]},data:function(){var e=this;return{filter:{sort:void 0,order:void 0},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"自增ID",prop:"id",width:"70",sortable:!0},{label:"操作者ID",prop:"userId",width:"60",sortable:!0},{label:"操作名称",prop:"userName"},{label:"菜单名称",prop:"menuName"},{label:"菜单Elid",prop:"menuElid"},{label:"执行的方法",prop:"execMethod"},{label:"操作的数据",prop:"opData",render:function(e,t){var a=t.row;return e(q["Tooltip"],{props:{content:a.opData,placement:"top"}},[e("div",{class:"operatiton-data"},[a.opData])])}},{label:"操作耗时",prop:"elapsedTime",fit:!0,sortable:!0},{label:"操作时间",prop:"createTime",fit:!0},{label:"操作",width:"90",fixed:"right",render:function(t,a){var n=a.row;return t(q["Button"],{props:{type:"success",icon:"el-icon-plus"},on:{click:e.handleCopy.bind(e,n)}},["复制"])}}],data:[],selected:[],selectionType:"multiple"}}},methods:{handleCopy:function(e){var t=e.opData,a=document.createElement("textarea");a.style.position="fixed",a.style.top="0",a.style.left="0",a.style.width="2em",a.style.height="2em",a.style.padding="0",a.style.border="none",a.style.outline="none",a.style.boxShadow="none",a.style.background="transparent",a.value=t,document.body.appendChild(a),a.select();try{var n=document.execCommand("copy");n&&this.$message({showClose:!0,message:"复制成功",type:"success"})}catch(i){this.$message({showClose:!0,message:"复制失败",type:"warning"})}document.body.removeChild(a)},handleFilterChange:function(e,t){if(t){var a=/^[0-9]*$/;if(t.id&&!a.test(t.id))return this.$message.error("id 应该为一个数字");if(t.userId&&!a.test(t.userId))return this.$message.error("操作着ID 应该为一个数字");this.filter=t}"query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData()},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();this.$service.sysLogOpPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=ll.a.map({id:ll.a.o.string.other("form",{component:"Input",placeholder:"ID  "}),userId:ll.a.o.string.other("form",{component:"Input",placeholder:"操作者ID  "}),userName:ll.a.o.string.other("form",{component:"Input",placeholder:"操作者名称"}),menuName:ll.a.o.string.other("form",{component:"Input",placeholder:"菜单名称"}),menuElid:ll.a.o.string.other("form",{component:"Input",placeholder:"菜单Elid  "}),execMethod:ll.a.o.string.other("form",{component:"Input",placeholder:"执行的方法  "}),elapsedTime:ll.a.o.string.other("form",{component:"Input",placeholder:"操作时间"}),createTime:ll.a.o.string.other("form",{component:"Input",placeholder:"操作耗时"}),opData:ll.a.o.string.other("form",{component:"Input",type:"textarea",placeholder:"操作的数据"})}).other("form",{cols:{item:5,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},ib=nb,rb=(a("971a"),Object(Yo["a"])(ib,tb,ab,!1,null,"5c1e62cf",null)),ob=rb.exports,lb=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("SysMenuList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{"open-add-page":e.openAddPage}}),e.isShowList?e._e():a("SysMenuAdd",{attrs:{editId:e.editId},on:{"open-list-page":e.openListPage,"go-back":e.goBack}})],1)},sb=[],cb=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.showIcon?e._e():a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitBtn}},[e._v("保存")]),a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{model:e.form,rules:e.formRules,"label-width":"160px"}},[a("el-form-item",{attrs:{label:"菜单名称",prop:"menuName"}},[a("el-input",{attrs:{placeholder:"菜单名称"},model:{value:e.form.menuName,callback:function(t){e.$set(e.form,"menuName",t)},expression:"form.menuName"}})],1),a("el-form-item",{attrs:{label:"元素ID",prop:"elid"}},[a("el-input",{attrs:{placeholder:"元素ID"},model:{value:e.form.elid,callback:function(t){e.$set(e.form,"elid",t)},expression:"form.elid"}})],1),a("el-form-item",{attrs:{label:"图标样式",prop:"iconClass"}},[a("el-input",{attrs:{placeholder:"图标样式"},model:{value:e.form.iconClass,callback:function(t){e.$set(e.form,"iconClass",t)},expression:"form.iconClass"}}),a("el-button",{staticClass:"marginL",attrs:{type:"primary",plain:""},on:{click:e.selectIcon}},[e._v("选择图标")])],1),a("el-form-item",{attrs:{label:"标签ID",prop:"tabId"}},[a("el-input",{attrs:{placeholder:"标签ID"},model:{value:e.form.tabId,callback:function(t){e.$set(e.form,"tabId",t)},expression:"form.tabId"}})],1),a("el-form-item",{attrs:{label:"标签名称",prop:"tabTitle"}},[a("el-input",{attrs:{placeholder:"标签名称"},model:{value:e.form.tabTitle,callback:function(t){e.$set(e.form,"tabTitle",t)},expression:"form.tabTitle"}})],1),a("el-form-item",{attrs:{label:"标签图标",prop:"tabIcon"}},[a("el-input",{attrs:{placeholder:"标签图标"},model:{value:e.form.tabIcon,callback:function(t){e.$set(e.form,"tabIcon",t)},expression:"form.tabIcon"}})],1),a("el-form-item",{attrs:{label:"跳转地址URL",prop:"iframeUrl"}},[a("el-input",{attrs:{placeholder:"跳转地址URL"},model:{value:e.form.iframeUrl,callback:function(t){e.$set(e.form,"iframeUrl",t)},expression:"form.iframeUrl"}})],1),a("el-form-item",{attrs:{label:"排序",prop:"seq"}},[a("el-input",{attrs:{placeholder:"排序"},model:{value:e.form.seq,callback:function(t){e.$set(e.form,"seq",t)},expression:"form.seq"}})],1),a("el-form-item",{attrs:{label:"菜单目录",prop:"modle"}},[a("el-radio",{attrs:{label:0},model:{value:e.form.modle,callback:function(t){e.$set(e.form,"modle",t)},expression:"form.modle"}},[e._v("收起")]),a("el-radio",{attrs:{label:1},model:{value:e.form.modle,callback:function(t){e.$set(e.form,"modle",t)},expression:"form.modle"}},[e._v("展开")]),a("el-radio",{attrs:{label:3},model:{value:e.form.modle,callback:function(t){e.$set(e.form,"modle",t)},expression:"form.modle"}},[e._v("媒资菜单")])],1),a("el-form-item",{attrs:{label:"是否禁用",prop:"disabled"}},[a("el-radio",{attrs:{label:"0"},model:{value:e.form.disabled,callback:function(t){e.$set(e.form,"disabled",t)},expression:"form.disabled"}},[e._v("否")]),a("el-radio",{attrs:{label:"1"},model:{value:e.form.disabled,callback:function(t){e.$set(e.form,"disabled",t)},expression:"form.disabled"}},[e._v("是")])],1),a("el-form-item",{attrs:{label:"菜单父ID",prop:"pmid"}},[a("el-input",{attrs:{placeholder:"菜单父ID"},model:{value:e.form.pmid,callback:function(t){e.$set(e.form,"pmid",t)},expression:"form.pmid"}})],1)],1)],1),e.showIcon?a("IconSelect",{attrs:{title:"选择图标",isUseInitialIcon:!0},on:{"get-icon":e.getIcon,"go-back":e.goBack}}):e._e()],1)},ub=[],db={props:{editId:Number,default:null},components:{IconSelect:Bo["IconSelect"]},data:function(){return{title:null,showIcon:!1,form:{menuName:null,elid:null,iconClass:null,tabId:null,tabTitle:null,tabIcon:null,iframeUrl:null,seq:null,modle:null,disabled:null,pmid:null,menuId:void 0},formRules:{menuName:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],elid:[{required:!0,message:"请输入元素ID",trigger:"blur"}],iconClass:[{required:!0,message:"请输入图标样式",trigger:"blur"}],tabId:[{required:!1,message:"请输入标签ID",trigger:"blur"}],tabTitle:[{required:!0,message:"请输入标签名称",trigger:"blur"}],tabIcon:[{required:!0,message:"请输入标签图标样式",trigger:"blur"}],iframeUrl:[{required:!0,message:"跳转地址URL",trigger:"blur"}],disabled:[{required:!0,message:"禁用",trigger:"blur"}],seq:[{required:!0,message:"请输入排序",trigger:"blur"}],modle:[{required:!0,message:"请选择菜单目录",trigger:"blur"}],pmid:[{required:!0,message:"请输入父菜单ID",trigger:"blur"}]}}},methods:{selectIcon:function(){this.showIcon=!0},goBack:function(){this.showIcon=!1},getIcon:function(e,t){this.form.iconClass=e,this.showIcon=!1},submitBtn:function(){var e=this;this.$refs.form.validate(function(t){t&&e.$service.saveSysMenu({jsonStr:JSON.stringify(e.form)},"保存成功").then(function(){e.$emit("open-list-page")})})},getEditData:function(){var e=this;this.$service.editSysMenu({id:this.editId}).then(function(t){Object.keys(e.form).forEach(function(a){e.form[a]="disabled"===a?t[a]+"":t[a]})})}},created:function(){null!==this.editId&&void 0!==this.editId?(this.title="编辑",this.form.menuId=this.editId,this.getEditData()):this.title="新增"}},pb=db,hb=Object(Yo["a"])(pb,cb,ub,!1,null,null,null),mb=hb.exports,fb=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"sysMenu"},on:{add:e.addData,edit:e.editData,delete:e.deleteData}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}}),e.setDialogVisible?a("el-dialog",{attrs:{title:"设置操作",visible:e.setDialogVisible},on:{"update:visible":function(t){e.setDialogVisible=t}}},[a("span",[a("el-transfer",{staticClass:"el-transfer",attrs:{data:e.sdata,titles:["待选操作","已选操作"]},on:{change:e.handleChange},model:{value:e.svalue,callback:function(t){e.svalue=t},expression:"svalue"}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.setDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.setDialogVisible=!1,e.setSave()}}},[e._v("确 定")])],1)]):e._e()],1)],1)},vb=[],gb={components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"],ButtonGroupForListPage:kl["a"]},data:function(){var e=this;return{canEdit:!1,filter:{sort:void 0,order:void 0},filterSchema:null,pagination:{},setDialogVisible:!1,svalue:[],sdata:[],allData:[],setMenuId:[],setMenu:[],selectMenu:[],data1:[],data2:[],selected:[],buttonList:[],table:{props:{},header:[{label:"菜单ID",prop:"menuId"},{label:"菜单名称",prop:"menuName"},{label:"元素ID",prop:"elid"},{label:"图标样式",prop:"iconClass"},{label:"标签ID",prop:"tabId"},{label:"标签名称",prop:"tabTitle"},{label:"标签图标",prop:"tabIcon"},{label:"跳转地址URL",prop:"iframeUrl"},{label:"排序",prop:"seq"},{label:"菜单目录",prop:"modle",render:function(e,t){var a=t.row,n={0:"收起",1:"展开",3:"媒资菜单"};return n[a.modle]}},{label:"禁用",prop:"disabled",render:function(e,t){var a=t.row;return a.disabled?"是":"否"}},{label:"父菜单ID",prop:"pmid"},{label:"操作",fixed:"right",render:function(t,a){var n=a.row;if(e.canEdit)return t("el-button",{attrs:{type:"text"},on:{click:function(){e.setData({row:n})}}},"设置操作")}}],data:[],selected:[],selectionType:"multiple"}}},methods:{addData:function(){this.$emit("open-add-page",null)},editData:function(){this.$isAllowEdit(this.selected)&&this.$emit("open-add-page",this.selected[0])},deleteData:function(){var e=this;0!==this.selected.length?this.$confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$service.deleteMenuById({id:e.selected.join(",")},"删除成功").then(function(t){e.handleAllRowSelectionRemove(),e.fetchData()})}):this.$message("请选择再删除")},handleCreate:function(){this.$router.push({name:"prize-create"})},handleRowSelectionAdd:function(e){this.selected.push(e.menuId),this.updateTableSelected()},handleRowSelectionRemove:function(e){this.selected=this.selected.filter(function(t){return t!==e.menuId}),this.updateTableSelected()},handleAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleRowSelectionAdd):(this.selected=[],this.table.selected=[])},handleAllRowSelectionRemove:function(){this.selected=[],this.table.selected=[]},updateTableSelected:function(){var e=this.table,t=this.selected;e.selected=e.data.reduce(function(e,a,n){return t.indexOf(a.menuId)>-1&&e.push(n),e},[])},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId([{label:"ID",value:this.filter.elid},{label:"标签ID",value:this.filter.tabId},{label:"菜单父ID",value:this.filter.pmid}])&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.getSysMenuList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},getSysMenuInfo:function(){var e=this;return this.$service.getMenuInfo().then(function(t){e.buttonList=t})},setData:function(e){var t=this,a=e.row;this.setDialogVisible=!0;var n={menuId:a.menuId},i=[],r=[],o=[];this.setMenuId=a.menuId,this.$service.getNotMenuByRunId(n).then(function(e){t.data1=e,t.$service.getMenuByRunId(n).then(function(e){t.data2=e,t.allData=t.data1.concat(t.data2);var a={};t.allData=t.allData.reduce(function(e,t){return a[t.runId]||(a[t.runId]=!0,e.push(t)),e},[]);for(var n=0;n<t.allData.length;n++)i.push({key:t.allData[n].runId,label:t.allData[n].runName});for(var l=0;l<t.data2.length;l++)r.push(t.data2[l].runId);for(var s=0;s<r.length;s++)-1===o.indexOf(r[s])&&o.push(r[s]);t.sdata=i,t.svalue=o,console.log(i),console.log(o)})})},handleChange:function(e,t,a){for(var n=[],i=0;i<e.length;i++)-1===n.indexOf(e[i])&&n.push(e[i]);var r=n.join(",");this.setMenu=r},setSave:function(){var e=this,t=this.setMenuId,a=this.setMenu;this.$service.saveMenuRun({menuId:t,runIds:a},"保存成功").then(function(){e.setDialogVisible=!1,e.fetchData()})}},created:function(){var e=this,t=ll.a.map({menuName:ll.a.o.string.other("form",{component:"Input",placeholder:"菜单名称"}),elid:ll.a.o.string.other("form",{component:"Input",placeholder:"元素ID"}),tabId:ll.a.o.string.other("form",{component:"Input",placeholder:"标签ID"}),iframeUrl:ll.a.o.string.other("form",{component:"Input",placeholder:"跳转地址URL"}),modle:ll.a.o.string.other("form",{component:"Input",placeholder:"菜单目录"}),pmid:ll.a.o.string.other("form",{component:"Input",placeholder:"菜单父ID"}),disabled:ll.a.o.enum({"否":"0","是":"1"}).other("form",{component:"Select",placeholder:"是否禁用"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=t,this.fetchData(),this.getSysMenuInfo(),this.$service.getButtonGroupForPageList("sysMenu").then(function(t){e.canEdit=t.some(function(e){return"edit"===e.runComm})})}},bb=gb,yb=(a("0c81"),Object(Yo["a"])(bb,fb,vb,!1,null,"09f3c986",null)),wb=yb.exports,Ib={components:{SysMenuAdd:mb,SysMenuList:wb},data:function(){return{isShowList:!0,editId:null}},methods:{openAddPage:function(e){this.editId=e,this.isShowList=!1},openListPage:function(){this.isShowList=!0,this.$refs.list.fetchData()},goBack:function(){this.isShowList=!0}}},Cb=Ib,Tb=Object(Yo["a"])(Cb,lb,sb,!1,null,null,null),Sb=Tb.exports,kb=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("UserConfigList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{"open-add-page":e.openAddPage}}),e.isShowList?e._e():a("UserConfigAdd",{attrs:{editId:e.editId},on:{"open-list-page":e.openListPage,"go-back":e.goBack}})],1)},_b=[],Pb=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitBtn}},[e._v("保存")]),a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{model:e.form,rules:e.formRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"用户名称",prop:"userName"}},[a("el-input",{attrs:{placeholder:"用户名称",maxlength:"50"},model:{value:e.form.userName,callback:function(t){e.$set(e.form,"userName",t)},expression:"form.userName"}})],1),a("el-form-item",{attrs:{label:"所在部门",prop:"deptId"}},[a("el-select",{attrs:{placeholder:"所在部门"},model:{value:e.form.deptId,callback:function(t){e.$set(e.form,"deptId",t)},expression:"form.deptId"}},e._l(e.departmentList,function(e){return a("el-option",{key:e.deptId+"",attrs:{label:e.deptName,value:e.deptId}})}),1)],1),a("el-form-item",{attrs:{label:"登录账号",prop:"loginName"}},[a("el-input",{attrs:{placeholder:"登录账号",maxlength:"50"},model:{value:e.form.loginName,callback:function(t){e.$set(e.form,"loginName",t)},expression:"form.loginName"}},[e._v(">")])],1),e.isShowloginPwd?a("el-form-item",{attrs:{label:"密码",prop:"loginPwd"}},[a("el-input",{attrs:{placeholder:"密码",maxlength:"50"},model:{value:e.form.loginPwd,callback:function(t){e.$set(e.form,"loginPwd",t)},expression:"form.loginPwd"}},[e._v(">")])],1):e._e(),a("el-form-item",{attrs:{label:"邮件地址",prop:"email"}},[a("el-input",{attrs:{type:"email",placeholder:"邮件地址"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),a("el-form-item",{attrs:{label:"是否可用",prop:"disabled"}},[a("el-radio",{attrs:{label:"0"},model:{value:e.form.disabled,callback:function(t){e.$set(e.form,"disabled",t)},expression:"form.disabled"}},[e._v("是")]),a("el-radio",{attrs:{label:"1"},model:{value:e.form.disabled,callback:function(t){e.$set(e.form,"disabled",t)},expression:"form.disabled"}},[e._v("否")])],1),a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{attrs:{type:"textarea",placeholder:"备注"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),a("el-form-item",{attrs:{label:"数据权限",prop:"dicts"}},[a("el-form-item",[a("el-checkbox-group",{model:{value:e.form.dicts,callback:function(t){e.$set(e.form,"dicts",t)},expression:"form.dicts"}},e._l(e.dictEnNameList,function(t){return a("el-checkbox",{key:t.dictId,attrs:{label:t.dictId}},[e._v(e._s(t.dictCnName))])}),1)],1)],1)],1)],1)},xb=[],Fb={props:{editId:Number,default:null},data:function(){return{title:null,dictEnNameList:null,departmentList:[],isShowloginPwd:!0,form:{userName:null,deptId:null,loginName:null,loginPwd:null,email:null,disabled:null,remark:null,superAdmin:0,dicts:[]},formRules:{userName:[{required:!0,message:"请输入用户名称",trigger:"blur"},{max:45,message:"不超过 45 个字符",trigger:"blur"}],loginName:[{required:!0,message:"请输入登录账号",trigger:"blur"},{max:45,message:"不超过 45 个字符",trigger:"blur"}],loginPwd:[{required:!0,message:"请输入密码",trigger:"blur"},{max:45,message:"不超过 45 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮件地址",trigger:"blur"},{type:"email",message:"邮件地址格式不正确",trigger:"blur"}]}}},methods:{userConfigBusinessType:function(){var e=this;this.$service.getDictType({type:"businessType"}).then(function(t){e.dictEnNameList=t})},submitBtn:function(){var e=this;this.$refs.form.validate(function(t){t&&e.$service.userConfigSave({jsonStr:JSON.stringify(e.form)},"保存成功").then(function(t){e.$emit("open-list-page")})})},getEditData:function(){var e=this;this.$service.userConfigEdit({id:this.editId}).then(function(t){Object.keys(e.form).forEach(function(a){e.form[a]="disabled"===a?t[a]+"":t[a]})})},getDepts:function(){var e=this;return this.$service.getDepts().then(function(t){e.departmentList=t,console.log(t),t.forEach(function(e){console.log(e.deptName+e.deptId)})})}},created:function(){this.userConfigBusinessType(),this.getDepts(),null!==this.editId&&void 0!==this.editId?(this.title="编辑",this.isShowloginPwd=!1,this.form.userId=this.editId,this.getEditData()):this.title="新增"}},Db=Fb,Rb=Object(Yo["a"])(Db,Pb,xb,!1,null,null,null),Lb=Rb.exports,$b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"sysUser"},on:{add:e.addUser,edit:e.editData,delete:e.batchDel}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1),a("el-dialog",{attrs:{title:"设置用户角色",visible:e.roleDialogVisible},on:{"update:visible":function(t){e.roleDialogVisible=t}}},[a("span",[a("el-transfer",{attrs:{data:e.roleData,titles:["待选角色","已选角色"]},on:{change:e.handleChange},model:{value:e.roleValue,callback:function(t){e.roleValue=t},expression:"roleValue"}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.roleDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.roleDialogVisible=!1,e.add()}}},[e._v("确 定")])],1)]),a("el-dialog",{attrs:{title:"数据权限设置",width:"30%",visible:e.dataPermissionWinVisible},on:{"update:visible":function(t){e.dataPermissionWinVisible=t}}},[a("el-checkbox-group",{directives:[{name:"show",rawName:"v-show",value:!e.isLoading,expression:"!isLoading"}],model:{value:e.checkedDictItems,callback:function(t){e.checkedDictItems=t},expression:"checkedDictItems"}},e._l(e.DataPermissionItems,function(t){var n=t.dictId,i=t.dictCnName;return a("el-checkbox",{key:n,staticClass:"checkItemStyle",attrs:{label:n}},[e._v("\n        "+e._s(i)+"\n      ")])}),1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dataPermissionWinVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveProfession}},[e._v("确 定")])],1)],1)],1)},Nb=[],Eb={components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"],ButtonGroupForListPage:kl["a"]},data:function(){var e=this;return{canEdit:!1,depts:{},roleData:[],roleValue:[],data1:[],user:[],setRolesId:[],roleDataSelected:null,roleDialogVisible:!1,currentUserId:null,dataPermissionWinVisible:!1,DataPermissionItems:{},checkedDictItems:[],isLoading:!1,selectedRole:[],filter:{sort:void 0,order:void 0},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"userId",width:"70",sortable:!0},{label:"用户名称","min-width":"120",prop:"userName",sortable:!0},{label:"登录账号",prop:"loginName",width:"110",sortable:!0},{label:"所在部门",prop:"deptName","min-width":"90"},{label:"电子邮箱",prop:"email","min-width":"160"},{label:"登录IP",prop:"loginIp",width:"130"},{label:"登录次数",prop:"loginCount"},{label:"最后登录时间",prop:"loginTime",width:"170"},{label:"是否禁用",prop:"disabled",formatter:function(e){return 0===e.disabled?"否":1===e.disabled?"是":void 0}},{label:"创建时间",prop:"dateCreate",width:"170",sortable:!0},{label:"修改时间",prop:"dateModify",width:"170",sortable:!0},{label:"备注",prop:"remark","min-width":"170"},{label:"操作",width:"200",fixed:"right",render:function(t,a){var n=a.row;if(e.canEdit){var i=t("el-button",{attrs:{type:"text"},on:{click:function(){e.setRole({row:n})}}},"设置角色"),r=t("el-button",{attrs:{type:"text"},on:{click:function(){e.setData({row:n})}}},"数据权限");return t("div",[i,r])}}}],data:[],selected:[],selectionType:"multiple"}}},methods:{addUser:function(){this.$emit("open-add-page",null)},handleRead:function(e){e.row},setRole:function(e){var t=this,a=e.row,n={userId:a.userId},i=[],r=[];this.roleDialogVisible=!0,this.user=a.userId,this.roleData=[],this.$service.getNotRolesByUserId(n).then(function(e){t.data1=e,t.$service.getRolesByUserId(n).then(function(e){null!=e&&(t.data1=t.data1.concat(e));for(var a=0;a<t.data1.length;a++)i.push({key:t.data1[a].roleId,label:t.data1[a].roleName});for(var n=0;n<e.length;n++)r.push(e[n].roleId);t.roleData=i,t.roleValue=r})})},handleChange:function(e,t,a){for(var n=[],i=0;i<e.length;i++)-1===n.indexOf(e[i])&&n.push(e[i]);var r=n.join(",");this.setRolesId=r},add:function(){var e=this,t=this.user,a=this.setRolesId;this.$service.saveUserRoles({userId:t,roleIds:a},"保存成功").then(function(){e.roleDialogVisible=!1,e.fetchData()})},editData:function(){this.$isAllowEdit(this.selected)&&this.$emit("open-add-page",this.selected[0])},batchDel:function(){var e=this;0!==this.selected.length?this.$confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$service.userConfigDelete({id:e.selected.join(",")},"删除成功").then(function(t){e.fetchData(),e.handleAllRowSelectionRemove()})}):this.$message("请选择再删除")},handleRowSelectionAdd:function(e){this.selected.push(e.userId),this.updateTableSelected()},handleRowSelectionRemove:function(e){this.selected=this.selected.filter(function(t){return t!==e.userId}),this.updateTableSelected()},handleAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleRowSelectionAdd):(this.selected=[],this.table.selected=[])},handleAllRowSelectionRemove:function(){this.selected=[],this.table.selected=[]},updateTableSelected:function(){var e=this.table,t=this.selected;e.selected=e.data.reduce(function(e,a,n){return t.indexOf(a.userId)>-1&&e.push(n),e},[])},handleFilterChange:function(e,t){t&&(this.filter=t),"query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData()},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.userConfigPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},getDepts:function(){var e=this;return this.$service.getDepts().then(function(t){t.forEach(function(t){e.depts[t.deptName]=t.deptId})})},getNotRolesByUserId:function(e){var t=this;this.$service.getNotRolesByUserId({userId:e}).then(function(e){e.forEach(function(e){t.depts[e.deptName]=e.deptId})})},setData:function(){var e=Object(Y["a"])(regeneratorRuntime.mark(function e(t){var a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.row,this.currentUserId=a.userId,e.next=4,this.userConfigBusinessType();case 4:return this.checkedDictItems=[],this.isLoading=!0,e.next=8,this.getDictCheckedByUserId(a.userId);case 8:this.isLoading=!1,this.dataPermissionWinVisible=!0;case 10:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),getDictCheckedByUserId:function(e){var t=this;return this.$service.getDictCheckedByUserId({userId:e}).then(function(e){t.checkedDictItems=e})},userConfigBusinessType:function(){var e=this;return this.$service.getDictType({type:"businessType"}).then(function(t){e.DataPermissionItems=t})},saveProfession:function(){var e=this,t=this.checkedDictItems.join(",");this.$service.saveProfession({userId:this.currentUserId,dicts:t},"保存成功").then(function(){e.dataPermissionWinVisible=!1})}},created:function(){var e=this,t=ll.a.map({userName:ll.a.o.string.other("form",{component:"Input",placeholder:"用户名称"}),deptId:ll.a.o.enum(this.depts).other("form",{component:"Select",placeholder:"所在部门"}),loginName:ll.a.o.string.other("form",{component:"Input",placeholder:"登录账号"}),email:ll.a.o.string.other("form",{component:"Input",placeholder:"电子邮箱"}),loginIp:ll.a.o.string.other("form",{component:"Input",placeholder:"最后登录IP"}),disabled:ll.a.o.enum({"否":"0","是":"1"}).other("form",{component:"Select",placeholder:"是否禁用"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.getDepts().then(function(){e.filterSchema=t}),this.fetchData(),this.$service.getButtonGroupForPageList("sysUser").then(function(t){e.canEdit=t.some(function(e){return"edit"===e.runComm})})}},Ob=Eb,Ab=(a("0eaa"),Object(Yo["a"])(Ob,$b,Nb,!1,null,"2c0536ae",null)),Vb=Ab.exports,Bb={components:{UserConfigAdd:Lb,UserConfigList:Vb},data:function(){return{isShowList:!0,editId:null}},methods:{openAddPage:function(e){this.editId=e,this.isShowList=!1},openListPage:function(){this.isShowList=!0,this.$refs.list.fetchData()},goBack:function(){this.isShowList=!0}}},Mb=Bb,Ub=Object(Yo["a"])(Mb,kb,_b,!1,null,null,null),Gb=Ub.exports,jb=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("ThemeInfoList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{"open-add-page":e.openAddPage}}),e.isShowList?e._e():a("ThemeInfoAdd",{attrs:{editId:e.editId,version:e.version,initMode:e.mode},on:{"upsert-end":e.openListPage,"go-back":e.goBack}})],1)},zb=[],Wb=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"theme"},on:{add:e.addUser,edit:e.editData,delete:e.batchDel}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1),a("el-dialog",{attrs:{title:"大图预览",visible:e.onclickPictureVisible,width:"70%"},on:{"update:visible":function(t){e.onclickPictureVisible=t}}},[a("img",{attrs:{src:e.URL,width:"100%"}})])],1)},qb=[],Jb={components:{ContentWrapper:Bo["ContentWrapper"],Table:Bo["Table"],ButtonGroupForListPage:kl["a"]},data:function(){var e=this;return{URL:"",onclickPictureVisible:!1,filterSchema:null,filter:{sort:void 0,order:void 0},pagination:{currentPage:1,pageSize:10},selected:[],table:{props:{},data:[],header:[{label:"ID",prop:"themeId",sortable:!0},{label:"主题名称",prop:"themeName",sortable:!0,render:function(t,a){var n=a.row;return t(q["Button"],{props:{type:"text"},on:{click:function(){return e.themeInfoPreview(n)}}},n.themeName)}},{label:"主题品牌",prop:"themeBrand",sortable:!0,formatter:function(e){return"Coocaa"===e.themeBrand?"创维酷开":"Other"===e.themeBrand?"全部":void 0}},{label:"系统默认",prop:"systemDefault",sortable:!0,formatter:function(e){var t=["否","是"];return t[e.systemDefault]}},{label:"状态",prop:"themeStatus",sortable:!0,formatter:function(e){var t=["下架","上架","草稿","待审核","审核通过","审核不通过"];return t[e.themeStatus]}},{label:"主题当前版本",prop:"currentVersion",sortable:!0},{label:"主题预览图",prop:"previewImgUrl",sortable:!0,render:function(t,a){var n=a.row;if(n.previewImgUrl)return t("img",{attrs:{src:n.previewImgUrl,width:"100px",height:"45px",class:"imgs"},on:{click:function(){e.URL=n.previewImgUrl,e.onclickPictureVisible=!0}}})}},{label:"待审核副本",prop:"duplicateVersion",sortable:!0,render:function(t,a){var n=a.row;if(n.duplicateVersion)return t(q["Button"],{props:{type:"success"},on:{click:function(){return e.duplicatePreview(n)}}},n.duplicateVersion)}},{label:"原价(元)",prop:"price",sortable:!0,formatter:function(e){return e.chargeType?e.price:"免费"}},{label:"折扣价(元)",prop:"discountPrice",sortable:!0,formatter:function(e){return e.chargeType?e.discountPrice:"免费"}},{label:"更新时间",prop:"lastUpdateDate",sortable:!0},{label:"更新人",prop:"modifierName",sortable:!0}],selected:[],selectionType:"multiple"}}},methods:{fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.themeInfoPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.themeId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={},this.pagination.currentPage=1,this.fetchData()},addUser:function(){this.$emit("open-add-page")},editData:function(){var e=this.selected;if(1!==e.length)return this.$message("只能选择一条数据"),!1;var t=this.table.data,a=t.find(function(t){return t.themeId===e[0]}).themeStatus;if(4===a)return this.$alert("审核通过的数据无法编辑！","操作提示"),!1;this.$emit("open-add-page",e[0],"edit")},batchDel:function(){var e=this;if(0!==this.selected.length){if(window.confirm("确定要删除吗")){var t=this.selected.join(",");this.$service.themeInfoRemove({id:t}).then(function(){e.selected=[],e.fetchData()})}}else this.$message("请选择数据后进行操作")},handleRowSelectionAdd:function(e){this.selected.push(e.themeId),this.updateTableSelected()},handleRowSelectionRemove:function(e){this.selected=this.selected.filter(function(t){return t!==e.themeId}),this.updateTableSelected()},handleAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleRowSelectionAdd):(this.selected=[],this.table.selected=[])},handleAllRowSelectionRemove:function(){this.selected=[],this.table.selected=[]},updateTableSelected:function(){var e=this.table,t=this.selected;e.selected=e.data.reduce(function(e,a,n){return t.indexOf(a.themeId)>-1&&e.push(n),e},[])},themeInfoPreview:function(e){this.$emit("open-add-page",e.themeId,"read")},duplicatePreview:function(e){this.$emit("open-add-page",e.themeId,"read",e.duplicateVersion)}},created:function(){var e=ll.a.map({themeId:ll.a.o.string.other("form",{component:"Input",placeholder:"ID"}),themeName:ll.a.o.string.other("form",{component:"Input",placeholder:"主题名称"}),currentVersion:ll.a.o.string.other("form",{component:"Input",placeholder:"当前版本"}),themeStatus:ll.a.o.enum({"待审核":"3","审核通过":"4","审核不通过":"5"}).other("form",{component:"Select",placeholder:"状态"})}).other("form",{cols:{item:5,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},Hb=Jb,Kb=(a("565d"),Object(Yo["a"])(Hb,Wb,qb,!1,null,"e2dd4174",null)),Yb=Kb.exports,Qb=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("div",[a("CommonContent",{ref:"commonContent",attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{edit:e.edit,replicate:e.replicate,"submit-audit":e.btnSave,"select-version":e.fetchData,unaudit:e.fetchData,shelves:e.fetchData,audit:function(t){return e.$emit("upsert-end")},delete:function(t){return e.$emit("upsert-end",t)}}},[a("div",{attrs:{slot:"auditAndDraft"},slot:"auditAndDraft"},[a("el-button",{attrs:{type:"primary"},on:{click:e.btnSave}},[e._v("提交审核")])],1),a("div",{staticClass:"split-bar"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),"read"!==e.mode?[a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{rules:e.rules,model:e.form,"label-width":"150px"}},[a("el-form-item",{attrs:{label:"主题名称",prop:"themeName"}},[a("el-input",{model:{value:e.form.themeName,callback:function(t){e.$set(e.form,"themeName",t)},expression:"form.themeName"}})],1),a("el-form-item",{attrs:{label:"收费类型"}},[a("el-radio-group",{model:{value:e.form.chargeType,callback:function(t){e.$set(e.form,"chargeType",t)},expression:"form.chargeType"}},[a("el-radio",{attrs:{label:"0"}},[e._v("免费")]),a("el-radio",{attrs:{label:"1"}},[e._v("付费")]),a("el-radio",{attrs:{label:"2"}},[e._v("VIP免费")])],1)],1),"0"!==e.form.chargeType?a("div",{staticClass:"priceInput"},[a("el-form-item",{attrs:{label:"价格"}},[a("el-input",{model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}}),e._v("元\n            ")],1),a("el-form-item",{attrs:{label:"折扣价"}},[a("el-input",{model:{value:e.form.discountPrice,callback:function(t){e.$set(e.form,"discountPrice",t)},expression:"form.discountPrice"}}),e._v("元\n            ")],1)],1):e._e(),a("el-form-item",{attrs:{label:"主题品牌"}},[a("el-radio-group",{model:{value:e.form.themeBrand,callback:function(t){e.$set(e.form,"themeBrand",t)},expression:"form.themeBrand"}},[a("el-radio",{attrs:{label:"Coocaa"}},[e._v("创维酷开")]),a("el-radio",{attrs:{label:"Other"}},[e._v("全部")])],1)],1),a("el-form-item",{attrs:{label:"皮肤APK"}},[a("ThemeFileUpload",{ref:"apk",attrs:{accept:"application/vnd.android.package-archive",fileCount:"1"},on:{"pic-data":e.handleApk,handleRemove:function(t){e.form.themeDownUrl="",e.form.themeMd5=""}}})],1),a("el-form-item",{attrs:{label:"主题预览图"}},[a("ThemeFileUpload",{ref:"preview",attrs:{accept:"image/*",fileCount:"1"},on:{"pic-data":e.handlePreviewImg,handleRemove:function(t){e.form.previewImgUrl=""}}})],1),a("el-form-item",{attrs:{label:"主题缩略图"}},[a("ThemeFileUpload",{ref:"thumbImg",attrs:{accept:"image/*",fileCount:"1"},on:{"pic-data":e.handleThumbImg,handleRemove:function(t){e.form.thumbImgUrl=""}}})],1),a("el-form-item",{attrs:{label:"图标库zip文件"}},[a("ThemeFileUpload",{ref:"pictureEntitys",attrs:{accept:"application/zip",fileCount:"1",zipType:"icon"},on:{"pic-data":e.handlePictureEntitys,handleRemove:function(t){e.form.pictureEntitys=[]}}})],1),a("div",{staticClass:"icon-list"},e._l(e.form.pictureEntitys,function(t,n){return a("div",{key:n,staticClass:"icon-list__item"},[a("img",{staticClass:"icon-list__item-img--pictureEntitys",attrs:{src:t.pictureUrl}}),a("span",{staticClass:"icon-list__item-text"},[e._v(e._s(n+1))])])}),0),a("el-form-item",{attrs:{label:"指定背景图片zip文件"}},[a("ThemeFileUpload",{ref:"tabBgEntitys",attrs:{accept:"application/zip",fileCount:"1",zipType:"tabBg"},on:{"pic-data":e.handleTabBgEntitys,handleRemove:function(t){e.form.tabBgEntitys=[]}}})],1),a("div",{staticClass:"icon-list"},e._l(e.form.tabBgEntitys,function(t,n){return a("div",{key:n,staticClass:"icon-list__item"},[a("img",{staticClass:"icon-list__item-img--tabBgEntitys",attrs:{src:t.pictureUrl}}),a("span",{staticClass:"icon-list__item-text"},[e._v(e._s(n+1))])])}),0)],1)]:e._e(),"read"===e.mode?[a("el-form",{staticClass:"preview-form",attrs:{model:e.form,"label-width":"150px"}},[a("el-form-item",{staticClass:"label",attrs:{label:"主题名称"}},[a("span",{attrs:{title:"themeName"}},[e._v(e._s(e.form.themeName))])]),a("el-form-item",{staticClass:"label",attrs:{label:"价格"}},[a("span",{attrs:{title:"price"}},[e._v(e._s(e.form.price)+"元")]),a("span",{attrs:{title:"discountPrice"}},[e._v("(折扣:"+e._s(e.form.discountPrice)+"元)")])]),a("el-form-item",{staticClass:"label",attrs:{label:"主题品牌"}},[a("span",{attrs:{title:"themeBrand"}},[e._v(e._s("Coocaa"===e.form.themeBrand?"创维酷开":"其他"))])]),a("el-form-item",{staticClass:"label",attrs:{label:"主题预览图"}},[a("div",{staticClass:"img-box",attrs:{title:"previewImgUrl"}},[a("img",{staticClass:"img",attrs:{src:e.form.previewImgUrl}})])]),a("el-form-item",{staticClass:"label",attrs:{label:"主题缩略图"}},[a("div",{staticClass:"img-box",attrs:{title:"thumbImgUrl"}},[a("img",{staticClass:"img",attrs:{src:e.form.thumbImgUrl}})])]),a("el-form-item",{staticClass:"label",attrs:{label:"图标库"}},[a("div",{staticClass:"icon-list",attrs:{title:"pictureEntitys"}},e._l(e.form.pictureEntitys,function(t,n){return a("div",{key:n,staticClass:"icon-list__item"},[a("img",{staticClass:"icon-list__item-img--pictureEntitys",attrs:{src:t.pictureUrl}}),a("span",{staticClass:"icon-list__item-text"},[e._v(e._s(t.iconTypeName))])])}),0)]),a("el-form-item",{staticClass:"label",attrs:{label:"指定背景图"}},[a("div",{staticClass:"icon-list",attrs:{title:"tabBgEntitys"}},e._l(e.form.tabBgEntitys,function(t,n){return a("div",{key:n,staticClass:"icon-list__item"},[a("img",{staticClass:"icon-list__item-img--tabBgEntitys",attrs:{src:t.pictureUrl}}),a("span",{staticClass:"icon-list__item-text"},[e._v(e._s(n+1))])])}),0)])],1)]:e._e()],2)],1)])},Xb=[],Zb=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Upload",{ref:"upload",attrs:{multiple:!0,accept:e.accept},on:{upload:e.handleUpload},scopedSlots:e._u([{key:"preview",fn:function(t){var i=t.fileList;return n("div",{staticClass:"upload-pic-list"},[n("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.$refs.upload.handleSelectFile()}}},[e._v("点击选择文件")]),e._l(i,function(t){return n("div",{key:t.id,staticClass:"upload-pic-list__item"},["error"===t.status?n("div",{staticClass:"upload-pic-list__error"},[e._v("上传失败: "+e._s(t.message))]):e._e(),"uploading"===t.status?n("div",{staticClass:"upload-pic-list__progress"},[n("el-progress",{attrs:{width:100,type:"circle",percentage:t.percentage}})],1):n("div",{staticClass:"upload-pic-list__success"},[void 0===t.dataUrl||""===t.dataUrl?n("img",{staticClass:"upload-pic-list__success__img",attrs:{src:a("87d4")}}):e._e(),void 0!==t.dataUrl&&""!==t.dataUrl?n("img",{staticClass:"upload-pic-list__success__img",attrs:{src:t.dataUrl}}):e._e(),"uploading"!==t.status?n("i",{staticClass:"upload-pic-list__remove el-icon el-icon-error",attrs:{title:"移除"},on:{click:function(a){return e.handleRemove(t)}}}):e._e(),n("div",{staticClass:"diy-file-name"},[e._v(e._s(t.name))]),"success"===t.status?n("div",{staticClass:"diy-bar"},[n("span",{staticClass:"diy-bar__text"},[e._v("上传完成")])]):e._e()])])})],2)}}])})},ey=[],ty={components:{Upload:Bo["Upload"]},props:{accept:{type:String},fileCount:{type:String},zipType:{type:String,default:function(){return"none"}}},data:function(){return{fileNum:0,picData:{}}},methods:{handleUpload:function(e,t){var a=this,n=this.$refs.upload.fileList,i=!1;if(n.map(function(t){t.name===e.name&&(i=!0)}),i)return this.$message("该资源已存在"),void n.pop();if(n[n.length-1].name=e.name,this.fileNum>=parseInt(this.fileCount))return this.$message("上传文件数量超过限制,最大上传文件个数为"+this.fileCount),void n.pop();this.fileNum++,this.fileName=e.name;var r=this.accept;if(/image/.test(r))this.$service.uploadImage({file:e,onUploadProgerss:function(e){e.lengthComputable&&(t.percentage=e.loaded/e.total)}}).then(function(e){0==e.code?(t.status="success",a.picData.url=e.data[0].url,a.$emit("pic-data",a.picData)):(t.status="error",t.message=e.msg)}).catch(function(){t.status="error",t.message="网络错误"});else if(/vnd.android.package-archive/.test(r))this.$service.uploadApk({file:e,onUploadProgerss:function(e){e.lengthComputable&&(t.percentage=e.loaded/e.total)}}).then(function(e){0==e.code?(t.status="success",a.picData.url=e.data.url,a.picData.fileMd5=e.data.fileMd5,a.$emit("pic-data",a.picData)):(t.status="error",t.message=e.msg)}).catch(function(){t.status="error",t.message="网络错误"});else if(/zip/.test(r)){var o=this.zipType;this.$service.uploadZip({file:e,type:o,onUploadProgerss:function(e){e.lengthComputable&&(t.percentage=e.loaded/e.total)}}).then(function(e){0==e.code?(t.status="success",a.picData=e.data,a.$emit("pic-data",a.picData)):(t.status="error",t.message=e.msg)}).catch(function(){t.status="error",t.message="网络错误"})}},handleRemove:function(e){this.$refs.upload.handleRemove(e),this.fileNum--,this.$emit("handleRemove")}},created:function(){}},ay=ty,ny=(a("28b5"),Object(Yo["a"])(ay,Zb,ey,!1,null,"22d7cc10",null)),iy=ny.exports,ry={props:{editId:Number,version:String,default:null,initMode:String},components:{CommonContent:Ql["a"],ThemeFileUpload:iy},data:function(){return{form:{themeId:void 0,themeName:"",chargeType:"0",price:"",discountPrice:"",themeBrand:"Coocaa",themeDownUrl:"",previewImgUrl:"",thumbImgUrl:"",systemDefault:"0",themeCode:"",themeVersion:"",themeMd5:"",pictureEntitys:[],tabBgEntitys:[],currentVersion:void 0,themeStatus:3},title:"",mode:"",status:"",rules:{themeName:[{required:!0,message:"请输入主题名称",trigger:"blur"}]}}},computed:{resourceInfo:function(){var e=this.form;if(e.themeId)return{id:e.themeId,version:e.currentVersion,status:e.themeStatus,type:"theme",menuElId:"themeInfo"}}},methods:{replicate:function(){var e=this;this.mode="replicate",this.title="创建副本",this.$nextTick(function(){e.$refs.preview.$refs.upload.fileList=[{dataUrl:e.form.previewImgUrl}],e.$refs.apk.$refs.upload.fileList=[{dataUrl:e.form.themeDownUrl}],e.$refs.thumbImg.$refs.upload.fileList=[{dataUrl:e.form.thumbImgUrl}],e.$refs.pictureEntitys.$refs.upload.fileList=[{dataUrl:""}],e.$refs.tabBgEntitys.$refs.upload.fileList=[{dataUrl:""}]})},edit:function(){var e=this;this.mode="edit",this.title="编辑",this.$nextTick(function(){e.$refs.preview.$refs.upload.fileList=[{dataUrl:e.form.previewImgUrl}],e.$refs.apk.$refs.upload.fileList=[{dataUrl:e.form.themeDownUrl}],e.$refs.thumbImg.$refs.upload.fileList=[{dataUrl:e.form.thumbImgUrl}],e.$refs.pictureEntitys.$refs.upload.fileList=[{dataUrl:""}],e.$refs.tabBgEntitys.$refs.upload.fileList=[{dataUrl:""}]})},btnSave:function(){var e=this,t=Object(Go["cloneDeep"])(this.form);"0"===t.chargeType&&(t.price="0",t.discountPrice="0"),"replicate"===this.mode&&(t.currentVersion=""),t.themeStatus=3,this.$refs.form.validate(function(a){a&&e.$service.savethemeInfo({jsonStr:JSON.stringify(t)},"保存成功").then(function(){e.$emit("upsert-end")})})},handleApk:function(e){var t=this;this.$service.checkThemeMd5({themeMd5:e.fileMd5},"该主题可用").then(function(){t.form.themeDownUrl=e.url,t.form.themeMd5=e.fileMd5})},handlePreviewImg:function(e){this.form.previewImgUrl=e.url},handleThumbImg:function(e){this.form.thumbImgUrl=e.url},handlePictureEntitys:function(e){this.form.pictureEntitys=this.EntitysPicUp(e)},handleTabBgEntitys:function(e){this.form.tabBgEntitys=this.EntitysPicUp(e)},EntitysPicUp:function(e){return e.reduce(function(e,t){var a={pictureName:t.originFileName,pictureUrl:t.url,pictureResolution:t.resolution};return e.push(a),e},[])},setFormData:function(e){var t=this.form;if(t.themeId=e.themeId,t.themeName=e.themeName,t.chargeType=e.chargeType.toString(),t.price=e.price,t.discountPrice=e.discountPrice,t.themeBrand=e.themeBrand,t.systemDefault=e.systemDefault,t.themeStatus=e.themeStatus,t.cornerIconEntities=e.cornerIconEntities,t.currentVersion=e.currentVersion,t.previewImgUrl=e.previewImgUrl,t.thumbImgUrl=e.thumbImgUrl,t.pictureEntitys=e.pictureEntitys,t.tabBgEntitys=e.tabBgEntitys,t.themeDownUrl=e.themeDownUrl,t.themeMd5=e.themeMd5,"edit"===this.mode){var a={name:"file"},n=this.$refs.apk.$refs.upload.fileList;n.push(a),this.$refs.apk.fileNum++,t.previewImgUrl=e.previewImgUrl;var i={name:"img",dataUrl:e.previewImgUrl},r=this.$refs.preview.$refs.upload.fileList;r.push(i),this.$refs.preview.fileNum++,t.thumbImgUrl=e.thumbImgUrl;var o={name:"img",dataUrl:e.thumbImgUrl},l=this.$refs.thumbImg.$refs.upload.fileList;l.push(o),this.$refs.thumbImg.fileNum++,t.pictureEntitys=e.pictureEntitys.map(function(e){return{pictureName:e.pictureName,pictureResolution:e.pictureResolution,pictureUrl:e.pictureUrl}});var s={name:"file"},c=this.$refs.pictureEntitys.$refs.upload.fileList;c.push(s),this.$refs.pictureEntitys.fileNum++,t.tabBgEntitys=e.tabBgEntitys.map(function(e){return{pictureName:e.pictureName,pictureResolution:e.pictureResolution,pictureUrl:e.pictureUrl}});var u={name:"file"},d=this.$refs.tabBgEntitys.$refs.upload.fileList;d.push(u),this.$refs.tabBgEntitys.fileNum++}},fetchData:function(e){var t=this;void 0!==e&&(this.form.currentVersion=e),this.$service.themeInfoDetail({id:this.editId,version:e}).then(function(e){t.setFormData(e)})}},created:function(){this.mode=this.initMode,this.editId?"edit"===this.mode?(this.title="编辑页面",this.fetchData()):"read"===this.mode&&(this.title="预览页面",this.fetchData(this.version)):this.title="新增页面"}},oy=ry,ly=(a("dca8"),Object(Yo["a"])(oy,Qb,Xb,!1,null,"57be6a2e",null)),sy=ly.exports,cy={components:{ThemeInfoList:Yb,ThemeInfoAdd:sy},data:function(){return{isShowList:!0,editId:null,version:null,mode:""}},methods:{openAddPage:function(e,t,a){this.editId=e,this.isShowList=!1,this.mode=t,this.version=a},goBack:function(){this.isShowList=!0},openListPage:function(){this.isShowList=!0,this.$refs.list.fetchData()}}},uy=cy,dy=Object(Yo["a"])(uy,jb,zb,!1,null,"46b458ee",null),py=dy.exports,hy=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PageWrapper",{staticClass:"tab-info-wrapper"},[a("PageContentWrapper",{directives:[{name:"show",rawName:"v-show",value:"movie_list"===e.activePage,expression:"activePage === 'movie_list'"}]},[a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType}})],1)],1)],1),"panel_preview"===e.activePage?a("PageContentWrapper",[a("PanelInfo",{attrs:{"title-prefix":"下架影片通知","init-mode":e.panelPreview.initMode,id:e.panelPreview.id,version:e.panelPreview.version,"panel-data-type":e.panelPreview.dataType,"init-group-index":e.panelPreview.initGroupIndex,"init-block-index":e.panelPreview.initBlockIndex},on:{"upsert-end":e.handlePreviewPanelEnd,"go-back":e.handlePreviewPanelEnd}})],1):e._e()],1)},my=[],fy={components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"],PageWrapper:eu["a"],PageContentWrapper:tu["a"],PanelInfo:Tu["a"]},data:function(){var e=this;return{filter:{},activePage:"movie_list",filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"id",width:"70"},{label:"名称",width:"150",prop:"thirdVideoTitle"},{label:"图片",width:"150",prop:"imgUrl",render:function(e,t){var a=t.row;return e("img",{attrs:{src:a.imgUrl,width:"100px",height:"100px",class:"imgs"}})}},{label:"引用状态",prop:"rlsInfo",render:function(t,a){var n=a.row;return n.rlsInfo.reduce(function(a,n){var i=t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n)}}},n);return a.push(i),a},[])}}],data:[],selected:[],selectionType:"none"},panelPreview:{panel:null,id:void 0,version:void 0,initMode:void 0,initGroupIndex:void 0,initBlockIndex:void 0}}},methods:{goBack:function(){this.isShowList=!0},handleRead:function(e){var t=e.indexOf("[")+1,a=e.indexOf("]"),n=e.slice(t,a).split(","),i=n[0],r=n[1];this.activePage="panel_preview",this.panelPreview={initMode:"read",id:i,dataType:1,version:r}},handlePreviewPanelEnd:function(){this.activePage="movie_list"},handleFilterChange:function(e,t){t&&(this.filter=t),"query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData()},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();this.$service.getMoviePageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=ll.a.map({keyword:ll.a.o.string.other("form",{component:"Input",placeholder:"影片名称/引用状态"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},vy=fy,gy=(a("4b20"),Object(Yo["a"])(vy,hy,my,!1,null,"0817d952",null)),by=gy.exports,yy=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"版面",name:"first"}},[a("MyDraftsTabIndex",{staticClass:"el-tab-pane-preview"})],1),a("el-tab-pane",{attrs:{label:"版块",name:"second"}},[a("MyDraftsPanelIndex",{staticClass:"el-tab-pane-preview"})],1),a("el-tab-pane",{attrs:{label:"首页",name:"third"}},[a("MyDraftsHomePageIndex",{staticClass:"el-tab-pane-preview"})],1),a("el-tab-pane",{attrs:{label:"策略",name:"fourth"}},[a("MyDraftsPolicyIndex",{staticClass:"el-tab-pane-preview"})],1)],1)},wy=[],Iy=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("MyDraftsTab",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{read:e.handleRead}}),e.isShowList||"special"!==e.tabParentType?e._e():a("FilmDetailPageAdd",{attrs:{id:e.id,initMode:e.mode,version:e.version},on:{"go-back":e.goBack,"open-list-page":e.handleUpsertEnd}}),e.isShowList||"biz"!==e.tabParentType?e._e():a("BusinessTabInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}),e.isShowList||"home"!==e.tabParentType?e._e():a("TabInfo",{attrs:{id:e.id,"init-mode":e.mode},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},Cy=[],Ty=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data}})],1)],1)},Sy=[],ky={components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"]},data:function(){var e=this;return{filter:{sort:void 0,order:void 0,type:"myDrafts"},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"tabId",width:"70"},{label:"名称",width:"170",prop:"tabName",sortable:!0,render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n)}}},n.tabName)}},{label:"标题",prop:"tabCnTitle"},{label:"待处理的版本",prop:"currentVersion"},{label:"更新时间",prop:"lastUpdateDate",sortable:!0}],data:[],selected:[],selectionType:"none"}}},methods:{handleRead:function(e){this.$emit("read",e)},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.taskId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0,type:"myDrafts"},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();t.resourceType="tab",this.$service.todoTaskPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=ll.a.map({taskId:ll.a.o.string.other("form",{component:"Input",placeholder:"ID"}),taskName:ll.a.o.string.other("form",{component:"Input",placeholder:"名称"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},_y=ky,Py=Object(Yo["a"])(_y,Ty,Sy,!1,null,null,null),xy=Py.exports,Fy={components:{FilmDetailPageAdd:tg,MyDraftsTab:xy,TabInfo:Em["a"],BusinessTabInfo:Av},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0,tabParentType:void 0}},methods:{handleUpsertEnd:function(e){this.$refs.list.fetchData(),this.isShowList=!0,this.mode="list",this.version=void 0},handleRead:function(e){this.id=e.tabId,this.mode="read",this.version=e.currentVersion,this.isShowList=!1,this.tabParentType=e.tabParentType,console.log(e.tabParentType)},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},Dy=Fy,Ry=Object(Yo["a"])(Dy,Iy,Cy,!1,null,"1b25e5be",null),Ly=Ry.exports,$y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("MyDraftsHomePage",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{read:e.handleRead}}),e.isShowList?e._e():a("HomePageInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},Ny=[],Ey=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data}})],1)],1)},Oy=[],Ay={components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"]},data:function(){var e=this;return{filter:{sort:void 0,order:void 0,type:"myDrafts"},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"homepageId",width:"70"},{label:"名称",width:"170",prop:"homepageName",sortable:!0,render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n)}}},n.homepageName)}},{label:"待处理的版本",prop:"currentVersion"},{label:"更新时间",prop:"lastUpdateDate",sortable:!0}],data:[],selected:[],selectionType:"none"}}},methods:{handleRead:function(e){this.$emit("read",e)},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.taskId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0,type:"myDrafts"},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();t.resourceType="homepage",this.$service.todoTaskPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=ll.a.map({taskId:ll.a.o.string.other("form",{component:"Input",placeholder:"ID"}),taskName:ll.a.o.string.other("form",{component:"Input",placeholder:"名称"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},Vy=Ay,By=Object(Yo["a"])(Vy,Ey,Oy,!1,null,null,null),My=By.exports,Uy={components:{MyDraftsHomePage:My,HomePageInfo:Hm["a"]},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0,pannelType:void 0}},methods:{handleUpsertEnd:function(e){this.$refs.list.fetchData(),this.isShowList=!0,this.mode="list",this.version=void 0},handleRead:function(e){this.id=e.homepageId,this.mode="read",this.version=e.currentVersion,this.isShowList=!1},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},Gy=Uy,jy=Object(Yo["a"])(Gy,$y,Ny,!1,null,"7ada2f38",null),zy=jy.exports,Wy=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("MyDraftsPolicy",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{read:e.handleRead}}),e.isShowList?e._e():a("PolicyManageInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},qy=[],Jy=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data}})],1)],1)},Hy=[],Ky={components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"]},data:function(){var e=this;return{filter:{sort:void 0,order:void 0,type:"myDrafts"},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"policyId",width:"70"},{label:"名称",width:"170",prop:"policyName",sortable:!0,render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n)}}},n.policyName)}},{label:"更新时间",prop:"lastUpdateDate",sortable:!0}],data:[],selected:[],selectionType:"none"}}},methods:{handleRead:function(e){this.$emit("read",e)},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.taskId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0,type:"myDrafts"},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();t.resourceType="policy",this.$service.todoTaskPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=ll.a.map({taskId:ll.a.o.string.other("form",{component:"Input",placeholder:"ID"}),taskName:ll.a.o.string.other("form",{component:"Input",placeholder:"名称"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},Yy=Ky,Qy=Object(Yo["a"])(Yy,Jy,Hy,!1,null,null,null),Xy=Qy.exports,Zy={components:{MyDraftsPolicy:Xy,PolicyManageInfo:Af},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0,pannelType:void 0}},methods:{handleUpsertEnd:function(){this.$refs.list.fetchData(),this.isShowList=!0,this.mode="list",this.version=void 0},handleRead:function(e){this.id=e.policyId,this.mode="read",this.version=e.currentVersion,this.isShowList=!1},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},ew=Zy,tw=Object(Yo["a"])(ew,Wy,qy,!1,null,"02e1aab2",null),aw=tw.exports,nw=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("MyDraftsPanel",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{read:e.handleRead}}),e.isShowList||8!==e.pannelType?e._e():a("MarkPanelInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}),e.isShowList||1!==e.pannelType&&7!==e.pannelType?e._e():a("PanelInfo",{attrs:{id:e.id,"panel-data-type":1,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}),e.isShowList||3!==e.pannelType?e._e():a("PanelInfo",{attrs:{id:e.id,"panel-data-type":3,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}),e.isShowList||9!==e.pannelType?e._e():a("PrivatePannelInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},iw=[],rw=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data}})],1)],1)},ow=[],lw={components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"]},data:function(){var e=this;return{filter:{sort:void 0,order:void 0,type:"myDrafts"},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"pannelGroupId",width:"70"},{label:"名称",width:"170",prop:"pannelGroupRemark",sortable:!0,render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n)}}},n.pannelGroupRemark)}},{label:"标题",prop:"pannelTitle"},{label:"业务类型",prop:"categoryName"},{label:"更新时间",prop:"lastUpdateDate",sortable:!0}],data:[],selected:[],selectionType:"none"}}},methods:{handleRead:function(e){this.$emit("read",e)},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.taskId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0,type:"myDrafts"},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();t.resourceType="panel",this.$service.todoTaskPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=ll.a.map({taskId:ll.a.o.string.other("form",{component:"Input",placeholder:"ID"}),taskName:ll.a.o.string.other("form",{component:"Input",placeholder:"名称"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},sw=lw,cw=Object(Yo["a"])(sw,rw,ow,!1,null,null,null),uw=cw.exports,dw={components:{PanelInfo:Tu["a"],MarkPanelInfo:Uu["a"],PrivatePannelInfo:Fd["a"],MyDraftsPanel:uw},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0,pannelType:void 0}},methods:{handleUpsertEnd:function(){this.$refs.list.fetchData(),this.isShowList=!0,this.mode="list",this.version=void 0},handleRead:function(e){this.id=e.pannelGroupId,this.mode="read",this.version=e.currentVersion,this.isShowList=!1,this.pannelType=parseInt(e.pannelType),console.log(e.pannelType)},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},pw=dw,hw=Object(Yo["a"])(pw,nw,iw,!1,null,"387195a0",null),mw=hw.exports,fw={components:{MyDraftsTabIndex:Ly,MyDraftsHomePageIndex:zy,MyDraftsPolicyIndex:aw,MyDraftsPanelIndex:mw},data:function(){return{activeName:"first"}},methods:{handleClick:function(){}}},vw=fw,gw=(a("4a80"),Object(Yo["a"])(vw,yy,wy,!1,null,"fa6e37a4",null)),bw=gw.exports,yw=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"版面",name:"tab"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"tabList"===e.mode,expression:"mode==='tabList'"}],ref:"tabList",attrs:{resourceType:"tab"},on:{read:e.handleRead}}),"tabPreview"===e.mode?a("TabPreview",{attrs:{row:e.previewData},on:{"go-back":e.goBack,"upsert-end":e.handleUpsertEnd}}):e._e()],1),a("el-tab-pane",{attrs:{label:"版块",name:"pannel"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"pannelList"===e.mode,expression:"mode==='pannelList'"}],ref:"pannelList",attrs:{resourceType:"pannel"},on:{read:e.handleRead}}),"pannelPreview"===e.mode?a("PanelPreview",{attrs:{row:e.previewData},on:{"go-back":e.goBack,"upsert-end":e.handleUpsertEnd}}):e._e()],1),a("el-tab-pane",{attrs:{label:"素材",name:"material"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"materialList"===e.mode,expression:"mode==='materialList'"}],ref:"materialList",attrs:{resourceType:"material"},on:{read:e.handleRead}}),"materialPreview"===e.mode?a("GlobalPictureUpsert",{attrs:{"edit-id":e.previewData.resourceId,initMode:"read"},on:{"show-list":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1),a("el-tab-pane",{attrs:{label:"布局",name:"layout"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"layoutList"===e.mode,expression:"mode==='layoutList'"}],ref:"layoutList",attrs:{resourceType:"layout"},on:{read:e.handleRead}}),"layoutPreview"===e.mode?a("LayoutInfo",{staticClass:"el-tab-preview",attrs:{id:e.previewData.resourceId,"init-mode":"read"},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}},[e._v("\n      "+e._s(JSON.stringify(e.previewData))+"\n    ")]):e._e()],1),a("el-tab-pane",{attrs:{label:"首页",name:"homepage"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"homepageList"===e.mode,expression:"mode==='homepageList'"}],ref:"homepageList",attrs:{resourceType:"homepage"},on:{read:e.handleRead}}),"homepagePreview"===e.mode?a("HomePageInfo",{staticClass:"el-tab-preview",attrs:{id:e.previewData.resourceId,"init-mode":"read",version:void 0},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1),a("el-tab-pane",{attrs:{label:"策略",name:"policy"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"policyList"===e.mode,expression:"mode==='policyList'"}],ref:"policyList",attrs:{resourceType:"policy"},on:{read:e.handleRead}}),"policyPreview"===e.mode?a("PolicyManageInfo",{staticClass:"el-tab-preview",attrs:{id:e.previewData.resourceId,"init-mode":"read",version:void 0},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1),a("el-tab-pane",{attrs:{label:"主题",name:"theme"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"themeList"===e.mode,expression:"mode==='themeList'"}],ref:"themeList",attrs:{resourceType:"theme"},on:{read:e.handleRead}}),"themePreview"===e.mode?a("ThemeInfoAdd",{attrs:{editId:e.previewData.resourceId,version:void 0,initMode:"read"},on:{"open-list-page":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1),a("el-tab-pane",{attrs:{label:"角标",name:"icon"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"iconList"===e.mode,expression:"mode==='iconList'"}],ref:"iconList",attrs:{resourceType:"icon"},on:{read:e.handleRead}}),"iconPreview"===e.mode?a("GlobalCornerIcon",{staticClass:"el-tab-preview",attrs:{id:e.previewData.resourceId,"init-mode":"read"},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1),a("el-tab-pane",{attrs:{label:"系统功能",name:"sysPlugin"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"sysPluginList"===e.mode,expression:"mode==='sysPluginList'"}],ref:"sysPluginList",attrs:{resourceType:"systemPlugin"},on:{read:e.handleRead}}),"sysPluginPreview"===e.mode?a("MultiFunctionBlockInfo",{staticClass:"el-tab-preview",attrs:{"init-mode":"read",id:e.previewData.resourceId,"content-props":{menuElId:"multiFunctionBlock"}},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1)],1)},ww=[],Iw=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data}})],1)],1)},Cw=[],Tw={components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"]},props:{resourceType:String},data:function(){var e=this;return{filter:{sort:void 0,order:void 0,type:"myAuditTasks"},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"taskId",width:"100"},{label:"名称",width:"130",prop:"taskName",sortable:!0,render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n)}}},n.taskName)}},{label:"待处理的版本",prop:"resourceVersion",render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n)}}},n.taskName)}},{label:"内容源",prop:"source",render:function(t,a){var n=a.row;return e.$consts.sourceText[n.source]}},{label:"优先级",prop:"priority",render:function(t,a){var n=a.row;return e.$numToReviewPriority(n.priority)}},{label:"任务状态",prop:"taskFlag",render:function(t,a){var n=a.row;return e.$numToTaskStatus(n.taskFlag)}},{label:"审核状态",prop:"auditFlag",render:function(t,a){var n=a.row;return e.$numToAuditStatus(n.auditFlag)}},{label:"审核人",prop:"currentOperatorName"},{label:"审核意见",prop:"auditDesc"},{label:"更新时间",prop:"lastUpdateDate",width:150,sortable:!0}],data:[],selected:[],selectionType:"none"}}},methods:{handleRead:function(e){this.$emit("read",e,this.resourceType+"Preview")},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.taskId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0,type:"myAuditTasks"},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();t.resourceType=this.resourceType,this.$service.todoTaskPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=ll.a.map({taskId:ll.a.o.string.other("form",{component:"Input",placeholder:"ID"}),taskName:ll.a.o.string.other("form",{component:"Input",placeholder:"名称"}),auditFlag:ll.a.o.enum({"审核中":6,"待审核":3,"审核通过":4,"审核不通过":5}).other("form",{component:"Select",placeholder:"审核状态"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},Sw=Tw,kw=Object(Yo["a"])(Sw,Iw,Cw,!1,null,null,null),_w=kw.exports,Pw=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"el-tab-pane-preview"},["special"===e.tabParentType&&void 0!==e.id?a("FilmDetailPageAdd",{attrs:{id:e.id,initMode:e.mode,version:e.version},on:{"open-list-page":e.handleUpsertEnd,"go-back":e.goBack}}):e._e(),"biz"===e.tabParentType&&void 0!==e.id?a("BusinessTabInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}):e._e(),"home"===e.tabParentType&&void 0!==e.id?a("TabInfo",{attrs:{id:e.id,"init-mode":e.mode},on:{"go-back":e.goBack,"upsert-end":e.handleUpsertEnd}}):e._e()],1)},xw=[],Fw={components:{FilmDetailPageAdd:tg,BusinessTabInfo:Av,TabInfo:Em["a"]},props:["row"],data:function(){return{id:void 0,mode:"read",version:void 0,tabParentType:void 0}},methods:{goBack:function(){this.$emit("go-back")},handleUpsertEnd:function(){this.$emit("upsert-end")}},created:function(){var e=this.row;this.id=e.resourceId,this.tabParentType=e.tabParentType,this.version=e.resourceVersion}},Dw=Fw,Rw=(a("5c3c"),Object(Yo["a"])(Dw,Pw,xw,!1,null,"6264d1c6",null)),Lw=Rw.exports,$w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"el-tab-pane-preview"},[8===e.pannelType?a("MarkPanelInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":function(t){return e.$emit("upsert-end")},"go-back":e.goBack}}):e._e(),1===e.pannelType?a("PanelInfo",{attrs:{id:e.id,"panel-data-type":1,"init-mode":e.mode,version:e.version},on:{"upsert-end":function(t){return e.$emit("upsert-end")},"go-back":e.goBack}}):e._e(),3===e.pannelType?a("PanelInfo",{attrs:{id:e.id,"panel-data-type":3,"init-mode":e.mode,version:e.version},on:{"upsert-end":function(t){return e.$emit("upsert-end")},"go-back":e.goBack}}):e._e(),9===e.pannelType||10===e.pannelType||5===e.pannelType?a("PrivatePannelInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":function(t){return e.$emit("upsert-end")},"go-back":e.goBack}}):e._e()],1)},Nw=[],Ew={components:{PanelInfo:Tu["a"],MarkPanelInfo:Uu["a"],PrivatePannelInfo:Fd["a"]},props:["row"],data:function(){return{id:void 0,mode:"read",version:void 0,pannelType:void 0}},methods:{goBack:function(){this.$emit("go-back")}},created:function(){var e=this.row;this.id=e.resourceId,this.pannelType=e.pannelType,this.version=e.resourceVersion}},Ow=Ew,Aw=(a("7289"),Object(Yo["a"])(Ow,$w,Nw,!1,null,"aeea75d6",null)),Vw=Aw.exports,Bw={components:{MySubmitTasksList:_w,PanelPreview:Vw,TabPreview:Lw,GlobalPictureUpsert:hh,LayoutInfo:Yh,HomePageInfo:Hm["a"],PolicyManageInfo:Af,ThemeInfoAdd:sy,GlobalCornerIcon:Ap,MultiFunctionBlockInfo:ou},data:function(){return{activeName:"tab",mode:"tabList",preMode:"tabList",previewData:void 0}},methods:{handleRead:function(e,t){this.previewData=e,this.preMode=this.mode,this.mode=t},goBack:function(){this.mode=this.preMode},handleClick:function(e){this.mode=this.preMode=e.name+"List"},handleUpsertEnd:function(){this.goBack(),this.$refs[this.preMode].fetchData()}}},Mw=Bw,Uw=(a("7b88"),Object(Yo["a"])(Mw,yw,ww,!1,null,"8efcd610",null)),Gw=Uw.exports,jw=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"版面",name:"tab"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"tabList"===e.mode,expression:"mode==='tabList'"}],ref:"tabList",attrs:{resourceType:"tab"},on:{read:e.handleRead}}),"tabPreview"===e.mode?a("TabPreview",{attrs:{row:e.previewData},on:{"go-back":e.goBack,"upsert-end":e.handleUpsertEnd}}):e._e()],1),a("el-tab-pane",{attrs:{label:"版块",name:"pannel"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"pannelList"===e.mode,expression:"mode==='pannelList'"}],ref:"pannelList",attrs:{resourceType:"pannel"},on:{read:e.handleRead}}),"pannelPreview"===e.mode?a("PanelPreview",{attrs:{row:e.previewData},on:{"go-back":e.goBack,"upsert-end":e.handleUpsertEnd}}):e._e()],1),a("el-tab-pane",{attrs:{label:"素材",name:"material"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"materialList"===e.mode,expression:"mode==='materialList'"}],ref:"materialList",attrs:{resourceType:"material"},on:{read:e.handleRead}}),"materialPreview"===e.mode?a("GlobalPictureUpsert",{attrs:{"edit-id":e.previewData.resourceId,initMode:"read"},on:{"show-list":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1),a("el-tab-pane",{attrs:{label:"布局",name:"layout"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"layoutList"===e.mode,expression:"mode==='layoutList'"}],ref:"layoutList",attrs:{resourceType:"layout"},on:{read:e.handleRead}}),"layoutPreview"===e.mode?a("LayoutInfo",{staticClass:"el-tab-preview",attrs:{id:e.previewData.resourceId,"init-mode":"read"},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1),a("el-tab-pane",{attrs:{label:"首页",name:"homepage"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"homepageList"===e.mode,expression:"mode==='homepageList'"}],ref:"homepageList",attrs:{resourceType:"homepage"},on:{read:e.handleRead}}),"homepagePreview"===e.mode?a("HomePageInfo",{staticClass:"el-tab-preview",attrs:{id:e.previewData.resourceId,"init-mode":"read",version:void 0},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1),a("el-tab-pane",{attrs:{label:"策略",name:"policy"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"policyList"===e.mode,expression:"mode==='policyList'"}],ref:"policyList",attrs:{resourceType:"policy"},on:{read:e.handleRead}}),"policyPreview"===e.mode?a("PolicyManageInfo",{staticClass:"el-tab-preview",attrs:{id:e.previewData.resourceId,"init-mode":"read",version:void 0},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1),a("el-tab-pane",{attrs:{label:"主题",name:"theme"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"themeList"===e.mode,expression:"mode==='themeList'"}],ref:"themeList",attrs:{resourceType:"theme"},on:{read:e.handleRead}}),"themePreview"===e.mode?a("ThemeInfoAdd",{attrs:{editId:e.previewData.resourceId,version:void 0,initMode:"read"},on:{"open-list-page":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1),a("el-tab-pane",{attrs:{label:"角标",name:"icon"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"iconList"===e.mode,expression:"mode==='iconList'"}],ref:"iconList",attrs:{resourceType:"icon"},on:{read:e.handleRead}}),"iconPreview"===e.mode?a("GlobalCornerIcon",{attrs:{id:e.previewData.resourceId,"init-mode":"read"},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1),a("el-tab-pane",{attrs:{label:"系统功能",name:"sysPlugin"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"sysPluginList"===e.mode,expression:"mode==='sysPluginList'"}],ref:"sysPluginList",attrs:{resourceType:"systemPlugin"},on:{read:e.handleRead}}),"sysPluginPreview"===e.mode?a("MultiFunctionBlockInfo",{staticClass:"el-tab-preview",attrs:{"init-mode":"read",id:e.previewData.resourceId,"content-props":{menuElId:"multiFunctionBlock"}},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1)],1)},zw=[],Ww=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data}})],1)],1)},qw=[],Jw={components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"]},props:{resourceType:String},data:function(){var e=this;return{filter:{sort:void 0,order:void 0,type:"mySubmittedTasks"},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"taskId",width:"100"},{label:"名称",width:"130",prop:"taskName",sortable:!0,render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n)}}},n.taskName)}},{label:"待处理的版本",prop:"resourceVersion",render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n)}}},n.taskName)}},{label:"内容源",prop:"source",render:function(t,a){var n=a.row;return e.$consts.sourceText[n.source]}},{label:"优先级",prop:"priority",render:function(t,a){var n=a.row;return e.$numToReviewPriority(n.priority)}},{label:"任务状态",prop:"taskFlag",render:function(t,a){var n=a.row;return e.$numToTaskStatus(n.taskFlag)}},{label:"审核状态",prop:"auditFlag",render:function(t,a){var n=a.row;return e.$numToAuditStatus(n.auditFlag)}},{label:"审核人",prop:"currentOperatorName"},{label:"审核意见",prop:"auditDesc"},{label:"更新时间",prop:"lastUpdateDate",width:150,sortable:!0}],data:[],selected:[],selectionType:"none"}}},methods:{handleRead:function(e){this.$emit("read",e,this.resourceType+"Preview")},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.taskId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0,type:"mySubmittedTasks"},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();t.resourceType=this.resourceType,this.$service.todoTaskPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=ll.a.map({taskId:ll.a.o.string.other("form",{component:"Input",placeholder:"ID"}),taskName:ll.a.o.string.other("form",{component:"Input",placeholder:"名称"}),auditFlag:ll.a.o.enum({"待审核":3,"审核通过":4,"审核不通过":5}).other("form",{component:"Select",placeholder:"审核状态"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},Hw=Jw,Kw=Object(Yo["a"])(Hw,Ww,qw,!1,null,null,null),Yw=Kw.exports,Qw={components:{MySubmitTasksList:Yw,PanelPreview:Vw,TabPreview:Lw,GlobalPictureUpsert:hh,LayoutInfo:Yh,HomePageInfo:Hm["a"],PolicyManageInfo:Af,ThemeInfoAdd:sy,GlobalCornerIcon:Ap,MultiFunctionBlockInfo:ou},data:function(){return{activeName:"tab",mode:"tabList",preMode:"tabList",previewData:void 0}},methods:{handleRead:function(e,t){this.previewData=e,this.preMode=this.mode,this.mode=t},goBack:function(){this.mode=this.preMode},handleClick:function(e){this.mode=this.preMode=e.name+"List"},handleUpsertEnd:function(){this.goBack(),this.$refs[this.preMode].fetchData()}}},Xw=Qw,Zw=(a("da88"),Object(Yo["a"])(Xw,jw,zw,!1,null,"39d4fe22",null)),eI=Zw.exports,tI=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ContentCard",[n("div",{staticClass:"ad-upsert"},[n("el-tabs",{model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[n("el-tab-pane",{staticClass:"detail-ad-wrapper",attrs:{label:"详情页广告位",name:"detail"}},[n("img",{staticClass:"detail-ad-1-2",attrs:{src:a("58c5")}}),n("img",{staticClass:"detail-ad-3",attrs:{src:a("580c")}}),n("el-form",{ref:"form",staticClass:"detail-form",attrs:{"label-width":"150px"}},[e.adSwitches.middle?n("cc-var",{attrs:{ad:e.adSwitches.middle},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[n("el-form-item",{staticClass:"detail-ad__1",attrs:{label:a.label}},[n("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:!!a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,2315655053)}):e._e(),e.adSwitches.bottom_serial?n("cc-var",{attrs:{ad:e.adSwitches.bottom_serial},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[n("el-form-item",{staticClass:"detail-ad__2",attrs:{label:a.label}},[n("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:!!a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,2208652494)}):e._e(),e.adSwitches.bottom_movie?n("cc-var",{attrs:{ad:e.adSwitches.bottom_movie},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[n("el-form-item",{staticClass:"detail-ad__3",attrs:{label:a.label}},[n("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:!!a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,2513247247)}):e._e()],1)],1),n("el-tab-pane",{attrs:{label:"视频播放广告",name:"video"}},[n("div",{staticClass:"video-ad-wrapper"},[n("p",{staticClass:"ad-title"},[e._v("前贴广告A"),n("span",[e._v("(加在腾讯、爱奇艺前贴广告之前的，酷开前贴广告)")])]),n("el-form",{attrs:{inline:!0,"label-width":"150px","label-position":"left"}},[e.adSwitches.front_detail_a?n("cc-var",{attrs:{ad:e.adSwitches.front_detail_a},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[n("el-form-item",{attrs:{label:a.label}},[n("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:!!a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,3651288997)}):e._e(),e.adSwitches.front_loop_a?n("cc-var",{attrs:{ad:e.adSwitches.front_loop_a},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[n("el-form-item",{attrs:{label:a.label}},[n("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:!!a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,3651288997)}):e._e(),e.adSwitches.front_topic_a?n("cc-var",{attrs:{ad:e.adSwitches.front_topic_a},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[n("el-form-item",{attrs:{label:a.label}},[n("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:!!a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,3651288997)}):e._e()],1)],1),n("div",{staticClass:"video-ad-wrapper"},[n("p",{staticClass:"ad-title"},[e._v("前贴广告B"),n("span",[e._v("(仅针对腾讯、爱奇艺不播前贴广告的场景，才播放我们自己的前贴广告B)")])]),n("el-form",{attrs:{inline:!0,"label-width":"150px","label-position":"left"}},[e.adSwitches.front_detail_b?n("cc-var",{attrs:{ad:e.adSwitches.front_detail_b},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[n("el-form-item",{attrs:{label:a.label}},[n("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:!!a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,3651288997)}):e._e(),e.adSwitches.front_loop_b?n("cc-var",{attrs:{ad:e.adSwitches.front_loop_b},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[n("el-form-item",{attrs:{label:a.label}},[n("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:!!a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,3651288997)}):e._e(),e.adSwitches.front_topic_b?n("cc-var",{attrs:{ad:e.adSwitches.front_topic_b},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[n("el-form-item",{attrs:{label:a.label}},[n("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:!!a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,3651288997)}):e._e()],1)],1),n("div",{staticClass:"video-ad-wrapper"},[n("p",{staticClass:"ad-title"},[e._v("中插广告")]),n("el-form",{attrs:{inline:!0,"label-width":"150px","label-position":"left"}},[e.adSwitches.middle_detail?n("cc-var",{attrs:{ad:e.adSwitches.middle_detail},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[n("el-form-item",{attrs:{label:a.label}},[n("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:!!a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,3651288997)}):e._e(),e.adSwitches.middle_loop?n("cc-var",{attrs:{ad:e.adSwitches.middle_loop},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[n("el-form-item",{attrs:{label:a.label}},[n("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:!!a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,3651288997)}):e._e(),e.adSwitches.middle_topic?n("cc-var",{attrs:{ad:e.adSwitches.middle_topic},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[n("el-form-item",{attrs:{label:a.label}},[n("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:!!a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,3651288997)}):e._e()],1)],1)]),n("el-tab-pane",{attrs:{label:"主页广告",name:"homepage"}},[e.adSwitches.screen?n("div",{staticClass:"video-ad-wrapper"},[n("p",{staticClass:"ad-title"},[e._v(e._s(e.adSwitches.screen.label))]),n("el-form",{attrs:{inline:!0,"label-width":"150px","label-position":"left"}},[n("cc-var",{attrs:{ad:e.adSwitches.screen},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[n("el-form-item",{attrs:{label:a.label}},[n("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:!!a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,3651288997)})],1)],1):e._e()]),n("el-tab-pane",{attrs:{label:"主页小窗口inline广告",name:"homepage-window"}},[e.adSwitches.broadcast_inline?n("div",{staticClass:"video-ad-wrapper"},[n("p",{staticClass:"ad-title"},[e._v(" "+e._s(e.adSwitches.broadcast_inline.label))]),n("el-form",{attrs:{inline:!0,"label-width":"150px","label-position":"left"}},[n("cc-var",{attrs:{ad:e.adSwitches.broadcast_inline},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[n("el-form-item",{attrs:{label:a.label,"label-width":"220px"}},[n("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:!!a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,1584887366)})],1)],1):e._e()]),n("el-tab-pane",{attrs:{label:"详情页的活动位",name:"activity_bar"}},[e.adSwitches.activity_bar?n("div",{staticClass:"video-ad-wrapper"},[n("p",{staticClass:"ad-title"},[e._v(e._s(e.adSwitches.activity_bar.label))]),n("el-form",{attrs:{inline:!0,"label-width":"150px","label-position":"left"}},[n("cc-var",{attrs:{ad:e.adSwitches.activity_bar},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[n("el-form-item",{attrs:{label:a.label,"label-width":"220px"}},[n("el-select",{attrs:{value:a.value},on:{input:function(t){return e.handleUpdateSwitch(a,t)}}},[n("el-option",{attrs:{label:"关",value:0}}),n("el-option",{attrs:{label:"开",value:1}}),n("el-option",{attrs:{label:"不显示福气值的进度条UI,但要提交视频播放时长数据",value:2}})],1)],1)]}}],null,!1,4282825363)})],1)],1):e._e()]),n("el-tab-pane",{attrs:{label:"15+5广告位",name:"15_plus_5"}},[e.adSwitches["15_plus_5"]?n("div",{staticClass:"video-ad-wrapper"},[n("p",{staticClass:"ad-title"},[e._v(e._s(e.adSwitches["15_plus_5"].label))]),n("el-form",{attrs:{inline:!0,"label-width":"150px","label-position":"left"}},[n("cc-var",{attrs:{ad:e.adSwitches["15_plus_5"]},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[n("el-form-item",{attrs:{label:a.label,"label-width":"220px"}},[n("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:!!a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,1584887366)})],1)],1):e._e()])],1)],1)])},aI=[],nI=a("b6c7"),iI={components:{"cc-var":nI["a"]},data:function(){return{adSwitches:{},activeTab:"detail"}},methods:{handleToggleSwitch:function(e){var t=this;this.$confirm("确定"+(e.value?"关闭":"开启")+"【"+e.label+"】的广告投放权限吗？").then(function(){t.doUpdate(e,e.value?0:1)}).catch(function(){})},handleUpdateSwitch:function(e,t){var a=this;this.$confirm("确定修改【"+e.label+"】的广告投放状态吗？").then(function(){a.doUpdate(e,t)}).catch(function(){})},doUpdate:function(e,t){this.$service.advertisementUpsert({id:e.id,status:t},"操作成功").then(function(a){e.value=t})},getLabel:function(e,t){return this.adSwitches[e+t].label},getSwitches:function(){var e=this;this.$service.advertisementList().then(function(t){var a={};t.rows.forEach(function(e){a[e.remark]={id:e.id,label:e.name,key:e.remark,value:+e.status}}),e.$set(e,"adSwitches",a)})}},created:function(){this.getSwitches()}},rI=iI,oI=(a("561d"),Object(Yo["a"])(rI,tI,aI,!1,null,null,null)),lI=oI.exports,sI=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{staticClass:"layout"},[a("div",{class:e.isCollapseMenu?"aside__menu aside__menu_collapse":"aside__menu"},[a("el-button",{staticClass:"collpase-btn",attrs:{type:"text",icon:e.isCollapseMenu?"el-icon-cc-indent":"el-icon-cc-outdent"},on:{click:e.toggleMenu}}),a("div",{staticClass:"left-aside"},[a("Menu",{attrs:{"default-active":e.$route.name,items:e.menu,isCollapse:e.isCollapseMenu},on:{select:e.handleOpenMenu}})],1)],1),a("el-container",{attrs:{direction:"vertical"}},[a("el-header",{staticClass:"header"},[a("div",{staticClass:"logo",attrs:{direction:"vertical"}},[a("div",{staticClass:"logo__img"},[a("i",{staticClass:"el-icon-location"}),e._v("\n          "+e._s(e.companyMap[e.$consts.idPrefix])+"内容运营平台\n        ")])]),a("span",{staticClass:"el-breadcrumb__separator",attrs:{role:"presentation"}},[e._v("/")]),a("Breadcrumb",{staticClass:"breadcrumb",attrs:{items:e.breadcrumb}}),a("div",{staticClass:"user-info"},[a("a",{attrs:{href:"http://wiki.skyoss.com/pages/viewpage.action?pageId=33481206",target:"_blank"}},[a("el-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"danger"}},[e._v("不好用，我要反馈")])],1),a("el-dropdown",{attrs:{"hide-on-click":!1},on:{command:e.handleDropdownCommand}},[a("span",{staticClass:"el-dropdown-link"},[a("i",{staticClass:"el-icon-cc-user"}),e._v("\n            "+e._s(e.$appState.user.name)+"\n            "),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"modifyPassword"},nativeOn:{click:function(t){return e.modifyPwd(t)}}},[e._v("修改密码")]),a("el-dropdown-item",{attrs:{command:"logout"}},[e._v("退出")])],1)],1)],1)],1),a("TagNav",{directives:[{name:"show",rawName:"v-show",value:e.isShowTagNav,expression:"isShowTagNav"}],ref:"tag",staticClass:"tagNav",attrs:{"default-path":"/desktop",titles:e.titles,"init-tags":e.initTags},on:{navigate:e.handleNavigate}}),a("el-main",{ref:"main",staticClass:"main-content"},[a("keep-alive",[e.isKeepAlive?a("router-view"):e._e()],1),e.isKeepAlive?e._e():a("router-view")],1)],1),a("el-dialog",{attrs:{title:"修改密码",visible:e.modifyDialogVisible},on:{"update:visible":function(t){e.modifyDialogVisible=t}}},[a("span",[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.formRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"旧密码",prop:"oldpwd"}},[a("el-input",{attrs:{type:"password",placeholder:"旧密码"},model:{value:e.form.oldpwd,callback:function(t){e.$set(e.form,"oldpwd",t)},expression:"form.oldpwd"}})],1),a("el-form-item",{attrs:{label:"新密码",prop:"newpwd"}},[a("el-input",{attrs:{type:"password",placeholder:"新密码"},model:{value:e.form.newpwd,callback:function(t){e.$set(e.form,"newpwd",t)},expression:"form.newpwd"}})],1),a("el-form-item",{attrs:{label:"确认新密码",prop:"newpwd2"}},[a("el-input",{attrs:{type:"password",placeholder:"确认密码"},model:{value:e.form.newpwd2,callback:function(t){e.$set(e.form,"newpwd2",t)},expression:"form.newpwd2"}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.modifyDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.modifyPwdSave}},[e._v("确 定")])],1)])],1)},cI=[],uI=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-menu",{staticClass:"menu",attrs:{"background-color":e.backgroundColor,"text-color":e.textColor,"active-text-color":e.activeTextColor,defaultActive:e.defaultActive,collapse:e.isCollapse},on:{select:e.handleSelect}},[e._l(e.items,function(t,n){return[t.children?a("el-submenu",{key:n,attrs:{index:n+""}},[a("div",{attrs:{slot:"title"},on:{click:function(a){return e.handleClickMenu(t.title)}},slot:"title"},[t.icon?a("i",{class:t.icon}):e._e(),a("span",[e._v(e._s(t.title))])]),e._l(t.children,function(t,i){return["undefined"===typeof t.children?a("el-menu-item",{key:i,attrs:{index:t.route},on:{click:function(a){return e.handleClickMenu(t.title)}}},[t.icon?a("i",{class:t.icon}):e._e(),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.title))])]):a("el-submenu",{key:i,attrs:{index:n+"_"+i}},[a("div",{attrs:{slot:"title"},on:{click:function(a){return e.handleClickMenu(t.title)}},slot:"title"},[t.icon?a("i",{class:t.icon}):e._e(),a("span",[e._v(e._s(t.title))])]),e._l(t.children,function(t,n){return[a("el-menu-item",{key:n,attrs:{index:t.route},on:{click:function(a){return e.handleClickMenu(t.title)}}},[t.icon?a("i",{class:t.icon}):e._e(),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.title))])])]})],2)]})],2):a("el-menu-item",{key:n,attrs:{index:t.route},on:{click:function(a){return e.handleClickMenu(t.title)}}},[t.icon?a("i",{class:t.icon}):e._e(),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.title))])])]})],2)},dI=[],pI={data:function(){return{itemsIndexed:{}}},props:["isCollapse","items","defaultActive","textColor","activeTextColor","backgroundColor"],methods:{handleSelect:function(e){this.$emit("select",e,this.itemsIndexed[e])},buildIndex:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t={};function a(e){e.route&&(t[e.route]=e),e.children&&e.children.forEach(a),Array.isArray(e)&&e.forEach(a)}a(e),this.itemsIndexed=t},handleClickMenu:function(e){this.$sendEvent({type:"menu_click",payload:{menu_name:e}})}},created:function(){this.$watch("items",this.buildIndex,{immediate:!0})}},hI=pI,mI=Object(Yo["a"])(hI,uI,dI,!1,null,null,null),fI=mI.exports,vI={rotateStationCategory:"rotateStationCategory",rotateStationCategory_viewStation:"rotateStationCategory_viewStation",rotateTopicInfo:"rotateTopicInfo",ownMediaResManage:"ownMediaResManage",rankingListManage:"rankingListManage",ccShortVideoConnectPositiveDetail:"ccShortVideoConnectPositiveDetail",rightsContentManage:"rightsContentManage",broadcastBlock:"broadcastBlock",multiFunctionBlock:"multiFunctionBlock",sysPlugin:"sysPlugin",mediaAutomation:"mediaAutomation",recStream:"recStream",recommendStreamScene:"recommendStreamScene",albumPannelInfo:"albumPannelInfo",markPanel:"markPanel",pannelInfo:"pannelInfo",ruleCreatePanel:"ruleCreatePanel",privatePannelInfo:"privatePannelInfo",commonOnclickInfo:"commonOnclickInfo",globalCornerIcon:"globalCornerIcon",globalCornerIconType:"globalCornerIconType",globalPicture:"globalPicture",layoutInfo:"layoutInfo",commonAlbumPanneleUser:"commonAlbumPanneleUser",commonPannelUser:"commonPannelUser",commonTabUser:"commonTabUser",dataSync:"dataSync",slaveBizErrLog:"slaveBizErrLog",slaveSecondAudit:"slaveSecondAudit",actDmpGroupInfo:"actDmpGroupInfo",homepageInfo:"homepageInfo",policyConf:"policyConf",testPolicyConf:"testPolicyConf",businessTab:"businessTab",filmDetailPage:"filmDetailPage",tabInfo:"tabInfo",videoContent:"videoContent",adminMasterControl:"adminMasterControl",dict:"dataDictionary",baDept:"baDept",roleConfig:"roleConfig",sysLogLogin:"sysLogLogin",sysLogOp:"sysLogOp",sysMenu:"sysMenu",userConfig:"userConfig",themeInfo:"themeInfo",msn:"msn",myDrafts:"myDrafts",myReviewTasks:"myReviewTasks",mySubmitTasks:"mySubmitTasks",filmDetailAdBit:"filmDetailAdBit",dmpMgr:"dmpMgr",topic:"topic",topicConfig:"topicConfig",panelRecommend:"panelRecommend",tabForceInsert:"tabForceInsert",panelRecommendCoreData:"panelRecommendCoreData",panelRecommendFeedback:"panelRecommendFeedback",childPolicy:"childPolicy",deviceConfig:"deviceConfig",testPolicyGroup:"testPolicyGroup",policyGroup:"policyGroup",matchHomepage:"matchHomepage"},gI={rotateStation:"el-icon-cc-interation",rotateStationCategory:"el-icon-cc-right-square",rotateStationCategory_viewStation:"el-icon-cc-down-square",rotateTopicInfo:"el-icon-cc-down-square",ownMediaResManage:"el-icon-cc-fund",rankingListManage:"el-icon-cc-fund",ccShortVideoConnectPositiveDetail:"el-icon-cc-fund",rightsContentManage:"el-icon-cc-fund",broadcastBlock:"el-icon-cc-gold",multiFunctionBlock:"el-icon-cc-control",sysPlugin:"el-icon-cc-minus-square",mediaAutomation:"el-icon-cc-tag",recStream:"el-icon-cc-tag",recommendStreamScene:"el-icon-cc-tag",ruleCreatePanel:"el-icon-cc-bankuaiguanli",blockInfo:"el-icon-cc-appstore",blockManage:"el-icon-cc-border",albumPannelInfo:"el-icon-cc-block",markPanel:"el-icon-cc-table",pannelInfo:"el-icon-cc-block",privatePannelInfo:"el-icon-cc-gateway",videoOnDemand:"el-icon-cc-tablet",commonModule:"el-icon-cc-cloud",commonOnclickInfo:"el-icon-cc-attachment",globalCornerIcon:"el-icon-cc-image",globalCornerIconType:"el-icon-cc-fund",globalPicture:"el-icon-cc-file-image",layoutInfo:"el-icon-cc-build",commonResource:"el-icon-cc-star",commonAlbumPanneleUser:"commonAlbumPanneleUser",commonPannelUser:"commonPannelUser",commonTabUser:"commonTabUser",slaveBizErrLog:"slaveBizErrLog",slaveSecondAudit:"slaveSecondAudit",actDmpGroupInfo:"actDmpGroupInfo",homePageManage:"el-icon-cc-bank",homepageInfo:"el-icon-cc-home",policyConf:"el-icon-cc-fork",testPolicyConf:"el-icon-cc-branches",panelManage:"el-icon-cc-layout",tabInfo:"el-icon-cc-pic-center",businessTab:"el-icon-cc-pic-right",filmDetailPage:"el-icon-cc-pic-left",resourceMgr:"el-icon-cc-folder-open",videoContent:"el-icon-cc-video",videoDataList:"el-icon-cc-file-copy",dataSyncMgr:"el-icon-cc-sync",sysConfig:"el-icon-cc-setting",adminMasterControl:"adminMasterControl",dict:"dataDictionary",baDept:"baDept",roleConfig:"roleConfig",sysLogLogin:"sysLogLogin",sysLogOp:"sysLogOp",sysMenu:"sysMenu",userConfig:"userConfig",themeManage:"el-icon-cc-font-colors",themeInfo:"el-icon-cc-font-size",msn:"el-icon-cc-database",todoTask:"el-icon-cc-edit-square",myDrafts:"el-icon-cc-database",myReviewTasks:"el-icon-cc-database",mySubmitTasks:"el-icon-cc-database",adBitMgr:"el-icon-cc-banner",filmDetailAdBit:"el-icon-cc-calendar-check",dirCrowdManager:"el-icon-cc-team",svMgr:"el-icon-cc-play-square",topic:"el-icon-cc-message",topicConfig:"el-icon-cc-notification",panelRecommend:"el-icon-cc-border-outer",tabForceInsert:"el-icon-sell",panelRecommendCoreData:"el-icon-data-line",panelRecommendFeedback:"el-icon-message",childPolicy:"el-icon-s-check",homeConfig:"el-icon-setting",deviceConfig:"el-icon-s-tools",policyGroup:"el-icon-cc-fork",testPolicyGroup:"el-icon-cc-branches",matchHomepage:"el-icon-cc-pic-center",recommendStream:"el-icon-connection"},bI={components:{Menu:fI,Breadcrumb:Bo["Breadcrumb"],TagNav:Bo["TagNav"]},data:function(){return{menu:[],titles:{},breadcrumb:[],isCollapseMenu:!1,isShowSetting:!1,isShowTagNav:!0,modifyDialogVisible:!1,companyMap:{10:"酷开",11:"江苏有线"},form:{oldpwd:null,newpwd:null,newpwd2:null},formRules:{oldpwd:[{required:!0,message:"请输入原始密码",trigger:"blur"}],newpwd:[{required:!0,message:"请输入新密码",trigger:"blur"}],newpwd2:[{required:!0,validator:this.validatePass2,trigger:"blur"}]}}},computed:{isKeepAlive:function(){var e=this.$route.meta;return e&&!1!==e.isCache},initTags:function(){var e=this.$appState.$get("tags_"+this.$appState.user.name)||[];return 0===e.length&&e.push({fullPath:"/desktop",meta:{title:"我的桌面",tagId:"desktop"},name:"desktop",isCloseable:!1}),e},defaultMenu:function(){var e=this.$router.options.routes.find(function(e){return"/"===e.path});function t(e){var a=e.name,n=e.meta,i=void 0===n?{}:n,r=e.children;if(!i.hideInMenu){var o={title:i.title,icon:i.icon,route:a};return r&&(o.children=r.reduce(function(e,a){var n=t(a);return n&&e.push(n),e},[])),o}}e.children.pop();var a=t(e).children;return console.log("defaultMenu:",a),a}},methods:{handleOpenMenu:function(e,t){this.$router.push({name:vI[e],query:t.query,params:t.params})},modifyPwd:function(){this.modifyDialogVisible=!0},modifyPwdSave:function(){var e=this;this.$refs.form.validate(function(t){if(t){var a=e.form,n=a.oldpwd,i=a.newpwd;if(n===i)return e.$message.error("新密码和旧密码不能一样");e.$service.modifyPwd(e.form,"修改成功").then(function(t){e.modifyDialogVisible=!1,e.$logout().then(function(){e.$router.push({name:"login"})})})}})},validatePass2:function(e,t,a){""===t?a(new Error("请再次输入密码")):t!==this.form.newpwd?a(new Error("两次输入密码不一致！")):a()},handleDropdownCommand:function(e){var t=this;"logout"===e&&this.$logout().then(function(){t.$router.push({name:"login"})})},toggleMenu:function(){var e=!this.isCollapseMenu;this.$appState.$set("isCollapseMenu",e),this.isCollapseMenu=e},saveTags:function(){var e=this.$refs.tag.tags;this.$appState.$set("tags_"+this.$appState.user.name,e)},getMenu:function(){var e=this;this.$service.getMenu().then(function(t){var a={},n=function e(t){if(Array.isArray(t))return t.map(e);a[t.id]=t.text;var n={icon:gI[t.id],route:t.id,title:t.text},i=t.attributes;i&&"3"===i.modle&&(n.openType=i.iframeUrl,n.query={url:i.iframeUrl});var r=t.children;return r&&r.length>0&&(n.children=e(r)),n};e.menu=n(t),e.titles=a,e.scrollMenuIntoView()})},handleNavigate:function(e){this.$sendEvent({type:"menu_click",payload:{menu_name:this.titles[e.name]}}),this.scrollMenuIntoView()},scrollMenuIntoView:function(){setTimeout(function(){var e=document.querySelector(".el-submenu.is-active"),t=document.querySelector(".el-menu-item.is-active");t&&t.scrollIntoViewIfNeeded(),e&&e.scrollIntoViewIfNeeded()},1e3)}},created:function(){var e=this;this.isCollapseMenu=!!this.$appState.$get("isCollapseMenu"),this.$bus.$on("breadcrumb-change",function(t){e.breadcrumb=t}),this.getMenu()},mounted:function(){var e=this;this.$bus.$on("scroll-top",function(){e.$refs.main&&e.$refs.main.$el.scrollTo(0,0)}),window.addEventListener("beforeunload",this.saveTags)},destroyed:function(){window.removeEventListener("beforeunload",this.saveTags)}},yI=bI,wI=(a("38b6"),a("8f40"),Object(Yo["a"])(yI,sI,cI,!1,null,"683608d1",null)),II=wI.exports,CI=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("PageWrapper",[n("PageContentWrapper",{directives:[{name:"show",rawName:"v-show",value:"desktop"===e.activePage,expression:"activePage === 'desktop'"}]},[n("ContentCard",{staticClass:"content"},[n("h2",[e._v("待处理任务")]),n("div",{staticClass:"list"},[n("div",[n("el-card",{staticClass:"box-card",staticStyle:{cursor:"pointer"}},[n("div",{on:{click:function(t){return e.goTo("myDrafts")}}},[n("img",{staticClass:"cod-img",attrs:{src:a("2366")}}),n("div",{staticClass:"text-wrap"},[n("span",{staticClass:"text"},[e._v("我的草稿")]),n("span",{staticClass:"text-num"},[e._v("("+e._s(e.draftNum)+")")])])])])],1),n("div",[n("el-card",{staticClass:"box-card",staticStyle:{cursor:"pointer"}},[n("div",{on:{click:function(t){return e.goTo("mySubmitTasks")}}},[n("img",{staticClass:"cod-img",attrs:{src:a("66d9")}}),n("div",{staticClass:"text-wrap"},[n("span",{staticClass:"text"},[e._v("我提交的任务")]),n("span",{staticClass:"text-num"},[e._v("("+e._s(e.submitNum)+")")])])])])],1),n("div",[n("el-card",{staticClass:"box-card",staticStyle:{cursor:"pointer"}},[n("div",{on:{click:function(t){return e.goTo("myReviewTasks")}}},[n("img",{staticClass:"cod-img",attrs:{src:a("3c3a")}}),n("div",{staticClass:"text-wrap"},[n("span",{staticClass:"text"},[e._v("我的审核任务")]),n("span",{staticClass:"text-num"},[e._v("("+e._s(e.auditNum)+")")])])])])],1),n("div",[n("el-card",{staticClass:"box-card",staticStyle:{cursor:"pointer"}},[n("div",{on:{click:function(t){return e.goTo("msn")}}},[n("img",{staticClass:"cod-img",attrs:{src:a("55cf")}}),n("div",{staticClass:"text-wrap"},[n("span",{staticClass:"text"},[e._v("下架影片")]),n("span",{staticClass:"text-num"},[e._v("("+e._s(e.movieNum)+")")])])])])],1)])]),"11"==e.$consts.idPrefix?n("ContentCard",{staticStyle:{"margin-top":"20px"}},[n("div",[n("h2",[e._v("\n          江苏有线\n          "),n("span",{directives:[{name:"show",rawName:"v-show",value:void 0!==e.isAutoSync,expression:"isAutoSync !== undefined"}],staticStyle:{float:"right","font-weight":"normal"}},[e._v("\n            是否自动同步酷开数据 "),n("el-switch",{attrs:{value:e.isAutoSync},on:{input:function(t){return e.handleSetAutoSync(t)}}})],1)]),!1===e.isAutoSync&&e.dataSyncGeneral?n("div",[n("el-row",{staticClass:"data-sync-list"},[n("el-col",{staticClass:"data-sync-list__item",attrs:{span:24},nativeOn:{click:function(t){return e.handleViewDataList("panel-list")}}},[n("span",[e._v("常规运营版块")]),n("span",{staticClass:"data-sync-list__num"},[e._v(e._s(e.dataSyncGeneral.normalPanel.total))])]),n("el-col",{staticClass:"data-sync-list__item",attrs:{span:24},nativeOn:{click:function(t){return e.handleViewDataList("album-list")}}},[n("span",[e._v("业务专辑版块")]),n("span",{staticClass:"data-sync-list__num"},[e._v(e._s(e.dataSyncGeneral.albumPanel.total))])]),n("el-col",{staticClass:"data-sync-list__item",attrs:{span:24},nativeOn:{click:function(t){return e.handleViewDataList("tab-list")}}},[n("span",[e._v("TAB版面")]),n("span",{staticClass:"data-sync-list__num"},[e._v(e._s(e.dataSyncGeneral.otherTab.total))])]),n("el-col",{staticClass:"data-sync-list__item",attrs:{span:24},nativeOn:{click:function(t){return e.handleViewDataList("film-list")}}},[n("span",[e._v("影视详情页版面")]),n("span",{staticClass:"data-sync-list__num"},[e._v(e._s(e.dataSyncGeneral.filmDetailTab.total))])])],1)],1):e._e()])]):e._e()],1),"panel-list"===e.activePage?n("PageContentWrapper",[n("keep-alive",[n("PanelList",{on:{read:e.handleReadPanel,"go-back":e.goBack}})],1)],1):e._e(),"tab-list"===e.activePage?n("PageContentWrapper",[n("keep-alive",[n("TabList",{on:{read:e.handleReadTab,"go-back":e.goBack}})],1)],1):e._e(),"album-list"===e.activePage?n("PageContentWrapper",[n("keep-alive",[n("AlbumList",{on:{read:e.handleReadPanel,"go-back":e.goBack}})],1)],1):e._e(),"film-list"===e.activePage?n("PageContentWrapper",[n("keep-alive",[n("FilmPageList",{on:{read:e.handleReadFilm,"go-back":e.goBack}})],1)],1):e._e(),"panel-read"===e.activePage?n("PageContentWrapper",[n("PanelInfo",{attrs:{id:e.panelPreview.id,"panel-data-type":e.panelPreview.dataType,"init-mode":"read",version:e.panelPreview.version},on:{"upsert-end":function(t){return e.goBack(3==e.panelPreview.dataType?"album-list":"panel-list")},"go-back":function(t){return e.goBack(3==e.panelPreview.dataType?"album-list":"panel-list")}}})],1):e._e(),"tab-read"===e.activePage?n("PageContentWrapper",[n("TabInfo",{attrs:{id:e.tabPreview.id,"init-mode":"read",version:e.tabPreview.version},on:{"upsert-end":function(t){return e.goBack("tab-list")},"go-back":function(t){return e.goBack("tab-list")}}})],1):e._e(),"film-read"===e.activePage?n("PageContentWrapper",[n("TabInfo",{attrs:{id:e.filmPreview.id,"init-mode":"read",version:e.filmPreview.version},on:{"upsert-end":function(t){return e.goBack("tab-list")},"go-back":function(t){return e.goBack("tab-list")}}})],1):e._e()],1)},TI=[],SI=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:"待处理版块"},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("ContentWrapper",{attrs:{pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},kI=[],_I={extends:Sl["a"],components:{ContentWrapper:Bo["ContentWrapper"],Table:Bo["Table"]},data:function(){var e=this;return{resourceType:"panelInfo",filter:this.genDefaultFilter(),filterSchema:null,pagination:{currentPage:1,pageSize:20},businessType:{},table:{props:{},data:[],header:[{label:"ID",prop:"pannelGroupId"},{label:"名称",minWidth:"180","show-overflow-tooltip":!0,render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(n)}}},n.pannelGroupRemark)}},{label:"布局",width:"150",prop:"fullLayoutName"},{label:"业务分类",prop:"categoryName"},{label:"内容源",prop:"pannelResource",formatter:function(t){return e.$consts.sourceText[t.pannelList[0].pannelResource]}},{label:"引用状态",prop:"fullTabName","show-overflow-tooltip":!0},{label:"版本/状态",prop:"pannelStatus",width:"130",formatter:function(t){var a=t.pannelStatus,n=t.currentVersion;return n+"/"+e.$consts.statusText[a]}},{label:"更新时间",prop:"lastUpdateDate",width:"140","show-overflow-tooltip":!0},{label:"审核人",prop:"auditor",width:"100"},{label:"更新人",width:"100",prop:"userName"}],selected:[],selectionType:"multiple"},selected:[]}},methods:{genDefaultFilter:function(){return{keyword:"pannel",subCategoryArray:"1"}},fetchData:function(){var e=this,t=this.parseFilter();this.$service.desktopGetDataSyncList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.pannelId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){console.log(this.dataList),this.dataList?(this.filter=Object.assign({},this.dataList.filter),console.log(this.filter)):this.filter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()}},created:function(){this.fetchData()}},PI=_I,xI=Object(Yo["a"])(PI,SI,kI,!1,null,"35600934",null),FI=xI.exports,DI=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:"待处理业务专辑"},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("ContentWrapper",{attrs:{pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},RI=[],LI={extends:Sl["a"],components:{ContentWrapper:Bo["ContentWrapper"],Table:Bo["Table"]},data:function(){var e=this;return{resourceType:"panelInfo",filter:this.genDefaultFilter(),filterSchema:null,pagination:{currentPage:1,pageSize:20},businessType:{},table:{props:{},data:[],header:[{label:"ID",prop:"pannelGroupId"},{label:"名称",minWidth:"180","show-overflow-tooltip":!0,render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(n)}}},n.pannelGroupRemark)}},{label:"布局",width:"150",prop:"fullLayoutName"},{label:"业务分类",prop:"categoryName"},{label:"内容源",prop:"pannelResource",formatter:function(t){return e.$consts.sourceText[t.pannelList[0].pannelResource]}},{label:"引用状态",prop:"fullTabName","show-overflow-tooltip":!0},{label:"版本/状态",prop:"pannelStatus",width:"130",formatter:function(t){var a=t.pannelStatus,n=t.currentVersion;return n+"/"+e.$consts.statusText[a]}},{label:"更新时间",prop:"lastUpdateDate",width:"140","show-overflow-tooltip":!0},{label:"审核人",prop:"auditor",width:"100"},{label:"更新人",width:"100",prop:"userName"}],selected:[],selectionType:"multiple"},selected:[]}},methods:{genDefaultFilter:function(){return{keyword:"pannel",subCategoryArray:"3",idPrefix:"10"}},fetchData:function(){var e=this,t=this.parseFilter();this.$service.desktopGetDataSyncList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.pannelId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){console.log(this.dataList),this.dataList?(this.filter=Object.assign({},this.dataList.filter),console.log(this.filter)):this.filter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()}},created:function(){this.fetchData()}},$I=LI,NI=Object(Yo["a"])($I,DI,RI,!1,null,"3da43079",null),EI=NI.exports,OI=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:"待处理版面"},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("ContentWrapper",{attrs:{pagination:e.pagination},on:{"filter-change":e.fetchData}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},AI=[],VI={extends:Sl["a"],components:{ContentWrapper:Bo["ContentWrapper"],Table:Bo["Table"]},data:function(){var e=this;return{resourceType:"tabInfo",selected:[],tabTypeOption:[{label:"信号源版面",value:"5"},{label:"第三方版面",value:"4"},{label:"专题版面",value:"2"},{label:"普通版面",value:"1"}],tabStatusOption:[{label:"下架",value:"0"},{label:"上架",value:"1"},{label:"草稿",value:"2"},{label:"待审核",value:"3"},{label:"审核通过",value:"4"},{label:"审核不通过",value:"5"}],businessType:[],filter:this.genDefaultFilter(),efficientFilter:this.genDefaultFilter(),appIdType:[],filterSchema:null,pagination:{currentPage:1,pageSize:20},table:{props:{},data:[],header:[{label:"ID",prop:"tabId"},{label:"名称",prop:"tabName","show-overflow-tooltip":!0,render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n)}}},n.tabName)}},{label:"版面属性",prop:"tabType",formatter:function(e){var t=e.tabType;return{1:"普通版面",2:"专题版面",4:"第三方版面",5:"信号源版面"}[t+""]||"未知版面"}},{label:"业务分类",prop:"businessCategoryName"},{label:"内容源",prop:"tabResource",formatter:function(e){var t=e.tabResource;return this.$consts.sourceText[t]||""}},{label:"AppId",prop:"tabAppid",formatter:function(t){return e.appIdType.map(function(e){if(t.tabAppid.toString()===e.dictEnName)return e.dictCnName})}},{label:"版本/状态",prop:"tabStatus",formatter:function(t){var a=t.tabStatus,n=t.currentVersion;return n+"/"+e.tabStatusOption.map(function(e){if(a.toString()===e.value)return e.label}).join("")}},{label:"更新时间",prop:"lastUpdateDate",width:140},{label:"审核人",prop:"auditor",width:100},{label:"更新人",prop:"modifierName",width:100}],selected:[],selectionType:"multiple"}}},methods:{genDefaultFilter:function(){return{idPrefix:"10",keyword:"tab",subCategoryArray:"1,2"}},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();if(t.tabId&&!/^\d+$/.test(t.tabId))return this.$message({type:"error",message:"ID 必须为正整数"});this.$service.desktopGetDataSyncList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.pagination,t=JSON.parse(JSON.stringify(this.efficientFilter));return e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(){this.pagination.currentPage=1,this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.fetchData()},handleFilterReset:function(){this.filter=this.genDefaultFilter(),this.efficientFilter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},addTabInfo:function(){this.$emit("create")},editData:function(){var e=this.table,t=this.table.selected,a=e.data[t[0]];this.$emit("edit",a)},getBusinessType:function(){var e=this;this.$service.getDictType({type:"businessType"}).then(function(t){e.businessType=t})},handleToggleCollect:function(e){var t=this;e.collected?this.$service.collectCancel({type:"tab",data:{resourceId:e.tabId}},"取消收藏成功").then(function(){t.$set(e,"collected",!1)}):this.$service.collect({type:"tab",data:{resourceId:e.tabId}},"收藏成功").then(function(){t.$set(e,"collected",!0)})}},created:function(){var e=this;this.$service.getDictType({type:"appIdType"}).then(function(t){e.appIdType=t,e.fetchData()}),this.getBusinessType()}},BI=VI,MI=(a("88fe"),Object(Yo["a"])(BI,OI,AI,!1,null,"604dff22",null)),UI=MI.exports,GI=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:"待处理影片详情页"},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("ContentWrapper",{attrs:{pagination:e.pagination},on:{"filter-change":e.fetchData}},[a("div",{staticClass:"el-row"}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},jI=[],zI={extends:Sl["a"],components:{ContentWrapper:Bo["ContentWrapper"],Table:Bo["Table"]},data:function(){var e=this;return{resourceType:"film",pannelValue:[],filter:this.genDefaultFilter(),efficientFilter:this.genDefaultFilter(),pagination:{currentPage:1,pageSize:20},tabStatusOption:[{label:"下架",value:"0"},{label:"上架",value:"1"},{label:"草稿",value:"2"},{label:"待审核",value:"3"},{label:"审核通过",value:"4"},{label:"审核不通过",value:"5"}],productOptions:[],channelOptions:[],table:{props:{},data:[],header:[{prop:"tabId",label:"ID",sortable:!0},{prop:"tabName",label:"版面名称",minWidth:180,"show-overflow-tooltip":!0,render:function(t,a){var n=a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handleRead(n)}}},n.tabName)}},{prop:"filmDetailPageInfo.priority",label:"优先级",sortable:!0},{prop:"tabCategory",label:"业务分类",sortable:!0,formatter:function(e){return 0===e.tabCategory||67===e.tabCategory?"影视":1===e.tabCategory?"教育":""}},{prop:"filmDetailPageInfo.source",label:"内容源",sortable:!0,formatter:function(e){if(0!==e.tabCategory&&67!==e.tabCategory)return"";switch(e.filmDetailPageInfo.source){case"qq":return"腾讯";case"iqiyi":return"爱奇艺";case"youku":return"优酷"}}},{prop:"tabStatus",label:"版本/状态",sortable:!0,formatter:function(t){return t.currentVersion+"/"+e.$consts.statuxText[t.tabStatus]}},{prop:"duplicateVersion",label:"待审核副本",sortable:!0,render:function(t,a){var n=a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handleRead(n,n.duplicateVersion)}}},n.duplicateVersion)}},{prop:"lastUpdateDate",label:"更新时间",sortable:!0,width:140},{prop:"modifierName",label:"更新人",sortable:!0},{prop:"auditor",label:"审核人",sortable:!0}],selected:[],selectionType:"multiple"},selected:[],filterFormRules:{tabId:[{validator:function(e,t,a){if(t&&!/^\d+$/.test(t))return a(Error("请输入数字"));a()}}]}}},methods:{genDefaultFilter:function(){return{keyword:"tab",subCategoryArray:3}},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.desktopGetDataSyncList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows,e.table.selected=[],e.selected=[]})},parseFilter:function(){var e=this.pagination,t=JSON.parse(JSON.stringify(this.efficientFilter));return e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(){var e=this;this.$refs.filterForm.validate(function(t){t&&(e.pagination.currentPage=1,e.efficientFilter=Object(Go["cloneDeep"])(e.filter),e.fetchData())})},handleFilterReset:function(){this.filter=this.genDefaultFilter(),this.efficientFilter=this.genDefaultFilter(),this.pannelValue=[],this.pagination.currentPage=1,this.fetchData()},getMediaResourceInfo:function(){var e=this;return this.$service.getMediaResourceInfo().then(function(t){var a=JSON.parse(decodeURI(t.slice(5,-1))),n=a.videoItemModels,i=n.reduce(function(e,t){return e.push(t.productList),e},[]),r=[].concat.apply([],i);e.productOptions=r;var o={label:"爱奇艺",value:"iqiyi",children:[]};o.children=n[0].categoryList.reduce(function(e,t){return e.concat({label:t.category_name,value:t.cc_category_id})},[]);var l={label:"腾讯",value:"qq",children:[]};l.children=n[1].categoryList.reduce(function(e,t){return e.concat({label:t.category_name,value:t.cc_category_id})},[]);var s={label:"优酷",value:"youku",children:[]};s.children=n[2].categoryList.reduce(function(e,t){return e.concat({label:t.category_name,value:t.cc_category_id})},[]),e.channelOptions.push(o),e.channelOptions.push(l),e.channelOptions.push(s)})},handleChannelChange:function(e){this.filter["filmDetailPageInfo.source"]="",this.filter["filmDetailPageInfo.source"]=e[0]}},created:function(){this.getMediaResourceInfo().then(function(){}),this.fetchData()}},WI=zI,qI=(a("c644"),Object(Yo["a"])(WI,GI,jI,!1,null,"e58ca8b0",null)),JI=qI.exports,HI={components:{ContentCard:Wo["a"],PanelList:FI,AlbumList:EI,TabList:UI,FilmPageList:JI,PanelInfo:Tu["a"],TabInfo:Em["a"],PageWrapper:eu["a"],PageContentWrapper:tu["a"]},data:function(){return{activePage:"desktop",draftNum:null,movieNum:null,auditNum:null,submitNum:null,mode:void 0,title:void 0,id:void 0,version:void 0,isAutoSync:void 0,dataSyncGeneral:null,panelPreview:{id:void 0,version:void 0,dataType:void 0},tabPreview:{id:void 0,version:void 0},filmPreview:{id:void 0,version:void 0}}},watch:{isAutoSync:"handleAutoSyncChange"},methods:{handleViewDataList:function(e){this.activePage=e},handleSetAutoSync:function(e){var t=this,a=e?"开启同步后，酷开数据将会自动更新至该平台，确认开启？":"关闭同步后，您需要进行手动确认才可同步酷开数据，确认关闭？";this.$confirm(a,"提示").then(function(){t.$service.desktopUpdateDataSyncInfo({enableManualOn:e}).then(function(){t.isAutoSync=e})}).catch(function(e){console.log(e)})},handleAutoSyncChange:function(){this.isAutoSync||this.getDataSyncGeneral()},handleReadPanel:function(e){this.panelPreview={id:e.pannelGroupId,version:e.currentVersion,dataType:e.pannelType},this.activePage="panel-read"},handleReadTab:function(e){this.tabPreview={id:e.tabId,version:e.currentVersion},this.activePage="tab-read"},handleReadFilm:function(e){this.filmPreview={id:e.tabId,version:e.currentVersion},this.activePage="film-read"},goTo:function(e){return this.$router.push({name:e})},goBack:function(e){this.activePage=e||"desktop"},getDataSyncGeneral:function(){var e=this;this.$service.desktopGetDataSyncGeneral().then(function(t){e.dataSyncGeneral=t})}},created:function(){var e=this;this.$service.getTotal("myDrafts").then(function(t){e.draftNum=t}),this.$service.getTotal("mySubmittedTasks").then(function(t){e.submitNum=t}),this.$service.getTotal("myAuditTasks").then(function(t){e.auditNum=t}),this.$service.getTotal("msn").then(function(t){e.movieNum=t}),"10"!==this.$consts.idPrefix&&this.$service.desktopGetDataSyncInfo().then(function(t){e.isAutoSync=t.isOn})}},KI=HI,YI=(a("c04e"),Object(Yo["a"])(KI,CI,TI,!1,null,"32cfcfc7",null)),QI=YI.exports,XI=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("iframe",{staticClass:"frame-page",attrs:{src:e.src}})},ZI=[],eC={computed:{src:function(){var e=this.$route.query.url;return/^http/.test(e)?e:"".concat(location.protocol,"//").concat(e)}}},tC=eC,aC=(a("32c2"),Object(Yo["a"])(tC,XI,ZI,!1,null,"2de1fbec",null)),nC=aC.exports,iC=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("div",{staticStyle:{margin:"10px 0"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleCreate}},[e._v("新建")]),a("el-button",{attrs:{type:"success"},on:{click:e.handleEdit}},[e._v("编辑")]),a("el-button",{attrs:{type:"danger"},on:{click:e.handleDelete}},[e._v("删除")])],1),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},rC=[],oC={extends:Sl["a"],components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"]},data:function(){return{resourceType:"crowdRel",filter:{},filterSchema:null,pagination:{currentPage:1,pageSize:20},selected:[],table:{props:{},header:[{label:"策略ID",prop:"policyId"},{label:"策略名",prop:"policyName"}],data:[],selected:[],selectionType:"multiple"}}},methods:{fetchData:function(){var e=this,t=this.parseFilter();this.$service.crowdRelList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.pannelId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={},this.pagination.currentPage=1,this.fetchData()}},created:function(){this.fetchData()}},lC=oC,sC=(a("eff5"),Object(Yo["a"])(lC,iC,rC,!1,null,"a648b170",null)),cC=sC.exports,uC=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:"人群关系管理"},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("div",{staticClass:"dmp-relationship"},[a("div",{staticClass:"actions"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("保存")])],1),a("el-form",{attrs:{"label-width":"120px"}},[a("el-form-item",{attrs:{label:"人群策略"}},[a("el-select",{staticClass:"dmp-relationship__policy",attrs:{disabled:!!e.id,placeholder:"请选择"},model:{value:e.rel.policyId,callback:function(t){e.$set(e.rel,"policyId",t)},expression:"rel.policyId"}},e._l(e.policyOptions,function(e){return a("el-option",{key:e.value,attrs:{disabled:!!e.disable,label:e.label,value:e.value}})}),1),a("el-button",{attrs:{type:"primary",disabled:!e.rel.policyId,loading:e.isRefreshing},on:{click:e.handleRefreshCrowd}},[e._v(e._s(e.isRefreshing?"刷新中":"刷新人群列表"))])],1),a("el-form-item",{attrs:{label:"人群关系图"}},[a("cc-level",{directives:[{name:"show",rawName:"v-show",value:e.rel.policyId,expression:"rel.policyId"}],attrs:{levels:e.rel.levels,items:e.rel.items,"max-depth":8},on:{"level-label-change":e.handleChangeLevelLabel,"level-add":e.handleAddLevel,"level-remove":e.handleRemoveLevel,"item-remove":e.handleRemoveItem,"item-activate":e.handleActivateItem},scopedSlots:e._u([{key:"item-add",fn:function(t){return[a("div",{staticClass:"crowd-add-wrapper"},[a("el-autocomplete",{attrs:{disabled:t.levelIndex>0&&void 0===e.rel.levels[t.levelIndex-1].activeValue,value:e.itemToAdd[t.levelIndex],placeholder:"人群ID，人群名称","custom-item":"crowd-search-item","trigger-on-focus":!1,"fetch-suggestions":e.handleSearchCrowd},on:{input:function(a){return e.$set(e.itemToAdd,t.levelIndex,a)},select:function(a){return e.handleAddCrowdFromInput(a,t.levelIndex)}},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.item;return a("span",{attrs:{title:n.label}},[e._v("\n                  "+e._s(n.label)+"\n                ")])}}],null,!0)}),a("el-button",{attrs:{disabled:t.levelIndex>0&&void 0===e.rel.levels[t.levelIndex-1].activeValue},on:{click:function(a){return e.handleAddItem(t.levelIndex)}}},[e._v("添加")])],1)]}}])})],1)],1),e.showCrowdSelector?a("cc-tag-selector",{attrs:{tags:e.availableCrowdOptions,disables:e.disabledCrowdIds},on:{"select-end":e.handleSelectCrowdEnd,"select-cancel":function(t){e.showCrowdSelector=!1}}}):e._e()],1)])},dC=[],pC=(a("386d"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"cc-level"},[e._l(e.levels,function(t,n){return[n>0?a("div",{key:"level-btn-"+n,staticClass:"cc-level-buttons"},[a("i",{staticClass:"el-icon-arrow-right"})]):e._e(),a("div",{key:"level-wrapper-"+n,staticClass:"cc-level-wrapper"},[a("div",{staticClass:"cc-level-title"},[a("el-input",{attrs:{value:t.label},on:{input:function(t){return e.$emit("level-label-change",t,n)}}})],1),e._t("item-add",[a("div",{staticClass:"cc-level-add"},[a("el-input",{model:{value:e.itemToAdd[n],callback:function(t){e.$set(e.itemToAdd,n,t)},expression:"itemToAdd[levelIndex]"}}),a("el-button",{on:{click:function(t){return e.handleAddItem(n)}}},[e._v("添加")])],1)],{levelIndex:n}),a("div",{staticClass:"cc-level-item-list"},[e._l(e.items,function(i){return[i.parentValue===t.parentValue&&i.level===n?a("div",{key:i.value,class:["cc-level-item",i.value===t.activeValue?"active":""],on:{click:function(t){return e.$emit("item-activate",i,n)}}},[a("span",{attrs:{title:i.label}},[e._v(e._s(i.label))]),a("i",{staticClass:"cc-level-item-remove el-icon-circle-close",attrs:{title:"删除"},on:{click:function(t){return e.$emit("item-remove",i)}}})]):e._e()]})],2),a("i",{staticClass:"cc-level-level-remove el-icon-circle-close",attrs:{title:"删除"},on:{click:function(t){return e.$emit("level-remove",n)}}})],2)]}),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.maxDepth||e.levels.length<e.maxDepth,expression:"maxDepth ? levels.length < maxDepth : true"}],staticClass:"cc-level__add-level",attrs:{type:"primary"},on:{click:function(t){return e.$emit("level-add")}}},[e._v("添加下一级")])],2)}),hC=[],mC={data:function(){return{itemToAdd:{}}},props:["levels","items","maxDepth"],methods:{handleAddItem:function(e){this.$emit("item-add",this.itemToAdd[e])}}},fC=mC,vC=(a("7d45"),Object(Yo["a"])(fC,pC,hC,!1,null,"86c9cdf2",null)),gC=vC.exports,bC=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"选择人群",visible:!0,"before-close":e.handleClose}},[a("div",{staticClass:"name-list"},[a("div",[a("el-input",{attrs:{placeholder:"搜素人群ID， 人群名称"},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),e._l(e.availableTags,function(t){return a("el-checkbox",{key:t.value,staticClass:"name-list__item",attrs:{title:t.label,disabled:!(!t.disabled&&!e.disablesIndexed[t.value])},model:{value:e.selectMap[t.value],callback:function(a){e.$set(e.selectMap,t.value,a)},expression:"selectMap[item.value]"}},[e._v("\n      "+e._s(t.label)+"\n    ")])})],2),a("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSelectEnd}},[e._v("添加")])],1)])},yC=[],wC=a("ffe7"),IC=a.n(wC),CC={props:{tags:{type:Array},selected:{type:Array},disables:{type:Array}},data:function(){return{keyword:void 0,selectedIndexed:{},disablesIndexed:{},selectMap:{}}},computed:{availableTags:function(){var e=this.keyword;if(e){var t=new IC.a(this.tags,{keys:["label","value"]});return t.search(e)}return this.tags}},watch:{selected:"updateSelectedIndex",disables:"updateDisablesIndex"},methods:{handleSelectEnd:function(){var e=this.selectMap,t=this.tags.reduce(function(t,a){return e[a.value]&&t.push(a),t},[]);this.$emit("select-end",t)},updateSelectedIndex:function(){this.buildIndex("selected","selectedIndexed")},updateDisablesIndex:function(){this.buildIndex("disables","disablesIndexed")},buildIndex:function(e,t){this[t]=(this[e]||[]).reduce(function(e,t){return e[t]=!0,e},{})},handleClose:function(){this.$emit("select-cancel")}},created:function(){this.buildIndex("selected","selectedIndexed"),this.buildIndex("disables","disablesIndexed");var e={},t=this.selectedIndexed;this.tags.forEach(function(a){e[a.value]=!!t[a.value]}),this.selectMap=e}},TC=CC,SC=(a("d1c2"),Object(Yo["a"])(TC,bC,yC,!1,null,"0fe6fac1",null)),kC=SC.exports,_C={components:{"cc-level":gC,"cc-tag-selector":kC},data:function(){return{isRefreshing:!1,showCrowdSelector:!1,crowdKeyword:"",rel:{policyId:void 0,levels:this.getDefaultLevels(),items:[]},policyOptions:[],availableCrowdOptions:[],crowdOptions:[],disabledCrowdIds:[],selectedLevelIndex:void 0,itemToAdd:{}}},props:["id","mode"],watch:{"rel.policyId":"handlePolicyIdChange"},methods:{getDefaultLevels:function(){return[{level:0,label:"一级",parentValue:void 0,activeValue:void 0},{level:1,label:"二级",parentValue:void 0,activeValue:void 0},{level:2,label:"三级",parentValue:void 0,activeValue:void 0}]},handleAddCrowdFromInput:function(e,t){void 0!==e.value&&this.addCrowdToLevel(e,t),this.itemToAdd[t]=""},handleSearchCrowd:function(e,t){var a=[];if(e){var n=this.rel.items.reduce(function(e,t){return e[t.value]=t,e},{}),i=this.crowdOptions.filter(function(e){return void 0===n[e.value]}),r=new IC.a(i,{keys:["label","value"]});a=r.search(e)}0===a.length&&a.push({label:"没有相关结果..."}),t(a)},handleAddLevel:function(){var e=this.rel.levels;e.push({id:void 0,label:["一","二","三","四","五","六","七","八","九","十"][e.length]+"级",selected:{}})},handleChangeLevelLabel:function(e,t){this.rel.levels[t].label=e},handleRemoveLevel:function(e){var t=this.rel.levels[e];this.$confirm("是否确认删除整个 "+t.label+"  层级, 删除后所有后面的层级也会被删除","提示").then(function(){var t=this.rel.items.filter(function(t){return t.level===e});t.forEach(this.doRemoveItem),this.rel.levels=this.rel.levels.slice(0,e)}.bind(this)).catch(function(){})},handleAddItem:function(e){this.showCrowdSelector=!0,this.selectedLevelIndex=e;var t={};this.rel.items.forEach(function(e){t[e.value]=!0}),this.availableCrowdOptions=this.crowdOptions.filter(function(e){return!t[e.value]})},handleActivateItem:function(e,t){var a=!this.rel.items.find(function(t){return t.value===e.value});if(!a){this.rel.levels.slice(t+1).forEach(function(e){e.parentValue=void 0,e.activeValue=void 0});var n=this.rel.levels[t+1];n&&(n.parentValue=e.value),this.rel.levels[t].activeValue=e.value}},doRemoveItem:function(e){var t=this.rel.items,a={},n=this.rel.levels.reduce(function(e,t){return t.activeValue&&(e[t.activeValue]=t),e},{}),i=function e(i){a[i]=!0,t.forEach(function(t){t.parentValue===i&&e(t.value)}),n[i]&&(n[i].activeValue=void 0)};i(e.value),this.rel.items=t.filter(function(e){return!a[e.value]})},handleRemoveItem:function(e){var t=this.rel.items.some(function(t){return t.parentValue===e.value}),a=this.doRemoveItem.bind(this);t?this.$confirm("是否确认删除 "+e.label+" 分组, 删除后将同时删除它下面的标签","提示").then(function(){a(e)}).catch(function(){}):a(e)},handlePolicyIdChange:function(e){this.clearDmpRel(),this.$service.crowdRelGet({id:e}).then(function(e){e.hasCascadeTag&&(this.setDmpRel(e),this.id||this.$message("该策略下已经创建了人群关系"))}.bind(this)),this.$service.getCrowdOfPolicy({id:e}).then(function(e){this.crowdOptions=e}.bind(this))},handleSelectCrowdEnd:function(e){var t=this.selectedLevelIndex;e&&e.forEach(function(e){this.addCrowdToLevel(e,t)}.bind(this)),this.showCrowdSelector=!1},addCrowdToLevel:function(e,t){var a=this.rel.levels[t],n={parentValue:a.parentValue,label:e.label,value:e.value,level:t};this.rel.items.push(n)},handleSubmit:function(){this.validate(this.rel,function(e){e?this.$message({type:"error",message:e}):this.$service.crowdRelUpsert(this.parseDataToApi(this.rel),"保存成功").then(function(){this.$emit("upsert-end")}.bind(this))}.bind(this))},validate:function(e,t){for(var a=e.levels,n=0,i=a.length;n<i;n++)if(!a[n].label)return t(Error("请填写第"+(n+1)+"个层级的标题"));t()},parseDataToApi:function(e){e=JSON.parse(JSON.stringify(e));var t={policyId:e.policyId,crowdRelationship:{}};return t.crowdRelationship.levels=e.levels.map(function(e){return{label:e.label}}),t.crowdRelationship.items=e.items,t},parseApiToData:function(e){e=JSON.parse(JSON.stringify(e));var t=e.crowdRelationship;return e.levels=t.levels.map(function(e,t){return{level:t,label:e.label,parentValue:void 0,activeValue:void 0}}),e.items=t.items.map(function(e){return{label:e.label,value:+e.value,parentValue:e.parentValue?+e.parentValue:void 0,level:e.level}}),e.crowdRelationship=void 0,e},setDmpRel:function(e){var t={};e=this.parseApiToData(e),t.policyId=e.policyId,t.levels=e.levels,t.items=e.items,this.rel=t,console.log(this.rel)},clearDmpRel:function(){this.rel.levels=this.getDefaultLevels(),this.rel.items=[]},getPolicyOptions:function(){return this.$service.getCrowdPolicy().then(function(e){this.policyOptions=e}.bind(this))},handleRefreshCrowd:function(){this.isRefreshing=!0,this.$service.crowdRefresh().then(function(){this.$service.getCrowdOfPolicy({id:this.rel.policyId}).then(function(e){this.crowdOptions=e;var t=e.reduce(function(e,t){return e[t.value]=t,e},{});this.rel.items.forEach(function(e){var a=t[e.value];a&&this.$set(e,"label",a.label)}.bind(this)),this.isRefreshing=!1,this.$message("刷新成功")}.bind(this))}.bind(this)).catch(function(){this.isRefreshing=!1,this.$message("刷新失败")})}},created:function(){this.getPolicyOptions(),this.id&&this.$service.crowdRelGet({id:this.id}).then(function(e){this.setDmpRel(e)}.bind(this))}},PC=_C,xC=(a("3354"),Object(Yo["a"])(PC,uC,dC,!1,null,"6bbfb212",null)),FC=xC.exports,DC={extends:xc["a"],components:{ResourceList:cC,ResourceContent:FC},data:function(){return{}},computed:{resourceInfo:function(){return{type:"crowdRel",idField:"policyId"}}},methods:{handleDelete:function(e){var t=this,a=this.resourceInfo,n="id";this.$service.deleteResource({type:a.type,id:e.map(function(e){return e[n]}).join(",")},"删除成功").then(function(){t.$refs.list.fetchData()})}}},RC=DC,LC=Object(Yo["a"])(RC,uc,dc,!1,null,null,null),$C=LC.exports,NC=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PageWrapper",[a("PageContentWrapper",[a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("div",{staticClass:"action-list"},["edit"===e.mode?a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("保存")]):e._e(),"read"===e.mode?a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.mode="edit"}}},[e._v("编辑")]):e._e()],1),a("DataForm",{attrs:{"label-width":"120px"}},[a("DataString",{attrs:{label:"版块ID",readonly:!0},model:{value:e.panelRecommend.panelGroupId,callback:function(t){e.$set(e.panelRecommend,"panelGroupId",t)},expression:"panelRecommend.panelGroupId"}}),a("DataString",{attrs:{label:"版块名称",readonly:!0},model:{value:e.panelRecommend.panelGroupName,callback:function(t){e.$set(e.panelRecommend,"panelGroupName",t)},expression:"panelRecommend.panelGroupName"}}),a("DataEnum",{attrs:{label:"内容源",options:e.$consts.sourceOptions,readonly:!0},model:{value:e.panelRecommend.source,callback:function(t){e.$set(e.panelRecommend,"source",t)},expression:"panelRecommend.source"}}),a("DataAny",{attrs:{label:"允许推荐流设置"}},[a("div",{staticClass:"stream-sign-list",attrs:{slot:"edit"},slot:"edit"},e._l(e.recommendStreamSignOptions,function(t,n){return a("div",{key:n,staticClass:"stream-sign-item"},[a("el-checkbox",{attrs:{disabled:"read"===e.mode,value:e.panelRecommend.panelGroupCategory.indexOf(t.value)>-1,label:t.label},on:{input:function(a){return e.handleInputCategoryItem(t.value)}}}),a("el-radio",{attrs:{disabled:"read"===e.mode,value:e.panelRecommend.recLockCategory.indexOf(t.value)>-1,label:!0},nativeOn:{click:function(a){return a.preventDefault(),e.handleInputLockItem(t.value)}}},[e._v("\n                锁定\n              ")])],1)}),0)])],1)],1)],1)],1)},EC=[],OC={components:{PageWrapper:eu["a"],PageContentWrapper:tu["a"],ContentCard:Wo["a"]},mixins:[ds["a"]],data:function(){return{resourceName:"版块推荐流",mode:"create",panelRecommend:{panelGroupId:"",panelGroupName:"",panelGroupVersion:"",source:"",flagRecommend:0,panelGroupCategory:[],recLockCategory:[]},recommendStreamSignOptions:[]}},props:["id","initMode"],methods:{handleInputCategoryItem:function(e){var t=this.panelRecommend,a=t.panelGroupCategory;-1===a.indexOf(e)?a.push(e):t.panelGroupCategory=a.filter(function(t){return t!==e})},handleInputLockItem:function(e){var t=this.panelRecommend,a=t.recLockCategory,n=a.indexOf(e)>-1;n?t.recLockCategory=a.filter(function(t){return t!==e}):a.push(e)},getRecommendStreamSignOptions:function(){return this.$service.getDictType({type:"recommendStreamSign"}).then(function(e){return e.map(function(e){return{label:e.dictCnName,value:e.dictCnName}})})},setPanelRecommend:function(e){var t=this.panelRecommend,a=e.panelGroupCategory,n=e.recLockCategory;a&&(t.panelGroupCategory=a.split(",")),n&&(t.recLockCategory=n.split(",")),Object.assign(t,Object(Go["pick"])(e,["panelGroupId","panelGroupName","panelGroupVersion","source","flagRecommend"]))},fetchData:function(e){this.$service.panelRecommendGetDetail({id:this.id}).then(this.setPanelRecommend)},parseDataToApi:function(e){return e=Object(Go["cloneDeep"])(e),e.panelGroupCategory=e.panelGroupCategory.join(","),e.recLockCategory=e.recLockCategory.join(","),e},handleSave:function(){var e=this;this.$service.panelRecommendUpsert(this.parseDataToApi(this.panelRecommend)).then(function(){e.$emit("upsert-end")})}},created:function(){var e=this;this.mode=this.initMode,this.fetchData(this.version),this.getRecommendStreamSignOptions().then(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.recommendStreamSignOptions=t.filter(function(e){return"精选"!==e.label})})}},AC=OC,VC=(a("c8f6"),Object(Yo["a"])(AC,NC,EC,!1,null,"45239012",null)),BC=VC.exports,MC=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{ref:"contentCard",staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},UC=[],GC={extends:Sl["a"],components:{ContentWrapper:Bo["ContentWrapper"],Table:Bo["Table"]},props:{},data:function(){var e=this;return{resourceType:"panelRecommend",filter:this.genDefaultFilter(),filterSchema:null,pagination:{currentPage:1},businessType:{},table:{props:{},data:[],header:[{label:"ID",prop:"panelGroupId"},{label:"名称",minWidth:"180","show-overflow-tooltip":!0,render:function(t,a){var n=a.row;return n.flag?t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(n,n.panelGroupVersion)}}},n.panelGroupName):n.panelGroupName}},{label:"版本",prop:"panelGroupVersion"},{label:"内容源",prop:"pannelResource",formatter:function(t){return e.$consts.sourceText[t.source]}},{label:"可推荐",prop:"pannelResource",formatter:function(e){return e.flag?"是":"否"}},{label:"版块分类",prop:"panelGroupCategory"},{label:"版块相关媒资的类型",prop:"videoCategory",width:130},{label:"不可推荐原因",prop:"flagReason"},{label:"原因描述",prop:"reasonDescribe"},{label:"更新时间",prop:"lastUpdateDate",width:"140","show-overflow-tooltip":!0},{label:"允许推荐的版块流",prop:"panelGroupCategory",width:"140","show-overflow-tooltip":!0},{label:"操作",fixed:"right",width:180,render:function(t,a){var n=a.row;return n.flag?t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleToggleRecommendFlag(n)}}},"不可推荐"):"已设置不可推荐"}}],selected:[],selectionType:"multiple"},selected:[]}},watch:{selected:{handler:function(e,t){var a=this.table,n=[];a.data.map(function(t){if(e.indexOf(t.pannelGroupId)>-1){var a={pannelGroupId:t.pannelGroupId,pannelGroupRemark:t.pannelGroupRemark,duplicateVersion:t.duplicateVersion};n.push(a)}}),this.$emit("input",n)}}},methods:{handleOpenContentAuthManager:function(e){this.$refs.contentCard.handleShowContentAuthManager({id:e.pannelGroupId,menuElId:"pannelInfo",type:"pannel"})},genDefaultFilter:function(){return{panelGroupId:void 0,panelGroupName:void 0,source:void 0}},handleToggleRecommendFlag:function(e){var t=this;this.$confirm("设置为“不可推荐”后，该版块将不会出现在任何流中，但是，若要将该版块恢复成“可推荐”，则非常困难，需要联系开发处理","提示").then(function(){var a=e.flag?0:1;t.$service.panelRecommendFlagUpsert({panelGroupId:e.panelGroupId,flag:a},"设置成功").then(function(){e.flag=a})}).catch(function(){})},fetchData:function(){var e=this,t=this.parseFilter();this.$service.panelRecommendList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.pannelId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){console.log(this.dataList),this.dataList?(this.filter=Object.assign({},this.dataList.filter),console.log(this.filter)):this.filter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()}},created:function(){var e=this;this.$service.getDictType({type:"recommendStreamSign"}).then(function(t){var a=t.reduce(function(e,t){var a=t.dictCnName;return e[a]=a,e},{}),n=ll.a.map({panelGroupId:ll.a.o.string.other("form",{placeholder:"ID",component:"Input",name:"pannelId",autocomplete:"on"}),panelGroupName:ll.a.o.string.other("form",{placeholder:"版块名称",component:"Input",name:"pannelName",autocomplete:"on"}),source:ll.a.o.enum(e.$consts.sourceEnums).other("form",{placeholder:"内容源",component:"Select"}),panelGroupCategory:ll.a.o.enum(a).other("form",{placeholder:"推荐流",component:"Select"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});e.filterSchema=n}),this.fetchData()}},jC=GC,zC=Object(Yo["a"])(jC,MC,UC,!1,null,"4562550d",null),WC=zC.exports,qC={extends:xc["a"],components:{ResourceList:WC,ResourceContent:BC},data:function(){return{}},computed:{resourceInfo:function(){return{type:"panelRecommend",idField:"panelGroupId"}}}},JC=qC,HC=Object(Yo["a"])(JC,pc,hc,!1,null,null,null),KC=HC.exports,YC=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("TabPage",[a("AssignVideoRecomList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,read:e.handleRead,edit:e.handleEdit,delete:e.handleDelete}}),e.isShowList?e._e():a("AssignVideoRecomInfo",{attrs:{id:e.id,version:e.version,"init-mode":e.mode,status:e.status},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},QC=[],XC=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{ref:"contentCard",staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"blockInfo"},on:{add:e.handleCreate,edit:e.handleEdit}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},ZC=[],eT={normal:"普通",child:"少儿",movie:"电影",series:"电视剧"},tT={extends:Sl["a"],components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"],ButtonGroupForListPage:kl["a"]},data:function(){var e=this;return{resourceType:"broadcastBlock",filter:this.genDefaultFilter(),filterSchema:null,pagination:{currentPage:1},selected:[],table:{props:{},header:[{label:"影片推荐流ID",prop:"id",sortable:!0,width:"120px",fixed:"left"},{label:"影片推荐流名称",prop:"name",fixed:"left",render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n)}}},n.name)}},{label:"内容源",prop:"source",render:function(t,a){var n=a.row;return e.$consts.sourceTextWithNone[n.source]}},{label:"源状态",prop:"openStatus",render:function(e,t){var a=t.row;return["关闭","开启"][a.openStatus]}},{label:"流类型",prop:"type",formatter:function(e){return eT[e.type]||"普通"}},{label:"版本/状态",prop:"status",formatter:function(t){var a=t.status,n=t.currentVersion;return n+"/"+e.$consts.statusText[a]}},{label:"待审核的版本",prop:"duplicateVersion",render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(n,n.duplicateVersion)}}},n.duplicateVersion)}},{label:"影片数量",prop:"videoNum"},{label:"已屏蔽影片数量",prop:"disableVideoNum"},{label:"图片海报尺寸",prop:"picSize"},{label:"操作",fixed:"right",render:function(t,a){var n=a.row;if(n.showContentAuthSettingBtn)return t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleOpenContentAuthManager(n)}}},"内容权限")}}],data:[],selected:[],selectionType:"multiple"}}},methods:{handleOpenContentAuthManager:function(e){this.$refs.contentCard.handleShowContentAuthManager({id:e.id,type:"block",menuElId:"broadcastBlock"})},genDefaultFilter:function(){return{page:1,rows:10}},handleFilterChange:function(e,t){t&&(this.filter=t),"query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData()},handleFilterReset:function(){this.filter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();this.$service.getMediaAutomationList(t).then(function(t){e.pagination.total=t.total,t.rows=t.rows.map(function(e){return e.picSize=e.picSize.join(","),e}),e.table.data=t.rows})},keyAndValueExchage:function(e){return Object.keys(e).reduce(function(t,a){return t[e[a]]=a,t},{})}},created:function(){var e=ll.a.map({id:ll.a.o.oneOf([ll.a.number,ll.a.value("")]).$msg("请输入数字").other("form",{component:"InputPositiveInt",placeholder:"影片流ID"}),name:ll.a.o.string.other("form",{component:"Input",placeholder:"影片流名称"}),source:ll.a.o.enum(this.$consts.sourceOptionsWithNoneEnums).other("form",{component:"Select",placeholder:"内容源",clearable:!0}),openStatus:ll.a.o.enum({"开启":1,"关闭":0}).other("form",{component:"Select",placeholder:"源状态",clearable:!0}),status:ll.a.o.enum(this.$consts.statusEnums).other("form",{component:"Select",placeholder:"审核状态",clearable:!0}),type:ll.a.o.enum(this.keyAndValueExchage(eT)).other("form",{component:"Select",placeholder:"流类型",clearable:!0})}).other("form",{layout:"inline",cols:{item:6,label:0,wrapper:20},footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},aT=tT,nT=(a("4c30"),Object(Yo["a"])(aT,XC,ZC,!1,null,"cfe07068",null)),iT=nT.exports,rT=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},["create"===e.mode?[a("el-form",{ref:"createForm",attrs:{model:e.createForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"流名称",prop:"name",rules:e.basicFormRules.name}},[a("el-input",{staticClass:"title-input",model:{value:e.createForm.name,callback:function(t){e.$set(e.createForm,"name",t)},expression:"createForm.name"}})],1),a("el-form-item",{attrs:{label:"源",prop:"source"}},[a("el-radio-group",{model:{value:e.createForm.source,callback:function(t){e.$set(e.createForm,"source",t)},expression:"createForm.source"}},e._l(e.$consts.sourceOptions,function(t){return a("el-radio",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label))])}),1)],1),a("el-form-item",{attrs:{label:"流类型"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.createForm.type,callback:function(t){e.$set(e.createForm,"type",t)},expression:"createForm.type"}},e._l(e.streamTypeGroup,function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)}),1),"normal"!==e.createForm.type?a("div",{staticClass:"type-tip"},[e._v("Tip：基本流仅适用于标准尺寸的推荐位 (标准尺寸：260*364，498*280)")]):e._e()],1)],1),a("div",{staticClass:"base-info"},[e._v("\n      创建流后，默认是关闭状态的。填充完内容后，找产品或开发去开启状态;\n    ")]),a("el-row",{staticClass:"createBtn-container"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleCreate}},[e._v("创建")]),a("el-button",{attrs:{type:"success"},on:{click:function(t){return e.$emit("go-back")}}},[e._v("取消")])],1)]:[a("CommonContent",{attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{replicate:function(t){e.mode="replicate"},copy:e.handleCopy,edit:function(t){e.mode="edit"},unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,audit:function(t){return e.$emit("upsert-end")},"submit-audit":e.handleSubmitAudit,"save-draft":e.handleSaveDraft,"select-version":e.fetchData,"cancel-timing":function(t){return e.fetchData(e.tabInfo.currentVersion)},delete:function(t){return e.$emit("upsert-end",t)}}},[a("div",{staticClass:"form-legend-header",on:{click:function(t){e.isCollapseBase=!e.isCollapseBase}}},[e.isCollapseBase?a("i",{staticClass:"el-icon-arrow-down"}):a("i",{staticClass:"el-icon-arrow-up"}),a("span",[e._v(" 流基本设置")])]),a("div",{style:{display:e.isCollapseBase?"none":"block"}},[a("el-form",{ref:"basicForm",attrs:{model:e.basicForm,"label-width":"150px",rules:e.basicFormRules}},[a("el-form-item",{attrs:{label:"推荐流ID"}},[e._v(e._s(e.basicForm.id))]),a("el-form-item",{attrs:{label:"推荐流名称",prop:"name"}},[a("el-input",{staticClass:"title-input",attrs:{disabled:e.isRead},model:{value:e.basicForm.name,callback:function(t){e.$set(e.basicForm,"name",t)},expression:"basicForm.name"}})],1),a("el-form-item",{attrs:{label:"源",prop:"source"}},[a("el-radio-group",{attrs:{value:e.basicForm.source,disabled:e.isRead||e.isReplica},on:{input:e.handleSourceChange}},e._l(e.$consts.sourceOptions,function(t){return a("el-radio",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label))])}),1)],1),a("el-form-item",{attrs:{label:"流状态"}},[e._v("\n          "+e._s(["关闭","开启"][e.basicForm.openStatus])+"\n        ")])],1)],1),a("div",{staticClass:"form-legend-header",on:{click:function(t){e.isCollapseVideo=!e.isCollapseVideo}}},[e.isCollapseVideo?a("i",{staticClass:"el-icon-arrow-down"}):a("i",{staticClass:"el-icon-arrow-up"}),a("span",[e._v(" 影片选择")])]),a("div",{style:{display:e.isCollapseVideo?"none":"block"}},[a("div",{staticClass:"video-select--header"},[a("InputPositiveInt",{staticClass:"num-input",attrs:{disabled:e.isRead},model:{value:e.newVideoTabNum,callback:function(t){e.newVideoTabNum=t},expression:"newVideoTabNum"}}),a("el-button",{attrs:{type:"primary",disabled:e.isRead},on:{click:function(t){return e.handleAddVideoTab(e.newVideoTabNum)}}},[e._v("添加")]),a("ResourceSelector",{ref:"resourceSelector",attrs:{"is-live":!1,selectors:["video","edu","pptv","live","topic","rotate"],"selection-type":"multiple",source:e.basicForm.source,"disable-partner":!0,disabled:e.isRead},on:{"select-end":e.handleSelectResourcesEnd}},[a("el-button",{staticClass:"batch-btn",attrs:{type:"primary",disabled:e.isRead,title:"若260*364或498*280的尺寸存在，选择资源后自动填充默认图"}},[e._v("批量选择资源")])],1),a("el-button",{attrs:{type:"primary",title:"若260*364或498*280的尺寸存在，选择资源后自动填充默认图",disabled:e.isRead},on:{click:function(t){e.isVisibleSize=!e.isVisibleSize}}},[e._v("添加尺寸")]),a("el-button",{attrs:{type:"text",disabled:e.isRead},on:{click:function(t){return e.handleAddTabSize(t,260,364)}}},[e._v("添加260*364")]),a("el-button",{attrs:{type:"text",disabled:e.isRead},on:{click:function(t){return e.handleAddTabSize(t,498,280)}}},[e._v("添加498*280")]),e._l(e.sizeTags,function(t,n){return a("el-tag",{key:n,staticClass:"size-tag",attrs:{type:"primary",closable:!e.isRead&&t.closable},on:{close:function(a){return e.handleTagClose(t)}}},[e._v("\n            "+e._s(t.width)+" x "+e._s(t.height)+"\n        ")])})],2),e._l(e.videoTabs,function(t,n){return a("div",{key:n,staticClass:"videoTab--wrapper"},[a("AssignVideoTab",{attrs:{index:n,source:e.basicForm.source,"input-tags":e.sizeTags,disabled:e.isRead},on:{"handle-delTab":e.handleDelTab,"select-clicked-source":function(t){return e.handleSelectClickedSource(t,n)},"select-normal-source":function(t){return e.handleSelectNormalSource(t,n)},blur:function(t){return e.handleBlurSort(n)},"del-normal-source":function(t){return e.handleDelNormalSource(n)}},model:{value:e.videoTabs[n],callback:function(t){e.$set(e.videoTabs,n,t)},expression:"videoTabs[index]"}})],1)})],2)])],a("el-dialog",{attrs:{title:"添加尺寸",visible:e.isVisibleSize,width:"30%"},on:{"update:visible":function(t){e.isVisibleSize=t}}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{staticClass:"text-center-align",attrs:{span:12}},[e._v("宽")]),a("el-col",{staticClass:"text-center-align",attrs:{span:12}},[e._v("高")])],1),a("el-row",[a("el-col",{attrs:{span:10}},[a("InputPositiveInt",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleAddTabSize(t)}},model:{value:e.newTabSize.width,callback:function(t){e.$set(e.newTabSize,"width",t)},expression:"newTabSize.width"}})],1),a("el-col",{staticClass:"text-center-align",attrs:{span:4}},[e._v("X")]),a("el-col",{attrs:{span:10}},[a("InputPositiveInt",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleAddTabSize(t)}},model:{value:e.newTabSize.height,callback:function(t){e.$set(e.newTabSize,"height",t)},expression:"newTabSize.height"}})],1)],1),a("div",{staticClass:"size-btn-group"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleAddTabSize}},[e._v("确定")]),a("el-button",{attrs:{type:"success"},on:{click:function(t){e.newTabSize={},e.isVisibleSize=!e.isVisibleSize}}},[e._v("取消")])],1)],1)],2)},oT=[],lT=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{staticClass:"header"},[a("el-col",{staticClass:"video-index",attrs:{span:4}},[e._v("影片"+e._s(e.index+1))]),a("el-col",{attrs:{span:14}},[e._v("置顶值\n      "),a("InputPositiveInt",{staticClass:"num-input",attrs:{disabled:e.disabled},on:{blur:function(t){return e.$emit("blur")}},model:{value:e.value.priority,callback:function(t){e.$set(e.value,"priority",t)},expression:"value.priority"}})],1),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"text",disabled:e.disabled},on:{click:function(t){e.value.flagRec=!e.value.flagRec}}},[e._v(e._s(e.value.flagRec?"取消屏蔽":"屏蔽"))])],1),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"text",disabled:e.disabled},on:{click:function(t){return e.$emit("handle-delTab",e.index)}}},[e._v("删除")])],1)],1),a("div",{staticClass:"container"},[a("el-form",{attrs:{"label-width":"150px"}},[a("el-form-item",{attrs:{label:"点击类型",rules:e.rules.required}},[a("el-radio-group",{attrs:{disabled:e.disabled},model:{value:e.value.clickType,callback:function(t){e.$set(e.value,"clickType",t)},expression:"value.clickType"}},[a("el-radio",{attrs:{label:"detail"}},[e._v("点击进详情页")]),a("el-radio",{attrs:{label:"play-fullscreen"}},[e._v("点击全屏播放")])],1)],1),a("el-form-item",{attrs:{label:"内容资源",rules:e.rules.required}},[a("ResourceSelector",{ref:"resourceSelector",style:{display:e.disabled?"none":"inline-block"},attrs:{"is-live":!1,selectors:e.resourceOptions,"selection-type":"single",source:e.source,"disable-partner":!0},on:{"select-end":function(t){return e.$emit("select-clicked-source",t)}}},[a("el-button",{attrs:{type:"primary",plain:"",title:"若260*364或498*280的尺寸存在，选择资源后自动填充默认图"}},[e._v("选择资源")])],1),a("el-tag",{directives:[{name:"show",rawName:"v-show",value:e.value.mediaResourceId,expression:"value.mediaResourceId"}],staticClass:"marginL",attrs:{type:"success"}},[e._v("已选择："+e._s(e.value.mediaResourceId))])],1),a("el-form-item",{attrs:{label:"主标题",rules:e.rules.title}},[a("el-input",{staticClass:"title-input",attrs:{disabled:e.disabled},model:{value:e.value.title,callback:function(t){e.$set(e.value,"title",t)},expression:"value.title"}})],1),a("el-form-item",{attrs:{label:"副标题"}},[a("el-input",{staticClass:"title-input",attrs:{disabled:e.disabled},model:{value:e.value.subTitle,callback:function(t){e.$set(e.value,"subTitle",t)},expression:"value.subTitle"}})],1),a("el-form-item",{attrs:{label:"图片海报",rules:e.rules.required}},[a("div",{staticClass:"poster--wrapper"},e._l(e.inputTags,function(t,n){return a("div",{key:n,staticClass:"poster--container"},[a("GlobalPictureSelector",{attrs:{disabled:e.disabled,"picture-resolution":e.formatPicResolution(t.width,t.height)},on:{"select-end":function(t){return e.handleSelectPostEnd(t,n)}}},[a("div",{staticClass:"poster--pic",style:e.computePicStyle(t.width,t.height)},[e.value.picInfoList[n]&&e.value.picInfoList[n].pictureUrl?a("img",{ref:"img",refInFor:!0,staticClass:"poster-image",attrs:{referrerpolicy:"no-referrer",src:e.value.picInfoList[n].pictureUrl}}):e._e(),a("i",{staticClass:"el-icon-close poster--del",on:{click:function(t){return t.stopPropagation(),e.handleDelPoster(n)}}})])])],1)}),0),0!==e.inputTags.length?a("div",[a("el-checkbox",{attrs:{value:!e.value.showSeries,disabled:e.disabled},on:{input:function(t){e.value.showSeries=t?0:1}}},[e._v("不展示期数")]),a("el-checkbox",{attrs:{value:!e.value.showScore,disabled:e.disabled},on:{input:function(t){e.value.showScore=t?0:1}}},[e._v("不展示评分")])],1):e._e()]),a("el-form-item",{attrs:{label:"视频资源"}},[a("ResourceSelector",{style:{display:e.disabled?"none":"inline-block"},attrs:{"is-live":!1,selectors:e.resourceOptions,"selection-type":"single",source:e.source,"disable-partner":!0},on:{"select-end":function(t){return e.$emit("select-normal-source",t)}}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("选择资源")])],1),e.value.videoId?a("el-tag",{staticClass:"video-tag",attrs:{type:"success",closable:""},on:{close:function(t){return e.$emit("del-normal-source")}}},[e._v("\n          "+e._s(e.value.videoId)+"\n        ")]):e._e()],1)],1)],1)],1)},sT=[],cT=["video","edu","pptv","live","topic","rotate"],uT={components:{InputPositiveInt:vs["a"],ResourceSelector:jl["a"],GlobalPictureSelector:ms["a"]},data:function(){return{isVisiablePosterSelector:!1,currentSelectPic:void 0,currentPicIndex:void 0,resourceOptions:cT,rules:{title:[{required:!0,message:"请输入主标题",trigger:"blur"}],required:[{required:!0}]}}},props:{value:{type:Object,default:function(){return{id:void 0,mediaResourceId:void 0,title:void 0,subTitle:void 0,priority:void 0,picInfoList:void 0,flagRec:void 0,coverType:"media",clickType:"detail",showSeries:1,showScore:1,videoId:void 0,picList:[]}}},index:Number,source:String,"input-tags":{type:Array,default:function(){return[]}},disabled:{type:Boolean,default:function(){return!1}}},watch:{value:{handler:function(e){this.$emit("input",e)},deep:!0,immediate:!0}},methods:{genPicInfoList:function(){return{pictureResolution:"",pictureUrl:"",pictureId:void 0,pictureStatus:void 0}},handleDelPoster:function(e){this.disabled||(this.value.picInfoList[e].pictureUrl=void 0)},computePicStyle:function(e,t){return{width:e/2+"px",height:t/2+"px"}},formatPicResolution:function(e,t){return e+"*"+t},handleSelectPostEnd:function(e,t){this.value.picInfoList[t].pictureUrl=e.pictureUrl},handlePicClick:function(e){this.disabled||(this.isVisiablePosterSelector=!0,this.currentPicIndex=e)},computeResolution:function(){var e=this.currentPicIndex,t=this.inputTags;return t[e].width+"*"+t[e].height}}},dT=uT,pT=(a("e64d"),Object(Yo["a"])(dT,lT,sT,!1,null,"49ff9589",null)),hT=pT.exports,mT=["mediaResourceId","title","showSeries","showScore","picInfoList"],fT=["name","source","status"],vT=[{label:"普通流",options:[{label:"普通",value:"normal"}]},{label:"基本流",options:[{label:"电影",value:"movie"},{label:"电视剧",value:"series"},{label:"少儿",value:"child"},{label:"春节电影",value:"T001"},{label:"春节电视剧",value:"T002"},{label:"春节教育",value:"T003"},{label:"春节游戏",value:"T004"}]}],gT={mixins:[ds["a"]],components:{InputPositiveInt:vs["a"],ResourceSelector:jl["a"],AssignVideoTab:hT,CommonContent:Ql["a"]},data:function(){return{resourceName:"指定影片推荐流",createForm:{name:"",source:"o_tencent",type:"normal"},mode:"create",basicForm:{id:void 0,name:void 0,source:"o_tencent",openStatus:void 0,currentVersion:void 0,flagAllVideoPoster:0,type:"normal"},isCollapseBase:!1,isCollapseVideo:!1,isVisibleSize:!1,videoTabs:[],newVideoTabNum:void 0,sizeTags:[],delSizeTagIndex:-1,newTabSize:{width:void 0,height:void 0},basicFormRules:{name:[{required:!0,message:"请输入名称",trigger:"blur"},{max:45,message:"推荐流名称不得超出45个字符",trigger:"blur"}]},videoListParams:mT,params:fT,streamTypeGroup:vT}},props:["id","initMode","version"],computed:{resourceInfo:function(){var e=this.basicForm;if(e.id)return{id:e.id,version:e.currentVersion,status:e.status,type:"mediaAutomation",menuElId:"mediaAutomation"}},isRead:function(){var e=this.mode;return"normal"!==this.basicForm.type||"read"===e},isReplica:function(){return"replicate"===this.mode||"yes"===this.basicForm.duplicateVersion},streamType:function(){var e={normal:"普通",child:"少儿",movie:"电影",series:"电视剧",T001:"春节电影",T002:"春节电视剧",T003:"春节教育",T004:"春节游戏"};return e[this.basicForm.type]}},methods:{getDefaultVideoTab:function(){return{id:void 0,clickTemplateType:void 0,coverType:"media",videoContentType:void 0,params:void 0,clickParams:void 0,clickType:"detail",mediaResourceId:void 0,title:"",subTitle:"",showSeries:1,showScore:1,videoId:void 0,priority:void 0,flagRec:0,picList:[],picInfoList:[]}},genPicInfo:function(){return{pictureResolution:"",pictureUrl:void 0,pictureId:void 0,pictureStatus:void 0}},judgeAvailableTag:function(){return!this.isRead&&0===this.videoTabs.length},handleCreate:function(){var e=this,t=this.createForm;this.$refs.createForm.validate(function(a){a?e.$service.saveMediaAutomation({jsonStr:JSON.stringify(t)},"保存成功").then(function(){e.$emit("upsert-end")}):e.$message.error("表单填写不完整")})},messageCancel:function(){this.$message({type:"info",message:"已取消切换源"})},handleSourceChange:function(e){var t=this,a=this.messageCancel;this.$confirm("修改源，会删除所有影片和素材，确定要修改","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$confirm("第二次警告，确定要修改","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$confirm("最后一个警告，删除后素材无法恢复！","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.basicForm.source=e,t.videoTabs=[],t.$message.success("成功切换内容源")}).catch(a)}).catch(a)}).catch(a)},handleAddVideoTab:function(e){var t=this.sizeTags.length;if(e)if(!this.newVideoTabNum||this.newVideoTabNum>100||this.newVideoTabNum<=0)this.$message.error("请输入0~100之间的数字");else{for(var a=0;a<e;a++){for(var n=this.getDefaultVideoTab(),i=0;i<t;i++)n.picInfoList.push(this.genPicInfo());this.videoTabs.push(n)}this.newVideoTabNum=void 0,this.$message.success("添加成功")}else{for(var r=this.getDefaultVideoTab(),o=0;o<t;o++)r.picInfoList.push(this.genPicInfo());this.videoTabs.push(r),this.$message.success("添加成功")}},handleAddTabSize:function(e,t,a){var n=this;if(t){var i=this.judgeIsRepeatSize({width:t,height:a});if(i)return void this.$message.error("尺寸不允许重复！");this.sizeTags.push({width:t,height:a,closable:!0})}else{var r=Object.assign({closable:!0},this.newTabSize);if(!r.width||!r.height)return void this.$message.error("宽或高不能为空");var o=this.judgeIsRepeatSize(r);if(o)return void this.$message.error("尺寸不允许重复！");this.sizeTags.push(r),this.newTabSize={}}this.videoTabs.forEach(function(e){e.picInfoList.push(n.genPicInfo())}),this.dealFillDefaultImg(),this.isVisibleSize=!1},judgeIsRepeatSize:function(e){return this.sizeTags.some(function(t){return t.width===e.width&&t.height===e.height})},handleTagClose:function(e){var t=this;this.$confirm("删除本尺寸后，本流中配置的本尺寸海报图也会删除，确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=t.sizeTags.indexOf(e);t.delSizeTagIndex=a,t.sizeTags.splice(a,1),t.videoTabs.forEach(function(e){e.picInfoList.splice(a,1)}),t.$message({type:"success",message:"删除成功!"})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleDelTab:function(e){var t=this,a=this.videoTabs;a.splice(e,1),this.videoTabs=[],this.$nextTick(function(){t.videoTabs=a.slice(),t.$message.success("删除成功")})},handleSelectResourcesEnd:function(e){var t=this;console.log("resources",e);var a=this.basicForm.source;["video","edu","pptv","live","topic","rotate"].forEach(function(n){var i=e[n];t.handleDiffResources(i,n,a,e)}),this.dealFillDefaultImg()},dealCommonParams:function(e){console.log("resources",e);var t=this.basicForm.source,a=["video","edu","pptv","live","topic","rotate"].filter(function(t){return 0!==e[t].length}).join(""),n=this.callbackParam(a,e[a][0],t),i=Object.assign({},n);i.vid=n.vid,i.sid=n.sid;var r=e[a][0].categoryId,o=a;switch(a){case"video":o="movie";break;case"live":o="txLive";break}var l=JSON.stringify(this.paramIdFun(i));return{tabName:a,anotherName:o,jsonParams:l,title:n.title,subTitle:n.subTitle,thirdIdOrPackageName:n.thirdIdOrPackageName,categoryId:r}},handleSelectClickedSource:function(e,t){var a=this.dealCommonParams(e),n=a.tabName,i=a.anotherName,r=a.jsonParams,o=a.title,l=a.subTitle,s=a.thirdIdOrPackageName,c=a.categoryId;Object.assign(this.videoTabs[t],{clickParams:r,clickTemplateType:i,videoContentType_click:i,title:o,subTitle:l,mediaResourceId:s,coverType:"media",categoryId:c});var u=this.videoTabs;if(u[t].imageInfoList=e[n][0].imageInfoList,this.dealFillDefaultImg(t),"video"===n){var d=e[n][0].ccVideoSourceEntities[0],p=d.score,h=d.updatedSegment,m=d.publishSegment,f=0==m,v=f?"unknown":h===m?"ended":"updating";Object.assign(this.videoTabs[t],{publishStatus:v,score:p,series:f?null:h,variety:d.lastCollection})}u[t].picList=[]},dealFillDefaultImg:function(e){var t=this,a=this.sizeTags,n=this.videoTabs;0!==a.length&&a.forEach(function(a,i){var r=a.width+"*"+a.height;"260*364"!==r&&"498*280"!==r||n.forEach(function(a,n){if(!a.picInfoList[i].pictureUrl)if("movie"===a.clickTemplateType){var o={resType:"vod",callbackparam:"result",sources:t.basicForm.source,id:a.mediaResourceId};t.$service.getMediaVideoInfos(o).then(function(e){a.imageInfoList=e.rows[0]?e.rows[0].imageInfoList:void 0;var t=(a.imageInfoList||[]).find(function(e){return e.size===r});a.picInfoList[i].pictureUrl=t?t.url:void 0})}else if("edu"===a.clickTemplateType){var l={resType:"vod",callbackparam:"result",businessType:1,id:a.mediaResourceId};t.$service.getMediaVideoInfos(l).then(function(e){a.imageInfoList=e.rows[0]?e.rows[0].imageInfoList:void 0})}else{var s=(a.imageInfoList||[]).find(function(e){return e.size===r});a.picInfoList[i].pictureUrl=s?s.url:void 0}if(e===n){var c=(a.imageInfoList||[]).find(function(e){return e.size===r});a.picInfoList[i].pictureUrl=c?c.url:void 0}})})},handleSelectNormalSource:function(e,t){var a=this.dealCommonParams(e),n=a.anotherName,i=a.jsonParams,r=a.thirdIdOrPackageName;Object.assign(this.videoTabs[t],{params:i,videoContentType:n,videoId:r})},handleDelNormalSource:function(e){this.isRead||(this.videoTabs[e].videoId=void 0,this.videoTabs[e].params=void 0)},handleDiffResources:function(e,t,a,n){var i=this,r=t;switch(t){case"video":r="movie";break;case"live":r="txLive";break}var o=this.videoTabs;e.map(function(e,l){var s=e.categoryId,c=i.callbackParam(t,e,a),u=Object.assign({},c);u.vid=e.vid,u.sid=e.sid;var d=JSON.stringify(i.paramIdFun(u));if("video"===t){var p=n["video"][l].ccVideoSourceEntities[0],h=p.score,m=p.updatedSegment,f=p.publishSegment,v=0==f,g=v?"unknown":m===f?"ended":"updating";c.publishStatus=g,c.score=h,c.series=v?null:m,c.variety=p.lastCollection}var b=i.getDefaultVideoTab();Object.assign(b,{title:c.title,subTitle:c.subTitle,mediaResourceId:c.thirdIdOrPackageName,clickParams:d,coverType:"media",clickTemplateType:r,videoContentType_click:r,clickType:"detail",publishStatus:c.publishStatus,score:c.score,series:c.series,variety:c.variety,categoryId:s});for(var y=0;y<i.sizeTags.length;y++)b.picInfoList.push(i.genPicInfo());b.imageInfoList=e.imageInfoList,o.push(b)})},handleBlurSort:function(e){var t=this,a=this.videoTabs;this.videoTabs=[],this.$nextTick(function(){t.videoTabs=a.sort(function(e,t){return t["priority"]-e["priority"]})})},handleSubmit:function(e){var t=!0;if(this.$refs.basicForm.validate(function(e){e||(t=!1)}),t){var a=this.basicForm,n=this.videoTabs,i=n.filter(function(e){return"undefined"!==typeof e.mediaResourceId}),r=i.every(function(e){return e.videoId});r&&(a.flagAllVideoPoster=1);for(var o=[],l=0;l<n.length-1;l++)for(var s=l+1;s<n.length-l;s++)if(n[l].mediaResourceId===n[s].mediaResourceId){o[0]=l+1,o[1]=s+1;break}if(0===o.length){var c=Object(Q["a"])({},a,{status:e});this.checkParams(c,i,function(){var e=this,t=Object.assign({},c);t.videoList=0===i.length?void 0:Object(Go["cloneDeep"])(i),"replicate"===this.mode&&(t.currentVersion=void 0),t.videoList&&0!==t.videoList.length&&t.videoList.map(function(e){e.picList=e.picInfoList.map(function(e){return e.pictureUrl}),e.picInfoList=void 0,e.imageInfoList=void 0,e.params||(e.params=e.clickParams),e.videoContentType||(e.videoContentType=e.videoContentType_click),e.videoContentType_click=void 0}),console.log("save",t),this.$service.saveMediaAutomation({jsonStr:JSON.stringify(t)},"保存成功").then(function(){e.$emit("upsert-end")})}.bind(this))}else{var u="影片 "+o[0]+" 和影片 "+o[1]+" 资源重复";this.$alert(u,"提示",{confirmButtonText:"确定"})}}},handleSubmitAudit:function(){this.handleSubmit(3)},handleSaveDraft:function(){this.handleSubmit(2)},checkParams:function(e,t,a){var n=this,i=this.sizeTags;if(this.checkBasicParam(e))if(0===t.length){if(0!==i.length)return this.$message.error("若未配置影片，请删除尺寸"),!1;a()}else{var r=i.map(function(e){return e.width+"*"+e.height});e.picSize=r;var o=!0;t.some(function(e,t){if(!n.checkVideoList(e)){var a="影片 "+(t+1)+"  配置不完整，无法保存";return n.$alert(a,{confirmButtonText:"确定"}),o=!1,!0}}),o&&a()}else this.$message.error("流基本设置，信息不完整")},checkVideoList:function(e){var t=this.videoListParams,a=!0;return t.forEach(function(t){"picInfoList"===t?a=!e.picInfoList.some(function(e){return void 0===e.pictureUrl||""===e.pictureUrl}):e[t]||(a=!1)}),a?(0===e.picInfoList.length&&(a=!1),a):a},checkBasicParam:function(e){var t=this.params,a=!0;return t.forEach(function(t){e[t]||(a=!1)}),a},handleCopy:function(e){var t=this.$consts.status;e===t.waiting?this.handleSubmitAudit():this.handleSaveDraft()},callbackParam:function(e,t,a){var n={type:"",contentType:"",thirdIdOrPackageName:""},i={tencent:"_otx_",o_tencent:"_otx_",yinhe:"_oqy_",o_iqiyi:"_oqy_",youku:"_oyk_"};switch(e){case"video":var r=t.selectedEpisodes,o=i[a]||"";r?(6===r.urlIsTrailer&&r.thirdVId?(n.thirdIdOrPackageName=o+r.thirdVId,n.sid=r.coocaaMId):(n.thirdIdOrPackageName=o+t.coocaaVId,n.vid=r.coocaaMId),n.thumb=r.thumb,n.title=r.urlTitle,n.subTitle=r.urlSubTitle):(n.thirdIdOrPackageName=o+t.coocaaVId,n.pictureUrl=t.thumb,n.title=t.title,n.subTitle=t.subTitle),n.contentType="movie",n.type="res";break;case"app":n.contentType="app",n.coverType="app",n.thirdIdOrPackageName=t.appPackageName,n.pictureUrl=t.appImageUrl,n.title=t.appName,n.type="app";break;case"edu":n.contentType="edu",n.thirdIdOrPackageName="_otx_"+t.coocaaVId,n.platformId=t.source,n.pictureUrl=t.thumb,n.title=t.title,n.subTitle=t.subTitle,n.type="res";break;case"pptv":n.contentType="pptv",n.thirdIdOrPackageName="pptv_tvsports://tvsports_detail?section_id="+t.pid+"&from_internal=1",n.title=t.pTitle,n.type="";break;case"live":n.contentType="txLive",n.thirdIdOrPackageName="_otx_"+t.vId,n.platformId=t.source,n.pictureUrl=t.thumb,n.title=t.title,n.subTitle=t.subTitle,n.type="live";break;case"topic":"parentTopic"===t.dataSign?n.contentType="bigTopic":n.contentType="topic",n.thirdIdOrPackageName=t.id+"",n.pictureUrl=t.picture,n.title=t.title,n.subTitle=t.subTitle,n.type="topic";break;case"rotate":n.contentType="rotate",n.thirdIdOrPackageName=t.id+"",n.pictureUrl=t.picture,n.title=t.title,n.subTitle=t.subTitle,n.type="rotate";break;default:break}return n},paramIdFun:function(e){var t;return"movie"===e.contentType?(t={id:e.thirdIdOrPackageName},e.vid&&(t.vid=e.vid),e.sid&&(t.sid=e.sid)):"app"===e.contentType||"edu"===e.contentType||"txLive"===e.contentType?t={id:e.thirdIdOrPackageName}:"bigTopic"===e.contentType?t={pTopicCode:e.thirdIdOrPackageName}:"topic"===e.contentType?t={topicCode:e.thirdIdOrPackageName}:"rotate"===e.contentType&&(t={rotateId:e.thirdIdOrPackageName}),t},fetchData:function(e){var t=this;this.$service.getMediaAutomationDetial({id:this.id,version:e}).then(function(e){t.setBasicInfo(e)})},setBasicInfo:function(e){var t=this,a=this.basicForm;a.id=e.id,a.name=e.name,a.openStatus=e.openStatus,a.type=e.type||"normal",a.currentVersion=e.currentVersion,a.duplicateVersion=e.duplicateVersion,a.status=e.status,a.source=e.source,this.videoTabs=[],this.videoTabs=(e.videoList||[]).map(function(e){return e.picList=e.picList||[],e}).sort(function(e,t){return t.priority-e.priority}),this.sizeTags=[],0!==e.picSize.length&&e.picSize.map(function(a){var n=e.picInfoList.find(function(e){return a===e.picSize});t.sizeTags.push({width:a.split("*")[0],height:a.split("*")[1],closable:n.canDelete})}),console.log("dataDetail",e)}},created:function(){var e=this;this.mode=this.initMode||"create",this.id&&this.$service.getMediaAutomationDetial({id:this.id,version:this.version}).then(function(t){e.setBasicInfo(t)})}},bT=gT,yT=(a("4240"),Object(Yo["a"])(bT,rT,oT,!1,null,"76b11844",null)),wT=yT.exports,IT={components:{TabPage:Il["a"],AssignVideoRecomInfo:wT,AssignVideoRecomList:iT},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0,status:void 0}},methods:{handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e.id,this.version=e.currentVersion,this.mode="edit",this.isShowList=!1},handleRead:function(e,t){this.id=e.id,this.mode="read",this.version=t||e.currentVersion,this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.deleteMediaAutomation({id:e.map(function(e){return e.id}).join(",")},"删除成功").then(function(e){t.$refs.list.fetchData()})},handleCopy:function(e){this.id=e.id,this.mode="copy",this.isShowList=!1},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},CT=IT,TT=Object(Yo["a"])(CT,YC,QC,!1,null,"f8886c00",null),ST=TT.exports,kT=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("TabPage",[a("NewVideoRecomList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,read:e.handleRead,edit:e.handleEdit,delete:e.handleDelete}}),e.isShowList?e._e():a("NewVideoRecomInfo",{attrs:{id:e.id,version:e.version,"init-mode":e.mode,status:e.status},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},_T=[],PT=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{ref:"contentCard",staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,pagination:e.pagination},on:{"filter-change":e.fetchData}},[a("el-form",{directives:[{name:"form-autocomplete",rawName:"v-form-autocomplete"}],ref:"form",staticClass:"form",attrs:{inline:!0},nativeOn:{submit:function(t){return t.preventDefault(),e.handleFilterChange(t)},reset:function(t){return t.preventDefault(),e.handleFilterReset(t)}},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("el-form-item",[a("el-input",{attrs:{type:"number",clearable:"",placeholder:"推荐流ID",title:"id"},model:{value:e.filter.id,callback:function(t){e.$set(e.filter,"id",t)},expression:"filter.id"}})],1),a("el-form-item",[a("el-input",{attrs:{clearable:"",placeholder:"推荐流名称"},model:{value:e.filter.recName,callback:function(t){e.$set(e.filter,"recName",t)},expression:"filter.recName"}})],1),a("el-form-item",[a("el-select",{attrs:{placeholder:"内容源",clearable:""},model:{value:e.filter.source,callback:function(t){e.$set(e.filter,"source",t)},expression:"filter.source"}},e._l(e.sourceOption,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",[a("el-select",{staticStyle:{"margin-left":"20px",width:"200px"},attrs:{multiple:"",placeholder:"适用场景",clearable:""},model:{value:e.defalutScene,callback:function(t){e.defalutScene=t},expression:"defalutScene"}},e._l(e.sceneOption,function(e){return a("el-option",{key:e.dictEnName,attrs:{label:e.dictCnName,value:e.dictEnName}})}),1)],1),a("el-form-item",{staticClass:"el-form-item-submit"},[a("el-button",{attrs:{type:"primary","native-type":"submit"}},[e._v("查询")]),a("el-button",{attrs:{"native-type":"reset"}},[e._v("重置")])],1)],1),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data}})],1)],1)},xT=[],FT={extends:Sl["a"],components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"]},data:function(){var e=this;return{notContainBtns:["audit","batchAudit"],resourceType:"broadcastBlock",filter:this.genDefaultFilter(),filterSchema:null,sourceOption:this.$consts.sourceOptionsWithEmpty,sceneOption:[],pagination:{currentPage:1,pageSize:10},selected:[],table:{props:{},header:[{label:"推荐流ID",prop:"id",width:"120px",fixed:"left"},{label:"推荐流名称",prop:"recName",fixed:"left",width:"180px",render:function(t,a){var n=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(n)}}},n.recName)}},{label:"内容源",prop:"source",render:function(t,a){var n=a.row;return e.$consts.sourceTextWithNone[n.source]}},{label:"适用场景",prop:"scene",width:"200px",render:function(t,a){var n=a.row,i=e.handleScene(n);return t("div",{},i)}},{label:"推荐流业务来源",prop:"platformName"},{label:"操作",fixed:"right",render:function(e,t){t.row;return e("div")}}],data:[],selected:[],selectionType:"multiple"},defalutScene:[],sceneNames:[]}},methods:{genDefaultFilter:function(){return{page:1,rows:10,scene:"",defalutScene:[]}},handleFilterReset:function(){this.defalutScene=[],this.filter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},handleFilterChange:function(){this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize,e.scene=this.defalutScene.join(",")),e},fetchData:function(){var e=this,t=this.parseFilter();this.$service.getNewMediaAutomationList(t).then(function(t){e.pagination.total=t.total,t.rows=t.rows.map(function(e){return e}),e.table.data=t.rows})},keyAndValueExchage:function(e){return Object.keys(e).reduce(function(t,a){return t[e[a]]=a,t},{})},fetchMediaSence:function(){var e=this;this.$service.getMediaSence().then(function(t){e.sceneOption=t})},handleScene:function(e){var t=this,a=[];return e.scene.split(",").map(function(e){t.sceneOption.map(function(t){e===t.dictEnName&&a.push(t.dictCnName)})}),a.join(",")}},mounted:function(){this.fetchMediaSence(),this.fetchData()}},DT=FT,RT=(a("ce3d"),Object(Yo["a"])(DT,PT,xT,!1,null,"0b322848",null)),LT=RT.exports,$T=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[[a("div",{staticClass:"form-legend-header",on:{click:function(t){e.isCollapseBase=!e.isCollapseBase}}},[e.isCollapseBase?a("i",{staticClass:"el-icon-arrow-down"}):a("i",{staticClass:"el-icon-arrow-up"}),a("span",[e._v(" 流基本设置")])]),a("div",{style:{display:e.isCollapseBase?"none":"block"}},[a("el-form",{ref:"basicForm",attrs:{model:e.basicForm,"label-width":"150px",rules:e.basicFormRules}},[a("el-form-item",{attrs:{label:"推荐流ID"}},[e._v(e._s(e.basicForm.id))]),a("el-form-item",{attrs:{label:"推荐流名称",prop:"recName"}},[a("el-input",{staticClass:"title-input",attrs:{disabled:e.isRead},model:{value:e.basicForm.recName,callback:function(t){e.$set(e.basicForm,"recName",t)},expression:"basicForm.recName"}})],1),a("el-form-item",{attrs:{label:"内容源",required:""}},[e._v("\n          "+e._s(e.$consts.sourceTextWithNone[e.basicForm.source])+"\n        ")]),a("el-form-item",{attrs:{label:"用户唯一标识",required:""}},[e._v("\n          mac\n        ")]),a("el-form-item",{attrs:{label:"业务来源",prop:"platformName"}},[a("el-input",{staticClass:"title-input",attrs:{disabled:e.isRead},model:{value:e.basicForm.platformName,callback:function(t){e.$set(e.basicForm,"platformName",t)},expression:"basicForm.platformName"}})],1),a("el-form-item",{attrs:{label:"运营后台请求间隔",required:""}},[e._v("\n          "+e._s(e.basicForm.requestInterval)+"\n          "),a("i",{staticClass:"nuit"},[e._v("单位：秒")])]),a("el-form-item",{attrs:{label:"适用场景",required:""}},[e._v("\n          "+e._s(e.handleScene(e.basicForm.scene))+"\n        ")])],1)],1),a("div",{staticClass:"form-legend-header",on:{click:function(t){e.isCollapseVideo=!e.isCollapseVideo}}},[e.isCollapseVideo?a("i",{staticClass:"el-icon-arrow-down"}):a("i",{staticClass:"el-icon-arrow-up"}),a("span",[e._v(" 影片选择")])]),a("div",{style:{display:e.isCollapseVideo?"none":"block"}},[a("div",{staticClass:"video-select--header"},[a("InputPositiveInt",{staticClass:"num-input",attrs:{disabled:e.isRead},model:{value:e.newVideoTabNum,callback:function(t){e.newVideoTabNum=t},expression:"newVideoTabNum"}}),a("el-button",{attrs:{type:"primary",disabled:e.isRead},on:{click:function(t){return e.handleAddVideoTab(e.newVideoTabNum)}}},[e._v("添加")]),a("ResourceSelector",{ref:"resourceSelector",attrs:{"is-live":!1,selectors:["video","edu","pptv","live","topic","rotate"],"selection-type":"multiple",source:e.basicForm.source,"disable-partner":!0,disabled:e.isRead},on:{"select-end":e.handleSelectResourcesEnd}},[a("el-button",{staticClass:"batch-btn",attrs:{type:"primary",disabled:e.isRead,title:"若260*364或498*280的尺寸存在，选择资源后自动填充默认图"}},[e._v("批量选择资源")])],1),a("el-button",{attrs:{type:"primary",title:"若260*364或498*280的尺寸存在，选择资源后自动填充默认图",disabled:e.isRead},on:{click:function(t){e.isVisibleSize=!e.isVisibleSize}}},[e._v("添加尺寸")]),a("el-button",{attrs:{type:"text",disabled:e.isRead},on:{click:function(t){return e.handleAddTabSize(t,260,364)}}},[e._v("添加260*364")]),a("el-button",{attrs:{type:"text",disabled:e.isRead},on:{click:function(t){return e.handleAddTabSize(t,498,280)}}},[e._v("添加498*280")]),e._l(e.sizeTags,function(t,n){return a("el-tag",{key:n,staticClass:"size-tag",attrs:{type:"primary",closable:!e.isRead&&t.closable},on:{close:function(a){return e.handleTagClose(t)}}},[e._v("\n            "+e._s(t.width)+" x "+e._s(t.height)+"\n        ")])})],2),e._l(e.videoTabs,function(t,n){return a("div",{key:n,staticClass:"videoTab--wrapper"},[a("AssignVideoTab",{attrs:{index:n,source:e.basicForm.source,"input-tags":e.sizeTags,disabled:e.isRead},on:{"handle-delTab":e.handleDelTab,"select-clicked-source":function(t){return e.handleSelectClickedSource(t,n)},"select-normal-source":function(t){return e.handleSelectNormalSource(t,n)},blur:function(t){return e.handleBlurSort(n)},"del-normal-source":function(t){return e.handleDelNormalSource(n)}},model:{value:e.videoTabs[n],callback:function(t){e.$set(e.videoTabs,n,t)},expression:"videoTabs[index]"}})],1)})],2)],a("el-dialog",{attrs:{title:"添加尺寸",visible:e.isVisibleSize,width:"30%"},on:{"update:visible":function(t){e.isVisibleSize=t}}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{staticClass:"text-center-align",attrs:{span:12}},[e._v("宽")]),a("el-col",{staticClass:"text-center-align",attrs:{span:12}},[e._v("高")])],1),a("el-row",[a("el-col",{attrs:{span:10}},[a("InputPositiveInt",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleAddTabSize(t)}},model:{value:e.newTabSize.width,callback:function(t){e.$set(e.newTabSize,"width",t)},expression:"newTabSize.width"}})],1),a("el-col",{staticClass:"text-center-align",attrs:{span:4}},[e._v("X")]),a("el-col",{attrs:{span:10}},[a("InputPositiveInt",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleAddTabSize(t)}},model:{value:e.newTabSize.height,callback:function(t){e.$set(e.newTabSize,"height",t)},expression:"newTabSize.height"}})],1)],1),a("div",{staticClass:"size-btn-group"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleAddTabSize}},[e._v("确定")]),a("el-button",{attrs:{type:"success"},on:{click:function(t){e.newTabSize={},e.isVisibleSize=!e.isVisibleSize}}},[e._v("取消")])],1)],1)],2)},NT=[],ET=["mediaResourceId","title","showSeries","showScore","picInfoList"],OT=["name","source","platformName","status"],AT=[{label:"普通流",options:[{label:"普通",value:"normal"}]},{label:"基本流",options:[{label:"电影",value:"movie"},{label:"电视剧",value:"series"},{label:"少儿",value:"child"},{label:"春节电影",value:"T001"},{label:"春节电视剧",value:"T002"},{label:"春节教育",value:"T003"},{label:"春节游戏",value:"T004"}]}],VT={mixins:[ds["a"]],components:{InputPositiveInt:vs["a"],ResourceSelector:jl["a"],AssignVideoTab:hT},data:function(e){return{resourceName:"指定影片推荐流",createForm:{name:"",source:"o_tencent",type:"normal"},mode:"create",basicForm:{id:void 0,name:void 0,source:"o_tencent",openStatus:void 0,currentVersion:void 0,flagAllVideoPoster:0,type:"normal",requestInterval:""},isCollapseBase:!1,isCollapseVideo:!1,isVisibleSize:!1,videoTabs:[],newVideoTabNum:void 0,sizeTags:[],delSizeTagIndex:-1,newTabSize:{width:void 0,height:void 0},basicFormRules:{recName:[{required:!0,message:"请输入名称",trigger:"blur"},{max:45,message:"推荐流名称不得超出45个字符",trigger:"blur"}],platformName:[{required:!0,message:"请输入业务来源",trigger:"blur"}]},videoListParams:ET,params:OT,streamTypeGroup:AT,sceneNames:[],resSceneOption:[]}},props:["id","initMode","version"],computed:{resourceInfo:function(){var e=this.basicForm;if(e.id)return{id:e.id,version:e.currentVersion,status:e.status,type:"mediaAutomation",menuElId:"mediaAutomation"}},isRead:function(){var e=this.mode;return"normal"!==this.basicForm.type||"read"===e},isReplica:function(){return"replicate"===this.mode||"yes"===this.basicForm.duplicateVersion},streamType:function(){var e={normal:"普通",child:"少儿",movie:"电影",series:"电视剧",T001:"春节电影",T002:"春节电视剧",T003:"春节教育",T004:"春节游戏"};return e[this.basicForm.type]}},methods:{fetchMediaSence:function(){var e=this;this.$service.getMediaSence().then(function(t){e.resSceneOption=t})},handleScene:function(e){var t=this;if(e){var a=[];return e.split(",").map(function(e){t.resSceneOption.map(function(t){e===t.dictEnName&&a.push(t.dictCnName)})}),a.join(",")}},getDefaultVideoTab:function(){return{id:void 0,clickTemplateType:void 0,coverType:"media",videoContentType:void 0,params:void 0,clickParams:void 0,clickType:"detail",mediaResourceId:void 0,title:"",subTitle:"",showSeries:1,showScore:1,videoId:void 0,priority:void 0,flagRec:0,picList:[],picInfoList:[]}},genPicInfo:function(){return{pictureResolution:"",pictureUrl:void 0,pictureId:void 0,pictureStatus:void 0}},judgeAvailableTag:function(){return!this.isRead&&0===this.videoTabs.length},handleCreate:function(){var e=this,t=this.createForm;this.$refs.createForm.validate(function(a){a?e.$service.saveMediaAutomation({jsonStr:JSON.stringify(t)},"保存成功").then(function(){e.$emit("upsert-end")}):e.$message.error("表单填写不完整")})},messageCancel:function(){this.$message({type:"info",message:"已取消切换源"})},handleSourceChange:function(e){var t=this,a=this.messageCancel;this.$confirm("修改源，会删除所有影片和素材，确定要修改","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$confirm("第二次警告，确定要修改","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$confirm("最后一个警告，删除后素材无法恢复！","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.basicForm.source=e,t.videoTabs=[],t.$message.success("成功切换内容源")}).catch(a)}).catch(a)}).catch(a)},handleAddVideoTab:function(e){var t=this.sizeTags.length;if(e)if(!this.newVideoTabNum||this.newVideoTabNum>100||this.newVideoTabNum<=0)this.$message.error("请输入0~100之间的数字");else{for(var a=0;a<e;a++){for(var n=this.getDefaultVideoTab(),i=0;i<t;i++)n.picInfoList.push(this.genPicInfo());this.videoTabs.push(n)}this.newVideoTabNum=void 0,this.$message.success("添加成功")}else{for(var r=this.getDefaultVideoTab(),o=0;o<t;o++)r.picInfoList.push(this.genPicInfo());this.videoTabs.push(r),this.$message.success("添加成功")}},handleAddTabSize:function(e,t,a){var n=this;if(t){var i=this.judgeIsRepeatSize({width:t,height:a});if(i)return void this.$message.error("尺寸不允许重复！");this.sizeTags.push({width:t,height:a,closable:!0})}else{var r=Object.assign({closable:!0},this.newTabSize);if(!r.width||!r.height)return void this.$message.error("宽或高不能为空");var o=this.judgeIsRepeatSize(r);if(o)return void this.$message.error("尺寸不允许重复！");this.sizeTags.push(r),this.newTabSize={}}this.videoTabs.forEach(function(e){e.picInfoList.push(n.genPicInfo())}),this.dealFillDefaultImg(),this.isVisibleSize=!1},judgeIsRepeatSize:function(e){return this.sizeTags.some(function(t){return t.width===e.width&&t.height===e.height})},handleTagClose:function(e){var t=this;this.$confirm("删除本尺寸后，本流中配置的本尺寸海报图也会删除，确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=t.sizeTags.indexOf(e);t.delSizeTagIndex=a,t.sizeTags.splice(a,1),t.videoTabs.forEach(function(e){e.picInfoList.splice(a,1)}),t.$message({type:"success",message:"删除成功!"})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleDelTab:function(e){var t=this,a=this.videoTabs;a.splice(e,1),this.videoTabs=[],this.$nextTick(function(){t.videoTabs=a.slice(),t.$message.success("删除成功")})},handleSelectResourcesEnd:function(e){var t=this;console.log("resources",e);var a=this.basicForm.source;["video","edu","pptv","live","topic","rotate"].forEach(function(n){var i=e[n];t.handleDiffResources(i,n,a,e)}),this.dealFillDefaultImg()},dealCommonParams:function(e){console.log("resources",e);var t=this.basicForm.source,a=["video","edu","pptv","live","topic","rotate"].filter(function(t){return 0!==e[t].length}).join(""),n=this.callbackParam(a,e[a][0],t),i=Object.assign({},n);i.vid=n.vid,i.sid=n.sid;var r=e[a][0].categoryId,o=a;switch(a){case"video":o="movie";break;case"live":o="txLive";break}var l=JSON.stringify(this.paramIdFun(i));return{tabName:a,anotherName:o,jsonParams:l,title:n.title,subTitle:n.subTitle,thirdIdOrPackageName:n.thirdIdOrPackageName,categoryId:r}},handleSelectClickedSource:function(e,t){var a=this.dealCommonParams(e),n=a.tabName,i=a.anotherName,r=a.jsonParams,o=a.title,l=a.subTitle,s=a.thirdIdOrPackageName,c=a.categoryId;Object.assign(this.videoTabs[t],{clickParams:r,clickTemplateType:i,videoContentType_click:i,title:o,subTitle:l,mediaResourceId:s,coverType:"media",categoryId:c});var u=this.videoTabs;if(u[t].imageInfoList=e[n][0].imageInfoList,this.dealFillDefaultImg(t),"video"===n){var d=e[n][0].ccVideoSourceEntities[0],p=d.score,h=d.updatedSegment,m=d.publishSegment,f=0==m,v=f?"unknown":h===m?"ended":"updating";Object.assign(this.videoTabs[t],{publishStatus:v,score:p,series:f?null:h,variety:d.lastCollection})}u[t].picList=[]},dealFillDefaultImg:function(e){var t=this,a=this.sizeTags,n=this.videoTabs;0!==a.length&&a.forEach(function(a,i){var r=a.width+"*"+a.height;"260*364"!==r&&"498*280"!==r||n.forEach(function(a,n){if(!a.picInfoList[i].pictureUrl)if("movie"===a.clickTemplateType){var o={resType:"vod",callbackparam:"result",sources:t.basicForm.source,id:a.mediaResourceId};t.$service.getMediaVideoInfos(o).then(function(e){a.imageInfoList=e.rows[0]?e.rows[0].imageInfoList:void 0;var t=(a.imageInfoList||[]).find(function(e){return e.size===r});a.picInfoList[i].pictureUrl=t?t.url:void 0})}else if("edu"===a.clickTemplateType){var l={resType:"vod",callbackparam:"result",businessType:1,id:a.mediaResourceId};t.$service.getMediaVideoInfos(l).then(function(e){a.imageInfoList=e.rows[0]?e.rows[0].imageInfoList:void 0})}else{var s=(a.imageInfoList||[]).find(function(e){return e.size===r});a.picInfoList[i].pictureUrl=s?s.url:void 0}if(e===n){var c=(a.imageInfoList||[]).find(function(e){return e.size===r});a.picInfoList[i].pictureUrl=c?c.url:void 0}})})},handleSelectNormalSource:function(e,t){var a=this.dealCommonParams(e),n=a.anotherName,i=a.jsonParams,r=a.thirdIdOrPackageName;Object.assign(this.videoTabs[t],{params:i,videoContentType:n,videoId:r})},handleDelNormalSource:function(e){this.isRead||(this.videoTabs[e].videoId=void 0,this.videoTabs[e].params=void 0)},handleDiffResources:function(e,t,a,n){var i=this,r=t;switch(t){case"video":r="movie";break;case"live":r="txLive";break}var o=this.videoTabs;e.map(function(e,l){var s=e.categoryId,c=i.callbackParam(t,e,a),u=Object.assign({},c);u.vid=e.vid,u.sid=e.sid;var d=JSON.stringify(i.paramIdFun(u));if("video"===t){var p=n["video"][l].ccVideoSourceEntities[0],h=p.score,m=p.updatedSegment,f=p.publishSegment,v=0==f,g=v?"unknown":m===f?"ended":"updating";c.publishStatus=g,c.score=h,c.series=v?null:m,c.variety=p.lastCollection}var b=i.getDefaultVideoTab();Object.assign(b,{title:c.title,subTitle:c.subTitle,mediaResourceId:c.thirdIdOrPackageName,clickParams:d,coverType:"media",clickTemplateType:r,videoContentType_click:r,clickType:"detail",publishStatus:c.publishStatus,score:c.score,series:c.series,variety:c.variety,categoryId:s});for(var y=0;y<i.sizeTags.length;y++)b.picInfoList.push(i.genPicInfo());b.imageInfoList=e.imageInfoList,o.push(b)})},handleBlurSort:function(e){var t=this,a=this.videoTabs;this.videoTabs=[],this.$nextTick(function(){t.videoTabs=a.sort(function(e,t){return t["priority"]-e["priority"]})})},handleSubmit:function(e){var t=!0;if(this.$refs.basicForm.validate(function(e){e||(t=!1)}),t){var a=this.basicForm,n=this.videoTabs,i=n.filter(function(e){return"undefined"!==typeof e.mediaResourceId}),r=i.every(function(e){return e.videoId});r&&(a.flagAllVideoPoster=1);for(var o=[],l=0;l<n.length-1;l++)for(var s=l+1;s<n.length-l;s++)if(n[l].mediaResourceId===n[s].mediaResourceId){o[0]=l+1,o[1]=s+1;break}if(0===o.length){var c=Object(Q["a"])({},a,{status:e});this.checkParams(c,i,function(){var e=this,t=Object.assign({},c);t.videoList=0===i.length?void 0:Object(Go["cloneDeep"])(i),"replicate"===this.mode&&(t.currentVersion=void 0),t.videoList&&0!==t.videoList.length&&t.videoList.map(function(e){e.picList=e.picInfoList.map(function(e){return e.pictureUrl}),e.picInfoList=void 0,e.imageInfoList=void 0,e.params||(e.params=e.clickParams),e.videoContentType||(e.videoContentType=e.videoContentType_click),e.videoContentType_click=void 0}),console.log("save",t),this.$service.saveMediaAutomation({jsonStr:JSON.stringify(t)},"保存成功").then(function(){e.$emit("upsert-end")})}.bind(this))}else{var u="影片 "+o[0]+" 和影片 "+o[1]+" 资源重复";this.$alert(u,"提示",{confirmButtonText:"确定"})}}},handleSubmitAudit:function(){this.handleSubmit(3)},handleSaveDraft:function(){this.handleSubmit(2)},checkParams:function(e,t,a){var n=this,i=this.sizeTags;if(this.checkBasicParam(e))if(0===t.length){if(0!==i.length)return this.$message.error("若未配置影片，请删除尺寸"),!1;a()}else{var r=i.map(function(e){return e.width+"*"+e.height});e.picSize=r;var o=!0;t.some(function(e,t){if(!n.checkVideoList(e)){var a="影片 "+(t+1)+"  配置不完整，无法保存";return n.$alert(a,{confirmButtonText:"确定"}),o=!1,!0}}),o&&a()}else this.$message.error("流基本设置，信息不完整")},checkVideoList:function(e){var t=this.videoListParams,a=!0;return t.forEach(function(t){"picInfoList"===t?a=!e.picInfoList.some(function(e){return void 0===e.pictureUrl||""===e.pictureUrl}):e[t]||(a=!1)}),a?(0===e.picInfoList.length&&(a=!1),a):a},checkBasicParam:function(e){var t=this.params,a=!0;return t.forEach(function(t){e[t]||(a=!1)}),a},handleCopy:function(e){var t=this.$consts.status;e===t.waiting?this.handleSubmitAudit():this.handleSaveDraft()},callbackParam:function(e,t,a){var n={type:"",contentType:"",thirdIdOrPackageName:""},i={tencent:"_otx_",o_tencent:"_otx_",yinhe:"_oqy_",o_iqiyi:"_oqy_",youku:"_oyk_"};switch(e){case"video":var r=t.selectedEpisodes,o=i[a]||"";r?(6===r.urlIsTrailer&&r.thirdVId?(n.thirdIdOrPackageName=o+r.thirdVId,n.sid=r.coocaaMId):(n.thirdIdOrPackageName=o+t.coocaaVId,n.vid=r.coocaaMId),n.thumb=r.thumb,n.title=r.urlTitle,n.subTitle=r.urlSubTitle):(n.thirdIdOrPackageName=o+t.coocaaVId,n.pictureUrl=t.thumb,n.title=t.title,n.subTitle=t.subTitle),n.contentType="movie",n.type="res";break;case"app":n.contentType="app",n.coverType="app",n.thirdIdOrPackageName=t.appPackageName,n.pictureUrl=t.appImageUrl,n.title=t.appName,n.type="app";break;case"edu":n.contentType="edu",n.thirdIdOrPackageName="_otx_"+t.coocaaVId,n.platformId=t.source,n.pictureUrl=t.thumb,n.title=t.title,n.subTitle=t.subTitle,n.type="res";break;case"pptv":n.contentType="pptv",n.thirdIdOrPackageName="pptv_tvsports://tvsports_detail?section_id="+t.pid+"&from_internal=1",n.title=t.pTitle,n.type="";break;case"live":n.contentType="txLive",n.thirdIdOrPackageName="_otx_"+t.vId,n.platformId=t.source,n.pictureUrl=t.thumb,n.title=t.title,n.subTitle=t.subTitle,n.type="live";break;case"topic":"parentTopic"===t.dataSign?n.contentType="bigTopic":n.contentType="topic",n.thirdIdOrPackageName=t.id+"",n.pictureUrl=t.picture,n.title=t.title,n.subTitle=t.subTitle,n.type="topic";break;case"rotate":n.contentType="rotate",n.thirdIdOrPackageName=t.id+"",n.pictureUrl=t.picture,n.title=t.title,n.subTitle=t.subTitle,n.type="rotate";break;default:break}return n},paramIdFun:function(e){var t;return"movie"===e.contentType?(t={id:e.thirdIdOrPackageName},e.vid&&(t.vid=e.vid),e.sid&&(t.sid=e.sid)):"app"===e.contentType||"edu"===e.contentType||"txLive"===e.contentType?t={id:e.thirdIdOrPackageName}:"bigTopic"===e.contentType?t={pTopicCode:e.thirdIdOrPackageName}:"topic"===e.contentType?t={topicCode:e.thirdIdOrPackageName}:"rotate"===e.contentType&&(t={rotateId:e.thirdIdOrPackageName}),t},fetchData:function(e){var t=this;this.$service.getNewMediaAutomationDetial({id:this.id,version:e}).then(function(e){t.setBasicInfo(e)})},setBasicInfo:function(e){var t=this.basicForm;t.id=e.id,t.recName=e.recName,t.openStatus=e.openStatus,t.type=e.type||"normal",t.currentVersion=e.currentVersion,t.duplicateVersion=e.duplicateVersion,t.platformName=e.platformName,t.status=e.status,t.source=e.source,t.scene=e.scene,t.requestInterval=e.requestInterval,this.videoTabs=[],this.videoTabs=(e.videoList||[]).map(function(e){return e.picList=e.picList||[],e}).sort(function(e,t){return t.priority-e.priority}),this.sizeTags=[]}},created:function(){var e=this;this.mode=this.initMode||"create",this.id&&this.$service.getNewMediaAutomationDetial({id:this.id,version:this.version}).then(function(t){e.setBasicInfo(t)})},mounted:function(){this.fetchMediaSence()}},BT=VT,MT=(a("b57e"),Object(Yo["a"])(BT,$T,NT,!1,null,"1914acea",null)),UT=MT.exports,GT={components:{TabPage:Il["a"],NewVideoRecomInfo:UT,NewVideoRecomList:LT},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0,status:void 0}},methods:{handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e.id,this.version=e.currentVersion,this.mode="edit",this.isShowList=!1},handleRead:function(e,t){this.id=e.id,this.mode="read",this.version=t||e.currentVersion,this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.deleteMediaAutomation({id:e.map(function(e){return e.id}).join(",")},"删除成功").then(function(e){t.$refs.list.fetchData()})},handleCopy:function(e){this.id=e.id,this.mode="copy",this.isShowList=!1},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},jT=GT,zT=Object(Yo["a"])(jT,kT,_T,!1,null,"b5da56c2",null),WT=zT.exports,qT=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("TabPage",[a("VideoRecomSceneList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate}}),e.isShowList?e._e():a("VideoRecomSceneInfo",{attrs:{id:e.id,version:e.version,"init-mode":e.mode,status:e.status},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},JT=[],HT=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,pagination:e.pagination},on:{"filter-change":e.fetchData}},[[a("el-tabs",{attrs:{type:"card"},on:{"tab-click":function(t){return e.handleClick(e.activeName)}},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"主页上版块填充",name:"1",disabled:""}}),a("el-tab-pane",{attrs:{label:"主页上推荐位填充",name:"2",disabled:""}}),a("el-tab-pane",{attrs:{label:"影片相关推荐",name:"3",disabled:""}}),a("el-tab-pane",{attrs:{label:"搜索页猜你想找",name:"4"}})],1)],[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$emit("create")}}},[e._v("添加推荐流与人群")])],a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data}})],2)],1)},KT=[],YT={components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"]},props:["contentType","mode","data","source","pannelGroupId","hideTitleOptions","checkCrowd","isInterveneBlock"],data:function(){var e=this;return{filter:this.genDefaultFilter(),showCrowdSelector:!1,activeName:"4",dialogFormVisible:!1,form:{},firstPanel:{},contentForm:{pannelResource:"o_tencent",dmpRegistryInfo:"",recStreamPanelRls:""},pagination:{currentPage:1,pageSize:10},table:{props:{},data:[],header:[{label:"推荐流名称",prop:"recStreamName"},{label:"人群ID",width:"150",prop:"dmpCrowdId"},{label:"优先级",prop:"priority",render:function(t,a){var n=a.row;return t("el-input",{style:{width:"100px"},props:{value:n.priority},on:{input:function(e){n.priority=e},blur:function(t){e.handleUpdatePriority(n)}}})}},{label:"操作",fixed:"right",width:180,render:function(t,a){var n=a.row;return t("div",[t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleDel(n)}}},"删除")])}}],selected:[],selectionType:"multiple"}}},methods:{handleUpdatePriority:function(e){var t=this,a={};a.id=e.id,a.priority=e.priority;var n=/^\+?[1-9]\d*$/;if(!n.test(a.priority))return this.$message.error("只能输入数字");this.$service.dmpUpdatePriority(a).then(function(e){e.success&&t.fetchData()})},fetchData:function(){var e=this,t=this.parseFilter();this.$service.getMediaSceneList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},handleClick:function(e){this.fetchData()},handleSelectBlockRecStreamEnd:function(e){var t=e[0],a=t.recId,n=t.recName,i=t.recCategory,r=t.flag;this.firstPanel.recStreamPanelRls={recId:a,recName:n,recCategory:i,recFlag:r}},genDefaultFilter:function(){return{page:1,rows:10}},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize,e.scene=this.activeName),e},handleSelectCrowdStart:function(){this.showCrowdSelector=!0},handleSelectCrowdCancel:function(){this.showCrowdSelector=!1},handleSelectCrowdEnd:function(e,t){this.$set(this.contentForm,"dmpRegistryInfo",{dmpPolicyId:e.value,dmpCrowdId:t.value,dmpPolicyName:e.label,dmpCrowdName:t.label}),this.$sendEvent({type:"create_block_dmp",payload:{type:"common"}}),this.showCrowdSelector=!1},handleDel:function(e){var t=this;this.$service.removeMediaDmp({id:e.id},"删除成功").then(function(e){1===t.table.data.length&&(t.pagination.currentPage=t.pagination.currentPage-1),t.fetchData()})}},mounted:function(){this.fetchData()}},QT=YT,XT=Object(Yo["a"])(QT,HT,KT,!1,null,null,null),ZT=XT.exports,eS=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:"影片应用场景"},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("el-form",{ref:"contentForm",staticClass:"video-content-form",attrs:{model:e.contentForm,"label-width":"160px"}},[a("el-form-item",{attrs:{label:"选择推荐流"}},[a("NewBlockRecStreamSelector",{attrs:{title:"选择推荐流","selection-type":"single"},on:{"select-end":e.handleSelectBlockRecStreamEnd}}),e.contentForm.id?[e._v("\n             已选择: "),a("el-tag",[e._v("\n             "+e._s(e.contentForm.id)+"\n             ("+e._s(e.contentForm.recName)+")\n             ")])]:e._e()],2),a("el-form-item",{attrs:{label:"关联定向人群"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSelectCrowdStart}},[e._v("添加人群")]),e.dmpRegistryInfo.dmpPolicyName?a("el-tag",{attrs:{type:"primary"}},[e._v("已选择: "+e._s(e.dmpRegistryInfo.dmpPolicyName)+"("+e._s(e.dmpRegistryInfo.dmpPolicyId)+") / "+e._s(e.dmpRegistryInfo.dmpCrowdName)+"("+e._s(e.dmpRegistryInfo.dmpCrowdId)+")")]):e._e()],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleCreate}},[e._v("确定")])],1)],1),e.showCrowdSelector?a("CrowdSelector",{on:{"select-cancel":e.handleSelectCrowdCancel,"select-end":e.handleSelectCrowdEnd}}):e._e()],1)},tS=[],aS={components:{NewBlockRecStreamSelector:Ss["a"],CrowdSelector:fs["a"]},data:function(){return{contentForm:{id:"",recName:""},dmpRegistryInfo:{dmpPolicyId:"",dmpCrowdId:"",dmpPolicyName:"",dmpCrowdName:""},showCrowdSelector:!1,dialogFormVisible:!1}},methods:{handleSelectBlockRecStreamEnd:function(e){this.contentForm=e[0],this.contentForm=Object.assign(this.dmpRegistryInfo,this.contentForm)},handleSelectCrowdStart:function(){this.showCrowdSelector=!0},handleSelectCrowdCancel:function(){this.showCrowdSelector=!1},handleSelectCrowdEnd:function(e,t){this.dmpRegistryInfo.dmpPolicyId=e.value,this.dmpRegistryInfo.dmpCrowdId=t.value,this.dmpRegistryInfo.dmpPolicyName=e.label,this.dmpRegistryInfo.dmpCrowdName=t.label,this.showCrowdSelector=!1},handleCreate:function(){var e=this;if(""===this.contentForm.id)return this.$message.error("请选择推荐流");var t={scene:"4"};t.recStreamId=this.contentForm.id,t.dmpPolicyId=this.contentForm.dmpPolicyId,t.dmpCrowdId=this.contentForm.dmpCrowdId,t.dmpCrowdName=this.contentForm.dmpCrowdName,t.dmpPolicyName=this.contentForm.dmpPolicyName,console.log(t,"--con"),this.$service.saveMediaRecStreamDmp(t).then(function(t){e.$emit("upsert-end")})}}},nS=aS,iS=Object(Yo["a"])(nS,eS,tS,!1,null,null,null),rS=iS.exports,oS={components:{TabPage:Il["a"],VideoRecomSceneInfo:rS,VideoRecomSceneList:ZT},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0,status:void 0}},methods:{handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e.id,this.version=e.currentVersion,this.mode="edit",this.isShowList=!1},handleRead:function(e,t){this.id=e.id,this.mode="read",this.version=t||e.currentVersion,this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.deleteMediaAutomation({id:e.map(function(e){return e.id}).join(",")},"删除成功").then(function(e){t.$refs.list.fetchData()})},handleCopy:function(e){this.id=e.id,this.mode="copy",this.isShowList=!1},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},lS=oS,sS=Object(Yo["a"])(lS,qT,JT,!1,null,"77ace942",null),cS=sS.exports,uS=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PageWrapper",[a("PageContentWrapper",[a("ContentCard",{ref:"contentCard",staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("a",{staticClass:"el-button el-button--primary el-button--small export-btn",attrs:{target:"_blank",href:e.exportUrl}},[e._v("\n          导出当前数据\n        ")]),a("ButtonGroupForListPage",{attrs:{pageName:"deviceConfig"},on:{edit:e.handleEdit}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1),a("el-dialog",{attrs:{visible:e.showEditDialog},on:{"update:visible":function(t){e.showEditDialog=t}}},[e.editingRow?a("el-form",{ref:"form",attrs:{"label-width":"120px",model:e.editingRow,rules:e.rules}},[a("el-form-item",{attrs:{label:"机型"}},[e._v("\n          "+e._s(e.editingRow.model)+"\n        ")]),a("el-form-item",{attrs:{label:"机芯"}},[e._v("\n          "+e._s(e.editingRow.chip)+"\n        ")]),a("el-form-item",{attrs:{label:"内存大小",prop:"ramSize"}},[a("el-input",{model:{value:e.editingRow.ramSize,callback:function(t){e.$set(e.editingRow,"ramSize","string"===typeof t?t.trim():t)},expression:"editingRow.ramSize"}})],1),a("el-form-item",{attrs:{label:"是否自动播放",prop:"autoPlay"}},[a("el-radio-group",{model:{value:e.editingRow.autoPlay,callback:function(t){e.$set(e.editingRow,"autoPlay",t)},expression:"editingRow.autoPlay"}},[a("el-radio",{attrs:{label:0}},[e._v("\n              否\n            ")]),a("el-radio",{attrs:{label:1}},[e._v("\n              是\n            ")]),a("el-radio",{attrs:{label:2}},[e._v("\n              客户端判断\n            ")])],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("保存")])],1)],1):e._e()],1)],1)],1)},dS=[],pS={extends:Sl["a"],components:{Table:Bo["Table"],ContentWrapper:Bo["ContentWrapper"],PageWrapper:eu["a"],PageContentWrapper:tu["a"],ButtonGroupForListPage:kl["a"]},data:function(){var e=this;return{resourceType:"deviceConfig",activePage:"deviceConfig_list",showEditDialog:!1,editingRow:null,filter:{model:void 0,chip:void 0,ramSize:void 0,autoPlay:void 0},autoPlayText:{0:"否",1:"是",2:"客户端判断"},autoPlayEnums:{"否":0,"是":1,"客户端判断":2},filterSchema:null,pagination:{},selected:[],rules:{ramSize:[{required:!0,message:"请输入内存大小"},{validator:function(e,t,a){if(!/\d+[mMgGtT]/.test(t))return a(new Error("内存大小格式不正确，应为类似 768m, 2g 这样的格式"));a()}}],autoPlay:[{required:!0,message:"请选择播放设置"}]},table:{props:{},header:[{label:"ID",prop:"id"},{label:"机型",prop:"model"},{label:"机芯",prop:"chip"},{label:"内存大小",prop:"ramSize"},{label:"自动播放",prop:"autoPlay",width:140,render:function(t,a){var n=a.row;return e.autoPlayText[n.autoPlay]}},{label:"修改时间",prop:"lastUpdateDate"},{label:"修改人",prop:"modifierName"}],data:[],selected:[],selectionType:"multiple"}}},computed:{exportUrl:function(){var e=this.filter,t=e.model,a=void 0===t?"":t,n=e.chip,i=void 0===n?"":n,r=e.ramSize,o=void 0===r?"":r,l=e.autoPlay,s=void 0===l?"":l;return"api/v1/deviceConfig/download.html?model=".concat(a,"&chip=").concat(i,"&ramSize=").concat(o,"&autoPlay=").concat(s)}},methods:{handleFilterChange:function(e,t){t&&(this.filter=t),"query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData()},handleFilterReset:function(){this.filter={},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},handleEdit:function(){var e=this.table,t=e.selected;return 0===t.length?this.$message.error("请选择一条数据"):t.length>1?this.$message.error("只能选择一条数据进行编辑"):(this.showEditDialog=!0,void(this.editingRow=JSON.parse(JSON.stringify(e.data[t[0]]))))},handleSave:function(){var e=this;this.$refs.form.validate(function(t){t?e.$service.deviceConfigUpsert(e.editingRow,"保存成功").then(function(t){e.showEditDialog=!1,e.editingRow=null,e.fetchData()}):e.$message.error("请把表单填写完整")})},fetchData:function(){var e=this,t=this.parseFilter();this.$service.deviceConfigGetList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){this.filterSchema=ll.a.map({model:ll.a.o.string.other("form",{component:"Input",placeholder:"机型",label:" ",clearable:!0}),ramSize:ll.a.o.string.other("form",{component:"Input",placeholder:"内存大小,如4g",label:" ",clearable:!0}),autoPlay:ll.a.o.enum(this.autoPlayEnums).other("form",{component:"Select",placeholder:"是否自动播放",label:" ",clearable:!0})}).other("form",{cols:{item:3,label:0,wrapper:23},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}}),this.fetchData()}},hS=pS,mS=(a("bdca"),Object(Yo["a"])(hS,uS,dS,!1,null,"22a1a172",null)),fS=mS.exports,vS={extends:xc["a"],components:{ResourceList:fS,ResourceContent:"div"},data:function(){return{}},computed:{resourceInfo:function(){return{type:"topic",idField:"id"}}}},gS=vS,bS=Object(Yo["a"])(gS,mc,fc,!1,null,null,null),yS=bS.exports,wS=function(){return a.e("chunk-49f36ed8").then(a.bind(null,"724d"))},IS=function(){return a.e("chunk-ecc0b95a").then(a.bind(null,"573e"))},CS=function(){return a.e("chunk-54162f7c").then(a.bind(null,"5264"))},TS=function(){return a.e("chunk-17556570").then(a.bind(null,"1b0a"))},SS=function(){return a.e("chunk-55807fc4").then(a.bind(null,"2ad5"))},kS=function(){return a.e("chunk-186084e7").then(a.bind(null,"6f00"))},_S=function(){return Promise.all([a.e("chunk-15b8f1ca"),a.e("chunk-aeb3c65a")]).then(a.bind(null,"5848"))},PS=function(){return Promise.all([a.e("chunk-15b8f1ca"),a.e("chunk-5d18b2b4")]).then(a.bind(null,"6448"))},xS=function(){return Promise.all([a.e("chunk-15b8f1ca"),a.e("chunk-c9c8ab1e")]).then(a.bind(null,"67ae"))},FS=[{path:"commonResource",name:"commonResource",component:bl,meta:{title:"常用文件",icon:"el-icon-cc-file"},children:[{name:"commonTopPannelUser",path:"/commonResourceUser/TopPannel/view.html",component:void 0,meta:{title:"常用排行榜",tagId:"commonTopPannelUser"}},{name:"commonPannelUser",path:"/commonResourceUser/Pannel/view.html",component:Sm,meta:{title:"常用常规运营版块",tagId:"commonPannelUser"}},{name:"commonAlbumPanneleUser",path:"/commonResourceUser/AlbumPannel/view.html",component:pm,meta:{title:"常用业务专辑",tagId:"commonAlbumPanneleUser"}},{name:"commonTabUser",path:"/commonResourceUser/Tab/view.html",component:zm,meta:{title:"常用Tab版面",tagId:"commonTabUser"}}]},{path:"homePageManage",name:"homePageManage",component:bl,meta:{title:"首页方案管理",icon:"el-icon-cc-toufangfangan"},children:[{name:"homepageInfo",path:"/homepageInfo/view.html",component:Wf,meta:{title:"首页方案",tagId:"homepageInfo"}},{name:"childPolicy",path:"/childPolicy/view.html",component:kS,meta:{title:"儿童策略管理",tagId:"childPolicy"}},{name:"policyConf",path:"/policyConf/view.html",component:nv,meta:{title:"策略管理",tagId:"policyConf"}},{name:"policyGroup",path:"/policyGroup/view.html",component:_S,meta:{title:"保底策略",tagId:"policyGroup"}},{name:"testPolicyGroup",path:"/testPolicyGroup/view.html",component:PS,meta:{title:"定向策略",tagId:"testPolicyGroup"}},{name:"testPolicyConf",path:"/testPolicyConf/view.html",component:fv,meta:{title:"测试策略",tagId:"testPolicyConf"}},{name:"matchHomepage",path:"/matchHomepage.html",component:xS,meta:{title:"主页匹配首页",tagId:"matchHomepage"}}]},{path:"panelManage",name:"panelManage",component:bl,meta:{title:"版面管理",icon:"el-icon-cc-banmianguanli-"},children:[{name:"tabInfo",path:"/tabInfo/view.html",component:Mm,meta:{title:"TAB版面管理",tagId:"tabInfo"}},{name:"businessTab",path:"/businessTab/view.html",component:Uv,meta:{title:"业务版面",tagId:"businessTab"}},{name:"filmDetailPage",path:"/filmDetailPage/view.html",component:rg,meta:{title:"影片详情页",tagId:"filmDetailPage"}},{name:"tabForceInsert",path:"/tabInsertionTask",component:wS,meta:{title:"版面强插任务",tagId:"tabForceInsert"}}]},{path:"blockManage",name:"blockManage",component:bl,meta:{title:"版块管理",icon:"el-icon-cc-bankuaiguanli"},children:[{name:"pannelInfo",path:"/pannelInfo/view.html",component:rd,meta:{title:"常规运营",tagId:"pannelInfo"}},{name:"ruleCreatePanel",path:"/ruleCreatePanel/view.html",component:wd,meta:{title:"筛选规则版块管理",tagId:"ruleCreatePanel"}},{name:"markPanel",path:"/markPanel/view.html",component:Wu,meta:{title:"功能版块",tagId:"markPanel"}},{name:"albumPannelInfo",path:"/albumPannelInfo/view.html",component:Nu,meta:{title:"业务专辑",tagId:"albumPannelInfo"}},{name:"privatePannelInfo",path:"/privatePannelInfo/view.html",component:$d,meta:{title:"专属影院",tagId:"privatePannelInfo"}},{name:"intelliReccomendPannel",path:"/intelliReccomendPannel/view.html",component:void 0,meta:{title:"智能化推荐",tagId:"intelliReccomendPannel"}},{name:"panelRecommend",path:"/panelRecommend",component:KC,meta:{title:"版块推荐流管理",tagId:"panelRecommend"}},{name:"panelRecommendCoreData",path:"/panelRecommendCoreData",component:TS,meta:{title:"个性化推荐核心指标",tagId:"panelRecommendCoreData"}},{name:"panelRecommendFeedback",path:"/panelRecommendFeedback",component:SS,meta:{title:"个性化推荐反馈",tagId:"panelRecommendFeedback"}}]},{path:"rotateStation",name:"rotateStation",component:bl,meta:{title:"轮播管理"},children:[{path:"rotateStationCategory",name:"rotateStationCategory",component:nC,meta:{tagId:"rotateStationCategory"}},{path:"rotateStationCategory_viewStation",name:"rotateStationCategory_viewStation",component:nC,meta:{tagId:"rotateStationCategory_viewStation"}},{path:"frame-page",name:"rotateTopicInfo",component:nC,meta:{tagId:"rotateTopicInfo"}}]},{path:"commonModule",name:"commonModule",component:bl,meta:{title:"公共模块"},children:[{name:"layoutInfo",path:"/layoutInfo/view.html",component:em,meta:{title:"布局管理",tagId:"layoutInfo"}},{name:"globalPicture",path:"/globalPicture/view.html",component:Fh,meta:{title:"素材管理",tagId:"GlobalPicture"}},{name:"globalCornerIcon",path:"/globalCornerIcon/view.html",component:Up,meta:{title:"角标素材管理",tagId:"globalCornerIcon"}},{name:"globalCornerIconType",path:"/globalCornerIconType/view.html",component:rh,meta:{title:"角标分类管理",tagId:"globalCornerIconType"}},{name:"commonOnclickInfo",path:"/commonOnclickInfo/view.html",component:Qd,meta:{title:"点击事件管理",tagId:"commonOnclickInfo"}}]},{path:"resourceMgr",name:"resourceMgr",component:bl,meta:{title:"资源管理",icon:"el-icon-cc-huaban"},children:[{name:"videoContent",path:"/videoContent/view.html",component:pg,meta:{title:"影片资源库",tagId:"videoContent"}},{name:"videoDataList",path:"/videoDataList/view.html",component:void 0,meta:{title:"数据列表",tagId:"videoDataList"}}]},{path:"blockInfo",name:"blockInfo",component:bl,meta:{title:"推荐位管理",icon:"el-icon-cc-ziyuanguanli"},children:[{name:"broadcastBlock",path:"/broadcastBlock/view.html",component:Pc,meta:{title:"轮播推荐位",tagId:"BroadcastBlock"}},{name:"sysPlugin",path:"/sysPlugin/view.html",component:wu,meta:{title:"系统插件(状态栏)",tagId:"SysPlugin"}},{name:"multiFunctionBlock",path:"/multiFunctionBlock/view.html",component:uu,meta:{title:"多功能推荐位",tagId:"multiFunctionBlock"}},{name:"mediaAutomation",path:"/mediaAutomation/view.html",component:ST,meta:{title:"指定影片推荐流",tagId:"mediaAutomation"}},{name:"recStream",path:"/recStream/view.html",component:WT,meta:{title:"新影片推荐流",tagId:"recStream"}},{name:"recommendStreamScene",path:"/recommendStreamScene/view.html",component:cS,meta:{title:"影片推荐流应用场景",tagId:"recommendStreamScene"}}]},{path:"videoOnDemand",name:"videoOnDemand",component:bl,meta:{title:"点播资源管理",icon:"el-icon-cc-huaban"},children:[{path:"ownMediaResManage",name:"ownMediaResManage",component:nC,meta:{tagId:"ownMediaResManage"}},{path:"rankingListManage",name:"rankingListManage",component:nC,meta:{tagId:"rankingListManage"}},{path:"ccShortVideoConnectPositiveDetail",name:"ccShortVideoConnectPositiveDetail",component:nC,meta:{tagId:"ccShortVideoConnectPositiveDetail"}},{path:"rightsContentManage",name:"rightsContentManage",component:nC,meta:{tagId:"rightsContentManage"}}]},{path:"themeManage",name:"themeManage",component:bl,meta:{title:"主题管理",icon:"el-icon-cc-zhuti"},children:[{name:"themeInfo",path:"/themeInfo/view.html",component:py,meta:{title:"主题皮肤管理",tagId:"themeInfo"}}]},{path:"dirCrowdManager",name:"dirCrowdManager",component:bl,meta:{title:"定向人群管理",icon:"el-icon-cc-institute"},children:[{name:"actDmpGroupInfo",path:"/actDmpGroupInfo/view.html",component:Jm,meta:{title:"RPC人群列表",tagId:"actDmpGroupInfo"}},{name:"dmpMgr",path:"/dmpMgr",component:$C,meta:{tagId:"dmpMgr"}}]},{path:"sysConfig",name:"sysConfig",component:bl,meta:{title:"系统设置",icon:"el-icon-cc-renyuanguanli"},children:[{name:"sysMenu",path:"/sysMenu/view.html",component:Sb,meta:{title:"系统菜单",tagId:"sysMenu"}},{name:"userConfig",path:"/sysUser/view.html",component:Gb,meta:{title:"用户管理",tagId:"userConfig"}},{name:"baDept",path:"/sysDept/view.html",component:Dg,meta:{title:"部门管理",tagId:"baDept"}},{name:"sysLogLogin",path:"/sysLogLogin/view.html",component:eb,meta:{title:"登录日志",tagId:"sysLogLogin"}},{name:"sysLogOp",path:"/sysLogOp/view.html",component:ob,meta:{title:"操作日志",tagId:"sysLogOp"}},{name:"roleConfig",path:"/sysRole/view.html",component:Hg,meta:{title:"角色管理",tagId:"roleConfig"}}]},{path:"adBitMgr",name:"adBitMgr",component:bl,meta:{title:"广告位管理",icon:"el-icon-cc-banner"},children:[{name:"filmDetailAdBit",path:"/filmDetailAdBit/view.html",component:lI,meta:{title:"详情页广告位",tagId:"filmDetailAdBit"}}]},{path:"deviceConfig",name:"deviceConfig",component:bl,meta:{title:"小窗自动播放配置"},children:[{name:"deviceConfig",path:"/deviceConfig",component:yS,meta:{title:"小窗自动播放配置",tagId:"deviceConfig"}}]},{path:"todoTask",name:"todoTask",component:bl,meta:{title:"待处理任务",icon:"el-icon-cc-daichuli2"},children:[{name:"myDrafts",path:"/myDrafts/view.html",component:bw,meta:{title:"我的草稿",tagId:"myDrafts"}},{name:"mySubmitTasks",path:"/mySubmitTasks/view.html",component:eI,meta:{title:"我提交的任务",tagId:"mySubmitTasks"}},{name:"myReviewTasks",path:"/myReviewTasks/view.html",component:Gw,meta:{title:"我的审核任务",tagId:"myReviewTasks"}},{name:"msn",path:"/v1/msn/view.html",component:by,meta:{title:"下架影片通知",tagId:"msn"}}]},{path:"svMgr",name:"svMgr",component:bl,children:[{name:"topic",path:"/svMgr/topic",component:IS,meta:{tagId:"topic"}},{name:"topicConfig",path:"/svMgr/topic-config",component:CS,meta:{tagId:"topic-config"}}]},{name:"desktop",path:"desktop",component:QI,meta:{title:"我的桌面",tagId:"desktop"}}],DS=[{path:"/",component:II,redirect:"/desktop",children:FS},{name:"login",path:"/login",component:pl,meta:{title:"登录"}}],RS=DS;function LS(e,t,a){var n=this.app;n.$isLoggedIn().then(function(){a("login"!==e.name?0===e.matched.length&&n.$router.getMatchedComponents(e.fullPath).length>0?{path:e.fullPath}:void 0:{name:"/"})}).catch(function(t){a("login"===e.name?void 0:{name:"login",query:{redirect:e.fullPath}})})}function $S(e){var t=this.app,a=e.matched.slice(1).map(function(e){e.name;var t=e.meta;return{name:t.title,to:void 0}});t.$nextTick(function(){t.$bus.$emit("breadcrumb-change",a)})}z["default"].use(Zo["a"]);var NS=new Zo["a"]({routes:RS});NS.beforeEach(LS.bind(NS)),NS.afterEach($S.bind(NS));var ES=NS;a("86d7");z["default"].config.productionTip=!1,z["default"].use(W["b"]),new z["default"]({router:ES,render:function(e){return e(Xo)}}).$mount("#app")},5794:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form-item",[a("div",{attrs:{slot:"label"},slot:"label"},[e._v("\n      应用参数\n      ")]),e.readonly?a("div",{key:"read-params"},e._l(e.params,function(t,n){return a("div",{key:n,staticClass:"app-extend-params"},[a("el-form-item",{attrs:{label:"","label-width":"0px"}},[a("el-tag",[e._v("key")]),e._v(" \n          "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.key,placement:"top"}},[a("span",[e._v(e._s(t.key))])])],1),a("el-form-item",{attrs:{label:"","label-width":"0px"}},[a("el-tag",[e._v("value")]),e._v(" \n          "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.value+"",placement:"top"}},[a("span",[e._v(e._s(t.value))])])],1)],1)}),0):a("div",{key:"edit-params"},[e._l(e.params,function(t,n){return a("div",{key:n,staticClass:"app-extend-params"},[t.hide?e._e():[a("el-form-item",{attrs:{label:"key:","label-width":"60px",prop:e.propPrefix+n+".key",rules:e.rules.params.key}},[t.default?a("div",{staticStyle:{"min-width":"160px"}},[e._v(e._s(t.key))]):a("el-input",{model:{value:t.key,callback:function(a){e.$set(t,"key","string"===typeof a?a.trim():a)},expression:"param.key"}})],1),a("el-form-item",{attrs:{label:"value:","label-width":"60px",prop:e.propPrefix+n+".value",rules:e.rules.params.value}},[a("el-input",{model:{value:t.value,callback:function(a){e.$set(t,"value","string"===typeof a?a.trim():a)},expression:"param.value"}})],1),t.default?e._e():a("a",{staticClass:"app-params__remove-param",on:{click:function(t){return e.handleRemoveParam(n)}}},[a("i",{staticClass:"el-icon-minus"})]),a("div",{staticClass:"tips"},[e._v(e._s(t.tip))])]],2)}),a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleAddParam}},[a("i",{staticClass:"el-icon-plus"}),e._v(" 添加\n      ")])],2),a("div",{staticClass:"tips"},[e._v("应用参数与点击事件无关，用于特殊推荐位，例如 话题PK")])])],1)},i=[],r={props:["params","readonly","propPrefix"],data:function(){var e=this,t=function(t,a,n){if(/[！￥……（）——【】：；“”‘’、《》，。？\s+]/.test(a))return n(new Error("请勿输入特殊或空白字符"));var i=e.params.filter(function(e){var t=e.key;return t===a}).length>1;if(i)return n(new Error("key 不能重复"));n()};return{rules:{params:{key:[{required:!0,message:"不能为空",trigger:"blur"},{validator:t,trigger:"blur"}],value:[{required:!0,message:"不能为空",trigger:"blur"}]}}}},methods:{handleRemoveParam:function(e){this.params.splice(e,1)},handleAddParam:function(){this.params.push({key:void 0,value:void 0})}},created:function(){console.log(this.propPrefix)}},o=r,l=(a("1367"),a("2877")),s=Object(l["a"])(o,n,i,!1,null,"774941ce",null);t["a"]=s.exports},"57da":function(e,t,a){"use strict";var n=a("0a51"),i=a.n(n);i.a},"57e4":function(e,t,a){},"580c":function(e,t,a){e.exports=a.p+"img/detail-ad-3.8a40a230.png"},"58c5":function(e,t,a){e.exports=a.p+"img/detail-ad-1-2.151fc6ac.png"},"5a57":function(e,t,a){"use strict";var n=a("4595"),i=a.n(n);i.a},"5a6f":function(e,t,a){"use strict";var n=a("fe63"),i=a.n(n);i.a},"5a82":function(e,t,a){"use strict";var n=a("28bf"),i=a.n(n);i.a},"5b59":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("RemoteSelectorWrapper",{ref:"wrapper",attrs:{title:e.title,"custom-class":"resource-selector",disabled:e.disabled,"is-live":e.isLive},on:{"select-start":e.handleSelectStart},scopedSlots:e._u([{key:"content",fn:function(t){var n=t.isShow;return[e.isLive||n?a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":e.getId,"selection-type":e.selectionType,table:e.table,filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination,"select-end-on-dbl-click":!1},on:{"pagination-change":e.fetchData,"filter-change":e.handleFilterChange,"filter-reset":e.handleResetFilter,"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}},[a("div",{attrs:{slot:"filter"},slot:"filter"},[a("el-form",{attrs:{inline:!0,model:e.filter},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.handleFilterChange(t))}}},[a("el-form-item",[a("el-input",{attrs:{type:"number",clearable:"",placeholder:"推荐流ID"},model:{value:e.filter.id,callback:function(t){e.$set(e.filter,"id",t)},expression:"filter.id"}})],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"推荐流名称",clearable:""},model:{value:e.filter.recName,callback:function(t){e.$set(e.filter,"recName",t)},expression:"filter.recName"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{on:{click:e.handleResetFilter}},[e._v("重置")])],1)],1)],1)]):e._e()]}}])})},i=[],r=(a("28a5"),a("a1fe")),o=a("42f0"),l={data:function(){var e=this;return{provinceOptions:[],pagination:{currentPage:1,pageSize:15,total:0},filter:this.genDefaultFilter(),effectiveFilter:this.genDefaultFilter(),filterSchema:null,table:{props:{},header:[{label:"推荐流ID",prop:"id",sortable:!0,width:"200px",fixed:"left"},{label:"推荐流名称",prop:"recName",fixed:"left"},{label:"内容源",prop:"source",render:function(t,a){var n=a.row;return e.$consts.sourceTextWithNone[n.source]}},{label:"适用场景",prop:"scene",render:function(t,a){var n=a.row,i=e.handleScene(n);return t("div",{},i)}},{label:"推荐业务来源",prop:"platformName"}],data:[],selected:[],selectionType:"multiple"},sceneOption:[]}},props:["title","disabled","isLive","scene","source","selectionType","initSelected"],computed:{},components:{RemoteSelectorWrapper:r["a"],BaseSelector:o["a"]},methods:{handleScene:function(e){var t=this,a=[];return e.scene.split(",").map(function(e){t.sceneOption.map(function(t){e===t.dictEnName&&a.push(t.dictCnName)})}),a.join(",")},getId:function(e){return e.id},genDefaultFilter:function(){return{id:"",recName:"",source:this.source,scene:this.scene}},handleSelectStart:function(){var e=this;this.$emit("select-start"),this.isLive?this.fetchData():this.handleResetFilter();var t=this.initSelected;t&&this.$nextTick(function(){var a=e.$refs.baseSelector;a.selected=t.filter(function(t){return e.getId(t)}),a.updateTableSelected()})},handleSelectCancel:function(){this.$refs.wrapper.handleSelectCancel()},handleSelectEnd:function(e){this.$emit("select-end",e),this.$refs.wrapper.handleSelectEnd()},handleRowSelectionRemove:function(e){this.$refs.baseSelector.handleTableRowSelectionRemove(e)},handleFilterChange:function(){this.effectiveFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleResetFilter:function(){this.filter=this.genDefaultFilter(),this.effectiveFilter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=JSON.parse(JSON.stringify(this.effectiveFilter)),a=this.pagination;a&&(t.page=a.currentPage,t.rows=a.pageSize),this.$service.getNewMediaAutomationList(t).then(function(t){e.pagination.total=t.total||0,e.table.data=t.rows||[]})},fetchMediaSence:function(){var e=this;this.$service.getMediaSence().then(function(t){e.sceneOption=t})}},created:function(){},mounted:function(){this.fetchMediaSence()}},s=l,c=(a("6a8c"),a("2877")),u=Object(c["a"])(s,n,i,!1,null,"7e71adfa",null);t["a"]=u.exports},"5bc4":function(e,t,a){"use strict";var n=a("0939"),i=a.n(n);i.a},"5bd3":function(e,t,a){"use strict";var n=a("952d"),i=a.n(n);i.a},"5c3c":function(e,t,a){"use strict";var n=a("7278"),i=a.n(n);i.a},"5c3f":function(e,t,a){"use strict";var n=a("4fc2"),i=a.n(n);i.a},"5e39":function(e,t,a){},"5eb0":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content-card"},[void 0!==e.title?a("div",{staticClass:"content-card__header"},[e._v("\n        "+e._s(e.title)+"\n        "),a("div",{staticClass:"actions"},[e._t("actions",[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.$emit("go-back")}}},[e._v("返回")])])],2)]):e._e(),a("div",{staticClass:"content-card__main"},[e._t("default")],2),e.showContentAuthManager?a("content-auth-manager",{ref:"contentAuthManager",attrs:{"resource-id":e.contentAuthInfo.id,"menu-elid":e.contentAuthInfo.menuElId,"resource-type":e.contentAuthInfo.type}},[a("div",{attrs:{slot:"button"},slot:"button"})]):e._e()],1)},i=[],r=a("3d85"),o={components:{ContentAuthManager:r["a"]},props:["title"],data:function(){return{showContentAuthManager:!1,contentAuthInfo:null}},methods:{handleShowContentAuthManager:function(e){var t=this;this.showContentAuthManager=!0,this.contentAuthInfo=e,this.$nextTick(function(){t.$refs.contentAuthManager.handleOpenAuthManagement()})}}},l=o,s=(a("55ef"),a("2877")),c=Object(s["a"])(l,n,i,!1,null,"66a9b9c9",null);t["a"]=c.exports},"5eb9":function(e,t,a){},"5f87":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-content-wrapper"},[e._t("default")],2)},i=[],r={mounted:function(){this.$bus.$emit("scroll-top")}},o=r,l=(a("f561"),a("2877")),s=Object(l["a"])(o,n,i,!1,null,"ac023078",null);t["a"]=s.exports},"5f9e":function(e,t,a){},"5fd1":function(e,t,a){},"607a":function(e,t,a){"use strict";var n=a("5662"),i=a.n(n);i.a},"60a9":function(e,t,a){"use strict";var n=a("f376"),i=a.n(n);i.a},"60d4":function(e,t,a){"use strict";var n=a("3260"),i=a.n(n);i.a},"60d6":function(e,t,a){},"61c9":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"sCoocaaMId","is-live":e.isLive,"selection-type":e.selectionType,table:e.table,pagination:e.pagination,"select-end-on-dbl-click":!0},on:{"pagination-change":e.fetchData,"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset,"select-cancel":function(t){return e.$emit("select-cancel")},"select-end":function(t){return e.$emit("select-end")}}},[a("el-form",{attrs:{slot:"filter",inline:!0,"label-width":"72px"},slot:"filter",model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("el-form-item",[a("CommonSelector",{attrs:{filterable:"",placeholder:"内容源",options:e.$consts.partnerOptions,disabled:e.disablePartner},model:{value:e.filter.source,callback:function(t){e.$set(e.filter,"source",t)},expression:"filter.source"}})],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"正片id",clearable:""},model:{value:e.filter.pThirdVId,callback:function(t){e.$set(e.filter,"pThirdVId",t)},expression:"filter.pThirdVId"}},[a("ResourceSelector",{attrs:{slot:"append",selectors:["video","edu"],source:e.source,"disable-partner":!0},on:{"select-end":e.handleSelectParentVideoEnd},slot:"append"},[a("el-button",[e._v("选择正片")])],1)],1)],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"短视频标题",clearable:""},model:{value:e.filter.mTitle,callback:function(t){e.$set(e.filter,"mTitle",t)},expression:"filter.mTitle"}})],1),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{attrs:{size:"small",type:"warning"},on:{click:e.handleFilterReset}},[e._v("重置")])],1)],1)},i=[],r=a("42f0"),o=a("ea3f"),l=a("cc30"),s={components:{BaseSelector:r["a"],CommonSelector:o["a"],ResourceSelector:l["a"]},data:function(){var e=this;return{pagination:{currentPage:1,pageSize:15},filter:this.getDefaultFilter(),efficientFilter:this.getDefaultFilter(),filterSchema:null,table:{props:{},header:[{label:"短视频ID",prop:"sCoocaaMId"},{label:"短视频名",prop:"sShowTitle"},{label:"内容源",prop:"source",render:function(t,a){var n=a.row;return e.$consts.partnerText[n.source]}},{label:"短视频时长",prop:"mDuration",render:function(t,a){var n=a.row;return e.secondToTimeStr(n.mDuration)}},{label:"平均播放时长",prop:"avgPerplayTimeSec",render:function(t,a){var n=a.row;return e.secondToTimeStr(n.avgPerplayTimeSec)}},{label:"正片",prop:"pTitle"}],data:[]}}},props:["isLive","selectionType","source","disablePartner"],computed:{selected:function(){return this.$refs.baseSelector.selected.slice()}},methods:{secondToTimeStr:function(e){if(e){var t=Math.floor(e/3600),a=Math.floor((e-3600*t)/60),n=e-3600*t-60*a;return"".concat(t,"小时").concat(a,"分").concat(n,"秒")}},handleSelectParentVideoEnd:function(e){var t,a=e.video,n=e.episode,i=e.edu;if(a.length>0){var r=a[0].coocaaVId,o=n[r];t=o?o.coocaaMId:r}else i.length>0&&(t=i[0].coocaaVId);this.filter.pThirdVId=t},getDefaultFilter:function(){return{source:this.$consts.sourceToPartner[this.source||this.$consts.sourceOptions[0].value],mTitle:"",pThirdVId:"",resType:"shortVideo",callback:"result",orderBy:"m_duration",order:"desc"}},getFilter:function(){var e=this.pagination,t=Object.assign({},this.efficientFilter);return t.code=t.id,e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.efficientFilter=this.getDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=this.getFilter();this.$service.getMediaVideoInfos(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows||[]})}},created:function(){}},c=s,u=a("2877"),d=Object(u["a"])(c,n,i,!1,null,"533a7836",null);t["default"]=d.exports},6283:function(e,t,a){},"62a4":function(e,t,a){},6308:function(e,t,a){},"63d2":function(e,t,a){"use strict";var n=a("cb10"),i=a.n(n);i.a},6483:function(e,t,a){"use strict";var n=a("e73c"),i=a.n(n);i.a},"657a":function(e,t,a){"use strict";var n=a("7637"),i=a.n(n);i.a},66790:function(e,t,a){},"66d9":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAI30lEQVR4XtWbeZBcVRXGf6dnJgScsKaCsimCyKJVQEQwxOk3wyYURbGYQA1CmNeEFApUISK4oBYoiCBggZKY6TfJmJhKWKpIgQgE8noIIAURFApQq4BICSIgywQImen+rNtJh0nS3W/p2bz/vu9859yv77v33XNOG6MwvG59QRm+COxv8Hng04jJMnYBdjQwF4ZgPfA3g+cQTwMrQp/VmGmkwiw7Hu7hzdNkmjldRgfCM2Pn1D7Em04IjHsGxF2P5Kw/NVcVw+ETQDIvoFOQA7JmZIYz0DKXeFfw65Jx08O+vTEc/MMiQDav4zGuNzhwOIKKwbFOImhq5uqHZtm/YuBrQhoSwL3bGHMxjmwkiNS2Yq3g+wWfW9LuE6kEOHyRtp+4nuuA2ZUNLPUkhsNQPFkqcXbfbHs+KV1iAdoCTcvAMmD3pM5GFC8GgQvDnM1N4ieRANlAFyFuHJENLknU9bE/DH37WVy62AJ4gb4D5WX//zBuCbu4KM6+EEuAbF6XmvGL/4eZV2IU9BR886NijhTAy+scjJ4oovH4XHBlwbcf14utrgBeoK9LLB3n73xd7UvGmX1d9vtaoJoCeN3aV8ZfzNhuPP66cWOSGMgYx6z0rVDNpqoAXo8mqsSfzTggrqNxjXP3iQyfC7vsnS3jrC5AoOuBS8b1pJIGJ+aGOTs/UgCvR/sjngWakvoYz3iBTHw5zNmTQ+PcagV4ea0as2/7EVZQ8MyUVg65baYVK642E6C9W0cpw4oRjmNM6QWdBd+WVBXAC/QYcMSYRpjQucSrZtxYEn/NiJ3J8FNgn1o0Ek8VcnboVgK0dastk6HqUZEwptGDi8X9g5y3eo59UHHq9WhHSjyBsW+ds/+Ilb497p5vegW8vBZhnDl60af3JFHC+F7Bt6qf516gbwC/q7kKYEnBt85NAhzbq0+sHyzn3iamD2uULMXaUobT+7rsD7U8Tu/VXs2DrKnzGgxYhu3DLltXXgHZHp1loneUptCIm5cxjg+77IV6JFPnabtJLbwf4eiY0LcVGwQItNigvCTG8SgMbsMpq860t6NibA+UFYT1cBJXFXL2o4oArxtMiSIeq+cSN0+ZxMVDz+9asXg9+ozEgwafjYg3DH1rt3JiM8MzYzW5un7FoIzzCr7Fuo63Bzpc4m6MyTHms469mWRtPerMiMUxDEYb8lYJTurz7dE4jtt6dKqJJQYT4uAdpggHWTavK824Io6RO37MmI/4N0azxAwz9otjmwgjni0ZJ/T59kocOy/QD6D8AZRoGJzsBHAJj5mRluKjktEx9BfZuNsuBU6MtI8PuKt/gM6hHze1TKfOU8ukZnoxzohPvxnyUvMCud0yG0UgcUkhZzdsidsowmpX+IziqLsrl2ujXBWVwqpwTF+snZrXsRxjelq/bnN1K8AlPg6JCq5lgJ1WzLF3q+EazR5JfJAxOlf6dlecyUxfqP2aitwbY6evTycWmJfXP+p9NzsGif8WcuZK2TWHyx8Ct8WZwFCM4BUrcUJ4rrkcROTw8nK/uNvpd4gERwAEd1o20BqDvaLIii3s9vBZ9lqECDcDF0RxVZ4LHm1u4qQHZ9lbcWza8jrboNuMljj4GJi73SvwXJzcn0RvIWez6pGWN6UW3JV6apRzl7e3vTkvbDdX0opYquXS+9UYl0dBkzwXLHGboEsRRQa8kfjC0Ldb6jnpWKjdS8VySm3HGrgixiVhl/0qTrDlBK1wn+qnxsEnwUjMdyvgPjOOjWNYvobC0YWcrayHb8vrWDP+uGXlWPB2Bk6plaLekvOo+dq12MQ9CX6gONPYhJG4zq0AV02dE9dS8F6xicNWzbK/17PJ9mgGJRYMqSs8Pgidq3x7MY6vrwY6MCMeMGO3OPg0GMEc83p0GeLnSQgkXipOZGrUzezoedqh2MLBxSL/7JttL8X10R7oOInbMVrj2qTBSXS4u8AJGZWXWbIhHukfpH31HBtIZlgfnc1rNjB3NMpx7mSzcjZogHfct32KiSwKfTsrhd1WJjOWqek//eXegwuHgy+KQ/Biwbd9yvkAL5Db1Lwoo2rPN/To2DVpbCs23jK1spbbgeMa4Ulo2x365lp8wMvrcoxUk3AVF4mT+3K2PGEAZbg7NotF7h/FDrNKmGeEvi3dIECPDkY8lWYCzkbwoRnTwi5z3Z2xR/sCTVWRezB2jW00PMD3t13LLvdeZB99nBYP5AQ4OC2/xGulCUyN+lyu8LsExsZEzKhnogW/LfhWPvo/FqBbZ5BhU8kopRBPf9TKtMdm2of17NMcvSnjqWpWKnFo37lWXvEf1wZ/ooy3J2sw9mjEmcTygs/J1RqU3F2htbl8mTm7ER+N2ErcX8jZps12s+LocHWCVVLOQwOd1qspEwa4o5EERiMTr9iW4MihWa3NBPjKMm07YW25XX3PRp0JbjW4U8a2iOmI882Y1Chvg/b3hb59bSjHVv0BrvHZjJplpwYDGEvz4iDst+VdpGqLTDbQHSNx/RzL2SNuCnN28ZYx1GqS+iQlXKpsRC8joyjIy/0DHFQt01y7TS7QiYLl46IbvAGl3N9wzDi81kda3UbJbF7fNuOXDfgfc1MZ3yp02W9qBRLZKpsNFBh0jflM0gVwbehb3TxipADumvpGP0sxTksXw5hZLQx9OyfKe6QAZQLJsgHXmnFpFOF4eO5yfYWcfTdOLPEE2Mjk8vIZIxjHTZRFiYsLOXP1iVgjkQCOsS1Qh4lFZnwqlofRAok1yjCj0GVPJHGZWABHfmRek1rgGhnfHCfH5EJauSCcaWuTTN5hUwlQceLl9SVBb5zKUtLAYuHF64KuQs7ujYWvAmpIAMdXPiXeY4YyXDGKaS1XS7x1cBtuiErNRwnTsABDHWysCF1m0BHlOOXzP7kVt76VBVFJl7j8wypAxWnHAu1TEu7vNqcZHBY3mK1wG/4Z+qgZD2RK3PbQuVaz+TGtjxERYGgw3nztoSZONXANyvsLDjDYfghmHe4fHcabglcRL5jxvMEzk1t5Mk5rXNrJO7v/AYQmHqWA1KfRAAAAAElFTkSuQmCC"},6857:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("CommonContent",{ref:"commonContent",attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{replicate:function(t){e.mode="replicate"},edit:function(t){e.mode="edit"},unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,audit:function(t){return e.$emit("upsert-end")},"select-version":e.fetchData,delete:function(t){return e.$emit("upsert-end",t)},"submit-audit":e.handleSubmitAudit,"save-draft":e.handleSaveDraft,"cancel-timing":function(t){return e.fetchData(e.form.currentVersion)}}},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),"read"!==e.mode?a("div",[a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"版块名称",prop:"pannelList[0].pannelName"}},[a("el-input",{attrs:{placeholder:"版块名称"},model:{value:e.form.pannelList[0].pannelName,callback:function(t){e.$set(e.form.pannelList[0],"pannelName",t)},expression:"form.pannelList[0].pannelName"}})],1),a("el-form-item",{attrs:{label:"版块标题",prop:"pannelList[0].pannelTitle"}},[a("el-input",{attrs:{placeholder:"版块标题"},model:{value:e.form.pannelList[0].pannelTitle,callback:function(t){e.$set(e.form.pannelList[0],"pannelTitle",t)},expression:"form.pannelList[0].pannelTitle"}}),a("el-checkbox",{staticClass:"marginL",attrs:{value:!e.form.pannelList[0].showTitle},on:{input:function(t){e.form.pannelList[0].showTitle=t?0:1}}},[e._v("前端不显示标题")])],1),a("el-form-item",{attrs:{label:"功能类型",prop:"clientType"}},[a("el-input",{attrs:{placeholder:"功能类型"},model:{value:e.form.clientType,callback:function(t){e.$set(e.form,"clientType",t)},expression:"form.clientType"}})],1),a("el-form-item",{attrs:{label:"内容源",prop:"pannelList[0].pannelResource"}},[a("el-radio",{attrs:{label:""},model:{value:e.form.pannelList[0].pannelResource,callback:function(t){e.$set(e.form.pannelList[0],"pannelResource",t)},expression:"form.pannelList[0].pannelResource"}},[e._v("不限")]),a("el-radio",{attrs:{label:"o_tencent"},model:{value:e.form.pannelList[0].pannelResource,callback:function(t){e.$set(e.form.pannelList[0],"pannelResource",t)},expression:"form.pannelList[0].pannelResource"}},[e._v("腾讯")]),a("el-radio",{attrs:{label:"o_iqiyi"},model:{value:e.form.pannelList[0].pannelResource,callback:function(t){e.$set(e.form.pannelList[0],"pannelResource",t)},expression:"form.pannelList[0].pannelResource"}},[e._v("爱奇艺")]),a("el-radio",{attrs:{label:"o_youku"},model:{value:e.form.pannelList[0].pannelResource,callback:function(t){e.$set(e.form.pannelList[0],"pannelResource",t)},expression:"form.pannelList[0].pannelResource"}},[e._v("优酷")])],1)],1)],1):e._e(),"read"===e.mode?a("div",[a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"版块名称",prop:"pannelList[0].pannelName"}},[e._v(e._s(e.form.pannelList[0].pannelName))]),a("el-form-item",{attrs:{label:"版块标题",prop:"pannelList[0].pannelTitle"}},[e._v(e._s(e.form.pannelList[0].pannelTitle)+e._s(0===e.form.pannelList[0].showTitle?"(前端不显示)":""))]),a("el-form-item",{attrs:{label:"功能类型",prop:"clientType"}},[e._v(e._s(e.form.clientType))]),a("el-form-item",{attrs:{label:"内容源",prop:"pannelList[0].pannelResource"}},[a("el-radio",{attrs:{disabled:!0,label:""},model:{value:e.form.pannelList[0].pannelResource,callback:function(t){e.$set(e.form.pannelList[0],"pannelResource",t)},expression:"form.pannelList[0].pannelResource"}},[e._v("不限")]),a("el-radio",{attrs:{disabled:!0,label:"o_tencent"},model:{value:e.form.pannelList[0].pannelResource,callback:function(t){e.$set(e.form.pannelList[0],"pannelResource",t)},expression:"form.pannelList[0].pannelResource"}},[e._v("腾讯")]),a("el-radio",{attrs:{disabled:!0,label:"o_iqiyi"},model:{value:e.form.pannelList[0].pannelResource,callback:function(t){e.$set(e.form.pannelList[0],"pannelResource",t)},expression:"form.pannelList[0].pannelResource"}},[e._v("爱奇艺")]),a("el-radio",{attrs:{disabled:!0,label:"o_youku"},model:{value:e.form.pannelList[0].pannelResource,callback:function(t){e.$set(e.form.pannelList[0],"pannelResource",t)},expression:"form.pannelList[0].pannelResource"}},[e._v("优酷")])],1)],1)],1):e._e()])],1)],1)},i=[],r=(a("c5f6"),a("c3d5")),o=a("363f"),l={mixins:[o["a"]],components:{CommonContent:r["a"]},props:{id:Number,initMode:String,version:{type:String,default:function(){return""}}},data:function(){var e={draft:2,waiting:3,accepted:4,rejected:5,processing:7};return{STATUS:e,mode:"create",resourceName:"功能版块",showTimeShelf:!1,releaseTime:void 0,form:{parentType:"function",pannelGroupId:void 0,currentVersion:void 0,panelGroupType:8,clientType:"",pannelStatus:void 0,pannelList:[{pannelName:"",pannelType:8,pannelResource:"",pannelTitle:"",showTitle:0,pannelStatus:void 0,pannelCategory:67}]},rules:{"pannelList[0].pannelName":[{required:!0,message:"请输入版块名称",trigger:"blur"}],"pannelList[0].pannelTitle":[{required:!0,message:"请输入版块标题",trigger:"blur"}],clientType:[{required:!0,message:"请输入功能类型",trigger:"blur"}]}}},computed:{resourceInfo:function(){var e=this.form;if(e.pannelGroupId)return{id:e.pannelGroupId,type:"pannel",menuElId:"pannelInfo",version:e.currentVersion,status:e.pannelList[0].pannelStatus}},couldSetReleaseTime:function(){var e=this.mode,t=this.form.currentVersion,a="create"===e||"copy"===e,n="edit"===e&&"V1"===t,i="10"===this.$consts.idPrefix;return i&&!(a||n)}},methods:{handleSubmitAudit:function(e){var t=this,a=this.getFormData();a.pannelList[0].pannelStatus=this.$consts.status.waiting,this.validateFormData(a,function(){t.couldSetReleaseTime?e?(a.isTiming=e.isTiming,a.releaseTime=e.releaseTime,t.submit(a)):t.$refs.commonContent.showReleaseTimeSetter=!0:t.submit(a)})},handleSaveDraft:function(){var e=this.getFormData();e.isTiming=void 0,e.releaseTime=void 0,e.pannelList[0].pannelStatus=this.$consts.status.draft,this.validateFormData(e,function(){this.submit(e)}.bind(this))},getFormData:function(){var e=JSON.parse(JSON.stringify(this.form)),t=this.mode;return"replicate"===t&&(e.currentVersion=""),"copy"===t&&(e.tabId=void 0,e.currentVersion=""),e},submit:function(e){var t=this,a=JSON.stringify(e);this.$service.MarkPanelSave({jsonStr:a},"保存成功").then(function(e){t.$emit("upsert-end")})},validateFormData:function(e,t){var a=this;this.$refs.form.validate(function(e){e?t():a.$message({type:"error",message:"请把表单填写完整"})})},fetchData:function(e){var t=this;this.$service.getViewData({id:this.id,version:e}).then(function(a){t.form=a,""!==e&&void 0!==e&&t.$service.getTimedInfo({id:t.id,version:e,type:"pannel"}).then(function(e){t.releaseTime=e.releaseTime})})}},created:function(){this.mode=this.initMode||"create",this.id&&this.fetchData(this.version)}},s=l,c=(a("693c"),a("2877")),u=Object(c["a"])(s,n,i,!1,null,"3e8981f0",null);t["a"]=u.exports},6871:function(e,t,a){"use strict";var n=a("6a34"),i=a.n(n);i.a},"693c":function(e,t,a){"use strict";var n=a("b652"),i=a.n(n);i.a},"6a1e":function(e,t,a){},"6a34":function(e,t,a){},"6a5b":function(e,t,a){"use strict";var n=a("885a"),i=a.n(n);i.a},"6a62":function(e,t,a){},"6a79":function(e,t,a){},"6a8c":function(e,t,a){"use strict";var n=a("d816"),i=a.n(n);i.a},"6aa1":function(e,t,a){},"6b22":function(e,t,a){"use strict";var n=a("aaed"),i=a.n(n);i.a},7087:function(e,t,a){},7255:function(e,t,a){"use strict";var n=a("3397"),i=a.n(n);i.a},7278:function(e,t,a){},7289:function(e,t,a){"use strict";var n=a("9eec"),i=a.n(n);i.a},"72f0":function(e,t,a){},"741b":function(e,t,a){"use strict";var n=a("e455"),i=a.n(n);i.a},7443:function(e,t,a){},"748c":function(e,t,a){"use strict";var n=a("5663"),i=a.n(n);i.a},7637:function(e,t,a){},"76f3":function(e,t,a){"use strict";var n=a("66790"),i=a.n(n);i.a},7704:function(e,t,a){},"782b":function(e,t,a){},"7b2c":function(e,t,a){},"7b32":function(e,t,a){"use strict";var n=a("33c9"),i=a.n(n);i.a},"7b7d":function(e,t,a){},"7b88":function(e,t,a){"use strict";var n=a("1fff"),i=a.n(n);i.a},"7c48":function(e,t,a){},"7c65":function(e,t,a){"use strict";var n=a("8884"),i=a.n(n);i.a},"7ca1":function(e,t,a){},"7d45":function(e,t,a){"use strict";var n=a("ec14"),i=a.n(n);i.a},"7e20":function(e,t,a){},"7e3c":function(e,t,a){"use strict";var n=a("afe2"),i=a.n(n);i.a},"7e4f":function(e,t,a){},"7ef0":function(e,t,a){"use strict";var n=a("31b7"),i=a.n(n);i.a},"7efd":function(e,t,a){e.exports=a.p+"img/logo-jscn.b9c445d9.png"},8108:function(e,t,a){"use strict";var n=a("c3e0"),i=a.n(n);i.a},8133:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:{"cc-virtual-pannel":!0,"cc-virtual-pannel--show-title":e.showTitle},style:e.pannelStyle},e._l(e.blockItems,function(t,n){return a("div",{key:t.content.vContentId+"-"+n},[a("el-popover",{attrs:{placement:"top",trigger:"hover",disabled:!e.showPopover,"popper-class":"show-chart-popper"}},[e.showChartBtn?a("div",[-101!=e.blocks[n].vcId?a("BlockStatChartViewer",{attrs:{"panel-group":e.panelGroup,"panel-index":e.panelIndex,"block-index":n}},[a("el-button",{staticClass:"popover-tool-btn",attrs:{type:"success"}},[e._v("\n              整体数据\n            ")])],1):e._e()],1):e._e(),e.showExchangeTool?a("div",[a("el-button",{staticClass:"popover-tool-btn",class:e.disableExchangeTool?"is-disabled el-button--disabled":"",attrs:{type:"warning"},on:{click:function(t){return t.stopPropagation(),e.$emit("copy-block",n)}}},[e._v("\n            复制\n          ")]),a("el-button",{staticClass:"popover-tool-btn",class:e.disableExchangeTool?"is-disabled el-button--disabled":"",attrs:{type:"warning"},on:{click:function(t){return t.stopPropagation(),e.$emit("exchange-block",n)}}},[e._v("\n            交换\n          ")])],1):e._e(),e.showPostUpdater?a("div",[a("PostUpdater",{staticClass:"popover-tool-btn",attrs:{vid:e.getVid(t),disabled:e.isDisablePostUpdater(t)},on:{"update-post-end":function(t){return e.$emit("update-post-end")}}})],1):e._e(),a("div",{class:{"cc-virtual-pannel__block":!0,"cc-virtual-pannel__block--duplicated":t.duplicated},style:t.style,attrs:{slot:"reference",draggable:e.draggable},on:{dragstart:function(t){return e.handleDragStart(n,t)},dragover:function(t){return e.handleDragOver(n,t)},drop:e.handleDrop,click:function(t){return e.handleClickBlock(n)}},slot:"reference"},[t.img?a("img",{key:t.img,staticClass:"cc-virtual-pannel__block-post",attrs:{referrerpolicy:"no-referrer",loading:"lazy",src:t.img}}):e._e(),e._l(t.cornerList,function(t,n){return[t.imgUrl?a("img",{key:n,staticClass:"corner-img",style:{position:"absolute",top:0===t.position||1===t.position?0:void 0,buttom:2===t.position||3===t.position?0:void 0,left:0===t.position||3===t.position?0:void 0,right:1===t.position||2===t.position?0:void 0},attrs:{referrerpolicy:"no-referrer",loading:"lazy",src:t.imgUrl}}):e._e()]}),a("div",{staticClass:"cc-virtual-pannel__block-base-info"},[a("span",{staticClass:"seq-num"},[e._v(e._s(t.content.vContentId||n+1))]),a("span",{staticClass:"size-mark"},[e._v(e._s(t.width)+"*"+e._s(t.height))])]),t.isExtra&&!e.isNotExtra?a("span",{staticClass:"cc-virtual-pannel__block-remove",on:{click:function(t){return t.stopPropagation(),e.handleRemoveBlock(n)}}},[e._v("x")]):e._e(),t.content?[t.content.secKillPrice>0?a("div",{staticClass:"specialSamll cc-virtual-pannel__block-price",attrs:{name:"smallPrice"}},[a("span",{staticClass:"sec-kill-price"},[e._v("￥"+e._s(e.fixPrice(t.content.secKillPrice)))]),a("span",[e._v("￥"+e._s(e.fixPrice(t.content.price)))])]):t.content.price>0?a("div",{staticClass:"specialSamll cc-virtual-pannel__block-price",attrs:{name:"smallPrice"}},[a("span",[e._v("￥"+e._s(e.fixPrice(t.content.price)))])]):e._e(),e.showTitle?a("div",{staticClass:"cc-virtual-pannel__title",attrs:{title:t.content.title}},[e._v(e._s(t.content.title))]):e._e()]:e._e()],2)]),t.titleStyle?a("div",{staticClass:"cc-virtual-pannel__block-title",style:t.titleStyle,attrs:{title:t.content.title}},[e._v(e._s(t.content.title||"title"))]):e._e()],1)}),0)},i=[],r=(a("c5f6"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.panelGroup?a("div",{staticClass:"chart-viewer"},[a("div",{on:{click:e.handleShowChart}},[e._t("default")],2),e.mountDialog?a("AnalyzeSimpleDataDialog",{attrs:{show:e.showChart,parentId:e.panelGroup.pannelGroupId,position:e.position,isRealTime:e.isRealTime},on:{"update:show":function(t){e.showChart=t}}}):e._e()],1):e._e()}),o=[],l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.visible,show:e.show,width:"70%","append-to-body":!0},on:{"update:visible":function(t){e.visible=t},close:function(t){return e.$emit("update:show",!1)},open:e.fetchData}},[e.isShowLoadTip?a("div",{staticClass:"loading-text"},[e._v("数据搬运中，请稍候。。。")]):e._e(),e._l(e.chartDataArr,function(t,n){return a("div",{key:n},[a("div",{staticClass:"chart-box--title"},[e._v(e._s(t.title))]),a("VeLine",{attrs:{data:e.handleChartData(t),"legend-visible":!1,extend:e.handleChartExtend(t),settings:e.handleChartSettings(t),events:e.handleChartEvents(n),"mark-line":e.markLine,"mark-point":e.markPoint}})],1)})],2),a("el-dialog",{staticClass:"extra-dia",attrs:{title:"推荐位标题变化",visible:e.extraVisible,"append-to-body":!0,width:"30%"},on:{"update:visible":function(t){e.extraVisible=t}}},e._l(e.extraArr,function(t,n){return a("p",{key:n},[e._v(e._s(t))])}),0)],1)},s=[],c=(a("20d6"),a("95a8"),a("db0e"),a("c3da")),u=a.n(c),d={components:{VeLine:u.a},data:function(){return this.extend={grid:{top:"10%",left:"5%",right:"5%",bottom:"10%",containLabel:!0},series:function(e){return e[0].smooth=!1,e},xAxis:{triggerEvent:!0,axisLabel:{rotate:45,formatter:function(e){var t=e.indexOf("(");if(-1===t)return e;var a=e.slice(t-e.length),n=e.slice(0,t);return["{a|".concat(a,"}"),n].join("")},rich:{a:{color:"red"}}}},color:["#1E90FF ","#2f4554"]},this.markLine={data:[{name:"平均线",type:"average"}]},this.markPoint={data:[{name:"最大值",type:"max"},{name:"最小值",type:"min"}]},{visible:this.show,chartDataArr:[],extraVisible:!1,extraArr:[],isShowLoadTip:!1,cacheParentId:void 0,cachePosition:void 0,cacheIsRealTime:void 0}},watch:{show:function(){this.visible=this.show}},computed:{dialogTitle:function(){return this.isRealTime?"看整体实时数据":"看整体数据"}},props:{show:{type:Boolean,default:function(){return!1}},parentId:Number,position:[String,Number],isRealTime:{type:Boolean,default:function(){return!1}}},methods:{fetchData:function(){var e=this,t=this.cacheParentId,a=this.cachePosition,n=this.cacheIsRealTime,i=this.parentId,r=this.position,o=this.isRealTime;if(t!==i||a!==r||n!==o){this.cacheParentId=i,this.cachePosition=r,this.cacheIsRealTime=o,this.chartDataArr=[],this.isShowLoadTip=!0;var l=this.isRealTime?"getVideoRealTimeChartData":"getVideoChartData";this.$service[l]({parentId:i,position:r}).then(function(t){e.isShowLoadTip=!1,e.chartDataArr=t.rows,0===e.chartDataArr.length&&e.$message("暂无数据")})}},handleChartData:function(e){return{title:e.title,unit:e.unit,columns:["x","y"],rows:e.data}},handleChartExtend:function(e){var t={axisLabel:{formatter:"{value}%"}},a=Object.assign({},this.extend);return"%"===e.unit?Object.assign(a,{yAxis:t}):a},handleChartSettings:function(e){return{labelMap:{y:e.title}}},handleChartEvents:function(e){var t=this;return{click:function(a){if("xAxis"===a.componentType){var n=t.chartDataArr[e].data.findIndex(function(e){return e.x===a.value}),i=t.chartDataArr[e].data[n].extra;i&&0!==i.length?(t.$sendEvent({type:"panel_chart_version_show"}),t.extraArr=i,t.extraVisible=!0):t.$message({message:"暂无推荐位标题变化数据哦！",type:"warning"})}}}}},created:function(){}},p=d,h=(a("02ab"),a("2877")),m=Object(h["a"])(p,l,s,!1,null,"906244ce",null),f=m.exports,v={components:{AnalyzeSimpleDataDialog:f},props:["panelGroup","panelIndex","blockIndex","isRealTime"],data:function(){return{mountDialog:!1,showChart:!1}},computed:{panelGroupId:function(){return this.panelGroup.pannelGroupId},position:function(){var e=this.panelGroup,t=this.panelIndex,a=this.blockIndex;return"group"===e.parentType?t+"-"+a:a}},methods:{handleShowChart:function(){var e=this;this.mountDialog||(this.mountDialog=!0),this.$nextTick(function(){e.showChart=!0,e.$sendEvent({type:"block_data_show",payload:{type:"position"}})})}}},g=v,b=(a("c67e"),Object(h["a"])(g,r,o,!1,null,"527eb7ca",null)),y=b.exports,w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.panelGroup?a("div",{staticClass:"chart-viewer"},[a("div",{on:{click:e.handleShowChart}},[e._t("default")],2),e.mountDialog?a("AnalyzeDmpDataDialog",{attrs:{show:e.showChart,parentId:e.panelGroup.pannelGroupId,position:e.position,isRealTime:e.isRealTime},on:{"update:show":function(t){e.showChart=t}}}):e._e()],1):e._e()},I=[],C=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.visible,"append-to-body":!0,show:e.show,width:"70%"},on:{"update:visible":function(t){e.visible=t},open:e.handleDialogOpen,close:function(t){return e.$emit("update:show",!1)}}},[a("el-form",{staticClass:"filter-form",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"推荐位标题"}},[a("el-select",{attrs:{filterable:"",clearable:""},on:{change:e.handleSelectTitle},model:{value:e.filter.title,callback:function(t){e.$set(e.filter,"title",t)},expression:"filter.title"}},e._l(e.allTitles,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})}),1)],1),a("el-form-item",{attrs:{label:"人群"}},[a("el-select",{attrs:{filterable:"",clearable:""},model:{value:e.filter.crowdId,callback:function(t){e.$set(e.filter,"crowdId",t)},expression:"filter.crowdId"}},e._l(e.allCrowd,function(e,t){return a("el-option",{key:t,attrs:{label:e.crowdName,value:e.crowdId}})}),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.fetchData}},[e._v("查询")])],1)],1),e.isShowLoadTip?a("div",{staticClass:"loading-text"},[e._v("数据搬运中，请稍候。。。")]):e._e(),e._l(e.chartDataArr,function(t,n){return a("div",{key:n,staticClass:"chart--wrapper"},[a("div",{staticClass:"chart-box--title"},[e._v(e._s(t.title))]),a("VeLine",{attrs:{data:e.handleChartData(t),"legend-visible":!1,extend:e.handleChartExtend(t),settings:e.handleChartSettings(t),events:e.handleChartEvents(n),"mark-line":e.markLine,"mark-point":e.markPoint}})],1)})],2),a("el-dialog",{staticClass:"extra-dia",attrs:{title:"推荐位标题变化",visible:e.extraVisible,"append-to-body":!0,width:"30%"},on:{"update:visible":function(t){e.extraVisible=t}}},e._l(e.extraArr,function(t,n){return a("p",{key:n},[e._v(e._s(t))])}),0)],1)},T=[],S=a("cebc"),k={components:{VeLine:u.a},data:function(){return this.extend={grid:{top:"10%",left:"5%",right:"5%",bottom:"10%",containLabel:!0},series:function(e){return e[0].smooth=!1,e},xAxis:{axisLabel:{rotate:45,formatter:function(e){var t=e.indexOf("(");if(-1===t)return e;var a=e.slice(t-e.length),n=e.slice(0,t);return["{a|".concat(a,"}"),n].join("")},rich:{a:{color:"red"}}}},color:["#1E90FF ","#2f4554"]},this.markLine={data:[{name:"平均线",type:"average"}]},this.markPoint={data:[{name:"最大值",type:"max"},{name:"最小值",type:"min"}]},{visible:this.show,chartDataArr:[],extraVisible:!1,extraArr:[],allTitles:[],allCrowd:[],filter:{title:"",crowdId:""},isShowLoadTip:!1,cacheParentId:void 0,cachePosition:void 0,cacheIsRealTime:void 0}},watch:{show:function(){this.visible=this.show}},computed:{dialogTitle:function(){return this.isRealTime?"DMP实时数据":"DMP"}},props:{show:{type:Boolean,default:function(){return!1}},parentId:Number,position:[String,Number],isRealTime:{type:Boolean,default:function(){return!1}}},methods:{handleDialogOpen:function(){var e=this;this.filter={title:"",crowdId:""},this.allCrowd=[];var t=this.parentId,a=this.position,n=this.isRealTime,i=this.cacheParentId,r=this.cachePosition,o=this.cacheIsRealTime;i===t&&r===a&&o===n||(this.cacheParentId=t,this.cachePosition=a,this.cacheIsRealTime=n,this.chartDataArr=[],this.$service.getVideoDmpTitles({parentId:t,position:a}).then(function(t){e.allTitles=t.rows}))},fetchData:function(){var e=this;this.isShowLoadTip=!0,this.chartDataArr=[];var t=this.parentId,a=this.position,n=this.filter,i=this.isRealTime?"getVideoDmpRealTimeChartData":"getVideoDmpChartData";this.$service[i](Object(S["a"])({parentId:t,position:a},n)).then(function(t){e.isShowLoadTip=!1,e.chartDataArr=t.rows,0===e.chartDataArr.length&&e.$message("暂无数据")})},handleChartData:function(e){return{title:e.title,unit:e.unit,columns:["x","y"],rows:e.data}},handleChartExtend:function(e){var t={axisLabel:{formatter:"{value}%"}},a=Object.assign({},this.extend);return"%"===e.unit?Object.assign(a,{yAxis:t}):a},handleChartSettings:function(e){return{labelMap:{y:e.title}}},handleSelectTitle:function(e){var t=this;this.filter.crowdId=void 0;var a=this.parentId,n=this.position,i=this.filter;this.$service.getVideoDmpCrowds({parentId:a,position:n,title:i.title}).then(function(e){t.allCrowd=e.rows})},handleChartEvents:function(e){var t=this;return{click:function(a){if("xAxis"===a.componentType){var n=t.chartDataArr[e].data.findIndex(function(e){return e.x===a.value}),i=t.chartDataArr[e].data[n].extra;i&&0!==i.length&&(t.$sendEvent({type:"album_version_show"}),t.extraArr=i,t.extraVisible=!0)}}}}},created:function(){}},_=k,P=(a("d7bf"),Object(h["a"])(_,C,T,!1,null,"081fa6d0",null)),x=P.exports,F={components:{AnalyzeDmpDataDialog:x},props:["panelGroup","panelIndex","blockIndex","isRealTime"],data:function(){return{mountDialog:!1,showChart:!1}},computed:{panelGroupId:function(){return this.panelGroup.pannelGroupId},position:function(){var e=this.panelGroup,t=this.panelIndex,a=this.blockIndex;return"group"===e.parentType?t+"-"+a:a}},methods:{handleShowChart:function(){var e=this;this.mountDialog||(this.mountDialog=!0),this.$nextTick(function(){e.showChart=!0,e.$sendEvent({type:"block_data_show",payload:{type:"dmp"}})})}}},D=F,R=(a("33c1"),Object(h["a"])(D,w,I,!1,null,"864cefe0",null)),L=R.exports,$=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{on:{click:e.handleShowDialog}},[e._t("default",[a("el-button",{attrs:{type:"success",disabled:e.disabled}},[e._v("更换海报")])])],2),e.isShowDialog?a("FrameDialog",{attrs:{url:e.url,fullscreen:!0,"frame-style":{padding:"0 20px"}},on:{close:e.handleUpdatePostEnd}},[a("div",{attrs:{slot:"title"},slot:"title"},[a("span",[e._v("更换海报")]),a("el-button",{staticClass:"close-btn",attrs:{size:"mini"},on:{click:e.handleUpdatePostEnd}},[e._v("关闭")])],1)]):e._e()],1)},N=[],E=(a("28a5"),a("477b")),O={components:{FrameDialog:E["a"]},props:["vid","disabled"],data:function(){return{mountedDialg:!1,isShowDialog:!1}},computed:{videoInfo:function(){var e=this.vid.split("_")||[],t=e.slice(2).join("_"),a=e[e.length-2],n={otx:"tencent",oqy:"yinhe",oyk:"youku"},i=n[a]?n[a]:"";return{id:t,partner:i}},url:function(){var e=this.videoInfo,t=e.id,a=e.partner,n=/^(127|172|beta)/.test(location.host)?"http://dev-mgr-media.tc.cc0808.com":"http://mgrnew.media.tc.skysrt.com";return n+"/#/ownMediaResManage/homeView.html?coocaaVId=".concat(t,"&partner=").concat(a)}},methods:{handleShowDialog:function(){var e=this,t=this.videoInfo;if(!t.id)return this.$message.error("该影片id不符合规则，无法更换");this.disabled||(this.mountedDialg=!0,this.$nextTick(function(){e.isShowDialog=!0}))},handleUpdatePostEnd:function(){this.isShowDialog=!1,this.$emit("update-post-end")}},created:function(){}},A=O,V=(a("3731"),Object(h["a"])(A,$,N,!1,null,"a5d3f60c",null)),B=V.exports,M={template:"#cc-virtual-panel",components:{BlockStatChartViewer:y,BlockStatDmpChartViewer:L,PostUpdater:B},data:function(){return{blockItems:[],pannelStyle:{},dragIndex:void 0,dropIndex:void 0}},props:["panelGroup","panelIndex","blocks","ratio","draggable","showTitle","mode","showChartBtn","showExchangeTool","showPostUpdater","disableExchangeTool","isNotExtra"],computed:{showPopover:function(){return this.showChartBtn||this.showExchangeTool||this.showPostUpdater}},watch:{blocks:"computeBlockItems"},methods:{isDisablePostUpdater:function(e){var t=this.getVid(e);return!t||e.isInterveneBlock},getVid:function(e){var t=e.content.extraValue1;return t},handleDragStart:function(e){this.dragIndex=e},handleDragOver:function(e,t){this.dropIndex=e,t.preventDefault()},handleDrop:function(){var e=this.dragIndex,t=this.dropIndex;void 0!==e&&void 0!==t&&(this.$emit("drag",e,t),this.dragIndex=this.dropIndex=void 0)},handleRemoveBlock:function(e){this.$emit("remove-block",e)},handleAnalyzeSimpleData:function(e,t){this.$emit("show-simple-chart",{index:e,isRealTime:t})},handleAnalyzeDmpData:function(e,t){this.$emit("show-dmp-chart",{index:e,isRealTime:t})},handleClickBlock:function(e){this.$emit("click-block",e)},fixPrice:function(e){return Number((e/100).toFixed(2))},computeBlockItems:function(){var e=this.blocks||[];if(0===e.length)return this.blockItems=[],void(this.pannelStyle={height:0});var t=this.ratio||.5,a=this.blocks.map(function(e){var a={title:e.title,isExtra:e.isExtra,isInterveneBlock:e.isInterveneBlock,duplicated:e.duplicated,specificContentList:e.specificContentList},n=e.contentPosition,i=e.resize||{},r=e.videoContentList||[],o=r[0]||{},l=e.titleInfo,s=i.y||n.y,c=i.x||n.x,u=n.height,d=n.width;a.top=s,a.left=c,a.height=u,a.width=d,a.style={top:s*t+"px",left:c*t+"px",height:u*t+"px",width:d*t+"px"};var p=o.pictureUrl;if(p){var h="block/sign.png";a.img="/themes/images/block/sign.png"===p?h:p}if(l){var m=l.width,f=l.height;a.titleStyle={top:(s+u)*t+"px",left:c*t+"px",width:m*t+"px",height:f*t+"px","line-height":f*t+"px"}}return a.content=o,a.cornerList=a.content.cornerList||[],a}),n=a[a.length-1],i=n.style,r=n.titleStyle||{},o=parseFloat(i.top)+parseFloat(i.height)+parseFloat(r.height||0)+"px";this.pannelStyle={height:o},this.blockItems=a},isOverFlow:function(e){var t=parseFloat(e.height.slice(0,-2));return t>96}},created:function(){this.computeBlockItems()}},U=M,G=(a("cf43"),a("8775"),Object(h["a"])(U,n,i,!1,null,"5e2bb3f1",null));t["a"]=G.exports},"81e3":function(e,t,a){"use strict";var n=a("dc28"),i=a.n(n);i.a},8232:function(e,t,a){"use strict";var n=a("7e20"),i=a.n(n);i.a},8297:function(e,t,a){"use strict";var n=a("439e"),i=a.n(n);i.a},"82dc":function(e,t,a){},8353:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("remote-selector-wrapper",{ref:"dialog",staticClass:"cc-tab-selector",attrs:{title:e.title||"选择版面",disabled:e.disabled,"hide-submit":e.selectedClose},on:{"select-start":e.handleSelectStart,"select-end":e.handleSelectEnd}},[a("div",{attrs:{slot:"filter"},slot:"filter"},[a("el-form",{attrs:{inline:!0},nativeOn:{submit:function(t){return t.preventDefault(),e.handleFilterChange(t)},reset:function(t){return t.preventDefault(),e.handleFilterReset(t)}}},[a("el-form-item",[a("el-input",{attrs:{clearable:"",placeholder:"ID",title:"ID"},model:{value:e.filter.tabId,callback:function(t){e.$set(e.filter,"tabId",t)},expression:"filter.tabId"}})],1),a("el-form-item",{staticStyle:{width:"220px"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{clearable:"",placeholder:"版面名称",title:"版面名称"},model:{value:e.filter.tabName,callback:function(t){e.$set(e.filter,"tabName",t)},expression:"filter.tabName"}})],1),a("el-form-item",[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"版面分类",title:"版面分类"},model:{value:e.filter.tabCategory,callback:function(t){e.$set(e.filter,"tabCategory",t)},expression:"filter.tabCategory"}},e._l(e.tabCategoryOptions,function(e,t){return a("el-option",{key:t,attrs:{value:e.dictId,label:e.dictCnName}})}),1)],1),2!==e.oneOption?[a("el-form-item",[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"版面属性",title:"版面属性"},model:{value:e.filter.tabType,callback:function(t){e.$set(e.filter,"tabType",t)},expression:"filter.tabType"}},e._l(e.tabTypeOptions,function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})}),1)],1)]:e._e(),void 0===e.source?a("el-form-item",[a("SourceSelector",{attrs:{placeholder:"内容源",title:"内容源"},model:{value:e.filter.tabResource,callback:function(t){e.$set(e.filter,"tabResource",t)},expression:"filter.tabResource"}})],1):e._e(),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"10"!=e.$consts.idPrefix,expression:"$consts.idPrefix != '10'"}]},[a("el-select",{attrs:{placeholder:"数据来源",title:"数据来源"},model:{value:e.filter.idPrefix,callback:function(t){e.$set(e.filter,"idPrefix",t)},expression:"filter.idPrefix"}},e._l(e.$consts.idPrefixOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{staticClass:"el-form-item-submit"},[a("el-button",{attrs:{type:"primary","native-type":"submit"}},[e._v("查询")]),a("el-button",{attrs:{"native-type":"reset"}},[e._v("重置")])],1)],2)],1),a("Table",{attrs:{slot:"item-list",data:e.table.data,header:e.table.header,selected:e.table.selected,props:e.table.props,"selection-type":e.selectionType||e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-change":e.handleSingleRow,"row-selection-add":e.handleTableRowSelectionAdd,"row-selection-remove":e.handleTableRowSelectionRemove,"all-row-selection-change":e.handleTableAllRowSelectionChange},slot:"item-list"}),a("el-pagination",{attrs:{slot:"pagination","current-page":e.pagination.currentPage,"page-sizes":[15,20,30],"page-size":e.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pagination.total},on:{"size-change":function(t){e.pagination.pageSize=t},"current-change":function(t){e.pagination.currentPage=t}},slot:"pagination"})],1)},i=[],r=(a("ac6a"),a("59c7")),o=a("5076"),l=a("4c36"),s="tabId",c=[{label:"普通版面",value:"1"},{label:"专题版面",value:"2"},{label:"标记版面",value:"12"},{label:"第三方版面",value:"4"},{label:"分页专题版面",value:"13"}],u=c.reduce(function(e,t){return e[t.value]=t.label,e},{}),d={components:{Table:r["Table"],RemoteSelectorWrapper:o["a"],SourceSelector:l["a"]},data:function(){return{tabTypeOptions:c,tabTypeIndexed:u,tabCategoryOptions:[],tabCategoryOptionsIndexed:{},tabStatusOptions:[{label:"待审核",value:3},{label:"审核通过",value:4}],tabResourceOptions:[{label:"腾讯",value:"o_tencent"},{label:"爱奇艺",value:"o_iqiyi"}],tabStatusOptionsIndexed:{3:"待审核",4:"审核通过"},pagination:{currentPage:1,pageSize:15,total:void 0},filter:this.getDefaultFilter(),table:{data:[],selected:[],header:[{label:"ID",prop:"tabId",width:120},{label:"名称",prop:"tabName","show-overflow-tooltip":!0,width:200},{label:"版面属性",width:120,render:function(e,t){return this.tabTypeIndexed[t.row.tabType]}.bind(this)},{label:"版面分类",width:150,render:function(e,t){return this.tabCategoryOptionsIndexed[t.row.tabCategory]}.bind(this)},{label:"状态",render:function(e,t){return this.tabStatusOptionsIndexed[t.row.tabStatus]}.bind(this)},{prop:"lastUpdateDate",label:"更新时间",width:190},{prop:"modifierName",label:"更新人",width:120}],selectionType:"multiple",props:{"tooltip-effect":"dark"}},selected:[]}},props:["title","isLive","initSelected","source","hasSubTab","selectionType","disabled","selectedClose","oneOption"],watch:{initSelected:"setSelected","pagination.currentPage":"fetchData","pagination.pageSize":"fetchData","table.data":"updateTableSelected"},methods:{handleSingleRow:function(e,t){this.$refs.dialog.showDialog=!1,this.table.selected=t,this.$emit("select-end",e)},setSelected:function(){this.selected=this.initSelected||[]},handleSelectStart:function(){this.$emit("select-start"),this.isLive||(this.table.data=[],this.selected=[],this.table.selected=[],this.handleFilterReset())},handleSelectEnd:function(){this.$emit("select-end",this.selected.slice())},getDefaultFilter:function(){var e=this.$consts.idPrefix;return{idPrefix:"10"!==e?e:void 0,tabId:void 0,tabName:void 0,tabCategory:void 0,tabType:this.oneOption,tabStatusArray:void 0,tabResource:void 0}},handleFilterChange:function(){this.$validateId(this.filter.tabId)&&(this.pagination.currentPage=1,this.fetchData())},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.pagination.currentPage=1,this.handleFilterChange()},getFilter:function(){var e=JSON.parse(JSON.stringify(this.filter)),t=this.pagination;return e.page=t.currentPage,e.rows=t.pageSize,2===this.oneOption&&(e.tabType=2),e.tabStatusArray||(e.tabStatusArray="4"),void 0!==this.hasSubTab&&(e.hasSubTab=this.hasSubTab),this.source&&(e.tabResource=this.source),e},fetchData:function(){var e=this;this.$service.tabInfoDataList(this.getFilter()).then(function(t){e.table.data=t.rows,e.pagination.total=t.total})},handleTableRowSelectionChange:function(e,t){this.selected=[e],this.table.selected=t},handleTableRowSelectionAdd:function(e){this.selected=this.selected.concat(e),this.updateTableSelected()},handleTableRowSelectionRemove:function(e){this.selected=this.selected.filter(function(t){return t[s]!==e[s]}),this.updateTableSelected()},handleTableAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleTableRowSelectionAdd):this.table.data.forEach(this.handleTableRowSelectionRemove)},updateTableSelected:function(){var e=this.table,t=this.selected.map(function(e){return e[s]});e.selected=e.data.reduce(function(e,a,n){return t.indexOf(a[s])>-1&&e.push(n),e},[])}},created:function(){var e=this;this.$service.getDictType({type:"businessType"}).then(function(t){e.tabCategoryOptions=t,e.tabCategoryOptionsIndexed=t.reduce(function(e,t){return e[t.dictId]=t.dictCnName,e},{})})}},p=d,h=(a("a7e7"),a("2877")),m=Object(h["a"])(p,n,i,!1,null,"5d0c3e1b",null);t["a"]=m.exports},8390:function(e,t,a){},"83ac":function(e,t,a){"use strict";var n=a("5fd1"),i=a.n(n);i.a},8470:function(e,t,a){},8490:function(e,t,a){},"861b":function(e,t,a){},8629:function(e,t,a){"use strict";var n=a("43a1"),i=a.n(n);i.a},"86d7":function(e,t,a){},8715:function(e,t,a){},87281:function(e,t,a){"use strict";var n=a("98e7b"),i=a.n(n);i.a},8775:function(e,t,a){"use strict";var n=a("5e39"),i=a.n(n);i.a},"87d4":function(e,t,a){e.exports=a.p+"img/file.dc19d61e.png"},"885a":function(e,t,a){},8873:function(e,t,a){},8884:function(e,t,a){},"88fe":function(e,t,a){"use strict";var n=a("e23c"),i=a.n(n);i.a},8924:function(e,t,a){"use strict";var n=a("c0e4"),i=a.n(n);i.a},8979:function(e,t,a){},"8b43":function(e,t,a){"use strict";var n=a("dde4"),i=a.n(n);i.a},"8bc3":function(e,t,a){},"8bca":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-input-number",{staticClass:"input-hour",attrs:{"controls-position":"right",precision:0,min:0,max:e.hourMax,value:e.hour},on:{input:e.handleInputHour}}),e._v(" 小时\n  "),a("el-input-number",{staticClass:"input-minute",attrs:{"controls-position":"right",precision:0,min:0,max:e.minMax,value:e.minute},on:{input:e.handleInputMinute}}),e._v(" 分钟\n")],1)},i=[],r={data:function(){return{inited:!1,hour:0,minute:0}},computed:{hourMax:function(){return this.max?Math.floor(this.max/60):24},minMax:function(){return this.max<60?this.max:59}},props:["value","max","min"],methods:{handleInputMinute:function(e){var t=60*this.hour+e;return t>this.max?this.setHourAndMinute(this.max):t<this.min?this.setHourAndMinute(this.min):(this.minute=e,void this.emitInput(t))},handleInputHour:function(e){var t=60*e+this.minute;return t>this.max?this.setHourAndMinute(this.max):t<this.min?this.setHourAndMinute(this.min):(this.hour=e,void this.emitInput(t))},setHourAndMinute:function(e){var t=this;e&&this.$nextTick(function(){t.hour=Math.floor(e/60),t.minute=e%60})},emitInput:function(e){this.inited&&this.$emit("input",e)}},mounted:function(){this.$watch("value",this.setHourAndMinute,{immediate:!0}),this.inited=!0}},o=r,l=(a("8b43"),a("2877")),s=Object(l["a"])(o,n,i,!1,null,"e3a9ce54",null);t["a"]=s.exports},"8d27":function(e,t,a){},"8f40":function(e,t,a){"use strict";var n=a("377a"),i=a.n(n);i.a},"8f58":function(e,t,a){"use strict";var n=a("d813"),i=a.n(n);i.a},9002:function(e,t,a){},"90f9":function(e,t,a){"use strict";var n=a("9460"),i=a.n(n);i.a},9311:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("RemoteSelectorWrapper",{ref:"wrapper",attrs:{title:"选择版块","custom-class":"resource-selector"},on:{"select-start":e.handleSelectStart},scopedSlots:e._u([{key:"content",fn:function(t){var n=t.isShow;return[e.isLive||n?a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"pannelGroupId","is-live":e.isLive,"selection-type":e.selectionType,table:e.table,pagination:e.pagination},on:{"pagination-change":e.fetchData,"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}},[a("el-form",{attrs:{slot:"filter",inline:!0},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.handleFilterChange(t))}},slot:"filter",model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("el-form-item",[a("el-select",{attrs:{filterable:"",placeholder:"类型"},model:{value:e.filter.pannelType,callback:function(t){e.$set(e.filter,"pannelType",t)},expression:"filter.pannelType"}},[a("el-option",{attrs:{value:1,label:"内容版块"}}),a("el-option",{attrs:{value:3,label:"专辑版块"}}),a("el-option",{attrs:{value:5,label:"专属影院版块"}})],1)],1),a("el-form-item",[a("InputPositiveInt",{attrs:{clearable:"",placeholder:"版块ID"},model:{value:e.filter.pannelId,callback:function(t){e.$set(e.filter,"pannelId",t)},expression:"filter.pannelId"}})],1),a("el-form-item",[a("el-input",{attrs:{clearable:"",placeholder:"版块名称"},model:{value:e.filter.pannelName,callback:function(t){e.$set(e.filter,"pannelName",t)},expression:"filter.pannelName"}})],1),a("el-form-item",[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"业务分类"},model:{value:e.filter.pannelCategory,callback:function(t){e.$set(e.filter,"pannelCategory",t)},expression:"filter.pannelCategory"}},e._l(e.panelCategoryOptions,function(e,t){return a("el-option",{key:t,attrs:{disabled:e.disabled,value:e.value,label:e.label}})}),1)],1),a("el-form-item",[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"状态"},model:{value:e.filter.pannelStatus,callback:function(t){e.$set(e.filter,"pannelStatus",t)},expression:"filter.pannelStatus"}},e._l(e.$consts.statusOptions,function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})}),1)],1),a("el-form-item",[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"版块组类型"},model:{value:e.filter.parentType,callback:function(t){e.$set(e.filter,"parentType",t)},expression:"filter.parentType"}},e._l(e.parentTypeOptions,function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})}),1)],1),a("el-form-item",[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"版块内容来源"},model:{value:e.filter.fillType,callback:function(t){e.$set(e.filter,"fillType",t)},expression:"filter.fillType"}},e._l(e.fillTypeOptions,function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})}),1)],1),a("el-form-item",[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"数据来源"},model:{value:e.filter.idPrefix,callback:function(t){e.$set(e.filter,"idPrefix",t)},expression:"filter.idPrefix"}},[a("el-option",{attrs:{label:"酷开",value:"10"}}),a("el-option",{attrs:{label:"江苏广电",value:"11"}})],1)],1),a("el-button",{attrs:{type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{attrs:{type:"warning"},on:{click:e.handleResetFilter}},[e._v("重置")])],1)],1):e._e()]}}])},[e._t("default")],2)},i=[],r=(a("28a5"),a("5076")),o=a("42f0"),l=a("2149"),s={components:{RemoteSelectorWrapper:r["a"],BaseSelector:o["a"],InputPositiveInt:l["a"]},data:function(){var e=this.$consts.statusOptions.filter(function(e){return[3,4,7].indexOf(e.value)>-1}),t=e.reduce(function(e,t){return e[t.value]=t.label,e},{});return{options:[],panelCategoryOptions:[],pannelCategoryOptionsIndexed:{},panelStatusOptions:e,panelStatusOptionsIndexed:t,parentTypeOptions:[{label:"分组版块",value:"group"},{label:"功能版块",value:"function"}],fillTypeOptions:[],pagination:{currentPage:1,pageSize:15,total:0},filter:this.genDefaultFilter(),efficientFilter:this.genDefaultFilter(),table:{data:[],selected:[],header:[{label:"ID",prop:"pannelGroupId"},{label:"名称",prop:"pannelGroupRemark","show-overflow-tooltip":!0,width:200},{label:"业务分类",width:100,render:function(e,t){return this.pannelCategoryOptionsIndexed[t.row.pannelCategory]}.bind(this)},{label:"布局",width:200,prop:"fullLayoutName","show-overflow-tooltip":!0},{label:"引用状态",prop:"fullTabName","show-overflow-tooltip":!0},{label:"状态",render:function(e,t){return this.$consts.statusText[t.row.pannelStatus]}.bind(this)},{label:"版块内容来源",render:function(e,t){return this.$consts.panelFillTypeText[t.row.pannelList[0].fillType]}.bind(this)},{prop:"lastUpdateDate",label:"更新时间",width:190},{prop:"userName",label:"更新人",width:120}],selectionType:"multiple",props:{"tooltip-effect":"dark"}},selected:[],originSelected:[]}},props:["isLive","source","selectionType","tabType"],computed:{isAlbumTab:function(){return 2===this.tabType}},methods:{handleSelectStart:function(){this.$emit("select-start"),this.fetchData()},handleSelectCancel:function(){this.$refs.wrapper.handleSelectCancel()},handleSelectEnd:function(e){if(!this.isAlbumTab)for(var t=function(e,t){var a=(t.pluginTypes||"").split(",");return a.some(function(t){return t===e})},a=0;a<e.length;a++){var n=e[a];if(t("REFERENCE_PLAY_VIDEO",n))return this.$message.error("版块"+n.pannelGroupRemark+"含有【播放视频推荐位】，只能配置在专题版面中");if(t("REFERENCE_VIP_QRCODE",n))return this.$message.error("版块"+n.pannelGroupRemark+"含有【VIP二维码推荐位】，只能配置在专题版面中")}this.$emit("select-end",e),this.$refs.wrapper.handleSelectEnd()},genDefaultFilter:function(){return{idPrefix:this.$consts.idPrefix,pannelType:1,panelId:void 0,pannelName:void 0,pannelCategory:void 0,pannelStatus:void 0,parentType:void 0,pannelResource:void 0,resourceIsNull:!0,fillType:void 0}},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleResetFilter:function(){this.filter=this.genDefaultFilter(),this.efficientFilter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=JSON.parse(JSON.stringify(this.efficientFilter)),a=this.pagination;a&&(t.page=a.currentPage,t.rows=a.pageSize),t.pannelStatus||(t.multiStatus="3,4"),t.pannelResource=this.source,this.$service.panelPageList(t).then(function(t){e.table.data=t.rows,e.pagination.total=t.total})}},created:function(){var e=this;this.$service.getDictType({type:"businessType"}).then(function(t){e.panelCategoryOptions=t.map(function(e){return{label:e.dictCnName,value:e.dictId,disabled:e.disabled}}),e.pannelCategoryOptionsIndexed=e.panelCategoryOptions.reduce(function(e,t){return e[t.value]=t.label,e},{})}),this.$service.getMediaFillType().then(function(t){e.fillTypeOptions=t.map(function(e){return{label:e.dictCnName,value:parseInt(e.dictEnName)}})})}},c=s,u=a("2877"),d=Object(u["a"])(c,n,i,!1,null,null,null);t["a"]=d.exports},9460:function(e,t,a){},"952d":function(e,t,a){},"95ed":function(e,t,a){},9659:function(e,t,a){},"971a":function(e,t,a){"use strict";var n=a("6308"),i=a.n(n);i.a},"980b":function(e,t,a){"use strict";var n=a("5f9e"),i=a.n(n);i.a},9840:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("TabPage",[a("ResourceList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",attrs:{"list-props":e.listProps},on:{create:e.handleCreate,delete:e.handleDelete,read:e.handleRead,edit:e.handleEdit,copy:e.handleCopy}}),e.isShowList?e._e():a("ResourceContent",{attrs:{id:e.id,"init-mode":e.mode,"content-props":e.contentProps,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},i=[],r=a("bbf7"),o={components:{TabPage:r["a"],ResourceList:function(){},ResourceContent:function(){}},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0}},computed:{resourceInfo:function(){return{type:"resource",idField:"id"}},listProps:function(){},contentProps:function(){}},methods:{handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e[this.resourceInfo.idField],this.mode="edit",this.isShowList=!1},handleRead:function(e,t){this.id=e[this.resourceInfo.idField],this.mode="read",this.version=t,this.isShowList=!1},handleDelete:function(e){var t=this,a=this.resourceInfo,n=a.idField;this.$service.deleteResource({type:a.type,id:e.map(function(e){return e[n]}).join(",")},"删除成功").then(function(){t.$refs.list.fetchData()})},handleCopy:function(e){this.id=e[this.resourceInfo.idField],this.mode="copy",this.isShowList=!1},handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},l=o,s=(a("8629"),a("2877")),c=Object(s["a"])(l,n,i,!1,null,"c6c348ba",null);t["a"]=c.exports},"98e7b":function(e,t,a){},"991a":function(e,t,a){},"99ad":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"hompage-upsert"},[a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("div",{staticClass:"base-info"},[a("div",[e._v("专属影院版块：")]),a("div",[e._v("专属影院，影片数据 由大数据和媒资库提供，运营人员只需配置相应内容块的影片类型（0 会员影片，1 非会员影片，2 单点影片）。")])]),a("CommonContent",{attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{replicate:function(t){e.mode="replicate"},edit:function(t){e.mode="edit"},unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,audit:function(t){return e.$emit("upsert-end")},"select-version":e.fetchData,delete:function(t){return e.$emit("upsert-end",t)},"submit-audit":e.handleSubmitAudit,"save-draft":e.handleSaveDraft}},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),"read"!==e.mode?a("div",[a("el-form",{ref:"upsertForm",staticClass:"el-form-add",attrs:{model:e.panel,"label-width":"120px",rules:e.rules}},[a("el-form-item",{attrs:{label:"业务分类"}},[a("el-select",{attrs:{value:e.panel.panelGroupCategory},on:{input:e.handlePanelGroupCategoryChange}},e._l(e.panelGroupCategoryOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.dictCnName,value:e.dictId}})}),1),a("span",{staticClass:"spform marginL"},[e._v("注：只有一个权限的操作者不能选择业务分类")])],1),"common"===e.panelGroupCategoryValue||"video"===e.panelGroupCategoryValue?a("el-form-item",{attrs:{label:"内容源"}},[a("el-radio-group",{attrs:{value:e.panel.pannelResource,disabled:e.sourceDisabled},on:{input:e.handlePannelResourceChange}},e._l(e.$consts.sourceOptions,function(t,n){return a("el-radio",{key:n,attrs:{label:t.value}},[e._v("\n                  "+e._s(t.label)+"\n                ")])}),1)],1):e._e(),a("el-form-item",{attrs:{label:"版块名称",prop:"pannelList.0.pannelName",rules:e.rules.pannelName}},[a("el-input",{model:{value:e.panel.pannelList[0].pannelName,callback:function(t){e.$set(e.panel.pannelList[0],"pannelName",t)},expression:"panel.pannelList[0].pannelName"}})],1),9===e.panel.panelGroupType?[a("el-form-item",{attrs:{label:"推荐策略"}},[a("el-select",{attrs:{value:e.panel.pannelList[0].recommendStrategy,disabled:e.isReplica},on:{input:e.handleRecommedStrategyInput}},e._l(e.recommendStrategyOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1)]:e._e(),a("div",{staticClass:"form-legend-header"},[a("span",[e._v("内容配置")])]),a("el-form-item",{attrs:{label:"版块标题",prop:"pannelList.0.pannelTitle",rules:e.rules.pannelTitle}},[a("el-input",{attrs:{placeholder:"请输入版本标题"},model:{value:e.panel.pannelList[0].pannelTitle,callback:function(t){e.$set(e.panel.pannelList[0],"pannelTitle",t)},expression:"panel.pannelList[0].pannelTitle"}}),a("el-checkbox",{staticClass:"marginL",attrs:{value:!e.panel.showTitle},on:{input:function(t){e.panel.showTitle=!t}}},[e._v("前端不显示标题")])],1),a("div",[5===e.panel.panelGroupType?a("el-form-item",{attrs:{label:"版块布局"}},[e.panel.layoutId>0?a("span",{staticClass:"spform J-selected J_select J_layout-selected"},[e._v(e._s(e.panel.layoutId))]):e._e(),a("el-checkbox",{model:{value:e.panel.lucenyFlag,callback:function(t){e.$set(e.panel,"lucenyFlag",t)},expression:"panel.lucenyFlag"}},[e._v("设置前端推荐位底色透明")]),a("div",{staticClass:"content-list"},e._l(e.panel.pannelList[0].contentList,function(t,n){return a("div",{key:n,staticClass:"content-list__item"},[a("el-select",{attrs:{size:"mini"},model:{value:t.blockVideoType,callback:function(a){e.$set(t,"blockVideoType",a)},expression:"item.blockVideoType"}},e._l(e.blockVideoTypeOptions,function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})}),1),a("span",{staticClass:"content-list__item-id"},[e._v(e._s(n+1))])],1)}),0)],1):e._e()],1),9===e.panel.panelGroupType||10===e.panel.panelGroupType?[a("el-form-item",{attrs:{prop:"pannelList.0.firstPageVipContentAmount",label:"首屏付费内容数",rules:e.rules.amount}},[a("el-input-number",{attrs:{max:6,min:0},model:{value:e.panel.pannelList[0].firstPageVipContentAmount,callback:function(t){e.$set(e.panel.pannelList[0],"firstPageVipContentAmount",t)},expression:"panel.pannelList[0].firstPageVipContentAmount"}})],1),a("el-form-item",{attrs:{prop:"pannelList.0.vipContentAmount",label:"总付费内容数",rules:e.rules.amount}},[a("el-input-number",{attrs:{max:15,min:0},model:{value:e.panel.pannelList[0].vipContentAmount,callback:function(t){e.$set(e.panel.pannelList[0],"vipContentAmount",t)},expression:"panel.pannelList[0].vipContentAmount"}})],1)]:e._e()],2)],1):e._e(),"read"===e.mode?a("div",[a("el-form",{attrs:{"label-width":"120px","label-position":"right"}},[a("el-form-item",{attrs:{label:"业务分类"}},[a("span",[e._v(e._s(e.getCategoryLabel(e.panel.panelGroupCategory)))])]),"common"===e.panelGroupCategoryValue||"video"===e.panelGroupCategoryValue?a("el-form-item",{attrs:{label:"内容源"}},[a("span",[e._v(e._s(e.$consts.sourceText[e.panel.pannelResource]))])]):e._e(),a("el-form-item",{attrs:{label:"版块名称",prop:"pannelList.0.pannelName"}},[e._v("\n              "+e._s(e.panel.pannelList[0].pannelName)+"\n            ")]),9===e.panel.panelGroupType?[a("el-form-item",{attrs:{label:"推荐策略"}},[a("span",[e._v("\n                  "+e._s(e.getRecommendStrategyLabel(e.panel.pannelList[0].recommendStrategy))+"\n                ")])])]:e._e(),a("div",{staticClass:"form-legend-header"},[a("span",[e._v("内容配置")])]),a("el-form-item",{attrs:{label:"版块标题",prop:"pannelList.0.pannelTitle"}},[e._v("\n              "+e._s(e.panel.pannelList[0].pannelTitle)+"\n              ("+e._s(e.panel.showTitle?"显示":"不显示")+")\n            ")]),5===e.panel.panelGroupType?a("el-form-item",{attrs:{label:"版块布局"}},[e.panel.layoutId>0?a("span",{staticClass:"spform J-selected J_select J_layout-selected"},[e._v(e._s(e.panel.layoutId))]):e._e(),e._v("\n              ("+e._s(e.panel.lucenyFlag?"透明":"非透明")+")\n              "),a("div",{staticClass:"content-list"},e._l(e.panel.pannelList[0].contentList,function(t,n){return a("div",{key:n,staticClass:"content-list__item"},[a("el-select",{attrs:{disabled:"read"===e.mode,size:"mini"},model:{value:t.blockVideoType,callback:function(a){e.$set(t,"blockVideoType",a)},expression:"item.blockVideoType"}},e._l(e.blockVideoTypeOptions,function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})}),1),a("span",{staticClass:"content-list__item-id"},[e._v(e._s(n+1))])],1)}),0)]):e._e(),9===e.panel.panelGroupType||10===e.panel.panelGroupType?a("el-form-item",{attrs:{label:"内容免/付费比例"}},[a("el-form-item",{staticClass:"amount-input",attrs:{label:"首屏付费内容数"}},[e._v(e._s(e.panel.pannelList[0].firstPageVipContentAmount))]),a("el-form-item",{staticClass:"amount-input",attrs:{label:"总付费内容数"}},[e._v(e._s(e.panel.pannelList[0].vipContentAmount))])],1):e._e()],2)],1):e._e()])],1)],1)])},i=[],r=(a("ac6a"),a("7514"),a("7cdf"),a("c5f6"),a("c3d5")),o=a("363f"),l={mixins:[o["a"]],components:{CommonContent:r["a"]},props:{id:Number,initMode:String,version:{type:String,default:function(){return""}}},data:function(){var e=[{value:0,label:"会员影片"},{value:1,label:"非会员影片"},{value:2,label:"单点影片"}];return{mode:"create",resourceName:"专属影院",panelGroupCategoryOptions:[],recommendStrategyOptions:[],blockVideoTypeOptions:e,rules:{pannelName:[{required:!0,message:"请填写版块名称"},{max:45,message:"版块名称不超过 45 个字符"}],pannelTitle:[{required:!0,message:"请填写标题"},{max:45,message:"标题不超过 45 个字符"}],amount:[{validator:function(e,t,a){Number.isInteger(Number(t))&&Number(t)>=0?a():a(new Error("请输入整数"))},trigger:"blur"}]},versionList:[],panel:{pannelGroupId:void 0,currentVersion:void 0,parentType:"function",groupTitle:"",showTitle:!0,lucenyFlag:!1,pannelResource:"o_tencent",panelGroupCategory:67,panelGroupType:9,pannelList:[{pannelId:void 0,pannelCategory:67,pannelName:void 0,pannelTitle:"专属剧场",pannelResource:void 0,pannelType:9,pannelStatus:void 0,showTitle:void 0,flagIs4k:0,fillType:4,recommendStrategy:"serial_watch_too",vipContentAmount:5,firstPageVipContentAmount:2,contentList:[]}]}}},computed:{sourceDisabled:function(){var e=this.panel;return"replicate"===this.mode||void 0!==e.currentVersion&&2!==e.pannelList[0].pannelStatus},panelGroupCategoryValue:function(){var e=this.panelGroupCategoryOptions,t=this.panel.panelGroupCategory;if(e){var a=e.find(function(e){return e.dictId===t});return a&&a.dictEnName}},resourceInfo:function(){var e=this.panel;if(e.pannelGroupId)return{id:e.pannelGroupId,type:"pannel",menuElId:"privatePannelInfo",version:e.currentVersion,status:e.pannelList[0].pannelStatus}},isReplica:function(){return"replica"===this.mode},isDisableTabType:function(){var e=this.mode;return"edit"===e||"replicate"===e||"copy"===e}},methods:{handleRecommedStrategyInput:function(e){this.panel.pannelList[0].recommendStrategy=e,this.initPanelTitleByRecommendStrategy(e)},initPanelTitleByRecommendStrategy:function(e){var t=this.recommendStrategyOptions.find(function(t){return t.value===e});this.panel.pannelList[0].pannelTitle=t&&t.label},getRecommendStrategyLabel:function(e){var t=this.recommendStrategyOptions.find(function(t){return t.value===e});return t&&t.label},setDefaultPanelTitle:function(e){this.panel.pannelList[0].pannelType=e,this.panel.pannelList[0].pannelTitle=10===e?"猜你喜欢":"专属剧场"},getCategoryLabel:function(e){var t=this.panelGroupCategoryOptions.find(function(t){return t.dictId===e});return t&&t.dictCnName},getPanelGroupTypeLabel:function(e){var t={9:"根据用户近期观影偏好推荐",10:"根据用户近期观看的影片推荐"};return t[e]},handlePanelGroupCategoryChange:function(e){this.panel.panelGroupCategory=e;var t=this.panelGroupCategoryValue;this.panel.pannelResource="common"===t||"video"===t?"o_tencent":""},handlePannelResourceChange:function(e){this.panel.pannelResource=e},handleSaveDraft:function(){var e=JSON.parse(JSON.stringify(this.panel));e.pannelStatus=2,this.submit(e)},handleSubmitAudit:function(){var e=JSON.parse(JSON.stringify(this.panel));e.pannelStatus=3,this.submit(e)},validate:function(e,t){this.$refs.upsertForm.validate(function(a){if(a){var n=e.pannelList[0],i=e.panelGroupType;if(9===i||10===i){if(n.vipContentAmount<n.firstPageVipContentAmount)return t(Error("首屏付费内容数量不能大于总付费内容数量"));if(n.vipContentAmount>n.firstPageVipContentAmount+9)return t(Error("总付费内容数应小于等于(首屏付费内容数 + 9)"))}t()}})},submit:function(e){var t=this,a=e.pannelList[0].firstPageVipContentAmount,n=e.pannelList[0].vipContentAmount;n>a+9?this.$message({type:"error",message:"总付费内容数应小于等于（首屏付费内容数 + 9）"}):this.validate(e,function(a){a?t.$message({type:"error",message:a}):t.$service.panelUpsert(t.parseDataToApi(e),"保存成功").then(function(e){t.$emit("upsert-end")})})},parseDataToApi:function(e){"replicate"===this.mode&&(e.currentVersion="");var t=JSON.parse(JSON.stringify(e)),a=t.panelGroupCategory,n=t.pannelResource,i=t.pannelStatus,r=t.layoutId,o=t.showTitle?1:0,l=t.lucenyFlag?1:0;return t.pannelList.forEach(function(e){e.pannelCategory=a,e.pannelResource=n,e.pannelStatus=i,e.layoutId=r,e.showTitle=o,e.contentList&&e.contentList.forEach(function(e){e.lucenyFlag=l})}),delete t.pannelResource,delete t.showTitle,delete t.lucenyFlag,delete t.pannelStatus,delete t.layoutId,t},parseApiToData:function(e){var t=e,a=e.pannelList[0];if(t.pannelResource=a.pannelResource,t.showTitle=1===a.showTitle,t.pannelStatus=a.pannelStatus,t.layoutId=a.layoutId,a.contentList&&a.contentList.length>0){var n=a.contentList[0];t.lucenyFlag=1===n.lucenyFlag}return t},setPanel:function(e){var t=this.parseApiToData(e);Object.assign(this.panel,t)},getDictType:function(){var e=this;this.$service.getDictType({type:"businessType"}).then(function(t){e.panelGroupCategoryOptions=t})},getRecommendStrategy:function(){var e=this;this.$service.getRecommendStrategy().then(function(t){console.log("rs",t),e.recommendStrategyOptions=t})},fetchData:function(e){var t=this;this.$service.panelGetDetail({id:this.id,version:e}).then(function(e){t.setPanel(e)})}},created:function(){this.mode=this.initMode||"create",this.id&&this.fetchData(this.version),this.getDictType(),this.getRecommendStrategy()}},s=l,c=(a("13a2"),a("2877")),u=Object(c["a"])(s,n,i,!1,null,"5c688df8",null);t["a"]=u.exports},"99eb":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form-item",{attrs:{label:e.title,prop:"mediaAutomationBlockRls.mediaAutomationId"}},[a("el-button",{attrs:{type:"primary",disabled:e.disabled},on:{click:function(t){e.isVisiableRecom=!0}}},[e._v("选择推荐流")]),e.value?a("el-tag",{staticClass:"margin-left-10",attrs:{type:"primary",closable:!e.disabled},on:{close:e.handleDelStreamTag}},[e._v("\n      "+e._s(e.value)+"\n    ")]):e._e()],1),a("el-dialog",{staticClass:"dia-log",attrs:{title:"推荐流",visible:e.isVisiableRecom,width:"40%"},on:{"update:visible":function(t){e.isVisiableRecom=t},open:e.fetchData}},[a("h4",[e._v("运营指定影片流")]),e._l(e.normalStreamTags,function(t){return a("el-tag",{key:t.id,staticClass:"recom-tag cursor-tip",attrs:{size:"medium"},on:{click:function(a){return e.handleSelectTag(t)}}},[e._v(e._s(t.name))])})],2)],1)},i=[],r=(a("ac6a"),a("2ef0")),o={components:{},data:function(){return{isVisiableRecom:!1,recomStreamTags:[],mediaAutomationId:void 0,normalStreamTags:[],standardStreamTags:[],title:""}},props:["value","disabled","source","resolution","show","type"],methods:{handleDelStreamTag:function(){this.$emit("del-select")},fetchData:function(){var e=this,t=this.resolution,a={page:1,rows:100,source:this.source||void 0,resolution:t};this.$service.getMediaAutomationDataList(a).then(function(t){e.recomStreamTags=t.rows.filter(function(e){return 1===e.openStatus});var a=[],n=[];e.recomStreamTags.forEach(function(e){var t=Object(r["cloneDeep"])(e);"normal"===e.type?a.push(t):n.push(t)}),e.normalStreamTags=a,e.standardStreamTags=n,0===e.recomStreamTags.length&&e.$message("流状态关闭，尺寸不匹配，或者暂无该内容源的推荐流")})},handleSelectTag:function(e){this.$emit("select-end",e),this.isVisiableRecom=!1}},created:function(){},mounted:function(){this.show?this.title="推荐流选择":this.title=""}},l=o,s=(a("4966"),a("2877")),c=Object(s["a"])(l,n,i,!1,null,"352e4bb5",null);t["a"]=c.exports},"9b76":function(e,t,a){"use strict";var n=a("4cda"),i=a.n(n);i.a},"9cdb":function(e,t,a){},"9ced":function(e,t,a){},"9cfd":function(e,t,a){},"9df1":function(e,t,a){"use strict";var n=a("fbaf"),i=a.n(n);i.a},"9eec":function(e,t,a){},a0e0:function(e,t,a){"use strict";var n=a("7ca1"),i=a.n(n);i.a},a166:function(e,t,a){"use strict";var n=a("3667"),i=a.n(n);i.a},a195:function(e,t,a){},a1fe:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"remote-selector-wrapper"},[a("div",{on:{click:e.handleSelectStart}},[e._t("default",[a("el-button",{attrs:{type:"primary",disabled:e.disabled,plain:""}},[e._v(" "+e._s(e.title))])])],2),a("PageDialog",{staticClass:"remote-selector-dialog",attrs:{"custom-class":e.customClass,"show-close":e.showClose,fullscreen:e.fullscreen,visible:e.showDialog,"append-to-body":!0},on:{"update:visible":function(t){e.showDialog=t}}},[a("div",{attrs:{slot:"title"},slot:"title"},[e._t("title",[e._v(" "+e._s(e.title))])],2),e._t("content",[a("div",{staticClass:"remote-selector-main"},[a("div",{staticClass:"remote-selector-main__prepend"},[e._t("prepend")],2),a("div",{staticClass:"remote-selector-main__filter"},[e._t("filter",[e.filterSchema?a("GateSchemaForm",{attrs:{schema:e.filterSchema},on:{submit:e.handleFilter,reset:e.handleResetFilterForm},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}}):e._e()])],2),a("div",{staticClass:"remote-selector-main__content"},[e._t("item-list")],2),a("div",{staticClass:"remote-selector-main__footer"},[a("div",{staticClass:"remote-selector-main__pagination"},[e._t("pagination",[e.pagination?a("el-pagination",{attrs:{"current-page":e.pagination.currentPage,"page-sizes":[15,20,30,50,100,200],"page-size":e.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pagination.total},on:{"size-change":e.handlePageSizeChange,"current-change":e.handlePageChange}}):e._e()])],2),a("div",{staticClass:"remote-selector-main__actions"},[e._t("actions",[e.hideSubmit?e._e():a("el-button",{attrs:{type:"primary"},on:{click:e.handleSelectEnd}},[e._v("\n                  确定\n                ")]),a("el-button",{on:{click:e.handleSelectCancel}},[e._v("\n                  取消\n                ")])])],2)])])],{isShow:e.showDialog})],2)],1)},i=[],r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",[a("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"page-dialog__wrapper"},[a("div",{staticClass:"backdrop"}),a("div",{class:{"page-dialog":!0,fullscreen:e.fullscreen}},[a("div",{staticClass:"page-dialog__header"},[e._t("title",[a("span",{staticClass:"page-dialog__title"},[e._v(" "+e._s(e.title))])])],2),a("div",{staticClass:"page-dialog__body"},[e._t("default")],2),a("div",{staticClass:"page-dialog__footer"},[e._t("footer")],2)])])])},o=[],l={data:function(){return{id:void 0,closed:!0}},props:["title","visible","fullscreen"],inject:["tabPage"],watch:{visible:function(e){e?this.openDialog():this.closeDialog()}},methods:{openDialog:function(){this.$emit("open"),this.closed=!1,this.tabPage.$el.append(this.$el),this.toggleLockScroll()},closeDialog:function(){this.$emit("close"),this.closed=!0,this.toggleLockScroll()},toggleLockScroll:function(){this.tabPage.toggleLockScroll(this.visible,this.id)}},created:function(){this.id=""+this._uid+Math.random()},mounted:function(){this.visible&&(this.closed=!1,this.tabPage.$el.append(this.$el),this.toggleLockScroll())},destroyed:function(){this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el),this.closed||this.toggleLockScroll()}},s=l,c=(a("5a6f"),a("2877")),u=Object(c["a"])(s,r,o,!1,null,null,null),d=u.exports,p={components:{PageDialog:d},props:{title:{type:String,default:function(){return"选择"}},hideSubmit:{type:Boolean},fullscreen:{type:Boolean,default:function(){return!0}},filter:Object,filterSchema:Object,pagination:Object,customClass:String,showClose:{type:Boolean,default:function(){return!0}},disabled:{type:Boolean,default:function(){return!1}}},data:function(){return{showDialog:!1,showContent:!1}},methods:{handleSelectStart:function(){this.disabled||(this.showDialog=!0,this.$emit("select-start"))},handleSelectEnd:function(){this.showDialog=!1,this.$emit("select-end")},handleSelectCancel:function(){this.showDialog=!1,this.$emit("select-cancel")},handleFilter:function(e){e&&0!==e.length||this.$emit("filter-change")},handlePageSizeChange:function(e){this.$set(this.pagination,"pageSize",e),this.$emit("pagination-change")},handlePageChange:function(e){this.$set(this.pagination,"currentPage",e),this.$emit("pagination-change")},handleResetFilterForm:function(){this.$emit("filter-reset")},emitFilterChange:function(e){this.$emit("filter-change",e)}},created:function(){}},h=p,m=(a("a853"),Object(c["a"])(h,n,i,!1,null,"eb544680",null));t["a"]=m.exports},a318:function(e,t,a){},a36a:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PageWrapper",{staticClass:"tab-info-wrapper"},[a("PageContentWrapper",[a("ContentCard",{attrs:{title:"京东版面"},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("span",{staticClass:"auditway"},[e._v("审核方式：")]),a("el-radio-group",{attrs:{value:e.tabData.enableAutoAudited},on:{input:e.handleInputAuditType}},[a("el-radio",{attrs:{label:!0}},[e._v("自动审核")]),a("el-radio",{attrs:{label:!1}},[e._v("手动审核")])],1),e.tabData.enableAutoAudited?e._e():[e.auditPassed?a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"success",size:"medium"}},[e._v("\n          审核已通过\n        ")]):a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",size:"medium"},on:{click:e.handleAudit}},[e._v("\n          审核\n        ")])],e.tabData?e._l(e.tabData.rows,function(t,n){return a("div",{key:n,staticClass:"panels-wrapper"},[t.groupTitle?a("span",{staticClass:"title"},[e._v(e._s(t.groupTitle))]):e._e(),a("JDPanel",{attrs:{layoutData:t.layout.contents,imgData:t.items}})],1)}):e._e()],2)],1)],1)},i=[],r=(a("ac6a"),a("4bc7")),o=a("5f87"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tablayout custom-scrollbar",style:e.styleObj},[a("ul",e._l(e.layoutData,function(t,n){return a("li",{key:n,style:e.styleLi[n],attrs:{title:e.imgData[n].title}},[t.resize?a("div",[e.imgData[n]?a("div",{staticClass:"layout-block",style:{width:t.resize.width/e.multiple+"px",height:t.height/e.multiple+"px"}},[a("img",{attrs:{src:e.imgData[n].imgUrl,referrerpolicy:"no-referrer"}}),e.imgData[n].priceInfo&&e.imgData[n].priceInfo.price?a("div",{staticClass:"price-info"},[e.imgData[n].priceInfo.secKillPrice&&e.imgData[n].priceInfo.secKillPrice>=0?a("div",[a("span",{staticStyle:{color:"#e68f3c"}},[e._v(e._s(e.imgData[n].priceInfo.price))]),a("s",[e._v(e._s(e.imgData[n].priceInfo.secKillPrice))])]):a("div",[a("span",{staticStyle:{color:"#e68f3c"}},[e._v(e._s(e.imgData[n].priceInfo.price))])])]):e._e()]):a("div",{staticClass:"layout-block",style:{width:t.resize.width/e.multiple+"px",height:t.resize.height/e.multiple+"px"}}),t.title_info?a("div",{staticClass:"layout-title",style:{width:t.title_info.width/e.multiple+"px",height:t.title_info.height/e.multiple+"px"}},[e._v(e._s(e.imgData[n].title))]):e._e()]):a("div",[e.imgData[n]?a("div",{staticClass:"layout-block",style:{width:t.width/e.multiple+"px",height:t.height/e.multiple+"px"}},[a("img",{attrs:{src:e.imgData[n].imgUrl,referrerpolicy:"no-referrer"}})]):a("div",{staticClass:"layout-block",style:{width:t.width/e.multiple+"px",height:t.height/e.multiple+"px"}})])])}),0)])},s=[],c=(a("ac4d"),a("8a81"),{props:{layoutData:Array,imgData:Array},data:function(){return{multiple:2,lastArr:this.layoutData[this.layoutData.length-1],conWidth:"",conHeight:""}},computed:{styleObj:function(){return{width:"811px",height:this.lastArr.resize?(this.lastArr.resize.y+this.lastArr.resize.height)/this.multiple+38+"px":(this.lastArr.y+this.lastArr.height)/this.multiple+10+"px"}},styleLi:function(){var e=[],t=this,a=!0,n=!1,i=void 0;try{for(var r,o=this.layoutData[Symbol.iterator]();!(a=(r=o.next()).done);a=!0){var l=r.value;l.resize?(e.push({width:l.resize.width/this.multiple+"px",height:l.resize.height/this.multiple+"px",left:l.resize.x/this.multiple+"px",top:l.resize.y/this.multiple+"px"}),t.isActive=!0):e.push({width:l.width/this.multiple+"px",height:l.height/this.multiple+"px",left:l.x/this.multiple+"px",top:l.y/this.multiple+"px"})}}catch(s){n=!0,i=s}finally{try{a||null==o.return||o.return()}finally{if(n)throw i}}return e}},created:function(){},watch:{},methods:{}}),u=c,d=(a("38c9"),a("2877")),p=Object(d["a"])(u,l,s,!1,null,"095c19bb",null),h=p.exports,m={components:{JDPanel:h,PageWrapper:r["a"],PageContentWrapper:o["a"]},props:["id"],data:function(){return{tabData:{enableAutoAudited:void 0,currentClientUsedVersion:void 0,currentUpdateVersion:void 0,rows:[]},dialogVisible:!1}},computed:{auditPassed:function(){var e=this.tabData,t=e.currentClientUsedVersion,a=e.currentUpdateVersion;return t===a}},methods:{handleInputAuditType:function(e){var t=this,a=this.tabData,n=e?"确定切换为自动审核":"确定切换为手动审核";this.$confirm(n,"提示").then(function(){a.enableAutoAudited=e,t.$service.updateThirdPartTabAuditType({id:t.id,enableAuto:e}).catch(function(){a.enableAutoAudited=!e})}).catch(function(){})},handleAudit:function(){var e=this;this.$confirm("是否审核通过?","京东版面审核").then(function(){e.$service.updateThirdPartTabAudit({id:e.id},"审核成功").then(function(){var t=e.tabData;t.currentClientUsedVersion=t.currentUpdateVersion,e.$emit("upsert-end")})}).catch(function(){})},fetchData:function(){var e=this;this.$service.getThirdpartTabLayout().then(function(t){e.$service.getThirdpartTabInfoDetail({id:e.id}).then(function(a){a.rows.forEach(function(e){var a=JSON.parse(e.layout);"Expander"===a.type&&(a.contents=t.contents),e.layout=a}),e.tabData=a})})}},created:function(){this.fetchData()}},f=m,v=(a("6a5b"),Object(d["a"])(f,n,i,!1,null,"326ca4ba",null));t["a"]=v.exports},a4eb:function(e,t,a){"use strict";var n=a("a195"),i=a.n(n);i.a},a62c:function(e,t,a){"use strict";var n=a("3250"),i=a.n(n);i.a},a787:function(e,t,a){},a7e7:function(e,t,a){"use strict";var n=a("1f40"),i=a.n(n);i.a},a82c:function(e,t,a){e.exports=a.p+"img/logo-coocaa.bceb1860.png"},a853:function(e,t,a){"use strict";var n=a("a787"),i=a.n(n);i.a},a901:function(e,t,a){},aa06:function(e,t,a){},aaed:function(e,t,a){},ab91:function(e,t,a){"use strict";var n=a("f093"),i=a.n(n);i.a},acd5:function(e,t,a){},ad1b:function(e,t,a){"use strict";var n=a("f10a"),i=a.n(n);i.a},adc0:function(e,t,a){"use strict";var n=a("31c4"),i=a.n(n);i.a},adca:function(e,t,a){"use strict";var n=a("28cf"),i=a.n(n);i.a},afe2:function(e,t,a){},aff1:function(e,t,a){},b093:function(e,t,a){"use strict";var n=a("eb3f"),i=a.n(n);i.a},b1cd:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("RemoteSelectorWrapper",{ref:"selectorWrapper",attrs:{title:e.title||"选择素材",filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination,disabled:e.disabled},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset,"pagination-change":e.fetchData,"select-end":e.handleSelectEnd,"select-start":e.handleSelectStart}},[a("div",{attrs:{slot:"filter"},slot:"filter"},[a("el-form",{ref:"filter",attrs:{model:e.filter,"label-width":"0px",inline:!0}},[a("el-form-item",{attrs:{label:""}},[a("InputPositiveInt",{attrs:{placeholder:"ID",clearable:""},model:{value:e.filter.pictureId,callback:function(t){e.$set(e.filter,"pictureId",t)},expression:"filter.pictureId"}})],1),a("el-form-item",{attrs:{label:""}},[a("el-input",{attrs:{placeholder:"素材名称",clearable:""},model:{value:e.filter.pictureName,callback:function(t){e.$set(e.filter,"pictureName",t)},expression:"filter.pictureName"}})],1),a("el-form-item",{attrs:{label:""}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"素材类别"},model:{value:e.filter.pictureCategory,callback:function(t){e.$set(e.filter,"pictureCategory",t)},expression:"filter.pictureCategory"}},e._l(e.materialTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:""}},[a("el-select",{attrs:{filterable:"",placeholder:"审核状态"},model:{value:e.filter.pictureStatus,callback:function(t){e.$set(e.filter,"pictureStatus",t)},expression:"filter.pictureStatus"}},e._l(e.pictureStatusOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:""}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"尺寸容忍度"},model:{value:e.filter.resolutionTolerance,callback:function(t){e.$set(e.filter,"resolutionTolerance",t)},expression:"filter.resolutionTolerance"}},e._l(e.resolutionToleranceOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),"10"!==e.$consts.idPrefix?a("el-form-item",{attrs:{label:""}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"数据来源"},model:{value:e.filter.idPrefix,callback:function(t){e.$set(e.filter,"idPrefix",t)},expression:"filter.idPrefix"}},e._l(e.$consts.idPrefixOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1):e._e(),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{on:{click:e.handleFilterReset}},[e._v("重置")])],1)],1)],1),e.presetTable.data.length>0?a("el-collapse",{staticClass:"rel-picture-wrapper",attrs:{slot:"prepend"},slot:"prepend",model:{value:e.collapseActiveItems,callback:function(t){e.collapseActiveItems=t},expression:"collapseActiveItems"}},[a("el-collapse-item",{attrs:{title:"关联图片",name:"relPicture"}},[a("CardList",{staticClass:"rel-picture-list",attrs:{data:e.presetTable.data,selected:e.presetTable.selected,"selection-type":"single","select-on-row-click":!0},on:{"row-selection-change":e.handlePresetTableRowSelectionChange},scopedSlots:e._u([{key:"row",fn:function(t){var n=t.row;return a("div",{staticClass:"picture-item"},[a("div",{staticClass:"img-wrapper"},[a("img",{key:n.pictureUrl,staticClass:"list-img",attrs:{referrerpolicy:"no-referrer",src:n.pictureUrl}})]),a("div",[e._v("\n            "+e._s(n.pictureResolution)+"\n          ")])])}}],null,!1,1304008132)})],1)],1):e._e(),a("CardList",{attrs:{slot:"item-list",data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-change":e.handleRowSelectionChange},slot:"item-list",scopedSlots:e._u([{key:"row",fn:function(t){var n=t.row;return a("div",{staticClass:"picture-item"},[a("div",{staticClass:"img-wrapper"},[a("img",{key:n.pictureUrl,staticClass:"list-img",attrs:{referrerpolicy:"no-referrer",src:n.pictureUrl}})]),a("div",[e._v(e._s(n.pictureName))]),a("div",[e._v("\n        "+e._s(n.pictureId)+" / "+e._s(e.$consts.statusText[n.pictureStatus])+" / "+e._s(n.pictureResolution)+"\n      ")])])}}])}),"single"===e.table.selectionType?a("div",{attrs:{slot:"actions"},slot:"actions"}):e._e(),e._t("default")],2)},i=[],r=a("768b"),o=(a("28a5"),a("cebc")),l=a("f6f4"),s=a("5076"),c=a("59c7"),u=a("2ef0"),d=a("2149"),p={mixins:[l["a"]],components:{CardList:c["CardList"],RemoteSelectorWrapper:s["a"],InputPositiveInt:d["a"]},props:["title","pictureResolution","queryLongPoster","disabled","resource"],data:function(){var e=this.$consts.status;return{collapseActiveItems:["relPicture"],materialTypeOptions:[],pictureStatusOptions:[{label:"审核通过",value:e.accepted},{label:"待审核",value:e.waiting}],resolutionToleranceOptions:[{label:"10%",value:10},{label:"30%",value:30},{label:"50%",value:50}],picDialogVisible:!1,auditDialogVisible:!1,reviewPicUrl:null,filter:this.getDefaultFilter(),filterSchema:null,pagination:{currentPage:1,pageSize:15},selectedCollection:"normal",selected:[],table:{props:{},data:[],selected:void 0,selectionType:"single"},presetTable:{data:[],selected:void 0},picturePreset:[]}},watch:{filter:{deep:!0,handler:"onFilterChange"}},methods:{getDefaultFilter:function(){var e={pictureStatus:4};return"10"!==this.$consts.idPrefix&&(e.idPrefix=this.$consts.idPrefix),e},handleRowSelectionChange:function(e,t){var a=this;this.selectedCollection="normal",this.table.selected=t,this.$refs.selectorWrapper.handleSelectEnd(),this.$nextTick(function(){a.dispatch("ElFormItem","el.form.blur")})},onFilterChange:function(){this.handleFilterChangeDebounce()},handleFilterChange:function(){this.pagination.currentPage=1,this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),Object(o["a"])({},e)},fetchData:function(){var e=this;this.table.selected=void 0;var t=this.parseFilter(),a=this.pictureResolution;a&&(t.pictureResolution=a);var n=this.queryLongPoster;void 0!==n&&(t.queryLongPoster=n),this.$service.getResourceList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},getMaterialTypes:function(){var e=this;return this.$service.getMaterialTypes().then(function(t){e.materialTypeOptions=t.map(function(e){return{label:e.dictCnName,value:e.dictId}})})},handleSelectStart:function(){this.filterSchema||this.initFilterSchema(),this.getPresetPictures(),this.fetchData()},handleSelectEnd:function(){var e=this.selectedCollection,t="preset"===e?this.presetTable:this.table,a=t.data,n=t.selected;this.$emit("select-end",a[n]),this.table.selected=void 0},handlePresetTableRowSelectionChange:function(e,t){this.selectedCollection="preset",this.presetTable.selected=t,this.$refs.selectorWrapper.handleSelectEnd()},getPresetPictures:function(){var e=this,t=this.resource,a=function(e){return e.map(function(e){return{pictureResolution:e.size,pictureUrl:e.url}})},n=function(t){var a=e.pictureResolution.split("*"),n=Object(r["a"])(a,2),i=n[0],o=n[1];return t.filter(function(e){var t=e.pictureResolution.split("*"),a=Object(r["a"])(t,2),n=a[0],l=a[1];return Math.abs(n-i)<5&&Math.abs(l-o)<5})};if(t&&"media"===t.coverType){if(t.picturePreset)return void(this.presetTable.data=n(a(t.picturePreset)));var i=t.extraValue1;if(i){var o={id:i,resType:"vod",callbackparam:"result",page:1,rows:1};this.$service.getMediaVideoInfos(o).then(function(t){var i=t.rows||[],r=i[0];if(r){var o=r.imageInfoList||[];e.presetTable.data=n(a(o))}})}}},initFilterSchema:function(){this.getMaterialTypes()}},created:function(){this.handleFilterChangeDebounce=Object(u["debounce"])(this.handleFilterChange,500)}},h=p,m=(a("c2f7"),a("2877")),f=Object(m["a"])(h,n,i,!1,null,"4da3e491",null);t["a"]=f.exports},b1fe:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pannel-wrap",style:{height:e.boundary.y*e.ratio+"px",width:e.contentWidth+"px"},attrs:{id:"layout"}},e._l(e.content,function(t,n){return a("div",{key:n},[t.resize?a("div",{style:{top:t.resize.y*e.ratio+"px",left:t.resize.x*e.ratio+"px",width:t.resize.width*e.ratio+"px",height:t.resize.height*e.ratio+"px",position:"absolute"},attrs:{draggable:"true"}},[a("div",{staticClass:"single-blcok pannel-content",style:{top:t.y*e.ratio+"px",left:t.x*e.ratio+"px",width:t.width*e.ratio+"px",height:t.height*e.ratio+"px"}},[a("span",{staticClass:"seq-num"},[e._v(e._s(n+1))]),a("span",{staticClass:"size-mark"},[e._v(e._s(t.width)+"*"+e._s(t.height))]),a("div",{staticClass:"corner-img",staticStyle:{position:"absolute",top:"0px",left:"0"},attrs:{name:"topLeft"}}),a("div",{staticClass:"corner-img",staticStyle:{position:"absolute",top:"0px",right:"0"},attrs:{name:"topRight"}}),a("div",{staticClass:"corner-img",staticStyle:{position:"absolute",bottom:"30px",left:"0"},attrs:{name:"bottomLeft"}}),a("div",{staticClass:"corner-img",staticStyle:{position:"absolute",bottom:"30px",right:"0"},attrs:{name:"bottomRight"}}),"Mall"===t.type?a("div",{staticClass:"specialSamll",attrs:{name:"smallPrice"}},[t.resize.width*e.ratio<150?a("div",[a("span",{staticClass:"secKillPrice",style:{"font-size":"10px","margin-right":"5px"},attrs:{name:"secKillPrice"}}),a("s",{staticClass:"price",style:{"font-size":"10px"},attrs:{name:"price"}})]):a("div",[a("span",{staticClass:"secKillPrice",attrs:{name:"secKillPrice"}}),a("s",{staticClass:"price",attrs:{name:"price"}})])]):e._e()]),t.title_info?a("div",{style:{width:t.title_info.width*e.ratio+"px",height:t.title_info.height*e.ratio+"px","font-size":t.title_info.size*e.ratio+"px","text-align":"center"}},[a("span",{attrs:{name:"titleName"}},[e._v("title")])]):e._e()]):a("div",[a("div",{staticClass:"single-blcok pannel-content",style:{top:t.y*e.ratio+"px",left:t.x*e.ratio+"px",width:t.width*e.ratio+"px",height:t.height*e.ratio+"px",position:"absolute"},attrs:{draggable:"true"}},[a("span",{staticClass:"seq-num"},[e._v(e._s(n+1))]),a("span",{staticClass:"size-mark"},[e._v(e._s(t.width)+"*"+e._s(t.height))]),a("div",{staticClass:"corner-img",staticStyle:{position:"absolute",top:"0px",left:"0"},attrs:{name:"topLeft"}}),a("div",{staticClass:"corner-img",staticStyle:{position:"absolute",top:"0px",right:"0"},attrs:{name:"topRight"}}),a("div",{staticClass:"corner-img",staticStyle:{position:"absolute",bottom:"0px",left:"0"},attrs:{name:"bottomLeft"}}),a("div",{staticClass:"corner-img",staticStyle:{position:"absolute",bottom:"0px",right:"0"},attrs:{name:"bottomRight"}}),t.width*e.ratio>=150?a("div",["Mall"===t.type?a("div",{staticClass:"specialSamll",staticStyle:{bottom:"5px"},attrs:{name:"smallPrice"}},[a("span",{staticClass:"secKillPrice",attrs:{name:"secKillPrice"}}),a("s",{staticClass:"price",attrs:{name:"price"}})]):e._e()]):a("div",["Mall"===t.type?a("div",{staticClass:"specialSamll",staticStyle:{bottom:"5px"},style:{"font-size":"10px !important"},attrs:{name:"smallPrice"}},[a("span",{staticClass:"secKillPrice",attrs:{name:"secKillPrice"}}),a("s",{staticClass:"price",attrs:{name:"price"}})]):e._e()])])])])}),0)},i=[],r=(a("ac6a"),a("c5f6"),{props:{content:{type:Array},contentWidth:{type:Number,default:811}},data:function(){return{}},computed:{boundary:function(){var e=0,t=0;return this.content.forEach(function(a){a=a.resize?a.resize:a,e=Math.max(e,a.x+a.width),t=Math.max(t,a.y+a.height)}),{x:e,y:t}},ratio:function(){var e=1,t=this.contentWidth,a=this.boundary.x;return a>t?t/a:e}},methods:{},created:function(){}}),o=r,l=(a("546a"),a("2877")),s=Object(l["a"])(o,n,i,!1,null,"9e66b712",null);t["a"]=s.exports},b49a:function(e,t,a){},b57e:function(e,t,a){"use strict";var n=a("6a62"),i=a.n(n);i.a},b59d:function(e,t,a){},b652:function(e,t,a){},b679:function(e,t,a){"use strict";var n=a("d032"),i=a.n(n);i.a},b6c7:function(e,t,a){"use strict";var n,i,r={props:["element"],render:function(e){return e(this.element||"div",{class:"cc-var"},this.$scopedSlots.default(this.$vnode.data.attrs))}},o=r,l=a("2877"),s=Object(l["a"])(o,n,i,!1,null,null,null);t["a"]=s.exports},b6cd:function(e,t,a){},b771:function(e,t,a){},b82d:function(e,t,a){"use strict";var n=a("7b7d"),i=a.n(n);i.a},b92a:function(e,t,a){"use strict";var n=a("ed89"),i=a.n(n);i.a},bac7:function(e,t,a){"use strict";var n=a("d8ce"),i=a.n(n);i.a},bbf7:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:{"tab-page-local":!0,"tab-page--lock-scroll":e.modals.length>0}},[e._t("default")],2)},i=[],r={data:function(){return{modals:[],originScrollTop:void 0}},provide:function(){return{tabPage:this}},methods:{toggleLockScroll:function(e,t){var a=this.modals;e?(a.length<=0&&(this.originScrollTop=this.$el.scrollTop),-1===a.indexOf(t)&&a.push(t),this.$el.scroll({top:0})):(this.modals=a.filter(function(e){return e!==t}),this.modals.length<=0&&void 0!==this.originScrollTop&&this.$el.scroll({top:this.originScrollTop}))}}},o=r,l=(a("e06a"),a("2877")),s=Object(l["a"])(o,n,i,!1,null,"50d35b92",null);t["a"]=s.exports},bdca:function(e,t,a){"use strict";var n=a("f54f"),i=a.n(n);i.a},bebe:function(e,t,a){},bec4:function(e,t,a){},bf6e:function(e,t,a){},bf7d:function(e,t,a){},c04e:function(e,t,a){"use strict";var n=a("7443"),i=a.n(n);i.a},c0e4:function(e,t,a){},c192:function(e,t,a){"use strict";var n=a("df39"),i=a.n(n);i.a},c2f7:function(e,t,a){"use strict";var n=a("df8c"),i=a.n(n);i.a},c3d5:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"common-content"},["read"!==e.mode?["copy"===e.mode?a("div",[a("VersionList",{attrs:{type:"resourceInfo.type",status:e.resourceInfo.status,version:e.resourceInfo.version,"version-list":e.versionList},on:{"select-version":function(t){return e.$emit("select-version",t)}}}),e._t("copy-confirm",[a("div",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$emit("copy",e.$consts.status.draft)}}},[e._v("复制为草稿")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$emit("copy",e.$consts.status.waiting)}}},[e._v("复制并提交审核")])],1)])],2):a("div",[e._t("auditAndDraft",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$emit("submit-audit")}}},[e._v("提交审核")]),a("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.$emit("save-draft")}}},[e._v("保存草稿")])])],2),e.showReleaseTimeSetter?a("ReleaseTimeSetter",{on:{cancel:function(t){e.showReleaseTimeSetter=!1},submit:e.handleSubmitWithReleaseTime}}):e._e(),e._t("default")]:[e.resourceInfo.id&&e.resourceInfo.menuElId&&e.showContentAuthManager?a("content-auth-manager",{attrs:{"resource-id":e.resourceInfo.id,"menu-elid":e.resourceInfo.menuElId,"resource-type":e.resourceInfo.type}}):e._e(),a("div",[e.releaseTime?a("div",{staticClass:"release-info"},[e._v("\n          该版块为定时任务，审核通过后将于 "+e._s(e.releaseTime)+" 上线\n        ")]):e._e(),e.resourceInfo.type?a("VersionList",{attrs:{type:"resourceInfo.type",status:e.resourceInfo.status,version:e.resourceInfo.version,"version-list":e.versionList},on:{"select-version":function(t){return e.$emit("select-version",t)}}}):e._e(),e.resourceInfo.id&&!e.isFrozen?a("ContentButtonGroup",{attrs:{"resource-info":e.resourceInfo,options:e.buttonGroupOptions},on:{copy:function(t){return e.$emit("replicate")},edit:function(t){return e.$emit("edit")},unaudit:e.handleUnAudit,audit:e.handleAuditStart,shelves:e.handleShelves,delete:e.handleDelete,"cancel-timing":e.handleCancelTiming,"second-audit":e.handleSecondAudit}}):e._e()],1),e._t("default"),a("AuditHistory",{attrs:{data:e.auditHistoryList}}),a("el-dialog",{attrs:{title:"审核",visible:e.showAuditDialog},on:{"update:visible":function(t){e.showAuditDialog=t}}},[a("el-form",{ref:"auditForm",attrs:{model:e.auditForm,"status-icon":"",rules:e.auditFormRule,"label-width":"100"}},[a("el-form-item",{attrs:{label:"审核意见",prop:"auditFlag"}},[a("el-radio",{attrs:{label:"4"},model:{value:e.auditForm.auditFlag,callback:function(t){e.$set(e.auditForm,"auditFlag",t)},expression:"auditForm.auditFlag"}},[e._v("通过")]),a("el-radio",{attrs:{label:"5"},model:{value:e.auditForm.auditFlag,callback:function(t){e.$set(e.auditForm,"auditFlag",t)},expression:"auditForm.auditFlag"}},[e._v("打回")])],1),a("el-form-item",{attrs:{label:"意见说明",prop:"auditDesc"}},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入意见说明"},model:{value:e.auditForm.auditDesc,callback:function(t){e.$set(e.auditForm,"auditDesc",t)},expression:"auditForm.auditDesc"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showAuditDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleAuditEnd}},[e._v("确 定")])],1)],1)]],2)},i=[],r=(a("7514"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{staticClass:"version-list",attrs:{inline:!0}},[e.versionList&&e.versionList.length>0?a("el-form-item",{attrs:{label:"版本"}},[a("el-select",{staticClass:"version-selector",attrs:{value:e.version,placeholder:"请选择"},on:{input:e.handleSelectVersion}},e._l(e.versionList,function(e){return a("el-option",{key:e.version,attrs:{label:e.label,value:e.value}})}),1)],1):e._e(),a("el-form-item",[a("div",{staticClass:"status"},[e._v("\n       "+e._s(e.$consts.statusText[e.status])+"\n        ")])])],1)}),o=[],l={props:["version","status","versionList"],methods:{handleSelectVersion:function(e){this.$emit("select-version",e)}}},s=l,c=(a("a62c"),a("2877")),u=Object(c["a"])(s,r,o,!1,null,"34d36a56",null),d=u.exports,p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.data.length>0?a("div",[e._m(0),a("table",{staticClass:"audit-history-table"},e._l(e.data,function(t,n){return a("tr",{key:n},[a("td",[e._v("\n        "+e._s(t.lastUpdateDate)+"\n      ")]),a("td",[e._v("\n        "+e._s(t.auditor)+"\n      ")]),a("td",[e._v("\n        "+e._s(e.$consts.statusText[t.auditFlag])+"\n      ")]),a("td",[e._v("\n        "+e._s(t.auditDesc)+"\n      ")])])}),0)]):e._e()},h=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"form-legend-header"},[a("span",[e._v("审核者备注")])])}],m={props:{data:{type:Array,default:function(){return[]}}}},f=m,v=(a("f352"),Object(c["a"])(f,p,h,!1,null,"8c5eb2cc",null)),g=v.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._l(e.buttons,function(t,n){return["copy"!==t.runComm||e.options.isAllowCopy?a("el-button",{key:n,attrs:{disabled:"claim"===t.runComm||"unclaim"===t.runComm,type:e.warningButtons.indexOf(t.runComm)>-1?"warning":"primary"},on:{click:function(a){return e.$emit(t.runComm)}}},[e._v("\n      "+e._s(t.runName)+"\n    ")]):e._e()]}),e.options.isNeedSecondAudit?a("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.$emit("second-audit")}}},[e._v("\n      二次审核\n  ")]):e._e(),e.options.isAllowCancelTiming?a("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.$emit("cancel-timing")}}},[e._v("\n      取消定时\n  ")]):e._e()],2)},y=[],w=(a("6b54"),{data:function(){return{buttons:[],warningButtons:["delete","unclaim","unaudit","copy"]}},props:["resourceInfo","options"],methods:{getButtons:function(){var e=this,t=this.$consts.idPrefix,a=this.resourceInfo,n=a.id,i=a.version,r=a.type,o=a.status,l=a.menuElId;if("10"===t||n.toString().substr(0,2)===t){var s={resourceId:n,version:i,type:r,status:o,menuElId:l};this.$service.getAuditDetailButton(s).then(function(t){e.buttons=t})}}},created:function(){this.$watch("resourceInfo",this.getButtons,{immediate:!0})}}),I=w,C=Object(c["a"])(I,b,y,!1,null,null,null),T=C.exports,S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{visible:e.showDialog},on:{"update:visible":function(t){e.showDialog=t}}},[a("el-form",{ref:"submitForm",attrs:{model:e.submitForm,rules:e.submitRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"是否定时"}},[a("el-radio-group",{model:{value:e.submitForm.isTiming,callback:function(t){e.$set(e.submitForm,"isTiming",t)},expression:"submitForm.isTiming"}},[a("el-radio",{attrs:{label:1}},[e._v("是")]),a("el-radio",{attrs:{label:0}},[e._v("否")])],1)],1),e.submitForm.isTiming?a("el-form-item",{attrs:{label:"设定时间",prop:"releaseTime"}},[a("el-date-picker",{attrs:{type:"datetime",clearable:!1,"picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.submitForm.releaseTime,callback:function(t){e.$set(e.submitForm,"releaseTime",t)},expression:"submitForm.releaseTime"}})],1):e._e()],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.judgeTask}},[e._v("确 定")]),a("el-button",{attrs:{size:"small"},on:{click:function(t){e.showDialog=!1}}},[e._v("取 消")])],1)],1)},k=[],_={data:function(){return{showDialog:!0,submitForm:{isTiming:0,releaseTime:void 0},pickerOptions:{disabledDate:function(e){var t=864e5,a=15*t;return e.getTime()<=Date.now()-t||e.getTime()>=Date.now()+a}},submitRules:{releaseTime:[{required:!0,message:"请选择时间",trigger:"change"}]}}},watch:{showDialog:function(e){!1===e&&this.$emit("cancel")}},methods:{judgeTask:function(){var e=this;this.$refs.submitForm.validate(function(t){if(t){var a=e.submitForm.isTiming,n=e.submitForm.releaseTime;if(n&&Date.now()>+new Date(n))return e.$message.error("上线时间不能小于当前时间");a?e.$service.getTimedTaskLimit().then(e.submitTask):e.submitTask()}})},submitTask:function(){var e=this.submitForm;this.$emit("submit",{isTiming:e.isTiming,releaseTime:e.releaseTime})}}},P=_,x=Object(c["a"])(P,S,k,!1,null,null,null),F=x.exports,D=a("3d85"),R={components:{ContentAuthManager:D["a"],VersionList:d,ContentButtonGroup:T,AuditHistory:g,ReleaseTimeSetter:F},data:function(){return{showReleaseTimeSetter:!1,showAuditDialog:!1,releaseTime:void 0,versionList:[],auditHistoryList:[],auditForm:{auditFlag:"4",auditDesc:""},auditFormRule:{auditDesc:[{required:!0,message:"请输入审核意见",trigger:"blur"}]}}},props:{mode:String,resourceInfo:{type:Object,default:function(){return{}}},validateMethod:{type:Function},isFrozen:{}},watch:{resourceInfo:"handleResourceChange"},computed:{showContentAuthManager:function(){var e=this.resourceInfo;return!!e.type&&["homepage","policy","tab","pannel","block","systemPlugin"].indexOf(e.type)>-1},buttonGroupOptions:function(){var e=this.$consts.status,t=e.draft,a=e.waiting,n=e.rejected,i=e.processing,r=e.waiting2,o=!this.versionList.some(function(e){var i=e.row.status;return i===t||i===a||i===n}),l=this.resourceInfo.status,s=l===i,c=l===r;return{isAllowCopy:o,isNeedSecondAudit:c,isAllowCancelTiming:s}}},methods:{handleSubmitWithReleaseTime:function(e){this.showReleaseTimeSetter=!1,this.$emit("submit-audit",e)},handleDelete:function(){var e=this,t=this.resourceInfo,a=t.type,n=t.id,i=t.version;this.$confirm("确认删除该版本吗?","提示").then(function(){e.$service.deleteVersion({type:a,id:n,version:i},"删除成功").then(function(){if(0===e.versionList.length)e.$emit("delete",!1);else{var t=e.versionList.find(function(e){return e.value!==i}).value;e.$emit("delete",!0),e.$emit("select-version",t)}})}).catch(function(){})},handleAuditStart:function(){this.showAuditDialog=!0},handleAuditEnd:function(){var e=this;this.$refs.auditForm.validate(function(t){if(t){var a=e.resourceInfo,n=a.id,i=a.version,r=a.type,o=e.auditForm,l=o.auditFlag,s=o.auditDesc;e.$service.auditTask({id:n,version:i,type:r,auditFlag:l,auditDesc:s},4===parseInt(l)?"审核成功":"打回成功").then(function(t){e.auditDialog=!1,e.$emit("audit")})}})},handleSecondAudit:function(){var e=this,t=this.resourceInfo,a=t.id,n=t.version,i=t.type;this.$confirm("是否对该内容进行二次审核","提示").then(function(){e.$service.secondAudit({id:a,version:n,type:i},"操作成功").then(function(t){e.$emit("audit")})}).catch(function(e){console.log(e)})},handleUnAudit:function(){var e=this,t=this.resourceInfo,a=t.id,n=t.version,i=t.type;this.$confirm("您确定要撤销审核吗?","提示").then(function(){e.$service.revokeAudit({id:a,version:n,type:i},"撤销审核成功").then(function(){e.$emit("unaudit")})}).catch(function(){})},handleShelves:function(){var e=this,t=this.resourceInfo,a=t.type,n=t.id,i=t.version;this.$service.putOnShelves({id:n,version:i,type:a},"上架成功").then(function(){e.$emit("shelves")})},getHistoryList:function(){var e=this,t=this.resourceInfo,a=t.type,n=t.id,i=t.version;n&&i?this.$service.getVersionList({id:n,type:a}).then(function(t){e.versionList=t}):this.versionList=[]},getAuditHistoryList:function(){var e=this,t=this.resourceInfo,a=t.type,n=t.id,i=t.version;n&&i?this.$service.getAuditHistoryList({id:n,type:a,version:i}).then(function(t){e.auditHistoryList=t}):this.auditHistoryList=[]},getReleaseTime:function(){var e=this;this.releaseTime=void 0;var t=this.resourceInfo,a=t.type,n=t.id,i=t.version,r=t.status,o=this.$consts.status,l=o.processing,s=o.waiting;n&&i&&(r!==l&&r!==s||this.$service.getTimedTaskInfo({id:n,type:a,version:i}).then(function(t){e.releaseTime=t.releaseTime}))},handleCancelTiming:function(){var e=this;this.$confirm("您确定取消定时吗?","提示").then(function(){var t=e.resourceInfo,a=t.type,n=t.id,i=t.version;e.$service.timedTaskCancel({id:n,type:a,version:i}).then(function(t){e.$emit("cancel-timing")})}).catch(function(){})},handleResourceChange:function(){this.getHistoryList(),this.getAuditHistoryList(),this.getReleaseTime()}},created:function(){}},L=R,$=(a("e9f2"),Object(c["a"])(L,n,i,!1,null,"730bc24b",null));t["a"]=$.exports},c3e0:function(e,t,a){},c41c:function(e,t,a){"use strict";var n=a("f78e"),i=a.n(n);i.a},c48d:function(e,t,a){},c49f:function(e,t,a){"use strict";var n=a("4ab5"),i=a.n(n);i.a},c4ef:function(e,t,a){"use strict";var n=a("326e"),i=a.n(n);i.a},c644:function(e,t,a){"use strict";var n=a("95ed"),i=a.n(n);i.a},c67a:function(e,t,a){"use strict";var n=a("0e59"),i=a.n(n);i.a},c67e:function(e,t,a){"use strict";var n=a("1cf5"),i=a.n(n);i.a},c797:function(e,t,a){"use strict";var n=a("8d27"),i=a.n(n);i.a},c8f6:function(e,t,a){"use strict";var n=a("2537"),i=a.n(n);i.a},cb10:function(e,t,a){},cc30:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("RemoteSelectorWrapper",{ref:"wrapper",attrs:{"custom-class":"resource-selector",disabled:e.disabled},on:{"select-start":e.handleSelectStart},scopedSlots:e._u([{key:"content",fn:function(t){var n=t.isShow;return[e.isLive||n?[e.isUseSelector("video")?a("video-selector",{directives:[{name:"show",rawName:"v-show",value:"video"===e.activeSelector,expression:"activeSelector === 'video'"}],ref:"video-selector",attrs:{"disable-partner":e.disablePartner,source:e.source,"selection-type":e.selectionType,"id-type":e.idType},on:{"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}}):e._e(),e.isUseSelector("app")?a("app-selector",{directives:[{name:"show",rawName:"v-show",value:"app"===e.activeSelector,expression:"activeSelector === 'app'"}],ref:"app-selector",attrs:{source:e.source,"selection-type":e.selectionType},on:{"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}}):e._e(),e.isUseSelector("edu")?a("edu-selector",{directives:[{name:"show",rawName:"v-show",value:"edu"===e.activeSelector,expression:"activeSelector === 'edu'"}],ref:"edu-selector",attrs:{source:e.source,"selection-type":e.selectionType,"id-type":e.idType},on:{"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}}):e._e(),e.isUseSelector("pptv")?a("pptv-selector",{directives:[{name:"show",rawName:"v-show",value:"pptv"===e.activeSelector,expression:"activeSelector === 'pptv'"}],ref:"pptv-selector",attrs:{source:e.source,"selection-type":e.selectionType},on:{"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}}):e._e(),e.isUseSelector("live")?a("live-selector",{directives:[{name:"show",rawName:"v-show",value:"live"===e.activeSelector,expression:"activeSelector === 'live'"}],ref:"live-selector",attrs:{source:e.source,"selection-type":e.selectionType},on:{"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}}):e._e(),e.isUseSelector("topic")?a("topic-selector",{directives:[{name:"show",rawName:"v-show",value:"topic"===e.activeSelector,expression:"activeSelector === 'topic'"}],ref:"topic-selector",attrs:{source:e.source,"selection-type":e.selectionType},on:{"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}}):e._e(),e.isUseSelector("rotate")?a("rotate-selector",{directives:[{name:"show",rawName:"v-show",value:"rotate"===e.activeSelector,expression:"activeSelector === 'rotate'"}],ref:"rotate-selector",attrs:{source:e.source,"selection-type":e.selectionType},on:{"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}}):e._e(),e.isUseSelector("func")?a("func-selector",{directives:[{name:"show",rawName:"v-show",value:"func"===e.activeSelector,expression:"activeSelector === 'func'"}],ref:"func-selector",attrs:{source:e.source,"selection-type":e.selectionType,"before-select-end-cb":e.beforeSelectEndCbs["func"]},on:{"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}}):e._e(),e.isUseSelector("broadcast")?a("broadcast-selector",{directives:[{name:"show",rawName:"v-show",value:"broadcast"===e.activeSelector,expression:"activeSelector === 'broadcast'"}],ref:"broadcast-selector",attrs:{source:e.source,"selection-type":e.selectionType},on:{"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}}):e._e(),e.isUseSelector("shortVideo")?a("short-video-selector",{directives:[{name:"show",rawName:"v-show",value:"shortVideo"===e.activeSelector,expression:"activeSelector === 'shortVideo'"}],ref:"shortVideo-selector",attrs:{source:e.source,"disable-partner":e.disablePartner,"selection-type":e.selectionType},on:{"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}}):e._e(),e.isUseSelector("shortVideoTopic")?a("short-video-topic-selector",{directives:[{name:"show",rawName:"v-show",value:"shortVideoTopic"===e.activeSelector,expression:"activeSelector === 'shortVideoTopic'"}],ref:"shortVideoTopic-selector",attrs:{source:e.source,"disable-partner":e.disablePartner,"selection-type":e.selectionType},on:{"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}}):e._e(),e.isUseSelector("ranking")?a("ranking-selector",{directives:[{name:"show",rawName:"v-show",value:"ranking"===e.activeSelector,expression:"activeSelector === 'ranking'"}],ref:"ranking-selector",attrs:{source:e.source,"business-type":e.businessType,"selection-type":e.selectionType},on:{"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}}):e._e(),e.isUseSelector("good")?a("good-selector",{directives:[{name:"show",rawName:"v-show",value:"good"===e.activeSelector,expression:"activeSelector === 'good'"}],ref:"good-selector",attrs:{source:e.source,"disable-partner":e.disablePartner,"selection-type":e.selectionType},on:{"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}}):e._e(),e.isUseSelector("subscribe")?a("subscribe-selector",{directives:[{name:"show",rawName:"v-show",value:"subscribe"===e.activeSelector,expression:"activeSelector === 'subscribe'"}],ref:"subscribe-selector",attrs:{source:e.source,"disable-partner":e.disablePartner,"selection-type":e.selectionType},on:{"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}}):e._e()]:e._e()]}}])},[a("div",{staticClass:"resource-selector__header",attrs:{slot:"title"},slot:"title"},[e._l(e.SELECTORS,function(t){return[e.isUseSelector(t.value)?a("a",{key:t.value,class:t.value===e.activeSelector?"active":"",on:{click:function(a){return e.handleActivateSelector(t.value)}}},[e._v("\n        "+e._s(t.label)+"\n      ")]):e._e()]})],2),e._t("default")],2)},i=[],r=(a("ac6a"),a("cebc")),o=(a("c5f6"),a("a1fe")),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"id","is-live":e.isLive,"selection-type":e.selectionType,table:e.table,pagination:e.pagination,"select-end-on-dbl-click":!0},on:{"pagination-change":e.fetchData,"filter-reset":e.handleFilterReset,"select-cancel":function(t){return e.$emit("select-cancel")},"select-end":function(t){return e.$emit("select-end")}}},[a("el-form",{attrs:{slot:"filter",inline:!0,"label-width":"72px"},slot:"filter",model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("el-form-item",{attrs:{label:"专题类别"}},[a("el-select",{attrs:{filterable:"",clearable:""},model:{value:e.filter.levelType,callback:function(t){e.$set(e.filter,"levelType",t)},expression:"filter.levelType"}},e._l(e.options,function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"专题名称"}},[a("el-input",{attrs:{filterable:"",clearable:""},model:{value:e.filter.title,callback:function(t){e.$set(e.filter,"title",t)},expression:"filter.title"}})],1),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{attrs:{size:"small",type:"warning"},on:{click:e.handleFilterReset}},[e._v("重置")])],1)],1)},s=[],c=a("42f0"),u={components:{BaseSelector:c["a"]},data:function(){return{pagination:{currentPage:1,pageSize:15},filter:this.getDefaultFilter(),efficientFilter:this.getDefaultFilter(),options:[{label:"大专题",value:"parentTopic"},{label:"小专题",value:"childTopic"}],table:{props:{},data:[],header:[{prop:"id",label:"ID",fixed:!0,width:"100"},{prop:"title",label:"专题名称",fixed:!0},{prop:"picture",label:"专题背景",render:function(e,t){var a=t.row;if(a.picture)return e("img",{key:a.picture,attrs:{src:a.picture,width:"110px",height:"50px",class:"imgs"}})},width:"220"},{prop:"dataSign",label:"专题类别",width:"200",formatter:function(e){return"parentTopic"===e.dataSign?"大专题":"childTopic"===e.dataSign?"小专题":void 0}},{prop:"code",label:"code",width:"80px"},{prop:"lastUpdateDate",label:"更新时间",width:"200"}],selected:[],selectionType:"single"}}},props:["isLive","selectionType"],computed:{selected:function(){return this.$refs.baseSelector.selected.slice()}},methods:{getDefaultFilter:function(){return{resType:"operation",dataType:"topic",callback:"result",levelType:void 0,title:void 0}},getFilter:function(){var e=this.pagination,t=Object.assign({},this.efficientFilter);return e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.efficientFilter=this.getDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=this.getFilter();this.$service.getMediaVideoInfos(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows||[]})}}},d=u,p=a("2877"),h=Object(p["a"])(d,l,s,!1,null,"d053d9ba",null),m=h.exports,f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"appId","is-live":e.isLive,"selection-type":e.selectionType,table:e.table,pagination:e.pagination,filter:e.filter,"filter-schema":null,"select-end-on-dbl-click":!0},on:{"pagination-change":e.fetchData,"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset,"select-cancel":function(t){return e.$emit("select-cancel")},"select-end":function(t){return e.$emit("select-end")}}},[a("el-form",{attrs:{slot:"filter",model:e.filter,"label-width":"80px",inline:!0},nativeOn:{reset:function(t){return t.preventDefault(),e.handleFilterReset(t)},submit:function(t){return t.preventDefault(),e.handleFilterChange(t)}},slot:"filter"},[a("el-form-item",{attrs:{label:""}},[a("InputPositiveInt",{attrs:{clearable:"",placeholder:"应用ID"},model:{value:e.filter.appId,callback:function(t){e.$set(e.filter,"appId",t)},expression:"filter.appId"}})],1),a("el-form-item",{attrs:{label:""}},[a("el-input",{attrs:{clearable:"",placeholder:"应用名称"},model:{value:e.filter.appName,callback:function(t){e.$set(e.filter,"appName","string"===typeof t?t.trim():t)},expression:"filter.appName"}})],1),a("el-form-item",{attrs:{label:""}},[a("el-input",{attrs:{clearable:"",placeholder:"应用包名"},model:{value:e.filter.appPackageName,callback:function(t){e.$set(e.filter,"appPackageName","string"===typeof t?t.trim():t)},expression:"filter.appPackageName"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary","native-type":"submit"}},[e._v("查询")]),a("el-button",{attrs:{"native-type":"reset"}},[e._v("重置")])],1)],1)],1)},v=[],g=a("2149"),b={components:{BaseSelector:c["a"],InputPositiveInt:g["a"]},data:function(){return{pagination:{currentPage:1,pageSize:15},filter:this.genDefaultFilter(),efficientFilter:this.genDefaultFilter(),filterSchema:null,table:{props:{},header:[{label:"ID",prop:"appId",width:"70"},{label:"应用名称",prop:"appName",width:"100"},{label:"应用包名",prop:"appPackageName"},{label:"图片",prop:"appImageUrl",render:function(e,t){var a=t.row;return e("img",{key:a.appImageUrl,attrs:{src:a.appImageUrl,width:"50px",height:"50px",class:"imgs"}})}}],data:[]}}},computed:{selected:function(){return this.$refs.baseSelector.selected.slice()}},props:["isLive","selectionType"],methods:{genDefaultFilter:function(){return{appId:void 0,appName:void 0,appPackageName:void 0}},getFilter:function(){var e=this.pagination,t=this.efficientFilter;return e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.fetchData()},handleFilterReset:function(){this.filter=this.genDefaultFilter(),this.efficientFilter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=this.getFilter();this.$service.getAppManagementList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){}},y=b,w=Object(p["a"])(y,f,v,!1,null,"1d0328dc",null),I=w.exports,C=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"id","is-live":e.isLive,"selection-type":e.selectionType,table:e.table,pagination:e.pagination,filter:e.filter,"filter-schema":null,"select-end-on-dbl-click":!0},on:{"pagination-change":e.fetchData,"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset,"select-cancel":function(t){return e.$emit("select-cancel")},"select-end":function(t){return e.$emit("select-end")}}},[a("el-form",{attrs:{slot:"filter",model:e.filter,"label-width":"80px",inline:!0},nativeOn:{reset:function(t){return t.preventDefault(),e.handleFilterReset(t)},submit:function(t){return t.preventDefault(),e.handleFilterChange(t)}},slot:"filter"},[a("el-form-item",{attrs:{label:""}},[a("InputPositiveInt",{attrs:{clearable:"",placeholder:"轮播ID"},model:{value:e.filter.id,callback:function(t){e.$set(e.filter,"id",t)},expression:"filter.id"}})],1),a("el-form-item",{attrs:{label:""}},[a("el-input",{attrs:{clearable:"",placeholder:"轮播名称"},model:{value:e.filter.containerName,callback:function(t){e.$set(e.filter,"containerName","string"===typeof t?t.trim():t)},expression:"filter.containerName"}})],1),a("el-form-item",{attrs:{label:""}},[a("CommonSelector",{attrs:{filterable:"",options:e.sourceOptions},model:{value:e.filter.source,callback:function(t){e.$set(e.filter,"source",t)},expression:"filter.source"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary","native-type":"submit"}},[e._v("查询")]),a("el-button",{attrs:{"native-type":"reset"}},[e._v("重置")])],1)],1)],1)},T=[],S=(a("7514"),a("ea3f")),k={components:{BaseSelector:c["a"],InputPositiveInt:g["a"],CommonSelector:S["a"]},data:function(){var e=this;return{pagination:{currentPage:1,pageSize:15},filter:this.getDefaultFilter(),efficientFilter:this.getDefaultFilter(),filterSchema:null,table:{props:{},header:[{prop:"id",label:"轮播ID",fixed:!0,searched:!0},{prop:"containerName",label:"轮播名称",fixed:!0,searched:!0},{prop:"source",label:"内容源",width:"120",options:[],render:function(t,a){var n=a.row;return e.$consts.sourceTextWithNone[n.source]||"未知"}},{prop:"lastUpdateDate",label:"创建时间"}],data:[]}}},props:["isLive","selectionType","source"],computed:{selected:function(){return this.$refs.baseSelector.selected.slice()}},methods:{getDefaultFilter:function(){return{id:void 0,containerName:void 0,source:this.source}},getFilter:function(){var e=this.pagination,t=JSON.parse(JSON.stringify(this.efficientFilter));return t.code=t.id,e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.efficientFilter=this.getDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=this.getFilter();this.$service.broadcastBlockDataList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=this.source,t=JSON.parse(JSON.stringify(this.$consts.sourceOptionsWithEmpty));e&&(t=t.filter(function(t){return t.value===e||""===t.value}));var a=t.find(function(e){return""===e.value});a&&(a.value="none"),this.sourceOptions=t}},_=k,P=Object(p["a"])(_,C,T,!1,null,"1db93732",null),x=P.exports,F=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"vId","is-live":e.isLive,"selection-type":e.selectionType,table:e.table,pagination:e.pagination,"select-end-on-dbl-click":!0},on:{"pagination-change":e.fetchData,"filter-reset":e.handleFilterReset,"select-cancel":function(t){return e.$emit("select-cancel")},"select-end":function(t){return e.$emit("select-end")}}},[a("el-form",{attrs:{slot:"filter",inline:!0,"label-width":"72px"},slot:"filter",model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("el-form-item",{attrs:{label:"内容源"}},[a("SourceSelector",{attrs:{filterable:"",freeze:!!e.source},model:{value:e.filter.source,callback:function(t){e.$set(e.filter,"source",t)},expression:"filter.source"}})],1),a("el-form-item",{attrs:{label:"资源类型"}},[a("el-select",{attrs:{filterable:""},model:{value:e.filter.nodeType,callback:function(t){e.$set(e.filter,"nodeType",t)},expression:"filter.nodeType"}},e._l(e.options.nodeType,function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"内容类型"}},[a("el-select",{attrs:{filterable:"",clearable:""},model:{value:e.filter.cateid,callback:function(t){e.$set(e.filter,"cateid",t)},expression:"filter.cateid"}},e._l(e.options.cateid,function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"内容搜索"}},[a("el-input",{attrs:{clearable:"",filterable:""},model:{value:e.filter.title,callback:function(t){e.$set(e.filter,"title",t)},expression:"filter.title"}})],1),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{attrs:{size:"small",type:"warning"},on:{click:e.handleFilterReset}},[e._v("重置")])],1)],1)],1)},D=[],R=(a("a481"),a("4c36")),L={components:{BaseSelector:c["a"],SourceSelector:R["a"]},data:function(){return{pagination:{currentPage:1,pageSize:15},filter:this.getDefaultFilter(),efficientFilter:this.getDefaultFilter(),options:{nodeType:[{label:"直播",value:"live"},{label:"录播",value:"res"}],cateid:[{label:"足球",value:"1"},{label:"篮球",value:"2"},{label:"综合类型",value:"3"},{label:"非对阵类",value:"4"}]},table:{props:{},data:[],selected:[],header:[{prop:"vId",label:"ID",fixed:!0,width:"100"},{prop:"thirdId",label:"第三方ID",fixed:!0,width:"100"},{prop:"title",label:"标题",fixed:!0,width:"220"},{prop:"subTitle",label:"副标题",width:"120"},{prop:"cateid",label:"内容类别",width:"120"},{prop:"thumb",label:"海报",render:function(e,t){var a=t.row;return e("img",{key:a.thumb,attrs:{src:a.thumb,width:"50px",height:"50px",class:"imgs"}})},width:"120"},{prop:"startTime",label:"开始时间",width:"200"},{prop:"endTime",label:"结束时间",width:"200"},{prop:"createdDate",label:"创建时间",width:"200"},{prop:"lastUpdateDate",label:"更新时间",width:"200"}],selectionType:"single"}}},props:["isLive","selectionType","source"],computed:{selected:function(){return this.$refs.baseSelector.selected.slice()}},methods:{getDefaultFilter:function(){return{callbackparam:"result",source:this.source||this.$consts.sourceOptions[0].value,nodeType:"live",cateid:"",title:""}},getFilter:function(){var e=this.pagination,t=Object.assign({},this.efficientFilter);return e&&(t.page=e.currentPage,t.rows=e.pageSize),t.source&&(t.source=this.$consts.sourceToPartner[t.source]),t},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.efficientFilter=this.getDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=this.getFilter();this.$service.queryLiveVideoResult(t).then(function(t){t=JSON.parse(t.replace("result(","").replace(/\)*$/,"")),e.pagination.total=t.total,e.table.data=t.rows})}}},$=L,N=Object(p["a"])($,F,D,!1,null,"26c46ee9",null),E=N.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"pid","is-live":e.isLive,"selection-type":e.selectionType,table:e.table,pagination:e.pagination,"select-end-on-dbl-click":!0},on:{"pagination-change":e.fetchData,"filter-reset":e.handleFilterReset,"select-cancel":function(t){return e.$emit("select-cancel")},"select-end":function(t){return e.$emit("select-end")}}},[a("el-form",{attrs:{slot:"filter",inline:!0,"label-width":"72px"},slot:"filter",model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("el-form-item",{attrs:{label:"资源类型"}},[a("CommonSelector",{attrs:{filterable:"",options:e.pTypeEnums},model:{value:e.filter.pType,callback:function(t){e.$set(e.filter,"pType",t)},expression:"filter.pType"}})],1),a("el-form-item",{attrs:{label:"内容搜索"}},[a("el-input",{attrs:{clearable:""},model:{value:e.filter.pTitle,callback:function(t){e.$set(e.filter,"pTitle",t)},expression:"filter.pTitle"}})],1),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{attrs:{size:"small",type:"warning"},on:{click:e.handleFilterReset}},[e._v("重置")])],1)],1)},A=[],V={components:{BaseSelector:c["a"],CommonSelector:S["a"]},data:function(){return{pagination:{currentPage:1,pageSize:15},filter:this.getDefaultFilter(),efficientFilter:this.getDefaultFilter(),pTypeEnums:[{label:"直播",value:"live"},{label:"录播",value:"res"}],table:{props:{},data:[],header:[{prop:"pid",label:"ID",fixed:!0,width:"100"},{prop:"pTitle",label:"节目名",fixed:!0,width:"220"},{prop:"liveStatus",label:"直播状态",width:120},{prop:"competition",label:"赛事名",width:120},{prop:"format",label:"赛制名",width:120},{prop:"round",label:"轮次名",width:120},{prop:"pType",label:"节目类型",width:120},{prop:"homeTeam",label:"主队名",width:150},{prop:"guestTeam",label:"客队名",width:150},{prop:"groups",label:"分组名",width:150},{prop:"startTime",label:"开始时间",width:200},{prop:"endTime",label:"结束时间",width:200},{prop:"score",label:"比分",width:120},{prop:"createDate",label:"创建时间",width:200}],selected:[],selectionType:"single"}}},props:["isLive","selectionType"],computed:{selected:function(){return this.$refs.baseSelector.selected.slice()}},methods:{getDefaultFilter:function(){return{pType:"live",pTitle:void 0}},getFilter:function(){var e=this.pagination,t=Object.assign({},this.efficientFilter);return e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.efficientFilter=this.getDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=this.getFilter();this.$service.mediaPPTVVideoList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}}},B=V,M=Object(p["a"])(B,O,A,!1,null,"7bfda9c8",null),U=M.exports,G=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"coocaaVId","is-live":e.isLive,"selection-type":e.selectionType,table:e.table,pagination:e.pagination,"select-end-on-dbl-click":!0},on:{"pagination-change":e.fetchData,"filter-reset":e.handleFilterReset,"select-cancel":function(t){return e.$emit("select-cancel")},"select-end":function(t){return e.$emit("select-end")}}},[a("el-collapse",{attrs:{slot:"filter",value:"1"},on:{change:e.handleCollapseChange},slot:"filter"},[a("el-collapse-item",{attrs:{title:"查询条件",name:"1"}},[a("el-form",{staticClass:"search-form",attrs:{inline:!0,"label-width":"72px"},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilterChange(t)}},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("el-form-item",{attrs:{label:"内容商"}},[a("CommonSelector",{attrs:{filterable:"",clearable:"",options:e.contentProviderEnums},model:{value:e.filter.contentProviders,callback:function(t){e.$set(e.filter,"contentProviders",t)},expression:"filter.contentProviders"}})],1),a("el-form-item",{attrs:{label:"教育分类"}},[a("CommonSelector",{attrs:{filterable:"",clearable:"",value:e.filter.teachTypes,options:e.teachTypeEnums},on:{input:e.handleTeachTypesChange}})],1),a("el-form-item",{attrs:{label:"年级年龄"}},[a("CommonSelector",{attrs:{filterable:"",clearable:"",options:e.gradeEnums,placeholder:"请选择"},model:{value:e.filter.gradeList,callback:function(t){e.$set(e.filter,"gradeList",t)},expression:"filter.gradeList"}})],1),a("el-form-item",{attrs:{label:"内容分类"}},[a("CommonSelector",{attrs:{filterable:"",clearable:"",options:e.videoTypeEnums,placeholder:"请选择"},model:{value:e.filter.videoTypes,callback:function(t){e.$set(e.filter,"videoTypes",t)},expression:"filter.videoTypes"}})],1),a("el-form-item",{attrs:{label:"付费类型"}},[a("CommonSelector",{attrs:{filterable:"",clearable:"",options:e.payTypeEnums,placeholder:"请选择"},model:{value:e.filter.payTypes,callback:function(t){e.$set(e.filter,"payTypes",t)},expression:"filter.payTypes"}})],1),a("el-form-item",{attrs:{label:"内容标签"}},[a("CommonSelector",{attrs:{filterable:"",clearable:"",options:e.contentTagEnums,placeholder:"请选择"},model:{value:e.filter.contentTag,callback:function(t){e.$set(e.filter,"contentTag",t)},expression:"filter.contentTag"}})],1),a("el-form-item",{attrs:{label:"资源形态"}},[a("CommonSelector",{attrs:{filterable:"",clearable:"",options:e.contentFormEnums,placeholder:"请选择"},model:{value:e.filter.contentForm,callback:function(t){e.$set(e.filter,"contentForm",t)},expression:"filter.contentForm"}})],1),a("el-form-item",{attrs:{label:"课程名称"}},[a("el-input",{attrs:{clearable:"",size:"small"},model:{value:e.filter.title,callback:function(t){e.$set(e.filter,"title",t)},expression:"filter.title"}})],1),a("span",{directives:[{name:"show",rawName:"v-show",value:e.isMore,expression:"isMore"}]},[a("el-form-item",{attrs:{label:"课程版本"}},[a("CommonSelector",{attrs:{filterable:"",clearable:"",options:e.courseVersionEnums,placeholder:"请选择"},model:{value:e.filter.courseVersion,callback:function(t){e.$set(e.filter,"courseVersion",t)},expression:"filter.courseVersion"}})],1),a("el-form-item",{attrs:{label:"集数"}},[a("CommonSelector",{attrs:{filterable:"",clearable:"",options:e.segmentTagEnums,placeholder:"请选择"},model:{value:e.filter.segmentTag,callback:function(t){e.$set(e.filter,"segmentTag",t)},expression:"filter.segmentTag"}})],1),a("el-form-item",{attrs:{label:"是否全集"}},[a("el-select",{attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.filter.updateStatus,callback:function(t){e.$set(e.filter,"updateStatus",t)},expression:"filter.updateStatus"}},[a("el-option",{attrs:{label:"不限",value:0}}),a("el-option",{attrs:{label:"是",value:1}})],1)],1),a("el-form-item",{attrs:{label:"同步时间"}},[a("el-select",{attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.filter.synDate,callback:function(t){e.$set(e.filter,"synDate",t)},expression:"filter.synDate"}},[a("el-option",{attrs:{label:"7天",value:7,size:"small"}}),a("el-option",{attrs:{label:"15天",value:15,size:"small"}}),a("el-option",{attrs:{label:"1个月",value:30,size:"small"}}),a("el-option",{attrs:{label:"3个月",value:90,size:"small"}}),a("el-option",{attrs:{label:"1年",value:365,size:"small"}})],1)],1),a("el-form-item",{attrs:{label:"动漫明星"}},[a("el-input",{attrs:{clearable:"",size:"small"},model:{value:e.filter.cartoonStar,callback:function(t){e.$set(e.filter,"cartoonStar",t)},expression:"filter.cartoonStar"}})],1),a("el-form-item",{attrs:{label:"地区"}},[a("el-select",{attrs:{filterable:"",clearable:"","allow-create":"",size:"small"},model:{value:e.filter.areas,callback:function(t){e.$set(e.filter,"areas",t)},expression:"filter.areas"}},e._l(e.conditionList.areas,function(e){return a("el-option",{key:e.tagId,attrs:{label:e.tagCnName,value:e.tagCnName}})}),1)],1),a("el-form-item",{attrs:{label:"年代"}},[a("el-input",{staticStyle:{width:"72px"},attrs:{size:"small",clearable:""},on:{blur:e.yearStartListen},model:{value:e.filter.yearStart,callback:function(t){e.$set(e.filter,"yearStart",t)},expression:"filter.yearStart"}}),e._v("\n            -\n            "),a("el-input",{staticStyle:{width:"72px"},attrs:{size:"small",clearable:""},on:{blur:e.yearEndListen},model:{value:e.filter.yearEnd,callback:function(t){e.$set(e.filter,"yearEnd",t)},expression:"filter.yearEnd"}})],1),a("el-form-item",{attrs:{label:"排序方式"}},[a("el-select",{staticStyle:{width:"120px"},attrs:{filterable:"",clearable:"",size:"small"},model:{value:e.filter.orderBy,callback:function(t){e.$set(e.filter,"orderBy",t)},expression:"filter.orderBy"}},e._l(e.conditionList.orderBy,function(e){return a("el-option",{key:e.tagId,attrs:{label:e.tagCnName,value:e.tagEnName}})}),1),a("el-tooltip",{attrs:{content:"asc"===e.filter.order?"升序":"降序"}},[a("el-button",{attrs:{icon:"asc"===e.filter.order?"el-icon-arrow-up":"el-icon-arrow-down"},on:{click:function(t){return e.changeSort()}}})],1)],1)],1),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{icon:e.isMore?"arrow-up":"arrow-down",size:"small"},on:{click:function(t){e.isMore=!e.isMore}}},[e._v(e._s(e.isMore?"收起":"展开"))]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{attrs:{size:"small",type:"warning"},on:{click:e.handleFilterReset}},[e._v("重置")])],1)],1)],1)],1)],1)},j=[],z=(a("456d"),{components:{BaseSelector:c["a"],CommonSelector:S["a"]},data:function(){return{isMore:!1,conditionList:{},pagination:{currentPage:1,pageSize:15},filter:this.getDefaultFilter(),efficientFilter:this.getDefaultFilter(),table:{props:{},data:[],header:[{prop:"coocaaVId",label:"ID",fixed:!0,width:"220"},{prop:"title",label:"课程名称",fixed:!0,width:"220"},{prop:"description",label:"课程简介",width:"250",showOverflowTooltip:!0},{prop:"sourceName",label:"内容提供商",width:"150"},{prop:"videoKey",label:"自定义标签",width:"150"},{prop:"classfication",label:"第三方标签",width:"150"},{prop:"thumb",label:"图片",width:"120",render:function(e,t){var a=t.row;return e("img",{key:a.thumb,attrs:{src:a.thumb,width:"50px",height:"50px",class:"imgs"}})}},{label:"课程集数",width:"120",formatter:function(e){var t=e.ccVideoSourceEntities||[],a=t[0]||{};return a.publishSegment}}],selectionType:"single"}}},computed:{selected:function(){return this.$refs.baseSelector.selected.slice()},contentProviderEnums:function(){return(this.conditionList.contentProviders||[]).map(function(e){var t=e.tagCnName;return{label:t,value:t}})},teachTypeEnums:function(){var e=this.conditionList.sources;return e?e[0].child.map(function(e){var t=e.categoryName;return{label:t,value:t}}):[]},gradeEnums:function(){var e=this.conditionList.gradeList,t=this.filter.teachTypes,a={"幼儿":[0,2],"小学":[2,8],"初中":[8,11],"高中":[11,14]},n=a[t];if(n&&e){var i=e.map(function(e){var t=e.tagCnName;return{label:t,value:t}});return i.slice(n[0],n[1])}return[]},videoTypeEnums:function(){var e=this.filter.teachTypes;return e?(this.conditionList.sources[0].child.find(function(t){var a=t.categoryName;return a===e}).child[0].tagEntities||[]).map(function(e){var t=e.tagName;return{label:t,value:t}}):[]},payTypeEnums:function(){return(this.conditionList.payTypes||[]).map(function(e){var t=e.tagCnName,a=e.tagEnName;return{label:t,value:a}})},contentTagEnums:function(){return(this.conditionList.contentTag||[]).map(function(e){var t=e.tagCnName;return{label:t,value:t}})},courseVersionEnums:function(){return(this.conditionList.courseVersion||[]).map(function(e){var t=e.tagCnName;return{label:t,value:t}})},segmentTagEnums:function(){return(this.conditionList.segmentTag||[]).map(function(e){var t=e.tagCnName,a=e.tagEnName;return{label:t,value:a}})},contentFormEnums:function(){return[{label:"不限",value:0},{label:"视频",value:1},{label:"绘本",value:2},{label:"听故事",value:3}]}},props:["isLive","selectionType","idType"],methods:{handleCollapseChange:function(){setTimeout(function(){window.dispatchEvent(new Event("resize"))},1e3)},getDefaultFilter:function(){return{resType:"vod",callbackparam:"result",contentProviders:void 0,teachTypes:void 0,gradeList:void 0,videoTypes:void 0,payTypes:void 0,contentTag:void 0,contentForm:void 0,orderBy:void 0,order:"desc",title:void 0,courseVersion:void 0,segmentTag:void 0,updateStatus:void 0,synDate:void 0,cartoonStar:void 0,areas:"",yearStart:void 0,yearEnd:void 0,businessType:1,idType:this.idType}},getFilter:function(){var e=this.pagination,t=this.efficientFilter,a=Object.keys(t).reduce(function(e,a){return""!==t[a]&&(e[a]=t[a]),e},{});return e&&(a.page=e.currentPage,a.rows=e.pageSize),a},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.efficientFilter=this.getDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=this.getFilter();this.$service.getMediaVideoInfos(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},handleTeachTypesChange:function(e){this.filter.gradeList=void 0,this.filter.videoTypes=void 0,this.filter.teachTypes=e},yearStartListen:function(){this.filter.yearStart&&!+this.filter.yearStart&&(this.$message("年代必须为数字"),this.filter.yearStart=null)},yearEndListen:function(){this.filter.yearEnd&&!+this.filter.yearEnd&&(this.$message("年代必须为数字"),this.filter.yearEnd=null)},changeSort:function(){"asc"===this.filter.order?this.filter.order="desc":this.filter.order="asc"}},created:function(){var e=this,t={type:"vod",businessType:1};this.$service.mediaGetCondition(t).then(function(t){e.conditionList=t.vod})}}),W=z,q=(a("ea7f"),Object(p["a"])(W,G,j,!1,null,"4e1980a8",null)),J=q.exports,H=a("25d0"),K=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"pluginId","is-live":e.isLive,"selection-type":e.selectionType,table:e.table,pagination:e.pagination,filter:e.filter,"filter-schema":e.filterSchema,"select-end-on-dbl-click":!0},on:{"pagination-change":e.fetchData,"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset,"select-cancel":function(t){return e.$emit("select-cancel")},"select-end":e.handleSelectEnd}},[a("el-form",{attrs:{slot:"filter",model:e.filter,"label-width":"80px",inline:!0},nativeOn:{reset:function(t){return t.preventDefault(),e.handleFilterReset(t)},submit:function(t){return t.preventDefault(),e.handleFilterChange(t)}},slot:"filter"},[a("el-form-item",{attrs:{label:""}},[a("InputPositiveInt",{attrs:{clearable:"",placeholder:"功能ID"},model:{value:e.filter.pluginId,callback:function(t){e.$set(e.filter,"pluginId",t)},expression:"filter.pluginId"}})],1),a("el-form-item",{attrs:{label:""}},[a("el-input",{attrs:{clearable:"",placeholder:"功能名称"},model:{value:e.filter.pluginName,callback:function(t){e.$set(e.filter,"pluginName","string"===typeof t?t.trim():t)},expression:"filter.pluginName"}})],1),a("el-form-item",{attrs:{label:""}},[a("CommonSelector",{attrs:{filterable:"",options:e.sourceOptions,placeholder:"内容源"},model:{value:e.filter.source,callback:function(t){e.$set(e.filter,"source",t)},expression:"filter.source"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary","native-type":"submit"}},[e._v("查询")]),a("el-button",{attrs:{"native-type":"reset"}},[e._v("重置")])],1)],1)],1)},Y=[],Q={"":"0",o_tencent:"1",o_iqiyi:"2",o_youku:"3"},X={components:{BaseSelector:c["a"],CommonSelector:S["a"],InputPositiveInt:g["a"]},data:function(){return{pagination:{currentPage:1,pageSize:15},filter:this.getDefaultFilter(),efficientFilter:this.getDefaultFilter(),filterSchema:null,table:{props:{},header:[{prop:"pluginId",label:"功能ID",width:"80"},{prop:"pluginName",label:"功能名称"},{prop:"source",label:"内容源",width:"120",options:[],render:function(e,t){var a=t.row,n="";switch(a.source){case 0:n="无";break;case 1:n="腾讯";break;case 2:n="爱奇艺";break;case 3:n="优酷";break;default:n="Error: 没有对应的处理!!";break}return n}},{prop:"globalPicture.pictureId",label:"通用内容图片",render:function(e,t){var a=t.row,n=a.globalPicture,i="block/sign.png",r=n&&n.pictureUrl,o="/themes/images/block/sign.png"===r?i:r;return e("img",{style:{"max-height":"64px","max-width":"120px"},attrs:{referrerpolicy:"no-referrer",src:o}})}},{prop:"createdDate",label:"创建时间"},{prop:"modifierName",label:"更新人"}],data:[]}}},props:["isLive","selectionType","source","beforeSelectEndCb"],computed:{selected:function(){return this.$refs.baseSelector.selected.slice()}},methods:{getDefaultFilter:function(){return{pluginId:void 0,pluginName:void 0,pluginStatus:4,source:Q[this.source]}},getFilter:function(){var e=this.pagination,t=JSON.parse(JSON.stringify(this.efficientFilter));return t.code=t.id,e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.efficientFilter=this.getDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=this.getFilter();this.$service.getMultiBlockList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},handleSelectEnd:function(e){var t=!0;this.beforeSelectEndCb&&(t=this.beforeSelectEndCb(e)),t&&this.$emit("select-end",e)}},created:function(){var e=this.source,t=JSON.parse(JSON.stringify(this.$consts.sourceOptionsWithEmpty));e&&(t=t.filter(function(t){return t.value===e||""===t.value})),t.forEach(function(e){e.value=Q[e.value]}),this.sourceOptions=t}},Z=X,ee=Object(p["a"])(Z,K,Y,!1,null,"8f2a4d4a",null),te=ee.exports,ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"id","is-live":e.isLive,"selection-type":e.selectionType,table:e.table,pagination:e.pagination,filter:e.filter,"filter-schema":null,"select-end-on-dbl-click":!0},on:{"pagination-change":e.fetchData,"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset,"select-cancel":function(t){return e.$emit("select-cancel")},"select-end":function(t){return e.$emit("select-end")}}},[a("el-form",{attrs:{slot:"filter",model:e.filter,"label-width":"80px",inline:!0},nativeOn:{reset:function(t){return t.preventDefault(),e.handleFilterReset(t)},submit:function(t){return t.preventDefault(),e.handleFilterChange(t)}},slot:"filter"},[a("el-form-item",{attrs:{label:""}},[a("InputPositiveInt",{attrs:{clearable:"",placeholder:"轮播入口ID"},model:{value:e.filter.id,callback:function(t){e.$set(e.filter,"id",t)},expression:"filter.id"}})],1),a("el-form-item",{attrs:{label:""}},[a("el-input",{attrs:{clearable:"",placeholder:"轮播入口名称"},model:{value:e.filter.title,callback:function(t){e.$set(e.filter,"title","string"===typeof t?t.trim():t)},expression:"filter.title"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary","native-type":"submit"}},[e._v("查询")]),a("el-button",{attrs:{"native-type":"reset"}},[e._v("重置")])],1)],1)],1)},ne=[],ie={components:{BaseSelector:c["a"],InputPositiveInt:g["a"]},data:function(){return{pagination:{currentPage:1,pageSize:15},filter:this.getDefaultFilter(),efficientFilter:this.getDefaultFilter(),filterSchema:null,table:{props:{},header:[{label:"轮播入口ID",prop:"id"},{label:"轮播入口名称",prop:"title"}],data:[]}}},props:["isLive","selectionType"],computed:{selected:function(){return this.$refs.baseSelector.selected.slice()}},methods:{getDefaultFilter:function(){return{id:void 0,title:void 0,resType:"operation",dataType:"rotate",levelType:"rotateSta",callback:"result"}},getFilter:function(){var e=this.pagination,t=JSON.parse(JSON.stringify(this.efficientFilter));return t.code=t.id,e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.efficientFilter=this.getDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=this.getFilter();this.$service.getMediaVideoInfos(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows||[]})}},created:function(){}},re=ie,oe=Object(p["a"])(re,ae,ne,!1,null,"36d3d184",null),le=oe.exports,se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"id","is-live":e.isLive,"selection-type":e.selectionType,table:e.table,pagination:e.pagination,filter:e.filter,"filter-schema":e.filterSchema,"select-end-on-dbl-click":!0},on:{"pagination-change":e.fetchData,"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset,"select-cancel":function(t){return e.$emit("select-cancel")},"select-end":function(t){return e.$emit("select-end")}}})},ce=[],ue=a("f6e7"),de=a.n(ue),pe={components:{BaseSelector:c["a"]},data:function(){var e=this;return{pagination:{currentPage:1,pageSize:15},filter:this.getDefaultFilter(),filterSchema:null,table:{props:{},header:[{label:"话题ID",prop:"id"},{label:"话题名",prop:"topicName"},{label:"话题类型",prop:"type",render:function(t,a){var n=a.row;return e.$consts.topicTypesText[n.type]}},{label:"内容源",prop:"source",render:function(t,a){var n=a.row;return e.$consts.sourceText[n.source]}}],data:[]}}},props:["isLive","selectionType","source","disablePartner"],computed:{selected:function(){return this.$refs.baseSelector.selected.slice()}},methods:{getDefaultFilter:function(){return{type:void 0,topicName:void 0,source:this.source,status:this.$consts.status.accepted}},getFilter:function(){var e=this.pagination,t=Object.assign({},this.filter);return t.code=t.id,e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(e){this.filter=e,this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=this.getFilter();this.$service.topicGetList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows||[]})}},created:function(){var e=de.a.map({topicName:de.a.o.string.other("form",{component:"Input",placeholder:"话题名",label:" "}),type:de.a.o.enum(this.$consts.topicTypesEnum).other("form",{component:"Select",placeholder:"话题类型",label:" ",clearable:!0}),source:de.a.o.enum(this.$consts.sourceEnums).other("form",{component:"Select",placeholder:"内容源",label:" ",clearable:!0,disabled:this.disablePartner})}).other("form",{cols:{item:3,label:1,wrapper:23},layout:"inline",footer:{cols:{item:3,label:1,wrapper:23},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e}},he=pe,me=Object(p["a"])(he,se,ce,!1,null,"3b78ba6e",null),fe=me.exports,ve=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"id","is-live":e.isLive,"selection-type":e.selectionType,table:e.table,pagination:e.pagination,"select-end-on-dbl-click":!0},on:{"pagination-change":e.fetchData,"filter-reset":e.handleFilterReset,"select-cancel":function(t){return e.$emit("select-cancel")},"select-end":function(t){return e.$emit("select-end")}}})},ge=[],be={components:{BaseSelector:c["a"]},data:function(){return{pagination:{currentPage:1,pageSize:50},filter:this.getDefaultFilter(),efficientFilter:this.getDefaultFilter(),table:{props:{},data:[],header:[{prop:"id",label:"ID",fixed:!0,width:"100"},{prop:"title",label:"排行榜",fixed:!0}],selected:[],selectionType:"single"}}},props:["isLive","selectionType","source","businessType"],computed:{selected:function(){return this.$refs.baseSelector.selected.slice()}},methods:{getDefaultFilter:function(){return{resType:"operation",dataType:"coocaaRanking",levelType:"childRanking",callback:"result"}},getFilter:function(){var e=this.pagination,t=Object.assign({},this.efficientFilter);return e&&(t.page=e.currentPage,t.rows=e.pageSize),t.businessType=this.businessType,t.partner=this.$consts.sourceToPartner[this.source],t},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.efficientFilter=this.getDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=this.getFilter();this.$service.getMediaVideoInfos(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows||[]})}}},ye=be,we=Object(p["a"])(ye,ve,ge,!1,null,"ad6fd45e",null),Ie=we.exports,Ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"resourceId","is-live":e.isLive,"selection-type":e.selectionType,table:e.table,pagination:e.pagination,"select-end-on-dbl-click":!0,filter:e.filter,"filter-schema":null},on:{"pagination-change":e.fetchData,"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset,"select-cancel":function(t){return e.$emit("select-cancel")},"select-end":function(t){return e.$emit("select-end")}}},[a("el-form",{attrs:{slot:"filter",model:e.filter,"label-width":"80px",inline:!0},nativeOn:{reset:function(t){return t.preventDefault(),e.handleFilterReset(t)},submit:function(t){return t.preventDefault(),e.handleFilterChange(t)}},slot:"filter"},[a("el-form-item",{attrs:{label:""}},[a("el-input",{attrs:{clearable:"",placeholder:"商品名称/ID"},model:{value:e.filter.keyword,callback:function(t){e.$set(e.filter,"keyword","string"===typeof t?t.trim():t)},expression:"filter.keyword"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary","native-type":"submit"}},[e._v("查询")]),a("el-button",{attrs:{"native-type":"reset"}},[e._v("重置")])],1)],1)],1)},Te=[],Se={components:{BaseSelector:c["a"]},data:function(){return{pagination:{currentPage:1,pageSize:15},filter:this.getDefaultFilter(),efficientFilter:this.getDefaultFilter(),filterSchema:null,table:{props:{},header:[{label:"商品ID",prop:"resourceId"},{label:"商品名称",prop:"resourceName"},{label:"供应商名称",prop:"sourceName"},{label:"商品价格",prop:"originPrice",render:function(e,t){var a=t.row;return a.originPrice/100}},{label:"宝贝图片",render:function(e,t){var a=t.row;return e("img",{class:"good-img",style:{height:"100px"},key:a.resourceImgUrl,attrs:{src:a.resourceImgUrl}})}}],data:[]}}},props:["isLive","selectionType","source","disablePartner"],computed:{selected:function(){return this.$refs.baseSelector.selected.slice()}},methods:{getDefaultFilter:function(){return{resournceName:void 0,company:void 0}},getFilter:function(){var e=this.pagination,t=JSON.parse(JSON.stringify(this.efficientFilter));return t.code=t.id,e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.efficientFilter=this.getDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=this.getFilter();this.$service.mallGetList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows||[]})}},created:function(){}},ke=Se,_e=Object(p["a"])(ke,Ce,Te,!1,null,"65c43b76",null),Pe=_e.exports,xe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"trailerId","is-live":e.isLive,"selection-type":e.selectionType,table:e.table,pagination:e.pagination,"select-end-on-dbl-click":!0},on:{"pagination-change":e.fetchData,"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset,"select-cancel":function(t){return e.$emit("select-cancel")},"select-end":function(t){return e.$emit("select-end")}}},[a("el-form",{attrs:{slot:"filter",inline:!0,"label-width":"72px"},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.stopPropagation(),e.handleFilterChange(t))}},slot:"filter",model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("el-form-item",{attrs:{label:"渠道"}},[a("CommonSelector",{attrs:{filterable:"",disabled:e.disablePartner,options:e.$consts.partnerOptions},model:{value:e.filter.partner,callback:function(t){e.$set(e.filter,"partner",t)},expression:"filter.partner"}})],1),a("el-form-item",{attrs:{label:"内容源"}},[a("CommonSelector",{attrs:{filterable:"",options:e.sourceEnums},model:{value:e.filter.sources,callback:function(t){e.$set(e.filter,"sources",t)},expression:"filter.sources"}})],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"影片名",clearable:""},model:{value:e.filter.code,callback:function(t){e.$set(e.filter,"code",t)},expression:"filter.code"}})],1),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{attrs:{size:"small",type:"warning"},on:{click:e.handleFilterReset}},[e._v("重置")])],1)],1)},Fe=[],De={components:{BaseSelector:c["a"],CommonSelector:S["a"]},data:function(){var e=this;return{pagination:{currentPage:1,pageSize:15},sourceEnums:[],sourceText:{},filter:this.getDefaultFilter(),efficientFilter:this.getDefaultFilter(),filterSchema:null,table:{props:{},header:[{label:"预约ID",prop:"trailerId"},{label:"预告片名",prop:"trailerTitle"},{label:"内容源",render:function(t,a){var n=a.row;return e.sourceText[n.thirdSource]}},{label:"有正片",render:function(e,t){var a=t.row;return a.positiveId?"是":""}}],data:[]}}},props:["isLive","selectionType","source","disablePartner"],computed:{selected:function(){return this.$refs.baseSelector.selected.slice()}},watch:{"filter.partner":"onPartnerChange"},methods:{secondToTimeStr:function(e){if(e){var t=Math.floor(e/3600),a=Math.floor((e-3600*t)/60),n=e-3600*t-60*a;return"".concat(t,"小时").concat(a,"分").concat(n,"秒")}},getDefaultFilter:function(){return{partner:this.$consts.sourceToPartner[this.source||this.$consts.sourceOptions[0].value],sources:"",code:void 0,resType:"videoReservation",callback:"result"}},getFilter:function(){var e=this.pagination,t=Object.assign({},this.efficientFilter);return e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.efficientFilter=this.getDefaultFilter(),this.pagination.currentPage=1,this.onPartnerChange().then(this.fetchData)},fetchData:function(){var e=this,t=this.getFilter();this.$service.getMediaVideoInfos(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows||t.list||[],e.setPartner(e.table.data,e.filter.partner)})},setPartner:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;e.forEach(function(e){e._partner=t})},setDefaultFilterSource:function(){var e=this.filter.partner,t=this.sourceEnums,a=t.find(function(t){return t.value===e})||t[0];a&&(this.filter.sources=a.value)},onPartnerChange:function(){var e=this,t=this.filter.partner;return this.sourceEnums=[],t?this.$service.getPartnerSource({partnerName:t}).then(function(t){var a=t.rows.reduce(function(e,t){return t.source_List&&(e=e.concat(t.source_List.map(function(e){var t=e.source_code,a=e.source_title;return{label:a,value:t}}))),e},[]);e.sourceEnums=a,e.sourceText=a.reduce(function(e,t){return e[t.value]=t.label,e},Object(r["a"])({},e.sourceText)),e.setDefaultFilterSource()}):Promise.resolve()}},created:function(){this.onPartnerChange().then(this.fetchData)}},Re=De,Le=Object(p["a"])(Re,xe,Fe,!1,null,"38e0e13f",null),$e=Le.exports,Ne=[{label:"影视中心",value:"video"},{label:"应用圈",value:"app"},{label:"教育中心",value:"edu"},{label:"PPTV资源",value:"pptv"},{label:"直播资源",value:"live"},{label:"专题资源",value:"topic"},{label:"轮播频道",value:"rotate"},{label:"多功能推荐位",value:"func"},{label:"轮播推荐位",value:"broadcast"},{label:"短视频",value:"shortVideo"},{label:"短视频话题",value:"shortVideoTopic"},{label:"排行榜",value:"ranking"},{label:"商品",value:"good"},{label:"预约影片",value:"subscribe"}],Ee={name:"ResourceSelector",components:{RemoteSelectorWrapper:o["a"],TopicSelector:m,AppSelector:I,BroadcastSelector:x,LiveSelector:E,"pptv-selector":U,EduSelector:J,VideoSelector:H["a"],FuncSelector:te,RotateSelector:le,ShortVideoTopicSelector:fe,RankingSelector:Ie,GoodSelector:Pe,SubscribeSelector:$e},data:function(){return{showDialog:!1,activeSelector:void 0,shouldAutoFetch:[],SELECTORS:Ne}},props:{disabled:{type:Boolean,default:!1},source:String,businessType:Number,disablePartner:Boolean,idType:Number,initActiveSelector:{},selectors:{type:Array,default:function(){return Ne.map(function(e){return e.value})}},isLive:Boolean,selectionType:{type:String,default:function(){return"single"}},autoFetchSelectors:{type:Array,default:function(){return["app","pptv","live","topic","rotate","func","broadcast","shortVideo","shortVideoTopic","ranking","good"]}},beforeSelectEndCbs:{}},methods:{isUseSelector:function(e){return this.selectors.indexOf(e)>-1},handleSelectStart:function(){this.shouldAutoFetch=(this.autoFetchSelectors||[]).slice(),this.handleActivateSelector(this.initActiveSelector||this.selectors[0])},handleActivateSelector:function(e){var t=this;this.activeSelector=e,this.$nextTick(function(){var a=t.shouldAutoFetch,n=a.indexOf(e),i=t.$refs[e+"-selector"];n>-1&&(a.splice(n,1),i.fetchData());var r=i.$refs.baseSelector;r&&r.setTableHeight()})},handleSelectEnd:function(){var e=this.selectionType,t=this.activeSelector,a=this.$refs;a.wrapper.handleSelectEnd();var n=this.selectors.reduce(function(n,i){var o=a[i+"-selector"];return"multiple"===e||"single"===e&&i===t?(n[i]=o.selected,"video"===i&&(n.episode=Object(r["a"])({},o.selectedEpisodes))):(n[i]=[],"video"===i&&(n.episode={})),n},{});a["video-selector"]&&Object.defineProperty(n,"videoSource",{value:a["video-selector"].filter.partner,enumerable:!1}),a["subscribe-selector"]&&Object.defineProperty(n,"subscribeSource",{value:a["subscribe-selector"].filter.partner,enumerable:!1}),this.$emit("select-end",n)},handleSelectCancel:function(){this.$refs.wrapper.handleSelectCancel()},clearSelected:function(){var e=this;this.selectors.forEach(function(t){var a=e.$refs,n=a[t+"-selector"];n&&n.$refs.baseSelector.clearSelected()})}},created:function(){},beforeCreate:function(){this.$options.components["short-video-selector"]=a("61c9").default},mounted:function(){}},Oe=Ee,Ae=(a("8232"),Object(p["a"])(Oe,n,i,!1,null,"4771211f",null));t["a"]=Ae.exports},ccbd:function(e,t,a){"use strict";var n=a("4982"),i=a.n(n);i.a},ce06:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"crowd-selector"},[a("el-dialog",{attrs:{title:"选择策略",visible:e.showPolicySelector,"append-to-body":"","before-close":e.handleClose}},[a("div",[a("el-form",{attrs:{inline:!0},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.handleFilterPolicy(t))}}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"策略名称",clearable:""},model:{value:e.filter.policyName,callback:function(t){e.$set(e.filter,"policyName",t)},expression:"filter.policyName"}})],1),a("el-button",{attrs:{type:"primary"},on:{click:e.handleFilterPolicy}},[e._v("搜索")])],1)],1),a("div",{staticClass:"name-list"},e._l(e.policy.items,function(t){return a("div",{key:t.value,staticClass:"name-list__item",attrs:{title:t.label},on:{click:function(a){return e.handleSelectPolicy(t)}}},[e._v("\n                "+e._s(t.label)+"\n            ")])}),0),a("div",{staticClass:"pagination"},[e.policy.pagination?a("el-pagination",{attrs:{"current-page":e.policy.pagination.currentPage,"page-sizes":[10,20,40,50,100,200],"page-size":e.policy.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.policy.pagination.total},on:{"size-change":e.handlePolicyPageSizeChange,"current-change":e.handlePolicyPageChange}}):e._e()],1)]),a("el-dialog",{attrs:{title:"选择人群","append-to-body":"",visible:e.showCrowdSelector,"before-close":e.handleSelectCrowdCancel}},[e.hasCascadeTag?a("div",[a("el-cascader",{attrs:{options:e.crowd.cascadeItems,filterable:"",expandTrigger:"hover",disabled:0===e.crowd.cascadeItems.length,placeholder:e.crowd.cascadeItems.length>0?"请选择":"无人群数据","change-on-select":""},model:{value:e.selectedCascaderCrowd,callback:function(t){e.selectedCascaderCrowd=t},expression:"selectedCascaderCrowd"}}),a("el-button",{attrs:{disabled:!e.selectedCascaderCrowd,type:"primary"},on:{click:e.handleSelectCascadeCrowd}},[e._v("\n                确定\n            ")])],1):a("div",{staticClass:"name-list"},e._l(e.crowd.items,function(t){return a("div",{key:t.value,staticClass:"name-list__item",attrs:{title:t.label},on:{click:function(a){return e.handleSelectCrowd(t)}}},[e._v("\n                "+e._s(t.label)+"\n            ")])}),0)])],1)},i=[],r=(a("7514"),{data:function(){return{hasCascadeTag:!1,showPolicySelector:!0,showCrowdSelector:!1,selectedPolicy:void 0,selectedCrowd:void 0,selectedCascaderCrowd:void 0,filter:{policyName:void 0},policy:{pagination:{currentPage:1,pageSize:40,total:0},items:[]},crowd:{pagination:{},items:[],cascadeItems:[]}}},props:["selectedPolicyId","selectedCrowdId"],methods:{handleClose:function(){this.showCrowdSelector=!1,this.showPolicySelector=!1,setTimeout(function(){this.$emit("select-cancel")}.bind(this),20)},handleFilterPolicy:function(){this.policy.pagination.currentPage=1,this.fetchData()},handlePolicyPageSizeChange:function(e){this.policy.pagination.pageSize=e,this.fetchData()},handlePolicyPageChange:function(e){this.policy.pagination.currentPage=e,this.fetchData()},handleSelectPolicy:function(e){this.selectedPolicy=e,this.$service.crowdRelGet({id:e.value}).then(function(t){t.hasCascadeTag?(this.hasCascadeTag=!0,this.crowd.items=t.crowdRelationship.items||[],this.crowd.cascadeItems=this.listToTree(t.crowdRelationship.items),this.showCrowdSelector=!0):this.$service.getCrowdOfPolicyWithCache({id:e.value}).then(function(e){this.hasCascadeTag=!1,this.crowd.items=e,this.showCrowdSelector=!0}.bind(this))}.bind(this))},handleSelectCrowd:function(e){this.selectedCrowd=e,this.selectEnd()},handleSelectCascadeCrowd:function(){var e=this.selectedCascaderCrowd.slice(-1)[0];this.selectedCrowd=this.crowd.items.find(function(t){return t.value===e}),this.selectEnd()},handleSelectCrowdCancel:function(){this.showCrowdSelector=!1},selectEnd:function(){this.$emit("select-end",this.selectedPolicy,this.selectedCrowd)},listToTree:function(e,t){e=JSON.parse(JSON.stringify(e)),t=t||{};for(var a,n,i,r=t.idKey||"value",o=t.parentKey||"parentValue",l=t.childrenKey||"children",s=[],c={},u=0,d=e.length;u<d;u++)a=e[u],n=a[r],i=a[o]||0,c[n]=c[n]||[],a[l]=c[n],0!==i?(c[i]=c[i]||[],c[i].push(a)):s.push(a);return s},fetchData:function(){var e=this,t=this.filter,a=this.policy.pagination,n={keyword:t.policyName,rows:a.pageSize,page:a.currentPage};this.$service.getPolicyList(n).then(function(t){e.policy.items=t.rows,e.policy.pagination.total=t.total})}},created:function(){this.$nextTick(this.fetchData)}}),o=r,l=(a("5c3f"),a("2877")),s=Object(l["a"])(o,n,i,!1,null,"5dad05cf",null);t["a"]=s.exports},ce3d:function(e,t,a){"use strict";var n=a("4287"),i=a.n(n);i.a},ce71:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PageWrapper",[a("PageContentWrapper",{directives:[{name:"show",rawName:"v-show",value:"homepage"==e.activePage,expression:"activePage == 'homepage'"}]},[a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("CommonContent",{attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{replicate:function(t){e.mode="replicate"},edit:function(t){e.mode="edit"},unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,audit:function(t){return e.$emit("upsert-end")},copy:function(t){return e.handleCopy(t)},"submit-audit":e.handleSubmitAudit,"save-draft":e.handleSaveDraft,"select-version":e.fetchData,delete:function(t){return e.$emit("upsert-end",t)}}},["read"!==e.mode?a("div",{staticClass:"hompage-upsert"},[a("el-form",{ref:"homepageForm",staticClass:"el-form-add",attrs:{model:e.homepage,rules:e.rules,"label-width":"140px"}},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form-item",{attrs:{label:"首页名称",prop:"homepageName"}},[a("el-input",{attrs:{placeholder:"首页名称"},model:{value:e.homepage.homepageName,callback:function(t){e.$set(e.homepage,"homepageName",t)},expression:"homepage.homepageName"}})],1),a("el-form-item",{attrs:{label:"首页版本号",prop:"homepageVersion"}},[a("el-input",{attrs:{placeholder:"首页版本号"},model:{value:e.homepage.homepageVersion,callback:function(t){e.$set(e.homepage,"homepageVersion",t)},expression:"homepage.homepageVersion"}})],1),a("div",{staticClass:"form-legend-header"},[a("span",[e._v("数据列表配置")])]),a("el-form-item",{attrs:{label:"首页版面"}},[a("TabSelector",{on:{"select-end":e.handleSelectTabEnd}}),a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleCreateTab}},[e._v("新建版面")]),a("span",{staticClass:"cc-form-annotation marginL remarks margin-right-20"},[e._v("至少选择1个版面")]),a("el-form",{staticClass:"tab-group-filter",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"是否固定位置"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.tabGroupFilter.tabIsFix,callback:function(t){e.$set(e.tabGroupFilter,"tabIsFix",t)},expression:"tabGroupFilter.tabIsFix"}},e._l(e.tabGroupFilterOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"初始化是否在首页分类"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.tabGroupFilter.tabIsInitInCategory,callback:function(t){e.$set(e.tabGroupFilter,"tabIsInitInCategory",t)},expression:"tabGroupFilter.tabIsInitInCategory"}},e._l(e.tabGroupFilterOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),a("OrderableTable",{staticClass:"orderableTable",attrs:{header:e.tabGroupTableHeader,"filter-fn":e.tabGroupFilterFn,"hide-action":!0},model:{value:e.tabGroupList,callback:function(t){e.tabGroupList=t},expression:"tabGroupList"}}),a("div")],1)],1)],1):e._e(),"read"===e.mode?a("div",{staticClass:"homepage-read"},[a("el-form",{staticClass:"el-form-add",attrs:{"label-width":"140px"}},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form-item",{attrs:{label:"首页名称",prop:"homepageName"}},[e._v(e._s(e.homepage.homepageName))]),a("el-form-item",{attrs:{label:"首页版本号",prop:"homepageVersion"}},[e._v(e._s(e.homepage.homepageVersion))]),a("div",{staticClass:"form-legend-header"},[a("span",[e._v("数据列表配置")])]),a("el-form-item",{attrs:{label:"首页版面"}},[a("el-form",{staticClass:"tab-group-filter",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"是否固定位置"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.tabGroupFilter.tabIsFix,callback:function(t){e.$set(e.tabGroupFilter,"tabIsFix",t)},expression:"tabGroupFilter.tabIsFix"}},e._l(e.tabGroupFilterOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"初始化是否在首页分类"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.tabGroupFilter.tabIsInitInCategory,callback:function(t){e.$set(e.tabGroupFilter,"tabIsInitInCategory",t)},expression:"tabGroupFilter.tabIsInitInCategory"}},e._l(e.tabGroupFilterOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),a("OrderableTable",{staticClass:"orderableTable",attrs:{header:e.tabGroupTableHeader,"filter-fn":e.tabGroupFilterFn,readonly:!0,"hide-action":!0},model:{value:e.tabGroupList,callback:function(t){e.tabGroupList=t},expression:"tabGroupList"}})],1)],1)],1):e._e()])],1)],1),"tab_group_setter"===e.activePage?a("PageContentWrapper",[a("HomePageTabGroupSetter",{attrs:{"title-prefix":e.title,"tab-info":e.homepage.tabInfos[e.activeTabGroupIndex],readonly:"read"===e.mode},on:{"set-end":e.handleSetTabGroupEnd,"go-back":function(t){e.activePage="homepage"}}})],1):e._e(),"tab"===e.activePage?a("PageContentWrapper",[4===e.embedTab.tabType?a("JDTabInfo",{attrs:{"title-prefix":e.title,id:e.embedTab.id,version:e.embedTab.version,"init-mode":e.embedTab.mode},on:{"upsert-end":e.handleTabEmbedBack,"go-back":function(t){e.activePage="tab_info"}}}):a("TabInfo",{attrs:{"title-prefix":e.title,id:e.embedTab.id,version:e.embedTab.version,"init-mode":e.embedTab.mode},on:{"upsert-end":e.handleTabEmbedBack,"go-back":e.handleTabEmbedBack}})],1):e._e()],1)},i=[],r=(a("7514"),a("cebc")),o=(a("20d6"),a("ac6a"),a("4bc7")),l=a("5f87"),s=a("c3d5"),c=a("8353"),u=a("363f"),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PageWrapper",[a("PageContentWrapper",{directives:[{name:"show",rawName:"v-show",value:"tab_group_setter"===e.activePage,expression:"activePage === 'tab_group_setter'"}]},[a("ContentCard",{staticClass:"cc-homepage-tab-group-setter",attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[e.readonly?e._e():a("div",[a("div",{staticClass:"actions"},[a("TabSelector",{ref:"tabSelector",attrs:{title:"添加定向版面"},on:{"select-start":e.handleSelectTabStart,"select-end":e.handleSelectTabEnd}}),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("保存")])],1),a("DataForm",[a("DataBoolean",{attrs:{type:"switch",label:"是否固定位置",value:e.tabIsFix},on:{input:e.handleInputTabIsFix}}),a("DataBoolean",{attrs:{type:"switch",label:"是否初始化在首页分类"},model:{value:e.tabIsInitInCategory,callback:function(t){e.tabIsInitInCategory=t},expression:"tabIsInitInCategory"}})],1)],1),a("OrderableTable",{ref:"tabTable",attrs:{header:e.tabTableHeader,"hide-action":!0,readonly:e.readonly,"order-text":"人群优先级"},model:{value:e.tabList,callback:function(t){e.tabList=t},expression:"tabList"}}),e.showCrowdSelector?a("CrowdSelector",{on:{"select-cancel":e.handleSelectCrowdCancel,"select-end":e.handleSelectCrowdEnd}}):e._e()],1)],1),"tab"===e.activePage?a("PageContentWrapper",[4===e.embedTab.tabType?a("JDTabInfo",{attrs:{"title-prefix":e.title,id:e.embedTab.id,version:e.embedTab.version,"init-mode":e.embedTab.mode},on:{"upsert-end":e.handleTabEmbedBack,"go-back":e.handleTabEmbedBack}}):a("TabInfo",{attrs:{"title-prefix":e.title,id:e.embedTab.id,version:e.embedTab.version,"init-mode":e.embedTab.mode},on:{"upsert-end":e.handleTabEmbedBack,"go-back":e.handleTabEmbedBack}})],1):e._e()],1)},p=[],h=a("03df"),m=a("2956"),f=a("a36a"),v=a("ce06"),g=a("2ef0"),b={mixins:[u["a"]],components:{PageWrapper:o["a"],PageContentWrapper:l["a"],TabSelector:c["a"],OrderableTable:h["a"],TabInfo:m["a"],JDTabInfo:f["a"],CrowdSelector:v["a"]},data:function(){return{activePage:"tab_group_setter",resourceName:"位置设置",showCrowdSelector:!1,tabIsFix:0,tabIsInitInCategory:0,tabList:[],embedTab:void 0,activeTabIndex:void 0}},computed:{tabTableHeader:function(){var e=this,t=[{label:"版面ID",prop:"tabId",width:120},{label:"版面名称",render:function(t,a){var n=a.$index,i=a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handlePreviewTab(i,n)}}},i.tabName)}},{label:"TAB标题(中文)",prop:"tabCnTitle"},{label:"TAB标题(英文)",prop:"tabEnTitle"},{label:"默认版面",align:"center",width:100,render:function(t,a){var n=a.$index,i=a.row;return e.readonly?i.isDefaultTab?"是":"否":t("el-radio",{attrs:{title:i.dmpInfo?"若要设置该版面为默认版面，请先取消版面定向":""},props:{label:!!i.isDefaultTab,disabled:!!i.dmpInfo,value:!0},on:{input:function(t){e.handleSetDefaultTab(n)}}},"")}},{label:"人群",render:function(t,a){var n=a.$index,i=a.row;return e.readonly?i.dmpInfo&&i.dmpInfo.dmpCrowdName:i.dmpInfo?t("el-button",{attrs:{title:i.dmpInfo.dmpCrowdName},props:{type:"text"},on:{click:function(t){e.handleSelectCrowdStart(n)}}},i.dmpInfo.dmpCrowdName):void 0}}];return this.readonly||t.push({label:"操作",width:180,render:function(t,a){var n=a.$index,i=a.row,r=[t("el-button",{on:{click:function(){e.handleRemoveTab(n)}}},"删除")];return i.dmpInfo?r.unshift(t("el-button",{on:{click:function(){e.handleRemoveCrowd(n)}}},"取消定向")):r.unshift(t("el-button",{props:{disabled:i.isDefaultTab},on:{click:function(){e.handleSelectCrowdStart(n)}}},"选择人群")),r}}),t}},props:{tabInfo:{default:function(){return{}}},readonly:{type:Boolean,default:function(){return!1}}},methods:{handleInputTabIsFix:function(e){var t=this;e?this.$confirm("不让用户移除是非常损伤用户体验的功能，过频使用可能会导致客诉，请尊重用户慎用此功能","提示").then(function(){t.tabIsFix=e}).catch(function(){}):this.tabIsFix=e},handleSave:function(){if(this.tabList.length>0){var e={tabIsFix:this.tabIsFix,tabIsInitInCategory:this.tabIsInitInCategory,tabList:this.tabList};this.tabIsFix&&(e.tabIsFocus=0),this.$emit("set-end",e)}else this.$message({type:"error",message:"请至少选择一个版面"})},handlePreviewTab:function(e,t){var a=this,n=e.tabId;this.$service.tabInfoGetBase({id:n}).then(function(i){var r=i.tabType,o=i.tabRemark;a.activePage="tab",a.embedTab={index:t,id:4===r?o:n,tabType:r,version:e.currentVersion,mode:"read"}})},handleTabEmbedBack:function(){var e=this.embedTab,t=e.index,a=e.id,n=this.tabList[t];this.activePage="tab_group_setter",this.$service.tabInfoGet({id:a}).then(function(e){Object.assign(n,e)})},handleSetDefaultTab:function(e){var t=this;this.tabList.forEach(function(a,n){n===e?t.$set(a,"isDefaultTab",!0):t.$set(a,"isDefaultTab",!1)})},handleRemoveTab:function(e){this.tabList.splice(e,1)},handleSelectTabStart:function(){var e=this;this.$nextTick(function(){var t=e.$refs.tabSelector;e.tabList.forEach(t.handleTableRowSelectionAdd)})},handleSelectTabEnd:function(e){this.$refs.tabTable.handleAppendData(e,"tabId")},handleSelectCrowdStart:function(e){this.showCrowdSelector=!0,this.activeTabIndex=e},handleSelectCrowdCancel:function(){this.showCrowdSelector=!1},handleSelectCrowdEnd:function(e,t){var a=this.tabList,n=a.findIndex(function(a){var n=a.dmpInfo;if(n&&n.dmpPolicyId===e.value&&n.dmpCrowdId===t.value)return!0});if(-1===n){this.showCrowdSelector=!1;var i=this.tabList[this.activeTabIndex];this.$set(i,"dmpInfo",{dmpPolicyId:e.value,dmpCrowdId:t.value,dmpPolicyName:e.label,dmpCrowdName:t.label})}else this.$message({type:"error",message:"第"+(n+1)+"个版面已选择该人群"})},handleRemoveCrowd:function(e){var t=this.tabList;t[e].dmpInfo=void 0}},created:function(){var e=this.tabInfo;this.tabIsFix=e.tabIsFix||0,this.tabIsInitInCategory=e.tabIsInitInCategory||0,this.tabList=Object(g["cloneDeep"])(this.tabInfo.tabList)}},y=b,w=(a("d533"),a("2877")),I=Object(w["a"])(y,d,p,!1,null,"f09701bc",null),C=I.exports,T={mixins:[u["a"]],components:{PageWrapper:o["a"],PageContentWrapper:l["a"],CommonContent:s["a"],TabSelector:c["a"],HomePageTabGroupSetter:C,OrderableTable:h["a"],TabInfo:m["a"]},data:function(){return{mode:"create",resourceName:"首页方案",activePage:"homepage",showTabGroupSetter:!1,showCrowdSelector:!1,showAuditDialog:!1,embedTab:void 0,selectedTabList:[],selectedTabListIndexed:{},activeTabGroupIndex:void 0,auditHistories:[],auditForm:{auditFlag:4,auditDesc:""},versionList:[],homepage:{homepageId:void 0,homepageName:void 0,homepageModel:"normal",homepageVersion:void 0,homepageStatus:void 0,currentVersion:void 0,defaultFocusIndex:void 0,tabInfos:[]},HOME_MODE_MAP:{normal:"普通模式",child:"儿童模式",old:"老人模式"},rules:{homepageName:[{required:!0,message:"请输入首页名称"}],homepageModel:[{required:!0,message:"请选择首页模式"}],homepageVersion:[{required:!0,message:"请输入首页版本号"}]},tabGroupFilter:{tabIsFix:-1,tabIsInitInCategory:-1},tabGroupFilterOptions:[{label:"全部",value:-1},{label:"是",value:1},{label:"否",value:0}]}},computed:{resourceInfo:function(){var e=this.homepage;if(e.homepageId)return{id:e.homepageId,type:"homepage",menuElId:"homepageInfo",version:e.currentVersion,status:e.homepageStatus}},tabGroupList:{get:function(){var e=this.homepage,t=e.tabInfos||[],a=[];return t.forEach(function(e){var t=e.tabList,n=t.findIndex(function(e){return e.isDefaultTab}),i=t[n>-1?n:0],o=n>-1,l=1===t.length&&void 0===i.dmpInfo,s=e.tabIsFix,c=s&&(o||l);e.tabIsFocus&&!c&&(e.tabIsFocus=0);var u=Object(r["a"])({tabIsFocus:e.tabIsFocus,tabIsFix:e.tabIsFix,tabIsForeverLast:e.tabIsForeverLast,tabIsInitInCategory:e.tabIsInitInCategory,tabList:t,canBeDefaultFocusTab:c,tabCount:t.length},i);a.push(u)}),a},set:function(e){var t=e.map(function(e){return{tabIsFix:e.tabIsFix,tabIsInitInCategory:e.tabIsInitInCategory,tabIsForeverLast:e.tabIsForeverLast,tabIsFocus:e.tabIsFocus,tabList:e.tabList}});this.homepage.tabInfos=t}},tabGroupTableHeader:function(){var e=this,t=[{label:"版面ID",prop:"tabId"},{label:"版面名称",render:function(t,a){var n=a.$index,i=a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handleShowTabGroup(n)}}},i.tabName)}},{prop:"tabCnTitle",label:"TAB标题(中文)"},{prop:"tabEnTitle",label:"TAB标题(英文)"},{label:"默认落焦",align:"center",render:function(t,a){var n=a.$index,i=a.row;if("read"===e.mode)return i.tabIsFocus?"是":"";var r=i.canBeDefaultFocusTab,o=t("el-radio",{props:{disabled:!r,value:i.tabIsFocus,label:1},on:{input:function(t){e.handleSetDefaultFocusTab(n)}}},"");return r||(o=t("el-tooltip",{attrs:{content:"只有固定位置，并且是普通版面或设了默认版面的定向版面组才能设为默认落焦"}},[o])),o}},{label:"固定位置",align:"center",render:function(e,t){t.$index;var a=t.row,n=a.tabIsFix;return n?"是":""}},{label:"初始化在首页分类",align:"center",render:function(e,t){t.$index;var a=t.row,n=a.tabIsInitInCategory;return n?"是":""}},{label:"版面数",prop:"tabCount",width:80},{label:"默认版面",render:function(e,t){t.$index;var a=t.row;return a.isDefaultTab?"有":""}}];return"read"!==this.mode&&t.push({label:"操作",width:80,render:function(t,a){var n=a.$index;a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handleRemoveTab(n)}}},"删除")}}),t}},props:["id","initMode","version"],methods:{tabGroupFilterFn:function(e){var t=this.tabGroupFilter,a=t.tabIsFix,n=t.tabIsInitInCategory,i=-1===a||e.tabIsFix===a,r=-1===n||e.tabIsInitInCategory===n;return i&&r},handleSetDefaultFocusTab:function(e){var t=this.homepage.tabInfos;t.forEach(function(t,a){t.tabIsFocus=a===e?1:0})},handleSetTabAlwaysLast:function(e,t){var a=this.homepage.tabInfos;t=t?1:0,t&&a.forEach(function(e,t){e.tabIsForeverLast=0}),a[e].tabIsForeverLast=t},handleShowTabGroup:function(e){this.activeTabGroupIndex=e,this.activePage="tab_group_setter"},handleSetTabGroupEnd:function(e){this.activePage="homepage";var t=this.activeTabGroupIndex,a=this.homepage,n=a.tabInfos,i=Object(r["a"])({},n[t],e);this.$set(n,t,i)},handleSaveDraft:function(){var e=JSON.parse(JSON.stringify(this.homepage));e.homepageStatus=2,"replicate"===this.mode&&(e.currentVersion=void 0),this.submit(e)},handleSubmitAudit:function(){var e=JSON.parse(JSON.stringify(this.homepage));e.homepageStatus=3,"replicate"===this.mode&&(e.currentVersion=void 0),this.submit(e)},validate:function(e,t){this.$refs.homepageForm.validate(function(a){if(a){var n=e.tabInfos;if(3===e.homepageStatus){if(0===e.tabInfos.length)return t(Error("请至少选择一个版面"));for(var i,r={},o=0,l=n.length;o<l;o++){var s=n[o].tabList,c=void 0;if(n[o].tabIsFocus&&(i=o),c=1===s.length&&void 0===s[0].dmpInfo?s[0]:s.find(function(e){return e.isDefaultTab}),c){var u=r[c.tabId];if(void 0!==u)return t(Error("第 "+(o+1)+" 个版面与第 "+(u+1)+" 个版面或默认版面重复"));r[c.tabId]=o}}if(void 0===i)return t(Error("请选择默认落焦版面"));for(var d=0,p=n.length;d<p;d++){var h=n[d].tabList;if(1!==h.length||void 0!==h[0].dmpInfo)for(var m=0,f=h.length;m<f;m++){var v=r[h[m].tabId],g=h[m].dmpInfo||{};if(!h[m].isDefaultTab){if(void 0===g.dmpCrowdId)return t(Error("请设置第 "+(d+1)+" 个组第 "+(m+1)+" 个版面的人群"));if(void 0!==v)return t(Error("第 "+(d+1)+" 个版面组里的第"+(m+1)+"个版面与第 "+(v+1)+" 个版面组的版面重复"))}}}}t()}else t(Error("请把表单填写完整"))})},submit:function(e){this.validate(e,function(t){var a=this;t?this.$message({type:"error",message:t}):this.$service.homePageInfoSave(this.parseDataToApi(e),"保存成功").then(function(e){a.$emit("upsert-end")})}.bind(this))},parseApiToData:function(e){var t=Object(g["cloneDeep"])(e);return t.tabInfos=(t.tabInfos||[]).map(function(e,t){var a=[];return e.tabId&&a.push({tabId:e.tabId,tabName:e.tabName,tabCnTitle:e.tabCnTitle,tabEnTitle:e.tabEnTitle,currentVersion:e.currentVersion,isDefaultTab:!1}),e.dmpTabList&&e.dmpTabList.forEach(function(e){var t={isDefaultTab:!1,tabId:e.tabId,tabName:e.tabName,tabCnTitle:e.tabCnTitle,tabEnTitle:e.tabEnTitle,currentVersion:e.currentVersion};-1===e.dmpCrowdId?t.isDefaultTab=!0:void 0!==e.dmpCrowdId&&(t.dmpInfo={dmpPolicyId:e.dmpPolicyId,dmpPolicyName:e.dmpPolicyName,dmpCrowdName:e.dmpCrowdName,dmpCrowdId:e.dmpCrowdId}),a.push(t)}),{tabIsFocus:e.tabIsFocus,tabIsFix:e.tabIsFix||0,tabIsForeverLast:e.tabIsForeverLast||0,tabIsInitInCategory:e.tabIsInitInCategory||0,tabList:a}}),t},parseDataToApi:function(e){var t=JSON.parse(JSON.stringify(e)),a=[];return t.tabInfos.forEach(function(e,t){var n={isDmpTab:0,tabIsFix:e.tabIsFix,tabIsInitInCategory:e.tabIsInitInCategory,tabIsForeverLast:e.tabIsForeverLast,tabIsFocus:e.tabIsFocus},i=[],r=0;e.tabList.forEach(function(a){if(void 0===a.dmpInfo&&1===e.tabList.length)n.tabId=a.tabId,n.tabSequence=t;else if(a.isDefaultTab)n.tabId=a.tabId,n.tabSequence=t;else{var o=a.dmpInfo||{};i.push({tabId:a.tabId,tabSequence:r++,dmpPolicyId:o.dmpPolicyId,dmpCrowdId:o.dmpCrowdId,dmpPolicyName:o.dmpPolicyName,dmpCrowdName:o.dmpCrowdName})}}),i.length>0&&(n.tabId&&(i.push({tabId:n.tabId,tabSequence:r++,dmpPolicyName:"不限",dmpCrowdName:"不限",dmpPolicyId:-1,dmpCrowdId:-1}),n.tabId=void 0),n.isDmpTab=1,n.dmpTabList=i),a.push(n)}),t.tabInfos=a,t},setHomepage:function(e){e=this.parseApiToData(e),Object.assign(this.homepage,e),this.selectedTabList=e.tabInfos.map(function(e){return{id:e.tabId,label:e.tabName,data:e}})},handleSelectTabEnd:function(e){var t=this.homepage.tabInfos;this.homepage.tabInfos=t.concat(e.map(function(e){return{tabIsFix:0,tabIsInitInCategory:0,tabIsForeverLast:0,tabIsFocus:0,tabList:[Object(g["cloneDeep"])(e)]}}))},handleTabEmbedBack:function(){this.activePage="homepage"},handleCreateTab:function(){this.activePage="tab",this.embedTab={mode:"create"}},handleRemoveTab:function(e){var t=this.homepage,a=t.defaultFocusIndex;this.homepage.tabInfos.splice(e,1),t.defaultFocusIndex=e<a?a-1:e===a?void 0:a},handleCopy:function(e){var t=JSON.parse(JSON.stringify(this.homepage));t.homepageId=void 0,t.homepageStatus=e,t.currentVersion="",this.submit(t)},fetchData:function(e){var t=this;this.$service.homePageGetDetail({id:this.id,version:e}).then(function(e){t.setHomepage(e)})}},created:function(){this.mode=this.initMode||"create",this.id&&this.fetchData(this.version)}},S=T,k=(a("51bf"),Object(w["a"])(S,n,i,!1,null,"04dad4b6",null));t["a"]=k.exports},ce8b:function(e,t,a){"use strict";var n=a("493a"),i=a.n(n);i.a},cf43:function(e,t,a){"use strict";var n=a("b49a"),i=a.n(n);i.a},cfc7:function(e,t,a){},cfd2:function(e,t,a){},d032:function(e,t,a){},d085:function(e,t,a){},d1ba:function(e,t,a){"use strict";var n=a("bf6e"),i=a.n(n);i.a},d1c2:function(e,t,a){"use strict";var n=a("109d"),i=a.n(n);i.a},d224:function(e,t,a){"use strict";var n=a("9cdb"),i=a.n(n);i.a},d3df:function(e,t,a){"use strict";var n=a("474f"),i=a.n(n);i.a},d406:function(e,t,a){"use strict";var n=a("82dc"),i=a.n(n);i.a},d4ff:function(e,t,a){},d533:function(e,t,a){"use strict";var n=a("62a4"),i=a.n(n);i.a},d7bf:function(e,t,a){"use strict";var n=a("e78a"),i=a.n(n);i.a},d813:function(e,t,a){},d816:function(e,t,a){},d82b:function(e,t,a){},d8c0:function(e,t,a){"use strict";var n=a("f15c"),i=a.n(n);i.a},d8ce:function(e,t,a){},da3c:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-radio-group",{attrs:{value:e.value,disabled:e.disabled},on:{input:function(t){return e.$emit("input",t)}}},e._l(e.$consts.sourceOptions,function(t,n){return a("el-radio",{key:n,attrs:{label:t.value}},[e._v("\n      "+e._s(t.label)+"\n    ")])}),1)},i=[],r={props:["value","disabled"]},o=r,l=a("2877"),s=Object(l["a"])(o,n,i,!1,null,null,null);t["a"]=s.exports},da88:function(e,t,a){"use strict";var n=a("2b84"),i=a.n(n);i.a},dc28:function(e,t,a){},dc91:function(e,t,a){},dca8:function(e,t,a){"use strict";var n=a("3172"),i=a.n(n);i.a},dde4:function(e,t,a){},df39:function(e,t,a){},df8c:function(e,t,a){},e06a:function(e,t,a){"use strict";var n=a("200b"),i=a.n(n);i.a},e20e:function(e,t,a){},e23c:function(e,t,a){},e2657:function(e,t,a){"use strict";var n=a("3f9a"),i=a.n(n);i.a},e32f:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"cc-tag-logic-filter"},[a("div",{staticClass:"tag-list"},e._l(e.tags,function(t,n){return a("div",{key:n},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleAddTagStart(n)}}},[e._v("\n        +选择标签\n      ")]),e._l(t,function(t,i){return a("el-tag",{key:t.tagCode+"-"+i,attrs:{type:"primary",closable:!0},on:{close:function(t){return e.handleRemoveTag(n,i)}}},[e._v("\n        "+e._s(t.tagCnName)+"\n      ")])})],2)}),0),e.hiddenExtend?e._e():a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleAddTagStart(e.tags.length)}}},[e._v("+且")]),e.showPanelTagsDialog?a("PanelTagSelector",{on:{"select-end":e.handleAddTagEnd,"select-cancel":e.handleAddTagCancel}}):e._e()],1)},i=[],r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"cc-media-tags-selector",attrs:{title:"选择标签",fullscreen:!0,"show-close":!1,modal:!1,"modal-append-to-body":!0,visible:!0}},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSelectEnd}},[e._v("\n    确定\n  ")]),a("el-button",{attrs:{type:"warning"},on:{click:e.handleSelectCancel}},[e._v("\n    关闭\n  ")]),a("div",{staticStyle:{"margin-top":"10px"}},[e._v("\n      已选择:\n      "),e._l(e.selectedTags,function(t){return a("el-tag",{key:t.tagCode,attrs:{closable:!0},on:{close:function(a){return e.handleRemoveTag(t)}}},[e._v("\n          "+e._s(t.tagCnName)+"\n      ")])})],2),a("MediaTagSelector",{ref:"mediaTag",on:{"get-tag-nodes":e.handleInputTags}})],1)},o=[],l=(a("20d6"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",e._l(e.levels,function(t,n){return a("div",{key:t.parentId,staticClass:"tree-level"},[e.tags[t.parentId]&&e.tags[t.parentId].length>0?[a("div",[e._v("第 "+e._s(e.toChineseNumber(n+1))+" 层")]),a("div",e._l(e.tags[t.parentId],function(i){return a("span",{key:i.tagCode,class:{"tree-node":!0,"tree-leaf":0!=i.nodeType,active:t.activeId===i.tagCode,checked:e.selectedIndex[i.tagCode]},on:{click:function(t){return e.handleSelectTag(i,n)}}},[e._v("\n        "+e._s(i.tagCnName)+"\n        "),0!=i.nodeType?a("el-checkbox",{staticClass:"tree-node__checkbox",attrs:{value:!!e.selectedIndex[i.tagCode]},on:{input:function(t){return e.handleSelectTag(i,n)}}}):e._e()],1)}),0)]:e._e()],2)}),0)}),s=[],c=(a("a481"),a("6b54"),a("28a5"),{data:function(){return{selected:[],selectedIndex:{},levels:[{parentId:"-1",activeId:void 0}],tags:{},cache:{}}},methods:{getTagsByParentCode:function(e){var t=this;if(this.cache[e])return this.cache[e];this.$service.mediaGetTagList({parentCode:e,page:1,rows:1e6}).then(function(a){t.cache[e]=a.rows,t.$set(t.tags,e,a.rows)})},handleSelectTag:function(e,t){var a=e.tagCode,n=this.levels.slice(0,t+1),i=this.selected,r=this.selectedIndex;n[t].activeId===a?n[t].activeId=void 0:r[a]||(n[t].activeId=a,n.push(this.genLevel(a)),this.getTagsByParentCode(a)),this.levels=n,0!=e.nodeType&&(r[a]?(this.$set(r,a,void 0),this.selected=i.filter(function(t){return t!==e})):(this.$set(r,a,e),this.selected.push(e)),this.$emit("get-tag-nodes",this.selected))},handleRemoveTag:function(e){this.selected=this.selected.filter(function(t){return t!==e}),this.selectedIndex[e.tagCode]=void 0,this.$emit("get-tag-nodes",this.selected)},genLevel:function(e,t){return{parentId:e,activeId:t}},toChineseNumber:function(e){var t=["零","一","二","三","四","五","六","七","八","九"],a=["","十","百","千","万"],n=0,i=e.toString().split("").reduceRight(function(e,i,r){i=+i;var o=a[n++],l=t[i];return l+(i>0?o:"")+e},"");return i.replace(/零+/,"零").replace(/.+零$/,"")}},created:function(){this.getTagsByParentCode("-1")}}),u=c,d=(a("7c65"),a("2877")),p=Object(d["a"])(u,l,s,!1,null,"c15d24d8",null),h=p.exports,m={components:{MediaTagSelector:h},data:function(){return{selectedTags:[],removingTags:[]}},methods:{handleSelectEnd:function(){if(0===this.selectedTags.length)return this.$message({type:"error",message:"请选择至少一个标签"});this.$emit("select-end",this.selectedTags.slice())},handleSelectCancel:function(){this.$emit("select-cancel")},handleRemoveTag:function(e){var t=this.selectedTags.findIndex(function(t){return t.tagCode===e.tagCode});t>-1&&this.selectedTags.splice(t,1),this.$refs.mediaTag.handleRemoveTag(e)},handleInputTags:function(e){this.selectedTags=e}}},f=m,v=(a("d1ba"),Object(d["a"])(f,r,o,!1,null,"d098557a",null)),g=v.exports,b={components:{PanelTagSelector:g},data:function(){return{showPanelTagsDialog:!1,activeTagListIndex:void 0,tags:[[]]}},props:{value:Array,hiddenExtend:{type:Boolean,default:!1}},methods:{reset:function(){this.tags=[[]]},emitInput:function(){var e=this.tags.reduce(function(e,t){return t.length>0&&e.push(t.map(function(e){return e.tagCode}).join(",")),e},[]);this.$emit("get-tag-entity",this.tags),this.$emit("input",e)},handleRemoveTag:function(e,t){var a=this.tags[e];a.splice(t,1),0===a.length&&0!==e&&this.tags.splice(e,1),this.emitInput()},handleAddTagStart:function(e){this.activeTagListIndex=e,this.showPanelTagsDialog=!0},handleAddTagCancel:function(){this.showPanelTagsDialog=!1},handleAddTagEnd:function(e){var t=this.activeTagListIndex,a=this.tags[t];a?this.$set(this.tags,t,a.concat(e)):this.$set(this.tags,t,e),this.emitInput(),this.showPanelTagsDialog=!1}},created:function(){}},y=b,w=(a("bac7"),Object(d["a"])(y,n,i,!1,null,"099c5652",null));t["a"]=w.exports},e455:function(e,t,a){},e64d:function(e,t,a){"use strict";var n=a("9002"),i=a.n(n);i.a},e736:function(e,t,a){"use strict";var n=a("bf7d"),i=a.n(n);i.a},e73c:function(e,t,a){},e78a:function(e,t,a){},e96a:function(e,t,a){"use strict";var n=a("782b"),i=a.n(n);i.a},e9b8:function(e,t,a){"use strict";var n=a("7c48"),i=a.n(n);i.a},e9f2:function(e,t,a){"use strict";var n=a("30ee"),i=a.n(n);i.a},ea07:function(e,t,a){"use strict";var n=a("8bc3"),i=a.n(n);i.a},ea3f:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return"radio"===e.type||"radio-button"===e.type?a("el-radio-group",{attrs:{value:e.value,disabled:e.disabled},on:{input:e.handleInput}},[e._l(e.options,function(t,n){return[e.hiddenItems.includes(t[e.valueKey])?e._e():a(e.radioComponent,{key:n,tag:"component",attrs:{disabled:t.disabled||e.disabledItems.includes(t[e.valueKey]),label:t[e.valueKey]}},[e._v("\n        "+e._s(t[e.labelKey])+"\n      ")])]})],2):a("el-select",{ref:"elSelect",attrs:{value:e.value,disabled:e.disabled,placeholder:e.placeholder||"请选择",filterable:e.filterable,clearable:e.clearable,"allow-create":e.allowCreate},on:{input:e.handleInput}},[e._l(e.options,function(t,n){return[e.hiddenItems.includes(t[e.valueKey])?e._e():a("el-option",{key:n,attrs:{disabled:t.disabled||e.disabledItems.includes(t[e.valueKey]),label:t[e.labelKey],value:t[e.valueKey]}})]})],2)},i=[],r={props:{type:null,options:Array,disabled:null,value:null,placeholder:null,filterable:null,clearable:null,allowCreate:null,disabledItems:{type:Array,default:function(){return[]}},hiddenItems:{type:Array,default:function(){return[]}},labelKey:{type:String,default:function(){return"label"}},valueKey:{type:String,default:function(){return"value"}}},computed:{radioComponent:function(){return"radio-button"===this.type?"el-radio-button":"el-radio"}},methods:{handleInput:function(e){if(e!==this.value){this.$emit("input",e);var t=this.$refs.elSelect;t&&this.$nextTick(function(){t.blur()})}}}},o=r,l=a("2877"),s=Object(l["a"])(o,n,i,!1,null,null,null);t["a"]=s.exports},ea7f:function(e,t,a){"use strict";var n=a("8470"),i=a.n(n);i.a},eb3f:function(e,t,a){},ec14:function(e,t,a){},ec2c:function(e,t,a){"use strict";var n=a("2351"),i=a.n(n);i.a},ed2c:function(e,t,a){},ed89:function(e,t,a){},eebe:function(e,t,a){},efa1:function(e,t,a){},efdb:function(e,t,a){},eff5:function(e,t,a){"use strict";var n=a("efdb"),i=a.n(n);i.a},f093:function(e,t,a){},f10a:function(e,t,a){},f146:function(e,t,a){"use strict";var n=a("8715"),i=a.n(n);i.a},f153:function(e,t,a){"use strict";var n=a("6283"),i=a.n(n);i.a},f15c:function(e,t,a){},f223:function(e,t,a){},f239:function(e,t,a){"use strict";var n=a("0fb4"),i=a.n(n);i.a},f352:function(e,t,a){"use strict";var n=a("d085"),i=a.n(n);i.a},f376:function(e,t,a){},f54f:function(e,t,a){},f561:function(e,t,a){"use strict";var n=a("6a1e"),i=a.n(n);i.a},f618:function(e,t,a){"use strict";var n=a("7b2c"),i=a.n(n);i.a},f78e:function(e,t,a){},fac2:function(e,t,a){},fbaf:function(e,t,a){},fe63:function(e,t,a){},feee:function(e,t,a){"use strict";var n=a("9ced"),i=a.n(n);i.a}});
//# sourceMappingURL=app.40411698.js.map