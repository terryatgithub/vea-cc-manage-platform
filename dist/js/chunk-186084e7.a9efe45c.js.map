{"version":3,"sources":["webpack:///./src/views/homePageManage/child-policy/ChildPolicyManageList.vue?c224","webpack:///./src/views/homePageManage/child-policy/ChildPolicyInfo.vue?d08c","webpack:///src/views/homePageManage/child-policy/ChildPolicyInfo.vue","webpack:///./src/views/homePageManage/child-policy/ChildPolicyInfo.vue?dfff","webpack:///./src/views/homePageManage/child-policy/ChildPolicyInfo.vue","webpack:///./src/views/homePageManage/child-policy/ChildPolicyManageIndex.vue?e12d","webpack:///./src/views/homePageManage/child-policy/ChildPolicyManageList.vue?5c84","webpack:///src/views/homePageManage/child-policy/ChildPolicyManageList.vue","webpack:///./src/views/homePageManage/child-policy/ChildPolicyManageList.vue?f128","webpack:///./src/views/homePageManage/child-policy/ChildPolicyManageList.vue","webpack:///src/views/homePageManage/child-policy/ChildPolicyManageIndex.vue","webpack:///./src/views/homePageManage/child-policy/ChildPolicyManageIndex.vue?4b98","webpack:///./src/views/homePageManage/child-policy/ChildPolicyManageIndex.vue","webpack:///./src/views/homePageManage/child-policy/ChildPolicyInfo.vue?d233"],"names":["_node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_oneOf_1_0_node_modules_css_loader_index_js_ref_11_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_11_oneOf_1_2_node_modules_stylus_loader_index_js_ref_11_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_ChildPolicyManageList_vue_vue_type_style_index_0_id_599b9264_lang_stylus_scoped_true___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_oneOf_1_0_node_modules_css_loader_index_js_ref_11_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_11_oneOf_1_2_node_modules_stylus_loader_index_js_ref_11_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_ChildPolicyManageList_vue_vue_type_style_index_0_id_599b9264_lang_stylus_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","n","ChildPolicyInfovue_type_template_id_dcdcd190_scoped_true_render","_vm","this","_h","$createElement","_c","_self","staticClass","directives","name","rawName","value","activePage","expression","attrs","title","on","go-back","$event","$emit","mode","resource-info","resourceInfo","replicate","edit","unaudit","shelves","fetchData","submit-audit","submitBtn","save-draft","audit","select-version","delete","_v","ref","model","form","label-width","label","_s","policyName","selection-type","header","homepageTableHeader","data","childHpList","id","homePageId","init-mode","version","homePageVersion","title-prefix","upsert-end","_e","staticRenderFns","ChildPolicyInfovue_type_script_lang_js_","mixins","components","Table","admin_toolkit_common","CommonContent","HomePageInfo","PageWrapper","PageContentWrapper","props","isTestPolicy","undefined","policyId","macStart","macEnd","homePageVerEnd","homePageVerStart","priority","policyStatus","deviceInfos","normalHpList","regionCityPairs","specialNormalHp","specialChildHp","formRules","ageOptions","ageEnums","computed","menuElId","type","currentVersion","status","resourceName","resourceNameMap","normal","test","child","policyType","_this","prop","width","render","h","_ref","row","age","_ref2","homepageId","click","handlePreviewHomepage","homepageName","push","_ref3","$index","HomepageSelector","selectionType","homepageModel","select-end","result","handleSelectHomepageEnd","methods","getHomepageInfo","homepage","preset","Object","objectSpread","homepageVersion","index","_ref4","_ref5","slicedToArray","oldHomepage","splice","getFormData","lodash","validateFormData","cb","_this2","$refs","validate","valid","unset","find","item","$message","error","message","parseDataToApi","map","_this3","options","jsonStr","JSON","stringify","$service","childPolicyConfSave","then","setData","childHpListIndexed","reduce","homepageVerStart","platform","getChildPolicyConfDetail","created","_this4","initMode","getDictType","dictCnName","dictEnName","disabled","child_policy_ChildPolicyInfovue_type_script_lang_js_","component","componentNormalizer","__webpack_exports__","create","handleCreate","read","handleRead","handleEdit","handleDelete","isShowList","policy-type","handleUpsertEnd","goBack","ChildPolicyManageListvue_type_template_id_599b9264_scoped_true_render","filter","filterSchema","pagination","filter-change","handleFilterChange","filter-reset","handleFilterReset","pageName","add","table","selected","select-on-row-click","row-selection-add","handleRowSelectionAdd","row-selection-remove","handleRowSelectionRemove","all-row-selection-change","handleAllRowSelectionChange","ChildPolicyManageListvue_type_template_id_599b9264_scoped_true_staticRenderFns","ChildPolicyManageListvue_type_script_lang_js_","extends","BaseList","ContentWrapper","ButtonGroupForListPage","resourceType","pageSize","selectedItems","rowKey","treeProps","children","minWidth","show-overflow-tooltip","icon","class","link","$numToAuditStatus","align","duplicateVersion","showContentAuthSettingBtn","event","stopPropagation","handleOpenContentAuthManager","contentCard","handleShowContentAuthManager","currentPage","parseFilter","page","rows","getChildPolicyManagePageList","total","expandItem","concat","toConsumableArray","targetItem","updateTableSelected","idField","forEach","newSelectedIndex","tableData","gateschema_min_default","a","o","oneOf","number","$msg","other","placeholder","string","enum","下架","上架","草稿","待审核","审核通过","审核不通过","cols","wrapper","layout","footer","showSubmit","submitText","showReset","resetText","child_policy_ChildPolicyManageListvue_type_script_lang_js_","ChildPolicyManageList","ChildPolicyManageIndexvue_type_script_lang_js_","TabPage","PolicyManageInfo","ChildPolicyInfo","PolicyManageList","policyConfRemove","join","list","onlyRefreshList","child_policy_ChildPolicyManageIndexvue_type_script_lang_js_","ChildPolicyManageIndex_component","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_oneOf_1_0_node_modules_css_loader_index_js_ref_11_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_11_oneOf_1_2_node_modules_stylus_loader_index_js_ref_11_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_ChildPolicyInfo_vue_vue_type_style_index_0_id_dcdcd190_lang_stylus_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_oneOf_1_0_node_modules_css_loader_index_js_ref_11_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_11_oneOf_1_2_node_modules_stylus_loader_index_js_ref_11_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_ChildPolicyInfo_vue_vue_type_style_index_0_id_dcdcd190_lang_stylus_scoped_true___WEBPACK_IMPORTED_MODULE_0___default"],"mappings":"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","file":"js/chunk-186084e7.a9efe45c.js","sourcesContent":["import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChildPolicyManageList.vue?vue&type=style&index=0&id=599b9264&lang=stylus&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChildPolicyManageList.vue?vue&type=style&index=0&id=599b9264&lang=stylus&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('PageWrapper',{staticClass:\"policy-info-wrapper\"},[_c('PageContentWrapper',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.activePage === 'policy_info'),expression:\"activePage === 'policy_info'\"}]},[_c('ContentCard',{attrs:{\"title\":_vm.title},on:{\"go-back\":function($event){return _vm.$emit('go-back')}}},[_c('CommonContent',{attrs:{\"mode\":_vm.mode,\"resource-info\":_vm.resourceInfo},on:{\"replicate\":function($event){_vm.mode = 'replicate'},\"edit\":function($event){_vm.mode = 'edit'},\"unaudit\":function($event){return _vm.$emit('upsert-end')},\"shelves\":_vm.fetchData,\"submit-audit\":function($event){return _vm.submitBtn(3)},\"save-draft\":function($event){return _vm.submitBtn(2)},\"audit\":function($event){return _vm.$emit('upsert-end')},\"select-version\":_vm.fetchData,\"delete\":function($event){return _vm.$emit('upsert-end', $event)}}},[_c('div',{staticClass:\"form-legend-header\"},[_c('i',{staticClass:\"el-icon-edit\"},[_vm._v(\"基本信息\")])]),_c('DataForm',{ref:\"form\",attrs:{\"model\":_vm.form,\"label-width\":\"120px\"}},[_c('el-form-item',{attrs:{\"label\":\"策略名称\"}},[_vm._v(\"\\n            \"+_vm._s(_vm.form.policyName)+\"\\n          \")]),_c('el-form-item',{attrs:{\"label\":\"首页方案\"}},[_c('Table',{attrs:{\"selection-type\":\"none\",\"header\":_vm.homepageTableHeader,\"data\":_vm.form.childHpList}})],1)],1)],1)],1)],1),(_vm.activePage === 'showHomePageDetail')?_c('PageContentWrapper',[_c('HomePageInfo',{attrs:{\"id\":_vm.homePageId,\"init-mode\":\"read\",\"version\":_vm.homePageVersion,\"title-prefix\":_vm.title},on:{\"upsert-end\":function($event){_vm.activePage = 'policy_info'},\"go-back\":function($event){_vm.activePage = 'policy_info'}}})],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n<PageWrapper class=\"policy-info-wrapper\">\n  <PageContentWrapper v-show=\"activePage === 'policy_info'\">\n    <ContentCard :title=\"title\" @go-back=\"$emit('go-back')\">\n      <!--新增编辑界面-->\n      <CommonContent\n        :mode=\"mode\"\n        :resource-info=\"resourceInfo\"\n        @replicate=\"mode = 'replicate'\"\n        @edit=\"mode = 'edit'\"\n        @unaudit=\"$emit('upsert-end')\"\n        @shelves=\"fetchData\"\n        @submit-audit=\"submitBtn(3)\"\n        @save-draft=\"submitBtn(2)\"\n        @audit=\"$emit('upsert-end')\"\n        @select-version=\"fetchData\"\n        @delete=\"$emit('upsert-end', $event)\">\n        <div class=\"form-legend-header\">\n          <i class=\"el-icon-edit\">基本信息</i>\n        </div>\n        <DataForm ref=\"form\" :model=\"form\" label-width=\"120px\">\n          <el-form-item label=\"策略名称\">\n            {{ form.policyName }}\n          </el-form-item>\n          <el-form-item label=\"首页方案\">\n            <Table\n            selection-type=\"none\"\n            :header=\"homepageTableHeader\"\n            :data=\"form.childHpList\"/>\n          </el-form-item>\n        </DataForm>\n      </CommonContent>\n    </ContentCard>\n  </PageContentWrapper>\n  <PageContentWrapper v-if=\"activePage === 'showHomePageDetail'\">\n    <HomePageInfo\n      :id=\"homePageId\"\n      init-mode=\"read\"\n      :version=\"homePageVersion\"\n      :title-prefix=\"title\"\n      @upsert-end=\"activePage = 'policy_info'\"\n      @go-back=\"activePage = 'policy_info'\"\n    />\n  </PageContentWrapper>\n</PageWrapper>\n</template>\n<script>\nimport PageWrapper from '@/components/PageWrapper'\nimport PageContentWrapper from '@/components/PageContentWrapper'\nimport CommonContent from '@/components/CommonContent.vue'\nimport HomePageInfo from '../HomePageInfo'\nimport HomepageSelector from '@/components/selectors/HomepageSelector'\nimport titleMixin from '@/mixins/title'\nimport { cloneDeep } from 'lodash'\nimport { Table } from 'admin-toolkit'\nexport default {\n  mixins: [titleMixin],\n  components: {\n    Table,\n    CommonContent,\n    HomePageInfo,\n    PageWrapper,\n    PageContentWrapper\n  },\n  props: ['id', 'initMode', 'version', 'policyType'],\n  data () {\n    const isTestPolicy = this.isTestPolicy\n    return {\n      activePage: 'policy_info',\n      mode: undefined,\n      form: {\n        policyId: null,\n        policyName: null,\n        macStart: isTestPolicy ? '' : '000000000000',\n        macEnd: 'ffffffffffff',\n        homePageVerEnd: '9999999',\n        homePageVerStart: '',\n        priority: null,\n        policyStatus: 3,\n        deviceInfos: [], // 机型机芯{chip:'',model:''}\n        normalHpList: [],\n        childHpList: [],\n        regionCityPairs: [],\n        specialNormalHp: [],\n        specialChildHp: []\n      },\n      formRules: {\n      },\n      ageOptions: [],\n      ageEnums: {}\n    }\n  },\n  computed: {\n    // eslint-disable-next-line\n    resourceInfo() {\n      const form = this.form\n      const menuElId = 'childPolicy'\n      if (form.policyId) {\n        return {\n          id: form.policyId,\n          type: 'policy',\n          menuElId,\n          version: form.currentVersion,\n          status: form.policyStatus\n        }\n      }\n    },\n    resourceName () {\n      const resourceNameMap = {\n        normal: '策略',\n        test: '测试策略',\n        child: '儿童策略'\n      }\n      return resourceNameMap[this.policyType]\n    },\n    homepageTableHeader () {\n      const header = [\n        {\n          label: '年龄',\n          prop: 'age',\n          width: '100px',\n          render: (h, { row }) => {\n            const age = row.age\n            if (age === 0) {\n              return '不限'\n            }\n            return age + '岁'\n          }\n        },\n        {\n          label: '首页方案ID',\n          prop: 'homepageId',\n          width: '150px'\n        },\n        {\n          label: '首页方案名称',\n          prop: 'homepageName',\n          render: (h, { row }) => {\n            if (row.homepageId) {\n              return h('el-button', {\n                props: {\n                  type: 'text'\n                },\n                on: {\n                  click: () => {\n                    this.handlePreviewHomepage(row)\n                  }\n                }\n              }, row.homepageName)\n            }\n          }\n        }\n      ]\n      if (this.mode !== 'read') {\n        header.push({\n          label: '操作',\n          width: '200px',\n          render: (h, { row, $index }) => {\n            return h(HomepageSelector, {\n              props: {\n                title: '选择方案',\n                selectionType: 'single',\n                homepageModel: 'child'\n              },\n              on: {\n                'select-end': (result) => {\n                  this.handleSelectHomepageEnd($index, result)\n                }\n              }\n            })\n          }\n        })\n      }\n      return header\n    }\n  },\n  methods: {\n    getHomepageInfo (homepage, preset) {\n      return {\n        homepageId: homepage.homepageId,\n        homepageModel: homepage.homepageModel,\n        homepageName: homepage.homepageName,\n        homepageVersion: homepage.homepageVersion,\n        ...preset\n      }\n    },\n    handlePreviewHomepage (homepage) {\n      this.homePageId = homepage.homepageId\n      this.homePageVersion = homepage.currentVersion\n      this.activePage = 'showHomePageDetail'\n    },\n    handleSelectHomepageEnd (index, [homepage]) {\n      const childHpList = this.form.childHpList\n      const oldHomepage = childHpList[index]\n      childHpList.splice(index, 1, this.getHomepageInfo(homepage, { age: oldHomepage.age }))\n    },\n    getFormData () {\n      const data = cloneDeep(this.form)\n      return data\n    },\n    validateFormData (data, cb) {\n      this.$refs.form.$refs.form.validate(valid => {\n        if (valid) {\n          const { childHpList } = data\n          const unset = childHpList.find(item => !item.homepageId)\n          if (unset) {\n            return this.$message.error(`每一个年龄都需要设置首页方案`)\n          }\n          cb()\n        } else {\n          this.$message({\n            type: 'error',\n            message: '请把表单填写完整'\n          })\n        }\n      })\n    },\n    parseDataToApi (data) {\n      data.childHpList = data.childHpList.map((item) => {\n        return {\n          homepageId: item.homepageId,\n          age: item.age\n        }\n      })\n      data.normalHpList = data.normalHpList.map((item) => {\n        return {\n          homepageId: item.homepageId\n        }\n      })\n\n      if (this.mode === 'replicate') {\n        data.currentVersion = ''\n      }\n      return data\n    },\n    submitBtn (status) {\n      const data = this.getFormData()\n      data.policyStatus = status\n      this.validateFormData(data, () => {\n        const options = {\n          jsonStr: JSON.stringify(this.parseDataToApi(data))\n        }\n        this.$service.childPolicyConfSave(options, '保存成功').then(data => {\n          this.$emit('upsert-end')\n        })\n      })\n    },\n    setData (data) {\n      data = cloneDeep(data)\n      const childHpListIndexed = data.childHpList.reduce((result, item) => {\n        result[item.age + ''] = item\n        return result\n      }, {})\n      const childHpList = this.ageOptions.map(item => {\n        return {\n          age: item.value,\n          ...childHpListIndexed[item.value + '']\n        }\n      })\n      this.form = {\n        currentVersion: data.currentVersion,\n        policyId: data.policyId,\n        policyName: data.policyName,\n        macStart: data.macStart,\n        macEnd: data.macEnd,\n        homePageVerEnd: data.homePageVerEnd,\n        homePageVerStart: data.homepageVerStart,\n        priority: data.priority,\n        policyStatus: data.policyStatus,\n        deviceInfos: [],\n        normalHpList: data.normalHpList,\n        childHpList: childHpList,\n        platform: data.platform,\n        regionCityPairs: [],\n        specialNormalHp: [],\n        specialChildHp: []\n      }\n    },\n    fetchData (version) {\n      const options = { id: this.id, version }\n      this.$service.getChildPolicyConfDetail(options).then(this.setData)\n    }\n  },\n  created () {\n    this.mode = this.initMode || 'create'\n    this.$service.getDictType({ type: 'childAge' }).then(data => {\n      this.ageOptions = data.map(item => {\n        return {\n          label: item.dictCnName,\n          value: +item.dictEnName,\n          disabled: item.disabled\n        }\n      })\n      this.ageEnums = data.reduce((result, item) => {\n        result[item.dictEnName] = item.dictCnName\n        return result\n      }, {})\n      if (this.id) {\n        this.fetchData(this.version)\n      }\n    })\n  }\n}\n</script>\n<style lang=\"stylus\" scoped>\n.tip\n  font-size: 12px\n  margin-left: 10px\n.el-tag\n  cursor: pointer;\n.child-homepage-item\n  position relative\n  width 380px\n  border 1px solid #ccc\n  display inline-block\n  margin 10px 10px 0 0\n  padding 10px\n  .el-icon-close\n    position absolute\n    top 10px\n    right 10px\n    cursor pointer\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChildPolicyInfo.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChildPolicyInfo.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ChildPolicyInfo.vue?vue&type=template&id=dcdcd190&scoped=true&\"\nimport script from \"./ChildPolicyInfo.vue?vue&type=script&lang=js&\"\nexport * from \"./ChildPolicyInfo.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ChildPolicyInfo.vue?vue&type=style&index=0&id=dcdcd190&lang=stylus&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"dcdcd190\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('TabPage',[_c('PolicyManageList',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isShowList),expression:\"isShowList\"}],ref:\"list\",on:{\"create\":_vm.handleCreate,\"read\":_vm.handleRead,\"edit\":_vm.handleEdit,\"delete\":_vm.handleDelete}}),(!_vm.isShowList)?_c('PolicyManageInfo',{attrs:{\"id\":_vm.id,\"init-mode\":_vm.mode,\"version\":_vm.version,\"policy-type\":\"child\"},on:{\"upsert-end\":_vm.handleUpsertEnd,\"go-back\":_vm.goBack}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ContentCard',{ref:\"contentCard\",staticClass:\"content\"},[_c('ContentWrapper',{attrs:{\"filter\":_vm.filter,\"filterSchema\":_vm.filterSchema,\"pagination\":_vm.pagination},on:{\"filter-change\":_vm.handleFilterChange,\"filter-reset\":_vm.handleFilterReset}},[_c('ButtonGroupForListPage',{attrs:{\"pageName\":\"childPolicy\"},on:{\"add\":_vm.handleCreate,\"edit\":_vm.handleEdit,\"delete\":_vm.handleDelete}}),_c('Table',{staticClass:\"policy-list\",attrs:{\"props\":_vm.table.props,\"header\":_vm.table.header,\"data\":_vm.table.data,\"selected\":_vm.table.selected,\"selection-type\":_vm.table.selectionType,\"select-on-row-click\":true},on:{\"row-selection-add\":_vm.handleRowSelectionAdd,\"row-selection-remove\":_vm.handleRowSelectionRemove,\"all-row-selection-change\":_vm.handleAllRowSelectionChange}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <ContentCard ref=\"contentCard\" class=\"content\">\n    <ContentWrapper\n      :filter=\"filter\"\n      :filterSchema=\"filterSchema\"\n      :pagination=\"pagination\"\n      @filter-change=\"handleFilterChange\"\n      @filter-reset=\"handleFilterReset\"\n    >\n      <ButtonGroupForListPage\n        pageName=\"childPolicy\"\n        @add=\"handleCreate\"\n        @edit=\"handleEdit\"\n        @delete=\"handleDelete\"\n      ></ButtonGroupForListPage>\n      <Table\n        class=\"policy-list\"\n        :props=\"table.props\"\n        :header=\"table.header\"\n        :data=\"table.data\"\n        :selected=\"table.selected\"\n        :selection-type=\"table.selectionType\"\n        :select-on-row-click=\"true\"\n        @row-selection-add=\"handleRowSelectionAdd\"\n        @row-selection-remove=\"handleRowSelectionRemove\"\n        @all-row-selection-change=\"handleAllRowSelectionChange\"\n      />\n    </ContentWrapper>\n  </ContentCard>\n</template>\n\n<script>\nimport _ from 'gateschema'\nimport { ContentWrapper, Table } from 'admin-toolkit'\nimport ButtonGroupForListPage from '@/components/ButtonGroupForListPage'\nimport BaseList from '@/components/BaseList'\nexport default {\n  extends: BaseList,\n  components: {\n    Table,\n    ContentWrapper,\n    ButtonGroupForListPage\n  },\n  data () {\n    return {\n      resourceType: 'policy',\n      filter: {\n      },\n      filterSchema: null,\n      pagination: {\n        pageSize: 10\n      },\n      selected: [],\n      selectedItems: [],\n      table: {\n        props: {\n          rowKey: 'policyId',\n          treeProps: { children: 'children' }\n        },\n        header: [\n          {\n            label: 'ID',\n            prop: 'policyId',\n            width: 70\n          },\n          {\n            label: '策略名称',\n            prop: 'policyName',\n            minWidth: 150,\n            'show-overflow-tooltip': true,\n            render: (h, { row }) => {\n              const icon = h('i', {\n                class: row.children ? 'el-icon-folder' : 'el-icon-document'\n              })\n              const link = h(\n                'el-button',\n                {\n                  attrs: {\n                    type: 'text'\n                  },\n                  on: {\n                    click: () => {\n                      this.handleRead(row)\n                    }\n                  }\n                },\n                row.policyName\n              )\n              return h('div', null, [\n                icon,\n                link\n              ])\n            }\n          },\n          {\n            label: '关联首页方案',\n            width: 150,\n            prop: 'relationHomepageName'\n          },\n          {\n            label: '版本',\n            prop: 'currentVersion'\n          },\n          {\n            label: '状态',\n            prop: 'policyStatus',\n            render: (h, { row }) => {\n              return this.$numToAuditStatus(row.policyStatus)\n            }\n          },\n\n          {\n            label: '待审核副本',\n            prop: 'duplicateVersion',\n            align: 'center',\n            render: (h, { row }) => {\n              if (row.duplicateVersion === '') {\n                return ''\n              } else {\n                return h(\n                  'el-button',\n                  {\n                    attrs: {\n                      type: 'text'\n                    },\n                    on: {\n                      click: () => {\n                        this.handleRead(row, row.duplicateVersion)\n                      }\n                    }\n                  },\n                  row.duplicateVersion\n                )\n              }\n            }\n          },\n          {\n            label: '更新时间',\n            prop: 'lastUpdateDate',\n            width: 140\n          },\n          {\n            label: '更新人',\n            prop: 'modifierName'\n          },\n          {\n            label: '操作',\n            render: (h, { row }) => {\n              if (row.showContentAuthSettingBtn) {\n                return h('el-button', {\n                  props: { type: 'text' },\n                  on: {\n                    click: (event) => {\n                      event.stopPropagation()\n                      this.handleOpenContentAuthManager(row)\n                    }\n                  }\n                }, '内容权限')\n              }\n            }\n          }\n        ],\n        data: [],\n        selected: [],\n        selectionType: 'multiple'\n      }\n    }\n  },\n  methods: {\n    handleOpenContentAuthManager (row) {\n      this.$refs.contentCard.handleShowContentAuthManager({\n        id: row.policyId,\n        type: 'policy',\n        menuElId: 'policyConf'\n      })\n    },\n    // 查询\n    handleFilterChange (type, filter) {\n      if (filter) { this.filter = filter }\n      if (type === 'query') {\n        this.pagination.currentPage = 1\n      }\n      this.fetchData()\n    },\n    // 重置\n    handleFilterReset () {\n      this.filter = {\n      }\n      this.pagination.currentPage = 1\n      this.fetchData()\n    },\n    parseFilter () {\n      const { filter, pagination } = this\n      if (pagination) {\n        filter.page = pagination.currentPage\n        filter.rows = pagination.pageSize\n      }\n      return filter\n    },\n    /**\n     * 获取数据\n     */\n    fetchData () {\n      const filter = this.parseFilter()\n      this.$service.getChildPolicyManagePageList(filter).then(data => {\n        this.pagination.total = data.total\n        this.table.data = data.rows || []\n      })\n    },\n    expandItem (item) {\n      if (item.children) {\n        return [item, ...item.children]\n      }\n      return [item]\n    },\n    handleRowSelectionAdd (targetItem) {\n      this.selected = this.selected.concat(this.expandItem(targetItem))\n      this.updateTableSelected()\n    },\n    handleRowSelectionRemove (targetItem) {\n      const idField = 'policyId'\n      const index = this.expandItem(targetItem).reduce((result, item) => {\n        result[item[idField]] = true\n        return result\n      }, {})\n      this.selected = this.selected.filter(item => {\n        return !index[item[idField]]\n      })\n      this.updateTableSelected()\n    },\n    handleAllRowSelectionChange (value) {\n      if (value) {\n        this.table.data.forEach(this.handleRowSelectionAdd)\n      } else {\n        this.selected = []\n        this.table.selected = []\n      }\n    },\n    updateTableSelected () {\n      const idField = 'policyId'\n      const table = this.table\n      const newSelectedIndex = this.selected.reduce((result, item) => {\n        result[item[idField]] = true\n        return result\n      }, {})\n      const tableData = table.data.reduce((result, item) => {\n        return result.concat(this.expandItem(item))\n      }, [])\n      table.selected = tableData.reduce((result, item, index) => {\n        if (newSelectedIndex[item[idField]]) {\n          result.push(index)\n        }\n        return result\n      }, [])\n    }\n  },\n  created () {\n    let filterSchema = _.map({\n      policyId: _.o.oneOf([_.value(''), _.number]).$msg('请输入数字').other('form', {\n        component: 'InputPositiveInt',\n        placeholder: 'ID'\n      }),\n      policyName: _.o.string.other('form', {\n        component: 'Input',\n        placeholder: '策略名称'\n      }),\n      policyStatus: _.o\n        .enum({\n          下架: '0',\n          上架: '1',\n          草稿: '2',\n          待审核: '3',\n          审核通过: '4',\n          审核不通过: '5'\n        })\n        .other('form', {\n          component: 'Select',\n          placeholder: '状态'\n        })\n    }).other('form', {\n      cols: {\n        item: 5,\n        label: 0,\n        wrapper: 20\n      },\n      layout: 'inline',\n      footer: {\n        cols: {\n          label: 0,\n          wrapper: 24\n        },\n        showSubmit: true,\n        submitText: '查询',\n        showReset: true,\n        resetText: '重置'\n      }\n    })\n    this.filterSchema = filterSchema\n    this.fetchData()\n  }\n}\n</script>\n<style lang='stylus' scoped>\n.policy-list >>> .el-table__row .el-table__expand-icon\n  position absolute\n  left 3px\n  line-height 25px\n  color #000\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChildPolicyManageList.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChildPolicyManageList.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ChildPolicyManageList.vue?vue&type=template&id=599b9264&scoped=true&\"\nimport script from \"./ChildPolicyManageList.vue?vue&type=script&lang=js&\"\nexport * from \"./ChildPolicyManageList.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ChildPolicyManageList.vue?vue&type=style&index=0&id=599b9264&lang=stylus&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"599b9264\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <TabPage>\n    <PolicyManageList\n      v-show='isShowList'\n      ref=\"list\"\n      @create=\"handleCreate\"\n      @read=\"handleRead\"\n      @edit=\"handleEdit\"\n      @delete=\"handleDelete\"\n    />\n    <PolicyManageInfo\n      v-if='!isShowList'\n      :id=\"id\"\n      :init-mode=\"mode\"\n      :version=\"version\"\n      policy-type=\"child\"\n      @upsert-end=\"handleUpsertEnd\"\n      @go-back=\"goBack\">\n    </PolicyManageInfo>\n  </TabPage>\n</template>\n<script>\nimport TabPage from '@/components/TabPage'\nimport PolicyManageInfo from './ChildPolicyInfo'\nimport PolicyManageList from './ChildPolicyManageList'\nexport default {\n  components: {\n    TabPage,\n    PolicyManageInfo,\n    PolicyManageList\n  },\n  data () {\n    return {\n      isShowList: true,\n      id: undefined,\n      mode: 'create',\n      version: undefined\n    }\n  },\n  methods: {\n    handleCreate () {\n      this.id = undefined\n      this.mode = 'create'\n      this.isShowList = false\n    },\n    handleEdit (item) {\n      this.id = item.policyId\n      this.mode = 'edit'\n      this.isShowList = false\n    },\n    handleRead (item, version) {\n      this.id = item.policyId\n      this.mode = 'read'\n      this.version = version\n      this.isShowList = false\n    },\n    handleDelete (selected) {\n      this.$service\n        .policyConfRemove({\n          id: selected.map(item => item.policyId).join(',')\n        }, '删除成功')\n        .then(() => {\n          this.$refs.list.fetchData()\n        })\n    },\n    handleUpsertEnd (onlyRefreshList) {\n      this.$refs.list.fetchData()// 更新页面\n      if (!onlyRefreshList) {\n        this.isShowList = true\n        this.mode = 'list'\n        this.version = undefined\n      }\n    },\n    goBack () {\n      this.isShowList = true\n      this.mode = 'list'\n      this.version = undefined\n    }\n  }\n}\n</script>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChildPolicyManageIndex.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChildPolicyManageIndex.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ChildPolicyManageIndex.vue?vue&type=template&id=2edb20d7&\"\nimport script from \"./ChildPolicyManageIndex.vue?vue&type=script&lang=js&\"\nexport * from \"./ChildPolicyManageIndex.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChildPolicyInfo.vue?vue&type=style&index=0&id=dcdcd190&lang=stylus&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChildPolicyInfo.vue?vue&type=style&index=0&id=dcdcd190&lang=stylus&scoped=true&\""],"sourceRoot":""}