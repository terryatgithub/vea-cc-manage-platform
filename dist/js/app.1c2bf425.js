(function(e){function t(t){for(var i,r,l=t[0],s=t[1],c=t[2],d=0,p=[];d<l.length;d++)r=l[d],n[r]&&p.push(n[r][0]),n[r]=0;for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i]);u&&u(t);while(p.length)p.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],i=!0,l=1;l<a.length;l++){var s=a[l];0!==n[s]&&(i=!1)}i&&(o.splice(t--,1),e=r(r.s=a[0]))}return e}var i={},n={app:0},o=[];function r(t){if(i[t])return i[t].exports;var a=i[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=i,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(a,i,function(t){return e[t]}.bind(null,i));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var u=s;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0163":function(e,t,a){"use strict";var i=a("d42e"),n=a.n(i);n.a},"0220":function(e,t,a){"use strict";var i=a("9788"),n=a.n(i);n.a},"0243":function(e,t,a){},"0255":function(e,t,a){"use strict";var i=a("44dd"),n=a.n(i);n.a},"025b":function(e,t,a){"use strict";var i=a("b6e6"),n=a.n(i);n.a},"03d3":function(e,t,a){},"0844":function(e,t,a){"use strict";var i=a("d57e"),n=a.n(i);n.a},"087a":function(e,t,a){"use strict";var i=a("dba1"),n=a.n(i);n.a},"0933":function(e,t,a){},"0bca":function(e,t,a){"use strict";var i=a("2880"),n=a.n(i);n.a},"0c40":function(e,t,a){},"0c91":function(e,t,a){"use strict";var i=a("2f44"),n=a.n(i);n.a},"0f0b":function(e,t,a){"use strict";var i=a("03d3"),n=a.n(i);n.a},"0f1a":function(e,t,a){"use strict";var i=a("be0a"),n=a.n(i);n.a},"0f91":function(e,t,a){"use strict";var i=a("17de"),n=a.n(i);n.a},"12a1":function(e,t,a){"use strict";var i=a("f3bf"),n=a.n(i);n.a},"17de":function(e,t,a){},"1f0f":function(e,t,a){"use strict";var i=a("df77"),n=a.n(i);n.a},"216b":function(e,t,a){},2174:function(e,t,a){"use strict";var i=a("909a"),n=a.n(i);n.a},"21aa":function(e,t,a){},"221a":function(e,t,a){"use strict";var i=a("ab5a"),n=a.n(i);n.a},2366:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAFxElEQVR4Xu1bXWwUVRT+zt3WLq0iGFTAaKIRwxNIQehM2xkN4osxMSH+gQIamC2IkWh8USNogg8+KAGhu0NVFCFBjUbjkyGhs9CdLT8iEB+IGjQKifJT6w8BlpljRt1SF3fnznQ7u4Xt23bO+b5zvnvumdk7ZwmX+R9d5vmjJkCtAkIqsCSt6AI0F4DKwG0EXBUSqrgb88KUbr+XNzDSygpiGp+L0dq323qOlYMv8BYwMspkypEJQns5AiiFwczzTd3emrdJWMq7IFrA4NMAVvW1269/SHCGEkcgARZ3t7bHhPs5QKOHQirty+7DKT277UIFqJsJeDT/mZn3iCv4waSS/V4as8BQWoAndrVOrHPdQwS6JixZUD9i96Gknv1gQABL2UJE8wbjMPPPsZjQO9t6DgfF9+ylBTDS6kYCFochCetz0RZIq+8DmF+Ix4wTLjmzu7Teg0G5pAR47MCUplH9TX0Eqg9KMBR7gvt4UstuGugBafUdAIv+D5OB48ROa0rv/SYIp5QAiZ0t94HFZ0GAy2HLwDJTy3QOEsAEsKQoNvNRqqPmZGvmF1l+KQGMdMvzBLFaFrRcdsxYbeqZFy/cBVrWg8SykviM7Ckt0yZ7d5ASIGEpa0D0dLkSk8Vh5q2mbg/secNSVxFhpb8/r0xp9iv+dpJN0LCUJBElZADLbHM4pWUmX6gAVQPB8uVgnI0hN2mDvudHP1upCqigABCCJg++xRlpdQOBFwE0qmRyhESqPeP1DB8zPwsAlRSgsA9IhBvIpOorAAHKOVDm/xpXvwAAGPguJujesE97pYQZEQJ4CTDjDIi7BLDZbTx32Jyxrz/Mihf6jBgBgiYr2zsuXQHAb5qa/ZSfcJesAAAnU5q9tCbASH8O8FvB4tdrFVDbApH2AAaOAfyxYM5C4Gj40i1R1KAJYDR75wQEaizNEeUWYN5/vh53v6Xap4Yj8ULMZdYdNzpUfwDA2KroAQSeldTs3VEkn+cwrJaFRGLguOxi7ogqgJn7Td0eE2XyHpexY/o4ijUcr3wFMJ9M6fa4qAXwDmob+6/8o/ICAHDgTA1zJD0U0Yy0cj+BPolKgBQRGcXIGPxlw4Tj6rpJ354dSlKyvh2WMs0lbC/9kiaiHpAPmsE/EFMXBO8l8Jn8/x1H/FkXy52sqxcn1rX0/lYqyQcYsfjBKfHRZ+Jxx4nFXaY4cy7OLOKCMIrc2HgGphHjWRAaquc2KLt0kdpFXAGR5iZFVhOgfN8FEmmlE6AOKeGrxqiMFVAToFYBI28LMNBpapnSL1JlByRktgAz/wRgPQn+moDfh6MVsIvrQTSVQcv9hrLKKsA/7+NQ9ICRwZlzTsPsTXd1DzwADYcAecyOHvU618F+AiYWfzotYwX4CUDMzUnd3j+cSRdiL0mrcwXwUcUF8EbWTM1uijJ5j2vRjtvHNMQa+4rysrshpWef9ItL7r1AiS3A4BwazzWZM/bl/MjKed33PCAqAbykXHLnbGzPbi9ngn5YhqXMI6ItkVRAwio9m+O9vXXqeGZUZ4IdGeUG9zx5TfDaqhDAC8I7GiPB68jFIQhIT2n5rXT+uktMwqGJTKIZ4KV+EyLMvN7U7eV++FI9wK8C/Egqcb0mQDkrwEgrbxBoRSVWMiwnM9aaesZ3tE9qCxhp5TkCvRY2mMr4yc0KSgmQ2DVrDtzYF5VJJBxr4ZxxMRQpAbzDyrE71T6/LyDhQh0eL4fP39Kl7z7ihy4lgAeSSCsvA/SSH2A1XPe+nJma3SoTi7QAf4/M/9r0FRHdKgNcKRv25smEO9ts690hE4O0AB7YYmvmzYLqugm4SQa8EjYM9wVTy74qyx1IAA/U2Dv9ajrdsAbgBQAJWaJht2PsdZie6bqzZ2cQrsAC5MET1qxJIPEIgHsY5P1srvhzeZCIJG29n8kAfASEHkH8abI92y3p+h+z0AKEIatGn5oA1bgqUcZ02VfAX+O2k1+cxKrTAAAAAElFTkSuQmCC"},"252f":function(e,t,a){"use strict";var i=a("2b82"),n=a.n(i);n.a},"287d":function(e,t,a){"use strict";var i=a("b2b0"),n=a.n(i);n.a},2880:function(e,t,a){},"28cf":function(e,t,a){},"2a32":function(e,t,a){"use strict";var i=a("9c57"),n=a.n(i);n.a},"2b82":function(e,t,a){},"2d09":function(e,t,a){},"2d57":function(e,t,a){"use strict";var i=a("9d6f"),n=a.n(i);n.a},"2dd7":function(e,t,a){"use strict";var i=a("3bfc"),n=a.n(i);n.a},"2f44":function(e,t,a){},"320d":function(e,t,a){},"35a7":function(e,t,a){"use strict";var i=a("fd3d"),n=a.n(i);n.a},"37b1":function(e,t,a){},"38b6":function(e,t,a){"use strict";var i=a("efa1"),n=a.n(i);n.a},"38ff":function(e,t,a){"use strict";var i=a("3949"),n=a.n(i);n.a},3949:function(e,t,a){},"3a26":function(e,t,a){},"3b79":function(e,t,a){"use strict";var i=a("8078"),n=a.n(i);n.a},"3bfc":function(e,t,a){},"3c3a":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAF40lEQVR4Xu1bW2wUVRj+/tkCLZcKVdSd4iWKiYlQE0ChuyMRIQETjchDSZSdwQdDEA2KokaFYIpGMSgxEpQYdaclmhoDGo0xEQNxtihINEZ4MEAjsLMVA5RLobTd+c201ECxnd1zzgz7wLzu/13+b8+cPTPnLCHC62jj1HGdXlkNM1cxaVUEVIJxCoRjGuM4x+hAfMGPeyO0BApbrNWuGeGhch4zTCKeCVCQZguBvybwluvN5h/C9hdkRlj/RFNt1ekObSkBTwNUKUi0nTxeEl+Y2SOID4QpD4BXQWu91VjBjOUARgQ6CCpg9piwQS9vW0Z1ezqDyov9XGkAR5ruHdl1tnszEWYVayS4nnd53HX/OGvn0eDawiuUBfDPp0m9qxNbQXR74fLFVTLj0FBg1ljL+bM45MDVSgI41FRbEevQdgI0QZWxgXn4YHl5R01V3e4TKrSUBODaxmYAc1UYKoSDGd/rLc5sWgWvkPrBaqQDyKYTTxFp78oaKRbPzPXVVmZlsbj+9VIBtG0yxpzp5r9ANErWSLF4ZnQMQ378NdaObLHYC+ulAsimjfVEeELGgBSWuVG3MikZDuEAXNu4EcABADEZA7JY8niCzEJJPIC0sRSEdbINyOO91brZvEKURziArJ3cSqD7RIUV4vbqpnOHKJ9QAEcbp1ae84Ycu9zDv6/pmOeNv25h836REIQCcD9JTIembRcRDAPD7M2ttpq/FOEWCiCbTj5CRJtEBMPB8GLdzLwvwi0UQC6dXM5Ea0QEw8DILIqEAsimk2uIyH/cLYmLmTdUWxmh9YhQAG46+RKIXiuJ7gEw81vVVuZ5ET9iAdiJxwFto4hgSJgVuumsFuEWC6DBmAPGtyKCoWCIF+ipjNCkLBSA/+anu6PrZAEvOEPptz+pzHJYKADfgJs2fgFhciQdDiLCwHG93BlLdciLeBEPwE7UA9orIqIqMTK/AL4P4QByH90z1ivzDhNoqMqGiuVizk+qtnb8Wiyur144AJ8gayffI9ASUXEFuO9005kjwyMVwOH03VdrNNR/CLlKxoQQ1t8vgDdF5tuXugX6TOcaDJMZaaEmJEDEeDNuOS9KUPRApUZAn3j07wZ4V/yGIQmasa27JAI40lA7vsuL/UGEYbKGgvHMpGkTVO0iKxkBveuC5CIQCT2SBjd9UcVG3XQWFYkZsFxZAD2/CunkZ0Q0X5W5S3iYTw0vo5tGP+ocV6WhNAB/n6A9j/0EjFFl8GIeXqabmXdUcisNoHcUJB4i0raoNHmeqyVe7twmuuQdyI/yAHrmgxD2ColgxVOOrTrYUAJobayd6Hmx31WZZXCnXt42quQPSFzYcNY2fiJgqqIQvtFN5wFFXBfRhDICeucC4wUivKHENONt3XKeVcLVjyS0ANyG2rngmH9uQP5iflm3Mq/LE13KEFoArbbxoAd8pcI0g9dXm5knVXD15wgtADedWAbS1qowzYxMteUYKrgiDCC5HUTT1ZhmJg8TZbbBI10H5BoTd7HnH5pSen2um06dUkZVj8MXmgrzxBgRz4+nMk0qQ1A6BzCDcrbxBQgPqzT5HxfzmTLNu/Pa1I59qviVBhDJO0LGbt1yppRUAP4379rJ9US0WJWxQXkY83TLUbLGGHAEuA3TJpEXm+mBAg88E2EagNmRNN+zGYpzBF7LoK7BNDUNDHgHQbGfB3qD9L8BuLbhb3jUR9VQFDpEmBFPOdsKWge4tnEKwMgojEWlQYRV8ZTzamAA7geTh6Oioj0qY9Hp8DrdzDwTGMD5v7icjs5YVEpXArgyAgq6BbgJMfes0R7NJkdUw9/XKfAW8Etdu3Y2s5YkQg1Ao6O0GZpW78nyDwMnwdAMlCix0meBEu1xUFs9AeTs5EoujZPfEWXI+yry7c+Neey3Nvp7k3FLPg+hk9YRuQ1FhphXxq1Mvf8UNwWgXaGolDRp768C5T6edjPHylpK2ms45npOl56fAxILPVCKQJf1/z/h9HkpK4NPDs+3m/4c8C+sR/9QvJUjfgAAAABJRU5ErkJggg=="},"3cad":function(e,t,a){},"3e3a":function(e,t,a){},"3e6d":function(e,t,a){"use strict";var i=a("fde9"),n=a.n(i);n.a},"3fb4":function(e,t,a){},"41fc":function(e,t,a){},4207:function(e,t,a){"use strict";var i=a("f63c"),n=a.n(i);n.a},"44dd":function(e,t,a){},4504:function(e,t,a){},"455a":function(e,t,a){"use strict";var i=a("d6b8"),n=a.n(i);n.a},"48c0":function(e,t,a){},"490c":function(e,t,a){},"4af5":function(e,t,a){},"4bad":function(e,t,a){"use strict";var i=a("88de"),n=a.n(i);n.a},"4c87":function(e,t,a){"use strict";var i=a("cbc1"),n=a.n(i);n.a},"4cc7":function(e,t,a){},"4d21":function(e,t,a){"use strict";var i=a("a3ea"),n=a.n(i);n.a},5093:function(e,t,a){"use strict";var i=a("a14f"),n=a.n(i);n.a},"51db":function(e,t,a){"use strict";var i=a("79c8"),n=a.n(i);n.a},5245:function(e,t,a){"use strict";var i=a("490c"),n=a.n(i);n.a},"52a5":function(e,t,a){"use strict";var i=a("be9b"),n=a.n(i);n.a},"53bc":function(e,t,a){"use strict";var i=a("4504"),n=a.n(i);n.a},"53c5":function(e,t,a){},"554f":function(e,t,a){"use strict";var i=a("3cad"),n=a.n(i);n.a},5598:function(e,t,a){"use strict";var i=a("8686"),n=a.n(i);n.a},"55cf":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAE8AAABACAYAAABbYipTAAAElUlEQVR4Xu2cTYgcRRTH3+sZZXZ6DkFl9mR0BQU/IOpBklzcKF68JApL0FM8Sbp7kmzEa6KHQJAkbuiqTW7mEg9eEj/wFEhyEwSjQkCFyPqBH4gkgZ2ZXba7X+hxVsIyM/W6a2qnJ1Nzff/36r1fve6aqeppBPvJTQBzexp2pEOHtqzE8bZ0mKkwvGp4uFzhCwevHQSzMcBRBJjdUNFFJ4rmp86eXcpVqQGnQsFb9rx96Dgf9auTAG5BkuyqLS5+a4BF5pCFgZd2XAJwWVVBCtAtl2dwYeGWSmvaXhh4Td+/CIi7OQUj0XxVygWO1qSmOPCCgLiFEsDVmhAb74lc96HpxhIeEC25Us4MjULOQOMJDwBcIUae+8gTWJ/0ZobLNvWx8O66XCy8nPeO1M3Cs/A0CGi42s6z8DQIaLjazrPwNAhouNrOs/A0CGi42s6z8DQIaLjazrPwNAj0cW03Gi+qoiZEV1Sau+0O4sDN0DiOb5s+6zC6JbXsec8i4gVAfDQLmGFpCeCKWy6/Zuq8wyy8ILjc4whxWGy4cd53hXiPK86iMwov6yKQJXGu1uR5h1l4vr8EiI9wCzWiI/rUlXKPidhG4akOsU0UtDEmJclzphYOo/DSQkYJkJLkrdri4jlTk2Qc3qgAmgaX1pUbXjsIZgBxK0bRb5UzZ35Wze5mdiAH3KrnPZmUSnUCuFENw99V+feyZ4a32mg8FREdA6LdgNjxJ6J/AeDLUhwfGfQU02YAVIFrNRrbE6JjCPDS/0CI/gKAz6hcPlI7ffpvLshM8NqetytB/AIQq70GIKKb6Dgvu2F4rV8CJgEqwQXBXiI6D4ilPvn96UTRTu5jbGx45PsPNgF+QMSHFDNzo4r4NIbh6mYCVIFb2b//sdhxrgNiRZH/V64QOzjdx4bX8v0PCPFdVlCid6pSnhqkHWYHqsB1Fq0g+BgB3mDmv7cq5ScqLRte0/d/BcSHVQE7dqKvXSlfUGmHAZADjubm7m/V68uAeJ8qp27+F1wpX1dpWfBobq7UqtfX1hcIVVAC+KcmRF2l0/0awwGXjtE+eHBrEse/cPLpaq65Qjyv0vPgzc9PtdbWWqpg63Yiul2TcgtXn7UD0/glxD1TQrC2sVYOHHg8TpKfuPkQ0fWalM+o9IWAl6UDU3BANJvlJ9c9D48DMA+4NO5EwBsEMC+4iYLXC6AOuImD11kh//trQeecwomic9xv/b1u8hNz2apWuDx2Cy8Pta6PhWfhaRDQcLWdNynwACDdjjquUe+wXR8AgAY36Eh/nnGTLKrOwtOYGQvPwtMgoOFqO68w8NJt7Onpvgc6GnkW0pWIvq9J2XmzxqAPazO0s9MRBDcRgL07rBq4yHYCuFQT4hVVjlngnUeAN1UB7wU7AhyuCvGhqhY2vO6TAt8BQFkVdMztf1QrlSfwxImmqg42vDRQy/cPE+JJVdCxtROtlRzn1UoYXuLUkAle597nefvAcY4jwDRngHHRENGPJcd5O8urlzLDS2F0z3G3AeJ2AGCdzxYc4jdVIT5HAPbrSdJ6csErOIhNS8/C00B9B08jCm6IhdIzAAAAAElFTkSuQmCC"},"561d":function(e,t,a){"use strict";var i=a("41fc"),n=a.n(i);n.a},"56d7":function(e,t,a){"use strict";a.r(t);var i={};a.r(i),a.d(i,"login",function(){return J}),a.d(i,"logout",function(){return K});var n={};a.r(n),a.d(n,"getMenu",function(){return Q}),a.d(n,"getButtonGroupForPageList",function(){return X});var o={};a.r(o),a.d(o,"uploadImage",function(){return Y}),a.d(o,"uploadLayoutFile",function(){return Z}),a.d(o,"uploadApk",function(){return ee}),a.d(o,"uploadZip",function(){return te});var r={};a.r(r),a.d(r,"getDepts",function(){return ae}),a.d(r,"userConfigMenuInfo",function(){return ie}),a.d(r,"userConfigPageList",function(){return ne}),a.d(r,"getNotRolesByUserId",function(){return oe}),a.d(r,"getRolesByUserId",function(){return re}),a.d(r,"saveUserRoles",function(){return le}),a.d(r,"userConfigEdit",function(){return se}),a.d(r,"getDictCheckedByUserId",function(){return ce}),a.d(r,"userConfigSave",function(){return ue}),a.d(r,"saveProfession",function(){return de}),a.d(r,"userConfigDelete",function(){return pe}),a.d(r,"getDictList",function(){return he}),a.d(r,"SaveDictionary",function(){return me}),a.d(r,"DeleteDict",function(){return fe}),a.d(r,"getDictCategoryList",function(){return ge}),a.d(r,"SaveDictCategory",function(){return be}),a.d(r,"getLoginLogList",function(){return ve}),a.d(r,"getSysMenuList",function(){return ye}),a.d(r,"saveSysMenu",function(){return we}),a.d(r,"editSysMenu",function(){return Ie}),a.d(r,"getNotMenuByRunId",function(){return Ce}),a.d(r,"getMenuByRunId",function(){return Te}),a.d(r,"saveMenuRun",function(){return Se}),a.d(r,"getMenuInfo",function(){return ke}),a.d(r,"deleteMenuById",function(){return _e}),a.d(r,"modifyPwd",function(){return Pe});var l={};a.r(l),a.d(l,"getRoleList",function(){return xe}),a.d(l,"userRoleList",function(){return De}),a.d(l,"saveRoleData",function(){return Fe}),a.d(l,"deleteRole",function(){return $e}),a.d(l,"setCrowdAuthOfRole",function(){return Le}),a.d(l,"getAuthList",function(){return Re}),a.d(l,"saveAuthOfRole",function(){return Ne}),a.d(l,"updateSeq",function(){return Ee}),a.d(l,"getRoleDetailById",function(){return Oe});var s={};a.r(s),a.d(s,"sysDeptPageList",function(){return Ae}),a.d(s,"sysDeptRemove",function(){return Ve}),a.d(s,"sysDeptSave",function(){return Me}),a.d(s,"sysDeptDetailInfo",function(){return Be}),a.d(s,"sysDeptUpdateSeq",function(){return Ue});var c={};a.r(c),a.d(c,"sysLogOpPageList",function(){return je});var u={};a.r(u),a.d(u,"broadcastBlockPageList",function(){return Ge}),a.d(u,"deleteBroadcastBlock",function(){return We}),a.d(u,"getCornerTypes",function(){return qe}),a.d(u,"getMaterialTypes",function(){return He}),a.d(u,"saveBlockInfo",function(){return ze}),a.d(u,"getSysPlugin",function(){return Je}),a.d(u,"editSysPlugin",function(){return Ke}),a.d(u,"getPluginParentTypes",function(){return Qe}),a.d(u,"getPluginTypes",function(){return Xe}),a.d(u,"getMediaVideoInfos",function(){return Ye}),a.d(u,"getPartnerSource",function(){return Ze}),a.d(u,"getCondition",function(){return et}),a.d(u,"queryLiveVideoResult",function(){return tt}),a.d(u,"getPluginVersions",function(){return at}),a.d(u,"getPluginType",function(){return it}),a.d(u,"getResourceList",function(){return nt}),a.d(u,"getCornerList",function(){return ot}),a.d(u,"SavePlugin",function(){return rt}),a.d(u,"getMultiBlockList",function(){return lt}),a.d(u,"getData",function(){return st}),a.d(u,"removeMulti",function(){return ct}),a.d(u,"getClickData",function(){return ut}),a.d(u,"getHistoryList",function(){return dt}),a.d(u,"getBroadcastBlockEditData",function(){return pt}),a.d(u,"broadcastBlockDataList",function(){return ht});var d={};a.r(d),a.d(d,"getAdminMasterControllInfo",function(){return mt}),a.d(d,"saveAdminMasterControll",function(){return ft});var p={};a.r(p),a.d(p,"getMaterialPageList",function(){return gt}),a.d(p,"materialBatchAudit",function(){return bt}),a.d(p,"materialBatchDelete",function(){return vt}),a.d(p,"getCommonOnclickInfoMenu",function(){return yt}),a.d(p,"getCommonOnclickInfoList",function(){return wt}),a.d(p,"commonOnclickInfoSave",function(){return It}),a.d(p,"commonOnclickInfoDelete",function(){return Ct}),a.d(p,"getCommonOnclickInfoEdit",function(){return Tt});var h={};a.r(h),a.d(h,"tabInfoList",function(){return St}),a.d(h,"getTabType",function(){return kt}),a.d(h,"getMediaResourceInfo",function(){return _t}),a.d(h,"filmDetailPageList",function(){return Pt}),a.d(h,"saveFilmDetailPage",function(){return xt}),a.d(h,"removeFilmDetailPage",function(){return Dt}),a.d(h,"tabIconList",function(){return Ft}),a.d(h,"tabInfoGet",function(){return $t}),a.d(h,"tabInfoUpsert",function(){return Lt}),a.d(h,"tabInfoRemove",function(){return Rt}),a.d(h,"editFilmDetailPage",function(){return Nt}),a.d(h,"reviewFilmDetailPage",function(){return Et}),a.d(h,"getVipButtonSource",function(){return Ot});var m={};a.r(m),a.d(m,"panelPageList",function(){return At}),a.d(m,"panelDataList",function(){return Vt}),a.d(m,"panelGetDetail",function(){return Mt}),a.d(m,"panelUpsert",function(){return Bt}),a.d(m,"panelRemove",function(){return Ut}),a.d(m,"collectCancel",function(){return jt}),a.d(m,"collect",function(){return Gt}),a.d(m,"getSharedTags",function(){return Wt});var f={};a.r(f),a.d(f,"getHomePageInfoList",function(){return qt}),a.d(f,"homePageInfoSave",function(){return Ht}),a.d(f,"homePageInfoDelete",function(){return zt}),a.d(f,"homePageGetDetail",function(){return Jt});var g={};a.r(g),a.d(g,"getMediaVideoInfos",function(){return Kt}),a.d(g,"getPartnerSource",function(){return Qt}),a.d(g,"getCondition",function(){return Xt}),a.d(g,"getSegmentList",function(){return Yt}),a.d(g,"getAppManagementList",function(){return Zt});var b={};a.r(b),a.d(b,"getMarkPanelList",function(){return ea}),a.d(b,"MarkPanelSave",function(){return ta}),a.d(b,"deleteMarkPanel",function(){return aa}),a.d(b,"getViewData",function(){return ia}),a.d(b,"getTimedInfo",function(){return na}),a.d(b,"getHandlePerson",function(){return oa});var v={};a.r(v),a.d(v,"getGlobalCornerIconTypePageList",function(){return ra}),a.d(v,"globalCornerIconTypeBatchDel",function(){return la}),a.d(v,"globalCornerIconTypeSave",function(){return sa}),a.d(v,"globalCornerIconTypeDetail",function(){return ca});var y={};a.r(y),a.d(y,"getLayoutInforPageList",function(){return ua}),a.d(y,"getLayoutInforBatchDel",function(){return da}),a.d(y,"getLayoutInforSave",function(){return pa}),a.d(y,"getLayoutInforById",function(){return ha}),a.d(y,"getAuditDetailButton",function(){return ma}),a.d(y,"auditTask",function(){return fa}),a.d(y,"revokedAudit",function(){return ga}),a.d(y,"putShelves",function(){return ba});var w={};a.r(w),a.d(w,"themeInfoPageList",function(){return va}),a.d(w,"themeInfoRemove",function(){return ya}),a.d(w,"themeInfoDetail",function(){return wa}),a.d(w,"savethemeInfo",function(){return Ia}),a.d(w,"checkThemeMd5",function(){return Ca});var I={};a.r(I),a.d(I,"globalPictureUpsert",function(){return Ta}),a.d(I,"globalPictureGet",function(){return Sa});var C={};a.r(C),a.d(C,"getGlobalMgrList",function(){return ka}),a.d(C,"getCornerTypes",function(){return _a}),a.d(C,"getIconAttributes",function(){return Pa}),a.d(C,"globalCornerIconEdit",function(){return xa}),a.d(C,"globalCornerIconSave",function(){return Da}),a.d(C,"globalCornerIconRemove",function(){return Fa}),a.d(C,"batchAudit",function(){return $a}),a.d(C,"revokedAudit",function(){return La}),a.d(C,"getDetailInfo",function(){return Ra}),a.d(C,"changePriority",function(){return Na});var T={};a.r(T),a.d(T,"advertisementList",function(){return Ea}),a.d(T,"advertisementUpsert",function(){return Oa});var S={};a.r(S),a.d(S,"getHistory",function(){return Aa}),a.d(S,"privatePanelRemove",function(){return Va});var k={};a.r(k),a.d(k,"getTotal",function(){return Ma}),a.d(k,"todoTaskPageList",function(){return Ba}),a.d(k,"getMoviePageList",function(){return Ua});var _={};a.r(_),a.d(_,"getPolicyManagePageList",function(){return ja}),a.d(_,"getTestPolicyManagePageList",function(){return Ga}),a.d(_,"getChipAndModelPageList",function(){return Wa}),a.d(_,"addChipAndModel",function(){return qa}),a.d(_,"getHomePageModelPageList",function(){return Ha}),a.d(_,"policyConfSave",function(){return za}),a.d(_,"testPolicyConfSave",function(){return Ja}),a.d(_,"policyConfRemove",function(){return Ka}),a.d(_,"testPolicyConfRemove",function(){return Qa}),a.d(_,"getPolicyConfDetail",function(){return Xa}),a.d(_,"getTestPolicyConfDetail",function(){return Ya});var P={};a.r(P),a.d(P,"floatWindowList",function(){return Za});var x={};a.r(x),a.d(x,"getVersionList",function(){return Fi}),a.d(x,"revokeAudit",function(){return $i}),a.d(x,"secondAudit",function(){return Li}),a.d(x,"getTimedTaskLimit",function(){return Ri}),a.d(x,"getTimedTaskInfo",function(){return Ni}),a.d(x,"timedTaskCancel",function(){return Ei}),a.d(x,"putOnShelves",function(){return Oi}),a.d(x,"deleteVersion",function(){return Vi}),a.d(x,"deleteResource",function(){return Bi}),a.d(x,"getAuditHistoryList",function(){return Ui}),a.d(x,"getDictType",function(){return Gi}),a.d(x,"getEnv",function(){return Wi}),a.d(x,"getRecommendStrategy",function(){return qi});var D={};a.r(D),a.d(D,"commonPannelUserList",function(){return Hi});var F={};a.r(F),a.d(F,"businessTabSave",function(){return zi}),a.d(F,"businessTabDelete",function(){return Ji}),a.d(F,"businessTabEdit",function(){return Ki}),a.d(F,"businessTabCollect",function(){return Qi}),a.d(F,"businessTabCancelCollect",function(){return Xi});var $={};a.r($),a.d($,"mediaPPTVVideoList",function(){return Yi}),a.d($,"mediaGetCondition",function(){return Zi}),a.d($,"mediaGetTagList",function(){return en});var L={};a.r(L),a.d(L,"crowdRelUpsert",function(){return tn}),a.d(L,"crowdRelGet",function(){return an}),a.d(L,"crowdRelDel",function(){return nn}),a.d(L,"crowdRefresh",function(){return on}),a.d(L,"crowdRelList",function(){return rn});var R={};a.r(R),a.d(R,"getCrowdOfPolicyWithCache",function(){return sn}),a.d(R,"getTaglist",function(){return cn}),a.d(R,"getCrowdOfPolicy",function(){return un}),a.d(R,"getCrowdPolicy",function(){return dn});var N={};a.r(N),a.d(N,"getUserContentAuth",function(){return pn}),a.d(N,"getResourceContentAuthList",function(){return hn}),a.d(N,"upsertResourceContentAuthList",function(){return mn});var E={};a.r(E),a.d(E,"desktopGetDataSyncInfo",function(){return fn}),a.d(E,"desktopUpdateDataSyncInfo",function(){return gn}),a.d(E,"desktopGetDataSyncGeneral",function(){return bn}),a.d(E,"desktopGetDataSyncList",function(){return vn});a("cadf"),a("551c"),a("f751"),a("097d");var O=a("2b0e"),A=a("5c96"),V=a.n(A),M=a("2819"),B=a.n(M),U=(a("96cf"),a("3b8d")),j=(a("456d"),a("ac6a"),a("cebc")),G=a("4328"),W=a.n(G),q=a("bc3a"),H=a.n(q);function z(e){var t=e.method,a=void 0===t?"get":t,i=e.url,n=e.data,o=e.params,r=e.isJSON,l=void 0!==r&&r,s=O["default"].prototype.$loading({lock:!0,body:!0}),c={method:a,url:i,data:l?n:"string"===typeof n?n:W.a.stringify(n),params:o};return H()(c).then(function(e){var t=e.data;if(s.close(),"undefined"!==typeof t.success&&"undefined"!==typeof t.msg){if(t.success)return"undefined"!==typeof t.data?"undefined"!==typeof t.total?{rows:t.data,total:t.total}:t.data:"undefined"!==typeof t.rows?"undefined"!==typeof t.total?{rows:t.rows,total:t.total}:t.rows:t;throw new Error(t.msg)}if("undefined"!==typeof t.rows&&"undefined"!==typeof t.total)return{rows:t.rows,total:t.total};if("undefined"!==typeof t.code&&"0"!=t.code)throw new Error(t.msg);return t}).catch(function(e){throw s.close(),e})}function J(e){var t=this;return this.fetch({method:"post",url:"api/v1/userlogin.html",data:e}).then(function(e){return t.state=e,e})}function K(e){return this.fetch({method:"get",url:"api/logout.html"}).catch(function(){})}function Q(e){return this.fetch({method:"post",url:"api/v1/getMenus.html",data:e}).then(function(e){return e})}function X(e){return this.fetch({method:"get",url:"api/v1/"+e+"/getMenuInfo.html",params:""})}function Y(e){var t=e.file,a=e.onUploadProgress,i=new FormData;return i.append("file",t),H()({method:"post",url:"api/v1/upload/image.html",data:i,onUploadProgress:a}).then(function(e){var t=e.data;return t})}function Z(e){var t=e.file,a=e.onUploadProgress,i=new FormData;return i.append("file",t),H()({method:"post",url:"api/v1/layout/getLayoutFile.html",data:i,onUploadProgress:a}).then(function(e){var t=e.data;return t})}function ee(e){var t=e.file,a=e.onUploadProgress,i=new FormData;return i.append("file",t),H()({method:"post",url:"api/v1/upload/apk.html",data:i,onUploadProgress:a}).then(function(e){var t=e.data;return t})}function te(e){var t=e.file,a=e.type,i=e.onUploadProgress,n=new FormData;return n.append("file",t),H()({method:"post",url:"api/v1/upload/zip.html?type="+a,data:n,onUploadProgress:i}).then(function(e){var t=e.data;return t})}function ae(e){return this.fetch({method:"get",url:"api/v1/sysDept/listAllDept.html",params:e})}function ie(e){return this.fetch({method:"post",url:"api/v1/sysUser/getMenuInfo.html",data:e})}function ne(e){return this.fetch({method:"post",url:"api/v1/sysUser/pageList.html",data:e})}function oe(e){return this.fetch({method:"post",url:"api/v1/sysUser/getNotRolesByUserId.html",data:e})}function re(e){return this.fetch({method:"post",url:"api/v1/sysUser/getRolesByUserId.html",data:e})}function le(e){return this.fetch({method:"post",url:"api/v1/sysUser/saveUserRoles.html",data:e})}function se(e){return this.fetch({method:"get",url:"api/v1/sysUser/getDetailInfo.html",params:e})}function ce(e){return this.fetch({method:"get",url:"api/v1/sysUser/getDictCheckedByUserId.html",params:e})}function ue(e){return this.fetch({method:"post",url:"api/v1/sysUser/save.html",data:e})}function de(e){return this.fetch({method:"post",url:"api/v1/sysUser/saveProfession.html",data:e})}function pe(e){return this.fetch({method:"get",url:"api/v1/sysUser/remove.html",params:e})}function he(e){return this.fetch({method:"post",url:"api/dict/pageList.html",data:e})}function me(e){return this.fetch({method:"post",url:"api/dict/save.html",data:e,isJSON:!0})}function fe(e){return this.fetch({method:"post",url:"api/dict/remove.html",data:e})}function ge(){return this.fetch({method:"post",url:"api/dictCategory/list.html"})}function be(e){return this.fetch({method:"post",url:"api/dictCategory/save.html",data:e,isJSON:!0})}function ve(e){return this.fetch({method:"post",url:"api/v1/sysLogLogin/pageList.html",data:e})}function ye(e){return this.fetch({method:"get",url:"api/v1/sysMenu/pageList.html",params:e})}function we(e){return this.fetch({method:"post",url:"api/v1/sysMenu/save.html",data:e})}function Ie(e){return this.fetch({method:"get",url:"api/v1/sysMenu/getDetailInfo.html",params:e})}function Ce(e){return this.fetch({method:"get",url:"api/v1/sysMenu/getNotRunByMenuId.html",params:e})}function Te(e){return this.fetch({method:"get",url:"api/v1/sysMenu/getRunByMenuId.html",params:e})}function Se(e){return this.fetch({method:"post",url:"api/v1/sysMenu/saveMenuRun.html",data:e})}function ke(){return this.fetch({method:"post",url:"api/v1/sysMenu/getMenuInfo.html"})}function _e(e){return this.fetch({method:"get",url:"api/v1/sysMenu/remove.html",params:e})}function Pe(e){return this.fetch({method:"get",url:"api/v1/updatePassword.html",params:e})}function xe(e){return this.fetch({method:"post",url:"api/v1/sysRole/pageList.html",data:e})}function De(e){return this.fetch({method:"post",url:"api/v1/sysRole/userList.html",params:e})}function Fe(e){return this.fetch({method:"post",url:"api/v1/sysRole/save.html",data:e})}function $e(e){return this.fetch({method:"get",url:"api/v1/sysRole/remove.html",params:e})}function Le(e){return this.fetch({method:"post",url:"api/v1/tag/save.html",data:e,isJSON:!0})}function Re(e){return this.fetch({method:"get",url:"api/v1/sysRole/modifyRoleAuthView.html",params:e})}function Ne(e){return this.fetch({method:"post",url:"api/v1/sysRole/modifyRoleAuthSave.html",data:e})}function Ee(e){return this.fetch({method:"get",url:"api/v1/sysRole/updateSeq.html",params:e})}function Oe(e){return this.fetch({method:"get",url:"api/v1/sysRole/getDetailInfo.html",params:e})}function Ae(e){return this.fetch({method:"post",url:"api/v1/sysDept/pageList.html",data:e})}function Ve(e){return this.fetch({method:"get",url:"api/v1/sysDept/remove.html",params:e})}function Me(e){return this.fetch({method:"post",url:"api/v1/sysDept/save.html",data:{jsonStr:JSON.stringify(e)}})}function Be(e){return this.fetch({method:"get",url:"api/v1/sysDept/getDetailInfo.html",params:e})}function Ue(e){return this.fetch({method:"get",url:"api/v1/sysDept/updateSeq.html",params:e})}function je(e){return this.fetch({method:"post",url:"api/v1/sysLogOp/pageList.html",data:e})}function Ge(e){return this.fetch({method:"post",url:"api/v1/blockInfo/pageList.html",data:e})}function We(e){return this.fetch({method:"get",url:"api/v1/blockInfo/remove.html",params:e})}function qe(e){return this.fetch({method:"get",url:"api/v1/cornerIconType/getCornerTypes.html",params:e})}function He(e){return void 0===e&&(e="materialType"),this.fetch({method:"get",url:"api/v1/dict/getTypes/poster/".concat(e,".html")})}function ze(e){return this.fetch({method:"post",url:"api/v1/blockInfo/save.html",data:e})}function Je(e){return this.fetch({method:"post",url:"api/v1/sysPlugin/pageList.html?pluginParentType=builtIn",data:e})}function Ke(e){return this.fetch({method:"get",url:"api/v1/sysPlugin/getDetailInfo.html",params:e})}function Qe(e){return this.fetch({method:"post",url:"api/v1/dict/getTypes/sysPlugin/pluginParentType.html",data:e})}function Xe(e){return this.fetch({method:"post",url:"api/v1/dict/getTypes/sysPlugin/pluginType.html",data:e})}function Ye(e){return this.fetch({method:"get",url:"api/tvos/getMediaVideoInfos.html",params:e})}function Ze(e){return this.fetch({method:"get",url:"api/tvos/getPartnerSource.html",params:e})}function et(e){return this.fetch({method:"get",url:"api/tvos/getCondition.html",params:e})}function tt(e){return this.fetch({method:"get",url:"api/tvos/queryLiveVideoResult.html",params:e})}function at(e){return this.fetch({method:"post",url:"api/v1/dict/getTypes/sysPlugin/"+e+".html"})}function it(e){return this.fetch({method:"post",url:"api/v1/dict/getTypes/sysPlugin/pluginType.html",data:e})}function nt(e){return this.fetch({method:"post",url:"api/v1/poster/dataList.html",data:e})}function ot(e){return this.fetch({method:"post",url:"api/v1/cornerIcon/pageList.html",data:e})}function rt(e){return e={jsonStr:JSON.stringify(e)},this.fetch({method:"post",url:"api/v1/sysPlugin/save.html",data:e})}function lt(e){return this.fetch({method:"post",url:"api/v1/sysPlugin/pageList.html?builtInNotShow=1",data:e})}function st(e){return this.fetch({method:"get",url:"api/v1/sysPlugin/getDetailInfo.html",params:e})}function ct(e){return this.fetch({method:"get",url:"api/v1/sysPlugin/remove.html",params:e})}function ut(e){return this.fetch({method:"post",url:"api/v1/onclickInfo/pageList.html",data:e})}function dt(e){return this.fetch({method:"get",url:"api/v1/hvi/historyList.html",params:e})}function pt(e){return this.fetch({method:"POST",url:"api/v1/blockInfo/getDetailInfo.html",data:e})}function ht(e){return this.fetch({url:"api/v1/blockInfo/dataList.html",params:e})}function mt(e){return this.fetch({method:"post",url:"api/adminMasterControl/getDetailInfo.html",data:e})}function ft(e){return this.fetch({method:"post",url:"api/adminMasterControl/save.html",data:e})}function gt(e){return this.fetch({method:"post",url:"api/v1/poster/pageList.html",data:e})}function bt(e){return this.fetch({method:"get",url:"api/v1/poster/batchAudit.html",params:e})}function vt(e){return this.fetch({method:"get",url:"api/v1/poster/remove.html",params:e})}function yt(){return this.fetch({method:"post",url:"api/v1/onclickInfo/getMenuInfo.html"})}function wt(e){return this.fetch({method:"post",url:"api/v1/onclickInfo/pageList.html",data:e})}function It(e){return this.fetch({method:"post",url:"api/v1/onclickInfo/save.html",data:e})}function Ct(e){return this.fetch({method:"get",url:"api/v1/onclickInfo/remove.html",params:e})}function Tt(e){return this.fetch({method:"get",url:"api/v1/onclickInfo/getDetailInfo.html",params:e}).then(function(e){return e})}a("4917");function St(e){return this.fetch({url:"api/v1/tab/pageList.html",params:e})}function kt(e){return this.fetch({method:"post",url:"api/v1/dict/getTypes/tab/tabType.html",data:e})}function _t(e){return this.fetch({method:"get",url:"api/v1/getMediaResourceInfoToPanel.html",params:e,isJSON:!0})}function Pt(e){return this.fetch({method:"post",url:"api/filmDetailPage/pageList.html",data:e})}function xt(e){return this.fetch({method:"post",url:"api/filmDetailPage/save.html",data:e})}function Dt(e){return this.fetch({method:"get",url:"api/filmDetailPage/remove.html",params:e})}function Ft(){return this.fetch({method:"get",url:"api/v1/tab/getIconList.html"})}function $t(e){return this.fetch({method:"post",url:"api/v1/tab/getDetailInfo.html",params:e})}function Lt(e){return this.fetch({method:"post",url:"api/v1/tab/save.html",data:{jsonStr:JSON.stringify(e)}})}function Rt(e){return this.fetch({method:"post",url:"api/v1/tab/remove.html",data:e})}function Nt(e){return this.fetch({method:"get",url:"api/filmDetailPage/edit.html",params:e}).then(function(e){return JSON.parse(e.match(/param = (\{.+\})/)[1])})}function Et(e){return this.fetch({method:"get",url:"api/filmDetailPage/preview.html",params:e}).then(function(e){return JSON.parse(e.match(/param = (\{.+\})/)[1])})}function Ot(e){return this.fetch({method:"get",url:"api/v1/tvos/getVipButtonSource.html",params:e})}function At(e){return this.fetch({method:"post",url:"api/v1/panel/pageList.html",data:e})}function Vt(e){return this.fetch({method:"post",url:"api/v1/panel/dataList.html",data:e})}function Mt(e){return this.fetch({url:"api/v1/panel/getDetailInfo.html",params:e})}function Bt(e){return this.fetch({method:"post",url:"api/v1/panel/save.html",data:{jsonStr:JSON.stringify(e)}})}function Ut(e){return this.fetch({method:"post",url:"api/v1/panel/remove.html",data:e})}function jt(e){return this.fetch({method:"post",url:"api/v1/collect/"+e.type+"/cancel.html",data:e.data})}function Gt(e){return this.fetch({method:"post",url:"api/v1/collect/"+e.type+"/collect.html",data:e.data})}function Wt(e){return this.fetch({method:"get",url:"api/tvos/getMediaCommonTags.html",params:e})}function qt(e){return this.fetch({method:"post",url:"api/v1/homepage/pageList.html",data:e})}function Ht(e){return this.fetch({method:"post",url:"api/v1/homepage/save.html",data:{jsonStr:JSON.stringify(e)}})}function zt(e){return this.fetch({url:"api/v1/homepage/remove.html",params:e})}function Jt(e){return this.fetch({method:"get",url:"api/v1/homepage/getDetailInfo.html",params:e})}a("a481");function Kt(e){var t,a=e.tagCodes||[];return a.length>0&&(delete e.tagCodes,t=a.map(function(e){return"tagCodes=".concat(e)}).join("&")),this.fetch({methods:"get",url:"api/tvos/getMediaVideoInfos.html".concat(t?"?"+t:""),params:e}).then(function(e){return"string"===typeof e?JSON.parse(e.replace("result(","").replace(/\)*$/,"")):e})}function Qt(e){return this.fetch({methods:"get",url:"api/tvos/getPartnerSource.html",params:e})}function Xt(){return this.fetch({methods:"get",url:"api/tvos/getCondition.html"}).then(function(e){return"string"===typeof e?JSON.parse(e.replace("result(","").replace(/\)*$/,"")):e})}function Yt(e){return this.fetch({methods:"get",url:"api/tvos/getSegmentList.html",params:e}).then(function(e){return"string"===typeof e?JSON.parse(e.replace("result(","").replace(/\)*$/,"")):e})}function Zt(e){return this.fetch({methods:"get",url:"api/v1/appManagement/pageList.html",params:e})}function ea(e){return this.fetch({method:"post",url:"api/v1/panel/pageList.html",data:e})}function ta(e){return this.fetch({method:"post",url:"api/v1/panel/save.html",data:e})}function aa(e){return this.fetch({method:"get",url:"api/v1/panel/remove.html",params:e})}function ia(e){return this.fetch({method:"get",url:"api/v1/panel/getDetailInfo.html",params:e})}function na(e){return this.fetch({method:"post",url:"api/v1/timedTask/getTimedInfo.html",data:e})}function oa(e){return this.fetch({method:"get",url:"api/v1/audit/historyList.html",params:e})}function ra(e){return this.fetch({method:"post",url:"api/v1/cornerIconType/pageList.html",data:e})}function la(e){return this.fetch({method:"post",url:"api/v1/cornerIconType/remove.html",data:e})}function sa(e){return this.fetch({method:"post",url:"api/v1/cornerIconType/save.html",data:{jsonStr:JSON.stringify(e)}})}function ca(e){return this.fetch({method:"get",url:"api/v1/cornerIconType/getDetailInfo.html",params:e})}function ua(e){return this.fetch({url:"api/v1/layout/pageList.html",params:e})}function da(e){return this.fetch({method:"post",url:"api/v1/layout/remove.html",data:e})}function pa(e){return this.fetch({method:"post",url:"api/v1/layout/save.html",data:e})}function ha(e){return this.fetch({method:"get",url:"api/v1/layout/getDetailInfo.html",params:e})}function ma(e){return this.fetch({method:"post",url:"api/v1/buttonManage/getAuditDetailButton.html",data:e})}function fa(e){return this.fetch({method:"post",url:"api/v1/audit/auditTask.html",data:e})}function ga(e){return this.fetch({method:"post",url:"api/v1/audit/revokedAudit.html",data:e})}function ba(e){return this.fetch({method:"post",url:"api/v1/audit/putShelves.html",data:e})}function va(e){return this.fetch({method:"post",url:"api/v1/theme/pageList.html",data:e})}function ya(e){return this.fetch({method:"get",url:"api/v1/theme/remove.html",params:e})}function wa(e){return this.fetch({method:"get",url:"api/v1/theme/getDetailInfo.html",params:e})}function Ia(e){return this.fetch({method:"post",url:"api/v1/theme/save.html",data:e})}function Ca(e){return this.fetch({method:"post",url:"api/v1/theme/checkThemeMd5.html",data:e})}function Ta(e){return this.fetch({url:"api/v1/poster/save.html",method:"post",data:e})}function Sa(e){return this.fetch({url:"api/v1/poster/getDetailInfo.html",method:"get",params:e})}function ka(e){return this.fetch({method:"get",url:"api/v1/cornerIcon/pageList.html",params:e})}function _a(e){return this.fetch({method:"get",url:"api/v1/cornerIconType/getCornerTypes.html",params:e})}function Pa(e){return this.fetch({method:"post",url:"api/v1/cornerIcon/getIconAttributes.html",params:e})}function xa(e){return this.fetch({method:"get",url:"api/v1/cornerIcon/getDetailInfo.html",params:e})}function Da(e){return this.fetch({method:"post",url:"api/v1/cornerIcon/save.html",data:{jsonStr:JSON.stringify(e)}})}function Fa(e){return this.fetch({method:"get",url:"api/v1/cornerIcon/remove.html",params:e})}function $a(e){return this.fetch({method:"get",url:"api/v1/cornerIcon/batchAudit.html",params:e})}function La(e){return this.fetch({method:"post",url:"api/v1/audit/revokedAudit.html",data:e})}function Ra(e){return this.fetch({method:"get",url:"api/v1/cornerIcon/getDetailInfo.html",params:e})}function Na(e){return this.fetch({method:"get",url:"api/v1/cornerIcon/changePriority.html",params:e})}function Ea(){return this.fetch({url:"api/v1/adBlock/pageList.html?rows=10000"})}function Oa(e){return this.fetch({method:"post",url:"api/v1/adBlock/switchStatus.html",data:e})}function Aa(e){return this.fetch({method:"get",url:"api/v1/hvi/historyList.html",params:e})}function Va(e){return this.fetch({method:"get",url:"api/v1/panel/remove.html",params:e})}function Ma(e){return this.fetch({method:"post",url:"api/v1/"+e+"/getTotal.html"})}function Ba(e){return this.fetch({method:"post",url:"api/v1/"+e.type+"/pageList.html",data:e})}function Ua(e){return this.fetch({method:"post",url:"api/v1/msn/pageList.html",data:e})}function ja(e){return this.fetch({method:"post",url:"api/v1/policyConf/pageList.html",data:e})}function Ga(e){return this.fetch({method:"post",url:"api/v1/testPolicyConf/pageList.html",data:e})}function Wa(e){return this.fetch({method:"post",url:"api/v1/device/dataList.html",data:e})}function qa(e){return this.fetch({method:"post",url:"api/v1/device/save.html",data:e})}function Ha(e){return this.fetch({method:"post",url:"api/v1/homepage/dataList.html",data:e})}function za(e){return this.fetch({method:"post",url:"api/v1/policyConf/save.html",data:e})}function Ja(e){return this.fetch({method:"post",url:"api/v1/testPolicyConf/save.html",data:e})}function Ka(e){return this.fetch({method:"post",url:"api/v1/policyConf/remove.html",data:e})}function Qa(e){return this.fetch({method:"post",url:"api/v1/testPolicyConf/remove.html",data:e})}function Xa(e){return this.fetch({method:"get",url:"api/v1/policyConf/getDetailInfo.html",params:e})}function Ya(e){return this.fetch({method:"get",url:"api/v1/testPolicyConf/getDetailInfo.html",params:e})}function Za(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.fetch({url:"api/v1/sysPlugin/pageList.html",params:Object.assign({pluginStatus:4,pluginType:"REFERENCE_ACTIVITY"},e)})}var ei=a("bd86");function ti(e){return e.reduce(function(e,t){var a=t.label,i=t.value;return e[i]=a,e},{})}function ai(e){return e.reduce(function(e,t){return e[t.label]=t.value,e},{})}var ii={offShelves:0,onShelves:1,draft:2,waiting:3,accepted:4,rejected:5,auditing:6,processing:7,waiting2:9},ni={0:"下架",1:"上架",2:"草稿",3:"待审核",4:"审核通过",5:"审核不通过",6:"审核中",7:"审核通过未上线",9:"待二次审核"},oi=Object.keys(ni).reduceRight(function(e,t){return t<6&&e.push({label:ni[t],value:t}),e},[]),ri=Object.keys(ni).reduceRight(function(e,t){return t<6&&(e[ni[t]]=t),e},{}),li=[{label:"腾讯",value:"o_tencent"},{label:"爱奇艺",value:"o_iqiyi"},{label:"优酷",value:"o_youku"}],si=ai(li),ci=[{label:"无",value:""}].concat(li),ui=[{label:"无",value:"none"}].concat(li),di=ai(ui),pi={o_tencent:"tencent",o_iqiyi:"yinhe",o_youku:"youku"},hi={o_tencent:"腾讯",o_iqiyi:"爱奇艺",o_youku:"优酷"},mi={none:"无",o_tencent:"腾讯",o_iqiyi:"爱奇艺",o_youku:"优酷"},fi=[{label:"无",value:0},{label:"腾讯",value:1},{label:"爱奇艺",value:2},{label:"优酷",value:3}],gi=ti(fi),bi=ai(fi),vi=[{label:"腾讯",value:"tencent"},{label:"爱奇艺",value:"yinhe"},{label:"优酷",value:"youku"}],yi=[{label:"普通版块",value:"normal"},{label:"分组版块",value:"group"}],wi=ti(yi),Ii=[{label:"面落焦",value:1},{label:"线落焦",value:0}],Ci=ti(Ii),Ti=[{label:"左上",value:0},{label:"右上",value:1},{label:"右下",value:2},{label:"左下",value:3}],Si=ai(Ti),ki=ti(Ti),_i="10",Pi=[{label:"酷开",value:"10"},{label:"江苏有线",value:"11"}],xi=ai(Pi),Di={status:ii,statusText:ni,statusOptions:oi,statusEnums:ri,sourceOptions:li,sourceEnums:si,sourceOptionsWithNoneEnums:di,sourceOptionsWithEmpty:ci,sourceOptionsWithNone:ui,sourceToPartner:pi,sourceText:hi,sourceTextWithNone:mi,sourceNumberOptions:fi,sourceNumberText:gi,sourceNumberEnums:bi,partnerOptions:vi,panelFocusOptions:Ii,panelFocusText:Ci,panelTypeOptions:yi,panelTypeText:wi,cornerIconPositionOptions:Ti,cornerIconPositionEnums:Si,cornerIconPositionText:ki,idPrefix:_i,idPrefixOptions:Pi,idPrefixEnums:xi};function Fi(e){return this.fetch({method:"get",url:"api/v1/hvi/historyList.html",params:e}).then(function(e){var t=e.rows||[];return t.map(function(e){var t=e.version,a=e.lastUpdateDate,i=e.modifierName,n=e.status;return{row:e,value:e.version,label:"".concat(t,"/").concat(a,"/").concat(i,"/").concat(Di.statusText[n])}})})}function $i(e){return this.fetch({method:"post",url:"api/v1/audit/revokedAudit.html",data:e})}function Li(e){return this.fetch({method:"post",url:"api/secondAudit/audit.html",data:e})}function Ri(){return this.fetch({url:"api/v1/timedTask/taskLimit.html"})}function Ni(e){return this.fetch({url:"api/v1/timedTask/getTimedInfo.html",params:e})}function Ei(e){return this.fetch({url:"api/v1/timedTask/cancelTimedTask.html",params:e})}function Oi(e){return this.fetch({method:"post",url:"api/v1/audit/putShelves.html",data:e})}var Ai=Object(ei["a"])({homepage:"api/v1/homepage/delHistory.html",pannel:"api/v1/panel/delHistory.html",tab:"api/v1/tab/delHistory.html",theme:"api/v1/theme/delHistory.html",policy:"api/v1/policyConf/delHistory.html",testPolicy:"api/v1/testPolicyConf/delHistory.html",systemPlugin:"",icon:"",material:"",layout:"",block:"api/v1/blockInfo/delHistory.html"},"systemPlugin","api/v1/sysPlugin/delHistory.html");function Vi(e){return this.fetch({url:Ai[e.type],params:{id:e.id,version:e.version}})}var Mi={homepage:"api/v1/homepage/remove.html",markPanel:"api/v1/panel/remove.html",multiFunctionBlock:"api/v1/sysPlugin/remove.html",sysPlugin:"api/v1/sysPlugin/remove.html",crowdRel:"api/v1/dmpMgr/remove.html"};function Bi(e){return this.fetch({url:Mi[e.type],params:{id:e.id}})}function Ui(e){return this.fetch({url:"api/v1/audit/historyList.html",params:e})}var ji={};function Gi(e){var t=e.type,a=e.isFilter,i=a?"".concat(t,"_filtered"):t,n=ji[i];return n?Promise.resolve(n):this.fetch({method:"post",url:"api/v1/dict/getTypes/"+t+".html",data:{isFilter:a}}).then(function(e){return ji[i]=e,e})}function Wi(){return this.fetch({method:"get",url:"api/v1/getEnvironment.html"})}function qi(){return this.fetch({url:"api/dict/recommendStrategy.html"})}function Hi(e){return this.fetch({method:"post",url:"api/v1/collect/".concat(e.type,"/pageList.html"),data:e.data})}function zi(e){return this.fetch({method:"post",url:"api/v1/tab/save.html",data:e})}function Ji(e){return this.fetch({method:"post",url:"api/v1/tab/remove.html",data:e})}function Ki(e){return this.fetch({method:"get",url:"api/v1/tab/getDetailInfo.html",params:e})}function Qi(e){return this.fetch({method:"post",url:"api/v1/commonResourceUser/tab/collectResource.html",data:e})}function Xi(e){return this.fetch({method:"post",url:"api/v1/commonResourceUser/tab/cancelCollectResource.html",data:e})}function Yi(e){return this.fetch({method:"get",url:"api/tvos/queryPPTVVideoResult.html?callbackparam=result",params:e}).then(function(e){return"string"===typeof e?JSON.parse(e.replace("result(","").replace(/\)*$/,"")):e})}function Zi(e){return this.fetch({url:"api/tvos/getCondition.html",params:e}).then(function(e){return"string"===typeof e?JSON.parse(e.replace("result(","").replace(/\)*$/,"")):e})}function en(e){return this.fetch({method:"get",url:"api/tvos/getMediaTagList.html?tagCode=",params:e}).then(function(e){var t=e.data;return t})}function tn(e){var t=new FormData;return t.append("jsonStr",JSON.stringify(e)),this.fetch({method:"post",url:"api/v1/dmpMgr/save.html",data:t,isJSON:!0})}function an(e){return this.fetch({url:"api/v1/dmpMgr/getDetailInfo.html",params:e})}function nn(e){return this.fetch({url:"api/v1/dmpMgr/remove.html",params:e})}function on(){return this.fetch({url:"api/v1/dmpMgr/loadDmpData.html"})}function rn(e){return this.fetch({url:"api/v1/dmpMgr/listCrowdRelationship.html",params:e})}var ln={fetchPolicyPromise:void 0,fetchCrowdPromise:{}};function sn(e){var t=e.id;return ln.fetchCrowdPromise[t]||(ln.fetchCrowdPromise[t]=this.getCrowdOfPolicy(t)),ln.fetchCrowdPromise[t]}function cn(e){return this.fetch({method:"get",url:"api/v1/tag/list.html",params:e})}function un(e){var t=e.id;return this.getTaglist({id:t,type:"crowd"})}function dn(){return this.getTaglist({type:"crowdPolicy"})}function pn(e){return this.fetch({url:"api/v1/sysContentAuthMgr/getUserContentAuth.html",params:e})}function hn(e){return this.fetch({url:"api/v1/sysContentAuthMgr/listResourceContentAuth.html",params:e})}function mn(e){var t=new FormData;return t.append("jsonStr",JSON.stringify(e)),this.fetch({method:"post",url:"api/v1/sysContentAuthMgr/save.html",data:t,isJSON:!0})}function fn(){return this.fetch({method:"post",url:"api/dataSync/getSwitcherInfo.html"}).then(function(e){var t=e.isOn;return{isOn:!t}})}function gn(e){return this.fetch({url:"api/dataSync/manualIsOn.html",params:{enableManualOn:e.enableManualOn?"false":"true"}})}function bn(){return this.fetch({url:"api/secondAudit/getTotalInfo.html"})}function vn(e){return this.fetch({url:"api/secondAudit/pageList.html",params:e})}var yn=Object(j["a"])({state:{},fetch:z},i,n,T,o,r,l,s,c,u,p,h,m,f,g,b,v,y,w,I,C,d,S,k,_,P,x,D,F,$,L,R,N,E);function wn(e){var t={};Object.keys(yn).forEach(function(a){"function"===typeof yn[a]?t[a]=function(){var t=Object(U["a"])(regeneratorRuntime.mark(function t(i,n){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",yn[a](i).then(function(t){return n&&e.prototype.$notify({title:"操作成功",type:"success",message:n}),t}).catch(function(t){if(!t.request||401!==t.request.status)return e.prototype.$notify({title:"操作失败",type:"error",message:t.message}),Promise.reject(t);location.hash="#/login"}));case 1:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}():t[a]=yn[a]}),e.prototype.$service=t}a("0fae");var In=new O["default"];Object.defineProperties(O["default"].prototype,{$bus:{get:function(){return In}}}),Object.defineProperties(O["default"].prototype,{$getMenu:{get:function(){}}});var Cn={};function Tn(){var e;do{e=""+Date.now()+Math.random()}while(Cn[e]);return e}function Sn(e){e.stopPropagation();var t=e.currentTarget,a=t.dataset.shadowDragId,i=Cn[a],n=i.binding,o=n.value;e.dataTransfer.setData("text/plain",JSON.stringify(o)),t.dispatchEvent(new Event("shadow-drag-start"))}function kn(e){e.currentTarget.dispatchEvent(new Event("shadow-drag-end"))}var _n={bind:function(e,t,a){if(t){var i=Tn();Cn[i]={binding:t,vnode:a},e.dataset.shadowDragId=i,e.addEventListener("dragstart",Sn),e.addEventListener("dragend",kn),e.setAttribute("draggable",!0)}},inserted:function(e,t,a){},update:function(e,t,a){var i=e.dataset.shadowDragId,n=Cn[i];n.binding=t},unbind:function(e,t,a){var i=e.dataset.shadowDragId;delete Cn[i],e.removeEventListener("dragstart",Sn),e.removeEventListener("dragend",kn)}},Pn=a("0754"),xn=a.n(Pn),Dn=(a("616e"),a("59c7"));a("ed2c");function Fn(e){return e.$service.getEnv().then(function(t){if(e.$consts.idPrefix=t.idPrefix,t.userInfo){var a=t.userInfo.loginName;e.$appState.user={name:a}}})}O["default"].prototype.$isLoggedIn=Object(U["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.$appState,!t.user){e.next=3;break}return e.abrupt("return");case 3:return e.abrupt("return",Fn(this).then(function(){if(!t.user)throw new Error("ERR_NOT_LOGIN")}));case 4:case"end":return e.stop()}},e,this)})),O["default"].prototype.$login=function(){var e=Object(U["a"])(regeneratorRuntime.mark(function e(t){var a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.$service.login(t).then(function(e){var i={name:t.username};return a.$service.state=i,a.$appState.user=i,a.$appState.$set("user",i),Fn(a)}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),O["default"].prototype.$logout=Object(U["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.$appState.user=void 0,this.$appState.$remove("user"),e.abrupt("return",this.$service.logout());case 3:case"end":return e.stop()}},e,this)}));var $n=a("7618"),Ln=a("2ef0"),Rn=a.n(Ln);O["default"].prototype.$isAllowEdit=function(e){return 1===e.length||(this.$message("请选择一条数据进行编辑"),!1)},O["default"].prototype.$isAllowDelete=function(e){return 0!==e.length||(this.$message("请选择数据后进行操作"),!1)},O["default"].prototype.$status=function(){return{"草稿":2,"待审核":3,"审核通过":4,"审核不通过":5}},O["default"].prototype.$baseStatus=function(){return{"待审核":3,"审核通过":4,"审核不通过":5}},O["default"].prototype.$numToAuditStatus=function(e){var t="";if("number"===typeof e)switch(e){case 0:t="下架";break;case 1:t="上架";break;case 2:t="草稿";break;case 3:t="待审核";break;case 4:t="审核通过";break;case 5:t="审核不通过";break;case 6:t="审核中";break;case 7:t="审核通过未上线";break;case 9:t="待二次审核";break;default:t="未知"}return t},O["default"].prototype.$regParenthesesContent=function(e){return e.match(/([^\(\)]+)(?=\))/g)},O["default"].prototype.deepClone=function(e){var t,a=this;switch(Object($n["a"])(e)){case"undefined":break;case"string":t=e+"";break;case"number":t=e-0;break;case"boolean":t=e;break;case"object":if(null===e)t=null;else if(e instanceof Array){t=[];for(var i=0,n=e.length;i<n;i++)t.push(a.deepClone(e[i]))}else for(var o in t={},e)t[o]=a.deepClone(e[o]);break;default:t=e;break}return t},O["default"].prototype.$numToReviewPriority=function(e){var t;if("number"===typeof e)switch(e){case 1:t="一般";break;case 2:t="重要";break;case 3:t="紧急";break;default:t="未知"}return t},O["default"].prototype.$numToTaskStatus=function(e){var t;if("number"===typeof e)switch(e){case 1:t="进行中";break;case 2:t="终止";break;case 3:t="结束";break;case 4:t="失效";break;default:t="未知"}return t},O["default"].prototype.$platform=function(e){switch(e){case"yinhe":return"爱奇艺";case"tencent":return"腾讯";case"voole":return"优朋"}},O["default"].prototype.$checkMacType=function(e,t,a){""===t&&a(),t=t.replace(/(^\s*)|(\s*$)/g,"");var i=/^[a-zA-Z0-9]{12}$/;i.test(t)?a():a(new Error("请输入12位的MAC地址"))},O["default"].prototype.$getFilterSelectField=function(e,t,a){return e.reduce(function(e,i){return e[i[t]]=i[a],e},{})},O["default"].prototype.$sourceName=function(e){var t={yinhe:"爱奇艺",o_iqiyi:"爱奇艺",qq:"腾讯",o_tencent:"腾讯",o_youku:"优酷",tencent:"腾讯",o_voole:"优朋",voole:"优朋",voolesohu:"优朋搜狐"};return t[e]},O["default"].prototype.$changeKeyToValue=function(e){var t=Object.keys(e);return t.reduce(function(t,a){return t[e[a]]=a,t},{})},O["default"].prototype.$validateId=function(e){var t=/^\+?[1-9][0-9]*$/,a="";return e instanceof Array?(e.forEach(function(i){void 0===i.value||""===Rn.a.trim(e)||t.test(i.value)||(""===a?a=i.label:a+=","+i.label)}),""!==a&&(a+="只能是正数字")):void 0===e||""===Rn.a.trim(e)||t.test(e)||(a="ID只能是正数字"),""===a||(this.$message({type:"error",message:a}),!1)};var Nn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content-card"},[void 0!==e.title?a("div",{staticClass:"content-card__header"},[e._v("\n        "+e._s(e.title)+"\n        "),a("div",{staticClass:"actions"},[e._t("actions",[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.$emit("go-back")}}},[e._v("返回")])])],2)]):e._e(),a("div",{staticClass:"content-card__main"},[e._t("default")],2),e.showContentAuthManager?a("content-auth-manager",{ref:"contentAuthManager",attrs:{"resource-id":e.contentAuthInfo.id,"menu-elid":e.contentAuthInfo.menuElId,"resource-type":e.contentAuthInfo.type}},[a("div",{attrs:{slot:"button"},slot:"button"})]):e._e()],1)},En=[],On=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content-auth-manager"},[e._t("button",[a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.showManageButton,expression:"showManageButton"}],attrs:{type:"primary"},on:{click:e.handleOpenAuthManagement}},[e._v("\n      内容权限管理\n    ")])]),a("el-dialog",{staticClass:"content-auth-manager__dialog",attrs:{title:"权限设置",visible:e.showManagementDialog,width:"80vw"},on:{"update:visible":function(t){e.showManagementDialog=t}}},[a("div",{staticClass:"content-auth-list"},[a("div",{staticClass:"actions"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("\n          保存\n        ")]),a("el-button",{attrs:{type:"warning"},on:{click:function(t){e.showManagementDialog=!1}}},[e._v("\n          关闭\n        ")])],1),a("el-autocomplete",{staticClass:"user-search-input",attrs:{placeholder:"用户名称、账号、邮箱","fetch-suggestions":e.handleSearch},on:{select:e.handleAddUser},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),a("Table",{attrs:{header:e.table.header,data:e.table.data}})],1)])],2)},An=[],Vn={components:{Table:Dn["Table"]},data:function(){return{showManagementDialog:!1,showManageButton:!1,keyword:"",currentUserId:void 0,ownerId:void 0,table:{data:[],header:[{label:"登录账号",prop:"loginName"},{label:"公司部门",prop:"deptName"},{label:"电子邮件",prop:"email"},{label:"查看",render:function(e,t){return e("el-checkbox",{props:{disabled:this.isDisableRow(t.row),value:!!t.row.browser},on:{input:function(e){t.row.browser=e?1:0}}})}.bind(this)},{label:"编辑",render:function(e,t){return e("el-checkbox",{props:{disabled:this.isDisableRow(t.row),value:!!t.row.edit},on:{input:function(e){t.row.edit=e?1:0}}})}.bind(this)},{label:"删除",render:function(e,t){return e("el-checkbox",{props:{disabled:this.isDisableRow(t.row),value:!!t.row.delete},on:{input:function(e){t.row.delete=e?1:0}}})}.bind(this)}]}}},props:["resourceId","resourceType","menuElid"],methods:{isDisableRow:function(e){return this.currentUserId===this.ownerId&&e.userId===this.currentUserId},handleOpenAuthManagement:function(){this.getUsers(),this.showManagementDialog=!0},handleAddUser:function(e){var t=e.row;this.keyword="",this.table.data.push({userId:t.userId,loginName:t.loginName,deptName:t.deptName,email:t.email,browser:1,edit:0,delete:0})},handleSearch:function(e,t){e&&this.$service.userConfigPageList({keyword:e}).then(function(e){var a=this.table.data.reduce(function(e,t){return e[t.userId]=!0,e},{}),i=e.rows.map(function(e){return{userId:e.userId,value:e.loginName+"("+e.email+")",row:e}}).filter(function(e){return!a[e.userId]});t(i)}.bind(this)).catch(function(){t()})},getUsers:function(){this.$service.getResourceContentAuthList({resourceId:this.resourceId,resourceType:this.resourceType,menuElid:this.menuElid}).then(function(e){this.currentUserId=e.currentUserId,this.ownerId=e.ownerId,this.table.data=e.userContentAuthList}.bind(this))},updateUserAuth:function(e,t,a){var i=e[t];e[t]=a;var n={resourceId:this.resourceId,resourceType:this.resourceType,userContentAuthList:[{userId:e.userId,browser:e.browser,edit:e.edit,delete:e.delete}]};this.$service.upsertResourceContentAuthList(n,"保存成功").catch(function(){e[t]=i})},handleSave:function(){var e=this.table.data.reduce(function(e,t){return(t.browser||t.edit||t.delete)&&e.push({userId:t.userId,browser:t.browser,edit:t.edit,delete:t.delete}),e},[]),t={resourceId:this.resourceId,resourceType:this.resourceType,userContentAuthList:e};this.$service.upsertResourceContentAuthList(t,"保存成功")}},created:function(){this.resourceId&&this.$service.getUserContentAuth({resourceId:this.resourceId,resourceType:this.resourceType,menuElid:this.menuElid}).then(function(e){e.enableContentAuth&&e.contentAuth.contentAuthSetting&&(this.showManageButton=!0)}.bind(this))}},Mn=Vn,Bn=(a("0163"),a("2877")),Un=Object(Bn["a"])(Mn,On,An,!1,null,"aad6efc4",null),jn=Un.exports,Gn={components:{ContentAuthManager:jn},props:["title"],data:function(){return{showContentAuthManager:!1,contentAuthInfo:null}},methods:{handleShowContentAuthManager:function(e){var t=this;this.showContentAuthManager=!0,this.contentAuthInfo=e,this.$nextTick(function(){t.$refs.contentAuthManager.handleOpenAuthManagement()})}}},Wn=Gn,qn=(a("2d57"),Object(Bn["a"])(Wn,Nn,En,!1,null,"76d2f037",null)),Hn=qn.exports;O["default"].use(V.a,{size:"small",zIndex:3e3}),O["default"].use(B.a),O["default"].use(V.a),O["default"].use(xn.a),O["default"].use(wn),O["default"].component("GateSchemaForm",Dn["GateSchemaForm"]),O["default"].component("ContentCard",Hn),O["default"].directive("shadow-drag",_n),O["default"].prototype.$consts=Di;var zn=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},Jn=[],Kn={name:"app"},Qn=Kn,Xn=Object(Bn["a"])(Qn,zn,Jn,!1,null,null,null),Yn=Xn.exports,Zn=(a("7f7f"),a("8c4f")),eo=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-row",{staticStyle:{margin:"auto"}},[i("el-col",{staticClass:"login-form",attrs:{span:6,offset:9}},[i("div",{staticClass:"log_center"},[i("div",{staticClass:"log_bj"},[i("div",{staticClass:"log_logo"},["11"==e.$consts.idPrefix?i("img",{attrs:{src:a("7efd")}}):i("img",{attrs:{src:a("a82c")}}),i("span",[e._v("内容运营平台")])]),i("div",{staticClass:"log-box"},[i("div",{attrs:{id:"accout"}},[i("el-row",[i("el-col",{attrs:{span:11}},[i("el-button",{class:{active:e.isNormalActive},on:{click:function(t){return e.changAccoutType("normal")}}},[e._v("普通账号")])],1),i("el-col",{attrs:{span:11,offset:2}},[i("el-button",{class:{active:e.isDomainActive},on:{click:function(t){return e.changAccoutType("domain")}}},[e._v("域账号")])],1)],1)],1),i("GateSchemaForm",{ref:"loginForm",attrs:{schema:e.formSchema},on:{submit:e.handleLogin},model:{value:e.user,callback:function(t){e.user=t},expression:"user"}}),i("el-button",{staticClass:"login-form__btn",attrs:{type:"primary"},on:{click:function(t){return e.$refs.loginForm.handleSubmit()}}},[e._v("登 录")])],1)])])]),i("div",{staticStyle:{width:"100%",height:"700px"},attrs:{id:"container"}},[i("div",{attrs:{id:"anitOut"}})])],1)},to=[],ao=(a("8449"),a("1157")),io=a.n(ao),no=(a("6c7b"),a("6b54"),a("63d9"),window.CAV={FRONT:0,BACK:1,DOUBLE:2,SVGNS:"http://www.w3.org/2000/svg"});function oo(){io()(function(){if(io()("#container").css({width:io()(window).width(),height:io()(window).height()}),io()(window).bind("resize",function(){io()("#container").css({width:io()(window).width(),height:io()(window).height()})}),!window.ActiveXObject&&document.createElement("canvas").getContext){var e,t,a,i,n,o,r,l=function(){s(),u(),d(),p(),b(),h(_.offsetWidth,_.offsetHeight),m()},s=function(){r=new CAV.CanvasRenderer,c(C.renderer)},c=function(e){switch(t&&P.removeChild(t.element),e){case I:t=r;break}t.setSize(_.offsetWidth,_.offsetHeight),P.appendChild(t.element)},u=function(){a=new CAV.Scene},d=function(){var e,r;for(a.remove(i),t.clear(),n=new CAV.Plane(y.width*t.width,y.height*t.height,y.segments,y.slices),o=new CAV.Material(y.ambient,y.diffuse),i=new CAV.Mesh(n,o),a.add(i),e=n.vertices.length-1;e>=0;e--)r=n.vertices[e],r.anchor=CAV.Vector3.clone(r.position),r.step=CAV.Vector3.create(Math.randomInRange(.2,1),Math.randomInRange(.2,1),Math.randomInRange(.2,1)),r.time=Math.randomInRange(0,Math.PIM2)},p=function(){var e,i;for(e=a.lights.length-1;e>=0;e--)i=a.lights[e],a.remove(i);for(t.clear(),e=0;e<w.count;e++)i=new CAV.Light(w.ambient,w.diffuse),i.ambientHex=i.ambient.format(),i.diffuseHex=i.diffuse.format(),a.add(i),i.mass=Math.randomInRange(10,100),i.velocity=CAV.Vector3.create(),i.acceleration=CAV.Vector3.create(),i.force=CAV.Vector3.create()},h=function(e,a){t.setSize(e,a),CAV.Vector3.set(S,t.halfWidth,t.halfHeight),d()},m=function t(){e=Date.now()-T,f(),g(),requestAnimationFrame(t)},f=function(){var t,i,o,r,l,s,c,u=y.depth/2;for(CAV.Vector3.copy(w.bounds,S),CAV.Vector3.multiplyScalar(w.bounds,w.xyScalar),CAV.Vector3.setZ(k,w.zOffset),r=a.lights.length-1;r>=0;r--){l=a.lights[r],CAV.Vector3.setZ(l.position,w.zOffset);var d=Math.clamp(CAV.Vector3.distanceSquared(l.position,k),w.minDistance,w.maxDistance),p=w.gravity*l.mass/d;CAV.Vector3.subtractVectors(l.force,k,l.position),CAV.Vector3.normalise(l.force),CAV.Vector3.multiplyScalar(l.force,p),CAV.Vector3.set(l.acceleration),CAV.Vector3.add(l.acceleration,l.force),CAV.Vector3.add(l.velocity,l.acceleration),CAV.Vector3.multiplyScalar(l.velocity,w.dampening),CAV.Vector3.limit(l.velocity,w.minLimit,w.maxLimit),CAV.Vector3.add(l.position,l.velocity)}for(s=n.vertices.length-1;s>=0;s--)c=n.vertices[s],t=Math.sin(c.time+c.step[0]*e*y.speed),i=Math.cos(c.time+c.step[1]*e*y.speed),o=Math.sin(c.time+c.step[2]*e*y.speed),CAV.Vector3.set(c.position,y.xRange*n.segmentWidth*t,y.yRange*n.sliceHeight*i,y.zRange*u*o-u),CAV.Vector3.add(c.position,c.anchor);n.dirty=!0},g=function(){t.render(a)},b=function(){window.addEventListener("resize",v)},v=function(e){h(_.offsetWidth,_.offsetHeight),g()},y={width:1.5,height:1.5,depth:10,segments:12,slices:6,xRange:.8,yRange:.1,zRange:1,ambient:"#ca652f",diffuse:"#FFFFFF",speed:2e-4},w={count:2,xyScalar:1,zOffset:100,ambient:"#ad5935",diffuse:"#ff4a00",speed:.001,gravity:1200,dampening:.95,minLimit:10,maxLimit:null,minDistance:20,maxDistance:400,autopilot:!1,draw:!1,bounds:CAV.Vector3.create(),step:CAV.Vector3.create(Math.randomInRange(.2,1),Math.randomInRange(.2,1),Math.randomInRange(.2,1))},I="canvas",C={renderer:I},T=Date.now(),S=CAV.Vector3.create(),k=CAV.Vector3.create(),_=document.getElementById("container"),P=document.getElementById("anitOut");l()}else alert("发生错误，请重试！")})}no.Array="function"===typeof Float32Array?Float32Array:Array,no.Utils={isNumber:function(e){return!isNaN(parseFloat(e))&&isFinite(e)}},function(){for(var e=0,t=["ms","moz","webkit","o"],a=0;a<t.length&&!window.requestAnimationFrame;++a)window.requestAnimationFrame=window[t[a]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[a]+"CancelAnimationFrame"]||window[t[a]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var a=(new Date).getTime(),i=Math.max(0,16-(a-e)),n=window.setTimeout(function(){t(a+i)},i);return e=a+i,n}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),Math.PIM2=2*Math.PI,Math.PID2=Math.PI/2,Math.randomInRange=function(e,t){return e+(t-e)*Math.random()},Math.clamp=function(e,t,a){return e=Math.max(e,t),Math.min(e,a)},no.Vector3={create:function(e,t,a){var i=new no.Array(3);return this.set(i,e,t,a),i},clone:function(e){var t=this.create();return this.copy(t,e),t},set:function(e,t,a,i){return e[0]=t||0,e[1]=a||0,e[2]=i||0,this},setX:function(e,t){return e[0]=t||0,this},setY:function(e,t){return e[1]=t||0,this},setZ:function(e,t){return e[2]=t||0,this},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],this},add:function(e,t){return e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],this},addVectors:function(e,t,a){return e[0]=t[0]+a[0],e[1]=t[1]+a[1],e[2]=t[2]+a[2],this},addScalar:function(e,t){return e[0]+=t,e[1]+=t,e[2]+=t,this},subtract:function(e,t){return e[0]-=t[0],e[1]-=t[1],e[2]-=t[2],this},subtractVectors:function(e,t,a){return e[0]=t[0]-a[0],e[1]=t[1]-a[1],e[2]=t[2]-a[2],this},subtractScalar:function(e,t){return e[0]-=t,e[1]-=t,e[2]-=t,this},multiply:function(e,t){return e[0]*=t[0],e[1]*=t[1],e[2]*=t[2],this},multiplyVectors:function(e,t,a){return e[0]=t[0]*a[0],e[1]=t[1]*a[1],e[2]=t[2]*a[2],this},multiplyScalar:function(e,t){return e[0]*=t,e[1]*=t,e[2]*=t,this},divide:function(e,t){return e[0]/=t[0],e[1]/=t[1],e[2]/=t[2],this},divideVectors:function(e,t,a){return e[0]=t[0]/a[0],e[1]=t[1]/a[1],e[2]=t[2]/a[2],this},divideScalar:function(e,t){return 0!==t?(e[0]/=t,e[1]/=t,e[2]/=t):(e[0]=0,e[1]=0,e[2]=0),this},cross:function(e,t){var a=e[0],i=e[1],n=e[2];return e[0]=i*t[2]-n*t[1],e[1]=n*t[0]-a*t[2],e[2]=a*t[1]-i*t[0],this},crossVectors:function(e,t,a){return e[0]=t[1]*a[2]-t[2]*a[1],e[1]=t[2]*a[0]-t[0]*a[2],e[2]=t[0]*a[1]-t[1]*a[0],this},min:function(e,t){return e[0]<t&&(e[0]=t),e[1]<t&&(e[1]=t),e[2]<t&&(e[2]=t),this},max:function(e,t){return e[0]>t&&(e[0]=t),e[1]>t&&(e[1]=t),e[2]>t&&(e[2]=t),this},clamp:function(e,t,a){return this.min(e,t),this.max(e,a),this},limit:function(e,t,a){var i=this.length(e);return null!==t&&i<t?this.setLength(e,t):null!==a&&i>a&&this.setLength(e,a),this},dot:function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},normalise:function(e){return this.divideScalar(e,this.length(e))},negate:function(e){return this.multiplyScalar(e,-1)},distanceSquared:function(e,t){var a=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2];return a*a+i*i+n*n},distance:function(e,t){return Math.sqrt(this.distanceSquared(e,t))},lengthSquared:function(e){return e[0]*e[0]+e[1]*e[1]+e[2]*e[2]},length:function(e){return Math.sqrt(this.lengthSquared(e))},setLength:function(e,t){var a=this.length(e);return 0!==a&&t!==a&&this.multiplyScalar(e,t/a),this}},no.Vector4={create:function(e,t,a){var i=new no.Array(4);return this.set(i,e,t,a),i},set:function(e,t,a,i,n){return e[0]=t||0,e[1]=a||0,e[2]=i||0,e[3]=n||0,this},setX:function(e,t){return e[0]=t||0,this},setY:function(e,t){return e[1]=t||0,this},setZ:function(e,t){return e[2]=t||0,this},setW:function(e,t){return e[3]=t||0,this},add:function(e,t){return e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e[3]+=t[3],this},multiplyVectors:function(e,t,a){return e[0]=t[0]*a[0],e[1]=t[1]*a[1],e[2]=t[2]*a[2],e[3]=t[3]*a[3],this},multiplyScalar:function(e,t){return e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,this},min:function(e,t){return e[0]<t&&(e[0]=t),e[1]<t&&(e[1]=t),e[2]<t&&(e[2]=t),e[3]<t&&(e[3]=t),this},max:function(e,t){return e[0]>t&&(e[0]=t),e[1]>t&&(e[1]=t),e[2]>t&&(e[2]=t),e[3]>t&&(e[3]=t),this},clamp:function(e,t,a){return this.min(e,t),this.max(e,a),this}},no.Color=function(e,t){this.rgba=no.Vector4.create(),this.hex=e||"#000000",this.opacity=no.Utils.isNumber(t)?t:1,this.set(this.hex,this.opacity)},no.Color.prototype={set:function(e,t){e=e.replace("#","");var a=e.length/3;return this.rgba[0]=parseInt(e.substring(0*a,1*a),16)/255,this.rgba[1]=parseInt(e.substring(1*a,2*a),16)/255,this.rgba[2]=parseInt(e.substring(2*a,3*a),16)/255,this.rgba[3]=no.Utils.isNumber(t)?t:this.rgba[3],this},hexify:function(e){return e=Math.ceil(255*e).toString(16),1===e.length&&(e="0"+e),e},format:function(){var e=this.hexify(this.rgba[0]),t=this.hexify(this.rgba[1]),a=this.hexify(this.rgba[2]);return this.hex="#"+e+t+a}},no.Object=function(){this.position=no.Vector3.create()},no.Object.prototype={setPosition:function(e,t,a){return no.Vector3.set(this.position,e,t,a),this}},no.Light=function(e,t){no.Object.call(this),this.ambient=new no.Color(e||"#FFFFFF"),this.diffuse=new no.Color(t||"#FFFFFF"),this.ray=no.Vector3.create()},no.Light.prototype=Object.create(no.Object.prototype),no.Vertex=function(e,t,a){this.position=no.Vector3.create(e,t,a)},no.Vertex.prototype={setPosition:function(e,t,a){return no.Vector3.set(this.position,e,t,a),this}},no.Triangle=function(e,t,a){this.a=e||new no.Vertex,this.b=t||new no.Vertex,this.c=a||new no.Vertex,this.vertices=[this.a,this.b,this.c],this.u=no.Vector3.create(),this.v=no.Vector3.create(),this.centroid=no.Vector3.create(),this.normal=no.Vector3.create(),this.color=new no.Color,this.polygon=document.createElementNS(no.SVGNS,"polygon"),this.polygon.setAttributeNS(null,"stroke-linejoin","round"),this.polygon.setAttributeNS(null,"stroke-miterlimit","1"),this.polygon.setAttributeNS(null,"stroke-width","1"),this.computeCentroid(),this.computeNormal()},no.Triangle.prototype={computeCentroid:function(){return this.centroid[0]=this.a.position[0]+this.b.position[0]+this.c.position[0],this.centroid[1]=this.a.position[1]+this.b.position[1]+this.c.position[1],this.centroid[2]=this.a.position[2]+this.b.position[2]+this.c.position[2],no.Vector3.divideScalar(this.centroid,3),this},computeNormal:function(){return no.Vector3.subtractVectors(this.u,this.b.position,this.a.position),no.Vector3.subtractVectors(this.v,this.c.position,this.a.position),no.Vector3.crossVectors(this.normal,this.u,this.v),no.Vector3.normalise(this.normal),this}},no.Geometry=function(){this.vertices=[],this.triangles=[],this.dirty=!1},no.Geometry.prototype={update:function(){if(this.dirty){var e,t;for(e=this.triangles.length-1;e>=0;e--)t=this.triangles[e],t.computeCentroid(),t.computeNormal();this.dirty=!1}return this}},no.Plane=function(e,t,a,i){var n,o,r;no.Geometry.call(this),this.width=e||100,this.height=t||100,this.segments=a||4,this.slices=i||4,this.segmentWidth=this.width/this.segments,this.sliceHeight=this.height/this.slices;a=[];for(n=-.5*this.width,o=.5*this.height,e=0;e<=this.segments;e++)for(a.push([]),t=0;t<=this.slices;t++)i=new no.Vertex(n+e*this.segmentWidth,o-t*this.sliceHeight),a[e].push(i),this.vertices.push(i);for(e=0;e<this.segments;e++)for(t=0;t<this.slices;t++)i=a[e+0][t+0],n=a[e+0][t+1],o=a[e+1][t+0],r=a[e+1][t+1],window.t0=new no.Triangle(i,n,o),window.t1=new no.Triangle(o,n,r),this.triangles.push(window.t0,window.t1)},no.Plane.prototype=Object.create(no.Geometry.prototype),no.Material=function(e,t){this.ambient=new no.Color(e||"#444444"),this.diffuse=new no.Color(t||"#FFFFFF"),this.slave=new no.Color},no.Mesh=function(e,t){no.Object.call(this),this.geometry=e||new no.Geometry,this.material=t||new no.Material,this.side=no.FRONT,this.visible=!0},no.Mesh.prototype=Object.create(no.Object.prototype),no.Mesh.prototype.update=function(e,t){var a,i,n,o,r;if(this.geometry.update(),t)for(a=this.geometry.triangles.length-1;a>=0;a--){for(i=this.geometry.triangles[a],no.Vector4.set(i.color.rgba),n=e.length-1;n>=0;n--)o=e[n],no.Vector3.subtractVectors(o.ray,o.position,i.centroid),no.Vector3.normalise(o.ray),r=no.Vector3.dot(i.normal,o.ray),this.side===no.FRONT?r=Math.max(r,0):this.side===no.BACK?r=Math.abs(Math.min(r,0)):this.side===no.DOUBLE&&(r=Math.max(Math.abs(r),0)),no.Vector4.multiplyVectors(this.material.slave.rgba,this.material.ambient.rgba,o.ambient.rgba),no.Vector4.add(i.color.rgba,this.material.slave.rgba),no.Vector4.multiplyVectors(this.material.slave.rgba,this.material.diffuse.rgba,o.diffuse.rgba),no.Vector4.multiplyScalar(this.material.slave.rgba,r),no.Vector4.add(i.color.rgba,this.material.slave.rgba);no.Vector4.clamp(i.color.rgba,0,1)}return this},no.Scene=function(){this.meshes=[],this.lights=[]},no.Scene.prototype={add:function(e){return e instanceof no.Mesh&&!~this.meshes.indexOf(e)?this.meshes.push(e):e instanceof no.Light&&!~this.lights.indexOf(e)&&this.lights.push(e),this},remove:function(e){return e instanceof no.Mesh&&~this.meshes.indexOf(e)?this.meshes.splice(this.meshes.indexOf(e),1):e instanceof no.Light&&~this.lights.indexOf(e)&&this.lights.splice(this.lights.indexOf(e),1),this}},no.Renderer=function(){this.halfHeight=this.halfWidth=this.height=this.width=0},no.Renderer.prototype={setSize:function(e,t){if(this.width!==e||this.height!==t)return this.width=e,this.height=t,this.halfWidth=.5*this.width,this.halfHeight=.5*this.height,this},clear:function(){return this},render:function(){return this}},no.CanvasRenderer=function(){no.Renderer.call(this),this.element=document.createElement("canvas"),this.element.style.display="block",this.context=this.element.getContext("2d"),this.setSize(this.element.width,this.element.height)},no.CanvasRenderer.prototype=Object.create(no.Renderer.prototype),no.CanvasRenderer.prototype.setSize=function(e,t){return no.Renderer.prototype.setSize.call(this,e,t),this.element.width=e,this.element.height=t,this.context.setTransform(1,0,0,-1,this.halfWidth,this.halfHeight),this},no.CanvasRenderer.prototype.clear=function(){return no.Renderer.prototype.clear.call(this),this.context.clearRect(-this.halfWidth,-this.halfHeight,this.width,this.height),this},no.CanvasRenderer.prototype.render=function(e){var t,a,i,n,o;for(no.Renderer.prototype.render.call(this,e),this.clear(),this.context.lineJoin="round",this.context.lineWidth=1,t=e.meshes.length-1;t>=0;t--)if(a=e.meshes[t],a.visible)for(a.update(e.lights,!0),i=a.geometry.triangles.length-1;i>=0;i--)n=a.geometry.triangles[i],o=n.color.format(),this.context.beginPath(),this.context.moveTo(n.a.position[0],n.a.position[1]),this.context.lineTo(n.b.position[0],n.b.position[1]),this.context.lineTo(n.c.position[0],n.c.position[1]),this.context.closePath(),this.context.strokeStyle=o,this.context.fillStyle=o,this.context.stroke(),this.context.fill();return this};var ro,lo,so=a("f6e7"),co=a.n(so),uo=(a("5118"),co.a.map({username:co.a.required.$msg("请输入登录名").string.other("form",{placeholder:"登录名"}),password:co.a.required.$msg("请输入密码").string.other("form",{placeholder:"密码",type:"password"})}).other("form",{cols:{label:0,wrapper:24}})),po={data:function(){return{user:{username:"yuanjunnan",password:"yuanjunnan@yjn@"},codeUrl:"captcha.jpg",isNormalActive:!0,isDomainActive:!1}},components:{},computed:{formSchema:function(){return this.schema||uo}},props:["schema"],methods:{keyupSubmit:function(e){13===e.keyCode&&this.$refs.loginForm.handleSubmit()},changAccoutType:function(e){"normal"===e?(this.isNormalActive=!0,this.isDomainActive=!1):(this.isNormalActive=!1,this.isDomainActive=!0)},createCav:function(){!window.ActiveXObject&&document.createElement("canvas").getContext},handleLogin:function(e){var t=this;0===e.length&&(this.isDomainActive?(this.user.ldapName=this.user.username,delete this.user.username):delete this.user.ldapName,window.localStorage&&window.localStorage.setItem("loginType",this.isDomainActive?"normal":"domain"),this.$login(this.user).then(function(e){console.log("redirect="+t.$route.query.redirect),t.$router.push({path:t.$route.query.redirect||"/desktop"})},function(){t.isDomainActive&&(t.user.username=t.user.ldapName)}))},updateValicode:function(){this.codeUrl+="?_="+(new Date).getTime()}},created:function(){oo()}},ho=po,mo=(a("e86d"),Object(Bn["a"])(ho,eo,to,!1,null,"dd15cf62",null)),fo=mo.exports,go=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isKeepAlive?a("keep-alive",[e.isKeepAlive?a("router-view"):e._e()],1):a("router-view")},bo=[],vo={computed:{isKeepAlive:function(){var e=this.$route.meta;return e&&!1!==e.isCache}}},yo=vo,wo=Object(Bn["a"])(yo,go,bo,!1,null,null,null),Io=wo.exports,Co=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("BroadcastBlockList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,read:e.handleRead,edit:e.handleEdit,delete:e.handleDelete}}),e.isShowList?e._e():a("BroadcastBlockInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},To=[],So=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{ref:"contentCard",staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"blockInfo"},on:{add:e.handleCreate,edit:e.handleEdit}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},ko=[],_o={homepage:{id:"homepageId",status:"homepageStatus"},panelInfo:{id:"pannelGroupId",status:"pannelStatus"},tabInfo:{id:"tabId",status:"tabStatus"},film:{id:"tabId",status:"tabStatus"},policy:{id:"policyId",status:"policyStatus"},broadcastBlock:{id:"id",status:"status"},blockInfo:{id:"pluginId",status:"pluginStatus"},sysPlugin:{id:"pluginId",status:"pluginStatus"},picture:{id:"pictureId",status:"pictureStatus"},layout:{id:"layoutId",status:"layoutStatus"},cornerIcon:{id:"cornerIconId",status:"cornerIconStatus"},cornerIconType:{id:"typeId",status:"typeStatus"},clickEvent:{id:"commonOnclickId",status:"commonOnclickStatus"},crowdRel:{id:"id"}},Po={data:function(){return{resourceType:void 0}},watch:{"table.data":"clearSelected"},methods:{handleRead:function(e,t){this.$emit("read",e,t)},handleCreate:function(){this.$emit("create")},handleEdit:function(){var e=this.selected.length;if(0===e)return this.$message({type:"error",message:"未选中记录"});if(e>1)return this.$message({type:"error",message:"只能选择一条记录"});var t=this.selected[0],a=this.resourceType,i=this.$consts.idPrefix,n=_o[a],o=t[n.id],r=t[n.status],l=this.$consts.status;if(-1===["clickEvent"].indexOf(a)&&o.toString().slice(0,2)!==i)return this.$message({type:"error",message:"无权限编辑该记录"});if(["crowdRel"].indexOf(a)>-1)return this.$emit("edit",t);if(["sysPlugin","picture","layout","cornerIcon","cornerIconType","clickEvent"].indexOf(a)>-1){if(r===l.accepted)return this.$message({type:"error",message:"该状态不允许编辑"})}else if(r!==l.draft&&r!==l.rejected)return this.$message({type:"error",message:"该状态不允许编辑"});this.$emit("edit",t)},handleDelete:function(){var e=this,t=this.selected,a=t.length;if(0===a)return this.$message({type:"error",message:"未选中记录"});this.$confirm("确认要删除选中对记录？").then(function(){e.$emit("delete",t)}).catch(function(){})},handleCopy:function(e){this.$emit("copy",e)},handleRowSelectionAdd:function(e){this.selected.push(e),this.updateTableSelected()},handleRowSelectionRemove:function(e){var t=_o[this.resourceType].id;this.selected=this.selected.filter(function(a){return a[t]!==e[t]}),this.updateTableSelected()},handleAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleRowSelectionAdd):(this.selected=[],this.table.selected=[])},handleAllRowSelectionRemove:function(){this.selected=[],this.table.selected=[]},updateTableSelected:function(){var e=_o[this.resourceType].id,t=this.table,a=this.selected.reduce(function(t,a){return t[a[e]]=!0,t},{});t.selected=t.data.reduce(function(t,i,n){return a[i[e]]&&t.push(n),t},[])},clearSelected:function(){this.selected=[],this.table.selected=[],this.updateTableSelected()}}},xo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("ActionList",{staticClass:"buttonGroup",attrs:{actions:e.actions,target:this}})],1)},Do=[],Fo=(a("6762"),a("2fdb"),{components:{ActionList:Dn["ActionList"]},props:{pageName:String,notContainBtns:{type:Array,default:function(){return[]}}},data:function(){return{actions:{}}},methods:{add:function(){this.$emit("add")},edit:function(){this.$emit("edit")},delete:function(){this.$emit("delete")},batchAudit:function(){this.$emit("batch-audit")}},created:function(){var e=this;this.$service.getButtonGroupForPageList(this.pageName).then(function(t){var a={};t.filter(function(e){return"contentAuthSetting"!==e.runComm}).forEach(function(t){if(!e.notContainBtns.includes(t.runComm))switch(t.runComm){case"add":a[t.runComm]={text:t.runName,type:"primary"};break;case"edit":a[t.runComm]={text:t.runName,type:"success"};break;case"delete":a[t.runComm]={text:t.runName,type:"danger"};break;default:a[t.runComm]={text:t.runName,type:"primary"};break}}),e.actions=a})}}),$o=Fo,Lo=(a("81eb"),Object(Bn["a"])($o,xo,Do,!1,null,"ba4d506a",null)),Ro=Lo.exports,No={extends:Po,components:{Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"],ButtonGroupForListPage:Ro},data:function(){var e=this;return{resourceType:"broadcastBlock",filter:this.genDefaultFilter(),filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",width:70,prop:"id",sortable:!0},{label:"轮播名称",prop:"containerName",sortable:!0,render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(i)}}},i.containerName)}},{label:"待审核的版本",prop:"duplicateVersion",sortable:!0,render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(i,i.duplicateVersion)}}},i.duplicateVersion)}},{label:"状态",prop:"status",sortable:!0,render:function(t,a){var i=a.row;return e.$consts.statusText[i.status]}},{label:"内容源",prop:"source",render:function(t,a){var i=a.row;return e.$consts.sourceTextWithNone[i.source]}},{label:"更新时间",prop:"lastUpdateDate",sortable:!0},{label:"操作",render:function(t,a){var i=a.row;if(i.showContentAuthSettingBtn)return t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleOpenContentAuthManager(i)}}},"内容权限")}}],data:[],selected:[],selectionType:"multiple"}}},methods:{handleOpenContentAuthManager:function(e){this.$refs.contentCard.handleShowContentAuthManager({id:e.id,type:"block",menuElId:"broadcastBlock"})},genDefaultFilter:function(){return{}},handleFilterChange:function(e,t){t&&(this.filter=t),"query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData()},handleFilterReset:function(){this.filter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();this.$service.broadcastBlockPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=co.a.map({id:co.a.o.oneOf([co.a.number,co.a.value("")]).$msg("请输入数字").other("form",{component:"Input",placeholder:"推荐位ID"}),containerName:co.a.o.string.other("form",{component:"Input",placeholder:"推荐位名称"}),status:co.a.o.enum(this.$consts.statusEnums).other("form",{component:"Select",placeholder:"审核状态"}),source:co.a.o.enum(this.$consts.sourceOptionsWithNoneEnums).other("form",{component:"Select",placeholder:"内容源"})}).other("form",{layout:"inline",cols:{item:5,label:0,wrapper:20},footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},Eo=No,Oo=(a("0f0b"),Object(Bn["a"])(Eo,So,ko,!1,null,"411a014a",null)),Ao=Oo.exports,Vo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("CommonContent",{ref:"commonContent",attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{replicate:e.replicate,edit:e.edit,unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,"submit-audit":function(t){return e.submitCheck(t,e.$consts.status.waiting)},"save-draft":function(t){return e.submitCheck(t,e.$consts.status.draft)},audit:function(t){return e.$emit("upsert-end")},"select-version":e.fetchData,"cancel-timing":function(t){return e.fetchData(e.basicForm.currentVersion)},delete:function(t){return e.$emit("upsert-end",t)}}},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"basicForm",staticClass:"el-form-add",attrs:{model:e.basicForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"推荐位名称",prop:"containerName",rules:[{required:!0,message:"请输入推荐位名称",trigger:"blur"}]}},[a("el-input",{attrs:{disabled:e.disabled},model:{value:e.basicForm.containerName,callback:function(t){e.$set(e.basicForm,"containerName",t)},expression:"basicForm.containerName"}})],1),a("el-form-item",{attrs:{label:"推荐位类型"}},[a("el-select",{attrs:{disabled:e.disabled},model:{value:e.basicForm.containerType,callback:function(t){e.$set(e.basicForm,"containerType",t)},expression:"basicForm.containerType"}},[a("el-option",{attrs:{label:"视频列表",value:"REFERENCE_BROADCASTING"}})],1)],1),a("el-form-item",{attrs:{label:"配置模式"}},[a("el-radio-group",{nativeOn:{change:function(t){return t.preventDefault(),e.modelChange(t)}},model:{value:e.basicForm.configModel,callback:function(t){e.$set(e.basicForm,"configModel",t)},expression:"basicForm.configModel"}},[a("el-radio",{attrs:{label:"broadcast",disabled:e.disabled}},[e._v("轮播模式")]),a("el-radio",{attrs:{label:"group",disabled:e.disabled}},[e._v("组合模式")])],1)],1),a("el-form-item",{attrs:{label:"内容源"}},[a("el-radio-group",{attrs:{value:e.basicForm.source},on:{input:e.handleSourceChange}},[a("el-radio",{attrs:{label:"none",disabled:e.disabled}},[e._v("无")]),a("el-radio",{attrs:{label:"o_tencent",disabled:e.disabled}},[e._v("腾讯")]),a("el-radio",{attrs:{label:"o_iqiyi",disabled:e.disabled}},[e._v("爱奇艺")]),a("el-radio",{attrs:{label:"o_youku",disabled:e.disabled}},[e._v("优酷")])],1)],1)],1),a("div",{staticClass:"split-bar"},[e._v("内容配置")]),a("div",{staticClass:"version-title"},[a("h4",{staticClass:"version-title__h"},[e._v("正常版本")]),"group"===e.basicForm.configModel?a("el-tag",{staticClass:"version-title__tag",attrs:{type:"warning"}},[e._v("短标题模式需至少运营四个资源，长标题模式至少6个，才能填满布局哦~")]):e._e(),"group"!==e.basicForm.configModel||e.disabled?e._e():a("ResourceSelector",{ref:"resourceSelector",staticStyle:{float:"right"},attrs:{"disable-partner":!!e.source,source:e.source,selectors:e.resourceOptions,"is-live":!1,"selection-type":"multiple"},on:{"select-end":e.handleSelectNormalmultipleResourceEnd}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("批量选择资源")])],1)],1),a("div",{staticClass:"form-wrap"},["group"===e.basicForm.configModel?a("el-row",{staticClass:"normal-left-list",style:e.classObject,attrs:{gutter:4}},[e.disabled?e._l(e.normalVersionContent,function(t,i){return a("el-card",{key:i,staticClass:"normal-version-wrap",class:{active:i===e.currentIndex},nativeOn:{click:function(t){return e.switchNormal(i)}}},[t.poster.pictureUrl?a("img",{attrs:{src:t.poster.pictureUrl,referrerpolicy:"no-referrer"}}):e._e(),a("span",[e._v(e._s(t.title))])])}):a("draggable",{attrs:{options:{group:"normalVersion"}},on:{start:function(t){return e.onDragStart(t)},end:function(t){return e.onDragtEnd(t)}},model:{value:e.normalVersionContent,callback:function(t){e.normalVersionContent=t},expression:"normalVersionContent"}},e._l(e.normalVersionContent,function(t,i){return a("el-card",{key:i,staticClass:"normal-version-wrap",class:{active:i===e.currentIndex},nativeOn:{click:function(t){return e.switchNormal(i)}}},[e.normalVersionContent.length>1&&!e.disabled?a("i",{staticClass:"el-icon-close",on:{click:function(t){return t.stopPropagation(),e.deleteNormal(i)}}}):e._e(),t.poster.pictureUrl?a("img",{attrs:{src:t.poster.pictureUrl,referrerpolicy:"no-referrer"}}):e._e(),a("span",[e._v(e._s(t.title))])])}),1),e.disabled?e._e():a("el-card",{staticStyle:{cursor:"pointer"}},[a("span",{staticClass:"add-version",on:{click:e.addNormal}},[e._v("+添加资源")])])],2):e._e(),a("el-form",{ref:"normalForm",staticClass:"el-form-add",class:{cutLine:"group"===e.basicForm.configModel},staticStyle:{float:"left",width:"75%"},attrs:{model:e.normalForm,rules:e.normalRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:e.normalResourceBtn,prop:"thirdIdOrPackageName"}},[e.autoWrite&&"轮播资源"===e.normalResourceBtn&&!e.disabled?a("ResourceSelector",{ref:"resourceSelector",attrs:{"disable-partner":!!e.source,source:e.source,selectors:["rotate"],"is-live":!1,"selection-type":"single"},on:{"select-end":function(t){return e.handleSelectNormalSingleResourceEnd(t,"single")}}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("选择资源")])],1):e._e(),e.autoWrite&&"播放资源"===e.normalResourceBtn&&!e.disabled?a("ResourceSelector",{ref:"resourceSelector",attrs:{source:e.source,"disable-partner":!!e.source,selectors:e.resourceOptions,"is-live":!1,"selection-type":"single"},on:{"select-end":function(t){return e.handleSelectNormalSingleResourceEnd(t,"Multiple")}}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("选择资源")])],1):e._e(),e.autoWrite?e._e():a("el-input",{staticStyle:{float:"left"},attrs:{disabled:e.disabled},on:{blur:e.getUrlBlur},model:{value:e.normalForm.thirdIdOrPackageName,callback:function(t){e.$set(e.normalForm,"thirdIdOrPackageName",t)},expression:"normalForm.thirdIdOrPackageName"}}),e.normalForm.thirdIdOrPackageName&&e.autoWrite?a("el-tag",{staticClass:"marginL",attrs:{type:"success"}},[e._v("已选择："+e._s(e.normalForm.thirdIdOrPackageName))]):e._e(),e.autoWrite&&"group"===e.basicForm.configModel&&!e.disabled?a("a",{staticClass:"write-play",attrs:{href:"#"},on:{click:e.autoWriteFun}},[e._v("手动填写播放串")]):e._e(),e.autoWrite||"group"!==e.basicForm.configModel||e.disabled?e._e():a("a",{staticClass:"write-play",staticStyle:{float:"left"},attrs:{href:"#"},on:{click:e.autoWriteFun}},[e._v("自动配置播放资源")])],1),"group"===e.basicForm.configModel?a("div",[e.normalForm.subchannelIs?a("el-form-item",{attrs:{label:"指定子频道",prop:"subchannelId"}},[a("el-input",{attrs:{disabled:e.disabled},on:{blur:function(t){return e.getSubchannel(e.normalForm)}},model:{value:e.normalForm.subchannelId,callback:function(t){e.$set(e.normalForm,"subchannelId",t)},expression:"normalForm.subchannelId"}})],1):e._e(),a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{attrs:{disabled:e.disabled},on:{blur:e.getTitleNormal},model:{value:e.normalForm.title,callback:function(t){e.$set(e.normalForm,"title",t)},expression:"normalForm.title"}})],1),a("el-form-item",{attrs:{label:"副标题",prop:"subTitle"}},[a("el-input",{attrs:{disabled:e.disabled},model:{value:e.normalForm.subTitle,callback:function(t){e.$set(e.normalForm,"subTitle",t)},expression:"normalForm.subTitle"}})],1)],1):e._e(),a("el-form-item",{attrs:{label:"海报",prop:"poster.pictureUrl"}},[a("el-card",{staticClass:"post-box",staticStyle:{height:"180px"},nativeOn:{click:function(t){return e.openPicture("poster","normalForm")}}},[e.normalForm.poster.pictureUrl?a("img",{staticStyle:{height:"180px"},attrs:{src:e.normalForm.poster.pictureUrl,referrerpolicy:"no-referrer"}}):e._e()])],1),a("el-form-item",{attrs:{label:"角标"}},[a("el-card",{staticClass:"corner-box"},e._l(e.normalForm.cornerIconList,function(t,i){return a("span",{key:i,staticClass:"corner",class:"corner-"+i},[t.imgUrl?a("span",{staticClass:"corner-img-wrapper",on:{click:function(t){return e.openPicture("corner","normalForm",i)}}},[a("img",{attrs:{src:t.imgUrl,referrerpolicy:"no-referrer"}}),e.disabled?e._e():a("i",{staticClass:"el-icon-delete",on:{click:function(t){return t.stopPropagation(),e.deleteCorner(e.normalForm,i)}}})]):a("el-tag",{attrs:{type:"success"},on:{click:function(t){return e.openPicture("corner","normalForm",i)}}},[a("i",{staticClass:"el-icon-plus"})])],1)}),0)],1),"group"===e.basicForm.configModel?a("el-form-item",{attrs:{label:"点击跳转"}},[a("el-radio-group",{model:{value:e.normalForm.clickType,callback:function(t){e.$set(e.normalForm,"clickType",t)},expression:"normalForm.clickType"}},[a("el-radio",{attrs:{label:"detail",disabled:e.disabled}},[e._v("点击进详情页")]),a("el-radio",{directives:[{name:"show",rawName:"v-show",value:e.couldFullscreen,expression:"couldFullscreen"}],attrs:{label:"play-fullscreen",disabled:e.disabled}},[e._v("点击直接全屏播放")])],1)],1):e._e(),"group"===e.basicForm.configModel?a("el-form-item",{attrs:{label:"点击事件",prop:"sign"}},[a("el-radio-group",{attrs:{value:e.normalForm.sign,disabled:e.signDisabled},on:{input:e.handleChangeSign}},[a("el-radio",{attrs:{label:"autoSet",disabled:e.disabled}},[e._v("跳转本播放资源")]),a("el-radio",{attrs:{label:"manualResource",disabled:e.disabled}},[e._v("跳转其他播放资源")]),a("el-radio",{attrs:{label:"manualSet",disabled:e.disabled}},[e._v("手动设置")])],1)],1):e._e(),a("el-form-item",{attrs:{label:"",prop:"clickParams"}},["manualResource"===e.normalForm.sign?a("div",[e.disabled?e._e():a("ResourceSelector",{ref:"resourceSelector",attrs:{"disable-partner":!!e.source,source:e.source,selectors:e.resourceOptions,"is-live":!1,"selection-type":"single"},on:{"select-end":function(t){return e.handleSelectNormalSingleOtherResourceEnd(t)}}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("选择资源")])],1),a("span",{directives:[{name:"show",rawName:"v-show",value:e.thirdIdOrPackageNameForClick,expression:"thirdIdOrPackageNameForClick"}]},[e._v("已选择: "+e._s(e.thirdIdOrPackageNameForClick))])],1):e._e()]),"manualSet"===e.normalForm.sign?a("div",[a("el-form-item",{attrs:{label:"打开方式"}},[a("el-select",{attrs:{value:"第三方应用",disabled:e.disabled}},[a("el-option",{attrs:{value:"app"}},[e._v("第三方应用")])],1),a("el-button",{staticClass:"marginL",attrs:{type:"primary",plain:"",disabled:e.disabled},on:{click:function(t){e.onclickEventVisible=!0,e.onclickEventVisibleFlag="normal"}}},[e._v("快速填充")])],1),e.disabled?e._e():a("AppParams",{attrs:{"prop-prefix":"onclick."},model:{value:e.normalForm.onclick,callback:function(t){e.$set(e.normalForm,"onclick",t)},expression:"normalForm.onclick"}}),e.disabled?a("AppParamsRead",{attrs:{value:e.normalForm.onclick}}):e._e()],1):e._e()],1)],1),a("div",{staticClass:"version-title",staticStyle:{"margin-top":"25px"}},[a("h4",{staticStyle:{float:"left","margin-top":"7px"}},[e._v("兼容低版本")]),"group"===e.basicForm.configModel?a("div",{staticStyle:{display:"inline-block","margin-left":"14px"}},[a("el-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary",plain:"",disabled:e.disabled},on:{click:e.lowerFill}},[e._v("快速填充\n        ")]),a("span",[e._v("使用正常版本的第一个资源，快速配置")])],1):e._e()]),a("div",{staticClass:"form-wrap"},[a("el-form",{ref:"lowerForm",staticClass:"el-form-add",attrs:{model:e.lowerForm,rules:e.lowerRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"资源类别",prop:"coverType"}},[a("el-radio-group",{on:{change:e.cleanLowerForm},model:{value:e.lowerForm.coverType,callback:function(t){e.$set(e.lowerForm,"coverType",t)},expression:"lowerForm.coverType"}},[a("el-radio",{attrs:{label:"media",disabled:e.disabled}},[e._v("媒体资源")]),a("el-radio",{attrs:{label:"app",disabled:e.disabled}},[e._v("应用")]),a("el-radio",{attrs:{label:"custom",disabled:e.disabled}},[e._v("自定义")])],1)],1),"media"===e.lowerForm.coverType||"app"===e.lowerForm.coverType?a("el-form-item",{attrs:{label:"内容资源",prop:"thirdIdOrPackageName"}},[e.disabled?e._e():a("ResourceSelector",{ref:"resourceSelector",attrs:{"disable-partner":!!e.source,source:e.source,selectors:e.resourceOptions,"is-live":!1,"selection-type":"single"},on:{"select-end":e.handleSelectLowerSingleResourceEnd}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("选择资源")])],1),e.lowerForm.thirdIdOrPackageName?a("el-tag",{staticClass:"marginL",attrs:{type:"success"}},[e._v("已选择："+e._s(e.lowerForm.thirdIdOrPackageName))]):e._e()],1):e._e(),e.lowerForm.subchannelIs?a("el-form-item",{attrs:{label:"指定子频道",prop:"subchannelId"}},[a("el-input",{attrs:{disabled:e.disabled},on:{blur:function(t){return e.getSubchannel(e.lowerForm)}},model:{value:e.lowerForm.subchannelId,callback:function(t){e.$set(e.lowerForm,"subchannelId",t)},expression:"lowerForm.subchannelId"}})],1):e._e(),e.lowerForm.smallTopicsIs?a("el-form-item",{attrs:{label:"指定小专题",prop:"smallTopicsId"}},[a("el-input",{attrs:{disabled:e.disabled},on:{blur:e.smallTopicsLower},model:{value:e.lowerForm.smallTopicsId,callback:function(t){e.$set(e.lowerForm,"smallTopicsId",t)},expression:"lowerForm.smallTopicsId"}})],1):e._e(),a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{attrs:{disabled:e.disabled},model:{value:e.lowerForm.title,callback:function(t){e.$set(e.lowerForm,"title",t)},expression:"lowerForm.title"}})],1),a("el-form-item",{attrs:{label:"副标题",prop:"subTitle"}},[a("el-input",{attrs:{disabled:e.disabled},model:{value:e.lowerForm.subTitle,callback:function(t){e.$set(e.lowerForm,"subTitle",t)},expression:"lowerForm.subTitle"}})],1),a("el-form-item",{attrs:{label:"海报",prop:"poster.pictureUrl"}},[a("el-card",{staticClass:"post-box",staticStyle:{height:"180px"},attrs:{disabled:e.disabled},nativeOn:{click:function(t){return e.openPicture("poster","lowerForm")}}},[e.lowerForm.poster.pictureUrl?a("img",{staticStyle:{height:"180px"},attrs:{src:e.lowerForm.poster.pictureUrl,referrerpolicy:"no-referrer"}}):e._e()])],1),a("el-form-item",{attrs:{label:"角标"}},[a("el-card",{staticClass:"corner-box"},e._l(e.lowerForm.cornerIconList,function(t,i){return a("span",{key:i,staticClass:"corner",class:"corner-"+i},[t.imgUrl?a("span",{staticClass:"corner-img-wrapper",on:{click:function(t){return e.openPicture("corner","lowerForm",i)}}},[a("img",{attrs:{src:t.imgUrl,referrerpolicy:"no-referrer"}}),e.disabled?e._e():a("i",{staticClass:"el-icon-delete",on:{click:function(t){return t.stopPropagation(),e.deleteCorner(e.lowerForm,i)}}})]):a("el-tag",{attrs:{type:"success"},on:{click:function(t){return e.openPicture("corner","lowerForm",i)}}},[a("i",{staticClass:"el-icon-plus"})])],1)}),0)],1),"media"===e.lowerForm.coverType||"app"===e.lowerForm.coverType?a("div",[a("el-form-item",{attrs:{label:"应用版本号",prop:"versionCode"}},[a("el-input",{attrs:{disabled:e.disabled},model:{value:e.lowerForm.versionCode,callback:function(t){e.$set(e.lowerForm,"versionCode",t)},expression:"lowerForm.versionCode"}})],1)],1):e._e(),"custom"===e.lowerForm.coverType?a("div",[a("el-form-item",{attrs:{label:"打开方式"}},[a("el-select",{attrs:{value:"第三方应用",disabled:e.disabled}},[a("el-option",{attrs:{value:"app"}},[e._v("第三方应用")])],1),a("el-button",{staticClass:"marginL",attrs:{type:"primary",plain:"",disabled:e.disabled},on:{click:function(t){e.onclickEventVisible=!0,e.onclickEventVisibleFlag="lower"}}},[e._v("快速填充")])],1),e.disabled?e._e():a("AppParams",{ref:"openWayLower",attrs:{"prop-prefix":"onclick."},model:{value:e.lowerForm.onclick,callback:function(t){e.$set(e.lowerForm,"onclick",t)},expression:"lowerForm.onclick"}},[e._v(e._s(e.lowerForm.onclick)+"\n          ")]),e.disabled?a("AppParamsRead",{attrs:{value:e.lowerForm.onclick}}):e._e()],1):e._e()],1)],1),a("el-dialog",{attrs:{visible:e.customDialogPicture.visible,width:"1200px"},on:{"update:visible":function(t){return e.$set(e.customDialogPicture,"visible",t)}}},[e.customDialogPicture.visible?a("DialogPicture",{attrs:{title:e.customDialogPicture.title,pictureResolution:e.pictureResolution,form:e.customDialogPicture.form},on:{"close-dialog":e.savePicture},model:{value:e.selectPicture,callback:function(t){e.selectPicture=t},expression:"selectPicture"}}):e._e(),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.customDialogPicture.visible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.savePicture}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{visible:e.customDialogCorner.visible,width:"1200px"},on:{"update:visible":function(t){return e.$set(e.customDialogCorner,"visible",t)}}},[e.customDialogCorner.visible?a("DialogCorner",{attrs:{typePosition:e.customDialogCorner.index,cornerIconTypeOptions:e.cornerIconTypeOptions},on:{"close-dialog":e.savePicture},model:{value:e.selectPicture,callback:function(t){e.selectPicture=t},expression:"selectPicture"}}):e._e(),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.customDialogCorner.visible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.savePicture}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{visible:e.onclickEventVisible,width:"1200px"},on:{"update:visible":function(t){e.onclickEventVisible=t}}},[a("selectClick",{on:{"row-click":e.getClickData}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.onclickEventVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onclickEventVisible=!1,e.clickThirdpartSubmit()}}},[e._v("确 定")])],1)],1)],1)],1)},Mo=[],Bo=(a("8615"),a("75fc")),Uo=a("310e"),jo=a.n(Uo),Go=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("RemoteSelectorWrapper",{ref:"wrapper",attrs:{"custom-class":"resource-selector"},on:{"select-start":e.handleSelectStart},scopedSlots:e._u([{key:"content",fn:function(t){var i=t.isShow;return[e.isLive||i?[a("video-selector",{directives:[{name:"show",rawName:"v-show",value:"video"===e.activeSelector,expression:"activeSelector === 'video'"}],ref:"video-selector",attrs:{"disable-partner":e.disablePartner,source:e.source,"selection-type":e.selectionType},on:{"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}}),a("app-selector",{directives:[{name:"show",rawName:"v-show",value:"app"===e.activeSelector,expression:"activeSelector === 'app'"}],ref:"app-selector",attrs:{source:e.source,"selection-type":e.selectionType},on:{"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}}),a("edu-selector",{directives:[{name:"show",rawName:"v-show",value:"edu"===e.activeSelector,expression:"activeSelector === 'edu'"}],ref:"edu-selector",attrs:{source:e.source,"selection-type":e.selectionType},on:{"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}}),a("pptv-selector",{directives:[{name:"show",rawName:"v-show",value:"pptv"===e.activeSelector,expression:"activeSelector === 'pptv'"}],ref:"pptv-selector",attrs:{source:e.source,"selection-type":e.selectionType},on:{"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}}),a("live-selector",{directives:[{name:"show",rawName:"v-show",value:"live"===e.activeSelector,expression:"activeSelector === 'live'"}],ref:"live-selector",attrs:{source:e.source,"selection-type":e.selectionType},on:{"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}}),a("topic-selector",{directives:[{name:"show",rawName:"v-show",value:"topic"===e.activeSelector,expression:"activeSelector === 'topic'"}],ref:"topic-selector",attrs:{source:e.source,"selection-type":e.selectionType},on:{"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}}),a("rotate-selector",{directives:[{name:"show",rawName:"v-show",value:"rotate"===e.activeSelector,expression:"activeSelector === 'rotate'"}],ref:"rotate-selector",attrs:{source:e.source,"selection-type":e.selectionType},on:{"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}}),a("func-selector",{directives:[{name:"show",rawName:"v-show",value:"func"===e.activeSelector,expression:"activeSelector === 'func'"}],ref:"func-selector",attrs:{source:e.source,"selection-type":e.selectionType},on:{"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}}),a("broadcast-selector",{directives:[{name:"show",rawName:"v-show",value:"broadcast"===e.activeSelector,expression:"activeSelector === 'broadcast'"}],ref:"broadcast-selector",attrs:{source:e.source,"selection-type":e.selectionType},on:{"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}})]:e._e()]}}])},[a("div",{staticClass:"resource-selector__header",attrs:{slot:"title"},slot:"title"},[e._l(e.SELECTORS,function(t){return[e.selectors.indexOf(t.value)>-1?a("a",{key:t.value,class:t.value===e.activeSelector?"active":"",on:{click:function(a){return e.handleActivateSelector(t.value)}}},[e._v("\n        "+e._s(t.label)+"\n      ")]):e._e()]})],2),e._t("default")],2)},Wo=[],qo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"remote-selector-wrapper"},[a("div",{on:{click:e.handleSelectStart}},[e._t("default",[a("el-button",{attrs:{type:"primary",disabled:e.disabled,plain:""}},[e._v(" "+e._s(e.title))])])],2),a("Dialog",{staticClass:"remote-selector-dialog",attrs:{"custom-class":e.customClass,"show-close":e.showClose,fullscreen:e.fullscreen,visible:e.showDialog,"append-to-body":!0},on:{"update:visible":function(t){e.showDialog=t}}},[a("div",{attrs:{slot:"title"},slot:"title"},[e._t("title",[e._v(" "+e._s(e.title))])],2),e._t("content",[a("div",{staticClass:"remote-selector-main"},[a("div",{staticClass:"remote-selector-main__filter"},[e._t("filter",[e.filterSchema?a("GateSchemaForm",{attrs:{schema:e.filterSchema},on:{submit:e.handleFilter,reset:e.handleResetFilterForm},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}}):e._e()])],2),a("div",{staticClass:"remote-selector-main__content"},[e._t("item-list")],2),a("div",{staticClass:"remote-selector-main__footer"},[a("div",{staticClass:"remote-selector-main__pagination"},[e._t("pagination",[e.pagination?a("el-pagination",{attrs:{"current-page":e.pagination.currentPage,"page-sizes":[15,20,30,50,100,200],"page-size":e.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pagination.total},on:{"size-change":e.handlePageSizeChange,"current-change":e.handlePageChange}}):e._e()])],2),a("div",{staticClass:"remote-selector-main__actions"},[e._t("actions",[e.hideSubmit?e._e():a("Button",{attrs:{type:"primary"},on:{click:e.handleSelectEnd}},[e._v("\n                  确定\n                ")]),a("Button",{on:{click:e.handleSelectCancel}},[e._v("\n                  取消\n                ")])])],2)])])],{isShow:e.showDialog})],2)],1)},Ho=[],zo={components:{Button:A["Button"],Dialog:A["Dialog"],Tag:A["Tag"]},props:{title:{type:String,default:function(){return"选择"}},hideSubmit:{type:Boolean},fullscreen:{type:Boolean,default:function(){return!0}},filter:Object,filterSchema:Object,pagination:Object,customClass:String,showClose:{type:Boolean,default:function(){return!0}},disabled:{type:Boolean,default:function(){return!1}}},data:function(){return{showDialog:!1,showContent:!1}},methods:{handleSelectStart:function(){this.disabled||(this.showDialog=!0,this.$emit("select-start"))},handleSelectEnd:function(){this.showDialog=!1,this.$emit("select-end")},handleSelectCancel:function(){this.showDialog=!1,this.$emit("select-cancel")},handleFilter:function(e){e&&0!==e.length||this.$emit("filter-change")},handlePageSizeChange:function(e){this.$set(this.pagination,"pageSize",e),this.$emit("pagination-change")},handlePageChange:function(e){this.$set(this.pagination,"currentPage",e),this.$emit("pagination-change")},handleResetFilterForm:function(){this.$emit("filter-reset")},emitFilterChange:function(e){this.$emit("filter-change",e)}},created:function(){}},Jo=zo,Ko=(a("f7cc"),Object(Bn["a"])(Jo,qo,Ho,!1,null,"46f21efa",null)),Qo=Ko.exports,Xo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"id","is-live":e.isLive,"selection-type":e.selectionType,table:e.table,pagination:e.pagination},on:{"pagination-change":e.fetchData,"filter-reset":e.handleFilterReset,"select-cancel":function(t){return e.$emit("select-cancel")},"select-end":function(t){return e.$emit("select-end")}}},[a("el-form",{attrs:{slot:"filter",inline:!0,"label-width":"72px"},slot:"filter",model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("el-form-item",{attrs:{label:"专题类别"}},[a("el-select",{attrs:{clearable:""},model:{value:e.filter.levelType,callback:function(t){e.$set(e.filter,"levelType",t)},expression:"filter.levelType"}},e._l(e.options,function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"专题名称"}},[a("el-input",{model:{value:e.filter.title,callback:function(t){e.$set(e.filter,"title",t)},expression:"filter.title"}})],1),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{attrs:{size:"small",type:"warning"},on:{click:e.handleFilterReset}},[e._v("重置")])],1)],1)],1)},Yo=[],Zo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"remote-selector-main"},[a("div",{staticClass:"remote-selector-main__filter"},[e._t("filter",[e.filterSchema?a("GateSchemaForm",{attrs:{schema:e.filterSchema},on:{submit:e.handleFilter,reset:e.handleResetFilterForm},model:{value:e.viewFilter,callback:function(t){e.viewFilter=t},expression:"viewFilter"}}):e._e()])],2),a("div",{ref:"selectorContent",staticClass:"remote-selector-main__content"},[e._t("item-list",[a("Table",{attrs:{data:e.table.data,header:e.table.header,selected:e.tableSelected,props:e.tableProps,"selection-type":e.selectionType||e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleTableRowSelectionAdd,"row-selection-remove":e.handleTableRowSelectionRemove,"row-selection-change":e.handleTableRowSelectionChange,"all-row-selection-change":e.handleTableAllRowSelectionChange}})])],2),a("div",{staticClass:"remote-selector-main__footer"},[a("div",{staticClass:"remote-selector-main__pagination"},[e._t("pagination",[e.pagination?a("el-pagination",{attrs:{"current-page":e.pagination.currentPage,"page-sizes":[15,20,30,50,100,200],"page-size":e.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pagination.total},on:{"size-change":e.handlePageSizeChange,"current-change":e.handlePageChange}}):e._e()])],2),a("div",{staticClass:"remote-selector-main__actions"},[e._t("actions",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSelectEnd}},[e._v("\n            确定\n          ")]),a("el-button",{on:{click:e.handleSelectCancel}},[e._v("\n            取消\n          ")])])],2)]),e._t("default")],2)},er=[],tr={components:{Table:Dn["Table"]},data:function(){return{tableHeight:void 0,selected:[],tableSelected:[],inputFilter:{},viewFilter:{}}},props:["idField","filter","filterSchema","table","pagination","selectionType"],computed:{tableProps:function(){var e=this.table.Props||{};return e.height?e:Object(j["a"])({},e,{height:this.tableHeight})}},watch:{"table.data":"updateTableSelected"},methods:{setViewFilter:function(e){this.inputFilter!==e&&(this.inputFilter=e||{},this.viewFilter=e?JSON.parse(JSON.stringify(e)):{})},clearSelected:function(){this.selected=[],this.tableSelected=[]},handleSelectEnd:function(){if(0===this.selected.length)return this.$message({type:"error",message:"请选择数据"});this.$emit("select-end",this.selected.slice())},handleSelectCancel:function(){this.$emit("select-cancel"),this.tableSelected=[],this.selected=[]},handleFilter:function(e){e&&0!==e.length||(this.inputFilter=JSON.parse(JSON.stringify(this.viewFilter)),this.$set(this.pagination,"currentPage",1),this.$emit("filter-change",this.inputFilter))},handlePageSizeChange:function(e){this.$set(this.pagination,"pageSize",e),this.$emit("pagination-change")},handlePageChange:function(e){this.$set(this.pagination,"currentPage",e),this.$emit("pagination-change")},handleResetFilterForm:function(){this.$emit("filter-reset")},handleTableRowSelectionChange:function(e,t){this.selected=[e],this.tableSelected=t},handleTableRowSelectionAdd:function(e){this.selected=this.selected.concat(e),this.updateTableSelected()},handleTableRowSelectionRemove:function(e){var t=this.idField;this.selected=this.selected.filter(function(a){return a[t]!==e[t]}),this.updateTableSelected()},handleTableAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleTableRowSelectionAdd):this.table.data.forEach(this.handleTableRowSelectionRemove)},updateTableSelected:function(){var e=this.idField,t=this.table,a=this.selected.map(function(t){return t[e]});this.tableSelected=t.data.reduce(function(t,i,n){return a.indexOf(i[e])>-1&&t.push(n),t},[])},setTableHeight:function(){this.tableHeight=this.$refs.selectorContent.clientHeight+"px"}},created:function(){this.$watch("filter",this.setViewFilter,{immediate:!0})},mounted:function(){window.addEventListener("resize",this.setTableHeight),this.setTableHeight()},beforeDestroy:function(){window.removeEventListener("resize",this.setTableHeight)}},ar=tr,ir=(a("0c91"),Object(Bn["a"])(ar,Zo,er,!1,null,"bc330528",null)),nr=ir.exports,or={components:{BaseSelector:nr},data:function(){return{pagination:{currentPage:1,pageSize:15},filter:this.getDefaultFilter(),efficientFilter:this.getDefaultFilter(),options:[{label:"大专题",value:"parentTopic"},{label:"小专题",value:"childTopic"}],table:{props:{},data:[],header:[{prop:"id",label:"ID",fixed:!0,width:"100"},{prop:"title",label:"专题名称",fixed:!0,width:"220"},{prop:"picture",label:"专题背景",render:function(e,t){var a=t.row;if(a.picture)return e("img",{attrs:{src:a.picture,width:"110px",height:"50px",class:"imgs"}})},width:"120"},{prop:"dataSign",label:"专题类别",width:"200",formatter:function(e){return"parentTopic"===e.dataSign?"大专题":"childTopic"===e.dataSign?"小专题":void 0}},{prop:"lastUpdateDate",label:"更新时间",width:"200"}],selected:[],selectionType:"single"}}},props:["isLive","selectionType"],computed:{selected:function(){return this.$refs.baseSelector.selected.slice()}},methods:{getDefaultFilter:function(){return{resType:"operation",dataType:"topic",callback:"result",levelType:void 0,title:void 0}},getFilter:function(){var e=this.pagination,t=Object.assign({},this.efficientFilter);return e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.efficientFilter=this.getDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=this.getFilter();this.$service.getMediaVideoInfos(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows||[]})}}},rr=or,lr=Object(Bn["a"])(rr,Xo,Yo,!1,null,"7291207f",null),sr=lr.exports,cr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"appId","is-live":e.isLive,"selection-type":e.selectionType,table:e.table,pagination:e.pagination,filter:e.filter,"filter-schema":e.filterSchema},on:{"pagination-change":e.fetchData,"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset,"select-cancel":function(t){return e.$emit("select-cancel")},"select-end":function(t){return e.$emit("select-end")}}})},ur=[],dr={components:{BaseSelector:nr},data:function(){return{pagination:{currentPage:1,pageSize:15},filter:this.genDefaultFilter(),filterSchema:null,table:{props:{},header:[{label:"ID",prop:"appId",width:"70"},{label:"应用名称",prop:"appName",width:"100"},{label:"应用包名",prop:"appPackageName"},{label:"图片",prop:"appImageUrl",render:function(e,t){var a=t.row;return e("img",{attrs:{src:a.appImageUrl,width:"50px",height:"50px",class:"imgs"}})}}],data:[]}}},computed:{selected:function(){return this.$refs.baseSelector.selected.slice()}},props:["isLive","selectionType"],methods:{genDefaultFilter:function(){return{appId:void 0,appName:void 0,appPackageName:void 0}},getFilter:function(){var e=this.pagination,t=Object.assign({},this.filter);return e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(e){this.filter=e,this.fetchData()},handleFilterReset:function(){this.filter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=this.getFilter();this.$service.getAppManagementList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=co.a.map({appId:co.a.o.oneOf([co.a.value(""),co.a.number]).$msg("请输入数字").other("form",{component:"Input",placeholder:"应用ID",label:" "}),appName:co.a.o.string.other("form",{component:"Input",placeholder:"应用名称",label:" "}),appPackageName:co.a.o.string.other("form",{component:"Input",placeholder:"应用包名",label:" "})}).other("form",{cols:{item:4,label:1,wrapper:23},layout:"inline",footer:{cols:{item:3,label:1,wrapper:23},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e}},pr=dr,hr=Object(Bn["a"])(pr,cr,ur,!1,null,"0730f304",null),mr=hr.exports,fr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"pluginId","is-live":e.isLive,"selection-type":e.selectionType,table:e.table,pagination:e.pagination,filter:e.filter,"filter-schema":e.filterSchema},on:{"pagination-change":e.fetchData,"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset,"select-cancel":function(t){return e.$emit("select-cancel")},"select-end":function(t){return e.$emit("select-end")}}})},gr=[],br={components:{BaseSelector:nr},data:function(){var e=this;return{pagination:{currentPage:1,pageSize:15},filter:this.getDefaultFilter(),filterSchema:null,table:{props:{},header:[{prop:"id",label:"轮播ID",fixed:!0,searched:!0},{prop:"containerName",label:"轮播名称",fixed:!0,searched:!0},{prop:"source",label:"内容源",width:"120",options:[],render:function(t,a){var i=a.row;return e.$consts.sourceText[i.source]||"未知"}},{prop:"lastUpdateDate",label:"创建时间"}],data:[]}}},props:["isLive","selectionType","source"],computed:{selected:function(){return this.$refs.baseSelector.selected.slice()}},methods:{getDefaultFilter:function(){return{id:void 0,containerName:void 0,source:void 0}},getFilter:function(){var e=this.pagination,t=Object.assign({},this.filter);return t.code=t.id,e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(e){this.filter=e,this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=this.getFilter();this.$service.broadcastBlockDataList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=co.a.map({id:co.a.o.oneOf([co.a.value(""),co.a.number]).$msg("请输入数字").other("form",{component:"Input",placeholder:"轮播ID",label:" "}),containerName:co.a.o.string.other("form",{placeholder:"轮播名称",label:" "})}).other("form",{cols:{item:3,label:1,wrapper:23},layout:"inline",footer:{cols:{item:3,label:1,wrapper:23},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e}},vr=br,yr=Object(Bn["a"])(vr,fr,gr,!1,null,"6bbb82b8",null),wr=yr.exports,Ir=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"vId","is-live":e.isLive,"selection-type":e.selectionType,table:e.table,pagination:e.pagination},on:{"pagination-change":e.fetchData,"filter-reset":e.handleFilterReset,"select-cancel":function(t){return e.$emit("select-cancel")},"select-end":function(t){return e.$emit("select-end")}}},[a("el-form",{attrs:{slot:"filter",inline:!0,"label-width":"72px"},slot:"filter",model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("el-form-item",{attrs:{label:"内容源"}},[a("SourceSelector",{attrs:{freeze:!!e.source},model:{value:e.filter.source,callback:function(t){e.$set(e.filter,"source",t)},expression:"filter.source"}})],1),a("el-form-item",{attrs:{label:"资源类型"}},[a("el-select",{model:{value:e.filter.nodeType,callback:function(t){e.$set(e.filter,"nodeType",t)},expression:"filter.nodeType"}},e._l(e.options.nodeType,function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"内容类型"}},[a("el-select",{model:{value:e.filter.cateid,callback:function(t){e.$set(e.filter,"cateid",t)},expression:"filter.cateid"}},[a("el-option",{attrs:{label:"请选择",value:""}}),e._l(e.options.cateid,function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})],2)],1),a("el-form-item",{attrs:{label:"内容搜索"}},[a("el-input",{model:{value:e.filter.title,callback:function(t){e.$set(e.filter,"title",t)},expression:"filter.title"}})],1),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{attrs:{size:"small",type:"warning"},on:{click:e.handleFilterReset}},[e._v("重置")])],1)],1)],1)},Cr=[],Tr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-select",{attrs:{value:e.value,disabled:e.disabled,placeholder:e.placeholder},on:{input:function(t){return e.$emit("input",t)}}},e._l(e.sourceOptions,function(t,i){return a("el-option",{key:i,attrs:{disabled:e.freeze&&t.value!==e.value,label:t.label,value:t.value}})}),1)},Sr=[],kr={props:["value","disabled","freeze","allowEmpty","placeholder"],computed:{sourceOptions:function(){var e=this.$consts;return this.allowEmpty?e.sourceOptionsWidthEmpty:e.sourceOptions}}},_r=kr,Pr=Object(Bn["a"])(_r,Tr,Sr,!1,null,null,null),xr=Pr.exports,Dr={components:{BaseSelector:nr,SourceSelector:xr},data:function(){var e;return{pagination:{currentPage:1,pageSize:15},filter:this.getDefaultFilter(),efficientFilter:this.getDefaultFilter(),options:{nodeType:[{label:"直播",value:"live"},{label:"录播",value:"res"}],cateid:[{label:"足球",value:"1"},{label:"篮球",value:"2"},{label:"综合类型",value:"3"},{label:"非对阵类",value:"4"}]},table:(e={props:{},data:[],selected:[],header:[{prop:"vId",label:"ID",fixed:!0,width:"100"},{prop:"thirdId",label:"第三方ID",fixed:!0,width:"100"},{prop:"title",label:"标题",fixed:!0,width:"220"},{prop:"subTitle",label:"副标题",width:"120"},{prop:"cateid",label:"内容类别",width:"120"},{prop:"thumb",label:"海报",render:function(e,t){var a=t.row;return e("img",{attrs:{src:a.thumb,width:"50px",height:"50px",class:"imgs"}})},width:"120"},{prop:"startTime",label:"开始时间",width:"200"},{prop:"endTime",label:"结束时间",width:"200"},{prop:"createdDate",label:"创建时间",width:"200"},{prop:"lastUpdateDate",label:"更新时间",width:"200"}]},Object(ei["a"])(e,"selected",[]),Object(ei["a"])(e,"selectionType","single"),e)}},props:["isLive","selectionType","source"],computed:{selected:function(){return this.$refs.baseSelector.selected.slice()}},methods:{getDefaultFilter:function(){return{callbackparam:"result",source:this.source||this.$consts.sourceOptions[0].value,nodeType:"live",cateid:"",title:""}},getFilter:function(){var e=this.pagination,t=Object.assign({},this.efficientFilter);return e&&(t.page=e.currentPage,t.rows=e.pageSize),t.source&&(t.source=this.$consts.sourceToPartner[t.source]),t},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.efficientFilter=this.getDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=this.getFilter();this.$service.queryLiveVideoResult(t).then(function(t){t=JSON.parse(t.replace("result(","").replace(/\)*$/,"")),e.pagination.total=t.total,e.table.data=t.rows})}}},Fr=Dr,$r=Object(Bn["a"])(Fr,Ir,Cr,!1,null,"1ea26df0",null),Lr=$r.exports,Rr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"pid","is-live":e.isLive,"selection-type":e.selectionType,table:e.table,pagination:e.pagination},on:{"pagination-change":e.fetchData,"filter-reset":e.handleFilterReset,"select-cancel":function(t){return e.$emit("select-cancel")},"select-end":function(t){return e.$emit("select-end")}}},[a("el-form",{attrs:{slot:"filter",inline:!0,"label-width":"72px"},slot:"filter",model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("el-form-item",{attrs:{label:"资源类型"}},[a("CommonSelector",{attrs:{options:e.pTypeEnums},model:{value:e.filter.pType,callback:function(t){e.$set(e.filter,"pType",t)},expression:"filter.pType"}})],1),a("el-form-item",{attrs:{label:"内容搜索"}},[a("el-input",{model:{value:e.filter.pTitle,callback:function(t){e.$set(e.filter,"pTitle",t)},expression:"filter.pTitle"}})],1),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{attrs:{size:"small",type:"warning"},on:{click:e.handleFilterReset}},[e._v("重置")])],1)],1)],1)},Nr=[],Er=function(){var e=this,t=e.$createElement,a=e._self._c||t;return"radio"===e.type?a("el-radio-group",{attrs:{value:e.value,disabled:e.disabled},on:{input:function(t){return e.$emit("input",t)}}},e._l(e.options,function(t,i){return a("el-radio",{key:i,attrs:{disabled:t.disabled,label:t.value}},[e._v("\n      "+e._s(t.label)+"\n    ")])}),1):a("el-select",{attrs:{value:e.value,disabled:e.disabled,placeholder:e.placeholder||"请选择",filterable:e.filterable,"allow-create":e.allowCreate},on:{input:function(t){return e.$emit("input",t)}}},e._l(e.options,function(e,t){return a("el-option",{key:t,attrs:{disabled:e.disabled,label:e.label,value:e.value}})}),1)},Or=[],Ar={props:["type","options","disabled","value","placeholder","filterable","allowCreate"]},Vr=Ar,Mr=Object(Bn["a"])(Vr,Er,Or,!1,null,null,null),Br=Mr.exports,Ur={components:{BaseSelector:nr,CommonSelector:Br},data:function(){return{pagination:{currentPage:1,pageSize:15},filter:this.getDefaultFilter(),efficientFilter:this.getDefaultFilter(),pTypeEnums:[{label:"直播",value:"live"},{label:"录播",value:"res"}],table:{props:{},data:[],header:[{prop:"pid",label:"ID",fixed:!0,width:"100"},{prop:"pTitle",label:"节目名",fixed:!0,width:"220"},{prop:"liveStatus",label:"直播状态",width:120},{prop:"competition",label:"赛事名",width:120},{prop:"format",label:"赛制名",width:120},{prop:"round",label:"轮次名",width:120},{prop:"pType",label:"节目类型",width:120},{prop:"homeTeam",label:"主队名",width:150},{prop:"guestTeam",label:"客队名",width:150},{prop:"groups",label:"分组名",width:150},{prop:"startTime",label:"开始时间",width:200},{prop:"endTime",label:"结束时间",width:200},{prop:"score",label:"比分",width:120},{prop:"createDate",label:"创建时间",width:200}],selected:[],selectionType:"single"}}},props:["isLive","selectionType"],computed:{selected:function(){return this.$refs.baseSelector.selected.slice()}},methods:{getDefaultFilter:function(){return{pType:"live",pTitle:void 0}},getFilter:function(){var e=this.pagination,t=Object.assign({},this.efficientFilter);return e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.efficientFilter=this.getDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=this.getFilter();this.$service.mediaPPTVVideoList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}}},jr=Ur,Gr=Object(Bn["a"])(jr,Rr,Nr,!1,null,"20f446cb",null),Wr=Gr.exports,qr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"coocaaVId","is-live":e.isLive,"selection-type":e.selectionType,table:e.table,pagination:e.pagination},on:{"pagination-change":e.fetchData,"filter-reset":e.handleFilterReset,"select-cancel":function(t){return e.$emit("select-cancel")},"select-end":function(t){return e.$emit("select-end")}}},[a("el-collapse",{attrs:{slot:"filter",value:"1"},on:{change:e.handleCollapseChange},slot:"filter"},[a("el-collapse-item",{attrs:{title:"查询条件",name:"1"}},[a("el-form",{attrs:{inline:!0,"label-width":"72px"},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("el-form-item",{attrs:{label:"内容商"}},[a("CommonSelector",{attrs:{options:e.contentProviderEnums},model:{value:e.filter.contentProviders,callback:function(t){e.$set(e.filter,"contentProviders",t)},expression:"filter.contentProviders"}})],1),a("el-form-item",{attrs:{label:"教育分类"}},[a("CommonSelector",{attrs:{value:e.filter.teachTypes,options:e.teachTypeEnums},on:{input:e.handleTeachTypesChange}})],1),a("el-form-item",{attrs:{label:"年级年龄"}},[a("CommonSelector",{attrs:{options:e.gradeEnums,placeholder:"请选择"},model:{value:e.filter.gradeList,callback:function(t){e.$set(e.filter,"gradeList",t)},expression:"filter.gradeList"}})],1),a("el-form-item",{attrs:{label:"内容分类"}},[a("CommonSelector",{attrs:{options:e.videoTypeEnums,placeholder:"请选择"},model:{value:e.filter.videoTypes,callback:function(t){e.$set(e.filter,"videoTypes",t)},expression:"filter.videoTypes"}})],1),a("el-form-item",{attrs:{label:"付费类型"}},[a("CommonSelector",{attrs:{options:e.payTypeEnums,placeholder:"请选择"},model:{value:e.filter.payTypes,callback:function(t){e.$set(e.filter,"payTypes",t)},expression:"filter.payTypes"}})],1),a("el-form-item",{attrs:{label:"内容标签"}},[a("CommonSelector",{attrs:{options:e.contentTagEnums,placeholder:"请选择"},model:{value:e.filter.contentTag,callback:function(t){e.$set(e.filter,"contentTag",t)},expression:"filter.contentTag"}})],1),a("el-form-item",{attrs:{label:"课程名称"}},[a("el-input",{attrs:{size:"small"},model:{value:e.filter.title,callback:function(t){e.$set(e.filter,"title",t)},expression:"filter.title"}})],1),a("span",{directives:[{name:"show",rawName:"v-show",value:e.isMore,expression:"isMore"}]},[a("el-form-item",{attrs:{label:"课程版本"}},[a("CommonSelector",{attrs:{options:e.courseVersionEnums,placeholder:"请选择"},model:{value:e.filter.courseVersion,callback:function(t){e.$set(e.filter,"courseVersion",t)},expression:"filter.courseVersion"}})],1),a("el-form-item",{attrs:{label:"集数"}},[a("CommonSelector",{attrs:{options:e.segmentTagEnums,placeholder:"请选择"},model:{value:e.filter.segmentTag,callback:function(t){e.$set(e.filter,"segmentTag",t)},expression:"filter.segmentTag"}})],1),a("el-form-item",{attrs:{label:"是否全集"}},[a("el-select",{attrs:{filterable:"",size:"small"},model:{value:e.filter.updateStatus,callback:function(t){e.$set(e.filter,"updateStatus",t)},expression:"filter.updateStatus"}},[a("el-option",{attrs:{label:"请选择/输入",value:""}}),a("el-option",{attrs:{label:"不限",value:0}}),a("el-option",{attrs:{label:"是",value:1}})],1)],1),a("el-form-item",{attrs:{label:"同步时间"}},[a("el-select",{attrs:{filterable:"",size:"small"},model:{value:e.filter.synDate,callback:function(t){e.$set(e.filter,"synDate",t)},expression:"filter.synDate"}},[a("el-option",{attrs:{label:"请选择/输入",value:""}}),a("el-option",{attrs:{label:"7天",value:7,size:"small"}}),a("el-option",{attrs:{label:"15天",value:15,size:"small"}}),a("el-option",{attrs:{label:"1个月",value:30,size:"small"}}),a("el-option",{attrs:{label:"3个月",value:90,size:"small"}}),a("el-option",{attrs:{label:"1年",value:365,size:"small"}})],1)],1),a("el-form-item",{attrs:{label:"动漫明星"}},[a("el-input",{attrs:{size:"small"},model:{value:e.filter.cartoonStar,callback:function(t){e.$set(e.filter,"cartoonStar",t)},expression:"filter.cartoonStar"}})],1),a("el-form-item",{attrs:{label:"地区"}},[a("el-select",{attrs:{filterable:"","allow-create":"",size:"small"},model:{value:e.filter.areas,callback:function(t){e.$set(e.filter,"areas",t)},expression:"filter.areas"}},e._l(e.conditionList.areas,function(e){return a("el-option",{key:e.tagId,attrs:{label:e.tagCnName,value:e.tagCnName}})}),1)],1),a("el-form-item",{attrs:{label:"年代"}},[a("el-input",{staticStyle:{width:"48px"},attrs:{size:"small"},on:{blur:e.yearStartListen},model:{value:e.filter.yearStart,callback:function(t){e.$set(e.filter,"yearStart",t)},expression:"filter.yearStart"}}),e._v("\n            -\n            "),a("el-input",{staticStyle:{width:"48px"},attrs:{size:"small"},on:{blur:e.yearEndListen},model:{value:e.filter.yearEnd,callback:function(t){e.$set(e.filter,"yearEnd",t)},expression:"filter.yearEnd"}})],1),a("el-form-item",{attrs:{label:"排序方式"}},[a("el-select",{staticStyle:{width:"85px"},attrs:{size:"small"},model:{value:e.filter.orderBy,callback:function(t){e.$set(e.filter,"orderBy",t)},expression:"filter.orderBy"}},e._l(e.conditionList.orderBy,function(e){return a("el-option",{key:e.tagId,attrs:{label:e.tagCnName,value:e.tagEnName}})}),1),a("el-tooltip",{attrs:{content:"asc"===e.filter.order?"升序":"降序"}},[a("el-button",{attrs:{icon:"asc"===e.filter.order?"el-icon-arrow-up":"el-icon-arrow-down"},on:{click:function(t){return e.changeSort()}}})],1)],1)],1),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{icon:e.isMore?"arrow-up":"arrow-down",size:"small"},on:{click:function(t){e.isMore=!e.isMore}}},[e._v(e._s(e.isMore?"收起":"展开"))]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{attrs:{size:"small",type:"warning"},on:{click:e.handleFilterReset}},[e._v("重置")])],1)],1)],1)],1)],1)},Hr=[],zr=(a("7514"),{components:{BaseSelector:nr,CommonSelector:Br},data:function(){return{isMore:!1,conditionList:{},pagination:{currentPage:1,pageSize:15},filter:this.getDefaultFilter(),efficientFilter:this.getDefaultFilter(),table:{props:{},data:[],header:[{prop:"coocaaVId",label:"ID",fixed:!0,width:"220"},{prop:"title",label:"课程名称",fixed:!0,width:"220"},{prop:"description",label:"课程简介",width:"250",showOverflowTooltip:!0},{prop:"sourceName",label:"内容提供商",width:"150"},{prop:"videoKey",label:"自定义标签",width:"150"},{prop:"classfication",label:"第三方标签",width:"150"},{prop:"thumb",label:"图片",width:"120",render:function(e,t){var a=t.row;return e("img",{attrs:{src:a.thumb,width:"50px",height:"50px",class:"imgs"}})}},{prop:"publistSegment",label:"课程集数",width:"120"}],selectionType:"single"}}},computed:{selected:function(){return this.$refs.baseSelector.selected.slice()},contentProviderEnums:function(){return(this.conditionList.contentProviders||[]).map(function(e){var t=e.tagCnName;return{label:t,value:t}})},teachTypeEnums:function(){var e=this.conditionList.sources;return e?e[0].child.map(function(e){var t=e.categoryName;return{label:t,value:t}}):[]},gradeEnums:function(){var e=this.conditionList.gradeList,t=this.filter.teachTypes,a={"幼儿":[0,2],"小学":[2,8],"初中":[8,11],"高中":[11,14]},i=a[t];if(i&&e){var n=e.map(function(e){var t=e.tagCnName;return{label:t,value:t}});return n.slice(i[0],i[1])}return[]},videoTypeEnums:function(){var e=this.filter.teachTypes;return e?(this.conditionList.sources[0].child.find(function(t){var a=t.categoryName;return a===e}).child[0].tagEntities||[]).map(function(e){var t=e.tagName;return{label:t,value:t}}):[]},payTypeEnums:function(){return(this.conditionList.payTypes||[]).map(function(e){var t=e.tagCnName,a=e.tagEnName;return{label:t,value:a}})},contentTagEnums:function(){return(this.conditionList.contentTag||[]).map(function(e){var t=e.tagCnName;return{label:t,value:t}})},courseVersionEnums:function(){return(this.conditionList.courseVersion||[]).map(function(e){var t=e.tagCnName;return{label:t,value:t}})},segmentTagEnums:function(){return(this.conditionList.segmentTag||[]).map(function(e){var t=e.tagCnName,a=e.tagEnName;return{label:t,value:a}})}},props:["isLive","selectionType"],methods:{handleCollapseChange:function(){setTimeout(function(){window.dispatchEvent(new Event("resize"))},1e3)},getDefaultFilter:function(){return{resType:"vod",callbackparam:"result",contentProviders:void 0,teachTypes:void 0,gradeList:void 0,videoTypes:void 0,payTypes:void 0,contentTag:void 0,orderBy:void 0,order:"desc",title:void 0,courseVersion:void 0,segmentTag:void 0,updateStatus:void 0,synDate:void 0,cartoonStar:void 0,areas:"",yearStart:void 0,yearEnd:void 0,businessType:1}},getFilter:function(){var e=this.pagination,t=this.efficientFilter,a=Object.keys(t).reduce(function(e,a){return""!==t[a]&&(e[a]=t[a]),e},{});return e&&(a.page=e.currentPage,a.rows=e.pageSize),a},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.efficientFilter=this.getDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=this.getFilter();this.$service.getMediaVideoInfos(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},handleTeachTypesChange:function(e){this.filter.gradeList=void 0,this.filter.videoTypes=void 0,this.filter.teachTypes=e},yearStartListen:function(){this.filter.yearStart&&!+this.filter.yearStart&&(this.$message("年代必须为数字"),this.filter.yearStart=null)},yearEndListen:function(){this.filter.yearEnd&&!+this.filter.yearEnd&&(this.$message("年代必须为数字"),this.filter.yearEnd=null)},changeSort:function(){"asc"===this.filter.order?this.filter.order="desc":this.filter.order="asc"}},created:function(){var e=this,t={type:"vod",businessType:1};this.$service.mediaGetCondition(t).then(function(t){e.conditionList=t.vod})}}),Jr=zr,Kr=Object(Bn["a"])(Jr,qr,Hr,!1,null,"7908d2ef",null),Qr=Kr.exports,Xr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"coocaaVId","is-live":e.isLive,"selection-type":e.selectionType,table:e.table,pagination:e.pagination},on:{"pagination-change":e.fetchData,"filter-reset":e.handleFilterReset,"select-cancel":function(t){return e.$emit("select-cancel")},"select-end":e.selectEnd}},[a("el-collapse",{attrs:{slot:"filter",value:"1"},on:{change:e.handleCollapseChange},slot:"filter"},[a("el-collapse-item",{attrs:{title:"查询条件",name:"1"}},[a("el-form",{staticClass:"search-form-inline",attrs:{inline:!0,model:e.filter,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"渠道"}},[a("CommonSelector",{attrs:{disabled:e.disablePartner,options:e.$consts.partnerOptions},model:{value:e.filter.partner,callback:function(t){e.$set(e.filter,"partner",t)},expression:"filter.partner"}})],1),a("el-form-item",{attrs:{label:"内容源"}},[a("CommonSelector",{attrs:{options:e.sourceEnums},model:{value:e.filter.sources,callback:function(t){e.$set(e.filter,"sources",t)},expression:"filter.sources"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"tencent"===e.filter.sources,expression:"filter.sources === 'tencent'"}],attrs:{label:"牌照"}},[a("CommonSelector",{attrs:{options:e.licenseEnums,clearable:""},model:{value:e.filter.licensee,callback:function(t){e.$set(e.filter,"licensee",t)},expression:"filter.licensee"}})],1),a("el-form-item",{attrs:{label:"频道类型"}},[a("CommonSelector",{attrs:{options:e.categoryEnums},model:{value:e.filter.category,callback:function(t){e.$set(e.filter,"category",t)},expression:"filter.category"}})],1),a("el-form-item",{attrs:{label:"影片类型"}},[a("CommonSelector",{attrs:{options:e.videoTypeEnums},model:{value:e.filter.videoTypes,callback:function(t){e.$set(e.filter,"videoTypes",t)},expression:"filter.videoTypes"}})],1),a("el-form-item",{attrs:{label:"付费类型"}},[a("CommonSelector",{attrs:{options:e.payTypeEnums},model:{value:e.filter.payTypes,callback:function(t){e.$set(e.filter,"payTypes",t)},expression:"filter.payTypes"}})],1),a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{model:{value:e.filter.title,callback:function(t){e.$set(e.filter,"title",t)},expression:"filter.title"}})],1),a("el-form-item",{attrs:{label:"素材类型"}},[a("CommonSelector",{attrs:{options:e.contentTypeEnums},model:{value:e.filter.contentTypes,callback:function(t){e.$set(e.filter,"contentTypes",t)},expression:"filter.contentTypes"}})],1),a("el-form-item",{attrs:{label:"年代"}},[a("el-input",{staticStyle:{width:"80px"},attrs:{size:"small"},on:{blur:e.yearStartListen},model:{value:e.filter.yearStart,callback:function(t){e.$set(e.filter,"yearStart",t)},expression:"filter.yearStart"}}),e._v("\n          -\n          "),a("el-input",{staticStyle:{width:"80px"},attrs:{size:"small"},on:{blur:e.yearEndListen},model:{value:e.filter.yearEnd,callback:function(t){e.$set(e.filter,"yearEnd",t)},expression:"filter.yearEnd"}})],1),a("span",{directives:[{name:"show",rawName:"v-show",value:e.isMore,expression:"isMore"}]},[a("el-form-item",{attrs:{label:"影片格式"}},[a("CommonSelector",{attrs:{options:e.videoFormatEnums},model:{value:e.filter.videoFormat,callback:function(t){e.$set(e.filter,"videoFormat",t)},expression:"filter.videoFormat"}})],1),a("el-form-item",{attrs:{label:"内容标签"}},[a("CommonSelector",{attrs:{options:e.contentTagEnums},model:{value:e.filter.contentTag,callback:function(t){e.$set(e.filter,"contentTag",t)},expression:"filter.contentTag"}})],1),a("el-form-item",{attrs:{label:"排序方式"}},[a("el-select",{staticStyle:{width:"120px"},attrs:{size:"small"},model:{value:e.filter.orderBy,callback:function(t){e.$set(e.filter,"orderBy",t)},expression:"filter.orderBy"}},[a("el-option",{attrs:{label:"请选择",value:""}}),e._l(e.conditionList.orderBy,function(e){return a("el-option",{key:"order"+e.tagId,attrs:{label:e.tagCnName,value:e.tagEnName}})})],2),a("el-tooltip",{attrs:{content:"asc"===e.filter.order?"升序":"降序"}},[a("el-button",{attrs:{icon:"asc"===e.filter.order?"el-icon-arrow-up":"el-icon-arrow-down"},on:{click:function(t){return e.changeSort()}}})],1)],1),a("el-form-item",{attrs:{label:"导演"}},[a("CommonSelector",{attrs:{placeholder:"请选择/输入",filterable:"","allow-create":"",options:e.directorEnums},model:{value:e.filter.directors,callback:function(t){e.$set(e.filter,"directors",t)},expression:"filter.directors"}})],1),a("el-form-item",{attrs:{label:"主演"}},[a("CommonSelector",{attrs:{placeholder:"请选择/输入",filterable:"","allow-create":"",options:e.actiorEnums},model:{value:e.filter.actors,callback:function(t){e.$set(e.filter,"actors",t)},expression:"filter.actors"}})],1),a("el-form-item",{attrs:{label:"地区"}},[a("CommonSelector",{attrs:{placeholder:"请选择/输入",filterable:"","allow-create":"",options:e.areaEnums},model:{value:e.filter.areas,callback:function(t){e.$set(e.filter,"areas",t)},expression:"filter.areas"}})],1),a("el-form-item",{staticStyle:{display:"block"},attrs:{label:"影片标签"}},[a("TagLogicFilter",{ref:"tagLogicFilter",model:{value:e.filter.tagCodes,callback:function(t){e.$set(e.filter,"tagCodes",t)},expression:"filter.tagCodes"}})],1)],1),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{icon:e.isMore?"el-icon-arrow-up":"el-icon-arrow-down",size:"small"},on:{click:function(t){e.isMore=!e.isMore}}},[e._v(e._s(e.isMore?"收起":"展开"))]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{attrs:{size:"small",type:"warning"},on:{click:e.handleFilterReset}},[e._v("重置")])],1)],1)],1)],1),a("EpisodeSelector",{ref:"episodeSelector",attrs:{id:e.currentVideoId,source:e.filter.partner},on:{"select-end":e.handleSelectEpisodeEnd}},[a("span")])],1)},Yr=[],Zr=(a("20d6"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("remote-selector-wrapper",{ref:"wrapper",attrs:{title:"选择单集"},on:{"select-start":e.handleSelectStart}},[a("BaseSelector",{ref:"baseSelector",attrs:{slot:"content","id-field":"coocaaVId","selection-type":e.selectionType,table:e.table,pagination:e.pagination},on:{"pagination-change":e.fetchData,"filter-reset":e.handleFilterReset,"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd},slot:"content"},[a("el-form",{attrs:{slot:"filter",inline:!0,"label-width":"72px"},slot:"filter",model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("el-form-item",{attrs:{label:"素材类型"}},[a("el-select",{model:{value:e.filter.urlIsTrailer,callback:function(t){e.$set(e.filter,"urlIsTrailer",t)},expression:"filter.urlIsTrailer"}},e._l(e.episodeTypeEnums,function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"单集名称"}},[a("el-input",{model:{value:e.filter.urlTitle,callback:function(t){e.$set(e.filter,"urlTitle",t)},expression:"filter.urlTitle"}})],1),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{attrs:{size:"small",type:"warning"},on:{click:e.handleFilterReset}},[e._v("重置")])],1)],1),e._t("default")],2)}),el=[],tl=[{label:"正片",value:"0"},{label:"非正片",value:"1"}],al={components:{BaseSelector:nr,RemoteSelectorWrapper:Qo},data:function(){return{pagination:{currentPage:1,pageSize:15},filter:this.getDefaultFilter(),efficientFilter:this.getDefaultFilter(),episodeTypeEnums:tl,table:{props:{},header:[{label:"集数名",prop:"urlCollection",width:"70"},{label:"单集ID",prop:"coocaaMId",width:"150"},{label:"单集名称",prop:"urlTitle"},{label:"图片",prop:"thumb",render:function(e,t){var a=t.row;return e("img",{attrs:{src:a.thumb,width:"50px",height:"50px",class:"imgs"}})}},{label:"素材类型",width:"120",prop:"urlIsTrailer",render:function(e,t){var a=t.row;return"1"===a.urlIsTrailer?"非正片":"正片"}}],data:[],selected:[],selectionType:"single"},selected:[]}},props:["selectionType","source","id"],watch:{id:"handleFilterReset"},methods:{handleSelectStart:function(){var e=this.$refs.baseSelector;e&&e.clearSelected(),this.handleFilterReset()},handleSelectCancel:function(){this.$refs.wrapper.handleSelectCancel()},getDefaultFilter:function(){return{urlIsTrailer:void 0,urlTitle:void 0,source:this.source,id:this.id}},getFilter:function(){var e=this.pagination,t=Object(j["a"])({},this.efficientFilter);return e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.efficientFilter=this.getDefaultFilter(),this.pagination.currentPage=1,this.table.data=[],this.fetchData()},fetchData:function(){var e=this,t=this.getFilter();this.$service.getSegmentList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows||[]})},handleSelectEnd:function(){this.$refs.wrapper.handleSelectEnd(),this.$emit.apply(this,["select-end"].concat(Array.prototype.slice.call(arguments)))}},created:function(){}},il=al,nl=Object(Bn["a"])(il,Zr,el,!1,null,"9dd64fe0",null),ol=nl.exports,rl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"cc-tag-logic-filter"},[a("div",{staticClass:"tag-list"},e._l(e.tags,function(t,i){return a("div",{key:i},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleAddTagStart(i)}}},[e._v("\n        +选择标签\n      ")]),e._l(t,function(t,n){return a("el-tag",{key:t.tagCode,attrs:{type:"primary",closable:!0},on:{close:function(t){return e.handleRemoveTag(i,n)}}},[e._v("\n        "+e._s(t.tagCnName)+"\n      ")])})],2)}),0),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleAddTagStart(e.tags.length)}}},[e._v("+且")]),e.showPanelTagsDialog?a("PanelTagSelector",{on:{"select-end":e.handleAddTagEnd,"select-cancel":e.handleAddTagCancel}}):e._e()],1)},ll=[],sl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"cc-media-tags-selector",attrs:{title:"选择标签",fullscreen:!0,"show-close":!1,modal:!1,"modal-append-to-body":!0,visible:!0}},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSelectEnd}},[e._v("\n    确定\n  ")]),a("el-button",{attrs:{type:"warning"},on:{click:e.handleSelectCancel}},[e._v("\n    关闭\n  ")]),a("div",{staticStyle:{"margin-top":"10px"}},[e._v("\n      已选择:\n      "),e._l(e.selectedTags,function(t){return a("el-tag",{key:t.tagCode,attrs:{closable:!0},on:{close:function(a){return e.handleRemoveTag(t)}}},[e._v("\n          "+e._s(t.tagCnName)+"\n      ")])})],2),a("MediaTagSelector",{ref:"mediaTag",on:{"get-tag-nodes":e.handleInputTags}})],1)},cl=[],ul=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",e._l(e.levels,function(t,i){return a("div",{key:t.parentId,staticClass:"tree-level"},[e.tags[t.parentId]&&e.tags[t.parentId].length>0?[a("div",[e._v("第 "+e._s(e.toChineseNumber(i+1))+" 层")]),a("div",e._l(e.tags[t.parentId],function(n){return a("span",{key:n.tagCode,class:{"tree-node":!0,"tree-leaf":0!=n.nodeType,active:t.activeId===n.tagCode,checked:e.selectedIndex[n.tagCode]},on:{click:function(t){return e.handleSelectTag(n,i)}}},[e._v("\n        "+e._s(n.tagCnName)+"\n        "),0!=n.nodeType?a("el-checkbox",{staticClass:"tree-node__checkbox",attrs:{value:!!e.selectedIndex[n.tagCode]},on:{input:function(t){return e.handleSelectTag(n,i)}}}):e._e()],1)}),0)]:e._e()],2)}),0)},dl=[],pl=(a("28a5"),{data:function(){return{selected:[],selectedIndex:{},levels:[{parentId:"-1",activeId:void 0}],tags:{},cache:{}}},methods:{getTagsByParentCode:function(e){var t=this;if(this.cache[e])return this.cache[e];this.$service.mediaGetTagList({parentCode:e,page:1,rows:1e6}).then(function(a){t.cache[e]=a.rows,t.$set(t.tags,e,a.rows)})},handleSelectTag:function(e,t){var a=e.tagCode,i=this.levels.slice(0,t+1),n=this.selected,o=this.selectedIndex;i[t].activeId===a?i[t].activeId=void 0:o[a]||(i[t].activeId=a,i.push(this.genLevel(a)),this.getTagsByParentCode(a)),this.levels=i,0!=e.nodeType&&(o[a]?(this.$set(o,a,void 0),this.selected=n.filter(function(t){return t!==e})):(this.$set(o,a,e),this.selected.push(e)),this.$emit("get-tag-nodes",this.selected))},handleRemoveTag:function(e){this.selected=this.selected.filter(function(t){return t!=e}),this.selectedIndex[e.tagCode]=void 0,this.$emit("get-tag-nodes",this.selected)},genLevel:function(e,t){return{parentId:e,activeId:t}},toChineseNumber:function(e){var t=["零","一","二","三","四","五","六","七","八","九"],a=["","十","百","千","万"],i=0,n=e.toString().split("").reduceRight(function(e,n,o){n=+n;var r=a[i++],l=t[n];return l+(n>0?r:"")+e},"");return n.replace(/零+/,"零").replace(/.+零$/,"")}},created:function(){this.getTagsByParentCode("-1")}}),hl=pl,ml=(a("3b79"),Object(Bn["a"])(hl,ul,dl,!1,null,"1fd30004",null)),fl=ml.exports,gl={components:{MediaTagSelector:fl},data:function(){return{selectedTags:[],removingTags:[]}},methods:{handleSelectEnd:function(){if(0===this.selectedTags.length)return this.$message({type:"error",message:"请选择至少一个标签"});this.$emit("select-end",this.selectedTags.slice())},handleSelectCancel:function(){this.$emit("select-cancel")},handleRemoveTag:function(e){var t=this.selectedTags.findIndex(function(t){return t.tagCode===e.tagCode});t>-1&&this.selectedTags.splice(t,1),this.$refs.mediaTag.handleRemoveTag(e)},handleInputTags:function(e){this.selectedTags=e}}},bl=gl,vl=(a("95be"),Object(Bn["a"])(bl,sl,cl,!1,null,"64ea5096",null)),yl=vl.exports,wl={components:{PanelTagSelector:yl},data:function(){return{showPanelTagsDialog:!1,activeTagListIndex:void 0,tags:[[]]}},props:["value"],methods:{reset:function(){this.tags=[[]]},emitInput:function(){var e=this.tags.reduce(function(e,t){return t.length>0&&e.push(t.map(function(e){return e.tagCode}).join(",")),e},[]);this.$emit("input",e)},handleRemoveTag:function(e,t){var a=this.tags[e];a.splice(t,1),0===a.length&&this.tags.splice(e,1),this.emitInput()},handleAddTagStart:function(e){this.activeTagListIndex=e,this.showPanelTagsDialog=!0},handleAddTagCancel:function(){this.showPanelTagsDialog=!1},handleAddTagEnd:function(e){var t=this.activeTagListIndex,a=this.tags[t];a?this.$set(this.tags,t,a.concat(e)):this.$set(this.tags,t,e),this.emitInput(),this.showPanelTagsDialog=!1}},created:function(){}},Il=wl,Cl=(a("ed36"),Object(Bn["a"])(Il,rl,ll,!1,null,"58301b20",null)),Tl=Cl.exports,Sl={components:{BaseSelector:nr,CommonSelector:Br,EpisodeSelector:ol,TagLogicFilter:Tl},data:function(){var e=this;return{isMore:!1,currentVideoId:void 0,conditionList:{},sourceEnums:[],pagination:{currentPage:1,pageSize:15},filter:this.getDefaultFilter(),efficientFilter:this.getDefaultFilter(),table:{props:{},header:[{prop:"coocaaVId",label:"ID",width:"130",sortable:!0},{prop:"title",label:"标题",width:"100"},{prop:"subTitle",label:"副标题",width:"100"},{prop:"ccVideoSourceEntities",label:"内容源",width:"60",render:function(t,a){var i=a.row;return t("div",e.getSourceLabel(i))}},{prop:"videoStatus",label:"状态",width:"50",formatter:function(e){return["失效","有效","待审核","审核不通过","草稿"][e.videoStatus]}},{prop:"thumb",label:"图片",width:"60",render:function(e,t){var a=t.row;return e("img",{attrs:{src:a.thumb,width:"50px",height:"50px",referrerpolicy:"no-referrer"}})}},{prop:"videoType",label:"影片类型",width:"80"},{prop:"contentType",label:"内容类型",width:"80"},{prop:"season",label:"期数"},{prop:"directors",label:"导演"},{prop:"actors",label:"演员",showOverflowTooltip:!0},{prop:"publishArea",label:"地区"},{prop:"year",label:"年代"},{prop:"segment",label:"已选集数",type:"specialBut",width:"100",mouseStyle:"hover",fixed:"right",render:function(t,a){var i=a.row,n=i.coocaaVId,o=e.selectedEpisodes;if(o[n])return t("el-button",{attrs:{type:"primary",text:"已选集数",value:"已选集数",title:o[n].urlTitle}},"已选集数")}},{prop:"but",label:"操作",width:"100",fixed:"right",render:function(t,a){var i=a.row;return t("el-button",{on:{click:function(t){t.stopPropagation(),e.handleSelectEpisode(i)}}},"选择单集")}}],data:[],selected:[],selectionType:"single"},selectedEpisodes:{}}},computed:{selected:function(){return this.$refs.baseSelector.selected.slice()},licenseEnums:function(){return(this.conditionList.licensee||[]).map(function(e){var t=e.tagCnName,a=e.tagEnName;return{label:t,value:a}})},categoryEnums:function(){var e=(this.conditionList.sources||[{}])[0].child;return(e||[]).map(function(e){var t=e.categoryName,a=e.categoryId;return{label:t,value:a}})},videoTypeEnums:function(){var e=this.filter.category;return e?(this.conditionList.sources[0].child.find(function(t){var a=t.categoryId;return a===e}).child[0].tagEntities||[]).map(function(e){var t=e.tagName;return{label:t,value:t}}):[]},payTypeEnums:function(){return(this.conditionList.payTypes||[]).map(function(e){var t=e.tagCnName,a=e.tagEnName;return{label:t,value:a}})},contentTypeEnums:function(){return(this.conditionList.contentTypes||[]).map(function(e){var t=e.contentType,a=e.contentTypeId;return{label:t,value:a}})},videoFormatEnums:function(){return(this.conditionList.videoFormat||[]).map(function(e){var t=e.tagCnName,a=e.tagEnName;return{label:t,value:a}})},contentTagEnums:function(){return(this.conditionList.contentTag||[]).map(function(e){var t=e.tagCnName;return{label:t,value:t}})},directorEnums:function(){return(this.conditionList.directors||[]).map(function(e){var t=e.tagCnName;return{label:t,value:t}})},actiorEnums:function(){return(this.conditionList.actors||[]).map(function(e){var t=e.tagCnName;return{label:t,value:t}})},areaEnums:function(){return(this.conditionList.areas||[]).map(function(e){var t=e.tagCnName;return{label:t,value:t}})}},props:["isLive","disablePartner","selection-type","source"],watch:{"filter.partner":"onPartnerChange","filter.sources":"onSourceChange","filter.category":"onCategoryChange"},methods:{selectEnd:function(e){var t=this;e=e.map(function(e){return e.selectedEpisodes=t.selectedEpisodes[e.coocaaVId],e}),this.$emit("select-end",e)},handleCollapseChange:function(){setTimeout(function(){window.dispatchEvent(new Event("resize"))},1e3)},handleSelectEpisode:function(e){this.currentVideoId=e.coocaaVId,this.$refs.episodeSelector.$refs.wrapper.handleSelectStart()},handleSelectEpisodeEnd:function(e){var t=this.currentVideoId;this.$set(this.selectedEpisodes,t,e[0]);var a=this.table.data,i=a.findIndex(function(e){return e.coocaaVId===t}),n=a[i],o=this.$refs.baseSelector;"single"===this.selectionType?o.selected!==i&&o.handleTableRowSelectionChange(n,i):"multiple"===this.selectionType&&-1===o.selected.indexOf(i)&&o.handleTableRowSelectionAdd(n,i)},onPartnerChange:function(){var e=this,t=this.filter.partner;this.sourceEnums=[],t&&this.$service.getPartnerSource({partnerName:t}).then(function(a){var i=a.rows.reduce(function(e,t){return t.source_List&&(e=e.concat(t.source_List.map(function(e){var t=e.source_code,a=e.source_title;return{label:a,value:t}}))),e},[]),n=i.find(function(e){return e.value===t})||i[0];n&&(e.filter.sources=n.value),e.sourceEnums=i})},onSourceChange:function(e){"tencent"!==e&&(this.filter.licensee=void 0)},onCategoryChange:function(){this.filter.videoTypes=void 0},getSourceLabel:function(e){for(var t=!1,a=0;a<e.ccVideoSourceEntities.length;a++)if("4KGarden"===e.ccVideoSourceEntities[a].thirdSource){t=!0;break}return!0===t?"4k花园":e.ccVideoSourceEntities[0]&&"tencent"===e.ccVideoSourceEntities[0].thirdSource?"腾讯":e.ccVideoSourceEntities[0]&&"yinhe"===e.ccVideoSourceEntities[0].thirdSource?"爱奇艺":void 0},statusLabel:function(e){return["失效","有效","待审核","审核不通过","草稿"][e.videoStatus]},getDefaultFilter:function(){return{resType:"vod",callbackparam:"result",partner:this.$consts.sourceToPartner[this.source||this.$consts.sourceOptions[0].value],sources:"",category:"",videoTypes:"",licensee:"",payTypes:"",provider:"",title:"",contentTypes:"",yearStart:void 0,yearEnd:void 0,videoFormat:"",contentTag:"",orderBy:"",order:"desc",directors:"",actors:"",areas:"",tagCodes:[[]]}},getFilter:function(){var e=this.pagination,t=this.efficientFilter,a=Object.keys(t).reduce(function(e,a){return""!==t[a]&&(e[a]=t[a]),e},{});return a.partner=void 0,e&&(a.page=e.currentPage,a.rows=e.pageSize),a},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.efficientFilter=this.getDefaultFilter(),this.$refs.tagLogicFilter.reset(),this.onPartnerChange(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=this.getFilter();this.$service.getMediaVideoInfos(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},handleTeachTypesChange:function(e){this.filter.gradeList=void 0,this.filter.videoTypes=void 0,this.filter.teachTypes=e},yearStartListen:function(){this.filter.yearStart&&!+this.filter.yearStart&&(this.$message("年代必须为数字"),this.filter.yearStart=null)},yearEndListen:function(){this.filter.yearEnd&&!+this.filter.yearEnd&&(this.$message("年代必须为数字"),this.filter.yearEnd=null)},changeSort:function(){"asc"===this.filter.order?this.filter.order="desc":this.filter.order="asc"}},created:function(){var e=this;this.$service.mediaGetCondition().then(function(t){e.conditionList=t.vod}),this.onPartnerChange()}},kl=Sl,_l=(a("b637"),Object(Bn["a"])(kl,Xr,Yr,!1,null,"719e1247",null)),Pl=_l.exports,xl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"pluginId","is-live":e.isLive,"selection-type":e.selectionType,table:e.table,pagination:e.pagination,filter:e.filter,"filter-schema":e.filterSchema},on:{"pagination-change":e.fetchData,"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset,"select-cancel":function(t){return e.$emit("select-cancel")},"select-end":function(t){return e.$emit("select-end")}}})},Dl=[],Fl={"":"0",o_tencent:"1",o_iqiyi:"2",o_youku:"3"},$l={components:{BaseSelector:nr},data:function(){return{pagination:{currentPage:1,pageSize:15},filter:this.getDefaultFilter(),filterSchema:null,table:{props:{},header:[{prop:"pluginId",label:"功能ID",width:"80"},{prop:"pluginName",label:"功能名称"},{prop:"source",label:"内容源",width:"120",options:[],render:function(e,t){var a=t.row,i="";switch(a.source){case 0:i="无";break;case 1:i="腾讯";break;case 2:i="爱奇艺";break;case 3:i="优酷";break;default:i="Error: 没有对应的处理!!";break}return i}},{prop:"globalPicture.pictureId",label:"通用内容图片",render:function(e,t){var a=t.row,i=a.globalPicture,n=i&&i.pictureUrl;if(n)return e("img",{style:{"max-height":"64px","max-width":"120px"},attrs:{src:n,referrerpolicy:"no-referrer"}})}},{prop:"createdDate",label:"创建时间"},{prop:"modifierName",label:"更新人"}],data:[]}}},props:["isLive","selectionType","source"],computed:{selected:function(){return this.$refs.baseSelector.selected.slice()}},methods:{getDefaultFilter:function(){return{pluginId:void 0,pluginName:void 0,source:Fl[this.source]}},getFilter:function(){var e=this.pagination,t=Object.assign({},this.filter);return t.code=t.id,e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(e){this.filter=e,this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=this.getFilter();this.$service.getMultiBlockList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=this.source,t=this.$consts.sourceOptionsWithEmpty;e&&(t=t.filter(function(t){return t.value===e||""===t.value}));var a=t.reduce(function(e,t){return e[t.label]=Fl[t.value],e},{}),i=co.a.map({pluginId:co.a.o.oneOf([co.a.value(""),co.a.number]).$msg("请输入数字").other("form",{component:"Input",placeholder:"功能ID",label:" "}),pluginName:co.a.o.string.other("form",{placeholder:"功能名称",label:" "}),source:co.a.o.enum(a).other("form",{component:"Select",placeholder:"内容源",label:" "})}).other("form",{cols:{item:3,label:1,wrapper:23},layout:"inline",footer:{cols:{item:3,label:1,wrapper:23},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=i}},Ll=$l,Rl=Object(Bn["a"])(Ll,xl,Dl,!1,null,"7716bec6",null),Nl=Rl.exports,El=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"id","is-live":e.isLive,"selection-type":e.selectionType,table:e.table,pagination:e.pagination,filter:e.filter,"filter-schema":e.filterSchema},on:{"pagination-change":e.fetchData,"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset,"select-cancel":function(t){return e.$emit("select-cancel")},"select-end":function(t){return e.$emit("select-end")}}})},Ol=[],Al={components:{BaseSelector:nr},data:function(){return{pagination:{currentPage:1,pageSize:15},filter:this.getDefaultFilter(),filterSchema:null,table:{props:{},header:[{label:"轮播入口ID",prop:"id",sortable:!0},{label:"轮播入口名称",prop:"title"}],data:[]}}},props:["isLive","selectionType"],computed:{selected:function(){return this.$refs.baseSelector.selected.slice()}},methods:{getDefaultFilter:function(){return{id:void 0,title:void 0,resType:"operation",dataType:"rotate",levelType:"rotateSta",callback:"result"}},getFilter:function(){var e=this.pagination,t=Object.assign({},this.filter);return t.code=t.id,e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(e){this.filter=e,this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=this.getFilter();this.$service.getMediaVideoInfos(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows||[]})}},created:function(){var e=co.a.map({id:co.a.o.number.other("form",{component:"Input",placeholder:"轮播入口ID",label:" "}),title:co.a.o.string.other("form",{component:"Input",placeholder:"轮播入口名称",label:" "})}).other("form",{cols:{item:3,label:1,wrapper:23},layout:"inline",footer:{cols:{item:3,label:1,wrapper:23},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e}},Vl=Al,Ml=Object(Bn["a"])(Vl,El,Ol,!1,null,"8b8e9724",null),Bl=Ml.exports,Ul=[{label:"影视中心",value:"video"},{label:"应用圈",value:"app"},{label:"教育中心",value:"edu"},{label:"PPTV资源",value:"pptv"},{label:"直播资源",value:"live"},{label:"专题资源",value:"topic"},{label:"轮播频道",value:"rotate"},{label:"多功能推荐位",value:"func"},{label:"轮播推荐位",value:"broadcast"}],jl={components:{RemoteSelectorWrapper:Qo,TopicSelector:sr,AppSelector:mr,BroadcastSelector:wr,LiveSelector:Lr,"pptv-selector":Wr,EduSelector:Qr,VideoSelector:Pl,FuncSelector:Nl,RotateSelector:Bl},data:function(){return{showDialog:!1,activeSelector:void 0,SELECTORS:Ul}},props:{source:String,disablePartner:Boolean,selectors:{type:Array,default:function(){return Ul.map(function(e){return e.value})}},isLive:Boolean,selectionType:{type:String,default:function(){return"single"}}},methods:{handleSelectStart:function(){this.handleActivateSelector(this.selectors[0])},handleActivateSelector:function(e){var t=this;this.activeSelector=e,this.$nextTick(function(){t.$refs[e+"-selector"].$refs.baseSelector.setTableHeight()})},handleSelectEnd:function(){var e=this.selectionType,t=this.activeSelector,a=this.$refs;a.wrapper.handleSelectEnd();var i=this.selectors.reduce(function(i,n){var o=a[n+"-selector"];return"multiple"===e||"single"===e&&n===t?(i[n]=o.selected,"video"===n&&(i.episode=Object(j["a"])({},o.selectedEpisodes))):(i[n]={},"video"===n&&(i.episode={})),i},{});a["video-selector"]&&Object.defineProperty(i,"videoSource",{value:a["video-selector"].filter.partner,enumerable:!1}),this.$emit("select-end",i)},handleSelectCancel:function(){this.$refs.wrapper.handleSelectCancel()},clearSelected:function(){var e=this;this.selectors.forEach(function(t){var a=e.$refs,i=a[t+"-selector"];i&&i.$refs.baseSelector.clearSelected()})}},mounted:function(){}},Gl=jl,Wl=(a("8c9b"),Object(Bn["a"])(Gl,Go,Wo,!1,null,"200e31b5",null)),ql=Wl.exports,Hl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("CardList",{attrs:{data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-change":e.handleRowSelectionChange},scopedSlots:e._u([{key:"row",fn:function(t){var i=t.row;return a("div",{staticClass:"box-list"},[a("p",{staticClass:"list-p"},[a("img",{staticClass:"list-img",attrs:{src:i.pictureUrl,alt:""}})]),a("p",{staticClass:"list-title"},[e._v(e._s(i.pictureName))]),a("p",{staticStyle:{margin:"0"}},[1==i.pictureStatus?a("span",[e._v("审核通过")]):a("span",[e._v("待审核")]),a("span",[e._v(e._s(i.pictureResolution))])])])}}])})],1)],1)},zl=[],Jl={components:{Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"],CardList:Dn["CardList"]},props:{title:String,pictureResolution:{type:String,default:""}},data:function(){return{materialTypes:{},pictureStatus:{"审核通过":1,"待审核":2},picDialogVisible:!1,auditDialogVisible:!1,reviewPicUrl:null,filter:{sort:void 0,order:void 0},filterSchema:null,pagination:{pageSize:5},selected:[],table:{props:{},data:[],selected:void 0,selectionType:"single"}}},methods:{handleRowSelectionChange:function(e,t){this.table.selected=t,this.$emit("input",e),"single"===this.table.selectionType&&this.$emit("close-dialog","savePicture")},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.pictureId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this;this.table.selected=void 0;var t=this.parseFilter();t.pictureResolution=this.pictureResolution,this.$service.getResourceList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows,console.log(t)})},getMaterialTypes:function(){var e=this;return this.$service.getMaterialTypes().then(function(t){t.forEach(function(t){e.materialTypes[t.dictCnName]=t.dictId})})}},created:function(){var e=this,t=co.a.map({pictureId:co.a.o.string.other("form",{component:"Input",placeholder:"ID"}),pictureName:co.a.o.string.other("form",{component:"Input",placeholder:"素材名称"}),pictureCategory:co.a.o.enum(this.materialTypes).other("form",{component:"Select",placeholder:"素材类别"}),pictureStatus:co.a.o.enum(this.pictureStatus).other("form",{component:"Select",placeholder:"审核状态"})}).other("form",{cols:{item:5,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.getMaterialTypes().then(function(){e.filterSchema=t}),this.fetchData()}},Kl=Jl,Ql=(a("d62f"),Object(Bn["a"])(Kl,Hl,zl,!1,null,"cbf7ed86",null)),Xl=Ql.exports,Yl=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("CardList",{attrs:{data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-change":e.handleRowSelectionChange},scopedSlots:e._u([{key:"row",fn:function(t){var i=t.row;return a("div",{staticClass:"box-list"},[a("p",{staticClass:"list-p"},[a("img",{staticClass:"list-img",attrs:{src:i.imgUrl,alt:""}})]),a("p",{staticClass:"list-title"},[e._v(e._s(i.cornerIconName))]),a("p",{staticStyle:{margin:"0"}},[1==i.cornerStatus?a("span",[e._v("审核通过")]):a("span",[e._v("待审核")])])])}}])})],1)],1)},Zl=[],es=(a("c5f6"),{components:{Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"],CardList:Dn["CardList"]},props:{title:String,typePosition:Number,cornerIconTypeOptions:Object,visible:!1},watch:{visible:function(e){e&&this.fetchData()}},data:function(){return{pictureStatus:{"审核通过":1,"待审核":2},cornerIconType:{typePosition:this.typePosition,typeId:""},picDialogVisible:!1,auditDialogVisible:!1,reviewPicUrl:null,filter:{sort:void 0,order:void 0},filterSchema:null,pagination:{currentPage:1,pageSize:10},selected:[],table:{props:{},data:[],selected:void 0,selectionType:"single"}}},methods:{handleRowSelectionChange:function(e,t){this.table.selected=t,this.$emit("input",e),"single"===this.table.selectionType&&this.$emit("close-dialog","savePicture")},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.cornerIconId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={page:1,rows:10},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),this.cornerIconType.typeId=e.cornerIconType,this.cornerIconType.typePosition=this.typePosition,e.cornerIconType=void 0,e["typeId"]=this.cornerIconType.typeId,e["typePosition"]=this.cornerIconType.typePosition,e},fetchData:function(){var e=this;this.table.selected=void 0;var t=this.parseFilter();this.$service.getCornerList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows,console.log(t)})}},created:function(){var e=co.a.map({cornerIconId:co.a.o.string.other("form",{component:"Input",placeholder:"ID"}),cornerIconName:co.a.o.string.other("form",{component:"Input",placeholder:"角标名称"}),cornerIconType:co.a.o.enum(this.cornerIconTypeOptions).other("form",{component:"Select",placeholder:"角标类别"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.fetchData(),this.filterSchema=e}}),ts=es,as=(a("5a1f"),Object(Bn["a"])(ts,Yl,Zl,!1,null,"54118f22",null)),is=as.exports,ns=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType},on:{"row-click":e.rowClick,"row-selection-change":e.rowClick}})],1)],1)},os=[],rs={},ls=Object(Bn["a"])(rs,ro,lo,!1,null,null,null),ss=(ls.exports,{components:{ActionList:Dn["ActionList"],Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"]},data:function(){return{filter:{sort:void 0,order:void 0},filterSchema:null,pagination:{},selected:void 0,table:{props:{},header:[{label:"ID",prop:"commonOnclickId",width:"70"},{label:"点击事件名称",prop:"onlickName"},{label:"备注",prop:"remark"},{label:"修改人",prop:"modifierName"},{label:"修改时间",prop:"lastUpdateDate",width:"170"}],data:[],selected:[],selectionType:"single"}}},methods:{rowClick:function(e){this.$emit("row-click",e)},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.getClickData(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},handleRowSelectionAdd:function(e){this.selected.push(e.commonOnclickId),this.updateTableSelected()},handleRowSelectionRemove:function(e){this.selected=this.selected.filter(function(t){return t!==e.commonOnclickId}),this.updateTableSelected()},handleAllRowSelectionRemove:function(){this.selected=[],this.table.selected=[]},updateTableSelected:function(){var e=this.table,t=this.selected;e.selected=e.data.reduce(function(e,a,i){return t.indexOf(a.commonOnclickId)>-1&&e.push(i),e},[])},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.commonOnclickId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e}},created:function(){var e=co.a.map({commonOnclickId:co.a.o.string.other("form",{component:"Input",placeholder:"ID  "}),onlickName:co.a.o.string.other("form",{component:"Input",placeholder:"点击事件名称"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}}),cs=ss,us=(a("dce0"),Object(Bn["a"])(cs,ns,os,!1,null,"191dbb52",null)),ds=us.exports,ps=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"common-content"},["read"!==e.mode?["copy"===e.mode?a("div",[a("VersionList",{attrs:{type:"resourceInfo.type",status:e.resourceInfo.status,version:e.resourceInfo.version,"version-list":e.versionList},on:{"select-version":function(t){return e.$emit("select-version",t)}}}),e._t("copy-confirm",[a("div",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$emit("copy",e.$consts.status.draft)}}},[e._v("复制为草稿")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$emit("copy",e.$consts.status.waiting)}}},[e._v("复制并提交审核")])],1)])],2):a("div",[e._t("auditAndDraft",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$emit("submit-audit")}}},[e._v("提交审核")]),a("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.$emit("save-draft")}}},[e._v("保存草稿")])])],2),e.showReleaseTimeSetter?a("ReleaseTimeSetter",{on:{cancel:function(t){e.showReleaseTimeSetter=!1},submit:e.handleSubmitWithReleaseTime}}):e._e(),e._t("default")]:[e.resourceInfo.id&&e.resourceInfo.menuElId?a("content-auth-manager",{attrs:{"resource-id":e.resourceInfo.id,"menu-elid":e.resourceInfo.menuElId,"resource-type":e.resourceInfo.type}}):e._e(),a("div",[e.releaseTime?a("div",{staticClass:"release-info"},[e._v("\n          该版块为定时任务，审核通过后将于 "+e._s(e.releaseTime)+" 上线\n        ")]):e._e(),a("VersionList",{attrs:{type:"resourceInfo.type",status:e.resourceInfo.status,version:e.resourceInfo.version,"version-list":e.versionList},on:{"select-version":function(t){return e.$emit("select-version",t)}}}),e.resourceInfo.id?a("ContentButtonGroup",{attrs:{"resource-info":e.resourceInfo,options:e.buttonGroupOptions},on:{copy:function(t){return e.$emit("replicate")},edit:function(t){return e.$emit("edit")},unaudit:e.handleUnAudit,audit:e.handleAuditStart,shelves:e.handleShelves,delete:e.handleDelete,"cancel-timing":e.handleCancelTiming,"second-audit":e.handleSecondAudit}}):e._e()],1),e._t("default"),a("AuditHistory",{attrs:{data:e.auditHistoryList}}),a("el-dialog",{attrs:{title:"审核",visible:e.showAuditDialog},on:{"update:visible":function(t){e.showAuditDialog=t}}},[a("el-form",{ref:"auditForm",attrs:{model:e.auditForm,"status-icon":"",rules:e.auditFormRule,"label-width":"100"}},[a("el-form-item",{attrs:{label:"审核意见",prop:"auditFlag"}},[a("el-radio",{attrs:{label:"4"},model:{value:e.auditForm.auditFlag,callback:function(t){e.$set(e.auditForm,"auditFlag",t)},expression:"auditForm.auditFlag"}},[e._v("通过")]),a("el-radio",{attrs:{label:"5"},model:{value:e.auditForm.auditFlag,callback:function(t){e.$set(e.auditForm,"auditFlag",t)},expression:"auditForm.auditFlag"}},[e._v("打回")])],1),a("el-form-item",{attrs:{label:"意见说明",prop:"auditDesc"}},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入意见说明"},model:{value:e.auditForm.auditDesc,callback:function(t){e.$set(e.auditForm,"auditDesc",t)},expression:"auditForm.auditDesc"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showAuditDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleAuditEnd}},[e._v("确 定")])],1)],1)]],2)},hs=[],ms=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{staticClass:"version-list",attrs:{inline:!0}},[e.versionList&&e.versionList.length>0?a("el-form-item",{attrs:{label:"版本"}},[a("el-select",{staticClass:"version-selector",attrs:{value:e.version,placeholder:"请选择"},on:{input:e.handleSelectVersion}},e._l(e.versionList,function(e){return a("el-option",{key:e.version,attrs:{label:e.label,value:e.value}})}),1)],1):e._e(),a("el-form-item",[a("div",{staticClass:"status"},[e._v("\n       "+e._s(e.$consts.statusText[e.status])+"\n        ")])])],1)},fs=[],gs={props:["version","status","versionList"],methods:{handleSelectVersion:function(e){this.$emit("select-version",e)}}},bs=gs,vs=(a("a181"),Object(Bn["a"])(bs,ms,fs,!1,null,"792049d6",null)),ys=vs.exports,ws=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.data.length>0?a("div",[e._m(0),a("table",{staticClass:"audit-history-table"},e._l(e.data,function(t,i){return a("tr",{key:i},[a("td",[e._v("\n        "+e._s(t.lastUpdateDate)+"\n      ")]),a("td",[e._v("\n        "+e._s(t.auditor)+"\n      ")]),a("td",[e._v("\n        "+e._s(e.$consts.statusText[t.auditFlag])+"\n      ")]),a("td",[e._v("\n        "+e._s(t.auditDesc)+"\n      ")])])}),0)]):e._e()},Is=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"form-legend-header"},[a("span",[e._v("审核者备注")])])}],Cs={props:{data:{type:Array,default:function(){return[]}}}},Ts=Cs,Ss=(a("d137"),Object(Bn["a"])(Ts,ws,Is,!1,null,"1833435c",null)),ks=Ss.exports,_s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._l(e.buttons,function(t,i){return["copy"!==t.runComm||e.options.isAllowCopy?a("el-button",{key:i,attrs:{disabled:"claim"===t.runComm||"unclaim"===t.runComm,type:e.warningButtons.indexOf(t.runComm)>-1?"warning":"primary"},on:{click:function(a){return e.$emit(t.runComm)}}},[e._v("\n      "+e._s(t.runName)+"\n    ")]):e._e()]}),e.options.isNeedSecondAudit?a("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.$emit("second-audit")}}},[e._v("\n      二次审核\n  ")]):e._e(),e.options.isAllowCancelTiming?a("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.$emit("cancel-timing")}}},[e._v("\n      取消定时\n  ")]):e._e()],2)},Ps=[],xs={data:function(){return{buttons:[],warningButtons:["delete","unclaim","unaudit","copy"]}},props:["resourceInfo","options"],methods:{getButtons:function(){var e=this,t=this.$consts.idPrefix,a=this.resourceInfo,i=a.id,n=a.version,o=a.type,r=a.status,l=a.menuElId;if("10"==t||i.toString().substr(0,2)===t){var s={resourceId:i,version:n,type:o,status:r,menuElId:l};this.$service.getAuditDetailButton(s).then(function(t){e.buttons=t})}}},created:function(){this.$watch("resourceInfo",this.getButtons,{immediate:!0})}},Ds=xs,Fs=Object(Bn["a"])(Ds,_s,Ps,!1,null,null,null),$s=Fs.exports,Ls=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{visible:e.showDialog},on:{"update:visible":function(t){e.showDialog=t}}},[a("el-form",{ref:"submitForm",attrs:{model:e.submitForm,rules:e.submitRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"是否定时"}},[a("el-radio-group",{model:{value:e.submitForm.isTiming,callback:function(t){e.$set(e.submitForm,"isTiming",t)},expression:"submitForm.isTiming"}},[a("el-radio",{attrs:{label:1}},[e._v("是")]),a("el-radio",{attrs:{label:0}},[e._v("否")])],1)],1),e.submitForm.isTiming?a("el-form-item",{attrs:{label:"设定时间",prop:"releaseTime"}},[a("el-date-picker",{attrs:{type:"datetime",clearable:!1,"picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.submitForm.releaseTime,callback:function(t){e.$set(e.submitForm,"releaseTime",t)},expression:"submitForm.releaseTime"}})],1):e._e()],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.judgeTask}},[e._v("确 定")]),a("el-button",{attrs:{size:"small"},on:{click:function(t){e.showDialog=!1}}},[e._v("取 消")])],1)],1)},Rs=[],Ns={data:function(){return{showDialog:!0,submitForm:{isTiming:0,releaseTime:void 0},pickerOptions:{disabledDate:function(e){var t=864e5,a=15*t;return e.getTime()<=Date.now()-t||e.getTime()>=Date.now()+a}},submitRules:{releaseTime:[{required:!0,message:"请选择时间",trigger:"change"}]}}},watch:{showDialog:function(e){!1===e&&this.$emit("cancel")}},methods:{judgeTask:function(){var e=this;this.$refs.submitForm.validate(function(t){if(t){var a=e.submitForm.isTiming;a?e.$service.getTimedTaskLimit().then(e.submitTask):e.submitTask()}})},submitTask:function(){this.$emit("submit",{isTiming:this.submitForm.isTiming,releaseTime:this.submitForm.releaseTime})}}},Es=Ns,Os=Object(Bn["a"])(Es,Ls,Rs,!1,null,null,null),As=Os.exports,Vs={components:{ContentAuthManager:jn,VersionList:ys,ContentButtonGroup:$s,AuditHistory:ks,ReleaseTimeSetter:As},data:function(){return{showReleaseTimeSetter:!1,showAuditDialog:!1,releaseTime:void 0,versionList:[],auditHistoryList:[],auditForm:{auditFlag:"4",auditDesc:""},auditFormRule:{auditDesc:[{required:!0,message:"请输入审核意见",trigger:"blur"}]}}},props:{mode:String,resourceInfo:{type:Object,default:function(){return{}}},validateMethod:{type:Function}},watch:{resourceInfo:"handleResourceChange"},computed:{buttonGroupOptions:function(){var e=this.$consts.status,t=e.draft,a=e.waiting,i=e.rejected,n=e.processing,o=e.waiting2,r=!this.versionList.some(function(e){var n=e.row.status;return n===t||n===a||n===i}),l=this.resourceInfo.status,s=l===n,c=l===o;return{isAllowCopy:r,isNeedSecondAudit:c,isAllowCancelTiming:s}}},methods:{handleSubmitWithReleaseTime:function(e){this.showReleaseTimeSetter=!1,this.$emit("submit-audit",e)},handleDelete:function(){var e=this,t=this.resourceInfo,a=t.type,i=t.id,n=t.version;this.$confirm("确认删除该版本吗?","提示").then(function(){e.$service.deleteVersion({type:a,id:i,version:n},"删除成功").then(function(){if(0===e.versionList.length)e.$emit("delete",!1);else{var t=e.versionList.find(function(e){return e.value!==n}).value;e.$emit("delete",!0),e.$emit("select-version",t)}})}).catch(function(){})},handleAuditStart:function(){this.showAuditDialog=!0},handleAuditEnd:function(){var e=this;this.$refs.auditForm.validate(function(t){if(t){var a=e.resourceInfo,i=a.id,n=a.version,o=a.type,r=e.auditForm,l=r.auditFlag,s=r.auditDesc;e.$service.auditTask({id:i,version:n,type:o,auditFlag:l,auditDesc:s},4===parseInt(l)?"审核成功":"打回成功").then(function(t){e.auditDialog=!1,e.$emit("audit")})}})},handleSecondAudit:function(){var e=this,t=this.resourceInfo,a=t.id,i=t.version,n=t.type;this.$confirm("是否对该内容进行二次审核","提示").then(function(){e.$service.secondAudit({id:a,version:i,type:n},"操作成功").then(function(t){e.$emit("audit")})}).catch(function(e){console.log(e)})},handleUnAudit:function(){var e=this,t=this.resourceInfo,a=t.id,i=t.version,n=t.type;this.$confirm("您确定要撤销审核吗?","提示").then(function(){e.$service.revokeAudit({id:a,version:i,type:n},"撤销审核成功").then(function(){e.$emit("unaudit")})}).catch(function(){})},handleShelves:function(){var e=this,t=this.resourceInfo,a=t.type,i=t.id,n=t.version;this.$service.putOnShelves({id:i,version:n,type:a},"上架成功").then(function(){e.$emit("shelves")})},getHistoryList:function(){var e=this,t=this.resourceInfo,a=t.type,i=t.id,n=t.version;i&&n?this.$service.getVersionList({id:i,type:a}).then(function(t){e.versionList=t}):this.versionList=[]},getAuditHistoryList:function(){var e=this,t=this.resourceInfo,a=t.type,i=t.id,n=t.version;i&&n?this.$service.getAuditHistoryList({id:i,type:a,version:n}).then(function(t){e.auditHistoryList=t}):this.auditHistoryList=[]},getReleaseTime:function(){var e=this;this.releaseTime=void 0;var t=this.resourceInfo,a=t.type,i=t.id,n=t.version,o=t.status,r=this.$consts.status,l=r.processing,s=r.waiting;i&&n&&(o!==l&&o!==s||this.$service.getTimedTaskInfo({id:i,type:a,version:n}).then(function(t){e.releaseTime=t.releaseTime}))},handleCancelTiming:function(){var e=this;this.$confirm("您确定取消定时吗?","提示").then(function(){var t=e.resourceInfo,a=t.type,i=t.id,n=t.version;t.status;e.$service.timedTaskCancel({id:i,type:a,version:n}).then(function(t){e.$emit("cancel-timing")})}).catch(function(){})},handleResourceChange:function(){this.getHistoryList(),this.getAuditHistoryList(),this.getReleaseTime()}},created:function(){}},Ms=Vs,Bs=(a("12a1"),Object(Bn["a"])(Ms,ps,hs,!1,null,"3f2fcc81",null)),Us=Bs.exports,js=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form-item",{attrs:{label:"应用包名",prop:e.formProp("packagename"),rules:e.rules.packagename}},[a("el-input",{model:{value:e.inputValue.packagename,callback:function(t){e.$set(e.inputValue,"packagename","string"===typeof t?t.trim():t)},expression:"inputValue.packagename"}})],1),a("el-form-item",{attrs:{label:"应用版本号",prop:e.formProp("versioncode"),rules:e.rules.versioncode}},[a("el-input",{model:{value:e.inputValue.versioncode,callback:function(t){e.$set(e.inputValue,"versioncode","string"===typeof t?t.trim():t)},expression:"inputValue.versioncode"}})],1),a("el-form-item",{attrs:{label:"启动动作",prop:e.formProp("dowhat"),rules:e.rules.dowhat}},[a("el-select",{model:{value:e.inputValue.dowhat,callback:function(t){e.$set(e.inputValue,"dowhat",t)},expression:"inputValue.dowhat"}},e._l(e.dowhatOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"启动方式",prop:e.formProp("bywhat"),rules:e.rules.bywhat}},[a("el-select",{model:{value:e.inputValue.bywhat,callback:function(t){e.$set(e.inputValue,"bywhat",t)},expression:"inputValue.bywhat"}},e._l(e.bywhatOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"启动参数",prop:e.formProp("byvalue"),rules:e.rules.byvalue}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.inputValue.byvalue,callback:function(t){e.$set(e.inputValue,"byvalue","string"===typeof t?t.trim():t)},expression:"inputValue.byvalue"}})],1),a("el-form-item",{attrs:{label:"数据配置",prop:e.formProp("data")}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.inputValue.data,callback:function(t){e.$set(e.inputValue,"data","string"===typeof t?t.trim():t)},expression:"inputValue.data"}})],1),a("el-form-item",{attrs:{label:"扩展参数"}},[e._l(e.inputValue.params,function(t,i){return a("div",{key:i,staticClass:"app-extend-params"},[a("el-form-item",{attrs:{label:"key:","label-width":"60px",prop:e.formProp("params."+i+".key"),rules:e.rules.params.key}},[a("el-input",{model:{value:t.key,callback:function(a){e.$set(t,"key","string"===typeof a?a.trim():a)},expression:"param.key"}})],1),a("el-form-item",{attrs:{label:"value:","label-width":"60px",prop:e.formProp("params."+i+".value"),rules:e.rules.params.value}},[a("el-input",{model:{value:t.value,callback:function(a){e.$set(t,"value","string"===typeof a?a.trim():a)},expression:"param.value"}})],1),a("a",{staticClass:"app-params__remove-param",on:{click:function(t){return e.handleRemoveParam(i)}}},[a("i",{staticClass:"el-icon-minus"})])],1)}),a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleAddParam}},[a("i",{staticClass:"el-icon-plus"}),e._v(" 添加\n    ")])],2)],1)},Gs=[],Ws={data:function(){function e(e,t,a){/[！￥……（）——【】：；“”‘’、《》，。？\s+]/.test(t)?a(new Error("请勿输入特殊或空白字符")):a()}return{inputValue:{packagename:void 0,versioncode:void 0,dowhat:void 0,bywhat:void 0,byvalue:void 0,params:[],data:"",exception:{}},rules:{packagename:[{required:!0,message:"请输入应用包名",trigger:"blur"}],versioncode:[{required:!0,message:"请输入应用版本号",trigger:"blur"}],dowhat:[{required:!0,message:"请选择启动动作",trigger:"blur"}],bywhat:[{required:!0,message:"请选择启动方式",trigger:"blur"}],byvalue:[{required:!0,message:"请输入启动参数",trigger:"blur"}],params:{key:[{required:!0,message:"不能为空",trigger:"blur"},{validator:e,trigger:"blur"}],value:[{required:!0,message:"不能为空",trigger:"blur"},{validator:e,trigger:"blur"}]}}}},props:{value:{},propPrefix:{},dowhatOptions:{default:function(){return[{label:"startActivity",value:"startActivity"},{label:"startService",value:"startService"},{label:"sendBroadcast",value:"sendBroadcast"}]}},bywhatOptions:{default:function(){return[{label:"action",value:"action"},{label:"class",value:"class"},{label:"uri",value:"uri"},{label:"activity",value:"activity"}]}}},watch:{value:"setInputValue"},methods:{formProp:function(e){return(this.propPrefix||"")+e},genDefaultValue:function(){return{packagename:void 0,versioncode:void 0,dowhat:void 0,bywhat:void 0,byvalue:void 0,params:[]}},setInputValue:function(e){e!==this.inputValue&&(this.inputValue=Object.assign(this.genDefaultValue(),e))},emitInputValue:function(e){this.$emit("input",this.inputValue)},handleAddParam:function(){this.inputValue.params.push({key:void 0,value:void 0})},handleRemoveParam:function(e){this.inputValue.params.splice(e,1)}},created:function(){this.value&&this.setInputValue(this.value),this.$watch("inputValue",this.emitInputValue,{deep:!0})}},qs=Ws,Hs=(a("e091"),Object(Bn["a"])(qs,js,Gs,!1,null,"7aeed227",null)),zs=Hs.exports,Js=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form-item",{attrs:{label:"应用包名"}},[e._v(e._s(e.value.packagename))]),a("el-form-item",{attrs:{label:"应用版本号"}},[e._v(e._s(e.value.versioncode))]),a("el-form-item",{attrs:{label:"启动动作"}},[e._v(e._s(e.value.dowhat))]),a("el-form-item",{attrs:{label:"启动方式"}},[e._v(e._s(e.value.bywhat))]),a("el-form-item",{attrs:{label:"启动参数"}},[e._v(e._s(e.value.byvalue))]),a("el-form-item",{attrs:{label:"数据配置"}},[e._v(e._s(e.value.data))]),a("el-form-item",{attrs:{label:"扩展参数"}},e._l(e.value.params,function(t,i){return a("div",{key:i,staticClass:"app-extend-params"},[a("el-form-item",{attrs:{label:"","label-width":"0px"}},[a("el-tag",[e._v("key")]),e._v(" \n        "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.key,placement:"top"}},[a("span",[e._v(e._s(t.key))])])],1),a("el-form-item",{attrs:{label:"","label-width":"0px"}},[a("el-tag",[e._v("value")]),e._v(" \n        "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.value,placement:"top"}},[a("span",[e._v(e._s(t.value))])])],1)],1)}),0)],1)},Ks=[],Qs={template:"#cc-app-params-read",data:function(){return{}},props:["value"],created:function(){}},Xs=Qs,Ys=(a("5f98"),Object(Bn["a"])(Xs,Js,Ks,!1,null,"74061b6d",null)),Zs=Ys.exports,ec={components:{draggable:jo.a,ResourceSelector:ql,DialogPicture:Xl,DialogCorner:is,selectClick:ds,AppParams:zs,AppParamsRead:Zs,CommonContent:Us},props:["id","initMode","version"],data:function(){return{pictureResolution:"797*449",selectingManualResource:!1,type:"block",menuElId:"broadcastBlock",disabled:!1,onclickEventVisibleFlag:"",clickData:void 0,onclickEventVisible:!1,cornerIconTypeOptions:{},cornerTypes:[],materialTypes:null,resourceOptions:["video","edu","live","rotate"],basicForm:{id:void 0,containerName:"",containerType:"REFERENCE_BROADCASTING",configModel:"broadcast",currentVersion:void 0,status:void 0,source:"none"},normalForm:{},lowerForm:{coverType:"media"},auditDisabled:!1,normalRules:{title:[{required:!0,message:"请填写标题",trigger:"blur"}],"poster.pictureUrl":[{required:!0,message:"请上传海报",trigger:"blur"}],thirdIdOrPackageName:[{required:!0,message:"请填选择资源",trigger:"blur"}],clickParams:[{validator:function(e,t,a){var i=this.normalForm;if("manualResource"===i.sign&&(!t||"{}"===t))return a("请选择资源");a()}.bind(this)}]},lowerRules:{title:[{required:!0,message:"请填写标题",trigger:"blur"}],"poster.pictureUrl":[{required:!0,message:"请上传海报",trigger:"blur"}],thirdIdOrPackageName:[{required:!0,message:"请填选择资源",trigger:"blur"}]},normalResourceBtn:"轮播资源",currentIndex:0,pictureListOptions:{poster:{idField:"pictureId",searchParams:{pictureId:{label:"素材ID"},pictureName:{label:"素材名称"},pictureCategory:{label:"素材类别",options:[]},pictureStatus:{label:"素材状态",options:[{label:"审核通过",value:"1"},{label:"待审核",value:"2"}]}},picField:"pictureUrl",textItems:[{field:"pictureName"},{field:"pictureStatus",customFormatter:function(e,t){return["","审核通过","待审核"][t]}}]},corner:{idField:"cornerIconId",searchParams:{cornerIconId:{label:"角标ID"},cornerIconName:{label:"角标名称"},"cornerIconType.typeId":{label:"角标类别",options:[]}},picField:"imgUrl",textItems:[{field:"cornerIconName"},{field:"cornerStatus",customFormatter:function(e,t){return["","审核通过","待审核"][t]}}]}},signDisabled:!1,modelType:"broadcast",versionForm:{title:"",subTitle:"",type:"",coverType:"media",thirdIdOrPackageName:"",subchannelId:"",subchannelIs:"",params:{},clickType:"detail",onclick:{},sign:"autoSet",contentType:"",clickParams:"",poster:{},cornerIconList:[{},{},{},{}]},pictureType:"",currentForm:"",pannelResource:"",autoWrite:!0,normalVersionContent:[],openModeArray:[{name:"第三方应用",value:"app"}],referenceDataNormal:[],referenceData:[],noPreview:"noPreview",referenceOptions:{picture:!1},resourceVisible:!1,layoutOptions:{contentDataNew:[]},selectPicture:"",resourceSeq:"",layoutparam:{},layouttypenew:"",checkresourceis:!0,customDialogPicture:{},customDialogCorner:{},pictureOptions:{}}},computed:{source:function(){return"none"===this.basicForm.source?"":this.basicForm.source},thirdIdOrPackageNameForClick:function(){return this.getThirdId(this.normalForm.clickParams)},couldFullscreen:function(){var e=this.normalForm.contentType;return["movie","custom","edu","txLive"].indexOf(e)>-1},classObject:function(){return this.normalForm.sign,{height:"600px"}},resourceInfo:function(){var e=this.basicForm;if(e.id)return{id:e.id,type:this.type,menuElId:this.menuElId,version:e.currentVersion,status:e.status}}},watch:{"basicForm.configModel":{deep:!0,handler:function(e,t){"group"===e?this.normalResourceBtn="播放资源":"broadcast"===e&&(this.normalResourceBtn="轮播资源")}},"normalForm.sign":{deep:!0,handler:function(e,t){this.selectingManualResource="manualResource"===e}}},methods:{handleSourceChange:function(e){this.$confirm("切换内容源将清空内容, 确定切换?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){this.normalForm=Object.assign({},this.versionForm),this.normalVersionContent=[this.normalForm],this.currentIndex=0,this.cleanLowerForm(),this.basicForm.source=e}.bind(this)).catch(function(e){})},getThirdId:function(e){if(e){var t=JSON.parse(e);return t.id||t.rotateId||t.pTopicCode||t.url}},replicate:function(){this.mode="replicate",this.disabled=!1,this.title="创建副本"},edit:function(){this.mode="edit",this.disabled=!1,this.title="编辑"},signChange:function(e){"manualSet"===e&&(this.normalForm.coverType="custom",this.normalForm.contentType="custom",this.normalForm.onclick={},!1===this.autoWrite&&(this.normalForm.type="url"))},clickThirdpartSubmit:function(){var e=this.onclickEventVisibleFlag;if("lower"===e){var t=this.$refs.openWayLower.inputValue;this.parseOnclick(t)}else{var a=this.$refs.openWayNormal.inputValue;this.parseOnclick(a)}},selectCancel:function(e){this.resourceVisible=!1,"savePicture"===e&&this.savePicture()},parseOnclick:function(e){var t=this.clickData;Object.keys(e).map(function(a){if("params"===a){var i=JSON.parse(t[a]);e[a]=Object.keys(i).map(function(e){return{key:e,value:i[e]}})}else e[a]=t[a]})},getClickData:function(e){this.onclickEventVisible=!1,this.clickData=e;var t=JSON.parse(e.params),a=Object.keys(t),i=a.reduce(function(e,a,i){var n={};return n.key=a,n.value=t[a],e.push(n),e},[]),n={packagename:e.packagename,versioncode:e.versioncode,dowhat:e.dowhat,bywhat:e.bywhat,byvalue:e.byvalue,params:i,exception:e.exception};this[this.onclickEventVisibleFlag+"Form"]["onclick"]=n},handleChangeSign:function(e){var t=this.normalForm;"autoSet"===e&&(t.onclick="",t.clickParams=t.params,t.clickTemplateType=t.contentType,this.referenceDataNormal={}),"manualResource"===e&&(t.onclick="",t.clickParams="",t.clickTemplateType="",this.referenceDataNormal={}),"manualSet"===e&&(t.clickTemplateType="custom",t.clickParams="",this.referenceDataNormal={}),t.sign=e},autoWriteFun:function(){if(this.autoWrite=!this.autoWrite,!1===this.autoWrite){this.normalForm=Object.assign({},this.versionForm),this.normalVersionContent.splice(this.currentIndex,1,this.normalForm),this.signDisabled=!0,this.normalForm.type="url",this.referenceDataNormal={},this.normalForm.sign=void 0,this.$nextTick(function(){this.handleChangeSign("manualSet")}.bind(this));var e=Object.assign({},this.normalForm),t={url:this.normalForm.thirdIdOrPackageName,source:"",name:this.normalForm.title,needParse:"false",url_type:"web"};e.params=JSON.stringify(t),this.normalForm=e}else this.normalForm=Object.assign({},this.versionForm),this.referenceDataNormal={},this.handleChangeSign("autoSet"),this.signDisabled=!1,this.normalVersionContent[this.currentIndex]=this.normalForm},deleteCorner:function(e,t){var a=e.cornerIconList.slice(0);a[t]={cornerIconId:"",imgUrl:"",position:t},e.cornerIconList=a,console.log(e)},modelChange:function(e){this.autoWrite=!0;var t=this;this.$confirm("切换后配置数据将被清空, 是否确认切换?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$message({type:"success",message:"模式切换成功!"}),t.modelType=t.basicForm.configModel,t.clearFormAll()}).catch(function(){t.$message({type:"info",message:"已取消切换"});var e=Object.assign({},t.basicForm);e.configModel=t.modelType,t.basicForm=e})},clearFormAll:function(){this.normalForm=Object.assign({},this.versionForm),this.normalForm.clickType="detail",this.lowerForm=Object.assign({},this.versionForm);var e=[];e.push(this.normalForm),this.normalVersionContent=e},handleSelectNormalSingleResourceEnd:function(e,t){var a;if("single"===t)a=this.callbackParam("rotate",e.rotate[0]);else for(var i=this.resourceOptions,n=0;n<i.length;n++)1===e[i[n]].length&&(a=this.callbackParam(i[n],e[i[n]][0],e.videoSource));this.resourceConfirm(a,"normalForm")},handleSelectNormalmultipleResourceEnd:function(e){var t=this;this.autoWrite||this.autoWriteFun();for(var a=[],i=this.resourceOptions,n=0;n<i.length;n++)e[i[n]].forEach(function(o){a.push(t.callbackParam(i[n],o,e.videoSource))});this.resourceConfirm(a,"normalForm")},handleSelectLowerSingleResourceEnd:function(e){for(var t,a=this.resourceOptions,i=0;i<a.length;i++)1===e[a[i]].length&&(t=this.callbackParam(a[i],e[a[i]][0],e.videoSource));this.resourceConfirm(t,"lowerForm")},handleSelectNormalSingleOtherResourceEnd:function(e){for(var t,a=this.resourceOptions,i=0;i<a.length;i++)1===e[a[i]].length&&(t=this.callbackParam(a[i],e[a[i]][0],e.videoSource));this.resourceConfirm(t,"normalForm")},callbackParam:function(e,t,a){var i={type:"",contentType:"",thirdIdOrPackageName:""};switch(e){case"video":switch(void 0!==t.selectedEpisodes&&(t.coocaaVId=t.selectedEpisodes.coocaaMId,t.pictureUrl=t.selectedEpisodes.thumb,t.title=t.selectedEpisodes.urlTitle,t.subTitle=t.selectedEpisodes.urlSubTitle),i.contentType="movie",a){case"yinhe":case"o_iqiyi":i.thirdIdOrPackageName="_oqy_"+t.coocaaVId;break;case"o_tencent":case"tencent":i.thirdIdOrPackageName="_otx_"+t.coocaaVId;break;default:i.thirdIdOrPackageName=t.coocaaVId;break}i.singleId=t.singleId,i.pictureUrl=t.thumb,i.title=t.title,i.subTitle=t.subTitle,i.type="res";break;case"app":i.contentType="app",i.coverType="app",i.thirdIdOrPackageName=t.appPackageName,i.pictureUrl=t.appImageUrl,i.title=t.appName,i.type="app";break;case"edu":i.contentType="edu",i.thirdIdOrPackageName="_otx_"+t.coocaaVId,i.platformId=t.source,i.pictureUrl=t.thumb,i.title=t.title,i.subTitle=t.subTitle,i.type="res";break;case"pptv":i.contentType="pptv",i.thirdIdOrPackageName="pptv_tvsports://tvsports_detail?section_id="+t.pid+"&from_internal=1",i.title=t.pTitle,i.type="";break;case"live":i.contentType="txLive",i.thirdIdOrPackageName="_otx_"+t.vId,i.platformId=t.source,i.pictureUrl=t.thumb,i.title=t.title,i.subTitle=t.subTitle,i.type="live";break;case"topic":"parentTopic"===t.dataSign?i.contentType="bigTopic":i.contentType="topic",i.thirdIdOrPackageName=t.id+"",i.pictureUrl=t.picture,i.title=t.title,i.subTitle=t.subTitle,i.type="topic";break;case"rotate":i.contentType="rotate",i.thirdIdOrPackageName=t.id+"",i.pictureUrl=t.picture,i.title=t.title,i.subTitle=t.subTitle,i.type="rotate";break;default:break}return i},paramIdFun:function(e){if("movie"===e.contentType)if(e.singleId)var t={id:e.thirdIdOrPackageName,vid:e.singleId};else t={id:e.thirdIdOrPackageName};else if("app"===e.contentType||"edu"===e.contentType||"txLive"===e.contentType)t={id:e.thirdIdOrPackageName};else if("bigTopic"===e.contentType)t={pTopicCode:e.thirdIdOrPackageName};else if("topic"===e.contentType)t={topicCode:e.thirdIdOrPackageName};else if("rotate"===e.contentType)t={rotateId:e.thirdIdOrPackageName};return t},paramIdFun_o:function(e,t){if("movie"===t.contentType)if(t.singleId)var a={id:t.thirdIdOrPackageName,vid:t.singleId};else a={id:t.thirdIdOrPackageName};else if("app"===t.contentType||"edu"===t.contentType||"txLive"===t.contentType)a={id:t.thirdIdOrPackageName};else if("bigTopic"===t.contentType)a={pTopicCode:t.thirdIdOrPackageName};else if("topic"===t.contentType)a={topicCode:t.thirdIdOrPackageName};else if("rotate"===t.contentType)a={rotateId:t.thirdIdOrPackageName};return a},packageFormParam_o:function(e,t){var a=JSON.parse(JSON.stringify(this.versionForm));a=Object.assign({},a,e),"rotate"===e.contentType?a.subchannelIs=!0:a.subchannelIs=!1,"bigTopic"===e.contentType?a.smallTopicsIs=!0:a.smallTopicsIs=!1,e.pictureUrl&&(a.poster.pictureUrl=e.pictureUrl,a.poster.pictureId=e.pictureId);var i=this.paramIdFun(a,e);return a.clickParams=JSON.stringify(i),a.params=JSON.stringify(i),a},packageFormParam:function(e,t){if(t=JSON.parse(JSON.stringify(t)),t.type=e.type,"rotate"===e.contentType?t.subchannelIs=!0:t.subchannelIs=!1,"bigTopic"===e.contentType?t.smallTopicsIs=!0:t.smallTopicsIs=!1,t.title=e.title,t.contentType=e.contentType,t.subTitle=e.subTitle,t.thirdIdOrPackageName=e.thirdIdOrPackageName,e.pictureUrl){var a=Object.assign({},t.poster);a.pictureUrl=e.pictureUrl,t.poster=a}var i=this.paramIdFun(e);return t.params=JSON.stringify(i),"autoSet"===t.sign&&(t.clickParams=JSON.stringify(i),t.clickTemplateType=e.contentType),t},smallTopicsLower:function(){if(this.lowerForm.smallTopicsId){var e=JSON.parse(this.lowerForm.params);e.topicCode=this.lowerForm.smallTopicsId,this.lowerForm.params=JSON.stringify(e)}},getUrlBlur:function(){if(!1===this.autoWrite){var e=Object.assign({},this.normalForm),t={url:this.normalForm.thirdIdOrPackageName,source:"",name:this.normalForm.title,needParse:"false",url_type:"web"};e.params=JSON.stringify(t),this.normalForm=e}},getTitleNormal:function(){if(!1===this.autoWrite){var e=Object.assign({},this.normalForm),t={url:this.normalForm.thirdIdOrPackageName,source:"",name:this.normalForm.title,needParse:"false",url_type:"web"};e.params=JSON.stringify(t),this.normalForm=e,this.normalVersionContent.splice(this.currentIndex,1,this.normalForm)}},getSubchannel:function(e){if(e.subchannelId){var t=JSON.parse(e.params);t.stationId=e.subchannelId,e.params=JSON.stringify(t)}},resourceConfirm:function(e,t){var a=this;if(this.currentForm=this[t],this.resourceVisible=!1,this.normalVersionContent=this.normalVersionContent.filter(function(e){return""!==e.type}),e instanceof Array){var i;console.log("array");var n=e.reduce(function(e,t){return e.push(a.packageFormParam(t,a.currentForm)),e},[]);(i=this.normalVersionContent).splice.apply(i,[this.currentIndex,0].concat(Object(Bo["a"])(n))),this[t]=n[0]}else console.log(" no array"),this.selectingManualResource?(this[t].clickParams=JSON.stringify(this.paramIdFun(e)),this[t].clickTemplateType=e.contentType,this.selectingManualResource=!1):(this[t]=this.packageFormParam(e,this.currentForm),"normalForm"===t&&this.normalVersionContent.splice(this.currentIndex,0,this[t]))},checkNormalForm:function(e){var t=this;this.$refs.normalForm.validate(function(a){if(!a)return t.$message("请将表单填写完整"),!1;"manualSet"===t.normalForm.sign?(t.normalVersionContent.splice(t.currentIndex,1,t.normalForm),e()):e()})},checkLowerForm:function(e){var t=this;this.$refs.lowerForm.validate(function(a){if(!a)return t.$message("请将表单填写完整"),!1;t.lowerForm.coverType,e()})},deepClone:function(e){return JSON.parse(JSON.stringify(e))},addNormal:function(e){var t=this;this.checkNormalForm(function(){t.normalForm=t.deepClone(t.versionForm),t.normalVersionContent.push(t.normalForm),t.currentIndex=t.normalVersionContent.length-1,t.referenceDataNormal=[],t.autoWrite=!0,t.signDisabled=!1})},deleteNormal:function(e){var t=this;this.$confirm("是否删除当前选中项?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$message({type:"success",message:"删除成功!"}),t.normalVersionContent.splice(e,1),t.currentIndex=0,t.normalForm=t.normalVersionContent[0],"url"===t.normalForm.type?t.autoWrite=!1:t.autoWrite=!0,"manualSet"===t.normalForm.sign?(t.referenceDataNormal={onclick:t.normalForm.onclick,params:"openMode==app"},"url"!==t.normalForm.type?t.signDisabled=!1:t.signDisabled=!0):t.signDisabled=!0}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},switchNormal:function(e){console.log(this.normalVersionContent);var t=this;this.checkNormalForm(function(){t.currentIndex=e,t.normalForm=t.normalVersionContent[e],"url"===t.normalForm.type?t.autoWrite=!1:t.autoWrite=!0,"manualSet"===t.normalForm.sign?(t.referenceDataNormal={onclick:t.normalForm.onclick,params:"openMode==app"},"url"===t.normalForm.type?t.signDisabled=!0:t.signDisabled=!1):t.signDisabled=!1,t.normalVersionContent.splice(e,1,t.normalForm)})},openPicture:function(e,t,a){this.disabled||(this.pictureResolution="normalForm"===t?"797*449":"1210*449",this.pictureType=e,this.currentForm=t,"poster"===e?this.customDialogPicture={visible:!0,form:t}:this.customDialogCorner={visible:!0,form:t,index:a},this.pictureOptions=this.pictureListOptions[e])},savePicture:function(){var e=this.selectPicture;if("{}"===JSON.stringify(e))this.$message("请至少选择一项");else{if(this.customDialogPicture.visible=!1,this.customDialogCorner.visible=!1,"poster"===this.pictureType)this[this.currentForm].poster={pictureUrl:e.pictureUrl,pictureId:e.pictureId};else if("corner"===this.pictureType){var t=e.cornerIconType.typePosition,a={cornerIconId:e.cornerIconId,position:t,imgUrl:e.imgUrl},i=this[this.currentForm].cornerIconList.slice(0);i[t]=a,this[this.currentForm].cornerIconList=i,this.customDialogCorner.visible=!1}this.selectPicture={}}this.normalVersionContent[this.currentIndex]=this.normalForm},onDragStart:function(e){console.log(e)},onDragtEnd:function(e){console.log(e),this.currentIndex=e.newIndex,this.normalForm=this.normalVersionContent[e.newIndex]},lowerFill:function(){var e=Object.assign({},this.normalVersionContent[0]);this.lowerForm=e},cleanLowerForm:function(e){this.resourceOptions="app"===e?["app"]:["video","edu","live","rotate"];var t=Object.assign({},this.versionForm);t.type=e,t.coverType=e,"custom"===e&&(t.sign="openMode==app",t.contentType="custom",t.params="{}",t.clickTemplateType="custom"),this.lowerForm=t},saveNormal:function(e){var t=this;this.checkNormalForm(function(){if("group"===t.basicForm.configModel){if(t.normalVersionContent.length<4)return t.$message("组合模式下，正常版本的配置资源至少4个，才可以进行保存！"),!1;e()}else e()})},submitCheck:function(e,t){if(this.basicForm.status=t,"V1"===this.basicForm.currentVersion&&"replicate"!==this.mode||void 0===this.basicForm.currentVersion)return this.doSave(t);"10"==this.$consts.idPrefix?e?(this.basicForm.isTiming=e.isTiming,this.basicForm.releaseTime=e.releaseTime,this.doSave(t)):3===t?this.$refs.commonContent.showReleaseTimeSetter=!0:this.doSave(t):this.doSave(t)},doSave:function(e){"replicate"===this.mode&&(this.basicForm.currentVersion="");var t=this;this.$refs.basicForm.validate(function(a){if(!a)return t.$message("请将表单填写完整"),!1;t.saveNormal(function(){t.checkLowerForm(function(){var a={normalVersionContent:[],lowerVersionContent:{}};"group"===t.basicForm.configModel?(t.normalVersionContent.map(function(e){e.onclick&&(e.onclick=JSON.stringify(e.onclick)),delete e.thirdIdOrPackageName}),a.normalVersionContent=t.normalVersionContent):(t.normalForm.onclick&&(t.normalForm.onclick=JSON.stringify(t.normalForm.onclick)),a.normalVersionContent.push(t.normalForm)),delete t.lowerForm.smallTopicsId,a.lowerVersionContent=t.lowerForm;var i=Object.assign(a,t.basicForm);i.status=e,i.parentType="Block",console.log("resultObj",i),t.$service.saveBlockInfo({jsonStr:JSON.stringify(i)},"提交成功").then(function(){t.$emit("upsert-end")})})})})},close:function(){window.parent.$("#add-view").dialog("_close")},fetchData:function(e){var t=this;this.$service.getBroadcastBlockEditData({id:this.id,version:e}).then(function(e){var a=t;a.basicForm.containerName=e.containerName,a.basicForm.containerType="REFERENCE_BROADCASTING",a.basicForm.configModel=e.configModel,a.basicForm.source=e.source,a.basicForm.status=e.status,a.basicForm.id=e.id,a.basicForm.currentVersion=e.currentVersion;var i=Object.assign({},a.normalForm);e.normalVersionContent.forEach(function(t,a){var i=[{},{},{},{}];if(t.cornerIconList&&0!==t.cornerIconList.length){for(var n=t.cornerIconList,o=0;o<n.length;o++){var r=n[o];i[r.position]=r}t.cornerIconList=i}else t.cornerIconList=i;if("manualSet"===t.sign){var l=Object.values(JSON.parse(t.params))[0];t=Object.assign({},t,{thirdIdOrPackageName:l})}else{l=Object.values(JSON.parse(t.clickParams))[0];t=Object.assign({},t,{thirdIdOrPackageName:l})}t.onclick=JSON.parse(t.onclick),e.normalVersionContent.splice(a,1,t)}),a.normalVersionContent=e.normalVersionContent,i=e.normalVersionContent[0],i.poster=e.normalVersionContent[0].poster,"manualSet"===i.sign&&(a.referenceDataNormal={onclick:i.onclick,params:"openMode==app"}),a.normalForm=i,"url"===a.normalForm.type?a.autoWrite=!1:a.autoWrite=!0,"manualSet"===a.normalForm.sign?(a.referenceDataNormal={onclick:a.normalForm.onclick,params:"openMode==app"},"url"===a.normalForm.type?a.signDisabled=!0:a.signDisabled=!1):a.signDisabled=!1;var n=e.lowerVersionContent;a.lowerForm=n,a.lowerForm.onclick=JSON.parse(a.lowerForm.onclick),a.lowerForm.thirdIdOrPackageName=Object.values(JSON.parse(n.clickParams))[0];var o=[{},{},{},{}];if(0===n.cornerIconList.length)n.cornerIconList=o;else{for(var r=n.cornerIconList,l=0;l<r.length;l++){var s=r[l];o[s.position]=s}a.lowerForm.cornerIconList=o}var c=n.coverType;"app"!==c&&"custom"!==c||(a.referenceDataLower={onclick:n.onclick,params:"openMode==app"}),a.modelType=e.configModel,a.$watch("lowerForm.coverType",a.cleanLowerForm)})}},created:function(){var e=this,t=this;switch(this.normalForm=Object.assign({},this.versionForm),this.lowerForm=Object.assign({},this.versionForm),this.lowerForm.smallTopicsId="",this.lowerForm.smallTopicsIs=!1,this.mode=this.initMode||"create",this.mode){case"create":this.title="新增",this.disabled=!1;break;case"copy":this.title="复制",this.disabled=!1;break;case"edit":this.title="编辑",this.disabled=!1;break;case"replica":this.title="创建副本",this.disabled=!1;case"read":this.title="预览",this.disabled=!0;break}this.id&&this.fetchData(this.version),this.$service.getDictType({type:"materialType"}).then(function(e){for(var a=[],i=0;i<e.length;i++){var n={label:e[i].dictCnName,value:e[i].dictId};a.push(n),t.pictureListOptions.poster.searchParams.pictureCategory.options=a}}),this.$service.getCornerTypes().then(function(t){for(var a={},i=0;i<t.length;i++){var n=t[i].typeName,o=t[i].typeId;a[n]=o}e.cornerIconTypeOptions=a})}},tc=ec,ac=(a("287d"),Object(Bn["a"])(tc,Vo,Mo,!1,null,"5353b676",null)),ic=ac.exports,nc={components:{BroadcastBlockInfo:ic,BroadcastBlockList:Ao},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0}},methods:{handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e.id,this.mode="edit",this.isShowList=!1},handleRead:function(e,t){this.id=e.id,this.mode="read",this.version=t,this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.deleteBroadcastBlock({id:e.map(function(e){return e.id}).join(",")},"删除成功").then(function(e){t.$refs.list.fetchData()})},handleCopy:function(e){this.id=e.id,this.mode="copy",this.isShowList=!1},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},oc=nc,rc=Object(Bn["a"])(oc,Co,To,!1,null,"79f269f3",null),lc=rc.exports,sc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("ResourceList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,delete:e.handleDelete,read:e.handleRead,edit:e.handleEdit,copy:e.handleCopy}}),e.isShowList?e._e():a("ResourceContent",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},cc=[],uc={components:{ResourceList:function(){},ResourceContent:function(){}},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0}},computed:{resourceInfo:function(){return{type:"resource",idField:"id"}}},methods:{handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e[this.resourceInfo.idField],this.mode="edit",this.isShowList=!1},handleRead:function(e,t){this.id=e[this.resourceInfo.idField],this.mode="read",this.version=t,this.isShowList=!1},handleDelete:function(e){var t=this,a=this.resourceInfo,i=a.idField;this.$service.deleteResource({type:a.type,id:e.map(function(e){return e[i]}).join(",")},"删除成功").then(function(){t.$refs.list.fetchData()})},handleCopy:function(e){this.id=e[this.resourceInfo.idField],this.mode="copy",this.isShowList=!1},handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},dc=uc,pc=Object(Bn["a"])(dc,sc,cc,!1,null,null,null),hc=pc.exports,mc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{ref:"contentCard",staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.fetchData,"filter-reset":e.handleFilterReset}},[a("el-form",{ref:"form",staticClass:"form",attrs:{inline:"","label-width":"0px"},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("el-form-item",{staticClass:"el-col-6"},[a("el-input",{attrs:{placeholder:"ID"},model:{value:e.filter.pluginId,callback:function(t){e.$set(e.filter,"pluginId",t)},expression:"filter.pluginId"}})],1),a("el-form-item",{staticClass:"el-col-6"},[a("el-input",{attrs:{placeholder:"功能名称"},model:{value:e.filter.pluginName,callback:function(t){e.$set(e.filter,"pluginName",t)},expression:"filter.pluginName"}})],1),a("el-form-item",{staticClass:"el-col-6"},[a("el-select",{attrs:{placeholder:"父功能分类"},on:{change:e.getPluginType},model:{value:e.filter.pluginParentType,callback:function(t){e.$set(e.filter,"pluginParentType",t)},expression:"filter.pluginParentType"}},e._l(e.parentTypes,function(e,t){return a("el-option",{key:t,attrs:{label:e.dictCnName,value:e.dictEnName}})}),1)],1),a("el-form-item",{staticClass:"el-col-6"},[a("el-select",{attrs:{placeholder:"功能分类"},model:{value:e.filter.pluginType,callback:function(t){e.$set(e.filter,"pluginType",t)},expression:"filter.pluginType"}},e._l(e.pluginType,function(e,t){return a("el-option",{key:t,attrs:{label:e.dictCnName,value:e.dictEnName}})}),1)],1),a("el-form-item",{staticClass:"el-col-6"},[a("el-select",{attrs:{placeholder:"状态"},model:{value:e.filter.pluginStatus,callback:function(t){e.$set(e.filter,"pluginStatus",t)},expression:"filter.pluginStatus"}},e._l(e.$consts.statusOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{staticClass:"el-col-6"},[a("el-select",{attrs:{placeholder:"内容源"},model:{value:e.filter.source,callback:function(t){e.$set(e.filter,"source",t)},expression:"filter.source"}},e._l(e.$consts.sourceNumberOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{staticClass:"el-form-item-submit"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{on:{click:e.handleFilterReset}},[e._v("重置")])],1)],1),a("div"),a("ButtonGroupForListPage",{attrs:{pageName:"multiFunctionBlock"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},fc=[],gc={extends:Po,components:{Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"],ButtonGroupForListPage:Ro},data:function(){var e=this;return{resourceType:"blockInfo",pluginType:[],parentTypes:[],childTypes:{},filter:{},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"pluginId",width:"70"},{label:"功能名称",prop:"pluginName",render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(i)}}},i.pluginName)}},{label:"待审核的版本",prop:"duplicateVersion",sortable:!0,render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(i,i.duplicateVersion)}}},i.duplicateVersion)}},{label:"内容源",prop:"source",render:function(t,a){var i=a.row;return e.$consts.sourceNumberText[i.source]}},{label:"状态",prop:"pluginStatus",render:function(t,a){var i=a.row;return e.$consts.statusText[i.pluginStatus]}},{label:"更新时间",prop:"lastUpdateDate"},{label:"操作",render:function(t,a){var i=a.row;if(i.showContentAuthSettingBtn)return t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleOpenContentAuthManager(i)}}},"内容权限")}}],data:[],selected:[],selectionType:"multiple"}}},methods:{handleOpenContentAuthManager:function(e){this.$refs.contentCard.handleShowContentAuthManager({id:e.pluginId,menuElId:"multiFunctionBlock",type:"systemPlugin"})},getPluginType:function(){var e=this;this.$service.getPluginType({pluginParentType:this.filter.pluginParentType}).then(function(t){e.pluginType=t})},fetchData:function(){var e=this,t=this.parseFilter();this.$service.getMultiBlockList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},getPluginParentTypes:function(){var e=this;this.$service.getPluginParentTypes().then(function(t){e.parentTypes=t})},handleFilterChange:function(){this.$validateId(this.filter.pluginId)&&(this.pagination.currentPage=1,this.fetchData())},handleFilterReset:function(){this.filter={},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e}},created:function(){this.getPluginParentTypes(),this.fetchData()}},bc=gc,vc=(a("fee3"),Object(Bn["a"])(bc,mc,fc,!1,null,"f41ed9e4",null)),yc=vc.exports,wc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("div",{staticClass:"multi-func-block-upsert"},[a("CommonContent",{attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{replicate:function(t){e.mode="replicate",e.title="创建副本"},edit:function(t){e.mode="edit",e.title="编辑"},unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,"submit-audit":function(t){return e.handleSubmitAudit(t,e.$consts.status.waiting)},"save-draft":function(t){return e.handleSubmitAudit(t,e.$consts.status.draft)},audit:function(t){return e.$emit("upsert-end")},"select-version":e.fetchData,delete:function(t){return e.$emit("upsert-end",t)}}},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),"read"!==e.mode?a("div",[a("el-form",{ref:"blockForm",staticClass:"el-form-add",attrs:{rules:e.rules,model:e.block,"label-width":"140px"}},[a("el-form-item",{attrs:{label:"系统功能名称",prop:"pluginInfo.pluginName",rules:e.rules.pluginInfo.pluginName}},[a("el-input",{model:{value:e.block.pluginInfo.pluginName,callback:function(t){e.$set(e.block.pluginInfo,"pluginName","string"===typeof t?t.trim():t)},expression:"block.pluginInfo.pluginName"}})],1),"builtIn"===e.block.pluginInfo.pluginParentType?[a("el-form-item",{attrs:{label:"固定刷新时间",prop:"pluginInfo.refreshTime"}},[a("div",{staticClass:"el-input",staticStyle:{"max-width":"400px"}},[a("el-time-picker",{attrs:{format:"HH:mm","value-format":"HH:mm","picker-options":{selectableRange:"00:01:01 - 23:59:59"},placeholder:"选择时间"},model:{value:e.block.pluginInfo.refreshTime,callback:function(t){e.$set(e.block.pluginInfo,"refreshTime",t)},expression:"block.pluginInfo.refreshTime"}})],1)]),a("el-form-item",{attrs:{label:"活动形式",prop:"hasActivity"}},[a("el-radio-group",{on:{change:e.handleChangeActivityFlag},model:{value:e.block.hasActivity,callback:function(t){e.$set(e.block,"hasActivity",t)},expression:"block.hasActivity"}},[a("el-radio",{attrs:{label:0}},[e._v("非活动")]),a("el-radio",{attrs:{label:1}},[e._v("活动")])],1)],1)]:e._e(),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"builtIn"!==e.block.pluginInfo.pluginParentType,expression:"block.pluginInfo.pluginParentType !== 'builtIn'"}],attrs:{label:"类型",prop:"pluginInfo.pluginParentType",rules:e.rules.pluginInfo.pluginParentType}},[a("el-select",{staticClass:"plugin-parent-type-selector",attrs:{value:e.block.pluginInfo.pluginParentType,disabled:"edit"===e.mode,placeholder:"请选择"},on:{input:e.handleChangePluginParentType}},e._l(e.pluginParentTypes,function(e){return a("el-option",{key:e.dictId,attrs:{label:e.dictCnName,value:e.dictEnName}})}),1)],1),"secKill"!==e.pluginParentType?a("el-form-item",{attrs:{label:"内容源",prop:"pluginInfo.source",rules:e.rules.pluginInfo.source}},[a("el-radio-group",{attrs:{value:e.block.pluginInfo.source,disabled:e.isDisabledSource},on:{input:e.handleChangeSource}},e._l(e.$consts.sourceNumberOptions,function(t,i){return a("el-radio",{key:i,attrs:{label:t.value}},[e._v(e._s(t.label))])}),1)],1):e._e(),"sign"===e.pluginParentType?[a("el-form-item",{attrs:{label:"标记推荐位类型",prop:"pluginInfo.pluginType",rules:e.rules.pluginInfo.pluginType}},[a("el-input",{model:{value:e.block.pluginInfo.pluginType,callback:function(t){e.$set(e.block.pluginInfo,"pluginType","string"===typeof t?t.trim():t)},expression:"block.pluginInfo.pluginType"}})],1)]:e._e(),"sign"!==e.pluginParentType&&e.pluginTypes.length>0?a("el-form-item",{attrs:{label:"多功能推荐位类型",prop:"pluginInfo.pluginType",rules:e.rules.pluginInfo.pluginType}},[a("el-select",{staticClass:"plugin-type-selector",staticStyle:{width:"300px","max-width":"300px"},attrs:{value:e.block.pluginInfo.pluginType,placeholder:"请选择"},on:{input:e.handleChangePluginType}},e._l(e.pluginTypes,function(e){return a("el-option",{key:e.dictId,attrs:{label:e.dictCnName,value:e.dictEnName}})}),1)],1):e._e(),e.baseHasTitle?[a("el-form-item",{attrs:{label:"标题",prop:"helper.title",rules:e.rules.title}},[a("el-input",{model:{value:e.block.helper.title,callback:function(t){e.$set(e.block.helper,"title","string"===typeof t?t.trim():t)},expression:"block.helper.title"}})],1),a("el-form-item",{attrs:{label:"副标题",prop:"helper.subTitle",rules:e.rules.subTitle}},[a("el-input",{model:{value:e.block.helper.subTitle,callback:function(t){e.$set(e.block.helper,"subTitle","string"===typeof t?t.trim():t)},expression:"block.helper.subTitle"}})],1)]:e._e(),"sign"!==e.pluginParentType?e._l(e.block.rlsInfo,function(t,i){return a("div",{key:i},[a("div",{staticClass:"form-legend-header"},[a("span",[e._v(e._s(t.label))])]),"builtIn"===e.block.pluginInfo.pluginParentType?[a("el-form-item",{attrs:{label:"状态栏文字",prop:"rlsInfo."+i+".title",rules:e.rules.barText}},[a("el-input",{model:{value:t.title,callback:function(a){e.$set(t,"title","string"===typeof a?a.trim():a)},expression:"item.title"}}),e._v("|\n                  "),a("el-input",{model:{value:t.subTitle,callback:function(a){e.$set(t,"subTitle","string"===typeof a?a.trim():a)},expression:"item.subTitle"}})],1)]:e._e(),e.versionHasTitle?[a("el-form-item",{attrs:{label:"标题",prop:"rlsInfo."+i+".title",rules:e.rules.title}},[a("el-input",{model:{value:t.title,callback:function(a){e.$set(t,"title","string"===typeof a?a.trim():a)},expression:"item.title"}})],1),a("el-form-item",{attrs:{label:"副标题",prop:"rlsInfo."+i+".subTitle",rules:e.rules.subTitle}},[a("el-input",{model:{value:t.subTitle,callback:function(a){e.$set(t,"subTitle","string"===typeof a?a.trim():a)},expression:"item.subTitle"}})],1)]:e._e(),"secKill"===e.block.pluginInfo.pluginParentType?[a("el-form-item",{attrs:{label:"商品ID",prop:"rlsInfo."+i+".goodsId",rules:e.rules.goodsId}},[a("el-input",{model:{value:t.goodsId,callback:function(a){e.$set(t,"goodsId","string"===typeof a?a.trim():a)},expression:"item.goodsId"}})],1),a("el-form-item",{attrs:{label:"商品名称",prop:"rlsInfo."+i+".title",rules:e.rules.goodsId}},[a("el-input",{model:{value:t.title,callback:function(a){e.$set(t,"title","string"===typeof a?a.trim():a)},expression:"item.title"}})],1)]:e._e(),a("el-form-item",{attrs:{label:"海报",prop:"rlsInfo."+i+".poster.pictureUrl",rules:e.rules.poster.pictureUrl}},[a("div",{staticClass:"poster",on:{click:function(t){return e.handleSelectPosterStart(i)}}},[t.poster.pictureUrl?a("img",{staticClass:"poster__img",attrs:{src:t.poster.pictureUrl}}):e._e()])]),"REFERENCE_ACTIVITY"===e.pluginType?[a("el-form-item",{attrs:{label:"异形焦点",prop:"rlsInfo."+i+".extendInfo.focusImgUrl",rules:e.rules.focusImgUrl}},[a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary"},on:{click:function(t){return e.handleSelectFocusImgStart(i)}}},[e._v("选择异形焦点")]),t.extendInfo.focusImgUrl?a("div",{staticClass:"focus-transition"},[a("i",{staticClass:"focus-transition__remove el-icon-circle-close",attrs:{title:"移除异形焦点"},on:{click:function(t){return e.handleRemoveFocusImg(i)}}}),a("img",{staticClass:"focus-transition__img",attrs:{src:t.extendInfo.focusImgUrl}})]):e._e()],1),a("el-form-item",{attrs:{label:"存活时间",prop:"rlsInfo."+i+".extendInfo.aliveTime",rules:e.rules.aliveTime}},[a("div",{staticClass:"el-input",staticStyle:{"max-width":"400px"}},[a("el-time-picker",{attrs:{format:"HH:mm","value-format":"HH:mm","picker-options":{selectableRange:"00:01:00 - 23:59:00"},placeholder:"选择时间"},model:{value:t.extendInfo.aliveTime,callback:function(a){e.$set(t.extendInfo,"aliveTime",a)},expression:"item.extendInfo.aliveTime"}})],1)]),a("el-form-item",{attrs:{label:"点击次数",prop:"rlsInfo."+i+".extendInfo.clickCount",rules:e.rules.clickCount}},[a("el-input",{model:{value:t.extendInfo.clickCount,callback:function(a){e.$set(t.extendInfo,"clickCount",e._n(a))},expression:"item.extendInfo.clickCount"}})],1)]:e._e(),"multi"===e.pluginParentType||"secKill"===e.pluginParentType||"builtIn"===e.pluginParentType?a("el-form-item",{attrs:{label:"打开方式",rules:e.rules.openMode}},[a("el-select",{attrs:{value:t.openMode},on:{input:function(a){return e.handleChangeOpenMode(t,a)}}},[a("el-option",{attrs:{label:"网页",value:"webpage"}}),a("el-option",{attrs:{label:"视频",value:"video"}}),a("el-option",{attrs:{label:"图片",value:"picture"}}),a("el-option",{attrs:{label:"版面",value:"tab"}}),a("el-option",{attrs:{label:"第三方应用",value:"app"}})],1),"app"===t.openMode?a("el-button",{staticClass:"marginL",attrs:{type:"primary",plain:""},on:{click:function(t){return e.handleSelectClickStart(i)}}},[e._v("快速填充")]):e._e()],1):e._e(),"webpage"===t.openMode?[a("el-form-item",{attrs:{label:"网页地址",prop:"rlsInfo."+i+".onclick.webpageUrl",rules:e.rules.webpageUrl}},[a("el-input",{model:{value:t.onclick.webpageUrl,callback:function(a){e.$set(t.onclick,"webpageUrl","string"===typeof a?a.trim():a)},expression:"item.onclick.webpageUrl"}})],1),a("el-form-item",{attrs:{label:"网页类型",prop:"rlsInfo."+i+".onclick.webpageType"}},[a("el-radio-group",{model:{value:t.onclick.webpageType,callback:function(a){e.$set(t.onclick,"webpageType",a)},expression:"item.onclick.webpageType"}},[a("el-radio",{attrs:{label:"1"}},[e._v("浮窗网页")]),a("el-radio",{attrs:{label:"2"}},[e._v("全屏网页")])],1)],1),a("el-form-item",{attrs:{label:"应用版本号",prop:"rlsInfo."+i+".onclick.webpageAppVersion",rules:e.rules.webpageAppVersion}},[a("el-input",{model:{value:t.onclick.webpageAppVersion,callback:function(a){e.$set(t.onclick,"webpageAppVersion","string"===typeof a?a.trim():a)},expression:"item.onclick.webpageAppVersion"}})],1)]:e._e(),"video"===t.openMode?[a("el-form-item",{attrs:{label:"视频名称",prop:"rlsInfo."+i+".onclick.videoName",rules:e.rules.videoName}},[a("el-input",{model:{value:t.onclick.videoName,callback:function(a){e.$set(t.onclick,"videoName","string"===typeof a?a.trim():a)},expression:"item.onclick.videoName"}})],1),a("el-form-item",{attrs:{label:"视频地址",prop:"rlsInfo."+i+".onclick.videoUrl",rules:e.rules.videoUrl}},[a("el-input",{model:{value:t.onclick.videoUrl,callback:function(a){e.$set(t.onclick,"videoUrl","string"===typeof a?a.trim():a)},expression:"item.onclick.videoUrl"}})],1)]:e._e(),"tab"===t.openMode?[a("el-form-item",{attrs:{label:"版面",prop:"rlsInfo."+i+".onclick.tab",rules:e.rules.tab}},[a("TabSelector",{attrs:{selectionType:"single","selected-close":!0,source:e.source},on:{"select-single":function(a){return e.handleSelectTabEnd(a,t)}}}),t.onclick.tab?a("el-tag",{attrs:{type:"primary"}},[e._v("已选择: "+e._s(t.onclick.tab.tabId))]):e._e()],1)]:e._e(),"picture"===t.openMode?[a("el-form-item",{attrs:{label:"选择图片",prop:"rlsInfo."+i+".onclick.picture",rules:e.rules.picture}},[a("el-upload",{attrs:{action:e.urls.uploadImg,"on-success":e.createUploadSuccessHandler(i),"on-remove":e.createUploadRemoveHandler(i),multiple:!1,"file-list":t.onclick.picture,accept:"image/png, image/gif, image/jpeg, image/bmp","list-type":"picture"}},[a("el-button",{attrs:{type:"primary"}},[e._v("点击上传")]),a("span",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("提示:只能上传png/gif/jpg/bmp文件")])],1)],1)]:e._e(),"app"===t.openMode?a("AppParams",{attrs:{"prop-prefix":"rlsInfo."+i+".onclick."},model:{value:t.onclick,callback:function(a){e.$set(t,"onclick",a)},expression:"item.onclick"}}):e._e()],2)}):e._e()],2)],1):e._e(),"read"===e.mode?a("div",[a("el-form",{ref:"blockForm",attrs:{"label-width":"140px"}},[a("el-form-item",{attrs:{label:"系统功能名称",prop:"pluginInfo.pluginName"}},[e._v(e._s(e.block.pluginInfo.pluginName))]),"builtIn"===e.block.pluginInfo.pluginParentType?[a("el-form-item",{attrs:{label:"固定刷新时间",prop:"pluginInfo.refreshTime"}},[e._v(e._s(e.parseMinToStr(e.block.pluginInfo.refreshTime)))]),a("el-form-item",{attrs:{label:"活动形式",prop:"hasActivity"}},[a("el-radio-group",{attrs:{disabled:""},model:{value:e.block.hasActivity,callback:function(t){e.$set(e.block,"hasActivity",t)},expression:"block.hasActivity"}},[a("el-radio",{attrs:{label:0}},[e._v("非活动")]),a("el-radio",{attrs:{label:1}},[e._v("活动")])],1)],1)]:e._e(),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"builtIn"!==e.block.pluginInfo.pluginParentType,expression:"block.pluginInfo.pluginParentType !== 'builtIn'"}],attrs:{label:"类型",prop:"pluginInfo.pluginParentType"}},[e._v(e._s(e.pluginParentTypeText))]),"secKill"!==e.pluginParentType?a("el-form-item",{attrs:{label:"内容源"}},[e._v(e._s(e.$consts.sourceNumberText[e.block.pluginInfo.source]))]):e._e(),"sign"===e.pluginParentType?[a("el-form-item",{attrs:{label:"标记推荐位类型",prop:"pluginInfo.pluginType"}},[e._v(e._s(e.block.pluginInfo.pluginType))])]:e._e(),"sign"!==e.pluginParentType&&e.pluginTypes.length>0&&e.pluginTypeText?a("el-form-item",{attrs:{label:"多功能推荐位类型",prop:"pluginInfo.pluginType"}},[e._v(e._s(e.pluginTypeText))]):e._e(),e.baseHasTitle?[a("el-form-item",{attrs:{label:"标题",prop:"helper.title"}},[e._v(e._s(e.block.helper.title))]),a("el-form-item",{attrs:{label:"副标题",prop:"helper.subTitle"}},[e._v(e._s(e.block.helper.subTitle))])]:e._e(),"sign"!==e.pluginParentType?e._l(e.block.rlsInfo,function(t,i){return a("div",{key:i},[a("div",{staticClass:"form-legend-header"},[a("span",[e._v(e._s(t.label))])]),e.versionHasTitle?[a("el-form-item",{attrs:{label:"标题"}},[e._v(e._s(t.title))]),a("el-form-item",{attrs:{label:"副标题"}},[e._v(e._s(t.subTitle))])]:e._e(),"builtIn"===e.block.pluginInfo.pluginParentType?[a("el-form-item",{attrs:{label:"状态栏文字"}},[e._v(e._s(t.title)+" "+e._s(t.subTitle?" | "+t.subTitle:""))])]:e._e(),"secKill"===e.block.pluginInfo.pluginParentType?[a("el-form-item",{attrs:{label:"商品ID"}},[e._v(e._s(t.goodsId))]),a("el-form-item",{attrs:{label:"商品名称"}},[e._v(e._s(t.title))])]:e._e(),a("el-form-item",{attrs:{label:"海报"}},[a("div",{staticClass:"poster"},[t.poster.pictureUrl?a("img",{staticClass:"poster__img",attrs:{src:t.poster.pictureUrl}}):e._e()])]),"REFERENCE_ACTIVITY"===e.pluginType?[a("el-form-item",{attrs:{label:"异形焦点"}},[t.extendInfo.focusImgUrl?a("div",{staticClass:"focus-transition"},[a("img",{staticClass:"focus-transition__img",attrs:{src:t.extendInfo.focusImgUrl}})]):a("span",[e._v("无")])]),a("el-form-item",{attrs:{label:"存活时间"}},[e._v(e._s(e.parseMinToStr(t.extendInfo.aliveTime)))]),a("el-form-item",{attrs:{label:"点击次数"}},[e._v(e._s(t.extendInfo.clickCount))])]:e._e(),"multi"===e.pluginParentType||"secKill"===e.pluginParentType?a("el-form-item",{attrs:{label:"打开方式"}},[e._v(e._s(e.OPEN_MODE_TEXT[t.openMode]))]):e._e(),"webpage"===t.openMode?[a("el-form-item",{attrs:{label:"网页地址"}},[e._v(e._s(t.onclick.webpageUrl))]),a("el-form-item",{attrs:{label:"网页类型"}},[e._v(e._s(["","浮窗网页","全屏网页"][+t.onclick.webpageType]))]),a("el-form-item",{attrs:{label:"应用版本号"}},[e._v(e._s(t.onclick.webpageAppVersion))])]:e._e(),"video"===t.openMode?[a("el-form-item",{attrs:{label:"视频名称"}},[e._v(e._s(t.onclick.videoName))]),a("el-form-item",{attrs:{label:"视频地址"}},[e._v(e._s(t.onclick.videoUrl))])]:e._e(),"picture"===t.openMode?[a("el-form-item",{attrs:{label:"图片"}},[a("div",{staticClass:"open-picture"},[a("img",{staticClass:"open-picture__img",attrs:{src:t.onclick.picture[0].url}})])])]:e._e(),"tab"===t.openMode?[a("el-form-item",{attrs:{label:"版面"}},[e._v(e._s(t.onclick.tab.tabId))])]:e._e(),"app"===t.openMode?a("AppParamsRead",{attrs:{"label-width":"140px"},model:{value:t.onclick,callback:function(a){e.$set(t,"onclick",a)},expression:"item.onclick"}}):e._e()],2)}):e._e()],2)],1):e._e(),a("el-dialog",{attrs:{visible:e.dialogTableVisible,width:"1200px"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[e.dialogTableVisible?a("selectResource",{on:{selected:e.getSelectResource}}):e._e(),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogTableVisible=!1}}},[e._v("取 消")])],1)],1),a("el-dialog",{attrs:{visible:e.dialogClickTableVisible,width:"1200px"},on:{"update:visible":function(t){e.dialogClickTableVisible=t}}},[a("selectClick",{on:{"row-click":e.getClickData}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogClickTableVisible=!1}}},[e._v("取 消")])],1)],1),a("el-dialog",{attrs:{visible:e.showFocusImgSelectorVisible,width:"1200px"},on:{"update:visible":function(t){e.showFocusImgSelectorVisible=t}}},[a("selectImg",{on:{selectImg:e.getSelectImg}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showFocusImgSelectorVisible=!1}}},[e._v("取 消")])],1)],1)],1)],1)])},Ic=[],Cc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("el-form-item",{attrs:{label:"应用包名",prop:e.formProp("packagename"),rules:e.rules.packagename}},[a("el-input",{model:{value:e.inputValue.packagename,callback:function(t){e.$set(e.inputValue,"packagename","string"===typeof t?t.trim():t)},expression:"inputValue.packagename"}})],1),a("el-form-item",{attrs:{label:"应用版本号",prop:e.formProp("versioncode"),rules:e.rules.versioncode}},[a("el-input",{model:{value:e.inputValue.versioncode,callback:function(t){e.$set(e.inputValue,"versioncode","string"===typeof t?t.trim():t)},expression:"inputValue.versioncode"}})],1),a("el-form-item",{attrs:{label:"启动动作",prop:e.formProp("dowhat"),rules:e.rules.dowhat}},[a("el-select",{model:{value:e.inputValue.dowhat,callback:function(t){e.$set(e.inputValue,"dowhat",t)},expression:"inputValue.dowhat"}},[a("el-option",{attrs:{label:"startActivity",value:"startActivity"}}),a("el-option",{attrs:{label:"startService",value:"startService"}}),a("el-option",{attrs:{label:"sendBroadcast",value:"sendBroadcast"}})],1)],1),a("el-form-item",{attrs:{label:"启动方式",prop:e.formProp("bywhat"),rules:e.rules.bywhat}},[a("el-select",{model:{value:e.inputValue.bywhat,callback:function(t){e.$set(e.inputValue,"bywhat",t)},expression:"inputValue.bywhat"}},[a("el-option",{attrs:{label:"action",value:"action"}}),a("el-option",{attrs:{label:"class",value:"class"}}),a("el-option",{attrs:{label:"uri",value:"uri"}}),a("el-option",{attrs:{label:"activity",value:"activity"}})],1)],1),a("el-form-item",{attrs:{label:"启动参数",prop:e.formProp("byvalue"),rules:e.rules.byvalue}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.inputValue.byvalue,callback:function(t){e.$set(e.inputValue,"byvalue","string"===typeof t?t.trim():t)},expression:"inputValue.byvalue"}})],1),a("el-form-item",{attrs:{label:"扩展参数"}},[e._l(e.inputValue.params,function(t,i){return a("div",{key:i,staticClass:"app-extend-params"},[a("el-form-item",{attrs:{label:"key:","label-width":"60px",prop:e.formProp("params."+i+".key"),rules:e.rules.params.key}},[a("el-input",{model:{value:t.key,callback:function(a){e.$set(t,"key","string"===typeof a?a.trim():a)},expression:"param.key"}})],1),a("el-form-item",{attrs:{label:"value:","label-width":"60px",prop:e.formProp("params."+i+".value"),rules:e.rules.params.value}},[a("el-input",{model:{value:t.value,callback:function(a){e.$set(t,"value","string"===typeof a?a.trim():a)},expression:"param.value"}})],1),a("a",{staticClass:"app-params__remove-param",on:{click:function(t){return e.handleRemoveParam(i)}}},[a("i",{staticClass:"el-icon-minus"})])],1)}),a("el-button",{attrs:{type:"primary"},on:{click:e.handleAddParam}},[a("i",{staticClass:"el-icon-plus"}),e._v(" 添加\n        ")])],2)],1)},Tc=[],Sc={data:function(){function e(e,t,a){/[！￥……（）——【】：；“”‘’、《》，。？\s+]/.test(t)?a(new Error("请勿输入特殊或空白字符")):a()}return{inputValue:{packagename:void 0,versioncode:void 0,dowhat:void 0,bywhat:void 0,byvalue:void 0,params:[],exception:{}},rules:{packagename:[{required:!0,message:"请输入应用包名",trigger:"blur"}],versioncode:[{required:!0,message:"请输入应用版本号",trigger:"blur"}],dowhat:[{required:!0,message:"请选择启动动作",trigger:"blur"}],bywhat:[{required:!0,message:"请选择启动方式",trigger:"blur"}],byvalue:[{required:!0,message:"请输入启动参数",trigger:"blur"}],params:{key:[{required:!0,message:"不能为空",trigger:"blur"},{validator:e,trigger:"blur"}],value:[{required:!0,message:"不能为空",trigger:"blur"},{validator:e,trigger:"blur"}]}}}},props:["value","label-width","propPrefix"],watch:{value:"setInputValue"},methods:{formProp:function(e){return(this.propPrefix||"")+e},genDefaultValue:function(){return{packagename:void 0,versioncode:void 0,dowhat:void 0,bywhat:void 0,byvalue:void 0,params:[]}},setInputValue:function(e){e!==this.inputValue&&(this.inputValue=Object.assign(this.genDefaultValue(),e))},emitInputValue:function(e){this.$emit("input",this.inputValue)},handleAddParam:function(){this.inputValue.params.push({key:void 0,value:void 0})},handleRemoveParam:function(e){this.inputValue.params.splice(e,1)}},created:function(){this.value&&this.setInputValue(this.value),this.$watch("inputValue",this.emitInputValue,{deep:!0})}},kc=Sc,_c=(a("e9bb"),Object(Bn["a"])(kc,Cc,Tc,!1,null,"5b28da52",null)),Pc=_c.exports,xc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-time-select",{attrs:{"picker-options":{start:"00:00",step:"00:10",end:"24:00"},placeholder:"选择时间"},on:{change:e.handle},model:{value:e.value1,callback:function(t){e.value1=t},expression:"value1"}})},Dc=[],Fc={data:function(){return{value1:"",time:""}},methods:{parseStrToMin:function(e){var t=e.split(":"),a=parseInt(t[0]),i=parseInt(t[1]);return 60*a+i},handle:function(){void 0!=this.value1&&(this.time=this.parseStrToMin(this.value1),this.$emit("input",this.time))}}},$c=Fc,Lc=Object(Bn["a"])($c,xc,Dc,!1,null,null,null),Rc=Lc.exports,Nc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("CardList",{attrs:{data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType},on:{"row-selection-change":e.handleRowSelectionChange},scopedSlots:e._u([{key:"row",fn:function(t){var i=t.row;return a("div",{staticClass:"box-list"},[a("p",{staticClass:"list-p"},[a("img",{staticClass:"list-img",attrs:{src:i.pictureUrl,alt:""},on:{click:function(t){return e.reviewPic(i.pictureUrl)}}})]),a("p",{staticClass:"list-title"},[e._v(" "+e._s(i.pictureName))]),a("p",{staticStyle:{margin:"0"}},[1==i.pictureStatus?a("span",[e._v("审核通过")]):a("span",[e._v("待审核")]),a("span",[e._v(" "+e._s(i.pictureResolution))])])])}}])}),a("el-dialog",{attrs:{title:"预览图片",visible:e.picDialogVisible,"append-to-body":""},on:{"update:visible":function(t){e.picDialogVisible=t}}},[a("span",{staticClass:"pics"},[a("img",{staticStyle:{width:"50%"},attrs:{src:e.reviewPicUrl,alt:"图片"}})])])],1)],1)},Ec=[],Oc={components:{Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"],CardList:Dn["CardList"]},data:function(){var e=this;return{materialTypes:{},pictureStatus:{"审核通过":1,"待审核":2},picDialogVisible:!1,auditDialogVisible:!1,reviewPicUrl:null,filter:{sort:void 0,order:void 0},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"pictureId",width:"70"},{label:"ID",prop:"pictureUrl",width:"70",render:function(t,a){var i=a.row;return t("img",{attrs:{src:i.pictureUrl,width:"50px",height:"50px",class:"imgs"},on:{click:function(){e.reviewPic(i)}}})}},{label:"素材名称",width:"120",prop:"pictureName",sortable:!0},{label:"分辨率",prop:"pictureResolution",width:"110",sortable:!0},{label:"状态",prop:"pictureStatus",width:"90",render:function(e,t){var a=t.row;switch(a.pictureStatus){case 0:return"不可用";case 1:return"可用";case 2:return"待审核";case 3:return"审核不通过"}}},{label:"素材类型",prop:"materialTypes",width:"70",render:function(e,t){var a=t.row;return a.materialTypes.length>0?a.materialTypes[0].dictCnName:""}},{label:"创建时间",prop:"createdDate",sortable:!0},{label:"修改时间",prop:"lastUpdateDate",sortable:!0},{label:"操作",width:"200",fixed:"right",render:Dn["utils"].component.createOperationRender(this,{editData:"编辑"})}],data:[],selected:void 0,selectionType:"single"}}},methods:{reviewPic:function(e){this.reviewPicUrl=e,this.picDialogVisible=!0},handleRowSelectionChange:function(e,t){console.log(e),this.$emit("selected",e);this.table.selected=t},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.pictureId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();this.$service.getResourceList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows,console.log(t)})},getMaterialTypes:function(){var e=this;return this.$service.getDictType({type:"materialType"}).then(function(t){t.forEach(function(t){e.materialTypes[t.dictCnName]=t.dictId})})}},created:function(){var e=this,t=co.a.map({pictureId:co.a.o.string.other("form",{placeholder:"ID",component:"Input"}),pictureName:co.a.o.string.other("form",{placeholder:"名称",component:"Input"}),pictureCategory:co.a.o.enum(this.materialTypes).other("form",{placeholder:"素材类别",component:"Select"}),pictureStatus:co.a.o.enum(this.pictureStatus).other("form",{placeholder:"状态",component:"Select"})}).other("form",{cols:{item:5,label:0,wrapper:18},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.getMaterialTypes().then(function(){e.filterSchema=t}),this.fetchData()}},Ac=Oc,Vc=(a("0255"),Object(Bn["a"])(Ac,Nc,Ec,!1,null,"128d2100",null)),Mc=Vc.exports,Bc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("remote-selector-wrapper",{ref:"dialog",staticClass:"cc-tab-selector",attrs:{title:e.title||"选择版面",disabled:e.disabled,"hide-submit":e.selectedClose},on:{"select-start":e.handleSelectStart,"select-end":e.handleSelectEnd}},[a("div",{attrs:{slot:"filter"},slot:"filter"},[a("el-form",{staticClass:"searchform",attrs:{inline:!0}},[a("el-form-item",{staticClass:"el-col el-col-6"},[a("el-input",{attrs:{placeholder:"ID",title:"ID"},model:{value:e.filter.tabId,callback:function(t){e.$set(e.filter,"tabId",t)},expression:"filter.tabId"}})],1),a("el-form-item",{staticClass:"el-col el-col-6"},[a("el-input",{attrs:{placeholder:"版面名称",title:"版面名称"},model:{value:e.filter.tabName,callback:function(t){e.$set(e.filter,"tabName",t)},expression:"filter.tabName"}})],1),a("el-form-item",{staticClass:"el-col el-col-6"},[a("el-select",{attrs:{clearable:!0,placeholder:"版面分类",title:"版面分类"},model:{value:e.filter.tabCategory,callback:function(t){e.$set(e.filter,"tabCategory",t)},expression:"filter.tabCategory"}},e._l(e.tabCategoryOptions,function(e,t){return a("el-option",{key:t,attrs:{value:e.dictId,label:e.dictCnName}})}),1)],1),a("el-form-item",{staticClass:"el-col el-col-6",attrs:{clearable:!0}},[a("el-select",{attrs:{placeholder:"版面属性",title:"版面属性"},model:{value:e.filter.tabType,callback:function(t){e.$set(e.filter,"tabType",t)},expression:"filter.tabType"}},e._l(e.tabTypeOptions,function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})}),1)],1),a("el-form-item",{staticClass:"el-col el-col-6"},[a("el-select",{attrs:{clearable:!0,placeholder:"审核状态",title:"审核状态"},model:{value:e.filter.tabStatusArray,callback:function(t){e.$set(e.filter,"tabStatusArray",t)},expression:"filter.tabStatusArray"}},e._l(e.tabStatusOptions,function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})}),1)],1),void 0===e.source?a("el-form-item",{staticClass:"el-col el-col-6"},[a("SourceSelector",{attrs:{placeholder:"内容源",title:"内容源"},model:{value:e.filter.tabResource,callback:function(t){e.$set(e.filter,"tabResource",t)},expression:"filter.tabResource"}})],1):e._e(),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"10"!=e.$consts.idPrefix,expression:"$consts.idPrefix != '10'"}],staticClass:"el-col el-col-6"},[a("el-select",{attrs:{placeholder:"数据来源",title:"数据来源"},model:{value:e.filter.idPrefix,callback:function(t){e.$set(e.filter,"idPrefix",t)},expression:"filter.idPrefix"}},e._l(e.$consts.idPrefixOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{staticClass:"el-form-item-submit"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{on:{click:e.handleFilterReset}},[e._v("重置")])],1)],1)],1),a("Table",{attrs:{slot:"item-list",data:e.table.data,header:e.table.header,selected:e.table.selected,props:e.table.props,"selection-type":e.selectionType||e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-change":e.handleSingleRow,"row-selection-add":e.handleTableRowSelectionAdd,"row-selection-remove":e.handleTableRowSelectionRemove,"all-row-selection-change":e.handleTableAllRowSelectionChange},slot:"item-list"}),a("el-pagination",{attrs:{slot:"pagination","current-page":e.pagination.currentPage,"page-sizes":[15,20,30],"page-size":e.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pagination.total},on:{"size-change":function(t){e.pagination.pageSize=t},"current-change":function(t){e.pagination.currentPage=t}},slot:"pagination"})],1)},Uc=[],jc="tabId",Gc={components:{Table:Dn["Table"],RemoteSelectorWrapper:Qo,SourceSelector:xr},data:function(){return{tabTypeOptions:[{label:"普通版面",value:"1"},{label:"专题版面",value:"2"}],tabTypeIndexed:{1:"普通版面",2:"专题版面"},tabCategoryOptions:[],tabCategoryOptionsIndexed:{},tabStatusOptions:[{label:"待审核",value:3},{label:"审核通过",value:4}],tabResourceOptions:[{label:"腾讯",value:"o_tencent"},{label:"爱奇艺",value:"o_iqiyi"}],tabStatusOptionsIndexed:{3:"待审核",4:"审核通过"},pagination:{currentPage:1,pageSize:15,total:void 0},filter:this.getDefaultFilter(),table:{data:[],selected:[],header:[{label:"ID",prop:"tabId",width:120},{label:"名称",prop:"tabName","show-overflow-tooltip":!0,width:200},{label:"版面属性",width:120,render:function(e,t){return this.tabTypeIndexed[t.row.tabType]}.bind(this)},{label:"版面分类",width:150,render:function(e,t){return this.tabCategoryOptionsIndexed[t.row.tabCategory]}.bind(this)},{label:"状态",render:function(e,t){return this.tabStatusOptionsIndexed[t.row.tabStatus]}.bind(this)},{prop:"lastUpdateDate",label:"更新时间",width:190},{prop:"modifierName",label:"更新人",width:120}],selectionType:"multiple",props:{"tooltip-effect":"dark"}},selected:[]}},props:["title","isLive","initSelected","source","hasSubTab","selectionType","disabled","selectedClose"],watch:{initSelected:"setSelected","pagination.currentPage":"fetchData","pagination.pageSize":"fetchData","table.data":"updateTableSelected"},methods:{handleSingleRow:function(e,t){this.$refs.dialog.showDialog=!1,this.table.selected=t,this.$emit("select-single",e)},setSelected:function(){this.selected=this.initSelected||[]},handleSelectStart:function(){this.$emit("select-start"),this.isLive||(this.table.data=[],this.selected=[],this.table.selected=[],this.handleFilterReset())},handleSelectEnd:function(){this.$emit("select-end",this.selected.slice())},getDefaultFilter:function(){var e=this.$consts.idPrefix;return{idPrefix:"10"!=e?e:void 0,tabId:void 0,tabName:void 0,tabCategory:void 0,tabType:void 0,tabStatusArray:void 0,tabResource:void 0}},handleFilterChange:function(){this.$validateId(this.filter.tabId)&&(this.pagination.currentPage=1,this.fetchData())},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.pagination.currentPage=1,this.handleFilterChange()},getFilter:function(){var e=JSON.parse(JSON.stringify(this.filter)),t=this.pagination;return e.page=t.currentPage,e.rows=t.pageSize,e.tabStatusArray||(e.tabStatusArray="3,4"),void 0!==this.hasSubTab&&(e.hasSubTab=this.hasSubTab),this.source&&(e.tabResource=this.source),e},fetchData:function(){var e=this;this.$service.tabInfoList(this.getFilter()).then(function(t){e.table.data=t.rows,e.pagination.total=t.total})},handleTableRowSelectionChange:function(e,t){this.selected=[e],this.table.selected=t},handleTableRowSelectionAdd:function(e){this.selected=this.selected.concat(e),this.updateTableSelected()},handleTableRowSelectionRemove:function(e){this.selected=this.selected.filter(function(t){return t[jc]!==e[jc]}),this.updateTableSelected()},handleTableAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleTableRowSelectionAdd):this.table.data.forEach(this.handleTableRowSelectionRemove)},updateTableSelected:function(){var e=this.table,t=this.selected.map(function(e){return e[jc]});e.selected=e.data.reduce(function(e,a,i){return t.indexOf(a[jc])>-1&&e.push(i),e},[])}},created:function(){var e=this;this.$service.getDictType({type:"businessType"}).then(function(t){e.tabCategoryOptions=t,e.tabCategoryOptionsIndexed=t.reduce(function(e,t){return e[t.dictId]=t.dictCnName,e},{})})}},Wc=Gc,qc=(a("bd60"),Object(Bn["a"])(Wc,Bc,Uc,!1,null,"40cfc244",null)),Hc=qc.exports,zc=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("CardList",{attrs:{data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType},on:{"row-selection-change":e.handleRowSelectionChange},scopedSlots:e._u([{key:"row",fn:function(t){var i=t.row;return a("div",{staticClass:"box-list"},[a("p",{staticClass:"list-p"},[a("img",{staticClass:"list-img",attrs:{src:i.pictureUrl,alt:""},on:{click:function(t){return e.reviewPic(i.pictureUrl)}}})]),a("p",{staticClass:"list-title"},[e._v(" "+e._s(i.pictureName))]),a("p",{staticStyle:{margin:"0"}},[1==i.pictureStatus?a("span",[e._v("审核通过")]):a("span",[e._v("待审核")]),a("span",[e._v(" "+e._s(i.pictureResolution))])])])}}])}),a("el-dialog",{attrs:{title:"预览图片",visible:e.picDialogVisible,"append-to-body":""},on:{"update:visible":function(t){e.picDialogVisible=t}}},[a("span",{staticClass:"pics"},[a("img",{staticStyle:{width:"50%"},attrs:{src:e.reviewPicUrl,alt:"图片"}})])])],1)],1)},Jc=[],Kc={components:{Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"],CardList:Dn["CardList"]},data:function(){var e=this;return{materialTypes:{},pictureStatus:{"审核通过":1,"待审核":2},picDialogVisible:!1,auditDialogVisible:!1,reviewPicUrl:null,filter:{sort:void 0,order:void 0},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"pictureId",width:"70"},{label:"ID",prop:"pictureUrl",width:"70",render:function(t,a){var i=a.row;return t("img",{attrs:{src:i.pictureUrl,width:"50px",height:"50px",class:"imgs"},on:{click:function(){e.reviewPic(i)}}})}},{label:"素材名称",width:"120",prop:"pictureName",sortable:!0},{label:"分辨率",prop:"pictureResolution",width:"110",sortable:!0},{label:"状态",prop:"pictureStatus",width:"90",render:function(e,t){var a=t.row;switch(a.pictureStatus){case 0:return"不可用";case 1:return"可用";case 2:return"待审核";case 3:return"审核不通过"}}},{label:"素材类型",prop:"materialTypes",width:"70",render:function(e,t){var a=t.row;return a.materialTypes.length>0?a.materialTypes[0].dictCnName:""}},{label:"创建时间",prop:"createdDate",sortable:!0},{label:"修改时间",prop:"lastUpdateDate",sortable:!0},{label:"操作",width:"200",fixed:"right",render:Dn["utils"].component.createOperationRender(this,{editData:"编辑"})}],data:[],selected:void 0,selectionType:"single"}}},methods:{reviewPic:function(e){this.reviewPicUrl=e,this.picDialogVisible=!0},handleRowSelectionChange:function(e,t){console.log(e),this.$emit("selectImg",e);this.table.selected=t},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.pictureId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();this.$service.getResourceList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows,console.log(t)})},getMaterialTypes:function(){var e=this;return this.$service.getDictType({type:"materialType"}).then(function(t){t.forEach(function(t){e.materialTypes[t.dictCnName]=t.dictId})})}},created:function(){var e=this,t=co.a.map({pictureId:co.a.o.string.other("form",{component:"Input",placeholder:"ID",cols:{item:3,label:0}}),pictureName:co.a.o.string.other("form",{component:"Input",placeholder:"素材名称",cols:{item:3,label:0}}),pictureCategory:co.a.o.enum(this.materialTypes).other("form",{component:"Select",placeholder:"素材类别",cols:{item:3,label:0}}),pictureStatus:co.a.o.enum(this.pictureStatus).other("form",{component:"Select",placeholder:"审核状态",cols:{item:3,label:0}})}).other("form",{layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.getMaterialTypes().then(function(){e.filterSchema=t}),this.fetchData()}},Qc=Kc,Xc=(a("0220"),Object(Bn["a"])(Qc,zc,Jc,!1,null,"b11eaa70",null)),Yc=Xc.exports,Zc={sign:"sign",multi:"multi",builtIn:"builtIn",secKill:"secKill"},eu={webpage:"网页",app:"第三方应用",video:"视频",tab:"版面",picture:"图片"};window.basicFn={};var tu,au,iu={components:{ccAppParamsForm:Pc,ccTimeSpinner:Rc,selectResource:Mc,selectClick:ds,selectImg:Yc,AppParams:zs,AppParamsRead:Zs,TabSelector:Hc,CommonContent:Us},props:["id","initMode","version"],data:function(){var e;return e={OPEN_MODE_TEXT:eu,title:null,mode:"create",dialogTableVisible:!1,dialogClickTableVisible:!1,showFocusImgSelectorVisible:!1,clickData:{},selectResource:{},selectImgData:{},urls:{uploadImg:"api/v1/upload/image.html"},PARENT_TYPES:Zc},Object(ei["a"])(e,"mode","create"),Object(ei["a"])(e,"pluginParentTypes",[]),Object(ei["a"])(e,"pluginTypes",[]),Object(ei["a"])(e,"pluginVersions",{}),Object(ei["a"])(e,"selectingPostForIndex",void 0),Object(ei["a"])(e,"selectingClickForIndex",void 0),Object(ei["a"])(e,"showTabSelector",!1),Object(ei["a"])(e,"selectingTabForIndex",void 0),Object(ei["a"])(e,"selectingFocusImgForIndex",void 0),Object(ei["a"])(e,"block",{helper:{title:void 0,subTitle:void 0,webpageUrl:void 0,webpageType:"1",webpageAppVersion:void 0},pluginInfo:{pluginId:void 0,pluginName:"",pluginParentType:void 0,source:0,channel:"",pluginType:void 0,enableEdit:1,pluginStatus:void 0,currentVersion:void 0,refreshTime:""},rlsInfo:[],hasActivity:0}),Object(ei["a"])(e,"rules",{pluginInfo:{pluginName:[{required:!0,message:"请输入系统功能名称",trigger:"blur"},{max:45,message:"不超过 45 个字符",trigger:"blur"}],pluginParentType:[{required:!0,message:"请选择类型",trigger:"blur"}],pluginType:[{required:!0,message:"不能为空",trigger:"blur"}]},barText:[{max:45,message:"不超过 45 个字符",trigger:"blur"}],title:[{required:!0,message:"请输入标题",trigger:"blur"},{max:45,message:"不超过 45 个字符",trigger:"blur"}],subTitle:[{max:100,message:"不超过 100 个字符",trigger:"blur"}],openMode:[{required:!0,message:"请选择打开方式",trigger:"blur"}],goodsId:[{required:!0,message:"请填写商品ID",trigger:"blur"},{max:45,message:"不超过 45 个字符",trigger:"blur"}],webpageUrl:[{required:!0,message:"请填写网页地址",trigger:"blur"}],webpageAppVersion:[{required:!0,message:"请填写应用版本号",trigger:"blur"}],videoName:[{required:!0,message:"请填写视频名称",trigger:"blur"}],videoUrl:[{required:!0,message:"请填写视频地址",trigger:"blur"}],picture:[{trigger:"change",validator:function(e,t,a){a(t&&t.length>0?void 0:new Error("请上传图片"))}},{required:!0,message:"请上传图片"}],tab:[{trigger:"change",validator:function(e,t,a){a(t?void 0:new Error("请选择版面"))}},{required:!0,message:"请选择版面"}],clickCount:[{required:!0,message:"请填入点击次数"},{type:"number",message:"请填入数字"},{validator:function(e,t,a){/^[1-9][0-9]*$/.test(t)?a():a(new Error("请输入正整数"))}}],aliveTime:[{required:!0,message:"请填入存活时间"}],focusImgUrl:[{required:!0,message:"请选择异形焦点"}],poster:{pictureUrl:[{required:!0,message:"请选择海报",trigger:"blur"}]}}),e},computed:{source:function(){switch(this.block.pluginInfo.source){case 0:return"";case 1:return"o_tencent";case 2:return"o_iqiyi";case 3:return"o_youku"}},pluginTypeText:function(){var e=this.pluginType,t=this.pluginTypes;if(console.log(e),console.log(t),t.length>0){var a=t.find(function(t){return t.dictEnName===e});if(a)return a.dictCnName}},pluginParentTypeText:function(){var e=this.pluginParentType,t=this.pluginParentTypes;if(t.length>0){var a=t.find(function(t){return t.dictEnName===e});if(a)return a.dictCnName}},resourceInfo:function(){var e=this.block.pluginInfo;if(e.pluginId)return{id:e.pluginId,type:"systemPlugin",menuElId:"multiFunctionBlock",version:e.currentVersion,status:e.pluginStatus}},pluginParentType:function(){return this.block.pluginInfo.pluginParentType},pluginType:function(){return this.block.pluginInfo.pluginType},isDisabledSource:function(){return"edit"===this.mode},versionHasTitle:function(){this.pluginParentType;var e=this.pluginType;return"REFERENCE_MOVIE_VIP"===e},baseHasTitle:function(){var e=this.pluginParentType,t=this.pluginType;return"secKill"!==e&&"builtIn"!==e&&t&&"REFERENCE_MOVIE_VIP"!==t}},watch:{},methods:{handleSelectTabEnd:function(e,t){this.$set(t.onclick,"tab",e)},parseMinToStr:function(e){if(void 0!==e){var t=e.split(":"),a=parseInt(t[0]),i=parseInt(t[1]);return 60*a+i}},parseStrToMin:function(e){var t=Math.floor(e/60),a=e%60,i=t>9?""+t:"0"+t,n=a>9?""+a:"0"+a;return i+":"+n},fetchData:function(e){var t=this;this.$service.editSysPlugin({id:this.id,version:e}).then(function(e){e&&(t.setData(e),t.pluginType&&t.getPluginVersions(t.pluginType).then(function(e){if(e){var t=this.block.rlsInfo,a=t.reduce(function(e,t){return e[t.dataType]=t,e},{});this.block.rlsInfo=e.reduce(function(e,t){var i=a[t.dictEnName];return i&&(this.$set(i,"label",t.dictCnName),e.push(i)),e}.bind(this),[])}}.bind(t)))})},getPluginParentTypes:function(){var e=this;this.$service.getPluginParentTypes().then(function(t){t&&(e.pluginParentTypes=t.filter(function(e){return"builtIn"!==e.dictEnName}))})},getPluginTypes:function(e){var t=this;this.$service.getPluginTypes({pluginParentType:e}).then(function(e){e&&(t.pluginTypes=e)})},handleTime:function(){},handleTime1:function(){},getPluginVersions:function(e){var t=this,a=this.pluginVersions;return new Promise(function(i,n){a[e]?i(a[e]):t.$service.getPluginVersions(e).then(function(t){console.log(t),t&&(a[e]=t,i(a[e]))})})},handleChangeSource:function(e){this.$confirm("确定切换内容源？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){this.$refs["blockForm"].clearValidate(),this.block.pluginInfo.source=e}.bind(this)).catch(function(e){throw e})},handleChangePluginParentType:function(e){this.$refs["blockForm"].clearValidate();var t=this.block.pluginInfo.pluginParentType,a=function(){this.pluginTypes=[],this.setPluginParentType(e),this.getPluginTypes(e),"secKill"===e&&this.setPluginType("REFERENCE_MALL_SECKILL")}.bind(this);t&&t!==e?this.$confirm("切换类型将清空版本等相关数据，确定切换？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(a).catch(function(e){throw e}):t||a()},setPluginParentType:function(e){this.PARENT_TYPES;var t=this.block,a=t.pluginInfo,i=t.helper;t.rlsInfo=[],a.source=0,a.pluginType=void 0,a.pluginParentType=e,i.title="",i.subTitle=""},handleChangePluginType:function(e){this.$refs["blockForm"].clearValidate();var t=this.block.pluginInfo.pluginType,a=function(){this.setPluginType(e)}.bind(this);t&&t!==e?this.$confirm("切换类型将清空版本等相关数据，确定切换？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(a).catch(function(){}):t||a()},setPluginType:function(e){var t=this.block,a=t.helper;this.getPluginVersions(e).then(function(i){t.pluginInfo.pluginType=e,a.title="",a.subTitle="",t.rlsInfo=i.map(function(t){return this.genRlsInfo({label:t.dictCnName,dataType:+t.dictEnName},e)}.bind(this))}.bind(this)).then(function(){})},genRlsInfo:function(e,t){var a={};return"REFERENCE_ACTIVITY"===t&&(a={focusImgUrl:void 0,aliveTime:"",clickCount:5}),Object.assign({openMode:"app",pluginDataId:void 0,dataType:5,onclick:{},params:0,title:"",subTitle:"",goodsId:void 0,webpageUrl:void 0,poster:{pictureId:void 0,pictureUrl:void 0}},{extendInfo:a},e)},handleSelectPosterStart:function(e){this.selectingPostForIndex=e,this.dialogTableVisible=!0},handleSelectClickStart:function(e){this.selectingClickForIndex=e,this.dialogClickTableVisible=!0},handleSelectTabStart:function(e){this.showTabSelector=!0,this.selectingTabForIndex=e},handleSelectFocusImgStart:function(e){this.showFocusImgSelectorVisible=!0,this.selectingFocusImgForIndex=e},handleRemoveFocusImg:function(e){this.block.rlsInfo[e].extendInfo.focusImgUrl=void 0},createUploadSuccessHandler:function(e){return function(t){if(t.success){var a=this.block.rlsInfo[e];this.$set(a.onclick,"picture",[{name:"已上传",url:t.data[0].url}])}else this.$message(t.msg)}.bind(this)},createUploadRemoveHandler:function(e){return function(){var t=this.block.rlsInfo[e];t.onclick.picture=[]}.bind(this)},parseOnclick:function(e){if(e.params){var t=e.params;e.params=Object.keys(e.params).map(function(e){return{key:e,value:t[e]}})}return e},handleChangeOpenMode:function(e,t){this.$refs["blockForm"].clearValidate(),e.openMode=t,e.onclick="webpage"===t?{webpageType:"1",webpageUrl:void 0,webpageAppVersion:""}:{}},getData:function(e){var t=JSON.parse(JSON.stringify(this.block));return"replicate"===this.mode&&(t.pluginInfo.currentVersion=""),t.pluginInfo.pluginStatus=e,t},validateData:function(e,t){this.$refs.blockForm.validate(function(a){a?t(e):this.$message({type:"error",message:"请把表单填写完整"})}.bind(this))},setData:function(e){var t=this.block.helper,a=JSON.parse(JSON.stringify(e)),i=a.pluginInfo.pluginParentType,n=a.pluginInfo.pluginType;if(a.rlsInfo.forEach(function(e){if(e.openMode=e.params.split(",")[0].split("==")[1],e.onclick){e.onclick=this.parseOnclick(JSON.parse(e.onclick));var t=e.onclick,a=t.params.reduce(function(e,t){return e[t.key]=t.value,e},{});switch(e.openMode){case"webpage":e.onclick={webpageType:"coocaa.intent.action.browser"===t.byvalue?"1":"2",webpageUrl:a.url,webpageAppVersion:t.versioncode};break;case"video":e.onclick={videoName:a.name,videoUrl:a.url};break;case"picture":e.onclick={picture:[{name:"已上传",url:a.url}]};break;case"tab":e.onclick={tab:{tabId:a.id}}}}e.extendInfo=e.extendInfo||{}}.bind(this)),i&&this.getPluginTypes(i),"secKill"!==i&&n&&"REFERENCE_MOVIE_VIP"!==n){var o=a.rlsInfo[0];o&&(t.title=o.title,t.subTitle=o.subTitle)}this.block=Object.assign(this.block,a),this.block.pluginInfo.refreshTime=this.parseStrToMin(this.block.pluginInfo.refreshTime);for(var r=0;r<this.block.rlsInfo.length;r++)this.block.rlsInfo[r].extendInfo.aliveTime=this.parseStrToMin(this.block.rlsInfo[r].extendInfo.aliveTime)},parseData:function(e){var t=e.helper,a=this.baseHasTitle,i=this.pluginParentType;return"sign"===i&&(e.rlsInfo=e.rlsInfo||[],e.rlsInfo[0]=e.rlsInfo[0]||{dataType:5,title:void 0,subTitle:void 0}),e.rlsInfo.forEach(function(e){var i=e.onclick;switch(e.openMode&&(e.params="openMode=="+e.openMode),e.openMode){case"webpage":"1"===i.webpageType?e.onclick={packagename:"com.coocaa.app_browser",versioncode:i.webpageAppVersion,dowhat:"startActivity",bywhat:"action",byvalue:"coocaa.intent.action.browser",params:[{key:"url",value:i.webpageUrl}],exception:{}}:"2"===i.webpageType&&(e.onclick={packagename:"com.coocaa.app_browser",versioncode:i.webpageAppVersion,dowhat:"startActivity",bywhat:"action",byvalue:"coocaa.intent.action.browser.no_trans",params:[{key:"url",value:i.webpageUrl}],exception:{}});break;case"video":e.onclick={packagename:"com.tianci.movieplatform",versioncode:"-1",dowhat:"startService",bywhat:"action",byvalue:"coocaa.intent.player.video",params:[{key:"name",value:i.videoName},{key:"url",value:i.videoUrl},{key:"needParse",value:"false"},{key:"url_type",value:"web"}],exception:{}};break;case"picture":e.onclick={packagename:"com.tianci.movieplatform",versioncode:"",dowhat:"startService",bywhat:"action",byvalue:"coocaa.intent.player.image",params:[{key:"name",value:""},{key:"url",value:i.picture[0].url}],exception:{}};break;case"tab":e.params+=",tabType=="+i.tab.tabType,e.onclick={packagename:"com.tianci.movieplatform",versioncode:"",dowhat:"startActivity",bywhat:"action",byvalue:1==i.tab.tabType?"coocaa.intent.action.HOME_COMMON_LIST":"coocaa.intent.action.HOME_SPECIAL_TOPIC",params:[{key:"id",value:i.tab.tabId}],exception:{}};break;case"app":e.onclick.exception={name:"onclick_exception",value:{packagename:"com.tianci.appstore",dowhat:"startActivity",versioncode:"-1",params:[{key:"id",value:i.packagename}],byvalue:"coocaa.intent.action.APP_STORE_DETAIL",bywhat:"action"}};break}a&&(e.title=t.title,e.subTitle=t.subTitle),e.onclick&&e.onclick.params&&(e.onclick.params=e.onclick.params.reduce(function(e,t){return e[t.key]=t.value,e},{}),e.onclick=JSON.stringify(e.onclick)),delete e.openMode}),delete e.helper,e},handleSubmitAudit:function(e,t){var a=this.getData(t);this.validateData(a,function(){this.submit(a)}.bind(this))},getSelectResource:function(e){this.selectResource=e,this.dialogTableVisible=!1;var t={pictureId:this.selectResource.pictureId,pictureStatus:this.selectResource.pictureStatus,pictureUrl:this.selectResource.pictureUrl};this.block.rlsInfo[this.selectingPostForIndex].poster=t},getClickData1:function(e){this.clickData=e,this.dialogClickTableVisible=!1;var t=this.clickData;t=JSON.parse(t.onlickJson);var a=this.selectingClickForIndex,i=this.block.rlsInfo[a];i.onclick=this.parseOnclick(t),this.showselectClickor=!1,this.selectingClickForIndex=void 0},getClickData:function(e){this.dialogClickTableVisible=!1;var t=JSON.parse(e.params),a=Object.keys(t),i=a.reduce(function(e,a,i){var n={};return n.key=a,n.value=t[a],e.push(n),e},[]),n={packagename:e.packagename,versioncode:e.versioncode,dowhat:e.dowhat,bywhat:e.bywhat,byvalue:e.byvalue,params:i,exception:e.exception},o=this.selectingClickForIndex,r=this.block.rlsInfo[o];r.onclick=n},clickSubmit:function(){},getSelectImg:function(e){this.selectImgData=e,this.showFocusImgSelectorVisible=!1;var t=this.selectingFocusImgForIndex,a=this.block.rlsInfo[t];this.$set(a.extendInfo,"focusImgUrl",this.selectImgData.pictureUrl),this.selectingFocusImgForIndex=void 0},selectImgSubmit:function(){},submit:function(e){this.validateData(e,function(){var t=this;e.pluginInfo.refreshTime=this.parseMinToStr(e.pluginInfo.refreshTime);for(var a=0;a<e.rlsInfo.length;a++)e.rlsInfo[a].extendInfo.aliveTime=this.parseMinToStr(e.rlsInfo[a].extendInfo.aliveTime);e=this.parseData(e),this.$service.SavePlugin(e,"保存成功").then(function(e){t.$emit("upsert-end")})}.bind(this))},handleChangeActivityFlag:function(e){e?this.block.rlsInfo.unshift(this.genRlsInfo({label:"活动形式",dataType:4})):this.block.rlsInfo=this.block.rlsInfo.filter(function(e){return 4!==e.dataType})}},created:function(){switch(this.basicFn=basicFn,this.getPluginParentTypes(),this.mode=this.initMode||"create",this.mode){case"create":this.title="新增";break;case"copy":this.title="复制";break;case"edit":this.title="编辑";break;case"replica":this.title="创建副本";case"read":this.title="预览";break}this.id&&this.fetchData(this.version)}},nu=iu,ou=(a("eb2f"),Object(Bn["a"])(nu,wc,Ic,!1,null,"15b8976b",null)),ru=ou.exports,lu={extends:hc,components:{ResourceList:yc,ResourceContent:ru},data:function(){return{}},computed:{resourceInfo:function(){return{type:"multiFunctionBlock",idField:"pluginId"}}}},su=lu,cu=Object(Bn["a"])(su,tu,au,!1,null,null,null),uu=cu.exports,du=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{ref:"contentCard",staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"sysPlugin"},on:{edit:e.handleEdit}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},pu=[],hu={extends:Po,components:{Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"],ButtonGroupForListPage:Ro},data:function(){var e=this;return{resourceType:"sysPlugin",channel:{"影视":"movie","体育":"sport","教育":"edu","少儿":"child"},filterSchema:null,pagination:{},selected:[],filter:{sort:void 0,order:void 0},table:{props:{},header:[{label:"ID",prop:"pluginId",width:"70"},{label:"功能名称",prop:"pluginName",render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(i)}}},i.pluginName)}},{label:"待审核的版本",prop:"duplicateVersion",sortable:!0,render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(i,i.duplicateVersion)}}},i.duplicateVersion)}},{label:"内容源",prop:"source",render:function(t,a){var i=a.row;return e.$consts.sourceNumberText[i.source]}},{label:"状态",prop:"pluginStatus",render:function(t,a){var i=a.row;return e.$consts.statusText[i.pluginStatus]}},{label:"频道",prop:"channel",render:function(e,t){var a=t.row;switch(a.channel){case"movie":return"影视";case"child":return"少儿";case"sport":return"体育";case"edu":return"教育"}}},{label:"更新时间",prop:"lastUpdateDate"},{label:"操作",render:function(t,a){var i=a.row;if(i.showContentAuthSettingBtn)return t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleOpenContentAuthManager(i)}}},"内容权限")}}],data:[],selected:[],selectionType:"multiple"}}},methods:{handleOpenContentAuthManager:function(e){this.$refs.contentCard.handleShowContentAuthManager({id:e.pluginId,menuElId:"sysPlugin",type:"systemPlugin"})},fetchData:function(){var e=this,t=this.parseFilter();this.$service.getSysPlugin(t).then(function(t){console.log(t),e.pagination.total=t.total,e.table.data=t.rows})},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.pluginId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e}},created:function(){var e=co.a.map({pluginId:co.a.o.string.other("form",{component:"Input",placeholder:"ID"}),pluginName:co.a.o.string.other("form",{component:"Input",placeholder:"功能名称"}),source:co.a.o.enum(this.$consts.sourceNumberEnums).other("form",{component:"Select",placeholder:"内容源"}),channel:co.a.o.enum(this.channel).other("form",{component:"Select",placeholder:"频道"}),pluginStatus:co.a.o.enum(this.$consts.statusEnums).other("form",{component:"Select",placeholder:"状态"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},mu=hu,fu=(a("d529"),Object(Bn["a"])(mu,du,pu,!1,null,"68072b33",null)),gu=fu.exports,bu=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("div",{staticClass:"multi-func-block-upsert"},[a("CommonContent",{attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{replicate:function(t){e.mode="replicate",e.title="创建副本"},edit:function(t){e.mode="edit",e.title="编辑"},unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,"submit-audit":function(t){return e.handleSubmitAudit(t,e.$consts.status.waiting)},"save-draft":function(t){return e.handleSubmitAudit(t,e.$consts.status.draft)},audit:function(t){return e.$emit("upsert-end")},"select-version":e.fetchData,delete:function(t){return e.$emit("upsert-end",t)}}},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),"read"!==e.mode?a("div",[a("el-form",{ref:"blockForm",staticClass:"el-form-add",attrs:{rules:e.rules,model:e.block,"label-width":"140px"}},[a("el-form-item",{attrs:{label:"系统功能名称",prop:"pluginInfo.pluginName",rules:e.rules.pluginInfo.pluginName}},[a("el-input",{model:{value:e.block.pluginInfo.pluginName,callback:function(t){e.$set(e.block.pluginInfo,"pluginName","string"===typeof t?t.trim():t)},expression:"block.pluginInfo.pluginName"}})],1),"builtIn"===e.block.pluginInfo.pluginParentType?[a("el-form-item",{attrs:{label:"固定刷新时间",prop:"pluginInfo.refreshTime"}},[a("div",{staticClass:"el-input",staticStyle:{"max-width":"400px"}},[a("el-time-select",{attrs:{"picker-options":{start:"00:00",step:"00:10",end:"24:00"},placeholder:"选择时间"},on:{change:e.handleTime},model:{value:e.block.pluginInfo.refreshTime,callback:function(t){e.$set(e.block.pluginInfo,"refreshTime",t)},expression:"block.pluginInfo.refreshTime"}})],1)]),a("el-form-item",{attrs:{label:"活动形式",prop:"hasActivity"}},[a("el-radio-group",{on:{change:e.handleChangeActivityFlag},model:{value:e.block.hasActivity,callback:function(t){e.$set(e.block,"hasActivity",t)},expression:"block.hasActivity"}},[a("el-radio",{attrs:{label:0}},[e._v("非活动")]),a("el-radio",{attrs:{label:1}},[e._v("活动")])],1)],1)]:e._e(),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"builtIn"!==e.block.pluginInfo.pluginParentType,expression:"block.pluginInfo.pluginParentType !== 'builtIn'"}],attrs:{label:"类型",prop:"pluginInfo.pluginParentType",rules:e.rules.pluginInfo.pluginParentType}},[a("el-select",{staticClass:"plugin-parent-type-selector",attrs:{value:e.block.pluginInfo.pluginParentType,disabled:"edit"===e.mode,placeholder:"请选择"},on:{input:e.handleChangePluginParentType}},e._l(e.pluginParentTypes,function(e){return a("el-option",{key:e.id,attrs:{label:e.dictCnName,value:e.dictEnName}})}),1)],1),"secKill"!==e.pluginParentType?a("el-form-item",{attrs:{label:"内容源",prop:"pluginInfo.source",rules:e.rules.pluginInfo.source}},[a("el-radio-group",{attrs:{value:e.block.pluginInfo.source,disabled:e.isDisabledSource},on:{input:e.handleChangeSource}},e._l(e.$consts.sourceNumberOptions,function(t,i){return a("el-radio",{key:i,attrs:{label:t.value}},[e._v(e._s(t.label))])}),1)],1):e._e(),"sign"===e.pluginParentType?[a("el-form-item",{attrs:{label:"标记推荐位类型",prop:"pluginInfo.pluginType",rules:e.rules.pluginInfo.pluginType}},[a("el-input",{model:{value:e.block.pluginInfo.pluginType,callback:function(t){e.$set(e.block.pluginInfo,"pluginType","string"===typeof t?t.trim():t)},expression:"block.pluginInfo.pluginType"}})],1)]:e._e(),"sign"!==e.pluginParentType&&e.pluginTypes.length>0?a("el-form-item",{attrs:{label:"多功能推荐位类型",prop:"pluginInfo.pluginType",rules:e.rules.pluginInfo.pluginType}},[a("el-select",{staticClass:"plugin-type-selector",staticStyle:{width:"300px","max-width":"300px"},attrs:{value:e.block.pluginInfo.pluginType,placeholder:"请选择"},on:{input:e.handleChangePluginType}},e._l(e.pluginTypes,function(e){return a("el-option",{key:e.dictId,attrs:{label:e.dictCnName,value:e.dictEnName}})}),1)],1):e._e(),e.baseHasTitle?[a("el-form-item",{attrs:{label:"标题",prop:"helper.title",rules:e.rules.title}},[a("el-input",{model:{value:e.block.helper.title,callback:function(t){e.$set(e.block.helper,"title","string"===typeof t?t.trim():t)},expression:"block.helper.title"}})],1),a("el-form-item",{attrs:{label:"副标题",prop:"helper.subTitle",rules:e.rules.subTitle}},[a("el-input",{model:{value:e.block.helper.subTitle,callback:function(t){e.$set(e.block.helper,"subTitle","string"===typeof t?t.trim():t)},expression:"block.helper.subTitle"}})],1)]:e._e(),"sign"!==e.pluginParentType?e._l(e.block.rlsInfo,function(t,i){return a("div",{key:i},[a("div",{staticClass:"form-legend-header"},[a("span",[e._v(e._s(t.label))])]),"builtIn"===e.block.pluginInfo.pluginParentType?[a("el-form-item",{attrs:{label:"状态栏文字",rules:e.rules.barText,prop:"rlsInfo."+i+".title"}},[a("el-row",{staticClass:"leftSide"},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{rules:e.rules.barText,prop:"rlsInfo."+i+".title"}},[a("el-input",{model:{value:t.title,callback:function(a){e.$set(t,"title","string"===typeof a?a.trim():a)},expression:"item.title"}})],1)],1),a("el-col",{staticClass:"textAlignCenter",attrs:{span:2}},[e._v("|")]),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{rules:e.rules.barText,prop:"rlsInfo."+i+".subTitle"}},[a("el-input",{model:{value:t.subTitle,callback:function(a){e.$set(t,"subTitle","string"===typeof a?a.trim():a)},expression:"item.subTitle"}})],1)],1)],1)],1)]:e._e(),e.versionHasTitle?[a("el-form-item",{attrs:{label:"标题",prop:"rlsInfo."+i+".title",rules:e.rules.title}},[a("el-input",{model:{value:t.title,callback:function(a){e.$set(t,"title","string"===typeof a?a.trim():a)},expression:"item.title"}})],1),a("el-form-item",{attrs:{label:"副标题",prop:"rlsInfo."+i+".subTitle",rules:e.rules.subTitle}},[a("el-input",{model:{value:t.subTitle,callback:function(a){e.$set(t,"subTitle","string"===typeof a?a.trim():a)},expression:"item.subTitle"}})],1)]:e._e(),"secKill"===e.block.pluginInfo.pluginParentType?[a("el-form-item",{attrs:{label:"商品ID",prop:"rlsInfo."+i+".goodsId",rules:e.rules.goodsId}},[a("el-input",{model:{value:t.goodsId,callback:function(a){e.$set(t,"goodsId","string"===typeof a?a.trim():a)},expression:"item.goodsId"}})],1),a("el-form-item",{attrs:{label:"商品名称",prop:"rlsInfo."+i+".title",rules:e.rules.goodsId}},[a("el-input",{model:{value:t.title,callback:function(a){e.$set(t,"title","string"===typeof a?a.trim():a)},expression:"item.title"}})],1)]:e._e(),a("el-form-item",{attrs:{label:"海报",prop:"rlsInfo."+i+".poster.pictureUrl",rules:e.rules.poster.pictureUrl}},[a("div",{staticClass:"poster",on:{click:function(t){return e.handleSelectPosterStart(i)}}},[t.poster.pictureUrl?a("img",{staticClass:"poster__img",attrs:{src:t.poster.pictureUrl}}):e._e()])]),"REFERENCE_ACTIVITY"===e.pluginType?[a("el-form-item",{attrs:{label:"异形焦点",prop:"rlsInfo."+i+".extendInfo.focusImgUrl",rules:e.rules.focusImgUrl}},[a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary"},on:{click:function(t){return e.handleSelectFocusImgStart(i)}}},[e._v("选择异形焦点")]),t.extendInfo.focusImgUrl?a("div",{staticClass:"focus-transition"},[a("i",{staticClass:"focus-transition__remove el-icon-circle-close",attrs:{title:"移除异形焦点"},on:{click:function(t){return e.handleRemoveFocusImg(i)}}}),a("img",{staticClass:"focus-transition__img",attrs:{src:t.extendInfo.focusImgUrl}})]):e._e()],1),a("el-form-item",{attrs:{label:"存活时间",prop:"rlsInfo."+i+".extendInfo.aliveTime",rules:e.rules.aliveTime}},[a("div",{staticClass:"el-input",staticStyle:{"max-width":"400px"}},[a("el-time-select",{attrs:{"picker-options":{start:"00:00",step:"00:10",end:"24:00"},placeholder:"选择时间"},on:{change:e.handleTime},model:{value:t.extendInfo.aliveTime,callback:function(a){e.$set(t.extendInfo,"aliveTime",e._n(a))},expression:"item.extendInfo.aliveTime"}})],1)]),a("el-form-item",{attrs:{label:"点击次数",prop:"rlsInfo."+i+".extendInfo.clickCount",rules:e.rules.clickCount}},[a("el-input",{model:{value:t.extendInfo.clickCount,callback:function(a){e.$set(t.extendInfo,"clickCount",e._n(a))},expression:"item.extendInfo.clickCount"}})],1)]:e._e(),"multi"===e.pluginParentType||"secKill"===e.pluginParentType||"builtIn"===e.pluginParentType?a("el-form-item",{attrs:{label:"打开方式",rules:e.rules.openMode}},[a("el-select",{attrs:{value:t.openMode},on:{input:function(a){return e.handleChangeOpenMode(t,a)}}},[a("el-option",{attrs:{label:"网页",value:"webpage"}}),a("el-option",{attrs:{label:"视频",value:"video"}}),a("el-option",{attrs:{label:"图片",value:"picture"}}),a("el-option",{attrs:{label:"版面",value:"tab"}}),a("el-option",{attrs:{label:"第三方应用",value:"app"}})],1),"app"===t.openMode?a("el-button",{staticClass:"marginL",attrs:{type:"primary",plain:""},on:{click:function(t){return e.handleSelectClickStart(i)}}},[e._v("快速填充")]):e._e()],1):e._e(),"webpage"===t.openMode?[a("el-form-item",{attrs:{label:"网页地址",prop:"rlsInfo."+i+".onclick.webpageUrl",rules:e.rules.webpageUrl}},[a("el-input",{model:{value:t.onclick.webpageUrl,callback:function(a){e.$set(t.onclick,"webpageUrl","string"===typeof a?a.trim():a)},expression:"item.onclick.webpageUrl"}})],1),a("el-form-item",{attrs:{label:"网页类型",prop:"rlsInfo."+i+".onclick.webpageType"}},[a("el-radio-group",{model:{value:t.onclick.webpageType,callback:function(a){e.$set(t.onclick,"webpageType",a)},expression:"item.onclick.webpageType"}},[a("el-radio",{attrs:{label:"1"}},[e._v("浮窗网页")]),a("el-radio",{attrs:{label:"2"}},[e._v("全屏网页")])],1)],1),a("el-form-item",{attrs:{label:"应用版本号",prop:"rlsInfo."+i+".onclick.webpageAppVersion",rules:e.rules.webpageAppVersion}},[a("el-input",{model:{value:t.onclick.webpageAppVersion,callback:function(a){e.$set(t.onclick,"webpageAppVersion","string"===typeof a?a.trim():a)},expression:"item.onclick.webpageAppVersion"}})],1)]:e._e(),"video"===t.openMode?[a("el-form-item",{attrs:{label:"视频名称",prop:"rlsInfo."+i+".onclick.videoName",rules:e.rules.videoName}},[a("el-input",{model:{value:t.onclick.videoName,callback:function(a){e.$set(t.onclick,"videoName","string"===typeof a?a.trim():a)},expression:"item.onclick.videoName"}})],1),a("el-form-item",{attrs:{label:"视频地址",prop:"rlsInfo."+i+".onclick.videoUrl",rules:e.rules.videoUrl}},[a("el-input",{model:{value:t.onclick.videoUrl,callback:function(a){e.$set(t.onclick,"videoUrl","string"===typeof a?a.trim():a)},expression:"item.onclick.videoUrl"}})],1)]:e._e(),"tab"===t.openMode?[a("el-form-item",{attrs:{label:"版面",prop:"rlsInfo."+i+".onclick.tab",rules:e.rules.tab}},[a("TabSelector",{attrs:{source:e.source,selectionType:"single"},on:{"select-single":function(a){return e.handleSelectTabEnd(a,t)}}}),t.onclick.tab?a("el-tag",{attrs:{type:"primary"}},[e._v("已选择: "+e._s(t.onclick.tab.tabId))]):e._e()],1)]:e._e(),"picture"===t.openMode?[a("el-form-item",{attrs:{label:"选择图片",prop:"rlsInfo."+i+".onclick.picture",rules:e.rules.picture}},[a("el-upload",{attrs:{action:e.urls.uploadImg,"on-success":e.createUploadSuccessHandler(i),"on-remove":e.createUploadRemoveHandler(i),multiple:!1,"file-list":t.onclick.picture,accept:"image/png, image/gif, image/jpeg, image/bmp","list-type":"picture"}},[a("el-button",{attrs:{type:"primary"}},[e._v("点击上传")]),a("span",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("提示:只能上传png/gif/jpg/bmp文件")])],1)],1)]:e._e(),"app"===t.openMode?a("AppParams",{attrs:{"prop-prefix":"rlsInfo."+i+".onclick."},model:{value:t.onclick,callback:function(a){e.$set(t,"onclick",a)},expression:"item.onclick"}}):e._e()],2)}):e._e()],2)],1):e._e(),"read"===e.mode?a("div",[a("el-form",{ref:"blockForm",attrs:{"label-width":"140px"}},[a("el-form-item",{attrs:{label:"系统功能名称",prop:"pluginInfo.pluginName"}},[e._v(e._s(e.block.pluginInfo.pluginName))]),"builtIn"===e.block.pluginInfo.pluginParentType?[a("el-form-item",{attrs:{label:"固定刷新时间",prop:"pluginInfo.refreshTime"}},[e._v(e._s(e.parseMinToStr(e.block.pluginInfo.refreshTime)))]),a("el-form-item",{attrs:{label:"活动形式",prop:"hasActivity"}},[a("el-radio-group",{attrs:{disabled:""},model:{value:e.block.hasActivity,callback:function(t){e.$set(e.block,"hasActivity",t)},expression:"block.hasActivity"}},[a("el-radio",{attrs:{label:0}},[e._v("非活动")]),a("el-radio",{attrs:{label:1}},[e._v("活动")])],1)],1)]:e._e(),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"builtIn"!==e.block.pluginInfo.pluginParentType,expression:"block.pluginInfo.pluginParentType !== 'builtIn'"}],attrs:{label:"类型",prop:"pluginInfo.pluginParentType"}},[e._v(e._s(e.pluginParentTypeText))]),"secKill"!==e.pluginParentType?a("el-form-item",{attrs:{label:"内容源"}},[e._v(e._s(e.$consts.sourceNumberText[e.block.pluginInfo.source]))]):e._e(),"sign"===e.pluginParentType?[a("el-form-item",{attrs:{label:"标记推荐位类型",prop:"pluginInfo.pluginType"}},[e._v(e._s(e.block.pluginInfo.pluginType))])]:e._e(),"sign"!==e.pluginParentType&&e.pluginTypes.length>0&&e.pluginTypeText?a("el-form-item",{attrs:{label:"多功能推荐位类型",prop:"pluginInfo.pluginType"}},[e._v(e._s(e.pluginTypeText))]):e._e(),e.baseHasTitle?[a("el-form-item",{attrs:{label:"标题",prop:"helper.title"}},[e._v(e._s(e.block.helper.title))]),a("el-form-item",{attrs:{label:"副标题",prop:"helper.subTitle"}},[e._v(e._s(e.block.helper.subTitle))])]:e._e(),"sign"!==e.pluginParentType?e._l(e.block.rlsInfo,function(t,i){return a("div",{key:i},[a("div",{staticClass:"form-legend-header"},[a("span",[e._v(e._s(t.label))])]),e.versionHasTitle?[a("el-form-item",{attrs:{label:"标题"}},[e._v(e._s(t.title))]),a("el-form-item",{attrs:{label:"副标题"}},[e._v(e._s(t.subTitle))])]:e._e(),"builtIn"===e.block.pluginInfo.pluginParentType?[a("el-form-item",{attrs:{label:"状态栏文字"}},[e._v(e._s(t.title)+" "+e._s(t.subTitle?" | "+t.subTitle:""))])]:e._e(),"secKill"===e.block.pluginInfo.pluginParentType?[a("el-form-item",{attrs:{label:"商品ID"}},[e._v(e._s(t.goodsId))]),a("el-form-item",{attrs:{label:"商品名称"}},[e._v(e._s(t.title))])]:e._e(),a("el-form-item",{attrs:{label:"海报"}},[a("div",{staticClass:"poster"},[t.poster.pictureUrl?a("img",{staticClass:"poster__img",attrs:{src:t.poster.pictureUrl}}):e._e()])]),"REFERENCE_ACTIVITY"===e.pluginType?[a("el-form-item",{attrs:{label:"异形焦点"}},[t.extendInfo.focusImgUrl?a("div",{staticClass:"focus-transition"},[a("img",{staticClass:"focus-transition__img",attrs:{src:t.extendInfo.focusImgUrl}})]):a("span",[e._v("无")])]),a("el-form-item",{attrs:{label:"存活时间"}},[e._v(e._s(e.parseMinToStr(t.extendInfo.aliveTime)))]),a("el-form-item",{attrs:{label:"点击次数"}},[e._v(e._s(t.extendInfo.clickCount))])]:e._e(),"multi"===e.pluginParentType||"secKill"===e.pluginParentType?a("el-form-item",{attrs:{label:"打开方式"}},[e._v(e._s(e.OPEN_MODE_TEXT[t.openMode]))]):e._e(),"webpage"===t.openMode?[a("el-form-item",{attrs:{label:"网页地址"}},[e._v(e._s(t.onclick.webpageUrl))]),a("el-form-item",{attrs:{label:"网页类型"}},[e._v(e._s(["","浮窗网页","全屏网页"][+t.onclick.webpageType]))]),a("el-form-item",{attrs:{label:"应用版本号"}},[e._v(e._s(t.onclick.webpageAppVersion))])]:e._e(),"video"===t.openMode?[a("el-form-item",{attrs:{label:"视频名称"}},[e._v(e._s(t.onclick.videoName))]),a("el-form-item",{attrs:{label:"视频地址"}},[e._v(e._s(t.onclick.videoUrl))])]:e._e(),"picture"===t.openMode?[a("el-form-item",{attrs:{label:"图片"}},[a("div",{staticClass:"open-picture"},[a("img",{staticClass:"open-picture__img",attrs:{src:t.onclick.picture[0].url}})])])]:e._e(),"tab"===t.openMode?[a("el-form-item",{attrs:{label:"版面"}},[e._v(e._s(t.onclick.tab.tabId))])]:e._e(),"app"===t.openMode?a("AppParamsRead",{attrs:{"label-width":"140px"},model:{value:t.onclick,callback:function(a){e.$set(t,"onclick",a)},expression:"item.onclick"}}):e._e()],2)}):e._e()],2)],1):e._e(),a("el-dialog",{attrs:{visible:e.dialogTableVisible,width:"1200px"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[e.dialogTableVisible?a("selectResource",{on:{selected:e.getSelectResource}}):e._e(),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogTableVisible=!1}}},[e._v("取 消")])],1)],1),a("el-dialog",{attrs:{visible:e.dialogClickTableVisible,width:"1200px"},on:{"update:visible":function(t){e.dialogClickTableVisible=t}}},[a("selectClick",{on:{"row-click":e.getClickData}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogClickTableVisible=!1}}},[e._v("取 消")])],1)],1),a("el-dialog",{attrs:{visible:e.showFocusImgSelectorVisible,width:"1200px"},on:{"update:visible":function(t){e.showFocusImgSelectorVisible=t}}},[a("selectImg",{on:{selectImg:e.getSelectImg}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showFocusImgSelectorVisible=!1}}},[e._v("取 消")])],1)],1)],1)],1)])},vu=[],yu={sign:"sign",multi:"multi",builtIn:"builtIn",secKill:"secKill"};window.basicFn={};var wu,Iu,Cu={components:{ccTimeSpinner:Rc,selectResource:Mc,selectClick:ds,selectImg:Yc,AppParams:zs,CommonContent:Us,AppParamsRead:Zs,TabSelector:Hc},props:["id","initMode","version"],data:function(){return{title:null,dialogTableVisible:!1,dialogClickTableVisible:!1,showFocusImgSelectorVisible:!1,clickData:{},selectResource:{},selectImgData:{},urls:{uploadImg:"api/v1/upload/image.html"},PARENT_TYPES:yu,mode:"create",pluginParentTypes:[],pluginTypes:[],pluginVersions:{},selectingPostForIndex:void 0,showClickSelector:!1,selectingClickForIndex:void 0,showTabSelector:!1,selectingTabForIndex:void 0,showFocusImgSelector:!1,selectingFocusImgForIndex:void 0,block:{helper:{title:void 0,subTitle:void 0,webpageUrl:void 0,webpageType:"1",webpageAppVersion:void 0},pluginInfo:{pluginId:void 0,pluginName:"",pluginParentType:void 0,source:0,channel:"",pluginType:void 0,enableEdit:1,pluginStatus:void 0,refreshTime:240},rlsInfo:[],hasActivity:0},rules:{pluginInfo:{pluginName:[{required:!0,message:"请输入系统功能名称",trigger:"blur"},{max:45,message:"不超过 45 个字符",trigger:"blur"}],refreshTime:[{required:!0,message:"请选择固定刷新时间",trigger:"blur"}],pluginParentType:[{required:!0,message:"请选择类型",trigger:"blur"}],pluginType:[{required:!0,message:"不能为空",trigger:"blur"}]},barText:[{max:45,message:"不超过 45 个字符",trigger:"blur"},{required:!0,message:"请输入状态栏文字",trigger:"blur"}],title:[{required:!0,message:"请输入标题",trigger:"blur"},{max:45,message:"不超过 45 个字符",trigger:"blur"}],subTitle:[{max:100,message:"不超过 100 个字符",trigger:"blur"}],openMode:[{required:!0,message:"请选择打开方式",trigger:"blur"}],goodsId:[{required:!0,message:"请填写商品ID",trigger:"blur"},{max:45,message:"不超过 45 个字符",trigger:"blur"}],webpageUrl:[{required:!0,message:"请填写网页地址",trigger:"blur"}],webpageAppVersion:[{required:!0,message:"请填写应用版本号",trigger:"blur"}],videoName:[{required:!0,message:"请填写视频名称",trigger:"blur"}],videoUrl:[{required:!0,message:"请填写视频地址",trigger:"blur"}],picture:[{trigger:"change",validator:function(e,t,a){a(t&&t.length>0?void 0:new Error("请上传图片"))}},{required:!0,message:"请上传图片"}],tab:[{trigger:"change",validator:function(e,t,a){a(t?void 0:new Error("请选择版面"))}},{required:!0,message:"请选择版面"}],clickCount:[{required:!0,message:"请填入点击次数"},{type:"number",message:"请填入数字"},{validator:function(e,t,a){/^[1-9][0-9]*$/.test(t)?a():a(new Error("请输入正整数"))}}],aliveTime:[{required:!0,message:"请填入存活时间"},{type:"number",message:"请填入数字"}],focusImgUrl:[{required:!0,message:"请选择异形焦点"}],poster:{pictureUrl:[{required:!0,message:"请选择海报",trigger:"blur"}]}}}},computed:{source:function(){switch(this.block.pluginInfo.source){case 0:return"";case 1:return"o_tencent";case 2:return"o_iqiyi";case 3:return"o_youku"}},resourceInfo:function(){var e=this.block.pluginInfo;if(e.pluginId)return{id:e.pluginId,type:"systemPlugin",menuElId:"sysPlugin",version:e.currentVersion,status:e.pluginStatus}},pluginTypeText:function(){var e=this.pluginType,t=this.pluginTypes;if(console.log(e),console.log(t),t.length>0){var a=t.find(function(t){return t.dictEnName===e});if(a)return a.dictCnName}},pluginParentTypeText:function(){var e=this.pluginParentType,t=this.pluginParentTypes;if(t.length>0){var a=t.find(function(t){return t.dictEnName===e});if(a)return a.dictCnName}},pluginParentType:function(){return this.block.pluginInfo.pluginParentType},pluginType:function(){return this.block.pluginInfo.pluginType},isDisabledSource:function(){return"edit"===this.mode},versionHasTitle:function(){this.pluginParentType;var e=this.pluginType;return"REFERENCE_MOVIE_VIP"===e},baseHasTitle:function(){var e=this.pluginParentType,t=this.pluginType;return"secKill"!==e&&"builtIn"!==e&&t&&"REFERENCE_MOVIE_VIP"!==t}},watch:{},methods:{handleSelectTabEnd:function(e,t){this.$set(t.onclick,"tab",e)},parseMinToStr:function(e){var t=e.split(":"),a=parseInt(t[0]),i=parseInt(t[1]);return 60*a+i},parseStrToMin:function(e){var t=Math.floor(e/60),a=e%60,i=t>9?""+t:"0"+t,n=a>9?""+a:"0"+a;return i+":"+n},fetchData:function(e){var t=this;this.$service.editSysPlugin({id:this.id,version:e}).then(function(e){e&&(t.setData(e),t.pluginType&&t.getPluginVersions(t.pluginType).then(function(e){if(e){var t=this.block.rlsInfo,a=t.reduce(function(e,t){return e[t.dataType]=t,e},{});this.block.rlsInfo=e.reduce(function(e,t){var i=a[t.dictEnName];return i&&(this.$set(i,"label",t.dictCnName),e.push(i)),e}.bind(this),[])}}.bind(t)))})},getPluginParentTypes:function(){var e=this;this.$service.getPluginParentTypes().then(function(t){console.log(t),t&&(e.pluginParentTypes=t.filter(function(e){return"builtIn"!==e.dictEnName}))})},getPluginTypes:function(e){var t=this;this.$service.getPluginTypes({pluginParentType:e}).then(function(e){console.log(e),e&&(t.pluginTypes=e)})},handleTime:function(){},getPluginVersions:function(e){var t=this,a=this.pluginVersions;return new Promise(function(i,n){a[e]?i(a[e]):t.$service.getPluginVersions(e).then(function(t){console.log(t),t&&(a[e]=t,i(a[e]))})})},handleChangeSource:function(e){this.$confirm("确定切换内容源？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){this.$refs["blockForm"].clearValidate(),this.block.pluginInfo.source=e}.bind(this)).catch(function(e){throw e})},handleChangePluginParentType:function(e){this.$refs["blockForm"].clearValidate();var t=this.block.pluginInfo.pluginParentType,a=function(){this.pluginTypes=[],this.setPluginParentType(e),this.getPluginTypes(e),"secKill"===e&&this.setPluginType("REFERENCE_MALL_SECKILL")}.bind(this);t&&t!==e?this.$confirm("切换类型将清空版本等相关数据，确定切换？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(a).catch(function(e){throw e}):t||a()},setPluginParentType:function(e){this.PARENT_TYPES;var t=this.block,a=t.pluginInfo,i=t.helper;t.rlsInfo=[],a.source=0,a.pluginType=void 0,a.pluginParentType=e,i.title="",i.subTitle=""},handleChangePluginType:function(e){this.$refs["blockForm"].clearValidate();var t=this.block.pluginInfo.pluginType,a=function(){this.setPluginType(e)}.bind(this);t&&t!==e?this.$confirm("切换类型将清空版本等相关数据，确定切换？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(a).catch(function(){}):t||a()},setPluginType:function(e){var t=this.block,a=t.helper;this.getPluginVersions(e).then(function(i){t.pluginInfo.pluginType=e,a.title="",a.subTitle="",t.rlsInfo=i.map(function(t){return this.genRlsInfo({label:t.dictCnName,dataType:+t.dictEnName},e)}.bind(this))}.bind(this)).then(function(){})},genRlsInfo:function(e,t){var a={};return"REFERENCE_ACTIVITY"===t&&(a={focusImgUrl:void 0,aliveTime:60,clickCount:5}),Object.assign({openMode:"app",pluginDataId:void 0,dataType:5,onclick:{},params:0,title:"",subTitle:"",goodsId:void 0,webpageUrl:void 0,poster:{pictureId:void 0,pictureUrl:void 0}},{extendInfo:a},e)},handleSelectPosterStart:function(e){this.selectingPostForIndex=e,this.dialogTableVisible=!0},getSelectResource:function(e){this.selectResource=e,this.dialogTableVisible=!1;var t={pictureId:this.selectResource.pictureId,pictureStatus:this.selectResource.pictureStatus,pictureUrl:this.selectResource.pictureUrl};this.block.rlsInfo[this.selectingPostForIndex].poster=t},selectSubmit:function(){},handleSelectClickStart:function(e){this.selectingClickForIndex=e,this.dialogClickTableVisible=!0},getClickData1:function(e){this.clickData=e,this.dialogClickTableVisible=!1;var t=this.clickData;t=JSON.parse(t.onlickJson);var a=this.selectingClickForIndex,i=this.block.rlsInfo[a];i.onclick=this.parseOnclick(t),this.showselectClickor=!1,this.selectingClickForIndex=void 0},getClickData:function(e){this.dialogClickTableVisible=!1;var t=JSON.parse(e.params),a=Object.keys(t),i=a.reduce(function(e,a,i){var n={};return n.key=a,n.value=t[a],e.push(n),e},[]),n={packagename:e.packagename,versioncode:e.versioncode,dowhat:e.dowhat,bywhat:e.bywhat,byvalue:e.byvalue,params:i,exception:e.exception},o=this.selectingClickForIndex,r=this.block.rlsInfo[o];r.onclick=n},clickSubmit:function(){},handleSelectFocusImgStart:function(e){this.showFocusImgSelectorVisible=!0,this.selectingFocusImgForIndex=e},getSelectImg:function(e){this.selectImgData=e,this.showFocusImgSelectorVisible=!1;var t=this.selectingFocusImgForIndex,a=this.block.rlsInfo[t];this.$set(a.extendInfo,"focusImgUrl",this.selectImgData.pictureUrl),this.selectingFocusImgForIndex=void 0},selectImgSubmit:function(){},handleSelectTabStart:function(e){this.showTabSelector=!0,this.selectingTabForIndex=e},handleRemoveFocusImg:function(e){this.block.rlsInfo[e].extendInfo.focusImgUrl=void 0},createUploadSuccessHandler:function(e){return function(t){if(t.success){var a=this.block.rlsInfo[e];this.$set(a.onclick,"picture",[{name:"已上传",url:t.data[0].url}])}else this.$message(t.msg)}.bind(this)},createUploadRemoveHandler:function(e){return function(){var t=this.block.rlsInfo[e];t.onclick.picture=[]}.bind(this)},parseOnclick:function(e){if(e.params){var t=e.params;e.params=Object.keys(e.params).map(function(e){return{key:e,value:t[e]}})}return e},handleChangeOpenMode:function(e,t){this.$refs["blockForm"].clearValidate(),e.openMode=t,e.onclick="webpage"===t?{webpageType:"1",webpageUrl:void 0,webpageAppVersion:""}:{}},getData:function(e){var t=JSON.parse(JSON.stringify(this.block));return"replicate"===this.mode&&(t.pluginInfo.currentVersion=""),t.pluginInfo.pluginStatus=e,t},validateData:function(e,t){this.$refs.blockForm.validate(function(a){a?t(e):this.$message({type:"error",message:"请把表单填写完整"})}.bind(this))},setData:function(e){var t=this.block.helper,a=JSON.parse(JSON.stringify(e)),i=a.pluginInfo.pluginParentType,n=a.pluginInfo.pluginType;if(a.rlsInfo.forEach(function(e){if(e.openMode=e.params.split(",")[0].split("==")[1],e.onclick){e.onclick=this.parseOnclick(JSON.parse(e.onclick));var t=e.onclick,a=t.params.reduce(function(e,t){return e[t.key]=t.value,e},{});switch(e.openMode){case"webpage":e.onclick={webpageType:"coocaa.intent.action.browser"===t.byvalue?"1":"2",webpageUrl:a.url,webpageAppVersion:t.versioncode};break;case"video":e.onclick={videoName:a.name,videoUrl:a.url};break;case"picture":e.onclick={picture:[{name:"已上传",url:a.url}]};break;case"tab":e.onclick={tab:{tabId:a.id}}}}e.extendInfo=e.extendInfo||{}}.bind(this)),i&&this.getPluginTypes(i),"secKill"!==i&&n&&"REFERENCE_MOVIE_VIP"!==n){var o=a.rlsInfo[0];o&&(t.title=o.title,t.subTitle=o.subTitle)}this.block=Object.assign(this.block,a),this.block.pluginInfo.refreshTime=this.parseStrToMin(this.block.pluginInfo.refreshTime);for(var r=0;r<this.block.rlsInfo.length;r++)"undefined"!==typeof this.block.rlsInfo[r].extendInfo&&"undefined"!==typeof this.block.rlsInfo[r].extendInfo.aliveTime&&(this.block.rlsInfo[r].extendInfo.aliveTime=this.parseStrToMin(this.block.rlsInfo[r].extendInfo.aliveTime))},parseData:function(e){var t=e.helper,a=this.baseHasTitle,i=this.pluginParentType;return"sign"===i&&(e.rlsInfo=e.rlsInfo||[],e.rlsInfo[0]=e.rlsInfo[0]||{dataType:5,title:void 0,subTitle:void 0}),e.rlsInfo.forEach(function(e){var i=e.onclick;switch(e.openMode&&(e.params="openMode=="+e.openMode),e.openMode){case"webpage":"1"===i.webpageType?e.onclick={packagename:"com.coocaa.app_browser",versioncode:i.webpageAppVersion,dowhat:"startActivity",bywhat:"action",byvalue:"coocaa.intent.action.browser",params:[{key:"url",value:i.webpageUrl}],exception:{}}:"2"===i.webpageType&&(e.onclick={packagename:"com.coocaa.app_browser",versioncode:i.webpageAppVersion,dowhat:"startActivity",bywhat:"action",byvalue:"coocaa.intent.action.browser.no_trans",params:[{key:"url",value:i.webpageUrl}],exception:{}});break;case"video":e.onclick={packagename:"com.tianci.movieplatform",versioncode:"-1",dowhat:"startService",bywhat:"action",byvalue:"coocaa.intent.player.video",params:[{key:"name",value:i.videoName},{key:"url",value:i.videoUrl},{key:"needParse",value:"false"},{key:"url_type",value:"web"}],exception:{}};break;case"picture":e.onclick={packagename:"com.tianci.movieplatform",versioncode:"",dowhat:"startService",bywhat:"action",byvalue:"coocaa.intent.player.image",params:[{key:"name",value:""},{key:"url",value:i.picture[0].url}],exception:{}};break;case"tab":e.params+=",tabType=="+i.tab.tabType,e.onclick={packagename:"com.tianci.movieplatform",versioncode:"",dowhat:"startActivity",bywhat:"action",byvalue:1==i.tab.tabType?"coocaa.intent.action.HOME_COMMON_LIST":"coocaa.intent.action.HOME_SPECIAL_TOPIC",params:[{key:"id",value:i.tab.tabId}],exception:{}};break;case"app":e.onclick.exception={name:"onclick_exception",value:{packagename:"com.tianci.appstore",dowhat:"startActivity",versioncode:"-1",params:[{key:"id",value:i.packagename}],byvalue:"coocaa.intent.action.APP_STORE_DETAIL",bywhat:"action"}};break}a&&(e.title=t.title,e.subTitle=t.subTitle),e.onclick&&e.onclick.params&&(e.onclick.params=e.onclick.params.reduce(function(e,t){return e[t.key]=t.value,e},{}),e.onclick=JSON.stringify(e.onclick)),delete e.openMode}),delete e.helper,e},handleSubmitAudit:function(e,t){var a=this.getData(t);this.validateData(a,function(){this.submit(a)}.bind(this))},submit:function(e){this.validateData(e,function(){var t=this;e.pluginInfo.refreshTime=this.parseMinToStr(e.pluginInfo.refreshTime);for(var a=0;a<e.rlsInfo.length;a++)"undefined"!==typeof e.rlsInfo[a].extendInfo&&"undefined"!==typeof e.rlsInfo[a].extendInfo.aliveTime&&(e.rlsInfo[a].extendInfo.aliveTime=this.parseMinToStr(e.rlsInfo[a].extendInfo.aliveTime));e=this.parseData(e),console.log(e),this.$service.SavePlugin(e,"保存成功").then(function(e){t.$emit("upsert-end")})}.bind(this))},handleChangeActivityFlag:function(e){e?this.block.rlsInfo.unshift(this.genRlsInfo({label:"活动形式",dataType:4})):this.block.rlsInfo=this.block.rlsInfo.filter(function(e){return 4!==e.dataType})}},created:function(){switch(this.basicFn=basicFn,this.getPluginParentTypes(),this.mode=this.initMode||"create",this.mode){case"create":this.title="新增";break;case"copy":this.title="复制";break;case"edit":this.title="编辑";break;case"replica":this.title="创建副本";case"read":this.title="预览";break}this.id&&this.fetchData(this.version)}},Tu=Cu,Su=(a("f5e9"),Object(Bn["a"])(Tu,bu,vu,!1,null,"73f1043f",null)),ku=Su.exports,_u={extends:hc,components:{ResourceList:gu,ResourceContent:ku},data:function(){return{}},computed:{resourceInfo:function(){return{type:"sysPlugin",idField:"pluginId"}}}},Pu=_u,xu=Object(Bn["a"])(Pu,wu,Iu,!1,null,null,null),Du=xu.exports,Fu=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("AlbumPannelInfoList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,read:e.handleRead,edit:e.handleEdit,copy:e.handleCopy,delete:e.handleDelete}}),e.isShowList?e._e():a("PanelInfo",{attrs:{id:e.id,"panel-data-type":3,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},$u=[],Lu=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PageWrapper",[a("PageContentWrapper",{directives:[{name:"show",rawName:"v-show",value:"panel_info"==e.activePage,expression:"activePage == 'panel_info'"}]},[a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("CommonContent",{ref:"commonContent",attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{replicate:function(t){e.mode="replicate"},edit:function(t){e.mode="edit"},unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,audit:function(t){return e.$emit("upsert-end")},"submit-audit":e.handleSubmitAudit,"save-draft":e.handleSaveDraft,"select-version":e.fetchData,delete:function(t){return e.$emit("upsert-end",t)},"cancel-timing":function(t){return e.fetchData(e.pannel.currentVersion)}}},[a("div",{attrs:{slot:"copy-confirm"},slot:"copy-confirm"},[e._v("\n          复制到\n          "),a("el-select",{model:{value:e.copyToPanelDataType,callback:function(t){e.copyToPanelDataType=t},expression:"copyToPanelDataType"}},[a("el-option",{attrs:{value:1,label:"常规运营"}}),a("el-option",{attrs:{value:3,label:"业务专辑"}})],1),e._v("\n           \n          "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleCopy(e.$consts.status.draft)}}},[e._v("复制为草稿")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleCopy(e.$consts.status.waiting)}}},[e._v("复制并提交审核")])],1),1==e.currentPanelDataType?a("div",{staticClass:"base-info"},[a("div",[e._v("常规运营版块：")]),a("div",[e._v("运营人员纯手工运营的版块，可以通过此版块自主配置影片、频道、活动、系统功能等，此类版块适合首屏比较固定的内容版块，不做个性推荐积累。")])]):e._e(),3==e.currentPanelDataType?a("div",{staticClass:"base-info"},[a("div",[e._v("业务专辑：")]),a("div",[e._v("运营人员可以把业务站点专辑，关联映射至此版块中，可以多个进行排序。")])]):e._e(),"read"!==e.mode?[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"form",attrs:{model:e.pannel,"label-width":"120px"}},[a("el-form-item",{staticClass:"selectItem",attrs:{label:"业务分类"}},[a("CommonSelector",{attrs:{value:e.pannel.panelGroupCategory,disabled:e.isReplica,options:e.businessTypeEnums},on:{input:e.handlePanelGroupCategoryChange}}),a("span",{staticClass:"remarks marginL"},[e._v("注：只有一个权限的操作者不能选择业务分类")])],1),e.isPanelCommonOrVideo?a("el-form-item",{attrs:{label:"内容源"}},[a("SourceRadioSelector",{attrs:{value:e.pannel.pannelResource,disabled:e.isReplica},on:{input:e.handlePannelResourceChange}})],1):e._e(),a("el-form-item",{attrs:{label:"版块名称",required:""}},[a("el-input",{model:{value:e.pannel.pannelName,callback:function(t){e.$set(e.pannel,"pannelName",t)},expression:"pannel.pannelName"}})],1),a("el-form-item",{attrs:{label:"版块分类",required:""}},[a("CommonSelector",{attrs:{type:"radio",value:e.pannel.parentType,disabled:e.isReplica,options:e.$consts.panelTypeOptions},on:{input:e.handleParentTypeChange}})],1),"group"===e.pannel.parentType?a("el-form-item",{attrs:{label:"落焦规则"}},[a("el-radio-group",{on:{change:e.handleFocusConfigChange},model:{value:e.pannel.focusConfig,callback:function(t){e.$set(e.pannel,"focusConfig",t)},expression:"pannel.focusConfig"}},[a("el-radio",{attrs:{label:""}},[e._v("手动指定")]),a("el-radio",{attrs:{label:"week"}},[e._v("根据一周时间")]),a("el-radio",{attrs:{label:"timeSlot"}},[e._v("根据时间段")])],1)],1):e._e(),a("el-form-item",{attrs:{label:"版块属性"}},[a("BinCheckBox",{attrs:{label:"4K",disabled:e.isReplica},model:{value:e.pannel.flagIs4k,callback:function(t){e.$set(e.pannel,"flagIs4k",t)},expression:"pannel.flagIs4k"}})],1)],1),a("div",{staticClass:"form-legend-header"},[a("span",[e._v("内容配置")])]),a("el-form",{ref:"form",attrs:{model:e.pannel,"label-width":"120px"}},["normal"===e.pannel.parentType?a("el-form-item",{attrs:{label:"版块标题",required:""}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入版本标题"},model:{value:e.pannel.pannelList[0].pannelTitle,callback:function(t){e.$set(e.pannel.pannelList[0],"pannelTitle",t)},expression:"pannel.pannelList[0].pannelTitle"}}),a("BinCheckBox",{attrs:{label:"前端不显示标题","is-negative":""},model:{value:e.pannel.showTitle,callback:function(t){e.$set(e.pannel,"showTitle",t)},expression:"pannel.showTitle"}})],1):e._e(),"group"===e.pannel.parentType?a("el-form-item",{attrs:{label:"版块标题",required:""}},[a("el-input",{attrs:{placeholder:"请输入版本标题"},model:{value:e.pannel.groupTitle,callback:function(t){e.$set(e.pannel,"groupTitle",t)},expression:"pannel.groupTitle"}})],1):e._e(),a("el-form-item",{attrs:{label:"版块布局",required:""}},[a("LayoutSelector",{on:{"select-end":e.handleSelectLayoutEnd}}),e.selectedLayout?a("span",{staticClass:"marginL"},[e._v("(已选择: "+e._s(e.selectedLayout.layoutName)+")")]):e._e(),a("BinCheckBox",{staticClass:"marginL",attrs:{label:"设置前端推荐位底色透明"},model:{value:e.pannel.lucenyFlag,callback:function(t){e.$set(e.pannel,"lucenyFlag",t)},expression:"pannel.lucenyFlag"}})],1),a("el-form-item",{attrs:{label:"落焦形式",required:""}},[a("CommonSelector",{attrs:{options:e.$consts.panelFocusOptions,placeholder:"请选择"},model:{value:e.pannel.focusShape,callback:function(t){e.$set(e.pannel,"focusShape",t)},expression:"pannel.focusShape"}}),a("BinCheckBox",{directives:[{name:"show",rawName:"v-show",value:0===e.pannel.focusShape,expression:"pannel.focusShape === 0"}],attrs:{label:"设置异形焦点"},model:{value:e.isShowfocusImgUrl,callback:function(t){e.isShowfocusImgUrl=t},expression:"isShowfocusImgUrl"}})],1),e.isShowfocusImgUrl&&0===e.pannel.focusShape?a("el-form-item",{attrs:{label:"异形焦点"}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.selectedLayout,expression:"!selectedLayout"}],attrs:{disabled:!e.selectedLayout}},[e._v("选择异形焦点(请先选择布局)")]),a("GlobalPictureSelector",{directives:[{name:"show",rawName:"v-show",value:e.selectedLayout,expression:"selectedLayout"}],attrs:{title:"选择异形焦点","picture-resolution":e.alienFocusResolution},on:{"select-end":e.handleSelectAlienFocusEnd}}),a("div",[e.pannel.focusImgUrl?a("img",{staticStyle:{"margin-top":"10px",width:"200px",border:"1px solid #eee"},attrs:{src:e.pannel.focusImgUrl}}):e._e()])],1):e._e(),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isShowTagsField,expression:"isShowTagsField"}],staticClass:"tag-list",attrs:{label:"资源共有标签"}},e._l(e.sharedTags,function(t,i){return a("el-tag",{key:i,attrs:{type:"primary"}},[e._v(e._s(t))])}),1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isShowTagsField,expression:"isShowTagsField"}],staticClass:"tag-list",attrs:{label:"资源批量打标签"}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleBatchAddTag}},[e._v("\n                批量打标签\n              ")])],1),a("el-form-item",{attrs:{label:"批量填充"}},[a("span",{directives:[{name:"show",rawName:"v-show",value:!e.selectedLayout,expression:"!selectedLayout"}]},[e._v("\n                请先选择布局\n              ")]),a("ResourceSelector",{directives:[{name:"show",rawName:"v-show",value:e.selectedLayout,expression:"selectedLayout"}],ref:"resourceSelector",attrs:{selectors:["video","app","edu","pptv","live","topic","rotate"],"is-live":!1,"disable-partner":!!e.pannel.pannelResource,"selection-type":"multiple",source:e.pannel.pannelResource},on:{"select-end":e.handleSelectResourceEnd}},[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("选择资源")])],1),"group"===e.pannel.parentType?[a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",disabled:e.pannel.pannelList.length>=10},on:{click:e.handleAddTab}},[e._v("添加分组")]),a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",disabled:!!e.pannel.pannelList[e.activePannelIndex].panelIsFocus||""!=e.pannel.focusConfig},on:{click:e.handleSetDefaultActiveTab}},[e._v("设置默认落焦")])]:e._e(),a("div",{staticClass:"pannel-blocks"},["group"===e.pannel.parentType?[a("el-tabs",{attrs:{value:e.activePannelIndex+"",type:"card",closable:""},on:{input:function(t){e.activePannelIndex=+t},"tab-remove":e.handleRemoveTab}},e._l(e.pannel.pannelList,function(t,i){return a("el-tab-pane",{key:i,attrs:{name:i.toString()}},[a("span",{attrs:{slot:"label"},on:{dblclick:function(t){return e.handleSetPanelGroupInfoStart(i)}},slot:"label"},[e._v("\n                        "+e._s(t.pannelTitle||"双击修改")+"\n                        "+e._s(t.panelIsFocus&&""===e.pannel.focusConfig?"(默认落焦)":"")+"\n                      ")]),a("VirtualPanel",{attrs:{blocks:t.contentList},on:{drag:e.handleDragBlock,"remove-block":e.handleRemoveBlock,"click-block":e.handleClickBlock}})],1)}),1)]:a("VirtualPanel",{attrs:{blocks:e.pannel.pannelList[0].contentList},on:{drag:e.handleDragBlock,"remove-block":e.handleRemoveBlock,"click-block":e.handleClickBlock}})],2)],2)],1)]:e._e(),"read"===e.mode?[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"form",attrs:{model:e.pannel,"label-width":"120px"}},[e.businessTypeEnums.length>0?a("el-form-item",{attrs:{label:"业务分类"}},[e._v("\n              "+e._s((e.businessTypeEnums.find(function(t){return t.value==e.pannel.panelGroupCategory})||{}).label)+"\n            ")]):e._e(),e.isPanelCommonOrVideo?a("el-form-item",{attrs:{label:"内容源"}},[e._v("\n              "+e._s(e.$consts.sourceText[e.pannel.pannelResource])+"\n            ")]):e._e(),a("el-form-item",{attrs:{label:"版块名称",required:""}},[a("div",[e._v(e._s(e.pannel.pannelName))])]),a("el-form-item",{attrs:{label:"版块分类",required:""}},[a("div",[e._v(e._s(e.$consts.panelTypeText[e.pannel.parentType])+" ")])]),""!==e.pannel.focusConfig?a("el-form-item",{attrs:{label:"落焦规则"}},[a("div",[e._v(e._s(""===e.pannel.focusConfig?"手动指定":{week:"根据一周时间",timeSlot:"根据时间段"}[e.pannel.focusConfig])+" ")])]):e._e(),a("el-form-item",{attrs:{label:"版块属性"}},[a("BinCheckBox",{attrs:{label:"4K",disabled:!0},model:{value:e.pannel.flagIs4k,callback:function(t){e.$set(e.pannel,"flagIs4k",t)},expression:"pannel.flagIs4k"}})],1)],1),a("div",{staticClass:"form-legend-header"},[a("span",[e._v("内容配置")])]),a("el-form",{ref:"form",attrs:{model:e.pannel,"label-width":"120px"}},["normal"===e.pannel.parentType?a("el-form-item",{attrs:{label:"版块标题",required:""}},[a("div",[e._v(e._s(e.pannel.pannelList[0].pannelTitle)+" "+e._s(!1===e.pannel.showTitle?"(前端不显示)":""))])]):e._e(),"group"===e.pannel.parentType?a("el-form-item",{attrs:{label:"版块标题",required:""}},[a("div",[e._v(e._s(e.pannel.groupTitle)+" "+e._s(!1===e.pannel.showTitle?"(前端不显示)":""))])]):e._e(),e.selectedLayout?a("el-form-item",{attrs:{label:"版块布局"}},[a("div",[e._v(e._s(e.selectedLayout.layoutName)+"("+e._s(e.selectedLayout.layoutId)+")"+e._s(e.pannel.lucenyFlag?"(透明)":""))])]):e._e(),a("el-form-item",{attrs:{label:"落焦形式",required:""}},[e._v("\n              "+e._s(e.$consts.panelFocusText[e.pannel.focusShape])+"\n            ")]),e.isShowfocusImgUrl&&0===e.pannel.focusShape?a("el-form-item",{attrs:{label:"异形焦点"}},[a("div",[e.pannel.focusImgUrl?a("img",{staticStyle:{"margin-top":"10px",width:"200px",border:"1px solid #eee"},attrs:{src:e.pannel.focusImgUrl}}):e._e()])]):e._e(),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isShowTagsField,expression:"isShowTagsField"}],staticClass:"tag-list",attrs:{label:"资源共有标签"}},e._l(e.sharedTags,function(t,i){return a("el-tag",{key:i,attrs:{type:"primary"}},[e._v(e._s(t))])}),1),a("el-form-item",{attrs:{label:"推荐位"}},[a("div",{staticClass:"pannel-blocks"},["group"===e.pannel.parentType?[a("el-tabs",{attrs:{type:"card"},model:{value:e.activePannelIndex,callback:function(t){e.activePannelIndex=t},expression:"activePannelIndex"}},e._l(e.pannel.pannelList,function(t,i){return a("el-tab-pane",{key:i,attrs:{name:i.toString()}},[a("span",{attrs:{slot:"label"},on:{dblclick:function(t){return e.handleSetPanelGroupInfoStart(i)}},slot:"label"},[e._v("\n                        "+e._s(t.pannelTitle)+" "+e._s(t.panelIsFocus&&""===e.pannel.focusConfig?"(默认落焦)":"")+"\n                      ")]),a("VirtualPanel",{attrs:{blocks:t.contentList},on:{"click-block":e.handleClickBlock}})],1)}),1)]:a("VirtualPanel",{attrs:{blocks:e.pannel.pannelList[0].contentList},on:{"click-block":e.handleClickBlock}})],2)])],1)]:e._e()],2),e.activePanelGroup?a("PanelGroupInfoSetter",{attrs:{info:e.activePanelGroup,mode:e.mode,"panel-list":e.pannel.pannelList,"focus-config":e.pannel.focusConfig},on:{"set-end":e.handleSetPanelGroupInfoEnd,"set-cancel":e.handleSetPanelGroupInfoCancel}}):e._e(),e.showAddTagDialog?a("TagFrame",{attrs:{"is-batch":!0,ids:e.panelResourceIds},on:{close:e.handleBatchAddTagEnd}}):e._e()],1)],1),"block_content"==e.activePage?a("PageContentWrapper",[a("BlockContent",{attrs:{mode:e.mode,data:e.blockContentProps,source:e.pannel.pannelResource,pannel:e.pannel.pannelList[+e.activePannelIndex],"hide-title-options":!!e.blockContentProps.blockInfo.title_info},on:{cancel:e.handleSetBlockContentCancle,save:e.handleSetBlockContentEnd}})],1):e._e()],1)},Ru=[],Nu=(a("3b2b"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-wrapper"},[e._t("default")],2)}),Eu=[],Ou={},Au=Ou,Vu=(a("d0fb"),Object(Bn["a"])(Au,Nu,Eu,!1,null,"9270acd6",null)),Mu=Vu.exports,Bu=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-content-wrapper"},[e._t("default")],2)},Uu=[],ju={},Gu=ju,Wu=(a("d610"),Object(Bn["a"])(Gu,Bu,Uu,!1,null,"73e9d528",null)),qu=Wu.exports,Hu={create:"创建",read:"预览",edit:"编辑",replicate:"",copy:"复制"},zu={props:["titlePrefix"],computed:{title:function(){var e=this.mode,t=this.resourceName||"",a="replicate"===e?"创建".concat(t,"副本"):(Hu[e]||"")+t,i=this.titlePrefix;return i?"".concat(i," / ").concat(a):a}}},Ju=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:{"cc-virtual-pannel":!0,"cc-virtual-pannel--show-title":e.showTitle},style:e.pannelStyle},e._l(e.blockItems,function(t,i){return a("div",{key:i},[a("div",{class:{"cc-virtual-pannel__block":!0,"cc-virtual-pannel__block--duplicated":t.duplicated},style:t.style,attrs:{draggable:e.draggable},on:{dragstart:function(t){return e.handleDragStart(i,t)},dragover:function(t){return e.handleDragOver(i,t)},drop:e.handleDrop,click:function(t){return e.handleClickBlock(i)}}},[t.img?a("img",{staticClass:"cc-virtual-pannel__block-post",attrs:{src:t.img}}):e._e(),e._l(t.cornerList,function(t,i){return[t.imgUrl?a("img",{key:i,staticClass:"corner-img",style:{position:"absolute",top:0===t.position||1===t.position?0:void 0,buttom:2===t.position||3===t.position?0:void 0,left:0===t.position||3===t.position?0:void 0,right:1===t.position||2===t.position?0:void 0},attrs:{src:t.imgUrl}}):e._e()]}),a("div",{staticClass:"cc-virtual-pannel__block-base-info"},[a("span",{staticClass:"seq-num"},[e._v(e._s(t.content.vContentId||i+1))]),a("span",{staticClass:"size-mark"},[e._v(e._s(t.width)+"*"+e._s(t.height))])]),t.isExtra?a("span",{staticClass:"cc-virtual-pannel__block-remove",on:{click:function(t){return t.stopPropagation(),e.handleRemoveBlock(i)}}},[e._v("x")]):e._e(),t.content?[t.content.secKillPrice>0?a("div",{staticClass:"specialSamll cc-virtual-pannel__block-price",attrs:{name:"smallPrice"}},[a("span",{staticClass:"sec-kill-price"},[e._v("￥"+e._s(e.fixPrice(t.content.secKillPrice)))]),a("span",[e._v("￥"+e._s(e.fixPrice(t.content.price)))])]):t.content.price>0?a("div",{staticClass:"specialSamll cc-virtual-pannel__block-price",attrs:{name:"smallPrice"}},[a("span",[e._v("￥"+e._s(e.fixPrice(t.content.price)))])]):e._e(),e.showTitle?a("div",{staticClass:"cc-virtual-pannel__title",attrs:{title:t.content.title}},[e._v(e._s(t.content.title))]):e._e()]:e._e()],2),t.titleStyle?a("div",{staticClass:"cc-virtual-pannel__block-title",style:t.titleStyle,attrs:{title:t.content.title}},[e._v(e._s(t.content.title||"title"))]):e._e()])}),0)},Ku=[],Qu={template:"#cc-virtual-panel",data:function(){return{blockItems:[],pannelStyle:{},dragIndex:void 0,dropIndex:void 0}},props:["blocks","ratio","draggable","showTitle"],watch:{blocks:"computeBlockItems"},methods:{handleDragStart:function(e){this.dragIndex=e},handleDragOver:function(e,t){this.dropIndex=e,t.preventDefault()},handleDrop:function(){var e=this.dragIndex,t=this.dropIndex;void 0!==e&&void 0!==t&&(this.$emit("drag",e,t),this.dragIndex=this.dropIndex=void 0)},handleRemoveBlock:function(e){this.$emit("remove-block",e)},handleClickBlock:function(e){this.$emit("click-block",e)},fixPrice:function(e){return Number((e/100).toFixed(2))},computeBlockItems:function(){this.showTitle;var e=this.blocks||[];if(0==e.length)return this.blockItems=[],void(this.pannelStyle={height:0});var t=this.ratio||.5,a=this.blocks.map(function(e){var a={title:e.title,isExtra:e.isExtra,duplicated:e.duplicated},i=e.contentPosition,n=e.resize||{},o=e.videoContentList||[],r=o[0]||{},l=e.titleInfo,s=n.y||i.y,c=n.x||i.x,u=i.height,d=i.width;if(a.top=s,a.left=c,a.height=u,a.width=d,a.style={top:s*t+"px",left:c*t+"px",height:u*t+"px",width:d*t+"px"},r.pictureUrl&&(a.img=r.pictureUrl),l){var p=l.width,h=l.height;a.titleStyle={top:(s+u)*t+"px",left:c*t+"px",width:p*t+"px",height:h*t+"px","line-height":h*t+"px"}}return a.content=r,a.cornerList=a.content.cornerList||[],a}),i=a[a.length-1],n=i.style,o=i.titleStyle||{},r=parseFloat(n.top)+parseFloat(n.height)+parseFloat(o.height||0)+"px";this.pannelStyle={height:r},this.blockItems=a}},created:function(){this.computeBlockItems()}},Xu=Qu,Yu=(a("4d21"),Object(Bn["a"])(Xu,Ju,Ku,!1,null,"b32dcc78",null)),Zu=Yu.exports,ed=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-radio-group",{attrs:{value:e.value,disabled:e.disabled},on:{input:function(t){return e.$emit("input",t)}}},e._l(e.$consts.sourceOptions,function(t,i){return a("el-radio",{key:i,attrs:{label:t.value}},[e._v("\n      "+e._s(t.label)+"\n    ")])}),1)},td=[],ad={props:["value","disabled"]},id=ad,nd=Object(Bn["a"])(id,ed,td,!1,null,null,null),od=nd.exports,rd=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("remote-selector-wrapper",{ref:"wrapper",staticClass:"layout-selector",attrs:{title:"选择布局"},on:{"select-start":e.handleSelectStart}},[a("div",{attrs:{slot:"filter"},slot:"filter"},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"布局ID"}},[a("el-input",{model:{value:e.filter.layoutId,callback:function(t){e.$set(e.filter,"layoutId",t)},expression:"filter.layoutId"}})],1),a("el-form-item",{attrs:{label:"布局名称"}},[a("el-input",{model:{value:e.filter.layoutName,callback:function(t){e.$set(e.filter,"layoutName",t)},expression:"filter.layoutName"}})],1),a("el-form-item",{attrs:{label:"布局分类"}},[a("el-select",{attrs:{clearable:""},model:{value:e.filter.layoutType,callback:function(t){e.$set(e.filter,"layoutType",t)},expression:"filter.layoutType"}},e._l(e.layoutTypeOptoins,function(e){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})}),1)],1),a("el-form-item",{attrs:{label:"布局标题"}},[a("el-select",{attrs:{clearable:""},model:{value:e.filter.layoutIsTitle,callback:function(t){e.$set(e.filter,"layoutIsTitle",t)},expression:"filter.layoutIsTitle"}},[a("el-option",{attrs:{value:0,label:"不带标题"}}),a("el-option",{attrs:{value:1,label:"带标题"}})],1)],1)],1),a("div",{staticClass:"filter-form__actions"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleFilter}},[e._v("查询")]),a("el-button",{attrs:{type:"warning"},on:{click:e.handleResetFilter}},[e._v("重置")])],1)],1),a("div",{attrs:{slot:"item-list"},slot:"item-list"},[a("Table",{attrs:{data:e.table.data,header:e.table.header,selected:e.table.selected,props:e.table.props,"selection-type":e.selectionType||e.table.selectionType,"select-on-row-click":!0},on:{"row-dblclick":e.handleRowDblClick,"row-selection-change":e.handleTableRowSelectionChange}}),a("el-dialog",{attrs:{title:"请输入预置推荐位个数",visible:e.showBlockCountDialog,"append-to-body":!0},on:{"update:visible":function(t){e.showBlockCountDialog=t}}},[a("el-form",{ref:"blockCountForm",attrs:{model:e.formBlock,rules:e.formBlockRules},nativeOn:{submit:function(t){return e.emitSelectEnd(t)}}},[a("el-form-item",{attrs:{label:"推荐位个数",prop:"count"}},[a("el-input",{attrs:{placeholder:e.blockCountPlaceholder},on:{keypress:function(e){e.preventDefault(),e.stopPropagation()}},model:{value:e.formBlock.count,callback:function(t){e.$set(e.formBlock,"count",e._n(t))},expression:"formBlock.count"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showBlockCountDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.emitSelectEnd}},[e._v("确 定")])],1)],1)],1),a("el-pagination",{attrs:{slot:"pagination","current-page":e.pagination.page,"page-sizes":[15,20,30],"page-size":e.pagination.rows,layout:"total, sizes, prev, pager, next, jumper",total:e.pagination.total},on:{"size-change":function(t){e.pagination.rows=t},"current-change":function(t){e.pagination.page=t}},slot:"pagination"}),a("div",{attrs:{slot:"actions"},slot:"actions"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSelectEnd}},[e._v("确定")]),a("el-button",{on:{click:function(t){return e.$refs.wrapper.handleSelectCancel()}}},[e._v("取消")])],1),e._t("default")],2)},ld=[],sd=[{label:"主页6.0",value:1},{label:"影视V2",value:2}],cd=sd.reduce(function(e,t){return(e[t.value]=t.label)&&e},{}),ud={components:{Table:Dn["Table"],RemoteSelectorWrapper:Qo},data:function(){return{options:[],showBlockCountDialog:!1,layoutTypeOptoins:sd,layoutTypeLabels:cd,selectedLayout:null,formBlock:{count:void 0},formBlockRules:{count:[{required:!0,validator:this.validateNum,trigger:"blur"}]},pagination:{page:1,rows:15,total:0},filter:this.getDefaultFilter(),table:{data:[],selected:[],header:[{label:"ID",prop:"layoutId"},{label:"名称",prop:"layoutName",width:200},{label:"分类",width:200,render:function(e,t){var a=t.row;return cd[a.layoutType]}},{label:"预览",render:function(e){return""}},{prop:"createdDate",label:"创建时间",width:190},{prop:"modifierName",label:"更新人",width:120}],selectionType:"single"},selected:[]}},props:["selectionType"],watch:{"pagination.page":"fetchData","pagination.rows":"fetchData"},computed:{blockCountPlaceholder:function(){var e=this.selectedLayout||{},t=e.layoutJsonParsed,a=t&&t.contents.length;if(a)return"请输入大于或等于"+a+"的数"}},methods:{validateNum:function(e,t,a){var i=/^[1-9]\d*$/,n=this.selectedLayout.layoutJsonParsed.contents.length;i.test(t)?t<n?a(new Error("请输入大于或等于"+n+"的数")):a():a(new Error("请输入个数"))},handleRowDblClick:function(e){this.handleTableRowSelectionChange(e,this.table.data.indexOf(e)),this.handleSelectEnd()},getDefaultFilter:function(){return{layoutStatus:this.$consts.status.accepted,layoutId:void 0,layoutName:void 0,layoutType:void 0,layoutIsTitle:void 0}},resetPageAndSelect:function(){this.selected=[],this.table.selected=void 0,this.pagination.page=1},handleFilter:function(){this.resetPageAndSelect(),this.fetchData()},handleResetFilter:function(){this.filter=this.getDefaultFilter(),this.resetPageAndSelect(),this.fetchData()},handleSelectStart:function(){this.formBlock={count:void 0},this.handleResetFilter()},handleSelectEnd:function(){var e=this.selected[0];if(e){var t=JSON.parse(e.layoutJson),a=t.type;e.layoutJsonParsed=t,this.selectedLayout=e,"Expander"===a||"Lengthwise"===a?this.showBlockCountDialog=!0:this.emitSelectEnd()}else this.$message({message:"请选择一条记录",type:"warning"})},emitSelectEnd:function(){this.showBlockCountDialog?this.$refs.blockCountForm.validate(function(e){e&&(this.showBlockCountDialog=!1,this.$refs.wrapper.handleSelectEnd(),this.$emit("select-end",this.selectedLayout,this.formBlock.count))}.bind(this)):(this.$refs.wrapper.handleSelectEnd(),this.$emit("select-end",this.selectedLayout,this.formBlock.count))},fetchData:function(){var e=this,t=JSON.parse(JSON.stringify(this.filter)),a=this.pagination;t.page=a.page,t.rows=a.rows,this.$service.getLayoutInforPageList(t).then(function(t){e.table.data=t.rows,e.pagination.total=t.total,e.selected=[],e.table.selected=void 0})},handleTableRowSelectionChange:function(e,t){this.selected=[e],this.table.selected=t},handleTableRowSelectionAdd:function(e){this.selected=this.selected.concat(e),this.updateTableSelected()},updateTableSelected:function(){var e=this.table,t=this.selected.map(function(e){return e.id});e.selected=e.data.reduce(function(e,a,i){return t.indexOf(a[idField])>-1&&e.push(i),e},[])}},created:function(){var e=this;this.$service.getDictType({type:"businessType"}).then(function(t){e.panelCategoryOptions=t,e.pannelCategoryOptionsIndexed=t.reduce(function(e,t){return e[t.dictId]=t.dictCnName,e},{})})}},dd=ud,pd=Object(Bn["a"])(dd,rd,ld,!1,null,null,null),hd=pd.exports,md=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("RemoteSelectorWrapper",{ref:"selectorWrapper",attrs:{title:e.title||"选择素材",filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination,disabled:e.disabled},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset,"pagination-change":e.fetchData,"select-end":e.handleSelectEnd,"select-start":e.fetchData}},[a("CardList",{attrs:{slot:"item-list",data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-change":e.handleRowSelectionChange},slot:"item-list",scopedSlots:e._u([{key:"row",fn:function(t){var i=t.row;return a("div",{staticClass:"box-list"},[a("p",{staticClass:"list-p"},[a("img",{staticClass:"list-img",attrs:{src:i.pictureUrl}})]),a("p",{staticClass:"list-title"},[e._v(e._s(i.pictureName))]),a("div",[e._v("\n        "+e._s(i.pictureId)+" / "+e._s(e.$consts.statusText[i.pictureStatus])+" / "+e._s(i.pictureResolution)+"\n      ")])])}}])}),a("div",{attrs:{slot:"actions"},slot:"actions"}),e._t("default")],2)},fd=[],gd={components:{Table:Dn["Table"],CardList:Dn["CardList"],RemoteSelectorWrapper:Qo},props:["title","pictureResolution","queryLongPoster","disabled"],data:function(){return{materialTypes:{},pictureStatus:{"审核通过":1,"待审核":2},picDialogVisible:!1,auditDialogVisible:!1,reviewPicUrl:null,filter:this.getDefaultFilter(),filterSchema:null,pagination:{currentPage:1,pageSize:15},selected:[],table:{props:{},data:[],selected:void 0,selectionType:"single"}}},methods:{getDefaultFilter:function(){var e={};return"10"!=this.$consts.idPrefix&&(e.idPrefix=this.$consts.idPrefix),e},handleRowSelectionChange:function(e,t){this.table.selected=t,this.$refs.selectorWrapper.handleSelectEnd()},handleFilterChange:function(){this.pagination.currentPage=1,this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),Object(j["a"])({},e)},fetchData:function(){var e=this;this.table.selected=void 0;var t=this.parseFilter(),a=this.pictureResolution;a&&(t.pictureResolution=a);var i=this.queryLongPoster;void 0!==i&&(t.queryLongPoster=i),this.$service.getResourceList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},getMaterialTypes:function(){var e=this;return this.$service.getMaterialTypes().then(function(t){t.forEach(function(t){e.materialTypes[t.dictCnName]=t.dictId})})},handleSelectEnd:function(){var e=this.table,t=e.data,a=e.selected;this.$emit("select-end",t[a]),this.table.selected=void 0}},created:function(){var e=this,t=co.a.map({pictureId:co.a.o.oneOf([co.a.value(""),co.a.number]).$msg("请输入数字").other("form",{label:" ",component:"Input",placeholder:"ID",cols:{item:3,wrapper:23}}),pictureName:co.a.o.string.other("form",{label:" ",component:"Input",placeholder:"素材名称",cols:{item:3,wrapper:23}}),pictureCategory:co.a.o.enum(this.materialTypes).other("form",{label:" ",component:"Select",placeholder:"素材类别",cols:{item:3,wrapper:23}}),pictureStatus:co.a.o.enum(this.pictureStatus).other("form",{label:" ",component:"Select",placeholder:"审核状态",cols:{item:3,wrapper:23}})}).other("form",{layout:"inline",footer:{cols:{item:3,wrapper:23},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});"10"!=this.$consts.idPrefix&&t.map({idPrefix:co.a.o.enum(this.$consts.idPrefixEnums).other("form",{label:" ",placeholder:"数据来源",component:"Select",layout:"inline",cols:{item:3,wrapper:18}})}),this.getMaterialTypes().then(function(){e.filterSchema=t})}},bd=gd,vd=(a("8177"),Object(Bn["a"])(bd,md,fd,!1,null,"35e442ef",null)),yd=vd.exports,wd=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("cancel")}}},["read"!==e.mode?a("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("\n    保存\n  ")]):e._e(),a("el-collapse",{staticClass:"wrapper-collapse",model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[a("el-collapse-item",{attrs:{title:"通用内容",name:"normal"}},[a("el-row",{staticClass:"addedContents-wrapper",attrs:{gutter:8}},e._l(e.normalContentList,function(t,i){return a("el-col",{key:i,attrs:{span:3}},[a("el-card",{class:{activeContent:"normal"===e.activeType&&i===e.activeIndex},attrs:{"body-style":{padding:"0px"}},nativeOn:{click:function(t){return e.handleActivate("normal",i)}}},[e.normalContentList.length>1?a("i",{staticClass:"remove-handle el-icon-close",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleRemoveContent(i,"normal")}}}):e._e(),a("img",{attrs:{src:t.pictureUrl,referrerpolicy:"no-referrer"}})])],1)}),1),"normal"===e.activeType?a("BlockForm",{ref:"normalBlockForm",attrs:{mode:e.mode,"check-crowd":e.checkCrowd,"content-type":"normal",source:e.source,data:e.data,pannel:e.pannel,"content-form":e.contentForm,"hide-title-options":e.hideTitleOptions},on:{click:function(e){e.stopPropagation()},"cover-type-change":e.handleCoverTypeChange}}):e._e()],1),a("el-collapse-item",{attrs:{title:"精细化定向内容",name:"specific"}},[a("el-row",{staticClass:"addedContents-wrapper",attrs:{gutter:8}},[a("read"===e.mode?"div":"draggable",{tag:"component",on:{start:e.handleDragConentStart,end:function(t){return e.handleDragConentEnd(t,"specific")}},model:{value:e.specificContentList,callback:function(t){e.specificContentList=t},expression:"specificContentList"}},e._l(e.specificContentList,function(t,i){return a("el-col",{key:i,attrs:{span:3}},[a("el-card",{class:{activeContent:"specific"===e.activeType&&i===e.activeIndex},attrs:{"body-style":{padding:"0px"}},nativeOn:{click:function(t){return e.handleActivate("specific",i)}}},["read"!==e.mode?a("i",{staticClass:"remove-handle el-icon-close",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleRemoveContent(i,"specific")}}}):e._e(),a("img",{attrs:{src:t.pictureUrl,referrerpolicy:"no-referrer"}})])],1)}),1),"read"!==e.mode?a("el-col",{attrs:{span:3}},[a("el-card",{nativeOn:{click:function(t){return e.handleAddContent("specific")}}},[a("i",{staticClass:"el-icon-plus"},[e._v("添加资源")])])],1):e._e()],1),"specific"===e.activeType?a("BlockForm",{ref:"specificBlockForm",attrs:{"content-type":"specific",mode:e.mode,"check-crowd":e.checkCrowd,data:e.data,source:e.source,pannel:e.pannel,"content-form":e.contentForm,"hide-title-options":e.hideTitleOptions},on:{click:function(e){e.stopPropagation()},"cover-type-change":e.handleCoverTypeChange}}):e._e()],1)],1)],1)},Id=[],Cd=a("768b"),Td=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.contentForm?a("el-form",{ref:"contentForm",staticClass:"block-content-form",attrs:{model:e.contentForm,rules:e.contentRule,"label-width":"120px"}},["specific"===e.contentType?[a("el-form-item",{attrs:{label:"内容类别",prop:"resourceType"}},[a("el-radio-group",{attrs:{disabled:e.isReadonly},model:{value:e.contentForm.resourceType,callback:function(t){e.$set(e.contentForm,"resourceType",t)},expression:"contentForm.resourceType"}},[a("el-radio",{attrs:{label:0}},[e._v("内容")]),a("el-radio",{attrs:{label:1}},[e._v("活动")])],1)],1),a("el-form-item",{attrs:{label:"关联定向人群",prop:"dmpRegistryInfo"}},[a("el-button",{attrs:{type:"primary",disabled:e.isReadonly},on:{click:e.handleSelectCrowdStart}},[e._v("添加人群")]),e.contentForm.dmpRegistryInfo?a("el-tag",{attrs:{type:"primary"}},[e._v("已选择: "+e._s(e.contentForm.dmpRegistryInfo.dmpPolicyName)+" / "+e._s(e.contentForm.dmpRegistryInfo.dmpCrowdName))]):e._e()],1)]:e._e(),a("el-form-item",{attrs:{label:"资源类别",prop:"coverType"}},[a("CommonSelector",{attrs:{disabled:e.isReadonly,type:"radio",value:e.contentForm.coverType,options:e.coverTypeEnums},on:{input:function(t){return e.$emit("cover-type-change",t)}}})],1),"media"===e.contentForm.coverType?a("el-form-item",{attrs:{label:"内容资源",prop:"extraValue1"}},[e.isReadonly?e._e():a("ResourceSelector",{ref:"resourceSelector",attrs:{"is-live":!0,"disable-partner":!!e.source,selectors:["video","edu","pptv","live","topic","rotate"],"selection-type":"single",source:e.source},on:{"select-end":e.handleSelectMediaEnd}},[a("el-button",[e._v("选择资源")])],1),e.contentForm.extraValue1?a("el-tag",{attrs:{type:"primary"}},[e._v("已选择: "+e._s(e.contentForm.extraValue1))]):e._e(),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.isReadonly&&e.contentForm.extraValue1,expression:"!isReadonly && contentForm.extraValue1"}],attrs:{plain:"",type:"primary"},on:{click:e.handleAddTagStart}},[e._v("打标签")])],1):e._e(),"app"===e.contentForm.coverType?a("el-form-item",{attrs:{label:"内容资源",prop:"extraValue1"}},[e.isReadonly?e._e():a("ResourceSelector",{ref:"resourceSelector",attrs:{"is-live":!0,selectors:["app"],"disable-partner":!!e.source,"selection-type":"single",source:e.source},on:{"select-end":e.handleSelectAppEnd}},[a("el-button",[e._v("选择资源")])],1),e.contentForm.extraValue1?a("el-tag",{attrs:{type:"primary"}},[e._v("已选择: "+e._s(e.contentForm.extraValue1))]):e._e()],1):e._e(),"specfic"===e.contentType?["custom"===e.contentForm.coverType?a("el-form-item",{attrs:{label:"内容类型"}},[a("el-select",{attrs:{disabled:e.isReadonly},model:{value:e.contentForm.blockResourceType,callback:function(t){e.$set(e.contentForm,"blockResourceType",t)},expression:"contentForm.blockResourceType"}},[a("el-option",{attrs:{label:"影视",value:1}}),a("el-option",{attrs:{label:"应用",value:0}}),a("el-option",{attrs:{label:"其他",value:-1}})],1)],1):e._e()]:e._e(),a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{attrs:{disabled:e.isReadonly},model:{value:e.contentForm.title,callback:function(t){e.$set(e.contentForm,"title","string"===typeof t?t.trim():t)},expression:"contentForm.title"}}),e.hideTitleOptions?e._e():a("el-checkbox",{attrs:{value:!e.contentForm.showTitle,disabled:e.isReadonly},on:{input:function(t){e.contentForm.showTitle=t?0:1}}},[e._v("关闭标题栏，仅图片运营")])],1),"block"!==e.contentForm.coverType?a("el-form-item",{attrs:{label:"副标题",prop:"subTitle"}},[a("el-input",{attrs:{disabled:e.isReadonly},model:{value:e.contentForm.subTitle,callback:function(t){e.$set(e.contentForm,"subTitle","string"===typeof t?t.trim():t)},expression:"contentForm.subTitle"}}),a("el-checkbox",{attrs:{value:!e.contentForm.showSubTitle,disabled:e.isReadonly},on:{input:function(t){e.contentForm.showSubTitle=t?0:1}}},[e._v("落焦不显示副标题")])],1):e._e(),a("el-form-item",{attrs:{label:"单集副标题",prop:"singleSubTitle"}},[a("el-input",{attrs:{disabled:e.isReadonly},model:{value:e.contentForm.singleSubTitle,callback:function(t){e.$set(e.contentForm,"singleSubTitle","string"===typeof t?t.trim():t)},expression:"contentForm.singleSubTitle"}}),e._v("有单集副标题时，优先显示单集副标题\n    ")],1),"block"!==e.contentForm.coverType?a("el-form-item",{attrs:{label:"内容海报",prop:"pictureUrl"}},[a("GlobalPictureSelector",{attrs:{disabled:e.isReadonly,"picture-resolution":e.resolution[0]+"*"+e.resolution[1]},on:{"select-end":e.handleSelectPostEnd}},[a("div",{staticClass:"post-box corner-box",style:{height:e.postSize.height+"px",width:e.postSize.width+"px",cursor:"pointer"}},[a("img",{attrs:{src:e.contentForm.pictureUrl,referrerpolicy:"no-referrer"}}),a("div",{staticClass:"post-info"},[[1,4,5].indexOf(e.contentForm.categoryId)>-1?a("div",{staticClass:"post-episode"},[e.contentForm.showSeries?a("span",{staticClass:"episode"},[1===e.contentForm.categoryId?[e._v("\n                  "+e._s("ended"===e.contentForm.publishStatus?e.contentForm.series?e.contentForm.series+"集全":"暂无":e.contentForm.series?"已更新至"+e.contentForm.series+"集":"暂无")+"\n                ")]:5===e.contentForm.categoryId?[e._v("\n                  "+e._s("ended"===e.contentForm.publishStatus?"":e.contentForm.variety?e.contentForm.variety:"暂无")+"\n                ")]:e._e()],2):e._e(),e.contentForm.showScore?a("span",{staticClass:"score"},[e._v(e._s(e.contentForm.score?e.contentForm.score+"分":""))]):e._e()]):e._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:e.contentForm.showTitle,expression:"contentForm.showTitle"}],staticClass:"post-title",attrs:{title:e.contentForm.title}},[e._v(e._s(e.contentForm.title))]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.contentForm.showTitle&&e.contentForm.showSubTitle,expression:"contentForm.showTitle && contentForm.showSubTitle"}],staticClass:"post-sub-title",attrs:{title:e.contentForm.singleSubTitle||e.contentForm.subTitle}},[e._v(e._s(e.contentForm.singleSubTitle||e.contentForm.subTitle))])]),e._l(e.contentForm.cornerList,function(t,i){return a("span",{key:i,class:["corner","corner-"+i],on:{click:function(e){e.stopPropagation()}}},[a("CornerSelector",{attrs:{disabled:e.isReadonly,position:i},on:{"select-end":function(t){return e.handleSelectCornerIconEnd(t,i)}}},[t.imgUrl?a("span",{staticClass:"corner-img-wrapper"},[a("img",{attrs:{src:t.imgUrl,referrerpolicy:"no-referrer"}}),a("i",{directives:[{name:"show",rawName:"v-show",value:!e.isReadonly,expression:"!isReadonly"}],staticClass:"el-icon-circle-close",attrs:{title:"删除角标"},on:{click:function(t){return t.stopPropagation(),e.handleRemoveCornerIcon(i)}}})]):a("div",{staticClass:"corner-add-icon-wrapper"},[a("i",{staticClass:"el-icon-plus"})])])],1)})],2)]),a("div",[a("el-checkbox",{attrs:{value:!e.contentForm.showSeries,disabled:e.isReadonly},on:{input:function(t){e.contentForm.showSeries=t?0:1}}},[e._v("\n          不展示期数\n        ")]),a("el-checkbox",{attrs:{value:!e.contentForm.showScore,disabled:e.isReadonly},on:{input:function(t){e.contentForm.showScore=t?0:1}}},[e._v("\n          不展示评分\n        ")])],1)],1):e._e(),e.shouldHaveBackupPicture?a("el-form-item",{attrs:{label:"替补海报",prop:"alternativePictureUrl"}},[a("GlobalPictureSelector",{attrs:{"picture-resolution":e.resolution[0]+"*"+e.resolution[1]},on:{"select-end":e.handleSelectBackupPostEnd}},[a("div",{staticClass:"post-box",style:{height:e.postSize.height+"px",width:e.postSize.width+"px",cursor:"pointer"}},[a("img",{attrs:{src:e.contentForm.alternativePictureUrl,referrerpolicy:"no-referrer"}})])])],1):e._e(),e._e(),e.contentForm.bgParams&&e.contentForm.bgParams.id?a("el-form-item",{attrs:{label:"背景图",prop:"bgImgUrl"}},[a("GlobalPictureSelector",{attrs:{disabled:e.isReadonly},on:{"select-end":e.handleSelectBgEnd}},[e.contentForm.bgImgUrl?a("img",{staticClass:"bg-img",attrs:{src:e.contentForm.bgImgUrl,referrerpolicy:"no-referrer"}}):a("div",{staticClass:"bg-placeholder"})])],1):e._e(),"media"===e.contentForm.coverType?a("el-form-item",{attrs:{label:"应用版本号",prop:"versionCode"}},[a("el-input",{attrs:{disabled:e.isReadonly},model:{value:e.contentForm.versionCode,callback:function(t){e.$set(e.contentForm,"versionCode","string"===typeof t?t.trim():t)},expression:"contentForm.versionCode"}})],1):e._e(),"block"===e.contentForm.coverType?a("el-form-item",{attrs:{label:"推荐位",prop:"vContentId"}},[e.isReadonly?e._e():a("ResourceSelector",{ref:"blockSelector",attrs:{"is-live":!0,selectors:["func","broadcast"],"selection-type":"single",source:e.source},on:{"select-end":e.handleSelectBlockEnd}},[a("el-button",[e._v("选择推荐位")])],1),e.contentForm.vContentId?a("el-tag",{attrs:{type:"primary"}},[e._v("已选择: "+e._s(e.contentForm.vContentId))]):e._e()],1):e._e(),e.isMall&&["custom","media","app"].indexOf(e.contentForm.coverType)>-1?a("el-form-item",{attrs:{label:"价格",prop:"price"}},[a("Price",{staticStyle:{"margin-right":"10px"},attrs:{min:"0",disabled:e.isReadonly},model:{value:e.contentForm.price,callback:function(t){e.$set(e.contentForm,"price","string"===typeof t?t.trim():t)},expression:"contentForm.price"}}),e._v("(元)\n    ")],1):e._e(),e.isMall&&["custom","media","app"].indexOf(e.contentForm.coverType)>-1?a("el-form-item",{attrs:{label:"秒杀价",prop:"secKillPrice"}},[a("Price",{staticStyle:{"margin-right":"10px"},attrs:{min:"0",disabled:e.isReadonly},model:{value:e.contentForm.secKillPrice,callback:function(t){e.$set(e.contentForm,"secKillPrice","string"===typeof t?t.trim():t)},expression:"contentForm.secKillPrice"}}),e._v("(元)\n    ")],1):e._e(),"normal"===e.contentType?["group"===e.data.pannelParentType||"Mall"===e.data.blockInfo.type||"media"!==e.contentForm.coverType&&"app"!==e.contentForm.coverType&&"custom"!==e.contentForm.coverType?e._e():a("el-form-item",{attrs:{label:"设置广告位",prop:"flagIsSetad"}},[a("el-radio-group",{attrs:{disabled:e.isReadonly},model:{value:e.contentForm.flagIsSetad,callback:function(t){e.$set(e.contentForm,"flagIsSetad",t)},expression:"contentForm.flagIsSetad"}},[a("el-radio",{attrs:{label:0}},[e._v("否")]),a("el-radio",{attrs:{label:1}},[e._v("是")])],1)],1)]:e._e(),"custom"===e.contentForm.coverType?[a("el-form-item",{attrs:{label:"打开方式"}},[a("el-select",{attrs:{disabled:e.isReadonly},on:{change:e.handleOpenModeChange},model:{value:e.contentForm.redundantParams.openMode,callback:function(t){e.$set(e.contentForm.redundantParams,"openMode",t)},expression:"contentForm.redundantParams.openMode"}},[a("el-option",{attrs:{label:"网页",value:"webpage"}}),a("el-option",{attrs:{label:"视频",value:"video"}}),a("el-option",{attrs:{label:"图片",value:"picture"}}),a("el-option",{attrs:{label:"版面",value:"tab"}}),a("el-option",{attrs:{label:"第三方应用",value:"app"}})],1),e.isReadonly?e._e():a("ClickEventSelector",{directives:[{name:"show",rawName:"v-show",value:"app"===e.contentForm.redundantParams.openMode,expression:"contentForm.redundantParams.openMode === 'app'"}],on:{"select-end":e.handleSelectClickEventEnd}},[a("el-button",{attrs:{type:"primary"}},[e._v("快速填充")])],1)],1),"webpage"===e.contentForm.redundantParams.openMode?[a("el-form-item",{attrs:{label:"网页类型",prop:"webpageType"}},[a("el-radio-group",{attrs:{disabled:e.isReadonly},on:{change:e.handleWebPageTypeChange},model:{value:e.contentForm.redundantParams.webpageType,callback:function(t){e.$set(e.contentForm.redundantParams,"webpageType",t)},expression:"contentForm.redundantParams.webpageType"}},[a("el-radio",{attrs:{label:"1"}},[e._v("浮窗网页")]),a("el-radio",{attrs:{label:"2"}},[e._v("全屏网页")])],1)],1),a("el-form-item",{key:"webpageUrl",attrs:{label:"网页地址",prop:"redundantParams.webpageUrl",rules:e.contentRule.webpageUrl}},[a("el-input",{attrs:{disabled:e.isReadonly},model:{value:e.contentForm.redundantParams.webpageUrl,callback:function(t){e.$set(e.contentForm.redundantParams,"webpageUrl","string"===typeof t?t.trim():t)},expression:"contentForm.redundantParams.webpageUrl"}})],1),a("el-form-item",{key:"webpage-versioncode",attrs:{label:"应用版本号",prop:"redundantParams.versioncode",rules:[{required:!0,message:"请输入版本号",trigger:"blur"}]}},[a("el-input",{attrs:{disabled:e.isReadonly},model:{value:e.contentForm.redundantParams.versioncode,callback:function(t){e.$set(e.contentForm.redundantParams,"versioncode","string"===typeof t?t.trim():t)},expression:"contentForm.redundantParams.versioncode"}})],1)]:e._e(),"video"===e.contentForm.redundantParams.openMode?[a("el-form-item",{key:"videoName",attrs:{label:"视频名称",prop:"redundantParams.videoName",rules:e.contentRule.videoName}},[a("el-input",{attrs:{disabled:e.isReadonly},model:{value:e.contentForm.redundantParams.videoName,callback:function(t){e.$set(e.contentForm.redundantParams,"videoName","string"===typeof t?t.trim():t)},expression:"contentForm.redundantParams.videoName"}})],1),a("el-form-item",{key:"videoUrl",attrs:{label:"视频地址",prop:"redundantParams.videoUrl",rules:e.contentRule.videoUrl}},[a("el-input",{attrs:{disabled:e.isReadonly},model:{value:e.contentForm.redundantParams.videoUrl,callback:function(t){e.$set(e.contentForm.redundantParams,"videoUrl","string"===typeof t?t.trim():t)},expression:"contentForm.redundantParams.videoUrl"}})],1)]:e._e(),"picture"===e.contentForm.redundantParams.openMode?[a("el-form-item",{key:"pictureUrl",attrs:{label:"选择图片",prop:"redundantParams.pictureUrl",rules:e.contentRule.pictureUrl}},[a("Upload",{ref:"upload",attrs:{multiple:!1,accept:"image/jpg,image/jpeg,image/png,image/bmp,image/gif"},on:{upload:e.handleUpload},scopedSlots:e._u([{key:"preview",fn:function(t){var i=t.fileList;return a("div",{staticClass:"upload-pic-list"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isReadonly&&0===i.length,expression:"!isReadonly && fileList.length === 0"}],staticClass:"upload-pic-list__add",on:{click:function(t){!e.isReadonly&&e.$refs.upload.handleSelectFile()}}}),i.length>0?a("div",{staticClass:"upload-pic-list__item",on:{click:function(t){!e.isReadonly&&e.$refs.upload.handleSelectFile()}}},["error"===i[0].status?a("div",{staticClass:"upload-pic-list__error"},[e._v("\n                  上传失败: "+e._s(i[0].message)+"\n                ")]):e._e(),"uploading"===i[0].status?a("div",{staticClass:"upload-pic-list__progress"},[a("el-progress",{attrs:{width:100,type:"circle",percentage:i[0].percentage}})],1):a("img",{attrs:{src:i[0].dataUrl}}),"uploading"===i[0].status||e.isReadonly?e._e():a("i",{staticClass:"upload-pic-list__remove el-icon el-icon-close",attrs:{title:"移除"},on:{click:function(t){return t.stopPropagation(),e.handleRemovePicture(i[0])}}})]):e._e()])}}],null,!1,64832960)}),a("span",[e._v("提示:只能上传png/gif/jpg/bmp文件")])],1)]:e._e(),"tab"===e.contentForm.redundantParams.openMode?[a("el-form-item",{key:"tabId",attrs:{label:"版面",prop:"redundantParams.tabId",rules:e.contentRule.tabId}},[a("TabSelector",{attrs:{disabled:e.isReadonly,title:"选择版面","selection-type":"single",source:e.source,"selected-close":!0},on:{"select-single":e.handleSelectTabEnd}}),e.contentForm.redundantParams.tabId?a("el-tag",{attrs:{type:"primary"}},[e._v("\n            已选择: "+e._s(e.contentForm.redundantParams.tabId)+"\n          ")]):e._e()],1)]:e._e(),"app"===e.contentForm.redundantParams.openMode?[e.isReadonly?a("AppParamsRead",{attrs:{value:e.contentForm.redundantParams}}):a("AppParamsForm",{key:"app",attrs:{"label-width":"140px","prop-prefix":"redundantParams."},model:{value:e.contentForm.redundantParams,callback:function(t){e.$set(e.contentForm,"redundantParams",t)},expression:"contentForm.redundantParams"}})]:e._e()]:e._e()],2):e._e(),e.showCrowdSelector?a("CrowdSelector",{on:{"select-cancel":e.handleSelectCrowdCancel,"select-end":e.handleSelectCrowdEnd}}):e._e(),e.showBlockTagDialog?a("TagFrame",{attrs:{ids:[e.currentResourceId]},on:{close:function(t){e.showBlockTagDialog=!1}}}):e._e()],1)},Sd=[],kd=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-input",{attrs:{disabled:e.disabled},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}})},_d=[],Pd=function(e){return parseFloat(e.toPrecision(12))},xd={data:function(){return{inputValue:void 0}},props:["value","disabled"],watch:{inputValue:"updateValue",value:"updateInputValue"},methods:{updateValue:function(e){var t=+e;isNaN(t)||0===t||(e=Pd(100*e)),this.$emit("input",e)},updateInputValue:function(e){var t=Pd(e/100);isNaN(t)||0===t?this.inputValue=e:t!==+this.inputValue&&(this.inputValue=t)}},created:function(){this.updateInputValue(this.value)}},Dd=xd,Fd=Object(Bn["a"])(Dd,kd,_d,!1,null,null,null),$d=Fd.exports,Ld=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form-item",{attrs:{label:"应用包名",prop:e.formProp("packagename"),rules:e.rules.packagename}},[a("el-input",{model:{value:e.inputValue.packagename,callback:function(t){e.$set(e.inputValue,"packagename","string"===typeof t?t.trim():t)},expression:"inputValue.packagename"}})],1),a("el-form-item",{attrs:{label:"应用版本号",prop:e.formProp("versioncode"),rules:e.rules.versioncode}},[a("el-input",{model:{value:e.inputValue.versioncode,callback:function(t){e.$set(e.inputValue,"versioncode","string"===typeof t?t.trim():t)},expression:"inputValue.versioncode"}})],1),a("el-form-item",{attrs:{label:"启动动作",prop:e.formProp("dowhat"),rules:e.rules.dowhat}},[a("el-select",{model:{value:e.inputValue.dowhat,callback:function(t){e.$set(e.inputValue,"dowhat",t)},expression:"inputValue.dowhat"}},e._l(e.dowhatOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"启动方式",prop:e.formProp("bywhat"),rules:e.rules.bywhat}},[a("el-select",{model:{value:e.inputValue.bywhat,callback:function(t){e.$set(e.inputValue,"bywhat",t)},expression:"inputValue.bywhat"}},e._l(e.bywhatOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"启动参数",prop:e.formProp("byvalue"),rules:e.rules.byvalue}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.inputValue.byvalue,callback:function(t){e.$set(e.inputValue,"byvalue","string"===typeof t?t.trim():t)},expression:"inputValue.byvalue"}})],1),a("el-form-item",{attrs:{label:"数据配置",prop:"formProp('data')"}},[a("el-input",{model:{value:e.inputValue.data,callback:function(t){e.$set(e.inputValue,"data","string"===typeof t?t.trim():t)},expression:"inputValue.data"}})],1),a("el-form-item",{attrs:{label:"扩展参数"}},[e._l(e.inputValue.params,function(t,i){return a("div",{key:i,staticClass:"app-extend-params"},[a("el-form-item",{attrs:{label:"key:","label-width":"60px",prop:e.formProp("params."+i+".key"),rules:e.rules.params.key}},[a("el-input",{model:{value:t.key,callback:function(a){e.$set(t,"key","string"===typeof a?a.trim():a)},expression:"param.key"}})],1),a("el-form-item",{attrs:{label:"value:","label-width":"60px",prop:e.formProp("params."+i+".value"),rules:e.rules.params.value}},[a("el-input",{model:{value:t.value,callback:function(a){e.$set(t,"value","string"===typeof a?a.trim():a)},expression:"param.value"}})],1),a("a",{staticClass:"app-params__remove-param",on:{click:function(t){return e.handleRemoveParam(i)}}},[a("i",{staticClass:"el-icon-minus"})])],1)}),a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleAddParam}},[a("i",{staticClass:"el-icon-plus"}),e._v(" 添加\n    ")])],2)],1)},Rd=[],Nd={data:function(){function e(e,t,a){/[！￥……（）——【】：；“”‘’、《》，。？\s+]/.test(t)?a(new Error("请勿输入特殊或空白字符")):a()}return{inputValue:{packagename:void 0,versioncode:void 0,dowhat:void 0,bywhat:void 0,byvalue:void 0,data:void 0,params:[],exception:{}},rules:{packagename:[{required:!0,message:"请输入应用包名",trigger:"blur"}],versioncode:[{required:!0,message:"请输入应用版本号",trigger:"blur"}],dowhat:[{required:!0,message:"请选择启动动作",trigger:"blur"}],bywhat:[{required:!0,message:"请选择启动方式",trigger:"blur"}],byvalue:[{required:!0,message:"请输入启动参数",trigger:"blur"}],params:{key:[{required:!0,message:"不能为空",trigger:"blur"},{validator:e,trigger:"blur"}],value:[{required:!0,message:"不能为空",trigger:"blur"},{validator:e,trigger:"blur"}]}}}},props:{value:{},propPrefix:{},dowhatOptions:{default:function(){return[{label:"startActivity",value:"startActivity"},{label:"startService",value:"startService"},{label:"sendBroadcast",value:"sendBroadcast"}]}},bywhatOptions:{default:function(){return[{label:"action",value:"action"},{label:"class",value:"class"},{label:"uri",value:"uri"}]}}},watch:{value:"setInputValue"},methods:{formProp:function(e){return(this.propPrefix||"")+e},genDefaultValue:function(){return{packagename:void 0,versioncode:void 0,dowhat:void 0,bywhat:void 0,byvalue:void 0,params:[]}},setInputValue:function(e){e!==this.inputValue&&(this.inputValue=Object.assign(this.genDefaultValue(),e))},emitInputValue:function(e){this.$emit("input",this.inputValue)},handleAddParam:function(){this.inputValue.params.push({key:void 0,value:void 0})},handleRemoveParam:function(e){this.inputValue.params.splice(e,1)}},created:function(){this.value&&this.setInputValue(this.value),this.$watch("inputValue",this.emitInputValue,{deep:!0})}},Ed=Nd,Od=(a("c34d"),Object(Bn["a"])(Ed,Ld,Rd,!1,null,"89fb68fa",null)),Ad=Od.exports,Vd=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form-item",{attrs:{label:"应用包名"}},[e._v(e._s(e.value.packagename))]),a("el-form-item",{attrs:{label:"应用版本号"}},[e._v(e._s(e.value.versioncode))]),a("el-form-item",{attrs:{label:"启动动作"}},[e._v(e._s(e.value.dowhat))]),a("el-form-item",{attrs:{label:"启动方式"}},[e._v(e._s(e.value.bywhat))]),a("el-form-item",{attrs:{label:"启动参数"}},[e._v(e._s(e.value.byvalue))]),a("el-form-item",{attrs:{label:"数据配置",prop:"formProp('data')"}},[e._v(e._s(e.value.data))]),a("el-form-item",{attrs:{label:"扩展参数"}},e._l(e.value.params,function(t,i){return a("div",{key:i,staticClass:"app-extend-params"},[a("el-form-item",{attrs:{label:"","label-width":"0px"}},[a("el-tag",[e._v("key")]),e._v(" \n        "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.key,placement:"top"}},[a("span",[e._v(e._s(t.key))])])],1),a("el-form-item",{attrs:{label:"","label-width":"0px"}},[a("el-tag",[e._v("value")]),e._v(" \n        "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.value,placement:"top"}},[a("span",[e._v(e._s(t.value))])])],1)],1)}),0)],1)},Md=[],Bd={template:"#cc-app-params-read",data:function(){return{}},props:["value"],created:function(){}},Ud=Bd,jd=(a("51db"),Object(Bn["a"])(Ud,Vd,Md,!1,null,"012ef109",null)),Gd=jd.exports,Wd=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("RemoteSelectorWrapper",{attrs:{title:e.title||"选择角标",filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination,disabled:e.disabled},on:{"pagination-change":e.fetchData,"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset,"select-end":e.handleSelectEnd,"select-start":e.fetchData}},[a("CardList",{attrs:{slot:"item-list",data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-change":e.handleRowSelectionChange},slot:"item-list",scopedSlots:e._u([{key:"row",fn:function(t){var i=t.row;return[a("div",{staticClass:"list-item__img-wrapper"},[a("img",{staticClass:"list-item__img",attrs:{src:i.imgUrl}})]),a("div",{staticClass:"list-item__info"},[e._v("\n          "+e._s(i.cornerIconName)+"\n          "),a("br"),e._v("\n          "+e._s(1==i.pictureStatus?"审核通过":"待审核")+"\n        ")])]}}])}),e._t("default")],2)},qd=[],Hd={components:{Table:Dn["Table"],CardList:Dn["CardList"],RemoteSelectorWrapper:Qo},props:["title","position","disabled"],data:function(){return{reviewPicUrl:null,filter:this.getDefaultFilter(),filterSchema:null,pagination:{currentPage:1,pageSize:30},selected:[],table:{props:{},data:[],selected:void 0,selectionType:"single"}}},methods:{getDefaultFilter:function(){var e=this.$consts.idPrefix;return{cornerIconId:void 0,cornerIconName:void 0,typeId:void 0,idPrefix:"10"!=e?e:void 0}},handleRowSelectionChange:function(e,t){this.table.selected=t},handleFilterChange:function(){this.pagination.currentPage=1,this.fetchData()},handleFilterReset:function(){this.filter=this.getDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination,a=this.position;return t&&(e.page=t.currentPage,e.rows=t.pageSize),void 0!==a&&(e.typePosition=a),e},fetchData:function(){var e=this;this.table.selected=void 0;var t=this.parseFilter();this.pictureResolution&&(t.pictureResolution=this.pictureResolution),this.$service.getCornerList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},getMaterialTypes:function(){var e=this;return this.$service.getMaterialTypes().then(function(t){t.forEach(function(t){e.materialTypes[t.label]=t.id})})},handleSelectEnd:function(){var e=this.table,t=e.data,a=e.selected;this.$emit("select-end",t[a]),this.table.selected=void 0}},created:function(){var e=this;this.$service.getCornerTypes().then(function(t){var a=t.reduce(function(e,t){return(e[t.typeName]=t.typeId)&&e},{}),i=co.a.map({cornerIconId:co.a.o.oneOf([co.a.value(""),co.a.number]).$msg("请输入数字").other("form",{component:"Input",label:" ",placeholder:"ID",cols:{item:3,wrapper:23}}),cornerIconName:co.a.o.string.other("form",{label:" ",placeholder:" 角标名称",cols:{item:3,wrapper:23}}),typeId:co.a.o.enum(a).other("form",{component:"Select",label:" ",placeholder:"角标类型",cols:{item:3,wrapper:23}})}).other("form",{layout:"inline",footer:{cols:{item:3,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}}),n=e.$consts.idPrefix;"10"!=n&&i.map({idPrefix:co.a.o.enum(e.$consts.idPrefixEnums).other("form",{label:" ",placeholder:"数据来源",component:"Select",layout:"inline",cols:{item:3,wrapper:23}})}),e.filterSchema=i})}},zd=Hd,Jd=(a("4c87"),Object(Bn["a"])(zd,Wd,qd,!1,null,"52aa8fc6",null)),Kd=Jd.exports,Qd=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"crowd-selector"},[a("el-dialog",{attrs:{title:"选择策略",visible:e.showPolicySelector,"append-to-body":"","before-close":e.handleClose}},[a("div",{staticClass:"name-list"},e._l(e.policy.items,function(t){return a("div",{key:t.value,staticClass:"name-list__item",attrs:{title:t.label},on:{click:function(a){return e.handleSelectPolicy(t)}}},[e._v("\n                "+e._s(t.label)+"\n            ")])}),0)]),a("el-dialog",{attrs:{title:"选择人群","append-to-body":"",visible:e.showCrowdSelector,"before-close":e.handleSelectCrowdCancel}},[e.hasCascadeTag?a("div",[a("el-cascader",{attrs:{options:e.crowd.cascadeItems,filterable:"",expandTrigger:"hover",disabled:0===e.crowd.cascadeItems.length,placeholder:e.crowd.cascadeItems.length>0?"请选择":"无人群数据","change-on-select":""},model:{value:e.selectedCascaderCrowd,callback:function(t){e.selectedCascaderCrowd=t},expression:"selectedCascaderCrowd"}}),a("el-button",{attrs:{disabled:!e.selectedCascaderCrowd,type:"primary"},on:{click:e.handleSelectCascadeCrowd}},[e._v("\n                确定\n            ")])],1):a("div",{staticClass:"name-list"},e._l(e.crowd.items,function(t){return a("div",{key:t.value,staticClass:"name-list__item",attrs:{title:t.label},on:{click:function(a){return e.handleSelectCrowd(t)}}},[e._v("\n                "+e._s(t.label)+"\n            ")])}),0)])],1)},Xd=[],Yd={data:function(){return{hasCascadeTag:!1,showPolicySelector:!0,showCrowdSelector:!1,selectedPolicy:void 0,selectedCrowd:void 0,selectedCascaderCrowd:void 0,policy:{pagination:{},items:[]},crowd:{pagination:{},items:[],cascadeItems:[]}}},props:["selectedPolicyId","selectedCrowdId"],methods:{handleClose:function(){this.showCrowdSelector=!1,this.showPolicySelector=!1,setTimeout(function(){this.$emit("select-cancel")}.bind(this),20)},handleSelectPolicy:function(e){this.selectedPolicy=e,this.$service.crowdRelGet({id:e.value}).then(function(t){t.hasCascadeTag?(this.hasCascadeTag=!0,this.crowd.items=t.crowdRelationship.items||[],this.crowd.cascadeItems=this.listToTree(t.crowdRelationship.items),this.showCrowdSelector=!0):this.$service.getCrowdOfPolicyWithCache({id:e.value}).then(function(e){this.hasCascadeTag=!1,this.crowd.items=e,this.showCrowdSelector=!0}.bind(this))}.bind(this))},handleSelectCrowd:function(e){this.selectedCrowd=e,this.selectEnd()},handleSelectCascadeCrowd:function(){var e=this.selectedCascaderCrowd.slice(-1)[0];this.selectedCrowd=this.crowd.items.find(function(t){return t.value===e}),this.selectEnd()},handleSelectCrowdCancel:function(){this.showCrowdSelector=!1},selectEnd:function(){this.$emit("select-end",this.selectedPolicy,this.selectedCrowd)},listToTree:function(e,t){e=JSON.parse(JSON.stringify(e)),t=t||{};for(var a,i,n,o=t.idKey||"value",r=t.parentKey||"parentValue",l=t.childrenKey||"children",s=[],c={},u=0,d=e.length;u<d;u++)a=e[u],i=a[o],n=a[r]||0,c[i]=c[i]||[],a[l]=c[i],0!=n?(c[n]=c[n]||[],c[n].push(a)):s.push(a);return s}},created:function(){this.$service.getCrowdPolicy().then(function(e){this.policy.items=e,console.log(e)}.bind(this))}},Zd=Yd,ep=(a("a536"),Object(Bn["a"])(Zd,Qd,Xd,!1,null,"95579770",null)),tp=ep.exports,ap=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("RemoteSelectorWrapper",{ref:"wrapper",attrs:{"custom-class":"resource-selector"},on:{"select-start":e.handleSelectStart},scopedSlots:e._u([{key:"content",fn:function(t){var i=t.isShow;return[e.isLive||i?a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"pannelGroupId","is-live":e.isLive,"selection-type":e.selectionType||"single",table:e.table,filter:e.filter,"filter-schema":e.filterSchema,pagination:e.pagination},on:{"pagination-change":e.fetchData,"filter-change":e.handleFilterChange,"filter-reset":e.handleResetFilter,"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}}):e._e()]}}])},[e._t("default")],2)},ip=[];co.a.addMsgs({required:"不能为空",enum:"请选择一项",enumList:"请选择一项",number:"请填写数字"});var np,op,rp,lp,sp=co.a,cp={data:function(){var e=this.$consts.statusOptions.filter(function(e){return[3,4,7].indexOf(e.value)>-1});e.reduce(function(e,t){return e[t.value]=t.label,e},{});return{pagination:{currentPage:1,pageSize:15,total:0},filter:{},filterSchema:null,table:{props:{},header:[{label:"ID",prop:"commonOnclickId",width:"70"},{label:"点击事件名称",prop:"onlickName"},{label:"备注",prop:"remark"},{label:"修改人",prop:"modifierName"},{label:"修改时间",prop:"lastUpdateDate",width:"170"}],data:[],selected:[]},selected:[],originSelected:[]}},props:["isLive","source","selectionType"],components:{RemoteSelectorWrapper:Qo,BaseSelector:nr},methods:{handleSelectStart:function(){this.$emit("select-start"),this.fetchData()},handleSelectCancel:function(){this.$refs.wrapper.handleSelectCancel()},handleSelectEnd:function(e){this.$emit("select-end",e),this.$refs.wrapper.handleSelectEnd()},getDefaultFilter:function(){return{}},handleFilterChange:function(e){this.filter=e,this.pagination.currentPage=1,this.fetchData()},handleResetFilter:function(){this.filter=this.getDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();this.$service.getClickData(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=sp.map({commonOnclickId:sp.o.oneOf([sp.value(""),sp.number]).$msg("请输入数字").other("form",{component:"Input",placeholder:"ID"}),onlickName:sp.o.string.other("form",{component:"Input",placeholder:"点击事件名称"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},up=cp,dp=Object(Bn["a"])(up,ap,ip,!1,null,null,null),pp=dp.exports,hp=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("FrameDialog",{attrs:{url:e.url},on:{close:function(t){return e.$emit("close")}}})},mp=[],fp=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"cc-frame-dialog__dialog",attrs:{title:"批量打标签",visible:!0,fullscreen:!0,"before-close":e.handleClose}},[a("div",[a("iframe",{staticClass:"cc-frame-dialog__frame",attrs:{src:e.url}})])])},gp=[],bp={data:function(){return{}},props:["url"],methods:{handleClose:function(){this.$emit("close")}}},vp=bp,yp=(a("ad40"),Object(Bn["a"])(vp,fp,gp,!1,null,"ddcdbaae",null)),wp=yp.exports,Ip={components:{FrameDialog:wp},props:["ids","isBatch"],data:function(){return{}},computed:{url:function(){var e=this.isBatch,t=e?"coocaaVIds":"coocaaVId",a=this.ids||[],i=/^(127|172)/.test(location.host)?"http://dev-mgr-media.tc.cc0808.com":"http://mgr.media.tc.skysrt.com";return i+"/ccGlobalMediaTag/".concat(e?"batch":"com",".html?referrer=homepage&enableDelete=0&").concat(t,"=")+a.join(",")}}},Cp=Ip,Tp=Object(Bn["a"])(Cp,hp,mp,!1,null,null,null),Sp=Tp.exports,kp={components:{Upload:Dn["Upload"],Price:$d,AppParamsForm:Ad,CornerSelector:Kd,GlobalPictureSelector:yd,ResourceSelector:ql,CommonSelector:Br,CrowdSelector:tp,TabSelector:Hc,ClickEventSelector:pp,AppParamsRead:Gd,TagFrame:Sp},data:function(){var e=this,t=this.isReadonly,a=function(t,a,i){3===e.contentForm.contentType&&a.length>0&&a.length<7?i(new Error("教育版本号需为7位以上")):i()},i=function(e,t,a){t?-1===t.indexOf("https")&&-1===t.indexOf("http")?a(new Error("请输入https或http地址")):a():a(new Error("请输入网页地址"))},n=function(e,t,a){"specific"!==_this.contentFormType||_this.contentForm.attributeInfo||_this.isReadonly?a():a(new Error("请选择人群"))},o=/^(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*))$/,r=function(e,t,a){o.test(t)?-1!==t.toString().indexOf(".")?a(new Error("只允许输入小数点后两位")):a():0===t&&""!==t?a():a(new Error("请输入合法的价格"))},l=function(e,t,a){var i=/^(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*))$/;i.test(t)?-1!==t.toString().indexOf(".")?a(new Error("只允许输入小数点后两位")):a():""===t?a():a(new Error("请输入合法的价格"))};return{showCrowdSelector:!1,showBlockTagDialog:!1,uploadImg:"/uploadHomeImg.html",contentRule:{bgImgUrl:[{required:!0,message:"请选择背景图"}],webpageUrl:[{required:!0,validator:i,trigger:"blur"}],videoName:[{required:!0,message:"请输入视频名称",trigger:"blur"}],videoUrl:[{required:!0,message:"请输入视频地址",trigger:"blur"}],tabId:[{required:!0,message:"请选择版面",trigger:"blur"}],moviePercent:[{type:"number",required:!0,message:"请输入进度",trigger:"blur"}],extraValue1:[{required:!0,message:"请选择资源",trigger:"blur"}],title:[{validator:function(e,t,a){this.contentForm.showTitle&&""===t.trim()?a(new Error("请输入标题")):a()}.bind(this)},{max:45,message:"不超过 45 个字符",trigger:"blur"}],subTitle:[{max:45,message:"不超过 45 个字符",trigger:"blur"}],pictureUrl:[{required:!0,message:"不能为空",trigger:"blur"}],alternativePictureUrl:[{required:!0,message:"请选择替补海报",trigger:"blur"},{validator:function(e,t,a){t&&"webp"===t.slice(-4).toLowerCase()?a(new Error("替补海报不能选择动图")):a()}}],vContentId:[{type:"number",required:!0,message:"请选择功能",trigger:"blur"}],attributeInfo:[{validator:n,trigger:"blur"}],versionCode:[{validator:a,trigger:"blur"}],price:[{required:!0,validator:r,trigger:"blur"}],secKillPrice:[{required:!1,validator:l,trigger:"blur"}],dmpRegistryInfo:[{required:!t,message:"请选择定向人群"}]}}},props:["contentType","mode","contentForm","data","source","pannel","hideTitleOptions","checkCrowd"],computed:{currentResourceId:function(){return this.contentForm.extraValue1},isReadonly:function(){return"read"===this.mode},resolution:function(){var e=this.data;return[e.blockInfo.width,e.blockInfo.height]},postSize:function(){var e=this.data.blockInfo||{},t=e.width||200,a=e.height||200,i=800,n=600,o=1;if(t<a){var r=200*a/t;return r>n&&(o=n/r),{height:r*o,width:200*o}}var l=200*t/a;return l>i&&(o=i/l),{height:200*o,width:l*o}},isMall:function(){return"Mall"===this.data.blockInfo.type},shouldHaveBackupPicture:function(){var e=this.contentForm,t=e.pictureUrl;return"block"!==e.coverType&&!this.isNormalPicture(t)},coverTypeEnums:function(){var e=[{label:"媒体资源",value:"media"},{label:"应用圈",value:"app"},{label:"自定义",value:"custom"},{label:"推荐位管理",value:"block",disabled:this.isMall}];return"specific"===this.contentType?e.filter(function(e){return"media"===e.value||"custom"===e.value}):e}},methods:{handleAddTagStart:function(){this.showBlockTagDialog=!0},genParams:function(e){return{openMode:e||"app",webpageUrl:"",webpageType:"2",videoName:"",videoUrl:"",pictureUrl:"",tabId:"",packagename:"",versioncode:"webpage"===e?"102007":"-1",dowhat:"startActivity",bywhat:"action",byvalue:"",data:void 0,params:[{key:"",value:""}]}},handleUpload:function(e,t){var a=this;this.$refs.upload.fileList=[t],t.status="uploading",this.$service.uploadImage({file:e,onUploadProgerss:function(e){e.lengthComputable&&(t.percentage=e.loaded/e.total)}}).then(function(e){if(e.success){var i=e.data[0];t.pictureName=i.fileName,t.pictureType=i.fileType,t.pictureUrl=i.url,t.status="success",a.contentForm.redundantParams.pictureUrl=i.url}else t.status="error",t.message=e.msg}).catch(function(){t.status="error",t.message="网络错误"})},handleRemovePicture:function(e){this.$refs.upload.handleRemove(e),this.contentForm.redundantParams.pictureUrl=""},handleSelectTabEnd:function(e){var t=e;t&&(this.$set(this.contentForm.redundantParams,"tabId",t.tabId+""),this.$set(this.contentForm.redundantParams,"tabType",t.tabType+""))},handleSelectCrowdStart:function(){this.showCrowdSelector=!0},handleSelectCrowdCancel:function(){this.showCrowdSelector=!1},handleSelectCrowdEnd:function(e,t){var a=this.checkCrowd(t);void 0!==a?this.$message({type:"error",message:"第"+(a+1)+"个精细化内容已关联该人群"}):(this.$set(this.contentForm,"dmpRegistryInfo",{dmpPolicyId:e.value,dmpCrowdId:t.value,dmpPolicyName:e.label,dmpCrowdName:t.label}),this.showCrowdSelector=!1)},handleOpenModeChange:function(e){this.contentForm.redundantParams=this.genParams(e)},handleWebPageTypeChange:function(e){this.contentForm.redundantParams.versioncode="1"==e?"1":"102007"},chopSubTitle:function(e){return(e||"").slice(0,50)},getSelectedResource:function(e){var t,a,i;return Object.keys(e).forEach(function(n){var o=e[n][0];o&&(t=n,"episode"===n?i=o:a=o)}),{selectedType:t,selected:a,selectedEpisode:i}},handleSelectMediaEnd:function(e){var t=this.getSelectedResource(e),a=t.selectedType,i=t.selected,n=t.selectedEpisode,o=e.videoSource,r=this.chopSubTitle,l=this.contentForm;if(Object.assign(l,{vContentId:"",blockResourceType:"",platformId:"",versionCode:""}),"video"===a){n?(this.contentForm.contentType=0,this.contentForm.videoContentType="movie","tencent"===o?(this.contentForm.extraValue1="_otx_"+i.coocaaVId,this.contentForm.extraValue5=n.coocaaMId):"yinhe"===o?(this.contentForm.extraValue1="_oqy_"+i.coocaaVId,this.contentForm.extraValue5=n.coocaaMId):"youku"===o&&(this.contentForm.extraValue1="_oyk_"+i.coocaaVId,this.contentForm.extraValue5=n.coocaaMId),this.contentForm.singleId=n.coocaaMId,this.contentForm.platformId=this.source,this.contentForm.pictureUrl=n.thumb,this.contentForm.title=n.urlTitle,this.contentForm.subTitle=r(n.urlSubTitle),this.contentForm.singleSubTitle="",this.contentForm.blockResourceType=1):("tencent"===o?this.contentForm.extraValue1="_otx_"+i.coocaaVId:"yinhe"===o?this.contentForm.extraValue1="_oqy_"+i.coocaaVId:"youku"===o&&(this.contentForm.extraValue1="_oyk_"+i.coocaaVId),this.contentForm.singleId="",this.contentForm.singleId="",this.contentForm.contentType=0,this.contentForm.videoContentType="movie",this.contentForm.extraValue5=null,this.contentForm.platformId=i.source,this.contentForm.pictureUrl=i.thumb,this.contentForm.title=i.title,this.contentForm.subTitle=r(i.subTitle),this.contentForm.singleSubTitle="",this.contentForm.blockResourceType=1);var s=i.ccVideoSourceEntities[0],c=s.score,u=s.updatedSegment,d=s.publishSegment,p=0==d,h=p?"unknown":u==d?"ended":"updating";l.publishStatus=h,l.score=c,l.series=p?null:u,l.variety=s.lastCollection}else if("edu"===a){this.contentForm.contentType=3,this.contentForm.videoContentType="edu",this.contentForm.extraValue1="_otx_"+i.coocaaVId,this.contentForm.platformId=i.source,this.contentForm.pictureUrl=i.thumb,this.contentForm.title=i.title,this.contentForm.subTitle=r(i.subTitle),this.contentForm.singleSubTitle="",this.contentForm.blockResourceType=1;var m=i.ccVideoSourceEntities;m&&m[0]&&1===m[0].isTvod&&(this.contentForm.versionCode=342e4)}else"pptv"===a?(this.contentForm.contentType=4,this.contentForm.videoContentType="pptv",this.contentForm.extraValue1="pptv_tvsports://tvsports_detail?section_id="+i.pid+"&from_internal=1",this.contentForm.title=i.pTitle,this.contentForm.subTitle=r(i.pTitle),this.contentForm.singleSubTitle="",this.contentForm.blockResourceType=1):"live"===a?(this.contentForm.contentType=6,this.contentForm.videoContentType="txLive",this.contentForm.extraValue1="_otx_"+i.vId,this.contentForm.platformId=i.source,this.contentForm.pictureUrl=i.thumb,this.contentForm.title=i.title,this.contentForm.subTitle=r(i.subTitle),this.contentForm.singleSubTitle="",this.contentForm.blockResourceType=1):"topic"===a?("parentTopic"===i.dataSign?this.contentForm.contentType=8:this.contentForm.contentType=7,"parentTopic"===i.dataSign?this.contentForm.videoContentType="bigTopic":this.contentForm.videoContentType="topic",this.contentForm.extraValue1=i.id+"",this.contentForm.pictureUrl=i.picture,this.contentForm.title=i.title,this.contentForm.subTitle=r(i.subTitle),this.contentForm.singleSubTitle="",this.contentForm.blockResourceType=1):"rotate"===a&&(this.contentForm.extraValue1=i.id+"",this.contentForm.pictureUrl=i.picture,this.contentForm.title=i.title,this.contentForm.subTitle=r(i.subTitle),this.contentForm.singleSubTitle="",this.contentForm.blockResourceType=1,this.contentForm.videoContentType="rotate");this.contentForm.categoryId=i.categoryId,this.$refs.resourceSelector.clearSelected()},handleSelectAppEnd:function(e){var t=e.app[0];t&&(this.contentForm.contentType=2,this.contentForm.videoContentType="app",this.contentForm.extraValue1=t.appPackageName,this.contentForm.pictureUrl=t.appImageUrl,this.contentForm.title=t.appName,this.contentForm.subTitle=this.chopSubTitle(t.appName),this.contentForm.singleSubTitle="",this.contentForm.blockResourceType=0)},handleSelectClickEventEnd:function(e){var t=e[0],a=t.packagename,i=t.versioncode,n=t.dowhat,o=t.bywhat,r=t.byvalue,l=t.params,s=t.exception,c=this.contentForm,u=[];if(l){var d=JSON.parse(l);u=Object.keys(d).map(function(e){return{key:e,value:d[e]}})}0===u.length&&u.push({key:void 0,value:void 0}),c.redundantParams=Object.assign({},c.redundantParams,{packagename:a,versioncode:i,dowhat:n,bywhat:o,byvalue:r,params:u,exception:s})},isNormalPicture:function(e){return!e||"webp"!==e.slice(-4).toLowerCase()},handleSelectCornerIconEnd:function(e,t){var a={cornerIconId:e.cornerIconId,position:t,imgUrl:e.imgUrl};this.$set(this.contentForm.cornerList,t,a)},handleRemoveCornerIcon:function(e){this.$set(this.contentForm.cornerList,e,{})},handleSelectPostEnd:function(e){this.contentForm.pictureUrl=e.pictureUrl},handleSelectBackupPostEnd:function(e){this.contentForm.alternativePictureUrl=e.pictureUrl},handleSelectBgEnd:function(e){this.contentForm.bgImgUrl=e.pictureUrl},handleSelectBgMediaEnd:function(e){var t,a=this.getSelectedResource(e),i=a.selectedType,n=a.selected,o=a.selectedEpisode,r=this.contentForm,l=e.videoSource;"video"===i?o?"tencent"===l?(t="_otx_"+n.coocaaVId,o.coocaaMId):"yinhe"===l?(t="_oqy_"+n.coocaaVId,o.coocaaMId):"youku"===l&&(t="_oyk_"+n.coocaaVId,o.coocaaMId):"tencent"===l?t="_otx_"+n.coocaaVId:"yinhe"===l?t="_oqy_"+n.coocaaVId:"youku"===l&&(t="_oyk_"+n.coocaaVId):"edu"===i?t="_otx_"+n.coocaaVId:"pptv"===i?t="pptv_tvsports://tvsports_detail?section_id="+n.pid+"&from_internal=1":"live"===i?t="_otx_"+n.vId:"topic"===i?t=n.id+"":"rotate"===i&&(t=n.id+""),r.bgParams={id:t},r.bgType="res"},handleRemoveBgMedia:function(){var e=this.contentForm;e.bgParams={id:""},e.bgType="",e.bgImgUrl=""},handleSelectBlockEnd:function(e){var t=e.func[0],a=e.broadcast[0];if(t){var i=t;this.contentForm.videoContentType="sysPlugin",this.contentForm.title=i.pluginName,this.contentForm.vContentId=i.pluginId,this.contentForm.pictureUrl=i.globalPicture?i.globalPicture.pictureUrl:""}if(a){var n=a;this.contentForm.videoContentType="specific",this.contentForm.title=n.containerName,this.contentForm.vContentId=n.id,this.contentForm.pictureUrl=n.poster.pictureUrl}this.$refs.blockSelector.clearSelected()},validate:function(e,t){var a=this.contentForm;this.$refs.contentForm.validate(function(e){if(e){if("custom"===a.coverType&&a.price<a.secKillPrice)return t("价格小于秒杀价，建议重新填写！");t()}else t("请把表单填写完整")})}},mounted:function(){var e=this.contentForm.redundantParams;"picture"===e.openMode&&e.pictureUrl&&(this.$refs.upload.fileList=[{status:"success",dataUrl:e.pictureUrl}])}},_p=kp,Pp=(a("52a5"),a("2dd7"),a("87281"),Object(Bn["a"])(_p,Td,Sd,!1,null,"9e9f5fc8",null)),xp=Pp.exports,Dp={components:{draggable:jo.a,BlockForm:xp},data:function(){return{activeNames:["normal","specific"],activeType:"normal",activeIndex:0,normalContentList:[this.getDefaultContentForm()],specificContentList:[]}},props:["mode","data","source","pannel","hideTitleOptions"],computed:{title:function(){return"read"===this.mode?"推荐位内容查看":"推荐位内容设置"},isMall:function(){return"Mall"===this.data.blockInfo.type},contentForm:function(){return this[this.activeType+"ContentList"][this.activeIndex]}},methods:{handleDragConentStart:function(e){},handleDragConentEnd:function(e,t){var a=e.newIndex,i=e.oldIndex;this.activeType===t&&(this.activeIndex===i?this.activeIndex=a:this.activeIndex===a&&(this.activeIndex=i))},handleSave:function(){var e=this;this.validateCurrentContent(function(){e.$emit("save",{videoContentList:e.parseContentList(e.normalContentList),specificContentList:e.parseContentList(e.specificContentList)})})},getDefaultContentForm:function(){return{coverType:this.isMall?"custom":"media",title:"",showTitle:this.hideTitleOptions?1:0,subTitle:"",showSubTitle:0,singleSubTitle:"",pictureUrl:"",showSeries:1,showScore:1,alternativePictureUrl:"",extraValue1:"",extraValue5:"",singleId:"",vContentId:"",resourceType:0,cornerList:[{},{}],blockResourceType:-1,moviePercent:100,versionCode:"",price:"",secKillPrice:"",flagIsSetad:0,redundantParams:this.getDefaultParams(),bgImgUrl:"",bgParams:{id:""},bgType:""}},getDefaultParams:function(){return{openMode:"app",webpageUrl:"",webpageType:"2",videoName:"",videoUrl:"",pictureUrl:"",tabId:"",packagename:"",versioncode:"-1",dowhat:"startActivity",bywhat:"action",byvalue:"",data:void 0,params:[{key:"",value:""}]}},handleCoverTypeChange:function(e){if("read"!==this.mode){var t=this.activeType,a=this.activeIndex,i=this[t+"ContentList"],n=i[a],o=this.getDefaultContentForm();o.coverType=e,"specific"===t&&(o.resourceType=n.resourceType,o.dmpRegistryInfo=n.dmpRegistryInfo),this.$set(i,a,o)}},handleRemoveContent:function(e,t){var a=this;this.$confirm("确认删除该内容","提示",{callback:function(i){if("confirm"===i){var n=a.activeType,o=a.activeIndex,r=a[t+"ContentList"];r.splice(e,1),n===t&&(r.length>0?void 0===r[o]&&a.handleActivate(t,e-1):a.handleActivate("normal"===t?"specific":"normal",0))}}})},handleAddContent:function(e){var t=this;this.$refs[this.activeType+"BlockForm"].validate(this.contentForm,function(a){if(a)t.$message({type:"error",message:a});else{var i=t[e+"ContentList"];i.push(t.getDefaultContentForm()),t.activeType=e,t.activeIndex=i.length-1}})},handleActivate:function(e,t){var a=this;this[this.activeType+"ContentList"][this.activeIndex]?this.validateCurrentContent(function(){a.activeType=e,a.activeIndex=t}):(this.activeType=e,this.activeIndex=t)},validateCurrentContent:function(e){var t=this;this.$refs[this.activeType+"BlockForm"].validate(this.contentForm,function(a){a?t.$message({type:"error",message:a}):e()})},setContentList:function(){var e=this,t=JSON.parse(JSON.stringify(this.data.block||"{}")),a=t.videoContentList||[],i=t.specificContentList||[],n=function(t){var a,i=e.getDefaultContentForm();if(t.cornerList=(t.cornerList||[]).reduce(function(e,t){return e[t.position]=t,e},i.cornerList),"custom"==t.coverType){var n=JSON.parse(t.onclick),o=t.params.split(",").reduce(function(e,t){var a=t.split("=="),i=Object(Cd["a"])(a,2),n=i[0],o=i[1];return e[n]=o,e},{}),r=o.openMode||"app";switch(r){case"webpage":n.webpageUrl=n.params.url,"coocaa.intent.action.browser"===n.byvalue&&(n.webpageType="1"),"coocaa.intent.action.browser.no_trans"===n.byvalue&&(n.webpageType="2");break;case"video":n.videoName=n.params.name,n.videoUrl=n.params.url;break;case"picture":n.pictureUrl=n.params.url;break;case"tab":n.tabId=n.params.id,n.tabType=o.tabType;break;case"app":var l=n.params;n.params=Object.keys(n.params).map(function(e){return{key:e,value:l[e]}});break;default:break}a=n,a.openMode=r,delete t.onclick}return a&&(t.redundantParams=a),t.bgParams&&(t.bgParams=JSON.parse(t.bgParams)),Object.assign({},i,t)};this.normalContentList=a.length>0?a.map(n):[this.getDefaultContentForm()],this.specificContentList=i.map(n)},parseContentList:function(e){function t(e){var t=e.coverType,a="",i="";if("custom"===t&&(e.contentType=0),"block"===t&&(e.contentType=1),"custom"===t){var n=e.redundantParams,o=n.openMode;i="openMode=="+o;var r=n.webpageType;switch(o){case"webpage":"1"===r?a=JSON.stringify({packagename:"com.coocaa.app_browser",versioncode:n.versioncode,dowhat:"startActivity",bywhat:"action",byvalue:"coocaa.intent.action.browser",params:{url:n.webpageUrl},exception:{}}):"2"===r&&(a=JSON.stringify({packagename:"com.coocaa.app_browser",versioncode:n.versioncode,dowhat:"startActivity",bywhat:"action",byvalue:"coocaa.intent.action.browser.no_trans",params:{url:n.webpageUrl},exception:{}}));break;case"video":a=JSON.stringify({packagename:"com.tianci.movieplatform",versioncode:"-1",dowhat:"startService",bywhat:"action",byvalue:"coocaa.intent.player.video",params:{name:n.videoName,url:n.videoUrl,needParse:"false",url_type:"web"},exception:{}});break;case"picture":a=JSON.stringify({packagename:"com.tianci.movieplatform",versioncode:"",dowhat:"startService",bywhat:"action",byvalue:"coocaa.intent.player.image",params:{name:"",url:n.pictureUrl},exception:{}});break;case"tab":var l=n.tabType;i+=",tabType=="+l,a=JSON.stringify({packagename:"com.tianci.movieplatform",versioncode:"",dowhat:"startActivity",bywhat:"action",byvalue:1==l?"coocaa.intent.action.HOME_COMMON_LIST":"coocaa.intent.action.HOME_SPECIAL_TOPIC",params:{id:n.tabId},exception:{}});break;case"app":for(var s={},c=n.params,u=0;u<c.length;u++){var d=c[u];""!==d.key&&""!==d.value&&(s[d.key]=d.value)}a=JSON.stringify({byvalue:n.byvalue,packagename:n.packagename,dowhat:n.dowhat,versioncode:n.versioncode,params:s,bywhat:n.bywhat,data:n.data,exception:{name:"onclick_exception",value:{packagename:"com.tianci.appstore",dowhat:"startActivity",versioncode:"-1",params:{id:n.packagename},byvalue:"coocaa.intent.action.APP_STORE_DETAIL",bywhat:"action"}}});break;default:break}}return e.onclick=a,e.params=i,e.bgParams&&(e.bgParams=JSON.stringify(e.bgParams)),delete e.redundantParams,e}return e=JSON.parse(JSON.stringify(e)),e.map(t)},checkCrowd:function(e){var t,a,i=this.specificContentList,n=i.length;while(--n>=0)if(a=i[n].dmpRegistryInfo,a&&a.dmpCrowdId===e.value){t=n;break}return t}},created:function(){this.setContentList()}},Fp=Dp,$p=(a("e345"),Object(Bn["a"])(Fp,wd,Id,!1,null,"b861905e",null)),Lp=$p.exports,Rp=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-checkbox",{attrs:{disabled:e.disabled,value:e.boolValue},on:{input:e.handleInputValue}},[e._v("\n  "+e._s(e.label)+"\n")])},Np=[],Ep={props:["value","label","disabled","isNegative"],computed:{boolValue:function(){var e=this.value;return void 0!==this.isNegative?!e:!!e}},methods:{handleInputValue:function(e){e=void 0!==this.isNegative?e?0:1:e?1:0,this.$emit("input",e)}}},Op=Ep,Ap=Object(Bn["a"])(Op,Rp,Np,!1,null,null,null),Vp=Ap.exports,Mp=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:"设置版块组信息",visible:e.showDialog,"close-on-click-modal":!0},on:{"update:visible":function(t){e.showDialog=t},close:e.handleSetCancel}},[a("el-form",{ref:"form",attrs:{"label-width":"140px",model:e.info,rules:e.rules},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.stopPropagation(),t.preventDefault(),e.handleSetEnd(t))}}},[a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{attrs:{disabled:"read"===e.mode},model:{value:e.info.title,callback:function(t){e.$set(e.info,"title",t)},expression:"info.title"}})],1),"timeSlot"===e.focusConfig?[a("el-form-item",{staticClass:"time-slot",attrs:{label:"时间段",prop:"startTime"}},[a("el-form-item",{attrs:{label:""}},[a("el-date-picker",{staticClass:"start-time",attrs:{disabled:"read"===e.mode,type:"datetime"},model:{value:e.info.startTime,callback:function(t){e.$set(e.info,"startTime",t)},expression:"info.startTime"}})],1),e._v("\n            -\n            "),a("el-form-item",{attrs:{label:""}},[a("el-date-picker",{staticClass:"end-time",attrs:{disabled:"read"===e.mode,type:"datetime"},model:{value:e.info.endTime,callback:function(t){e.$set(e.info,"endTime",t)},expression:"info.endTime"}})],1)],1),a("el-form-item",{attrs:{label:"",prop:"panelIsFocus"}},[a("el-checkbox",{attrs:{disabled:"read"===e.mode,value:!!e.info.panelIsFocus},on:{input:function(t){e.info.panelIsFocus=t?1:0}}},[e._v("空时间段默认落焦")])],1)]:e._e()],2),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleSetCancel}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSetEnd}},[e._v("确 定")])],1)],1)],1)},Bp=[],Up={data:function(){return{showDialog:!0,timeSlotError:"",rules:{title:[{required:!0,message:"请输入标题"}],startTime:[{validator:this.timeSlotValidator.bind(this)}]}}},props:["mode","info","panelList","focusConfig"],methods:{handleSetCancel:function(){this.$emit("set-cancel")},handleSetEnd:function(){this.$refs.form.validate(function(e){e?this.$emit("set-end"):this.$message({type:"error",message:"请把表单填写完整"})}.bind(this))},timeSlotValidator:function(e,t,a){var i,n,o=this.panelList,r=this.info,l=r.index,s=o.length,c=r.startTime,u=r.endTime;if(c&&u){if(c>=u)return a("开始时间必须小于结束时间");while(--s>=0)if(s!==l){var d=o[s],p=d.startTime,h=d.endTime;if(p&&(c<=p&&u>=p||p<=c&&h>=c)){i=s,n=p.toISOString()+"-"+h.toISOString();break}}}else{if(c&&!u)return a("请设置结束时间");if(u&&!c)return a("请设置开始时间");if(1!==r.panelIsFocus)return a("时间段和空时间段默认落焦至少设置一个")}void 0!==i?a("与第 "+(i+1)+" 个分组的时间段 "+n+" 重合"):a()}}},jp=Up,Gp=(a("c06a"),Object(Bn["a"])(jp,Mp,Bp,!1,null,"4ea6b420",null)),Wp=Gp.exports,qp={mixins:[zu],components:{PageWrapper:Mu,PageContentWrapper:qu,ContentCard:Hn,CommonContent:Us,CommonSelector:Br,VirtualPanel:Zu,SourceRadioSelector:od,LayoutSelector:hd,GlobalPictureSelector:yd,BlockContent:Lp,BinCheckBox:Vp,ResourceSelector:ql,PanelGroupInfoSetter:Wp,TagFrame:Sp},data:function(){return{mode:"create",activePage:"panel_info",PANNEL_STATUS:{draft:2,waiting:3,accepted:4,rejected:5},showResourceSelector:!1,selectedLayout:null,blocks:[],selectedResources:[],selectedFocusImgUrl:void 0,selectedBlocksAndResources:[],copyToPanelDataType:this.panelDataType,blockContentProps:{},pannelType:1,pannel:{pannelGroupId:void 0,pannelName:"",panelGroupCategory:67,parentType:"normal",flagIs4k:0,pannelResource:"o_tencent",groupTitle:void 0,panelGroupType:void 0,showTitle:1,selectV:"",lucenyFlag:0,focusShape:0,focusImgUrl:void 0,focusConfig:"",currentVersion:"",pannelList:[{pannelTitle:"",panelIsFocus:0,contentList:[],selectedResources:[]}]},isShowfocusImgUrl:!1,blockList:[],blockCountList:[0],blockCount:1,businessTypeEnums:[],currentBlockIndex:void 0,activePannelIndex:"0",activePanelGroup:void 0,showAddTagDialog:!1,sharedTags:[]}},props:["id","initMode","version","panelDataType","initGroupIndex","initBlockIndex"],computed:{resourceName:function(){return 3===this.currentPanelDataType?"业务专辑":"版块"},resourceInfo:function(){var e=this.pannel;if(e.pannelGroupId)return{id:e.pannelGroupId,version:e.currentVersion,status:e.pannelStatus,type:"pannel",menuElId:"pannelInfo"}},currentPanelDataType:function(){var e=this.pannel;return e.pannelGroupId?e.panelGroupType:this.panelDataType},pannelStatusText:function(){var e=this.pannel.pannelList[0].pannelStatus;if(""!==e)return basicFn.numToAuditStatus(e)},isPanelCommonOrVideo:function(){var e=this.pannel.panelGroupCategory;return 31===e||67===e},isReplica:function(){return"replicate"===this.mode||"yes"===this.pannel.duplicateVersion},isSelectMultiResource:function(){var e=this.selectedLayout.layoutJsonParsed;return!e||"Panel"!==e.type||1!==e.contents.length},alienFocusResolution:function(){var e=this.selectedLayout;if(e){var t=e.layoutJsonParsed.contents[0],a=t.width+15+15,i=t.height+20+79,n=a+"*"+i;return n}},panelResourceIds:function(){var e=[],t={movie:!0,edu:!0,shopping:!0,app:!0};return this.pannel.pannelList.forEach(function(a){a.contentList.forEach(function(a){a.videoContentList.forEach(function(a){var i=a.videoContentType,n=a.extraValue1||"";n&&t[i]&&e.push(n)})})}),e},isShowTagsField:function(){for(var e=this.pannel.pannelList,t=!!this.selectedLayout,a=0,i=e.length;a<i;a++)for(var n=e[a],o=n.contentList,r=0,l=o.length;r<l;r++){var s=o[r]||{};if(!s.videoContentList||0===s.videoContentList.length){t=!1;break}}return t},couldSetReleaseTime:function(){var e=this.mode,t=this.pannel.currentVersion,a="create"===e||"copy"===e,i="edit"===e&&"V1"===t,n="10"==this.$consts.idPrefix;return n&&!(a||i)}},watch:{isShowfocusImgUrl:function(e){!1===e&&(this.pannel.focusImgUrl="")},"pannel.focusShape":function(e){1===e&&(this.isShowfocusImgUrl=!1)},"pannel.parentType":function(e){"group"===e&&(this.pannel.showTitle=1)}},methods:{handleBatchAddTag:function(){this.showAddTagDialog=!0},handleBatchAddTagEnd:function(){this.getSharedTags(),this.showAddTagDialog=!1},getSharedTags:function(){var e=this,t=this.panelResourceIds,a=t&&0===t.length;if(!this.isShowTagsField||a)return this.sharedTags=[];this.$service.getSharedTags({coocaaVIds:t.join(",")}).then(function(t){var a=t.data.tags;e.sharedTags=a?a.split(","):[]})},handleFocusConfigChange:function(e){if("week"===e){var t=this.pannel,a=t.pannelList,i=7-a.length;while(i-- >0)this.addPannel();var n=["周一","周二","周三","周四","周五","周六","周日"];t.pannelList=a.map(function(e,t){return e.pannelTitle=n[t],e.panelIsFocus=0,e}),this.updateAllPosition()}if("timeSlot"===e){var o=this.pannel,r=o.pannelList,l=4-r.length;while(l-- >0)this.addPannel();o.pannelList=r.map(function(e,t){return e.pannelTitle="时间段分组",e}),this.updateAllPosition()}},fetchData:function(e){var t=this;return this.$service.panelGetDetail({id:this.id,version:e}).then(function(e){t.setPanelInfoData(e)})},handleSelectVersion:function(){var e=this.pannel;window.location.href=this.urls.copy_pannel+"?id="+e.pannelGroupId+"&version="+e.currentVersion},handleCopy:function(e){this.pannel.panelGroupType=this.copyToPanelDataType;var t=this.$consts.status;e==t.waiting?this.handleSubmitAudit():this.handleSaveDraft()},handleSelectLayoutEnd:function(e,t){this.selectedLayout=e,this.blockCount=t,this.blockCountList=this.blockCountList.map(function(){return t}),void 0!==t&&this.pannel.pannelList.forEach(function(e){var a=e.selectedResources;a&&(e.selectedResources=a.slice(0,t))}),"Mall"!==e.layoutJsonParsed.contents[0].type&&this.pannel.pannelList.forEach(function(e){e.contentList.forEach(function(e){[].concat(e.videoContentList||[],e.specificContentList||[]).forEach(function(e){e.price=void 0,e.secKillPrice=void 0})})});var a=this.pannel.pannelList.length;while(--a>=0)this.updatePosition(a);this.getSharedTags(),this.pannel.focusImgUrl=""},handleSelectAlienFocusEnd:function(e){this.pannel.focusImgUrl=e.pictureUrl},handleClickBlock:function(e){var t=this.pannel,a=this.selectedLayout,i=+this.activePannelIndex,n=this.pannel.pannelList[i].selectedResources||[];this.blockContentProps={layoutType:a.layoutJsonParsed.type,pannelParentType:t.parentType,pannelCategory:this.pannel.panelGroupCategory,block:n[e],blockInfo:this.blockList[i][e],pannelResource:this.pannel.pannelResource},this.currentBlockIndex=e,this.activePage="block_content"},handleSetBlockContentCancle:function(){this.activePage="panel_info",this.getSharedTags()},handleSetBlockContentEnd:function(e){var t=+this.activePannelIndex,a=this.pannel.pannelList[t],i=a.selectedResources||[],n=this.currentBlockIndex,o=i[n]||{};i[n]=o;e.videoContentList[0];Object.assign(o,e),e.specificContentList.length>0&&(a.pannelType=7),this.updatePosition(),this.getSharedTags(),this.activePage="panel_info"},handleSelectResourceEnd:function(e){var t=this.$refs.resourceSelector,a=e.videoSource,i=e.episode||{},n=this.pannel,o=this.pannel.pannelList[+this.activePannelIndex],r={tencent:"o_tencent",yinhe:"o_iqiyi",youku:"o_youku"},l=n.pannelResource||r[a],s=function(e){return"o_tencent"===l?"_otx_"+e:"o_iqiyi"===l?"_oqy_"+e:"o_youku"===l?"_oyk_"+e:""},c=0;o.contentList.forEach(function(e){var t=e.videoContentList;t&&t.length>0&&c++}),this.$prompt("请确认从第几个内容框开始填充","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"当前已填充 "+c+" 个， 默认为从第1位开始填充",inputValidator:function(e){if(null!==e&&!RegExp(/^[0-9]*[1-9][0-9]*$/).test(e))return"请正确填写位置"}}).then(function(a){for(var n=a.value||1,r=(this.selectedLayout,e.video.map(function(e){var t,a=i[e.coocaaVId];t=a?{contentType:0,coverType:"media",videoContentType:"movie",extraValue1:s(e.coocaaVId),extraValue5:a.coocaaMId,pictureUrl:a.thumb,title:a.urlTitle,subTitle:a.urlSubTitle,blockResourceType:1}:{contentType:0,coverType:"media",videoContentType:"movie",extraValue1:s(e.coocaaVId),extraValue5:void 0,pictureUrl:e.thumb,title:e.title,subTitle:e.urlSubTitle,blockResourceType:1};var n=e.ccVideoSourceEntities[0],o=n.score,r=n.updatedSegment,l=n.publishSegment,c=0==l,u=c?"unknown":r==l?"ended":"updating";return t.publishStatus=u,t.score=o,t.categoryId=e.categoryId,t.series=c?null:r,t.variety=n.lastCollection,t})),l=e.app.map(function(e){return{contentType:2,coverType:"app",videoContentType:"app",extraValue1:e.appPackageName,pictureUrl:e.appImageUrl,title:e.appName,blockResourceType:0}}),c=e.edu.map(function(e){var t=e.ccVideoSourceEntities,a={contentType:3,coverType:"media",videoContentType:"edu",extraValue1:"_otx_"+e.coocaaVId,pictureUrl:e.thumb,title:e.title,subTitle:e.subTitle,blockResourceType:1,categoryId:e.categoryId};return t&&t[0]&&1===t[0].isTvod&&(a.versionCode=342e4),a}),u=e.pptv.map(function(e){return{contentType:4,coverType:"media",videoContentType:"pptv",extraValue1:"pptv_tvsports://tvsports_detail?section_id="+e.pid+"&from_internal=1",title:e.pTitle,blockResourceType:1,categoryId:e.categoryId}}),d=e.live.map(function(e){var t;return t={contentType:4,coverType:"media"},Object(ei["a"])(t,"contentType",6),Object(ei["a"])(t,"videoContentType","txLive"),Object(ei["a"])(t,"extraValue1","_otx_"+e.vId),Object(ei["a"])(t,"pictureUrl",e.thumb),Object(ei["a"])(t,"title",e.title),Object(ei["a"])(t,"subTitle",e.subTitle),Object(ei["a"])(t,"blockResourceType",1),Object(ei["a"])(t,"categoryId",e.categoryId),t}),p=e.topic.map(function(e){return{coverType:"media",contentType:"parentTopic"===e.dataSign?8:7,videoContentType:"parentTopic"===e.dataSign?"bigTopic":"topic",extraValue1:e.id+"",pictureUrl:e.picture,title:e.title,subTitle:e.subTitle,blockResourceType:1,categoryId:e.categoryId}}),h=e.rotate.map(function(e){return{coverType:"media",contentType:9,videoContentType:"rotate",extraValue1:e.id+"",pictureUrl:e.picture,title:e.title,subTitle:e.subTitle,blockResourceType:1,categoryId:e.categoryId}}),m=[].concat(r,l,c,d,u,p,h).map(function(e){return{contentPosition:null,blockMallPosition:null,focusImgUrl:"",lucenyFlag:0,resize:null,titleInfo:null,videoContentList:[e],specificContentList:[]}}),f=Math.max(n-1+m.length,o.selectedResources.length),g=Array.apply(null,{length:f}),b=0,v=n-1,y=v+m.length-1,w=f;b<w;b++)g[b]=b>=v&&b<=y?m[b-v]:o.selectedResources[b];o.selectedResources=g,t.clearSelected(),this.updatePosition(),this.getSharedTags()}.bind(this)).catch(function(e){console.log(e),t.$refs.wrapper.handleSelectStart()})},handleRemoveTab:function(e){this.$confirm("确认删除该子版块?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=this.pannel.pannelList;if(1===t.length)return this.$message({type:"error",message:"至少包含一个分组"});var a=+e;if(t.splice(a,1),this.activePannelIndex>=e){var i=a-1;this.activePannelIndex=-1===i?"0":i.toString()}}.bind(this)).catch(function(e){console.log(e)})},handleAddTab:function(){var e=this.validateBlocks();if(e.emptyBlock)return this.$message({type:"error",message:"请先把空推荐位填充完毕"});this.activePanelGroup={index:this.pannel.pannelList.length,title:"",startTime:void 0,endTime:void 0,panelIsFocus:0}},addPannel:function(e){var t=this.pannel.pannelList,a={pannelTitle:e,panelIsFocus:0,selectedResources:[],contentList:[]},i=t.length;this.activePannelIndex=i.toString(),this.blockCountList.push(this.blockCount),t.push(a)},handleSetDefaultActiveTab:function(){var e=+this.activePannelIndex;this.pannel.pannelList.forEach(function(t,a){t.panelIsFocus=e===a?1:0})},handlePanelGroupCategoryChange:function(e){var t=this;this.$confirm("切换业务类型将清空推荐位内容, 确定切换?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=t.pannel;a.panelGroupCategory=e,t.isPanelCommonOrVideo?a.pannelResource="o_tencent":a.pannelResource="",t.clearBlocks()}).catch(function(){})},handlePannelResourceChange:function(e){this.$confirm("切换内容源将清空推荐位内容, 确定切换?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){this.pannel.pannelResource=e,this.clearBlocks()}.bind(this)).catch(function(){})},handleParentTypeChange:function(e){this.$confirm("切换版块类型将清空推荐位内容, 确定切换?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=this.pannel;"normal"===e&&(t.focusConfig=""),t.pannelList=t.pannelList.slice(0,1),this.activePannelIndex=0,this.clearBlocks(),this.pannel.parentType=e}.bind(this)).catch(function(){})},handleSetPanelGroupInfoStart:function(e){var t=this.pannel.pannelList[e];this.activePanelGroup={index:e,title:t.pannelTitle,startTime:t.startTime,endTime:t.endTime,panelIsFocus:t.panelIsFocus}},handleSetPanelGroupInfoCancel:function(){this.activePanelGroup=void 0},handleSetPanelGroupInfoEnd:function(){var e=this.activePanelGroup,t=e.index,a=this.pannel.pannelList,i=a[t];i||(this.addPannel(e),this.updateAllPosition(),i=a[t]),i.pannelTitle=e.title,e.panelIsFocus?this.setPanelDefaultFocus(t):i.panelIsFocus=e.panelIsFocus,i.startTime=e.startTime,i.endTime=e.endTime,this.activePanelGroup=void 0},setPanelDefaultFocus:function(e){var t=this.pannel.pannelList,a=t[e];t.forEach(function(e){e.panelIsFocus=0}),a.panelIsFocus=1},clearBlocks:function(){var e=this.pannel;e.pannelList.forEach(function(e){e.selectedResources=[]}),this.updateAllPosition()},updateAllPosition:function(){var e=this.pannel.pannelList.length;while(--e>=0)this.updatePosition(e)},updatePosition:function(e){var t=this.selectedLayout;if(t){var a=this.pannel,i=JSON.parse(t.layoutJson),n=i.type,o=i.contents,r=o.length,l=void 0===e?+this.activePannelIndex:e,s=a.pannelList[l],c=s.selectedResources||[],u=this.blockCountList[l],d=o[r-1],p=d.x+d.width,h=d.resize||{},m=d.y+(h.height||d.height),f=function(){if("Expander"===n&&2===r){var e=i.extra.space;return function(t){var a=o[1],i=a.resize,n=a.title_info,r=a.mall_resize,l=p+(t-2)*e+(t-3)*a.width,s=a.y,c={height:a.height,width:a.width,x:l,y:s,isExtra:!0,title_info:n,mall_resize:r,loop:a.loop,type:a.type};return n&&i&&(c.resize={height:i.height,width:i.width,x:l,y:s}),c}}if("Expander"===n){var t=i.extra.space;return function(e){var a=Math.floor(e/r)-1,i=e%r,n=o[i],l=n.resize,s=n.title_info,c=n.mall_resize,u=n.x+a*p+a*t,d=n.y,h={height:n.height,width:n.width,x:u,y:d,isExtra:!0,title_info:s,mall_resize:c,loop:n.loop,type:n.type};return s&&l&&(h.resize={height:l.height,width:l.width,x:u,y:d}),h}}if("Lengthwise"===n){var a=28;return function(e){var t=Math.ceil(e/r)-1,i=e-r*t-1,n=o[i],l=n.resize,s=n.title_info,c=n.mall_resize,u=n.x,d=n.y+t*m+t*a,p={height:n.height,width:n.width,parents:n.parents,type:n.type,title_align:n.title_align,x:u,y:d,isExtra:!0,title_info:s,mall_resize:c};return s&&l&&(p.resize={height:l.height,width:l.width,x:u,y:d}),p}}};if("Expander"===n||"Lengthwise"===n){var g=f(),b="group"===a.parentType&&"Lengthwise"===n?u:Math.max(u,c.length),v=o.length;while(v++<b)o.push(g(v))}this.blockList[l]=o;var y={};this.selectedBlocksAndResources=o.map(function(e,t){var a,i=c[t]||{},n=i.videoContentList||[],o=i.specificContentList||[],r=n[0];if(!r||"media"!==r.coverType&&"block"!==r.coverType)i.duplicated=!1;else if(r.extraValue1?a=r.contentType+"/"+r.extraValue1+(r.extraValue5||""):r.vContentId&&(a=r.contentType+"/"+r.vContentId),a){var l=y[a];l?(l.duplicated=!0,i.duplicated=!0):(i.duplicated=!1,y[a]=i)}return[].concat(n,o).forEach(function(t){e.title_info?(t.showTitle=1,t.forceTitle=!0):t.forceTitle=!1,void 0===t.showTitle&&(t.showTitle=0),void 0===t.showSubTitle&&(t.showSubTitle=0)}),i.videoContentList=n,i.contentPosition=Object.assign({},e,{resize:void 0}),i.titleInfo=e.title_info,i.mallResize=e.mall_resize,i.resize=e.resize,i.isExtra=e.isExtra,i}),s.contentList=this.selectedBlocksAndResources}},handleDragBlock:function(e,t){var a=this.pannel.pannelList[+this.activePannelIndex],i=a.selectedResources,n=i[e],o=i[t];i[t]=n,i[e]=o,this.updatePosition()},handleRemoveBlock:function(e){var t=+this.activePannelIndex;this.blockCountList[t]--;var a=this.pannel.pannelList[t],i=a.selectedResources;i.splice(e,1),this.updatePosition(),this.getSharedTags()},getFormData:function(){var e=JSON.parse(JSON.stringify(this.pannel)),t=this.mode;return"replicate"===t&&(e.currentVersion=""),"copy"===t&&(e.pannelGroupId=void 0,e.currentVersion=""),e},parseDataToApi:function(e){this.mode;var t=this.currentPanelDataType,a=this.selectedLayout,i=JSON.parse(JSON.stringify(e));if(i.panelGroupType=t,i.pannelList=e.pannelList.map(function(e){var n,o=!1,r=e.contentList.map(function(e){var t=e.titleInfo,n=e.resize,r=e.mallResize,l=Object.assign({},e.contentPosition);l.resize=void 0,l.mall_resize=void 0,l.title_info=void 0,l.isExtra=void 0,"Expander"===a.layoutJsonParsed.type&&(l.x=0,l.y=0,t&&(t.x=0,t.y=0),n&&(n.x=0,n.y=0));var s=Object.assign({},e,{contentPosition:JSON.stringify(l),titleInfo:t?JSON.stringify(t):"",resize:n?JSON.stringify(n):"",blockMallPosition:r?JSON.stringify(r):""});return s.focusImgUrl=i.focusImgUrl,s.lucenyFlag=i.lucenyFlag,s.specificContentList&&s.specificContentList.length>0&&(o=!0),[].concat(s.videoContentList||[],s.specificContentList||[]).forEach(function(e){e.forceTitle=void 0}),delete s.mallResize,delete s.isExtra,delete s.duplicated,s});if("timeSlot"===i.focusConfig){var l=e.startTime,s=e.endTime;l&&s&&(n=l+","+s)}return{pannelStatus:i.pannelStatus,pannelId:e.pannelId,pannelCategory:i.panelGroupCategory,pannelName:i.pannelName,pannelTitle:e.pannelTitle,pannelResource:i.pannelResource,pannelType:o?7:t,showTitle:i.showTitle,flagIs4k:i.flagIs4k,layoutId:a.layoutId,panelIsFocus:e.panelIsFocus,timeSlot:n,focusShape:i.focusShape,contentList:r}}),delete i.pannelName,delete i.pannelResource,delete i.showTitle,delete i.flagIs4k,delete i.lucenyFlag,delete i.focusShape,delete i.focusImgUrl,"timeSlot"===i.focusConfig){var n=i.pannelList.findIndex(function(e){return 1===e.panelIsFocus});-1===n&&(i.pannelList[0].panelIsFocus=1)}return i},validate:function(e,t){var a=this,i=function(e){e?a.$message({type:"error",message:e}):t()},n=this.$consts.status,o=e.pannelStatus;if(!e.pannelName)return i("请输入版块名称");if("normal"===e.parentType&&!e.pannelList[0].pannelTitle)return i("请输入版块标题");if("group"===e.parentType&&!e.groupTitle)return i("请输入版块标题");if(!this.selectedLayout)return i("请选择布局");if(this.isShowfocusImgUrl&&!e.focusImgUrl)return i("请设置异形焦点");if(o===n.accepted||o===n.waiting){var r=this.validateBlocks(),l=r.emptyPannelTitleIndex,s=r.duplicatedPannelTitleIndex,c=r.emptyTimeSlotIndex,u=r.emptyPostIndex,d=r.emptyPostBlockIndex,p=r.emptyPriceIndex,h=r.emptyPriceBlockIndex,m=r.emptyTitleIndex,f=r.emptyTitleBlockIndex,g=r.emptyBlock,b=r.hasDuplicated,v=r.focusIndex;if(this.isPanelCommonOrVideo&&!e.pannelResource)return i("请选择内容源");if(void 0!==l)return i("请填写第"+(l+1)+"分组的标题");if(void 0!==s)return i("第"+(s+1)+"分组的标题与别的分组重复");if(void 0!==c)return i("请设置第"+(c+1)+"分组的落焦时间");if(void 0!==p&&void 0!==h)return"group"===e.parentType?i("请设置第 "+(p+1)+" 个分组第 "+(h+1)+" 个推荐位的价格"):i("请设置第 "+(h+1)+" 个推荐位的价格");if(void 0!==m&&void 0!==f)return"group"===e.parentType?i("请设置第 "+(m+1)+" 个分组第 "+(f+1)+" 个推荐位的标题"):i("请设置第 "+(f+1)+" 个推荐位的标题");if(void 0!==u&&void 0!==d)return"group"===e.parentType?i("请设置第 "+(u+1)+" 个分组第 "+(d+1)+" 个推荐位的内容海报"):i("请设置第 "+(d+1)+" 个推荐位的内容海报");if(""===e.focusConfig&&void 0===v&&"group"===e.parentType)return i("请选择默认落焦");if(g)return i("含有空推荐位");if(b)return i("含有重复推荐位内容")}i()},validateBlocks:function(){var e,t,a,i,n,o,r,l,s,c,u,d,p=this.pannel.pannelList,h=this.pannel.focusConfig,m=(this.selectedLayout,{});e:for(var f=0,g=p.length;f<g;f++){var b=p[f];if(!b.pannelTitle){e=f;break e}var v=b.pannelTitle.trim();if(m[v]){t=f;break e}if(m[v]=!0,"timeSlot"===h&&(!b.startTime||!b.endTime)&&!b.panelIsFocus){a=f;break e}b.panelIsFocus&&(d=f);for(var y=b.contentList,w=0,I=y.length;w<I;w++){var C=y[w]||{};if(!C.videoContentList||0===C.videoContentList.length){c=C;break e}if(C.duplicated){u=!0;break e}var T=C.videoContentList[0].price;C.videoContentList[0].coverType;if("Mall"===C.contentPosition.type&&(void 0===T||-1===T||""===T)){i=f,n=w;break e}var S=C.videoContentList[0].title||"",k=C.videoContentList[0].forceTitle||!1;k&&""===S.trim()&&(l=f,s=w);var _=C.videoContentList[0].pictureUrl;_||(o=f,r=w)}}return{emptyPannelTitleIndex:e,duplicatedPannelTitleIndex:t,emptyTimeSlotIndex:a,emptyPostIndex:o,emptyPostBlockIndex:r,emptyPriceIndex:i,emptyPriceBlockIndex:n,emptyTitleIndex:l,emptyTitleBlockIndex:s,emptyBlock:c,hasDuplicated:u,focusIndex:d}},handleSaveDraft:function(){var e=this,t=this.getFormData();t.isTiming=void 0,t.releaseTime=void 0,t.pannelStatus=this.$consts.status.draft,this.validate(t,function(){e.upsertPanelInfo(t)})},handleSubmitAudit:function(e){var t=this,a=this.getFormData();a.pannelStatus=this.$consts.status.waiting,this.validate(a,function(){t.couldSetReleaseTime?e?(a.isTiming=e.isTiming,a.releaseTime=e.releaseTime,t.upsertPanelInfo(a)):t.$refs.commonContent.showReleaseTimeSetter=!0:t.upsertPanelInfo(a)})},upsertPanelInfo:function(e){var t=this;this.$service.panelUpsert(this.parseDataToApi(e),"保存成功").then(function(e){t.$emit("upsert-end")})},setPanelInfoData:function(e){var t=e,a=this.pannel,i=t.pannelList||[],n=i[0];if(Object.assign(a,e),a.pannelName=e.pannelGroupRemark,n){n.contentList=n.contentList||[],this.blockCountList=i.map(function(e){return e.contentList.length}),a.pannelList=i.map(function(e){if(e.contentList=e.contentList.map(function(e){return e.contentPosition=JSON.parse(e.contentPosition),[].concat(e.videoContentList||[],e.specificContentList||[]).forEach(function(e){-1==e.price&&(e.price=""),-1==e.secKillPrice&&(e.secKillPrice="")}),e}),e.timeSlot){var t=e.timeSlot.split(",");e.startTime=new Date(t[0]),e.endTime=new Date(t[1])}return e.selectedResources=e.contentList,e}),a.pannelResource=n.pannelResource,a.flagIs4k=n.flagIs4k,a.showTitle=n.showTitle,a.focusShape=n.focusShape,a.pannelStatus=n.pannelStatus;var o=n.layoutInfo;o.layoutJsonParsed=JSON.parse(o.layoutJson),this.selectedLayout=o;var r=n.contentList[0];r&&(a.lucenyFlag=r.lucenyFlag,a.focusImgUrl=r.focusImgUrl,this.isShowfocusImgUrl=r.focusImgUrl)}this.pannel=Object(j["a"])({},a),this.updateAllPosition(),this.getSharedTags(),this.$watch("pannel.focusConfig",this.handleFocusConfigChange)},clickBlock:function(){var e=this.initGroupIndex,t=this.initBlockIndex;void 0!==e&&(this.activePannelIndex=e),void 0!==t&&this.handleClickBlock(t)}},created:function(){var e=this;this.mode=this.initMode||"create",this.$service.getDictType({type:"businessType",isFilter:1}).then(function(t){e.businessTypeEnums=t.map(function(e){return{label:e.dictCnName,value:e.dictId,disabled:e.disabled}})})},mounted:function(){var e=this;this.id&&this.fetchData(this.version).then(function(){e.clickBlock()})}},Hp=qp,zp=(a("99e1"),Object(Bn["a"])(Hp,Lu,Ru,!1,null,"21143490",null)),Jp=zp.exports,Kp=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{ref:"contentCard",staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[void 0===e.dataList?a("ButtonGroupForListPage",{attrs:{pageName:"albumPanel"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}):e._e(),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},Qp=[],Xp={extends:Po,components:{ContentWrapper:Dn["ContentWrapper"],Table:Dn["Table"],ButtonGroupForListPage:Ro},props:{dataList:{type:Object}},data:function(){var e,t=this;return e={resourceType:"panelInfo",businessType:{},pannelStatus:{},filter:this.genDefaultFilter(),filterSchema:null,pagination:{currentPage:1}},Object(ei["a"])(e,"businessType",{}),Object(ei["a"])(e,"table",{props:{},data:[],header:[{label:"ID",prop:"pannelGroupId"},{label:"名称",prop:"pannelGroupRemark",minWidth:180,"show-overflow-tooltip":!0,render:function(e,a){var i=a.row;return e("el-button",{attrs:{type:"text"},on:{click:function(){t.handleRead(i)}}},i.pannelGroupRemark)}},{label:"布局",width:"150",prop:"fullLayoutName"},{label:"业务分类",prop:"categoryName"},{label:"内容源",prop:"pannelResource",formatter:function(e){return t.$consts.sourceText[e.pannelList[0].pannelResource]}},{label:"引用状态",prop:"fullTabName","show-overflow-tooltip":!0},{label:"版本/状态",prop:"pannelStatus",width:"130",formatter:function(e){var a=e.pannelStatus,i=e.currentVersion;return i+"/"+t.$consts.statusText[a]}},{label:"待审核副本",width:"100",prop:"duplicateVersion",render:function(e,a){var i=a.row;return e("el-button",{attrs:{type:"text"},on:{click:function(e){e.stopPropagation(),t.handleRead(i,i.duplicateVersion)}}},i.duplicateVersion)}},{label:"更新时间",prop:"lastUpdateDate",width:"140","show-overflow-tooltip":!0},{label:"审核人",prop:"auditor",width:"100"},{label:"更新人",prop:"userName",width:"100"},{label:"操作",fixed:"right",width:140,render:function(e,a){var i=a.row;return e("div",[e("el-button",{props:{type:"text"},on:{click:function(e){e.stopPropagation(),t.handleCopy(i)}}},"复制"),e("el-button",{props:{type:"text"},on:{click:function(e){e.stopPropagation(),t.handleToggleCollect(i)}}},[e("el-icon",{class:i.collected?"el-icon-star-on":"el-icon-star-off"}),i.collected?"取消":"收藏"]),!!i.showContentAuthSettingBtn&&e("el-button",{props:{type:"text"},on:{click:function(e){e.stopPropagation(),t.handleOpenContentAuthManager(i)}}},"内容权限")])}}],selected:[],selectionType:"multiple"}),Object(ei["a"])(e,"selected",[]),e},watch:{selected:{handler:function(e,t){var a=this.table,i=[];a.data.map(function(t){if(e.indexOf(t.pannelGroupId)>-1){var a={pannelGroupId:t.pannelGroupId,pannelGroupRemark:t.pannelGroupRemark,duplicateVersion:t.duplicateVersion,pannelType:t.pannelType};console.log("AlbumPannelInfo"),i.push(a)}}),this.$emit("input",i)}}},methods:{handleOpenContentAuthManager:function(e){this.$refs.contentCard.handleShowContentAuthManager({id:e.pannelGroupId,menuElId:"albumPannelInfo",type:"pannel"})},genDefaultFilter:function(){return{idPrefix:this.$consts.idPrefix,pannelType:3}},fetchData:function(){var e=this,t=this.parseFilter();this.dataList?this.$service.panelDataList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows}):this.$service.panelPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.pannelId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){console.log(this.dataList),this.dataList?(this.filter=Object.assign({},this.dataList.filter),console.log(this.filter)):this.filter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},getBusinessType:function(){var e=this;return this.$service.getDictType({type:"businessType"}).then(function(t){t.forEach(function(t){e.businessType[t.dictCnName]=t.dictId})})},handleToggleCollect:function(e){var t=this;e.collected?this.$service.collectCancel({type:"pannel",data:{resourceId:e.pannelGroupId}},"取消收藏成功").then(function(){t.$set(e,"collected",!1)}):this.$service.collect({type:"pannel",data:{resourceId:e.pannelGroupId}},"收藏成功").then(function(){t.$set(e,"collected",!0)})}},created:function(){var e=this,t=co.a.map({pannelCategory:co.a.o.enum(this.businessType).other("form",{placeholder:"业务分类",component:"Select"}),pannelId:co.a.o.string.other("form",{placeholder:"ID",component:"Input"}),pannelName:co.a.o.string.other("form",{placeholder:"版块名称",component:"Input"}),pannelTitle:co.a.o.string.other("form",{placeholder:"版块标题",component:"Input"}),vDataListName:co.a.o.string.other("form",{placeholder:"关联专辑名",component:"Input"}),tabName:co.a.o.string.other("form",{placeholder:"引用状态",component:"Input"}),pannelResource:co.a.o.enum(this.$consts.sourceEnums).other("form",{placeholder:"内容源",component:"Select"}),pannelStatus:co.a.o.enum(this.$consts.statusEnums).other("form",{placeholder:"状态",component:"Select"}),type:co.a.o.enum({"默认":-1,"置顶":1,"下沉":0}).other("form",{placeholder:"智能化推荐",component:"Select"})}).other("form",{cols:{item:6,label:0,wrapper:18},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});"10"!=this.$consts.idPrefix&&t.map({idPrefix:co.a.o.enum({"酷开":"10","江苏广电":"11"}).other("form",{component:"Select",placeholder:"数据来源"})}),this.getBusinessType().then(function(){e.dataList?e.filterSchema=a.filterSchema:e.filterSchema=t});var a=this.dataList;a&&(this.filter=Object.assign({},a.filter),this.table=a.table),this.fetchData()}},Yp=Xp,Zp=Object(Bn["a"])(Yp,Kp,Qp,!1,null,"a599bc4c",null),eh=Zp.exports,th="pannelGroupId",ah={components:{PanelInfo:Jp,AlbumPannelInfoList:eh},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0}},methods:{handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e[th],this.mode="edit",this.isShowList=!1},handleRead:function(e,t){this.id=e[th],this.mode="read",this.version=t,this.isShowList=!1},handleCopy:function(e){this.id=e[th],this.mode="copy",this.isShowList=!1},handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},handleDelete:function(e){var t=this;this.$service.panelRemove({id:e.map(function(e){return e.pannelGroupId}).join(",")},"删除成功").then(function(){t.$refs.list.fetchData()})},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},ih=ah,nh=Object(Bn["a"])(ih,Fu,$u,!1,null,null,null),oh=nh.exports,rh=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"markPanel"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},lh=[],sh={extends:Po,components:{Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"],ButtonGroupForListPage:Ro},data:function(){var e=this;return{resourceType:"panelInfo",businessTypes:{},filter:this.genDefaultFilter(),filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"pannelGroupId",width:"90"},{label:"名称",prop:"pannelGroupRemark",minWidth:"100","show-overflow-tooltip":!0,render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(i)}}},i.pannelGroupRemark)}},{label:"业务分类",prop:"categoryName",width:"90"},{label:"内容源",prop:"pannelList",width:"90",render:function(t,a){var i=a.row,n=i.pannelList;if(n.length>0)return e.$consts.sourceText[n[0].pannelResource]}},{label:"引用状态",prop:"fullTabName","min-width":"90"},{label:"版本/状态",prop:"pannelStatus",width:"120",render:function(t,a){var i=a.row;return i.currentVersion+"/"+e.$consts.statusText[i.pannelStatus]}},{label:"待审核副本",prop:"duplicateVersion",width:"90",render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(i,i.duplicateVersion)}}},i.duplicateVersion)}},{label:"更新时间",prop:"lastUpdateDate",width:"140"}],data:[],selected:[],selectionType:"multiple"}}},methods:{genDefaultFilter:function(){return{idPrefix:this.$consts.idPrefix,pannelType:8}},fetchData:function(){var e=this,t=this.parseFilter();this.$service.getMarkPanelList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},getBusinessType:function(){var e=this;return this.$service.getDictType({type:"businessType"}).then(function(t){t.forEach(function(t){e.businessTypes[t.dictCnName]=t.dictId}),console.log(e.businessTypes)})},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.pannelId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()}},created:function(){var e=this,t=co.a.map({pannelId:co.a.o.string.other("form",{component:"Input",placeholder:"ID"}),pannelName:co.a.o.string.other("form",{component:"Input",placeholder:"名称"}),pannelCategory:co.a.o.enum(this.businessTypes).other("form",{component:"Select",placeholder:"业务分类"}),pannelResource:co.a.o.enum(this.$consts.sourceEnums).other("form",{component:"Select",placeholder:"内容源"}),tabName:co.a.o.string.other("form",{component:"Input",placeholder:"引用状态"}),pannelStatus:co.a.o.enum(this.$consts.statusEnums).other("form",{component:"Select",placeholder:"状态"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});"10"!=this.$consts.idPrefix&&t.map({idPrefix:co.a.o.enum({"酷开":"10","江苏广电":"11"}).other("form",{component:"Select",placeholder:"数据来源"})}),this.fetchData(),this.getBusinessType().then(function(){e.filterSchema=t})}},ch=sh,uh=(a("8b5d"),Object(Bn["a"])(ch,rh,lh,!1,null,"d36da156",null)),dh=uh.exports,ph=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("CommonContent",{ref:"commonContent",attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{replicate:function(t){e.mode="replicate",e.title="创建副本"},edit:function(t){e.mode="edit",e.title="编辑"},unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,audit:function(t){return e.$emit("upsert-end")},"select-version":e.fetchData,delete:function(t){return e.$emit("upsert-end",t)},"submit-audit":e.handleSubmitAudit,"save-draft":e.handleSaveDraft}},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),"read"!==e.mode?a("div",[a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"版块名称",prop:"pannelList[0].pannelName"}},[a("el-input",{attrs:{placeholder:"版块名称"},model:{value:e.form.pannelList[0].pannelName,callback:function(t){e.$set(e.form.pannelList[0],"pannelName",t)},expression:"form.pannelList[0].pannelName"}})],1),a("el-form-item",{attrs:{label:"版块标题",prop:"pannelList[0].pannelTitle"}},[a("el-input",{attrs:{placeholder:"版块标题"},model:{value:e.form.pannelList[0].pannelTitle,callback:function(t){e.$set(e.form.pannelList[0],"pannelTitle",t)},expression:"form.pannelList[0].pannelTitle"}}),a("el-checkbox",{staticClass:"marginL",attrs:{value:!e.form.pannelList[0].showTitle},on:{input:function(t){e.form.pannelList[0].showTitle=t?0:1}}},[e._v("前端不显示标题")])],1),a("el-form-item",{attrs:{label:"功能类型",prop:"clientType"}},[a("el-input",{attrs:{placeholder:"功能类型"},model:{value:e.form.clientType,callback:function(t){e.$set(e.form,"clientType",t)},expression:"form.clientType"}})],1),a("el-form-item",{attrs:{label:"内容源",prop:"pannelList[0].pannelResource"}},[a("el-radio",{attrs:{label:""},model:{value:e.form.pannelList[0].pannelResource,callback:function(t){e.$set(e.form.pannelList[0],"pannelResource",t)},expression:"form.pannelList[0].pannelResource"}},[e._v("不限")]),a("el-radio",{attrs:{label:"o_tencent"},model:{value:e.form.pannelList[0].pannelResource,callback:function(t){e.$set(e.form.pannelList[0],"pannelResource",t)},expression:"form.pannelList[0].pannelResource"}},[e._v("腾讯")]),a("el-radio",{attrs:{label:"o_iqiyi"},model:{value:e.form.pannelList[0].pannelResource,callback:function(t){e.$set(e.form.pannelList[0],"pannelResource",t)},expression:"form.pannelList[0].pannelResource"}},[e._v("爱奇艺")]),a("el-radio",{attrs:{label:"o_youku"},model:{value:e.form.pannelList[0].pannelResource,callback:function(t){e.$set(e.form.pannelList[0],"pannelResource",t)},expression:"form.pannelList[0].pannelResource"}},[e._v("优酷")])],1)],1)],1):e._e(),"read"===e.mode?a("div",[a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"版块名称",prop:"pannelList[0].pannelName"}},[e._v(e._s(e.form.pannelList[0].pannelName))]),a("el-form-item",{attrs:{label:"版块标题",prop:"pannelList[0].pannelTitle"}},[e._v(e._s(e.form.pannelList[0].pannelTitle)+e._s(0===e.form.pannelList[0].showTitle?"(前端不显示)":""))]),a("el-form-item",{attrs:{label:"功能类型",prop:"clientType"}},[e._v(e._s(e.form.clientType))]),a("el-form-item",{attrs:{label:"内容源",prop:"pannelList[0].pannelResource"}},[a("el-radio",{attrs:{disabled:!0,label:""},model:{value:e.form.pannelList[0].pannelResource,callback:function(t){e.$set(e.form.pannelList[0],"pannelResource",t)},expression:"form.pannelList[0].pannelResource"}},[e._v("不限")]),a("el-radio",{attrs:{disabled:!0,label:"o_tencent"},model:{value:e.form.pannelList[0].pannelResource,callback:function(t){e.$set(e.form.pannelList[0],"pannelResource",t)},expression:"form.pannelList[0].pannelResource"}},[e._v("腾讯")]),a("el-radio",{attrs:{disabled:!0,label:"o_iqiyi"},model:{value:e.form.pannelList[0].pannelResource,callback:function(t){e.$set(e.form.pannelList[0],"pannelResource",t)},expression:"form.pannelList[0].pannelResource"}},[e._v("爱奇艺")]),a("el-radio",{attrs:{disabled:!0,label:"o_youku"},model:{value:e.form.pannelList[0].pannelResource,callback:function(t){e.$set(e.form.pannelList[0],"pannelResource",t)},expression:"form.pannelList[0].pannelResource"}},[e._v("优酷")])],1)],1)],1):e._e()])],1)],1)},hh=[],mh={components:{CommonContent:Us},props:{id:Number,initMode:String,version:{type:String,default:function(){return""}}},data:function(){var e={draft:2,waiting:3,accepted:4,rejected:5,processing:7};return{STATUS:e,title:"",showTimeShelf:!1,releaseTime:void 0,form:Object(ei["a"])({parentType:"function",pannelGroupId:void 0,currentVersion:void 0,panelGroupType:8,clientType:"",pannelStatus:void 0,pannelList:[{pannelName:"",pannelType:8,pannelResource:"",pannelTitle:"",showTitle:0,pannelStatus:void 0,pannelCategory:67}]},"currentVersion",void 0),rules:{"pannelList[0].pannelName":[{required:!0,message:"请输入版块名称",trigger:"blur"}],"pannelList[0].pannelTitle":[{required:!0,message:"请输入版块标题",trigger:"blur"}],clientType:[{required:!0,message:"请输入功能类型",trigger:"blur"}]}}},computed:{resourceInfo:function(){var e=this.form;if(e.pannelGroupId)return{id:e.pannelGroupId,type:"pannel",menuElId:"pannelInfo",version:e.currentVersion,status:e.pannelList[0].pannelStatus}},couldSetReleaseTime:function(){var e=this.mode,t=this.form.currentVersion,a="create"===e||"copy"===e,i="edit"===e&&"V1"===t,n="10"==this.$consts.idPrefix;return n&&!(a||i)}},methods:{handleSubmitAudit:function(e){var t=this,a=this.getFormData();a.pannelList[0].pannelStatus=this.$consts.status.waiting,this.validateFormData(a,function(){t.couldSetReleaseTime?e?(a.isTiming=e.isTiming,a.releaseTime=e.releaseTime,t.submit(a)):t.$refs.commonContent.showReleaseTimeSetter=!0:t.submit(a)})},handleSaveDraft:function(){var e=this.getFormData();e.isTiming=void 0,e.releaseTime=void 0,e.pannelList[0].pannelStatus=this.$consts.status.draft,this.validateFormData(e,function(){this.submit(e)}.bind(this))},getFormData:function(){var e=JSON.parse(JSON.stringify(this.form)),t=this.mode;return"replicate"===t&&(e.currentVersion=""),"copy"===t&&(e.tabId=void 0,e.currentVersion=""),e},submit:function(e){var t=this,a=JSON.stringify(e);this.$service.MarkPanelSave({jsonStr:a},"保存成功").then(function(e){t.$emit("upsert-end")})},validateFormData:function(e,t){var a=this;this.$refs.form.validate(function(e){e?t():a.$message({type:"error",message:"请把表单填写完整"})})},fetchData:function(e){var t=this;this.$service.getViewData({id:this.id,version:e}).then(function(a){t.form=a,""!==e&&void 0!==e&&t.$service.getTimedInfo({id:t.id,version:e,type:"pannel"}).then(function(e){t.releaseTime=e.releaseTime})})}},created:function(){switch(this.mode=this.initMode||"create",this.mode){case"create":this.title="新增";break;case"copy":this.title="复制";break;case"edit":this.title="编辑";break;case"replica":this.title="创建副本";case"read":this.title="预览";break}this.id&&this.fetchData(this.version)}},fh=mh,gh=(a("e1cc"),Object(Bn["a"])(fh,ph,hh,!1,null,"73289a08",null)),bh=gh.exports,vh={extends:hc,components:{ResourceList:dh,ResourceContent:bh},data:function(){return{}},computed:{resourceInfo:function(){return{type:"markPanel",idField:"pannelGroupId"}}}},yh=vh,wh=Object(Bn["a"])(yh,np,op,!1,null,null,null),Ih=wh.exports,Ch=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("PanelInfoList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,read:e.handleRead,edit:e.handleEdit,copy:e.handleCopy,delete:e.handleDelete}}),e.isShowList?e._e():a("PanelInfo",{attrs:{id:e.id,"panel-data-type":1,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},Th=[],Sh=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{ref:"contentCard",staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"panel"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},kh=[],_h={extends:Po,components:{ContentWrapper:Dn["ContentWrapper"],Table:Dn["Table"],ButtonGroupForListPage:Ro},props:{dataList:{type:Object}},data:function(){var e=this;return{resourceType:"panelInfo",filter:this.genDefaultFilter(),filterSchema:null,pagination:{currentPage:1},businessType:{},table:{props:{},data:[],header:[{label:"ID",prop:"pannelGroupId"},{label:"名称",minWidth:"180","show-overflow-tooltip":!0,render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(i)}}},i.pannelGroupRemark)}},{label:"布局",width:"150",prop:"fullLayoutName"},{label:"业务分类",prop:"categoryName"},{label:"内容源",prop:"pannelResource",formatter:function(t){return e.$consts.sourceText[t.pannelList[0].pannelResource]}},{label:"引用状态",prop:"fullTabName","show-overflow-tooltip":!0},{label:"版本/状态",prop:"pannelStatus",width:"130",formatter:function(t){var a=t.pannelStatus,i=t.currentVersion;return i+"/"+e.$consts.statusText[a]}},{label:"待审核副本",width:"100",render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(i,i.duplicateVersion)}}},i.duplicateVersion)}},{label:"更新时间",prop:"lastUpdateDate",width:"140","show-overflow-tooltip":!0},{label:"审核人",prop:"auditor",width:"100"},{label:"更新人",width:"100",prop:"userName"},{label:"操作",fixed:"right",width:180,render:function(t,a){var i=a.row;return t("div",[t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleCopy(i)}}},"复制"),t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleToggleCollect(i)}}},[t("el-icon",{class:i.collected?"el-icon-star-on":"el-icon-star-off"}),i.collected?"取消":"收藏"]),!!i.showContentAuthSettingBtn&&t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleOpenContentAuthManager(i)}}},"内容权限")])}}],selected:[],selectionType:"multiple"},selected:[]}},watch:{selected:{handler:function(e,t){var a=this.table,i=[];a.data.map(function(t){if(e.indexOf(t.pannelGroupId)>-1){var a={pannelGroupId:t.pannelGroupId,pannelGroupRemark:t.pannelGroupRemark,duplicateVersion:t.duplicateVersion};i.push(a)}}),this.$emit("input",i)}}},methods:{handleOpenContentAuthManager:function(e){this.$refs.contentCard.handleShowContentAuthManager({id:e.pannelGroupId,menuElId:"pannelInfo",type:"pannel"})},genDefaultFilter:function(){return{idPrefix:this.$consts.idPrefix}},fetchData:function(){var e=this,t=this.parseFilter();this.dataList?this.$service.panelDataList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows}):this.$service.panelPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.pannelId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){console.log(this.dataList),this.dataList?(this.filter=Object.assign({},this.dataList.filter),console.log(this.filter)):this.filter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},getBusinessType:function(){var e=this;return this.$service.getDictType({type:"businessType"}).then(function(t){t.forEach(function(t){e.businessType[t.dictCnName]=t.dictId})})},handleToggleCollect:function(e){var t=this;e.collected?this.$service.collectCancel({type:"pannel",data:{resourceId:e.pannelGroupId}},"取消收藏成功").then(function(){t.$set(e,"collected",!1)}):this.$service.collect({type:"pannel",data:{resourceId:e.pannelGroupId}},"收藏成功").then(function(){t.$set(e,"collected",!0)})}},created:function(){var e=this,t=co.a.map({pannelCategory:co.a.o.enum(this.businessType).other("form",{placeholder:"业务分类",component:"Select"}),pannelId:co.a.o.string.other("form",{placeholder:"ID",component:"Input"}),pannelName:co.a.o.string.other("form",{placeholder:"版块名称",component:"Input"}),pannelTitle:co.a.o.string.other("form",{placeholder:"版块标题",component:"Input"}),tabName:co.a.o.string.other("form",{placeholder:"引用状态",component:"Input"}),pannelResource:co.a.o.enum(this.$consts.sourceEnums).other("form",{placeholder:"内容源",component:"Select"}),pannelStatus:co.a.o.enum(this.$consts.statusEnums).other("form",{placeholder:"状态",component:"Select"}),pannelType:co.a.o.enum({"影视推荐版块":6,"定向版块":7,"常规版块":1}).other("form",{placeholder:"版块类别",component:"Select"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});"10"!=this.$consts.idPrefix&&t.map({idPrefix:co.a.o.enum({"酷开":"10","江苏广电":"11"}).other("form",{component:"Select",placeholder:"数据来源"})}),this.getBusinessType().then(function(){e.dataList?e.filterSchema=a.filterSchema:e.filterSchema=t});var a=this.dataList;a&&(this.filter=Object.assign({},a.filter),this.table=a.table),this.fetchData()}},Ph=_h,xh=Object(Bn["a"])(Ph,Sh,kh,!1,null,"0fcef189",null),Dh=xh.exports,Fh="pannelGroupId",$h={components:{PanelInfo:Jp,PanelInfoList:Dh},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0}},methods:{handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e[Fh],this.mode="edit",this.isShowList=!1},handleRead:function(e,t){this.id=e[Fh],this.mode="read",this.version=t,this.isShowList=!1},handleCopy:function(e){this.id=e[Fh],this.mode="copy",this.isShowList=!1},handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},handleDelete:function(e){var t=this;this.$service.panelRemove({id:e.map(function(e){return e.pannelGroupId}).join(",")},"删除成功").then(function(){t.$refs.list.fetchData()})},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},Lh=$h,Rh=Object(Bn["a"])(Lh,Ch,Th,!1,null,null,null),Nh=Rh.exports,Eh=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("PrivatePannelInfoList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,read:e.handleRead,edit:e.handleEdit,copy:e.handleCopy,delete:e.handleDelete}}),e.isShowList?e._e():a("PrivatePannelInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},Oh=[],Ah=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[void 0===e.dataList?a("ButtonGroupForListPage",{attrs:{pageName:"privatePanel"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}):e._e(),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},Vh=[],Mh={extends:Po,components:{ContentWrapper:Dn["ContentWrapper"],Table:Dn["Table"],ButtonGroupForListPage:Ro},props:{dataList:{type:Object}},data:function(){var e=this;return{resourceType:"panelInfo",pannelCategories:{},pannelStatus:{},filter:{sort:void 0,order:void 0,pannelType:5},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"pannelGroupId",width:"90"},{label:"名称",prop:"pannelGroupRemark",minWidth:180,"show-overflow-tooltip":!0,render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(i)}}},i.pannelGroupRemark)}},{label:"业务分类",prop:"categoryName",width:"70"},{label:"引用状态",prop:"fullTabName"},{label:"版本/状态",prop:"pannelStatus",formatter:function(t){var a=t.pannelStatus,i=t.currentVersion;return"".concat(i,"/").concat(e.$consts.statusText[a])}},{label:"待审核副本",prop:"duplicateVersion",width:"90",render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(i,i.duplicateVersion)}}},i.duplicateVersion)}},{label:"更新时间",width:140,prop:"lastUpdateDate"},{label:"审核人",prop:"auditor"},{label:"更新人",prop:"userName"}],data:[],selected:[],selectionType:"multiple"}}},watch:{selected:{handler:function(e,t){var a=this.table,i=[];a.data.map(function(t){if(e.indexOf(t.pannelGroupId)>-1){var a={pannelGroupId:t.pannelGroupId,pannelGroupRemark:t.pannelGroupRemark,duplicateVersion:t.duplicateVersion,pannelType:t.pannelType};console.log("PrivatePannelInfo"),i.push(a)}}),this.$emit("input",i)}}},methods:{fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.dataList,this.$service.panelPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.pannelId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.dataList?this.filter=Object.assign({},this.dataList.filter):this.filter={sort:void 0,order:void 0,pannelType:5},this.pagination.currentPage=1,this.fetchData()},getDictType:function(){var e=this;return this.$service.getDictType({type:"businessType"}).then(function(t){t.forEach(function(t){e.pannelCategories[t.dictCnName]=t.dictId})})}},created:function(){var e=this,t=co.a.map({pannelId:co.a.o.string.other("form",{component:"Input",placeholder:"ID"}),pannelName:co.a.o.string.other("form",{component:"Input",placeholder:"名称"}),pannelTitle:co.a.o.string.other("form",{component:"Input",placeholder:"标题"}),pannelResource:co.a.o.enum(this.$consts.sourceEnums).other("form",{component:"Select",placeholder:"内容源"}),pannelCategory:co.a.o.enum(this.pannelCategories).other("form",{component:"Select",placeholder:"业务分类"}),tabName:co.a.o.string.other("form",{component:"Input",placeholder:"引用状态"}),pannelStatus:co.a.o.enum(this.$consts.statusEnums).other("form",{component:"Select",placeholder:"状态"})}).other("form",{cols:{item:6,label:0,wrapper:18},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}}),a=this.dataList;a&&(this.filter=Object.assign({},a.filter),this.table=a.table),this.getDictType().then(function(){e.dataList?e.filterSchema=a.filterSchema:e.filterSchema=t}),this.fetchData()}},Bh=Mh,Uh=Object(Bn["a"])(Bh,Ah,Vh,!1,null,"073a740a",null),jh=Uh.exports,Gh=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"hompage-upsert"},[a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("div",{staticClass:"base-info"},[a("div",[e._v("专属影院版块：")]),a("div",[e._v("专属影院，影片数据 由大数据和媒资库提供，运营人员只需配置相应内容块的影片类型（0 会员影片，1 非会员影片，2 单点影片）。")])]),a("CommonContent",{attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{replicate:function(t){e.mode="replicate"},edit:function(t){e.mode="edit"},unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,audit:function(t){return e.$emit("upsert-end")},"select-version":e.fetchData,delete:function(t){return e.$emit("upsert-end",t)},"submit-audit":e.handleSubmitAudit,"save-draft":e.handleSaveDraft}},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),"read"!==e.mode?a("div",[a("el-form",{ref:"upsertForm",staticClass:"el-form-add",attrs:{model:e.panel,"label-width":"120px",rules:e.rules}},[a("el-form-item",{attrs:{label:"业务分类"}},[a("el-select",{attrs:{value:e.panel.panelGroupCategory},on:{input:e.handlePanelGroupCategoryChange}},e._l(e.panelGroupCategoryOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.dictCnName,value:e.dictId}})}),1),a("span",{staticClass:"spform marginL"},[e._v("注：只有一个权限的操作者不能选择业务分类")])],1),"common"===e.panelGroupCategoryValue||"video"===e.panelGroupCategoryValue?a("el-form-item",{attrs:{label:"内容源"}},[a("el-radio-group",{attrs:{value:e.panel.pannelResource,disabled:e.sourceDisabled},on:{input:e.handlePannelResourceChange}},e._l(e.$consts.sourceOptions,function(t,i){return a("el-radio",{key:i,attrs:{label:t.value}},[e._v("\n                  "+e._s(t.label)+"\n                ")])}),1)],1):e._e(),a("el-form-item",{attrs:{label:"版块名称",prop:"pannelList.0.pannelName",rules:e.rules.pannelName}},[a("el-input",{model:{value:e.panel.pannelList[0].pannelName,callback:function(t){e.$set(e.panel.pannelList[0],"pannelName",t)},expression:"panel.pannelList[0].pannelName"}})],1),9===e.panel.panelGroupType?[a("el-form-item",{attrs:{label:"推荐策略"}},[a("el-select",{attrs:{value:e.panel.pannelList[0].recommendStrategy,disabled:e.isReplica},on:{input:e.handleRecommedStrategyInput}},e._l(e.recommendStrategyOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1)]:e._e(),a("div",{staticClass:"form-legend-header"},[a("span",[e._v("内容配置")])]),a("el-form-item",{attrs:{label:"版块标题",prop:"pannelList.0.pannelTitle",rules:e.rules.pannelTitle}},[a("el-input",{attrs:{placeholder:"请输入版本标题"},model:{value:e.panel.pannelList[0].pannelTitle,callback:function(t){e.$set(e.panel.pannelList[0],"pannelTitle",t)},expression:"panel.pannelList[0].pannelTitle"}}),a("el-checkbox",{staticClass:"marginL",attrs:{value:!e.panel.showTitle},on:{input:function(t){e.panel.showTitle=!t}}},[e._v("前端不显示标题")])],1),a("div",[5===e.panel.panelGroupType?a("el-form-item",{attrs:{label:"版块布局"}},[e.panel.layoutId>0?a("span",{staticClass:"spform J-selected J_select J_layout-selected"},[e._v(e._s(e.panel.layoutId))]):e._e(),a("el-checkbox",{model:{value:e.panel.lucenyFlag,callback:function(t){e.$set(e.panel,"lucenyFlag",t)},expression:"panel.lucenyFlag"}},[e._v("设置前端推荐位底色透明")]),a("div",{staticClass:"content-list"},e._l(e.panel.pannelList[0].contentList,function(t,i){return a("div",{key:i,staticClass:"content-list__item"},[a("el-select",{attrs:{size:"mini"},model:{value:t.blockVideoType,callback:function(a){e.$set(t,"blockVideoType",a)},expression:"item.blockVideoType"}},e._l(e.blockVideoTypeOptions,function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})}),1),a("span",{staticClass:"content-list__item-id"},[e._v(e._s(i+1))])],1)}),0)],1):e._e()],1),a("el-form-item",{attrs:{prop:"pannelList.0.firstPageVipContentAmount",label:"首屏付费内容数",rules:e.rules.amount}},[a("el-input-number",{attrs:{max:6,min:0},model:{value:e.panel.pannelList[0].firstPageVipContentAmount,callback:function(t){e.$set(e.panel.pannelList[0],"firstPageVipContentAmount",t)},expression:"panel.pannelList[0].firstPageVipContentAmount"}})],1),a("el-form-item",{attrs:{prop:"pannelList.0.vipContentAmount",label:"总付费内容数",rules:e.rules.amount}},[a("el-input-number",{attrs:{max:15,min:0},model:{value:e.panel.pannelList[0].vipContentAmount,callback:function(t){e.$set(e.panel.pannelList[0],"vipContentAmount",t)},expression:"panel.pannelList[0].vipContentAmount"}})],1)],2)],1):e._e(),"read"===e.mode?a("div",[a("el-form",{attrs:{"label-width":"120px","label-position":"right"}},[a("el-form-item",{attrs:{label:"业务分类"}},[a("span",[e._v(e._s(e.getCategoryLabel(e.panel.panelGroupCategory)))])]),"common"===e.panelGroupCategoryValue||"video"===e.panelGroupCategoryValue?a("el-form-item",{attrs:{label:"内容源"}},[a("span",[e._v(e._s(e.$consts.sourceText[e.panel.pannelResource]))])]):e._e(),a("el-form-item",{attrs:{label:"版块名称",prop:"pannelList.0.pannelName"}},[e._v("\n              "+e._s(e.panel.pannelList[0].pannelName)+"\n            ")]),9===e.panel.panelGroupType?[a("el-form-item",{attrs:{label:"推荐策略"}},[a("span",[e._v("\n                  "+e._s(e.getRecommendStrategyLabel(e.panel.pannelList[0].recommendStrategy))+"\n                ")])])]:e._e(),a("div",{staticClass:"form-legend-header"},[a("span",[e._v("内容配置")])]),a("el-form-item",{attrs:{label:"版块标题",prop:"pannelList.0.pannelTitle"}},[e._v("\n              "+e._s(e.panel.pannelList[0].pannelTitle)+"\n              ("+e._s(e.panel.showTitle?"显示":"不显示")+")\n            ")]),5===e.panel.panelGroupType?a("el-form-item",{attrs:{label:"版块布局"}},[e.panel.layoutId>0?a("span",{staticClass:"spform J-selected J_select J_layout-selected"},[e._v(e._s(e.panel.layoutId))]):e._e(),e._v("\n              ("+e._s(e.panel.lucenyFlag?"透明":"非透明")+")\n              "),a("div",{staticClass:"content-list"},e._l(e.panel.pannelList[0].contentList,function(t,i){return a("div",{key:i,staticClass:"content-list__item"},[a("el-select",{attrs:{disabled:"read"===e.mode,size:"mini"},model:{value:t.blockVideoType,callback:function(a){e.$set(t,"blockVideoType",a)},expression:"item.blockVideoType"}},e._l(e.blockVideoTypeOptions,function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})}),1),a("span",{staticClass:"content-list__item-id"},[e._v(e._s(i+1))])],1)}),0)]):e._e(),9===e.panel.panelGroupType||10===e.panel.panelGroupType?a("el-form-item",{attrs:{label:"内容免/付费比例"}},[a("el-form-item",{staticClass:"amount-input",attrs:{label:"首屏付费内容数"}},[e._v(e._s(e.panel.pannelList[0].firstPageVipContentAmount))]),a("el-form-item",{staticClass:"amount-input",attrs:{label:"总付费内容数"}},[e._v(e._s(e.panel.pannelList[0].vipContentAmount))])],1):e._e()],2)],1):e._e()])],1)],1)])},Wh=[],qh=(a("7cdf"),{mixins:[zu],components:{CommonContent:Us},props:{id:Number,initMode:String,version:{type:String,default:function(){return""}}},data:function(){var e=[{value:0,label:"会员影片"},{value:1,label:"非会员影片"},{value:2,label:"单点影片"}];return{mode:"create",resourceName:"专属影院",panelGroupCategoryOptions:[],recommendStrategyOptions:[],blockVideoTypeOptions:e,rules:{pannelName:[{required:!0,message:"请填写版块名称"},{max:45,message:"版块名称不超过 45 个字符"}],pannelTitle:[{required:!0,message:"请填写标题"},{max:45,message:"标题不超过 45 个字符"}],amount:[{validator:function(e,t,a){Number.isInteger(Number(t))&&Number(t)>=0?a():a(new Error("请输入整数"))},trigger:"blur"}]},versionList:[],panel:{pannelGroupId:void 0,currentVersion:void 0,parentType:"function",groupTitle:"",showTitle:!0,lucenyFlag:!1,pannelResource:"o_tencent",panelGroupCategory:67,panelGroupType:9,pannelList:[{pannelId:void 0,pannelCategory:67,pannelName:void 0,pannelTitle:"专属剧场",pannelResource:void 0,pannelType:9,pannelStatus:void 0,showTitle:void 0,flagIs4k:0,recommendStrategy:"serial_watch_too",vipContentAmount:5,firstPageVipContentAmount:2,contentList:[]}]}}},computed:{sourceDisabled:function(){return"replicate"===this.mode||void 0!==this.panel.currentVersion&&2!==panel.pannelList[0].pannelStatus},panelGroupCategoryValue:function(){var e=this.panelGroupCategoryOptions,t=this.panel.panelGroupCategory;if(e){var a=e.find(function(e){return e.dictId===t});return a&&a.dictEnName}},resourceInfo:function(){var e=this.panel;if(e.pannelGroupId)return{id:e.pannelGroupId,type:"pannel",menuElId:"privatePannelInfo",version:e.currentVersion,status:e.pannelList[0].pannelStatus}},isReplica:function(){return"replica"===this.mode},isDisableTabType:function(){var e=this.mode;return"edit"===e||"replicate"===e||"copy"===e}},methods:{handleRecommedStrategyInput:function(e){this.panel.pannelList[0].recommendStrategy=e,this.initPanelTitleByRecommendStrategy(e)},initPanelTitleByRecommendStrategy:function(e){var t=this.recommendStrategyOptions.find(function(t){return t.value===e});this.panel.pannelList[0].pannelTitle=t&&t.label},getRecommendStrategyLabel:function(e){var t=this.recommendStrategyOptions.find(function(t){return t.value===e});return t&&t.label},setDefaultPanelTitle:function(e){this.panel.pannelList[0].pannelType=e,this.panel.pannelList[0].pannelTitle=10===e?"猜你喜欢":"专属剧场"},getCategoryLabel:function(e){var t=this.panelGroupCategoryOptions.find(function(t){return t.dictId===e});return t&&t.dictCnName},getPanelGroupTypeLabel:function(e){var t={9:"根据用户近期观影偏好推荐",10:"根据用户近期观看的影片推荐"};return t[e]},handlePanelGroupCategoryChange:function(e){this.panel.panelGroupCategory=e;var t=this.panelGroupCategoryValue;this.panel.pannelResource="common"===t||"video"===t?"o_tencent":""},handlePannelResourceChange:function(e){this.panel.pannelResource=e},handleSaveDraft:function(){var e=JSON.parse(JSON.stringify(this.panel));e.pannelStatus=2,this.submit(e)},handleSubmitAudit:function(){var e=JSON.parse(JSON.stringify(this.panel));e.pannelStatus=3,this.submit(e)},validate:function(e,t){this.$refs.upsertForm.validate(function(a){if(a){var i=e.pannelList[0],n=e.panelGroupType;if(9===n||10===n){if(i.vipContentAmount<i.firstPageVipContentAmount)return t("首屏付费内容数量不能大于总付费内容数量");if(i.vipContentAmount>i.firstPageVipContentAmount+9)return t("总付费内容数应小于等于(首屏付费内容数 + 9)")}t()}})},submit:function(e){var t=this,a=e.pannelList[0].firstPageVipContentAmount,i=e.pannelList[0].vipContentAmount;i>a+9?this.$message({type:"error",message:"总付费内容数应小于等于（首屏付费内容数 + 9）"}):this.validate(e,function(a){a?t.$message({type:"error",message:a}):t.$service.panelUpsert(t.parseDataToApi(e),"保存成功").then(function(e){t.$emit("upsert-end")})})},parseDataToApi:function(e){"replicate"===this.mode&&(e.currentVersion="");var t=JSON.parse(JSON.stringify(e)),a=t.panelGroupCategory,i=t.pannelResource,n=t.pannelStatus,o=t.layoutId,r=t.showTitle?1:0,l=t.lucenyFlag?1:0;return t.pannelList.forEach(function(e){e.pannelCategory=a,e.pannelResource=i,e.pannelStatus=n,e.layoutId=o,e.showTitle=r,e.contentList&&e.contentList.forEach(function(e){e.lucenyFlag=l})}),delete t.pannelResource,delete t.showTitle,delete t.lucenyFlag,delete t.pannelStatus,delete t.layoutId,t},parseApiToData:function(e){var t=e,a=e.pannelList[0];if(t.pannelResource=a.pannelResource,t.showTitle=1==a.showTitle,t.pannelStatus=a.pannelStatus,t.layoutId=a.layoutId,a.contentList&&a.contentList.length>0){var i=a.contentList[0];t.lucenyFlag=1==i.lucenyFlag}return t},setPanel:function(e){var t=this.parseApiToData(e);Object.assign(this.panel,t)},getDictType:function(){var e=this;this.$service.getDictType({type:"businessType"}).then(function(t){e.panelGroupCategoryOptions=t})},getRecommendStrategy:function(){var e=this;this.$service.getRecommendStrategy().then(function(t){console.log("rs",t),e.recommendStrategyOptions=t})},fetchData:function(e){var t=this;this.$service.panelGetDetail({id:this.id,version:e}).then(function(e){t.setPanel(e)})}},created:function(){this.mode=this.initMode||"create",this.id&&this.fetchData(this.version),this.getDictType(),this.getRecommendStrategy()}}),Hh=qh,zh=(a("97a6"),Object(Bn["a"])(Hh,Gh,Wh,!1,null,"cedeba2c",null)),Jh=zh.exports,Kh={components:{PrivatePannelInfoList:jh,PrivatePannelInfo:Jh},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0}},methods:{handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e.pannelGroupId,this.mode="edit",this.isShowList=!1},handleRead:function(e,t){this.id=e.pannelGroupId,this.mode="read",this.version=t,this.isShowList=!1},handleCopy:function(e){this.id=e.pannelGroupId,this.mode="copy",this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.privatePanelRemove({id:e.map(function(e){return e.pannelGroupId}).join(",")},"删除成功").then(function(e){t.$refs.list.fetchData()})},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},Qh=Kh,Xh=Object(Bn["a"])(Qh,Eh,Oh,!1,null,"73068fce",null),Yh=Xh.exports,Zh=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("CommonOnclickInfoList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}),e.isShowList?e._e():a("CommonOnclickInfo",{attrs:{editId:e.id},on:{openListPage:e.handleUpsertEnd,"go-back":e.goBack}})],1)},em=[],tm=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitBtn}},[e._v("保存")]),a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{model:e.form,rules:e.formRules,"label-width":"160px"}},[a("el-form-item",{attrs:{label:"点击事件名称",prop:"onlickName"}},[a("el-input",{attrs:{placeholder:"点击事件名称"},model:{value:e.form.onlickName,callback:function(t){e.$set(e.form,"onlickName",t)},expression:"form.onlickName"}})],1),a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{attrs:{placeholder:"备注"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),a("AppParams",{attrs:{"prop-prefix":"onclick."},model:{value:e.form.onclick,callback:function(t){e.$set(e.form,"onclick",t)},expression:"form.onclick"}}),a("el-form-item",{attrs:{label:"异常处理(exception)",prop:"exception"}},[a("el-input",{attrs:{type:"textarea",placeholder:"异常处理(exception)"},model:{value:e.form.exception,callback:function(t){e.$set(e.form,"exception",t)},expression:"form.exception"}})],1)],1)],1)},am=[],im={components:{AppParams:Dn["AppParams"]},props:{editId:Number,default:null},data:function(){return{title:null,form:{onlickName:null,remark:null,onlickJson:null,onclick:{packagename:null,versioncode:"-1",dowhat:"startActivity",bywhat:"action",byvalue:null,params:[]},exception:null},formRules:{onlickName:[{required:!0,message:"请输入点击事件名称",trigger:"blur"}],packagename:[{required:!0,message:"请输入应用包名",trigger:"blur"}],byvalue:[{required:!0,message:"请输入启动参数",trigger:"blur"}]},paramsList:[{key:"",value:""}]}},methods:{paramsAddBtn:function(){this.paramsList.push({key:"",value:""})},paramsRedBtn:function(e){this.paramsList.splice(e,1)},submitBtn:function(){var e=this;this.$refs.form.validate(function(t){if(t){var a={};e.form.onclick.params.forEach(function(e){a[e.key]=e.value}),e.form.onclick.params=a,e.form=Object.assign({},e.form,e.form.onclick),e.form.onlickJson=JSON.stringify(e.form.onclick),delete e.form.onclick,e.$service.commonOnclickInfoSave({jsonStr:JSON.stringify(e.form)},"保存成功").then(function(t){e.$emit("openListPage")})}})},getEditData:function(){var e=this;this.$service.getCommonOnclickInfoEdit({id:this.editId}).then(function(t){var a=JSON.parse(t.params||"{}");t.params=Object.keys(a).map(function(e){return{key:e,value:a[e]}}),t.onclick={packagename:t.packagename,versioncode:t.versioncode,dowhat:t.dowhat,bywhat:t.bywhat,byvalue:t.byvalue,params:t.params},delete t.packagename,delete t.versioncode,delete t.dowhat,delete t.bywhat,delete t.byvalue,delete t.params,e.form=Object.assign({},e.form,t)})}},created:function(){null!==this.editId&&void 0!==this.editId?(this.title="编辑",this.getEditData()):this.title="新增"}},nm=im,om=(a("2174"),Object(Bn["a"])(nm,tm,am,!1,null,"c363d844",null)),rm=om.exports,lm=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"onclickInfo"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},sm=[],cm={extends:Po,components:{ActionList:Dn["ActionList"],Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"],ButtonGroupForListPage:Ro},data:function(){return{resourceType:"clickEvent",resourceName:"点击事件",filter:{},filterSchema:null,pagination:{},setDialogVisible:!1,selected:[],table:{props:{},header:[{label:"ID",prop:"commonOnclickId"},{label:"点击事件名称",prop:"onlickName"},{label:"备注",prop:"remark"},{label:"应用包名",prop:"packagename"},{label:"应用版本号",prop:"versioncode"},{label:"启动动作",prop:"dowhat"},{label:"启动方式",prop:"bywhat"},{label:"启动参数",prop:"byvalue"},{label:"扩展参数",prop:"params"},{label:"异常处理",prop:"exception"},{label:"创建人",prop:"modifierName"},{label:"创建时间",prop:"createdDate"},{label:"修改人",fixed:"modifierName"},{label:"修改时间",fixed:"lastUpdateDate"}],data:[],selected:[],selectionType:"multiple"}}},methods:{handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.commonOnclickId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();this.$service.getCommonOnclickInfoList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=co.a.map({commonOnclickId:co.a.o.string.other("form",{component:"Input",placeholder:"ID"}),onlickName:co.a.o.string.other("form",{component:"Input",placeholder:"点击事件名"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},um=cm,dm=(a("1f0f"),Object(Bn["a"])(um,lm,sm,!1,null,"a0d914ca",null)),pm=dm.exports,hm={components:{CommonOnclickInfo:rm,CommonOnclickInfoList:pm},data:function(){return{isShowList:!0,mode:"list",id:null}},methods:{handleCreate:function(){this.mode="create",this.id=void 0,this.isShowList=!1},handleEdit:function(e){this.id=e.commonOnclickId,this.mode="edit",this.isShowList=!1},handleRead:function(e){this.id=e.commonOnclickId,this.mode="read",this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.commonOnclickInfoDelete({id:e.map(function(e){return e.commonOnclickId}).join(",")},"删除成功").then(function(e){t.$refs.list.fetchData()})},handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},mm=hm,fm=Object(Bn["a"])(mm,Zh,em,!1,null,null,null),gm=fm.exports,bm=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("GlobalCornerIconList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,edit:e.handleEdit,read:e.handleRead,delete:e.handleDelete}}),e.isShowList?e._e():a("GlobalCornerIcon",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},vm=[],ym=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"cornerIcon"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1),a("el-dialog",{attrs:{title:"预览图片",visible:e.picDialogVisible,width:"30%"},on:{"update:visible":function(t){e.picDialogVisible=t}}},[a("span",{staticClass:"pics"},[a("img",{staticStyle:{width:"200px"},attrs:{src:e.reviewPicUrl,alt:"图片"}})])]),a("el-dialog",{attrs:{title:"审核",visible:e.dialogPLVisible,"before-close":e.handleDialogClose},on:{"update:visible":function(t){e.dialogPLVisible=t}}},[a("GlobalIconAudit",{ref:"auditForm",on:{auditForm:e.submitForm,cancle:e.cancle}})],1),a("el-dialog",{attrs:{title:"调整优先级",visible:e.dialogLevelVisible},on:{"update:visible":function(t){e.dialogLevelVisible=t}}},[a("GlobelIconLevel"),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogLevelVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogLevelVisible=!1}}},[e._v("确 定")])],1)],1)],1)},wm=[],Im=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"auditForm",staticClass:"demo-ruleForm",attrs:{model:e.auditForm,"status-icon":"",rules:e.auditFormRule,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"审核意见",prop:"auditFlag"}},[a("el-radio",{attrs:{label:"4"},model:{value:e.auditForm.auditFlag,callback:function(t){e.$set(e.auditForm,"auditFlag",t)},expression:"auditForm.auditFlag"}},[e._v("通过")]),a("el-radio",{attrs:{label:"5"},model:{value:e.auditForm.auditFlag,callback:function(t){e.$set(e.auditForm,"auditFlag",t)},expression:"auditForm.auditFlag"}},[e._v("打回")])],1),a("el-form-item",{attrs:{label:"意见说明",prop:"auditDesc"}},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入意见说明"},model:{value:e.auditForm.auditDesc,callback:function(t){e.$set(e.auditForm,"auditDesc",t)},expression:"auditForm.auditDesc"}})],1),a("el-form-item",[a("el-button",{on:{click:function(t){return e.cancle("auditForm")}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("auditForm")}}},[e._v("确定")])],1)],1)],1)},Cm=[],Tm={data:function(){return{auditForm:{auditFlag:"4",auditDesc:""},auditFormRule:{auditDesc:[{required:!0,message:"请输入审核意见",trigger:"blur"}]}}},methods:{onSubmit:function(e){var t=this;this.$refs.auditForm.validate(function(e){if(e){var a=t.auditForm;t.$emit("auditForm",a)}})},cancle:function(e){this.$refs.auditForm.resetFields();var t=!1;this.$emit("cancle",t)}},created:function(){}},Sm=Tm,km=Object(Bn["a"])(Sm,Im,Cm,!1,null,null,null),_m=km.exports,Pm=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("el-table",{staticStyle:{"margin-top":"20px","max-width":"80%"},attrs:{data:e.tab.pannelList,border:""}},[a("el-table-column",{attrs:{prop:"cornerIconId",label:"版块ID"}}),a("el-table-column",{attrs:{prop:"cornerIconName",label:"版块名称"}}),a("el-table-column",{attrs:{label:"图片",prop:""},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{attrs:{src:e.row.imgUrl,width:"70px"}})]}}])}),a("el-table-column",{attrs:{prop:"",label:"优先级",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("OrderInput",{key:Math.random().toString(),attrs:{value:t.$index+1},on:{input:function(a){return e.handleChangePannelOrderStart(t.$index,a)},blur:function(a){return e.handleChangePannelOrderEnd(t.$index)}}})]}}])})],1)],1)],1)},xm=[],Dm=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-input",{on:{blur:function(t){return e.$emit("blur")}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}})},Fm=[],$m=void 0,Lm={data:function(){return{inputValue:void 0}},props:["value"],watch:{inputValue:"handleInputValue",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){$m.inputValue=value})},methods:{handleInputValue:function(e){this.$emit("input",e)}},created:function(){this.inputValue=this.value}},Rm=Lm,Nm=Object(Bn["a"])(Rm,Dm,Fm,!1,null,null,null),Em=Nm.exports,Om={components:{ActionList:Dn["ActionList"],Table:Dn["Table"],OrderInput:Em,ContentWrapper:Dn["ContentWrapper"]},data:function(){return{tab:{cornerIconId:void 0,cornerIconName:void 0,imgUrl:void 0,pannelList:[]},globalTypes:{test1:"1010",test2:"1011","付费属性":"101","排行榜":"103","教育角标":"105","策划类":"104","素材播出属性":"102"},attributeTypes:{},dialogPLVisible:!1,dialogLevelVisible:!1,typePositions:{"左上":0,"右上":1,"左下":3,"右下":2},reviewPicUrl:null,filter:{sort:void 0,order:void 0},filterSchema:null,pagination:{},selected:[]}},methods:{fetchData:function(){var e=this,t=this.parseFilter();this.$service.getGlobalMgrList(t).then(function(t){console.log(t),e.pagination.total=t.total,e.tab.pannelList=t.rows})},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.idPrefix="10",e.page=t.currentPage,e.rows=t.pageSize),e},handleChangePannelOrderStart:function(e,t){if(""!==t){t=parseInt(t);var a=this.tab.pannelList;isNaN(t)||t>a.length||t<=0?(this.currentPannelIndex=void 0,this.$message({type:"error",message:"序号必须大于0且不能大于总数量"}),this.tab.pannelList=a.slice()):(this.currentPannelIndex=e,this.currentPannelOrder=t)}},handleChangePannelOrderEnd:function(e){if(this.currentPannelIndex===e){var t=this.currentPannelOrder-1,a=e,i=this.tab.pannelList,n=i[a];i.splice(a,1),this.tab.pannelList=[].concat(i.slice(0,t),n,i.slice(t)),this.currentPannelIndex=void 0,this.currentPannelOrder=void 0}},handleFilterChange:function(e,t){t&&(this.filter=t),"query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData()},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},handleRowSelectionAdd:function(e){this.selected.push(e.cornerIconId),this.updateTableSelected()},handleRowSelectionRemove:function(e){this.selected=this.selected.filter(function(t){return t!==e.cornerIconId}),this.updateTableSelected()},handleAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleRowSelectionAdd):(this.selected=[],this.table.selected=[])},handleAllRowSelectionRemove:function(){this.selected=[],this.table.selected=[]},updateTableSelected:function(){var e=this.table,t=this.selected;e.selected=e.data.reduce(function(e,a,i){return t.indexOf(a.cornerIconId)>-1&&e.push(i),e},[])},getCornerTypes:function(){var e=this;return this.$service.getCornerTypes().then(function(t){t.forEach(function(t){e.globalTypes[t.typeName]=t.typeId}),console.log(e.globalTypes)})},getIconAttributes:function(){var e=this;return this.$service.getIconAttributes().then(function(t){t.attributes.forEach(function(t){e.attributeTypes[t.attributeName]=t.attributeCode}),console.log(e.attributeTypes)})}},created:function(){var e=this,t=co.a.map({typeId:co.a.o.enum(this.globalTypes).other("form",{component:"Select",placeholder:"角标分类",cols:{item:3,label:0}})}).other("form",{layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.fetchData(),this.getCornerTypes().then(function(){e.getIconAttributes().then(function(){e.filterSchema=t})})}},Am=Om,Vm=(a("e020"),Object(Bn["a"])(Am,Pm,xm,!1,null,"52b15aa3",null)),Mm=Vm.exports,Bm={extends:Po,components:{ActionList:Dn["ActionList"],Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"],GlobalIconAudit:_m,GlobelIconLevel:Mm,ButtonGroupForListPage:Ro},data:function(){var e=this;return{resourceType:"cornerIcon",checkAll:!1,globalTypes:{test1:"1010",test2:"1011","付费属性":"101","排行榜":"103","教育角标":"105","策划类":"104","素材播出属性":"102"},attributeTypes:{},dialogPLVisible:!1,dialogLevelVisible:!1,typePositions:{"左上":0,"右上":1,"左下":3,"右下":2},picDialogVisible:!1,reviewPicUrl:null,filter:this.genDefaultFilter(),filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"cornerIconId"},{label:"角标名称",prop:"cornerIconName",render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(i)}}},i.cornerIconName)}},{label:"图片",prop:"imgUrl",render:function(t,a){var i=a.row;return t("img",{attrs:{src:i.imgUrl,width:"50px",height:"50px",class:"imgs"},on:{click:function(t){t.stopPropagation(),e.reviewPic(i)}}})}},{label:"审核状态",prop:"cornerStatus",render:function(t,a){var i=a.row;return e.$consts.statusText[i.cornerStatus]}}],data:[],selected:[],selectionType:"multiple"}}},methods:{genDefaultFilter:function(){return{idPrefix:this.$consts.idPrefix}},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.getGlobalMgrList(t).then(function(t){console.log(t),e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},batchHandle:function(){var e=this;if(0==e.selected.length)e.$message("最少选择一条数据");else{console.log(e.table.data);for(var t=e.selected,a=0;a<t.length;a++)for(var i=0;i<e.table.data.length;i++)t[a]==e.table.data[i].cornerIconId&&(3==e.table.data[i].cornerStatus||2==e.table.data[i].cornerStatuses?this.dialogPLVisible=!0:e.$message("["+t[a]+"]不是待审核状态，不允许审核"))}},submitForm:function(e){var t=this,a=e;this.$service.batchAudit({idStr:this.selected.join(","),auditFlag:a.auditFlag,auditDesc:a.auditDesc},"审核成功").then(function(e){t.fetchData(),t.$refs.auditForm.cancle(),t.dialogPLVisible=!1})},cancle:function(e){this.dialogPLVisible=e},handleDialogClose:function(){this.$refs.auditForm.cancle()},changePriority:function(){this.dialogLevelVisible=!0},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.cornerIconId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},getCornerTypes:function(){var e=this;return this.$service.getCornerTypes().then(function(t){t.forEach(function(t){e.globalTypes[t.typeName]=t.typeId}),console.log(e.globalTypes)})},getIconAttributes:function(){var e=this;return this.$service.getIconAttributes().then(function(t){t.attributes.forEach(function(t){e.attributeTypes[t.attributeName]=t.attributeCode}),console.log(e.attributeTypes)})},reviewPic:function(e){this.reviewPicUrl=e.imgUrl,this.picDialogVisible=!0}},created:function(){var e=this,t=co.a.map({cornerIconName:co.a.o.string.other("form",{component:"Input",placeholder:"角标名称  "}),cornerIconId:co.a.o.string.other("form",{component:"Input",placeholder:"ID"}),typeId:co.a.o.enum(this.globalTypes).other("form",{component:"Select",placeholder:"角标分类"}),typePosition:co.a.o.enum(this.typePositions).other("form",{component:"Select",placeholder:"角标位置"}),attributeCode:co.a.o.enum(this.attributeTypes).other("form",{component:"Select",placeholder:"角标类别"}),cornerStatus:co.a.o.enum(this.$consts.statusEnums).other("form",{component:"Select",placeholder:"审核状态"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});"10"!=this.$consts.idPrefix&&t.map({idPrefix:co.a.o.enum({"酷开":"10","江苏广电":"11"}).other("form",{component:"Select",placeholder:"数据来源"})}),this.fetchData(),this.getCornerTypes().then(function(){e.getIconAttributes().then(function(){e.filterSchema=t})})}},Um=Bm,jm=(a("8ffe"),Object(Bn["a"])(Um,ym,wm,!1,null,"007be065",null)),Gm=jm.exports,Wm=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"global-picture",attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("CommonContent",{attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{edit:function(t){e.mode="edit"},unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,audit:function(t){return e.$emit("upsert-end")},"select-version":e.fetchData,delete:function(t){return e.$emit("upsert-end",t)}}},[a("div",{attrs:{slot:"auditAndDraft"},slot:"auditAndDraft"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("提交审核")])],1),"read"!==e.mode?a("div",{staticClass:"layout-upsert"},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"form",attrs:{"label-width":"120px",model:this}},[a("div",{staticClass:"global-picture__label"},[e._v("角标图片")]),a("Upload",{ref:"upload",staticClass:"global-picture__uploader",attrs:{multiple:!0},on:{upload:e.handleUpload}},[a("template",{slot:"preview"},[e._l(e.fileInfo,function(t,i){return a("div",{key:i,staticClass:"upload-pic-list__item-wrapper"},[a("div",{staticClass:"upload-pic-list__item"},["error"===t.upload.status?a("div",{staticClass:"upload-pic-list__error"},[e._v("上传失败: "+e._s(t.upload.message))]):e._e(),"uploading"===t.upload.status?a("div",{staticClass:"upload-pic-list__progress"},[a("el-progress",{attrs:{width:180,type:"circle",percentage:t.upload.percentage}})],1):a("img",{attrs:{src:t.upload.dataUrl}})]),a("div",{staticClass:"pic-info"},[a("el-form-item",{attrs:{prop:"fileInfo."+i+".cornerIconName",rules:e.rules.title,label:"角标标题"}},[a("el-input",{model:{value:t.cornerIconName,callback:function(a){e.$set(t,"cornerIconName",a)},expression:"file.cornerIconName"}})],1),a("el-form-item",{attrs:{prop:"fileInfo."+i+".typeRls.typeId",rules:e.rules.type,label:"角标分类"}},[a("el-select",{model:{value:t.typeRls.typeId,callback:function(a){e.$set(t.typeRls,"typeId",a)},expression:"file.typeRls.typeId"}},e._l(e.attributes,function(e,t){return a("el-option",{key:t,attrs:{value:e.typeId,label:e.typeName}})}),1)],1),a("el-form-item",{attrs:{prop:"fileInfo."+i+".attributeCode",rules:e.rules.code,label:"角标类别"}},[a("el-radio-group",{model:{value:t.attributeCode,callback:function(a){e.$set(t,"attributeCode",a)},expression:"file.attributeCode"}},[a("el-radio",{attrs:{label:"0"}},[e._v("其他")]),a("el-radio",{attrs:{label:"1"}},[e._v("VIP")])],1)],1)],1),"uploading"!==t.status?a("i",{staticClass:"upload-pic-list__remove el-icon el-icon-close",attrs:{title:"移除"},on:{click:function(a){return e.handleRemoveFile(t,i)}}}):e._e()])}),a("el-button",{staticClass:"upload-pic-list__add",attrs:{disabled:"edit"===e.mode&&e.fileInfo.length>=1,type:"primary",plain:""},on:{click:function(t){return e.$refs.upload.handleSelectFile()}}},[e._v("\n              点击选择图片\n            ")])],2)],2)],1)],1):e._e(),"read"===e.mode?a("div",{staticClass:"layout-read"},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),e.fileInfo.length>0?a("el-form",{ref:"form",attrs:{"label-width":"120px"}},[a("el-form-item",{attrs:{label:"角标标题",prop:"cornerIconName"}},[e._v("\n          "+e._s(e.fileInfo[0].cornerIconName)+"\n        ")]),a("el-form-item",{attrs:{label:"角标图片",prop:"imgUrl"}},[a("img",{staticStyle:{width:"200px"},attrs:{src:e.fileInfo[0].imgUrl}})]),a("el-form-item",{attrs:{label:"角标类别",prop:"attributeName"}},[e._v("\n          "+e._s(e.fileInfo[0].attributeName)+"\n        ")]),a("el-form-item",{attrs:{label:"角标分类",prop:"attributeName"}},[e._v("\n          "+e._s(e.fileInfo[0].cornerIconType.typeName)+"\n        ")])],1):e._e()],1):e._e()])],1)},qm=[],Hm={mixins:[zu],components:{CommonContent:Us,Upload:Dn["Upload"]},data:function(){return{mode:"create",resourceName:"角标",fileInfo:[],attributes:[],attributesIndexed:[],form:{},rules:{title:[{required:!0,message:"请填写素材标题"},{max:45,message:"不超过 45 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择角标类别"}],code:[{required:!0,message:"请选择角标分类"}]}}},props:["initMode","id"],computed:{resourceInfo:function(){var e=this.fileInfo[0];if(e&&e.cornerIconId)return{id:e.cornerIconId,type:"icon",menuElId:"globalCornerIcon",version:e.currentVersion,status:e.cornerStatus}}},methods:{fetchData:function(e){this.$service.globalCornerIconEdit({id:this.id}).then(this.setFormData)},handleSave:function(){var e=this;this.validateFormData(function(t){if(!t){var a=e.getFormData();e.$service.globalCornerIconSave(a,"保存成功").then(function(){e.$emit("upsert-end")})}})},getFormData:function(){var e=this,t=(this.attributesIndexed,this.getUploadedFiles().map(function(t){return{cornerIconId:e.id,cornerIconName:t.cornerIconName,imgUrl:t.imgUrl,attributeCode:t.attributeCode,typeRls:t.typeRls}}));return t},setFormData:function(e){this.fileInfo=[Object(j["a"])({upload:{status:"success",dataUrl:e.imgUrl},typeRls:{typeId:e.cornerIconType.typeId}},e)]},validateFormData:function(e){this.$refs.form.validate(function(t){if(t){var a=this.getUploadedFiles();0===a.length?(this.$message({type:"error",message:"最少要上传一个角标素材，才能保存"}),e(!0)):e()}else this.$message({type:"error",message:"请把表单填写完整"}),e(!0)}.bind(this))},getUploadedFiles:function(){return this.fileInfo.filter(function(e){return void 0!==e.imgUrl})},getCornerTypes:function(){var e=this;this.$service.getCornerTypes().then(function(t){e.attributes=t||[],e.attributesIndexed=e.attributes.reduce(function(e,t){return e[t.typeName]=t,e},{})})},handleUpload:function(e,t){this.$refs.upload.getImageInfo(t.dataUrl).then(function(a){var i={upload:t,typeRls:{typeId:void 0},cornerIconName:void 0,attributeCode:void 0,imgUrl:void 0,pictureType:void 0};this.fileInfo.push(i),t.status="uploading",this.$service.uploadImage({file:e,onUploadProgress:function(e){e.lengthComputable&&(t.percentage=e.loaded/e.total)}}).then(function(e){if(0==e.code){var a=e.data[0];i.cornerIconName=a.originFileName,i.pictureType=a.fileType,i.imgUrl=a.url,t.status="success"}else t.status="error",t.message=e.msg}).catch(function(){t.status="error",t.message="网络错误"})}.bind(this))},handleRemoveFile:function(e,t){this.$refs.upload.handleRemove(e.upload),this.fileInfo=this.fileInfo.filter(function(e,a){return a!==t})}},created:function(){this.mode=this.initMode||"create",this.id&&this.fetchData(this.version),this.getCornerTypes()}},zm=Hm,Jm=(a("db09"),Object(Bn["a"])(zm,Wm,qm,!1,null,"6ef57636",null)),Km=Jm.exports,Qm={components:{GlobalCornerIconList:Gm,GlobalCornerIcon:Km},data:function(){return{isShowList:!0,mode:"list",id:void 0,version:void 0}},methods:{handleCreate:function(){this.mode="create",this.id=void 0,this.isShowList=!1},handleEdit:function(e){this.id=e.cornerIconId,this.mode="edit",this.isShowList=!1},handleRead:function(e){this.id=e.cornerIconId,this.mode="read",this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.globalCornerIconRemove({id:e.map(function(e){return e.cornerIconId}).join(",")},"删除成功").then(function(e){t.$refs.list.fetchData()})},handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},Xm=Qm,Ym=Object(Bn["a"])(Xm,bm,vm,!1,null,null,null),Zm=Ym.exports,ef=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("GlobalCornerIconTypeList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,edit:e.handleEdit,read:e.handleRead,delete:e.handleDelete}}),e.isShowList?e._e():a("GlobalCornerIconType",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},tf=[],af=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"cornerIconType"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete,"batch-audit":e.batchAudit}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},nf=[],of={extends:Po,components:{Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"],ButtonGroupForListPage:Ro},data:function(){var e=this;return{resourceType:"cornerIconType",materialTypes:{},picDialogVisible:!1,auditDialogVisible:!1,auditForm:{idStr:null,auditFlag:"4",auditDesc:""},auditFormRules:{auditDesc:[{required:!0,message:"请输入意见说明",trigger:"blur"}],auditFlag:[{required:!0,message:"请输入审核意见",trigger:"blur"}]},filter:{sort:void 0,order:void 0},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"typeId",width:"70"},{label:"分类名称",width:"120",prop:"typeName",sortable:!0},{label:"角标位置",prop:"typePosition",width:"110",sortable:!0,render:function(t,a){var i=a.row;return e.$consts.cornerIconPositionText[i.typePosition]}},{label:"优先级(越小越靠前)",prop:"typePriority",width:"150",sortable:!0},{label:"修改人",prop:"modifierName",width:"90"},{label:"创建时间",prop:"createdDate",sortable:!0},{label:"修改时间",prop:"lastUpdateDate",sortable:!0}],data:[],selected:[],selectionType:"multiple"}}},methods:{batchAudit:function(){this.selected.length>0?this.auditDialogVisible=!0:this.$message({type:"error",message:"请选择再审核"})},submitAudit:function(){var e=this;this.$refs.auditForm.validate(function(t){t&&(e.auditForm.idStr=e.selected.join(","),e.$service.materialBatchAudit(e.auditForm,"审批成功").then(function(t){e.fetchData(),e.auditDialogVisible=!1}))})},handleChange:function(e,t,a){for(var i=[],n=0;n<e.length;n++)i.push(["roleIds",e[n]]);this.selectedRole=this.user.concat(i)},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.typeId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.getGlobalCornerIconTypePageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=co.a.map({typeId:co.a.o.string.other("form",{component:"Input",placeholder:"ID"}),typeName:co.a.o.string.other("form",{component:"Input",placeholder:"角标名称"}),typePosition:co.a.o.enum(this.$consts.cornerIconPositionEnums).other("form",{component:"Select",placeholder:"角标位置"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},rf=of,lf=(a("5f09"),Object(Bn["a"])(rf,af,nf,!1,null,"23a27216",null)),sf=lf.exports,cf=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"global-picture",attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("CommonContent",{attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{edit:function(t){e.mode="edit"},unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,audit:function(t){return e.$emit("upsert-end")},"select-version":e.fetchData,delete:function(t){return e.$emit("upsert-end",t)}}},[a("div",{attrs:{slot:"auditAndDraft"},slot:"auditAndDraft"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("保存")])],1),"read"!==e.mode?a("div",{staticClass:"layout-upsert"},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{model:e.form,rules:e.formRules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"角标分类名称",prop:"typeName"}},[a("el-input",{attrs:{placeholder:"角标名称"},model:{value:e.form.typeName,callback:function(t){e.$set(e.form,"typeName",t)},expression:"form.typeName"}})],1),a("el-form-item",{attrs:{label:"角标位置",prop:"typePosition"}},[a("el-select",{attrs:{placeholder:"角标位置"},model:{value:e.form.typePosition,callback:function(t){e.$set(e.form,"typePosition",t)},expression:"form.typePosition"}},e._l(e.$consts.cornerIconPositionOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"优先级",prop:"typePriority"}},[a("el-input-number",{attrs:{min:1,label:"优先级"},model:{value:e.form.typePriority,callback:function(t){e.$set(e.form,"typePriority",t)},expression:"form.typePriority"}})],1)],1)],1):e._e(),"read"===e.mode?a("div",{staticClass:"layout-read"}):e._e()])],1)},uf=[],df={mixins:[zu],components:{CommonContent:Us,Upload:Dn["Upload"]},data:function(){return{mode:"create",resourceName:"角标分类",form:{typeId:void 0,typeName:null,typePosition:null,typePriority:null},formRules:{typeName:[{required:!0,message:"请输入角标名称",trigger:"blur"},{max:45,message:"不能超过45个字符",trigger:"blur"}],typePosition:[{required:!0,message:"请输入角标位置",trigger:"blur"}],typePriority:[{required:!0,message:"请输入角标优先级",trigger:"blur"}]}}},props:["initMode","id"],computed:{resourceInfo:function(){var e=this.form;if(e.typeId)return{id:e.typeId,type:"icon",menuElId:"globalCornerIcon",version:e.currentVersion,status:e.typeStatus}}},methods:{fetchData:function(e){var t=this;this.$service.globalCornerIconTypeDetail({id:this.id}).then(function(e){t.form=Object.assign({},t.form,e)})},handleSave:function(){var e=this;this.$refs.form.validate(function(t){t&&e.$service.globalCornerIconTypeSave(e.form,"保存成功").then(function(t){e.$emit("upsert-end")})})}},created:function(){this.mode=this.initMode||"create",this.id&&this.fetchData(this.version)}},pf=df,hf=(a("9af4"),Object(Bn["a"])(pf,cf,uf,!1,null,"681c7729",null)),mf=hf.exports,ff={components:{GlobalCornerIconTypeList:sf,GlobalCornerIconType:mf},data:function(){return{isShowList:!0,mode:"list",id:void 0,version:void 0}},methods:{handleCreate:function(){this.mode="create",this.id=void 0,this.isShowList=!1},handleEdit:function(e){this.id=e.typeId,this.mode="edit",this.isShowList=!1},handleRead:function(e){this.id=e.typeId,this.mode="read",this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.globalCornerIconTypeBatchDel({id:e.map(function(e){return e.typeId}).join(",")},"删除成功").then(function(e){t.$refs.list.fetchData()})},handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},gf=ff,bf=Object(Bn["a"])(gf,ef,tf,!1,null,null,null),vf=bf.exports,yf=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("GlobalPictureList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,edit:e.handleEdit,read:e.handleRead,delete:e.handleDelete}}),e.isShowList?e._e():a("GlobalPictureUpsert",{attrs:{"edit-id":e.editId,initMode:e.mode},on:{"show-list":e.openListPage,"go-back":e.goBack}})],1)},wf=[],If=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},["read"!==e.mode?a("div",{staticClass:"global-picture"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("保存")]),a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"form",attrs:{"label-width":"120px",model:this}},[a("div",{staticClass:"global-picture__label"},[e._v("素材图片")]),a("Upload",{ref:"upload",staticClass:"global-picture__uploader",attrs:{multiple:!0},on:{upload:e.handleUpload}},[a("template",{slot:"preview"},[e._l(e.fileInfo,function(t,i){return a("div",{key:i,staticClass:"upload-pic-list__item-wrapper"},[a("div",{staticClass:"upload-pic-list__item"},["error"===t.upload.status?a("div",{staticClass:"upload-pic-list__error"},[e._v("上传失败: "+e._s(t.upload.message))]):e._e(),"uploading"===t.upload.status?a("div",{staticClass:"upload-pic-list__progress"},[a("el-progress",{attrs:{width:180,type:"circle",percentage:t.upload.percentage}})],1):a("img",{attrs:{src:t.upload.dataUrl}})]),a("div",{staticClass:"pic-info"},[a("el-form-item",{attrs:{prop:"fileInfo."+i+".pictureName",rules:e.rules.title,label:"素材标题"}},[a("el-input",{model:{value:t.pictureName,callback:function(a){e.$set(t,"pictureName",a)},expression:"file.pictureName"}})],1),a("el-form-item",{attrs:{label:"素材分辨率"}},[e._v(e._s(t.pictureResolution))]),a("el-form-item",{attrs:{prop:"fileInfo."+i+".materialTypeDictEnName",rules:e.rules.type,label:"素材类型"}},[a("el-select",{model:{value:e.fileInfo[i].materialTypeDictEnName,callback:function(t){e.$set(e.fileInfo[i],"materialTypeDictEnName",t)},expression:"fileInfo[index].materialTypeDictEnName"}},e._l(e.picTypeOptions,function(e,t){return a("el-option",{key:t,attrs:{value:e.dictEnName,label:e.dictCnName}})}),1)],1)],1),"uploading"!==t.status?a("i",{staticClass:"upload-pic-list__remove el-icon el-icon-close",attrs:{title:"移除"},on:{click:function(a){return e.handleRemoveFile(t,i)}}}):e._e()])}),a("el-button",{staticClass:"upload-pic-list__add",attrs:{disabled:"edit"===e.mode&&e.fileInfo.length>=1,type:"primary"},on:{click:function(t){return e.$refs.upload.handleSelectFile()}}},[e._v("点击选择图片")]),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){e.showPicTypeSelector=!0}}},[e._v("批量设置类型")])],2)],2)],1),a("el-dialog",{staticClass:"global-pic-type-selector",attrs:{title:"选择素材类型",size:"tiny",visible:e.showPicTypeSelector},on:{"update:visible":function(t){e.showPicTypeSelector=t}}},e._l(e.picTypeOptions,function(t,i){return a("el-tag",{key:i,nativeOn:{click:function(a){return e.handleBatchSetPicType(t)}}},[e._v(e._s(t.dictCnName))])}),1)],1):e._e(),"read"===e.mode?a("div",{staticClass:"global-picture"},[a("div",{staticClass:"global-picture__actions"},[3===e.status?a("el-button",{attrs:{type:"primary"},on:{click:e.audit}},[e._v("审核")]):e._e(),a("el-button",{on:{click:e.handleCancel}},[e._v("关闭")])],1),a("el-form",{ref:"form",attrs:{"label-width":"120px",model:this}},[a("div",{staticClass:"global-picture__label"},[e._v("素材图片")]),a("Upload",{ref:"upload",staticClass:"global-picture__uploader",attrs:{multiple:!0},on:{upload:e.handleUpload}},[a("template",{slot:"preview"},e._l(e.fileInfo,function(t,i){return a("div",{key:i,staticClass:"upload-pic-list__item-wrapper"},[a("div",{staticClass:"upload-pic-list__item"},["error"===t.upload.status?a("div",{staticClass:"upload-pic-list__error"},[e._v("上传失败: "+e._s(t.upload.message))]):e._e(),"uploading"===t.upload.status?a("div",{staticClass:"upload-pic-list__progress"},[a("el-progress",{attrs:{width:180,type:"circle",percentage:t.upload.percentage}})],1):a("img",{attrs:{src:t.upload.dataUrl}})]),a("div",{staticClass:"pic-info"},[a("el-form-item",{attrs:{prop:"fileInfo."+i+".pictureName",rules:e.rules.title,label:"素材标题"}},[e._v(e._s(t.pictureName))]),a("el-form-item",{attrs:{label:"素材分辨率"}},[e._v(e._s(t.pictureResolution))]),a("el-form-item",{attrs:{prop:"fileInfo."+i+".materialTypeDictEnName",rules:e.rules.type,label:"素材类型"}},[a("el-select",{attrs:{disabled:!0},model:{value:e.fileInfo[i].materialTypeDictEnName,callback:function(t){e.$set(e.fileInfo[i],"materialTypeDictEnName",t)},expression:"fileInfo[index].materialTypeDictEnName"}},e._l(e.picTypeOptions,function(e,t){return a("el-option",{key:t,attrs:{value:e.dictEnName,label:e.dictCnName}})}),1)],1)],1)])}),0)],2)],1)],1):e._e(),a("el-dialog",{attrs:{title:"预览图片",visible:e.auditDialogVisible,width:"30%"},on:{"update:visible":function(t){e.auditDialogVisible=t}}},[a("span",[a("el-form",{ref:"auditForm",attrs:{model:e.auditForm,rules:e.auditFormRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"审核意见",prop:"auditFlag"}},[a("el-radio",{attrs:{label:"4"},model:{value:e.auditForm.auditFlag,callback:function(t){e.$set(e.auditForm,"auditFlag",t)},expression:"auditForm.auditFlag"}},[e._v("通过")]),a("el-radio",{attrs:{label:"5"},model:{value:e.auditForm.auditFlag,callback:function(t){e.$set(e.auditForm,"auditFlag",t)},expression:"auditForm.auditFlag"}},[e._v("打回")])],1),a("el-form-item",{attrs:{label:"意见说明",prop:"auditDesc"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.auditForm.auditDesc,callback:function(t){e.$set(e.auditForm,"auditDesc",t)},expression:"auditForm.auditDesc"}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.auditDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitAudit}},[e._v("确 定")])],1)])],1)},Cf=[],Tf={components:{Upload:Dn["Upload"]},data:function(){return{mode:"create",status:void 0,showPicTypeSelector:!1,pictureId:void 0,fileInfo:[],title:"",auditDialogVisible:!1,picTypeOptions:[],picTypeOptionsIndexed:[],rules:{title:[{required:!0,message:"请填写素材标题"},{max:45,message:"不超过 45 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择素材类型"}]},auditForm:{idStr:null,auditFlag:"4",auditDesc:""},auditFormRules:{auditDesc:[{required:!0,message:"请输入意见说明",trigger:"blur"}],auditFlag:[{required:!0,message:"请输入审核意见",trigger:"blur"}]}}},props:["editId","initMode"],methods:{audit:function(){this.auditDialogVisible=!0},submitAudit:function(){var e=this;this.$refs.auditForm.validate(function(t){t&&(e.auditForm.idStr=e.editId,e.$service.materialBatchAudit(e.auditForm,"审批成功").then(function(t){e.auditDialogVisible=!1,e.$emit("show-list")}))})},handleUpload:function(e,t){this.$refs.upload.getImageInfo(t.dataUrl).then(function(a){var i={upload:t,materialTypeDictEnName:void 0,pictureId:void 0,pictureName:void 0,pictureResolution:a.width+"*"+a.height,pictureStatus:void 0,pictureType:void 0,pictureUrl:void 0};this.fileInfo.push(i),t.status="uploading",this.$service.uploadImage({file:e,onUploadProgerss:function(e){e.lengthComputable&&(t.percentage=e.loaded/e.total)}}).then(function(e){if(0==e.code){var a=e.data[0];i.pictureName=a.originFileName,i.pictureType=a.fileType,i.pictureUrl=a.url,t.status="success"}else t.status="error",t.message=e.msg}).catch(function(){t.status="error",t.message="网络错误"})}.bind(this))},handleRemoveFile:function(e,t){this.$refs.upload.handleRemove(e.upload),this.fileInfo=this.fileInfo.filter(function(e,a){return a!==t})},handleSelectPicTypeStart:function(){this.showPicTypeSelector=!0},handleBatchSetPicType:function(e){this.fileInfo.forEach(function(t){t.materialTypeDictEnName=e.dictEnName}),this.showPicTypeSelector=!1},getFormData:function(){var e=this,t=this.pictureId,a=this.picTypeOptionsIndexed,i=this.getUploadedFiles().map(function(i){return{pictureId:t,pictureType:i.pictureType,pictureResolution:i.pictureResolution,pictureUrl:i.pictureUrl,pictureStatus:i.pictureStatus,pictureName:i.pictureName,materialTypes:e.parseMaterialType(a[i.materialTypeDictEnName])}}),n={jsonStr:JSON.stringify(i)};return n},setFormData:function(e){this.status=e.pictureStatus,e=JSON.parse(JSON.stringify(e));var t=e.materialTypes;e.materialTypeDictEnName=t[0].dictEnName,e.upload={status:"success",dataUrl:e.pictureUrl},this.pictureId=e.pictureId,this.fileInfo.push(e)},parseMaterialType:function(e){return{dictId:e.dictId,dictEnName:e.dictEnName,dictCnName:e.dictCnName}},validateFormData:function(e){this.$refs.form.validate(function(t){if(t){var a=this.getUploadedFiles();0===a.length?(this.$message({type:"error",message:"最少要上传一个素材，才能保存"}),e(!0)):e()}else this.$message({type:"error",message:"请把表单填写完整"}),e(!0)}.bind(this))},getUploadedFiles:function(){return this.fileInfo.filter(function(e){return void 0!==e.pictureUrl})},handleSubmit:function(){var e=this;this.validateFormData(function(t){if(!t){var a=e.getFormData();e.$service.globalPictureUpsert(a,"保存成功").then(function(){e.$emit("show-list")})}})},handleCancel:function(){this.$emit("go-back")},getMaterialTypes:function(){var e=this;this.$service.getDictType({type:"materialType"}).then(function(t){e.picTypeOptions=t||[],e.picTypeOptionsIndexed=e.picTypeOptions.reduce(function(e,t){return e[t.dictEnName]=t,e},{})})}},created:function(){this.editId?(this.title="编辑",this.$service.globalPictureGet({id:this.editId}).then(this.setFormData)):this.title="新增",this.mode=this.initMode,this.getMaterialTypes()}},Sf=Tf,kf=(a("6b22"),Object(Bn["a"])(Sf,If,Cf,!1,null,null,null)),_f=kf.exports,Pf=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"poster"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete,"batch-audit":e.batchAudit}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1),a("el-dialog",{attrs:{title:"预览图片",visible:e.picDialogVisible,width:"30%"},on:{"update:visible":function(t){e.picDialogVisible=t}}},[a("span",{staticClass:"pics"},[a("img",{attrs:{src:e.reviewPicUrl,alt:"图片","max-width":"500"}})]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.picDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.picDialogVisible=!1}}},[e._v("确 定")])],1)]),a("el-dialog",{attrs:{title:"审核",visible:e.auditDialogVisible,width:"30%"}},[a("span",[a("el-form",{ref:"auditForm",attrs:{model:e.auditForm,rules:e.auditFormRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"审核意见",prop:"auditFlag"}},[a("el-radio",{attrs:{label:"4"},model:{value:e.auditForm.auditFlag,callback:function(t){e.$set(e.auditForm,"auditFlag",t)},expression:"auditForm.auditFlag"}},[e._v("通过")]),a("el-radio",{attrs:{label:"5"},model:{value:e.auditForm.auditFlag,callback:function(t){e.$set(e.auditForm,"auditFlag",t)},expression:"auditForm.auditFlag"}},[e._v("打回")])],1),a("el-form-item",{attrs:{label:"意见说明",prop:"auditDesc"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.auditForm.auditDesc,callback:function(t){e.$set(e.auditForm,"auditDesc",t)},expression:"auditForm.auditDesc"}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.auditDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitAudit}},[e._v("确 定")])],1)])],1)},xf=[],Df={extends:Po,components:{Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"],ButtonGroupForListPage:Ro},data:function(){var e=this;return{resourceType:"picture",materialTypes:{},picDialogVisible:!1,auditDialogVisible:!1,reviewPicUrl:null,auditForm:{idStr:null,auditFlag:"4",auditDesc:""},auditFormRules:{auditDesc:[{required:!0,message:"请输入意见说明",trigger:"blur"}],auditFlag:[{required:!0,message:"请输入审核意见",trigger:"blur"}]},filter:{sort:void 0,order:void 0},filterSchema:null,pagination:{},selected:[],status:[],table:{props:{},header:[{label:"ID",prop:"pictureId",width:"90"},{label:"ID",prop:"pictureUrl",width:"70",render:function(t,a){var i=a.row;return t("img",{attrs:{src:i.pictureUrl,width:"50px",height:"50px",class:"imgs","referrer-policy":"no-referrer"},on:{click:function(){e.reviewPic(i)}}})}},{label:"素材名称",width:"120",prop:"pictureName",sortable:!0,render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(i)}}},i.pictureName)}},{label:"分辨率",prop:"pictureResolution",width:"110",sortable:!0},{label:"状态",prop:"pictureStatus",width:"90",render:function(t,a){var i=a.row;return e.$numToAuditStatus(i.pictureStatus)}},{label:"素材类型",prop:"materialTypes",width:"70",render:function(e,t){var a=t.row;return a.materialTypes.length>0?a.materialTypes[0].dictCnName:""}},{label:"创建时间",prop:"createdDate",sortable:!0},{label:"修改时间",prop:"lastUpdateDate",sortable:!0}],data:[],selected:[],selectionType:"multiple"}}},methods:{submitAudit:function(){var e=this;this.$refs.auditForm.validate(function(t){t&&(e.auditForm.idStr=e.selected.join(","),e.$service.materialBatchAudit(e.auditForm,"4"===e.auditForm.auditFlag?"审批成功":"打回成功").then(function(t){e.fetchData(),e.auditDialogVisible=!1}))})},handleChange:function(e,t,a){for(var i=[],n=0;n<e.length;n++)i.push(["roleIds",e[n]]);this.selectedRole=this.user.concat(i)},batchAudit:function(){var e=this;if(0!==this.selected.length){var t="";if(this.status.forEach(function(a,i){4===a&&(""===t?t+="ID="+e.selected[i]:(t+=",",t+="ID="+e.selected[i]))}),""!==t)return this.$message({type:"error",message:t+" 已经审核通过了，不需要再审核"}),!1;this.auditForm={idStr:null,auditFlag:"4",auditDesc:""},this.auditDialogVisible=!0}else this.$message("请选择再审批")},reviewPic:function(e){this.reviewPicUrl=e.pictureUrl,this.picDialogVisible=!0},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.pictureId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.getMaterialPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},getMaterialTypes:function(){var e=this;return this.$service.getDictType({type:"materialType"}).then(function(t){t.forEach(function(t){e.materialTypes[t.dictCnName]=t.dictId})})}},created:function(){var e=this,t=co.a.map({pictureId:co.a.o.string.other("form",{component:"Input",placeholder:"ID"}),pictureName:co.a.o.string.other("form",{component:"Input",placeholder:"素材名称"}),pictureCategory:co.a.o.enum(this.materialTypes).other("form",{component:"Select",placeholder:"素材类别"}),pictureStatus:co.a.o.enum(this.$baseStatus()).other("form",{component:"Select",placeholder:"审核状态"})}).other("form",{cols:{item:5,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.getMaterialTypes().then(function(){e.filterSchema=t}),this.fetchData()}},Ff=Df,$f=(a("0844"),Object(Bn["a"])(Ff,Pf,xf,!1,null,"3faf7c22",null)),Lf=$f.exports,Rf={components:{GlobalPictureUpsert:_f,GlobalPictureList:Lf},data:function(){return{isShowList:!0,editId:null,mode:void 0}},methods:{goBack:function(){this.isShowList=!0},handleCreate:function(e){this.editId=void 0,this.isShowList=!1,this.mode="create"},handleEdit:function(e){this.editId=e.pictureId,this.isShowList=!1,this.mode="edit"},handleRead:function(e){this.editId=e.pictureId,this.mode="read",this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.materialBatchDelete({id:e.map(function(e){return e.pictureId}).join(",")},"删除成功").then(function(e){t.$refs.list.fetchData()})},openListPage:function(){this.isShowList=!0,this.$refs.list.fetchData()}}},Nf=Rf,Ef=Object(Bn["a"])(Nf,yf,wf,!1,null,null,null),Of=Ef.exports,Af=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("LayoutInfoList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,edit:e.handleEdit,read:e.handleRead,delete:e.handleDelete}}),e.isShowList?e._e():a("LayoutInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},Vf=[],Mf=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("div",{staticClass:"btns"},[a("ButtonGroupForListPage",{attrs:{pageName:"layout","not-contain-btns":e.notContainBtns},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}})],1),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},Bf=[],Uf={extends:Po,components:{Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"],ButtonGroupForListPage:Ro},data:function(){var e=this;return{resourceType:"layout",notContainBtns:["audit","batchAudit"],layoutType:{"主页6.0":1,"影视V2":2},layoutIsTitle:{"带标题":1,"不带标题":0},filter:this.genDefaultFilter(),filterSchema:null,pagination:{},selected:[],selectedRows:{},table:{props:{},header:[{label:"ID",prop:"layoutId",width:"70"},{label:"名称",width:"200",prop:"layoutName",sortable:!0,render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(i)}}},i.layoutName)}},{label:"分类",prop:"layoutType",width:"80",render:function(e,t){var a=t.row;return 1===a.layoutType?"主页6.0":"影视V2"}},{label:"布局标题",prop:"layoutIsTitle",width:"80",render:function(e,t){var a=t.row;return 1===a.layoutIsTitle?"带标题":"不带标题"}},{label:"扩展方式",prop:"layoutFlag",width:"80",render:function(e,t){var a=t.row;if("undefined"===typeof a.layoutFlag)return"无";switch(a.layoutFlag){case 0:return"横向扩展";case 1:return"纵向扩展"}}},{label:"状态",prop:"layoutStatus",width:70,render:function(t,a){var i=a.row;return e.$consts.statusText[i.layoutStatus]}},{label:"更新时间",prop:"lastUpdateDate",sortable:!0},{label:"更新人",prop:"modifierName",render:function(e,t){var a=t.row;return a.modifierName}}],data:[],selected:[],selectionType:"multiple"}}},methods:{genDefaultFilter:function(){return{}},handleFilterChange:function(e,t){t&&(this.filter=t),"query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData()},handleFilterReset:function(){this.filter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();this.$service.getLayoutInforPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=co.a.map({layoutName:co.a.o.string.other("form",{component:"Input",placeholder:"布局名称"}),layoutType:co.a.o.enum(this.layoutType).other("form",{component:"Select",placeholder:"布局分类"}),layoutIsTitle:co.a.o.enum(this.layoutIsTitle).other("form",{component:"Select",placeholder:"布局标题"}),layoutStatus:co.a.o.enum(this.$consts.statusEnums).other("form",{component:"Select",placeholder:"状态"})}).other("form",{cols:{item:5,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},jf=Uf,Gf=(a("0bca"),Object(Bn["a"])(jf,Mf,Bf,!1,null,"54331b78",null)),Wf=Gf.exports,qf=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PageWrapper",[a("PageContentWrapper",{directives:[{name:"show",rawName:"v-show",value:"layout"===e.activePage,expression:"activePage === 'layout'"}]},[a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("CommonContent",{attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{edit:function(t){e.mode="edit"},unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,audit:function(t){return e.$emit("upsert-end")},"select-version":e.fetchData,delete:function(t){return e.$emit("upsert-end",t)}}},[a("div",{attrs:{slot:"auditAndDraft"},slot:"auditAndDraft"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("提交审核")])],1),"read"!==e.mode?a("div",{staticClass:"layout-upsert"},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{model:e.form,rules:e.formRules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"布局名称(中文)",prop:"layoutName"}},[a("el-input",{attrs:{placeholder:"布局名称"},model:{value:e.form.layoutName,callback:function(t){e.$set(e.form,"layoutName",t)},expression:"form.layoutName"}})],1),a("el-form-item",{attrs:{label:"布局类别",prop:"layoutType"}},[a("el-select",{attrs:{placeholder:"布局类别"},model:{value:e.form.layoutType,callback:function(t){e.$set(e.form,"layoutType",t)},expression:"form.layoutType"}},e._l(e.layoutType,function(e){return a("el-option",{key:e.name+"",attrs:{label:e.name,value:e.id}})}),1)],1),a("el-form-item",{attrs:{label:"上传文件"}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.$refs.upload.handleSelectFile()}}},[e._v("上传布局文件")]),a("Upload",{ref:"upload",attrs:{multiple:!0},on:{upload:e.handleUpload},scopedSlots:e._u([{key:"preview",fn:function(t){var i=t.fileList;return[i&&i.length>0?a("div",[a("div",{staticClass:"upload-pic-list__item"},["error"===i[0].status?a("div",{staticClass:"upload-pic-list__error"},[e._v("\n                        上传失败: "+e._s(i[0].message)+"\n                      ")]):"uploading"===i[0].status?a("div",{staticClass:"upload-pic-list__progress"},[a("el-progress",{staticStyle:{width:"250px"},attrs:{percentage:i[0].percentage}})],1):a("span",[e._v(e._s(i[0].filename))])])]):e._e()]}}],null,!1,4289451972)})],1),a("el-form-item",{attrs:{label:"布局"}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.productLayout}},[e._v("生成布局")])],1),a("el-form-item",[a("LayoutBloack",{staticClass:"layoutBloack",attrs:{content:e.content}})],1)],1)],1):e._e(),"read"===e.mode?a("div",{staticClass:"layout-read"},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"布局名称(中文)",prop:"layoutName"}},[a("div",[e._v(e._s(e.form.layoutName))])]),a("el-form-item",{attrs:{label:"布局类别",prop:"layoutType"}},[a("div",[e._v(e._s(e.layoutTypeText[e.form.layoutType]))])]),a("el-form-item",{attrs:{label:"布局"}},[a("LayoutBloack",{staticClass:"layoutBloack",attrs:{content:e.content}})],1)],1)],1):e._e()])],1)],1),"layout-generate"===e.activePage?a("PageContentWrapper",[a("LayoutInfoGenerator",{on:{"go-back":function(t){e.activePage="layout"},"generator-layout":e.generatorLayout}})],1):e._e()],1)},Hf=[],zf=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pannel-wrap",style:{height:e.maxY*e.ratio+"px",width:e.contentWidth+"px"},attrs:{id:"layout"}},e._l(e.content,function(t,i){return a("div",{key:i},[t.resize?a("div",{style:{top:t.resize.y*e.ratio+"px",left:t.resize.x*e.ratio+"px",width:t.resize.width*e.ratio+"px",height:t.resize.height*e.ratio+"px",position:"absolute"},attrs:{draggable:"true"}},[a("div",{staticClass:"single-blcok pannel-content",style:{top:t.y*e.ratio+"px",left:t.x*e.ratio+"px",width:t.width*e.ratio+"px",height:t.height*e.ratio+"px"}},[a("span",{staticClass:"seq-num"},[e._v(e._s(i+1))]),a("span",{staticClass:"size-mark"},[e._v(e._s(t.width)+"*"+e._s(t.height))]),a("div",{staticClass:"corner-img",staticStyle:{position:"absolute",top:"0px",left:"0"},attrs:{name:"topLeft"}}),a("div",{staticClass:"corner-img",staticStyle:{position:"absolute",top:"0px",right:"0"},attrs:{name:"topRight"}}),a("div",{staticClass:"corner-img",staticStyle:{position:"absolute",bottom:"30px",left:"0"},attrs:{name:"bottomLeft"}}),a("div",{staticClass:"corner-img",staticStyle:{position:"absolute",bottom:"30px",right:"0"},attrs:{name:"bottomRight"}}),"Mall"===t.type?a("div",{staticClass:"specialSamll",attrs:{name:"smallPrice"}},[t.resize.width*e.ratio<150?a("div",[a("span",{staticClass:"secKillPrice",style:{"font-size":"10px","margin-right":"5px"},attrs:{name:"secKillPrice"}}),a("s",{staticClass:"price",style:{"font-size":"10px"},attrs:{name:"price"}})]):a("div",[a("span",{staticClass:"secKillPrice",attrs:{name:"secKillPrice"}}),a("s",{staticClass:"price",attrs:{name:"price"}})])]):e._e()]),t.title_info?a("div",{style:{width:t.title_info.width*e.ratio+"px",height:t.title_info.height*e.ratio+"px","font-size":t.title_info.size*e.ratio+"px","text-align":"center"}},[a("span",{attrs:{name:"titleName"}},[e._v("title")])]):e._e()]):a("div",[a("div",{staticClass:"single-blcok pannel-content",style:{top:t.y*e.ratio+"px",left:t.x*e.ratio+"px",width:t.width*e.ratio+"px",height:t.height*e.ratio+"px",position:"absolute"},attrs:{draggable:"true"}},[a("span",{staticClass:"seq-num"},[e._v(e._s(i+1))]),a("span",{staticClass:"size-mark"},[e._v(e._s(t.width)+"*"+e._s(t.height))]),a("div",{staticClass:"corner-img",staticStyle:{position:"absolute",top:"0px",left:"0"},attrs:{name:"topLeft"}}),a("div",{staticClass:"corner-img",staticStyle:{position:"absolute",top:"0px",right:"0"},attrs:{name:"topRight"}}),a("div",{staticClass:"corner-img",staticStyle:{position:"absolute",bottom:"0px",left:"0"},attrs:{name:"bottomLeft"}}),a("div",{staticClass:"corner-img",staticStyle:{position:"absolute",bottom:"0px",right:"0"},attrs:{name:"bottomRight"}}),t.width*e.ratio>=150?a("div",["Mall"===t.type?a("div",{staticClass:"specialSamll",staticStyle:{bottom:"5px"},attrs:{name:"smallPrice"}},[a("span",{staticClass:"secKillPrice",attrs:{name:"secKillPrice"}}),a("s",{staticClass:"price",attrs:{name:"price"}})]):e._e()]):a("div",["Mall"===t.type?a("div",{staticClass:"specialSamll",staticStyle:{bottom:"5px"},style:{"font-size":"10px !important"},attrs:{name:"smallPrice"}},[a("span",{staticClass:"secKillPrice",attrs:{name:"secKillPrice"}}),a("s",{staticClass:"price",attrs:{name:"price"}})]):e._e()])])])])}),0)},Jf=[],Kf={props:{content:{type:Array},contentWidth:{type:Number,default:811}},data:function(){return{maxX:0,maxY:0,ratio:0}},methods:{init:function(){var e=this;this.maxY=0,this.maxX=0,this.content.forEach(function(t){t=t.resize?t.resize:t,e.maxX=Math.max(e.maxX,t.x+t.width),e.maxY=Math.max(e.maxY,t.y+t.height)})}},mounted:function(){this.ratio=this.contentWidth/this.maxX},watch:{content:function(e,t){this.init(),this.ratio=this.contentWidth/this.maxX}},created:function(){this.init()}},Qf=Kf,Xf=(a("ec194"),Object(Bn["a"])(Qf,zf,Jf,!1,null,"ff7b117e",null)),Yf=Xf.exports,Zf=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:"生成布局"},on:{"go-back":function(t){return e.$emit("go-back","add")}}},[a("el-form",{ref:"dynamicValidateForm",staticClass:"layout-dynamic",attrs:{model:e.dynamicValidateForm,"label-width":"100px"}},[a("el-form-item",{staticClass:"spacing",attrs:{prop:"spacing",label:"间距",rules:[{required:!0,message:"间距不能为空",trigger:"blur"},{type:"number",message:"请输入数字",trigger:"blur"}]}},[a("el-input-number",{attrs:{min:10,max:e.totalWidth,placeholder:"间距"},on:{change:e.setAllBlockWidth},model:{value:e.dynamicValidateForm.spacing,callback:function(t){e.$set(e.dynamicValidateForm,"spacing",t)},expression:"dynamicValidateForm.spacing"}})],1),a("el-form-item",{attrs:{label:"附加条件"}},[a("el-checkbox",{model:{value:e.dynamicValidateForm.hasPrice,callback:function(t){e.$set(e.dynamicValidateForm,"hasPrice",t)},expression:"dynamicValidateForm.hasPrice"}},[e._v("价格")]),a("el-checkbox",{on:{change:e.changeLayout},model:{value:e.dynamicValidateForm.lengthwiseIs,callback:function(t){e.$set(e.dynamicValidateForm,"lengthwiseIs",t)},expression:"dynamicValidateForm.lengthwiseIs"}},[e._v("纵向扩展布局")])],1),e._l(e.dynamicValidateForm.rows,function(t,i){return a("el-form-item",{key:t.key,staticClass:"blockList",attrs:{label:"第"+(i+1)+"行有几块"}},[a("el-form-item",{staticClass:"el-form-item__select",attrs:{prop:"rows."+i+".blockNum",rules:[{required:!0,message:"请选择行数",trigger:"blur"}]}},[a("el-col",{attrs:{span:9}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(a){return e.setBlockWidth(t)}},model:{value:t.blockNum,callback:function(a){e.$set(t,"blockNum",a)},expression:"row.blockNum"}},e._l(e.blockCount,function(t,i){return a("el-option",{key:i,attrs:{label:i+1+"块",value:i+1}},[e._v(e._s(i+1)+"块")])}),1)],1)],1),a("el-form-item",{staticClass:"el-form-item__select el-form-item__height",attrs:{prop:"rows."+i+".height",rules:[{required:!0,message:"请输入高度",trigger:"blur"}]}},[a("span",{staticClass:"title"},[e._v("高度:")]),a("el-col",{attrs:{span:9}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.height,callback:function(a){e.$set(t,"height",a)},expression:"row.height"}},e._l(e.heightInit,function(t,i){return a("el-option",{key:i,attrs:{label:t,value:t}},[e._v(e._s(t))])}),1)],1)],1),a("el-form-item",[a("span",{staticClass:"title",staticStyle:{"margin-left":"10px"}},[e._v("标题:")]),a("el-col",{attrs:{span:1}},[a("el-checkbox",{model:{value:t.hasTitle,callback:function(a){e.$set(t,"hasTitle",a)},expression:"row.hasTitle"}})],1)],1),t.blockWidth.length>0?a("el-form-item",{staticClass:"el-form-item__block-width"},[a("span",[e._v("宽度:")]),e._l(t.blockWidth,function(i,n){return a("div",{key:n},[a("el-input",{on:{change:function(a){return e.surplusWidth(t)}},model:{value:t.blockWidth[n],callback:function(a){e.$set(t.blockWidth,n,a)},expression:"row.blockWidth[i]"}})],1)}),a("span",[e._v("剩余的宽度="+e._s(t.surplusWidth)+"px")])],2):e._e(),a("el-form-item",{staticClass:"el-form-item__delete"},[a("el-col",{attrs:{span:2}},[i>0?a("el-button",{on:{click:function(a){return a.preventDefault(),e.removeDomain(t)}}},[e._v("删除")]):e._e()],1)],1)],1)}),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.reviewLayout("dynamicValidateForm")}}},[e._v("预览布局")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm()}}},[e._v("生成布局")]),a("el-button",{attrs:{type:"primary"},on:{click:e.export_raw}},[e._v("导出布局文件")]),e.dynamicValidateForm.lengthwiseIs?e._e():a("el-button",{attrs:{type:"primary"},on:{click:e.addDomain}},[e._v("添加行数")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.resetForm("dynamicValidateForm")}}},[e._v("重置")])],1)],2),a("section",[a("LayoutBloack",{staticClass:"layoutBloack",attrs:{content:e.data.contents},on:{"change-width":e.changeWidth}})],1)],1)},eg=[],tg={components:{LayoutBloack:Yf},data:function(){return{dynamicValidateForm:{rows:[{value:"",key:Date.now(),blockNum:null,height:null,hasTitle:!1,blockWidth:[],surplusWidth:0}],spacing:0,hasPrice:!1,lengthwiseIs:!1},blockCount:6,totalWidth:1622,titleHeight:58,priceHeight:52,titleSize:32,x:0,y:0,heightInit:[130,150,200,247,300,346,360,365,398,423,448],data:{contents:[],parents:"",type:"Panel"},fileName:""}},methods:{submitForm:function(e){var t=this;this.$refs.dynamicValidateForm.validate(function(a){if(!a)return console.log("error submit!!"),!1;t.genLayout(e)})},genLayout:function(e){for(var t="",a=new Array("A","B","C","D"),i=this.dynamicValidateForm.rows,n=0;n<i.length;n++)t+=a[n]+i[n].blockNum+"-"+i[n].height,i[n].hasTitle&&(t+="-title"),this.dynamicValidateForm.hasPrice&&(t+="-price"),n<i.length-1&&(t+="_");t+=".txt",this.fileName=t,0===this.data.contents.length&&this.getLayoutData(),void 0===e&&this.$emit("generator-layout",{fileName:t,content:JSON.stringify(this.data)})},resetForm:function(e){this.$refs[e].resetFields()},surplusWidth:function(e){var t=this;e.surplusWidth=0,e.surplusWidth=this.totalWidth-e.blockWidth.reduce(function(e,a,i){return i>0?e+parseInt(a)+t.dynamicValidateForm.spacing:e+parseInt(a)},0)},setBlockWidth:function(e){e.blockWidth=[],e.surplusWidth=0;for(var t=this.getBlockWidth(e.blockNum),a=0;a<e.blockNum;a++)e.blockWidth.push(t)},setAllBlockWidth:function(){var e=this;this.dynamicValidateForm.rows.forEach(function(t){e.setBlockWidth(t)})},changeLayout:function(){if(this.dynamicValidateForm.rows.length>1){var e=[];e.push(this.dynamicValidateForm.rows.shift()),this.dynamicValidateForm.rows=e}},getLayoutData:function(){var e=this;this.data.contents=[],this.dynamicValidateForm.rows.reduce(function(t,a,i){for(var n=0,o=0;o<a.blockNum;o++){var r=parseInt(a.blockWidth[o]),l={};l["height"]=a.height,l["title_align"]=0,e.dynamicValidateForm.hasPrice?(l["parents"]="Block",l["type"]="Mall",l["mall_resize"]={x:n,y:parseInt(t.height),width:r,height:a.height+e.priceHeight}):(l["parents"]="",l["type"]="Block"),a.hasTitle&&(l["resize"]={x:n,y:parseInt(t.height),width:r,height:a.height+e.titleHeight},l["title_info"]={width:r,height:e.titleHeight,size:e.titleSize}),l["width"]=r,l["x"]=n,l["y"]=parseInt(t.height),l["whichRow"]=i,l["whichBlock"]=o,e.data.contents.push(l),n=n+r+e.dynamicValidateForm.spacing}var s=a.hasTitle?a.height+e.titleHeight:a.height;return t.height=parseInt(t.height)+s+e.dynamicValidateForm.spacing,t},{height:0}),this.lengthwiseIs?this.data.type="Lengthwise":this.data.type="Panel"},changeWidth:function(e,t,a,i){this.dynamicValidateForm.rows[t]},reviewLayout:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.getLayoutData()})},getBlockWidth:function(e){return Math.floor((this.totalWidth-this.dynamicValidateForm.spacing*(e-1))/e)},removeDomain:function(e){var t=this.dynamicValidateForm.rows.indexOf(e);-1!==t&&this.dynamicValidateForm.rows.splice(t,1)},addDomain:function(){4!==this.dynamicValidateForm.rows.length?this.dynamicValidateForm.rows.push({value:"",key:Date.now(),blockNum:null,height:null,hasTitle:!1,blockWidth:[],surplusWidth:0}):this.$message("最多添加4行")},fake_click:function(e){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(t)},export_raw:function(){if(""!==this.fileName){var e=window.URL||window.webkitURL||window,t=new Blob([JSON.stringify(this.data)]),a=document.createElementNS("http://www.w3.org/1999/xhtml","a");a.href=e.createObjectURL(t),a.download=this.fileName,this.fake_click(a)}else this.submitForm("download")}}},ag=tg,ig=(a("fe46"),Object(Bn["a"])(ag,Zf,eg,!1,null,"5aa0558c",null)),ng=ig.exports,og={mixins:[zu],components:{PageWrapper:Mu,PageContentWrapper:qu,CommonContent:Us,Upload:Dn["Upload"],LayoutBloack:Yf,LayoutInfoGenerator:ng},data:function(){return{activePage:"layout",mode:"create",resourceName:"布局",layoutType:[{name:"主页6.0",id:1},{name:"影视V2",id:2}],layoutTypeText:{1:"主页6.0",2:"影视V2"},form:{layoutId:void 0,layoutName:null,layoutType:null,layoutJson:{},layoutModel:null,layoutStatus:2},formRules:{layoutName:[{required:!0,message:"请输入布局名称",trigger:"blur"}],layoutType:[{required:!0,message:"请输入布局类别",trigger:"blur"}]},content:[]}},props:["initMode","id"],computed:{resourceInfo:function(){var e=this.form;if(e.layoutId)return{id:e.layoutId,type:"layout",menuElId:"layoutInfo",version:e.currentVersion,status:e.layoutStatus}}},methods:{fetchData:function(e){this.$service.getLayoutInforById({id:this.id}).then(this.setLayoutInfo)},setLayoutInfo:function(e){this.form=Object.assign({},e),this.getLayoutJson({fileName:this.form.layoutName,content:this.form.layoutJson})},handleSave:function(){var e=this;this.$refs.form.validate(function(t){if(t){if(0===e.content.length)return void e.$message({type:"error",message:"请上传布局文件或者生成布局"});e.$service.getLayoutInforSave({jsonStr:JSON.stringify(e.form)},"保存成功").then(function(t){e.$emit("upsert-end")})}})},handleUpload:function(e,t){var a=this;this.$service.uploadLayoutFile({file:e,onUploadProgress:function(e){e.lengthComputable&&(t.percentage=e.loaded/e.total)}}).then(function(e){var i=JSON.parse(e.data.content);"undefined"===typeof i.type||"Panel"!==i.type&&"Lengthwise"!==i.type&&"Expander"!==i.type?(t.status="error",t.message="选择的文件不对，应该选择布局格式的文件"):(a.getLayoutJson(e.data),t.status="success",t.fileName=e.data.fileName)})},generatorLayout:function(e){this.activePage="layout",this.getLayoutJson(e)},getLayoutJson:function(e){var t=JSON.parse(e.content);this.form.layoutModel=t.type,this.form.layoutName=e.fileName.replace(".txt","");var a={};this.content=t.contents,"Expander"===t.type?(a={type:t.type,extra:t.extra,contents:t.contents},0==t.extra.orientation&&(this.form.layoutRemark="支持横向扩展"),1==t.extra.orientation&&(this.form.layoutRemark="支持纵向扩展"),this.form.space=t.extra.space,this.form.layoutFlag=t.extra.orientation,this.form.width=t.extra.width,this.form.height=t.extra.height):a={type:t.type,contents:t.contents},this.form.layoutJson=JSON.stringify(a)},productLayout:function(){this.activePage="layout-generate"}},created:function(){this.mode=this.initMode||"create",this.id&&this.fetchData(this.version)}},rg=og,lg=Object(Bn["a"])(rg,qf,Hf,!1,null,null,null),sg=lg.exports,cg={components:{LayoutInfoList:Wf,LayoutInfo:sg},data:function(){return{mode:"list",isShowList:!0,id:void 0,version:void 0,editData:{},reviewData:{}}},methods:{handleCreate:function(){this.mode="create",this.id=void 0,this.isShowList=!1},handleEdit:function(e){this.id=e.layoutId,this.mode="edit",this.isShowList=!1},handleRead:function(e){this.id=e.layoutId,this.mode="read",this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.getLayoutInforBatchDel({id:e.map(function(e){return e.layoutId}).join(",")},"删除成功").then(function(e){t.$refs.list.fetchData()})},handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},ug=cg,dg=Object(Bn["a"])(ug,Af,Vf,!1,null,null,null),pg=dg.exports,hg=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div")},mg=[],fg={},gg=fg,bg=Object(Bn["a"])(gg,hg,mg,!1,null,"7f083fc4",null),vg=bg.exports,yg=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("CommonPannelUserList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,read:e.handleRead,edit:e.handleEdit,copy:e.handleCopy}}),e.isShowList?e._e():a("PanelInfo",{attrs:{id:e.id,"panel-data-type":1,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},wg=[],Ig=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},Cg=[],Tg={components:{ContentWrapper:Dn["ContentWrapper"],Table:Dn["Table"]},props:{dataList:{type:Object}},data:function(){var e=this;return{pannelStatusOption:[{label:"下架",value:"0"},{label:"上架",value:"1"},{label:"草稿",value:"2"},{label:"待审核",value:"3"},{label:"审核通过",value:"4"},{label:"审核不通过",value:"5"}],pannelStatus:{},filter:{sort:void 0,order:void 0,idPrefix:10},filterSchema:null,pagination:{currentPage:1},businessType:{},table:{props:{},data:[],header:[{label:"ID",prop:"pannelGroupId"},{label:"名称",prop:"pannelGroupRemark",render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(i)}}},i.pannelGroupRemark)}},{label:"布局",prop:"fullLayoutName"},{label:"业务分类",prop:"categoryName"},{label:"引用状态",prop:"fullTabName","show-overflow-tooltip":!0},{label:"版本/状态",prop:"pannelStatus",formatter:function(t){var a=t.pannelStatus,i=t.currentVersion;return i+"/"+e.pannelStatusOption.map(function(e){if(a.toString()===e.value)return e.label}).join("")}},{label:"待审核副本",prop:"duplicateVersion",render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(i,i.duplicateVersion)}}},i.duplicateVersion)}},{label:"更新时间",prop:"lastUpdateDate","show-overflow-tooltip":!0},{label:"审核人",prop:"auditor"},{label:"更新人",prop:"userName"},{label:"操作",width:"100",fixed:"right",render:Dn["utils"].component.createOperationRender(this,{handleCopy:"复制",cancalCollect:"取消收藏"})}],selected:[],selectionType:"multiple"},selected:[]}},watch:{selected:{handler:function(e,t){var a=this.table,i=[];a.data.map(function(t){if(e.indexOf(t.pannelGroupId)>-1){var a={pannelGroupId:t.pannelGroupId,pannelGroupRemark:t.pannelGroupRemark,duplicateVersion:t.duplicateVersion};i.push(a)}}),this.$emit("input",i)}}},methods:{handleCopy:function(e){var t=e.row;this.$emit("copy",t.pannelGroupId)},cancalCollect:function(e){var t=this,a=e.row;this.$service.collectCancel({type:"pannel",data:{resourceId:a.pannelGroupId}},"取消成功").then(function(){t.fetchData()})},handleRead:function(e,t){this.$emit("read",e.pannelGroupId,t)},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.commonPannelUserList({data:t,type:"pannel"}).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.pannelId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){console.log(this.dataList),this.dataList?(this.filter=Object.assign({},this.dataList.filter),console.log(this.filter)):this.filter={sort:void 0,order:void 0,idPrefix:10},this.pagination.currentPage=1,this.fetchData()},getBusinessType:function(){var e=this;return this.$service.getDictType({type:"businessType"}).then(function(t){t.forEach(function(t){e.businessType[t.dictCnName]=t.dictId})})},handleRowSelectionAdd:function(e){this.selected.push(e.pannelGroupId),this.updateTableSelected()},handleRowSelectionRemove:function(e){this.selected=this.selected.filter(function(t){return t!==e.pannelGroupId}),this.updateTableSelected()},handleAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleRowSelectionAdd):(this.selected=[],this.table.selected=[])},handleAllRowSelectionRemove:function(){this.selected=[],this.table.selected=[]},updateTableSelected:function(){var e=this.table,t=this.selected;e.selected=e.data.reduce(function(e,a,i){return t.indexOf(a.pannelGroupId)>-1&&e.push(i),e},[])},addTabInfo:function(){},editData:function(){},batchDel:function(){}},created:function(){var e=this;this.pannelStatus=this.pannelStatusOption.reduce(function(e,t){return e[t.label]=t.value,e},{});var t=co.a.map({"pannelInfo.pannelCategory":co.a.o.enum(this.businessType).other("form",{placeholder:"业务分类",component:"Select"}),"pannelInfo.pannelId":co.a.o.string.other("form",{placeholder:"ID",component:"Input"}),"pannelInfo.pannelName":co.a.o.string.other("form",{placeholder:"版块名称",component:"Input"}),"pannelInfo.pannelTitle":co.a.o.string.other("form",{placeholder:"版块标题",component:"Input"}),"pannelInfo.tabName":co.a.o.string.other("form",{placeholder:"引用状态",component:"Input"}),"pannelInfo.pannelResource":co.a.o.enum({"腾讯":"o_tencent","爱奇艺":"o_iqiyi","优酷":"o_youku"}).other("form",{placeholder:"内容源",component:"Select"}),"pannelInfo.pannelStatus":co.a.o.enum(this.pannelStatus).other("form",{placeholder:"状态",component:"Select"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.getBusinessType().then(function(){e.dataList?e.filterSchema=a.filterSchema:e.filterSchema=t});var a=this.dataList;a&&(this.filter=Object.assign({},a.filter),this.table=a.table),this.fetchData()}},Sg=Tg,kg=(a("8857"),Object(Bn["a"])(Sg,Ig,Cg,!1,null,"7ae784e0",null)),_g=kg.exports,Pg={components:{PanelInfo:Jp,CommonPannelUserList:_g},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0}},methods:{handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e,this.mode="edit",this.isShowList=!1},handleRead:function(e,t){this.id=e,this.mode="read",this.version=t,this.isShowList=!1},handleCopy:function(e){this.id=e,this.mode="copy",this.isShowList=!1},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},xg=Pg,Dg=Object(Bn["a"])(xg,yg,wg,!1,null,null,null),Fg=Dg.exports,$g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div")},Lg=[],Rg={},Ng=Rg,Eg=Object(Bn["a"])(Ng,$g,Lg,!1,null,"51b525ea",null),Og=(Eg.exports,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.editData}},[e._v("编辑")])],1)}),Ag=[],Vg={methods:{editData:function(){this.$isAllowEdit(this.selected)&&this.$emit("open-add-page",this.selected[0])}}},Mg=Vg,Bg=Object(Bn["a"])(Mg,Og,Ag,!1,null,"3b68991a",null),Ug=(Bg.exports,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div")}),jg=[],Gg={},Wg=Gg,qg=Object(Bn["a"])(Wg,Ug,jg,!1,null,"ea68c45a",null),Hg=(qg.exports,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div")}),zg=[],Jg={},Kg=Jg,Qg=Object(Bn["a"])(Kg,Hg,zg,!1,null,"b3fe1604",null),Xg=(Qg.exports,{}),Yg=Object(Bn["a"])(Xg,rp,lp,!1,null,null,null),Zg=Yg.exports,eb=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PageWrapper",[a("PageContentWrapper",{directives:[{name:"show",rawName:"v-show",value:"homepage"==e.activePage,expression:"activePage == 'homepage'"}]},[a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("CommonContent",{attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{replicate:function(t){e.mode="replicate"},edit:function(t){e.mode="edit"},unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,audit:function(t){return e.$emit("upsert-end")},copy:function(t){return e.handleCopy(t)},"submit-audit":e.handleSubmitAudit,"save-draft":e.handleSaveDraft,"select-version":e.fetchData,delete:function(t){return e.$emit("upsert-end",t)}}},["read"!==e.mode?a("div",{staticClass:"hompage-upsert"},[a("el-form",{ref:"homepageForm",staticClass:"el-form-add",attrs:{model:e.homepage,rules:e.rules,"label-width":"140px"}},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form-item",{attrs:{label:"首页名称",prop:"homepageName"}},[a("el-input",{attrs:{placeholder:"首页名称"},model:{value:e.homepage.homepageName,callback:function(t){e.$set(e.homepage,"homepageName",t)},expression:"homepage.homepageName"}})],1),a("el-form-item",{attrs:{label:"首页模式",prop:"homepageModel"}},[a("el-radio-group",{model:{value:e.homepage.homepageModel,callback:function(t){e.$set(e.homepage,"homepageModel",t)},expression:"homepage.homepageModel"}},[a("el-radio",{attrs:{label:"normal"}},[e._v("标准模式")]),a("el-radio",{attrs:{label:"child"}},[e._v("儿童模式")]),a("el-radio",{attrs:{label:"old"}},[e._v("老人模式")])],1)],1),a("el-form-item",{attrs:{label:"首页版本号",prop:"homepageVersion"}},[a("el-input",{attrs:{placeholder:"首页版本号"},model:{value:e.homepage.homepageVersion,callback:function(t){e.$set(e.homepage,"homepageVersion",t)},expression:"homepage.homepageVersion"}})],1),a("div",{staticClass:"form-legend-header"},[a("span",[e._v("数据列表配置")])]),a("el-form-item",{attrs:{label:"首页版面"}},[a("TabSelector",{on:{"select-end":e.handleSelectTabEnd}}),a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleCreateTab}},[e._v("新建版面")]),a("span",{staticClass:"cc-form-annotation marginL remarks"},[e._v("至少选择1个版面")]),a("OrderableTable",{staticClass:"orderableTable",attrs:{header:e.tabGroupTableHeader,"hide-action":!0},model:{value:e.tabGroupList,callback:function(t){e.tabGroupList=t},expression:"tabGroupList"}}),a("div")],1)],1)],1):e._e(),"read"===e.mode?a("div",{staticClass:"homepage-read"},[a("el-form",{staticClass:"el-form-add",attrs:{"label-width":"140px"}},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form-item",{attrs:{label:"首页名称",prop:"homepageName"}},[e._v(e._s(e.homepage.homepageName))]),a("el-form-item",{attrs:{label:"首页模式",prop:"homepageModel"}},[e._v(e._s(e.HOME_MODE_MAP[e.homepage.homepageModel]))]),a("el-form-item",{attrs:{label:"首页版本号",prop:"homepageVersion"}},[e._v(e._s(e.homepage.homepageVersion))]),a("div",{staticClass:"form-legend-header"},[a("span",[e._v("数据列表配置")])]),a("el-form-item",{attrs:{label:"首页版面"}},[a("OrderableTable",{staticClass:"orderableTable",attrs:{header:e.tabGroupTableHeader,readonly:!0,"hide-action":!0},model:{value:e.tabGroupList,callback:function(t){e.tabGroupList=t},expression:"tabGroupList"}})],1)],1)],1):e._e()])],1)],1),"tab_group_setter"===e.activePage?a("PageContentWrapper",[a("HomePageTabGroupSetter",{attrs:{"title-prefix":e.title,tabs:e.homepage.tabInfos[e.activeTabGroupIndex],readonly:"read"===e.mode},on:{"set-end":e.handleSetTabGroupEnd,"go-back":function(t){e.activePage="homepage"}}})],1):e._e(),"tab"===e.activePage?a("PageContentWrapper",[a("TabInfo",{attrs:{"title-prefix":e.title,id:e.embedTab.id,version:e.embedTab.version,"init-mode":e.embedTab.mode},on:{"upsert-end":e.handleTabEmbedBack,"go-back":e.handleTabEmbedBack}})],1):e._e()],1)},tb=[],ab=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-input",{attrs:{disabled:e.disabled},on:{change:e.handleOrderChange},model:{value:e.order,callback:function(t){e.order=t},expression:"order"}})},ib=[],nb={data:function(){return{order:void 0}},watch:{value:"handleInputValue"},props:["value","disabled"],methods:{handleInputValue:function(e){this.order=e},handleOrderChange:function(e){/^\d+$/.test(e)&&e>0?this.$emit("input",e):(this.$message({type:"error",message:"请输入正整数"}),this.order=this.value)}},created:function(){this.order=this.value}},ob=nb,rb=Object(Bn["a"])(ob,ab,ib,!1,null,null,null),lb=rb.exports,sb=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PageWrapper",[a("PageContentWrapper",{directives:[{name:"show",rawName:"v-show",value:"tab_group_setter"===e.activePage,expression:"activePage === 'tab_group_setter'"}]},[a("ContentCard",{staticClass:"cc-homepage-tab-group-setter",attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.readonly,expression:"!readonly"}],staticClass:"actions"},[a("TabSelector",{ref:"tabSelector",attrs:{title:"添加定向版面"},on:{"select-start":e.handleSelectTabStart,"select-end":e.handleSelectTabEnd}}),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("\n            保存\n          ")])],1),a("OrderableTable",{ref:"tabTable",attrs:{header:e.tabTableHeader,"hide-action":!0,readonly:e.readonly},model:{value:e.tabList,callback:function(t){e.tabList=t},expression:"tabList"}}),e.showCrowdSelector?a("CrowdSelector",{on:{"select-cancel":e.handleSelectCrowdCancel,"select-end":e.handleSelectCrowdEnd}}):e._e()],1)],1),"tab"===e.activePage?a("PageContentWrapper",[a("TabInfo",{attrs:{"title-prefix":e.title,id:e.embedTab.id,version:e.embedTab.version,"init-mode":e.embedTab.mode},on:{"upsert-end":e.handleTabEmbedBack,"go-back":e.handleTabEmbedBack}})],1):e._e()],1)},cb=[],ub=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Table",{staticStyle:{"margin-top":"10px"},attrs:{data:e.value,header:e.tableHeader,props:{border:!0},selectionType:"none"}})},db=[],pb={data:function(){return{table:{props:{border:!0}}}},components:{Table:Dn["Table"],InputOrder:lb},computed:{tableHeader:function(){var e=this,t=(this.header||[]).slice(),a={label:"排序",width:100,render:function(t,a){var i=a.$index;return e.readonly?i+1:t(lb,{key:i+Math.random().toString(),props:{value:i+1},on:{input:function(t){e.handleChangeOrder(i,t)}}})}},i={label:"操作",width:80,render:function(t,a){var i=a.$index;a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handleRemoveRow(i)}}},"删除")}};return t.unshift(a),this.hideAction||t.push(i),t}},props:["value","header","hideAction","readonly"],methods:{handleChangeOrder:function(e,t){var a=this.value;t>a.length&&(t=a.length);var i=t-1,n=e,o=a[n];a.splice(n,1),this.$emit("input",[].concat(a.slice(0,i),o,a.slice(i)))},handleRemoveRow:function(e){var t=this.value.slice();t.splice(e,1),this.$emit("input",t)},handleAppendData:function(e,t){var a=this.value,i=e,n=e.reduce(function(e,a,i){return e[a[t]]=i,e},{}),o=[];a.forEach(function(e){var a=n[e[t]];void 0!==a&&(o.push(e),i[a]=void 0)}),this.$emit("input",o.concat(i.filter(function(e){return e})))}}},hb=pb,mb=Object(Bn["a"])(hb,ub,db,!1,null,null,null),fb=mb.exports,gb=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PageWrapper",{staticClass:"tab-info-wrapper"},[a("PageContentWrapper",{directives:[{name:"show",rawName:"v-show",value:"tab_info"===e.activePage,expression:"activePage === 'tab_info'"}]},[a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("CommonContent",{ref:"commonContent",attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{replicate:function(t){e.mode="replicate"},copy:e.handleCopy,edit:function(t){e.mode="edit"},unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,audit:function(t){return e.$emit("upsert-end")},"submit-audit":e.handleSubmitAudit,"save-draft":e.handleSaveDraft,"select-version":e.fetchData,"cancel-timing":function(t){return e.fetchData(e.tabInfo.currentVersion)},delete:function(t){return e.$emit("upsert-end",t)}}},["read"!==e.mode?[a("el-form",{ref:"tabForm",attrs:{rules:e.rules,model:e.tabInfo,"label-width":"170px"}},[a("div",{staticClass:"form-legend-header",on:{click:function(t){e.isCollapseBase=!e.isCollapseBase}}},[e.isCollapseBase?a("i",{staticClass:"el-icon-arrow-down"}):a("i",{staticClass:"el-icon-arrow-up"}),a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("div",{style:{display:e.isCollapseBase?"none":"block"}},[a("el-form-item",{attrs:{label:"版面名称",prop:"tabName"}},[a("el-input",{model:{value:e.tabInfo.tabName,callback:function(t){e.$set(e.tabInfo,"tabName","string"===typeof t?t.trim():t)},expression:"tabInfo.tabName"}})],1),a("el-form-item",{attrs:{label:"TAB标题(中文)",prop:"tabCnTitle"}},[a("el-input",{model:{value:e.tabInfo.tabCnTitle,callback:function(t){e.$set(e.tabInfo,"tabCnTitle","string"===typeof t?t.trim():t)},expression:"tabInfo.tabCnTitle"}})],1),a("el-form-item",{attrs:{label:"TAB标题(英文)",prop:"tabEnTitle"}},[a("el-input",{model:{value:e.tabInfo.tabEnTitle,callback:function(t){e.$set(e.tabInfo,"tabEnTitle","string"===typeof t?t.trim():t)},expression:"tabInfo.tabEnTitle"}})],1),a("el-form-item",{staticClass:"selectItem",attrs:{label:"业务分类",prop:"tabCategory"}},[a("cc-business-type-selector",{attrs:{value:e.tabInfo.tabCategory},on:{input:e.handleChangeTabCategory}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.showSystemDefault,expression:"showSystemDefault"}],attrs:{label:"系统默认",prop:"systemDefault"}},[a("el-switch",{attrs:{"on-text":"是","off-text":"否",value:!!e.tabInfo.systemDefault},on:{input:function(t){e.tabInfo.systemDefault=t?1:0}}})],1),a("el-form-item",{staticClass:"selectItem",attrs:{label:"AppId",prop:"tabAppid"}},[a("cc-appid-selector",{attrs:{disabled:e.disableAppId},model:{value:e.tabInfo.tabAppid,callback:function(t){e.$set(e.tabInfo,"tabAppid",t)},expression:"tabInfo.tabAppid"}})],1),e.hasSource?a("el-form-item",{attrs:{label:"内容源",prop:"tabResource"}},[a("SourceRadioSelector",{attrs:{value:e.tabInfo.tabResource,disabled:e.isReplicate},on:{input:e.handleChangeSource}})],1):e._e(),a("el-form-item",{attrs:{label:"TAB对应的icon",prop:"pictureName"}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleSelectIconStart}},[e._v("选择")]),e.tabInfo.iconTypeName?a("span",{staticClass:"marginL"},[e._v("已选择： "+e._s(e.tabInfo.iconTypeName))]):e._e()],1),a("el-form-item",{attrs:{label:"标题图片"}},[a("cc-global-picture-selector",{attrs:{title:"选择素材","picture-resolution":"178*80"},on:{"select-end":function(t){return e.handleSelectTitleIcon("imgOnSelected",t)}}},[a("el-form-item",{staticClass:"tab-title-icon-wrapper",attrs:{prop:"imgOnSelected"}},[e.tabInfo.imgOnSelected?[a("img",{attrs:{src:e.tabInfo.imgOnSelected}}),a("i",{staticClass:"el-icon el-icon-close tab-title-icon__remove",on:{click:function(t){t.stopPropagation(),e.tabInfo.imgOnSelected=""}}})]:e._e(),a("div",{staticClass:"tab-title-icon__title"},[e._v("选中")])],2)],1),a("cc-global-picture-selector",{attrs:{title:"选择素材","picture-resolution":"178*80"},on:{"select-end":function(t){return e.handleSelectTitleIcon("imgOnFocus",t)}}},[a("el-form-item",{staticClass:"tab-title-icon-wrapper",attrs:{prop:"imgOnFocus"}},[e.tabInfo.imgOnFocus?[a("img",{attrs:{src:e.tabInfo.imgOnFocus}}),a("i",{staticClass:"el-icon el-icon-close tab-title-icon__remove",on:{click:function(t){t.stopPropagation(),e.tabInfo.imgOnFocus=""}}})]:e._e(),a("div",{staticClass:"tab-title-icon__title"},[e._v("落焦")])],2)],1),a("cc-global-picture-selector",{attrs:{title:"选择素材","picture-resolution":"178*80"},on:{"select-end":function(t){return e.handleSelectTitleIcon("imgOnBlur",t)}}},[a("el-form-item",{staticClass:"tab-title-icon-wrapper",attrs:{prop:"imgOnBlur"}},[e.tabInfo.imgOnBlur?[a("img",{attrs:{src:e.tabInfo.imgOnBlur}}),a("i",{staticClass:"el-icon el-icon-close tab-title-icon__remove",nativeOn:{click:function(t){e.tabInfo.imgOnBlur=""}}})]:e._e(),a("div",{staticClass:"tab-title-icon__title"},[e._v("非落焦")])],2)],1)],1),a("el-form-item",{attrs:{label:"自动化推荐",prop:"autoPromotion"}},[a("el-radio-group",{model:{value:e.tabInfo.autoPromotion,callback:function(t){e.$set(e.tabInfo,"autoPromotion",t)},expression:"tabInfo.autoPromotion"}},e._l(e.PROMOTIONS,function(t,i){return a("el-radio",{key:i,attrs:{label:t.value}},[e._v(e._s(t.label))])}),1)],1),a("el-form-item",{attrs:{label:"固定刷新时间",prop:"timeCycle"}},[a("InputMinute",{attrs:{min:5,max:360},model:{value:e.tabInfo.timeCycle,callback:function(t){e.$set(e.tabInfo,"timeCycle",t)},expression:"tabInfo.timeCycle"}}),a("span",{staticClass:"hint remarks"},[e._v("设置范围:5分钟-6小时")])],1)],1),a("div",{staticClass:"form-legend-header",on:{click:function(t){e.isCollapseExtend=!e.isCollapseExtend}}},[e.isCollapseExtend?a("i",{staticClass:"el-icon-arrow-down"}):a("i",{staticClass:"el-icon-arrow-up"}),a("span",[e._v("扩展参数")])]),a("div",{style:{display:e.isCollapseExtend?"none":"block"}},[a("el-form-item",{attrs:{label:"版面属性",prop:"tabType"}},[a("el-radio-group",{attrs:{disabled:e.isReplicate},model:{value:e.tabInfo.tabType,callback:function(t){e.$set(e.tabInfo,"tabType",t)},expression:"tabInfo.tabType"}},e._l(e.TAB_TYPES,function(t,i){return a("el-radio",{key:i,attrs:{label:t.value}},[e._v(e._s(t.label))])}),1)],1),1===e.tabInfo.tabType?[a("el-form-item",{attrs:{label:"是否二级版面",prop:"hasSubTab"}},[a("el-switch",{attrs:{disabled:e.isReplicate,value:!!e.tabInfo.hasSubTab,"on-text":"是","off-text":"否"},on:{input:function(t){e.tabInfo.hasSubTab=t?1:0}}})],1),1===e.tabInfo.hasSubTab?a("el-form-item",{attrs:{label:"是否支持记忆",prop:"flagIsRecord"}},[a("el-switch",{attrs:{value:!!e.tabInfo.flagIsRecord,"on-text":"是","off-text":"否"},on:{input:function(t){e.tabInfo.flagIsRecord=t?1:0}}})],1):e._e(),a("el-form-item",{attrs:{label:"活动浮窗",prop:"floatWindow"}},[a("cc-float-window-selector",{attrs:{params:e.floatWindowParams},on:{"select-end":e.handleSelectFloatWindowEnd}}),e.tabInfo.activityFloatWindow?[e._v("\n                    已选择: "+e._s(e.tabInfo.activityFloatWindow.pluginName)+"\n                    "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.handleRemoveFloatWindow}},[e._v("删除")])]:e._e()],2),1===e.tabInfo.hasSubTab?a("el-form-item",{attrs:{label:"选择版面"}},[a("cc-tab-selector-el",{ref:"tabSelector",attrs:{source:e.tabInfo.tabResource,"has-sub-tab":0},on:{"select-start":e.handleSelectTabStart,"select-end":e.handleSelectTabEnd}}),a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleCreateTab}},[e._v("新建版面")]),a("div",[a("OrderableTable",{ref:"subTabTable",attrs:{header:e.subTabTableHeader},model:{value:e.tabInfo.tabList,callback:function(t){e.$set(e.tabInfo,"tabList",t)},expression:"tabInfo.tabList"}})],1)],1):e._e()]:e._e(),2===e.tabInfo.tabType?[a("el-form-item",{attrs:{label:"活动浮窗",prop:"floatWindow"}},[a("cc-float-window-selector",{attrs:{params:e.floatWindowParams},on:{"select-end":e.handleSelectFloatWindowEnd}}),e.tabInfo.activityFloatWindow?[e._v("\n                    已选择: "+e._s(e.tabInfo.activityFloatWindow.pluginName)+"\n                    "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.handleRemoveFloatWindow}},[e._v("删除")])]:e._e()],2)]:e._e(),0===e.tabInfo.hasSubTab?a("el-form-item",{attrs:{label:"选择版块"}},[a("div",{staticClass:"tab-info__virtual-tab-menu",style:{visibility:e.isPanelDragging?"hidden":"visible"}},[a("Affix",{staticStyle:{width:"840px",display:"inline-block",background:"#fff","z-index":"1"},attrs:{"relative-element-selector":".tab-info__virtual-tab","scroll-container-selector":".el-main",offset:{top:128,bottom:50}}},[a("cc-panel-selector-el",{ref:"panelSelector",attrs:{source:e.tabInfo.tabResource},on:{"select-end":e.handleSelectPanelEnd}}),a("el-dropdown",[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("\n                        新建\n                        "),a("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(t){e.activePage="panel"}}},[e._v("常规版块")]),a("el-dropdown-item",{nativeOn:{click:function(t){e.activePage="album_panel"}}},[e._v("业务专辑")]),a("el-dropdown-item",{nativeOn:{click:function(t){e.activePage="private_panel"}}},[e._v("专属影院")])],1)],1),a("el-button",{staticClass:"marginL",attrs:{type:"primary",plain:""},on:{click:function(t){return e.handleToggleAllPanel(!1)}}},[e._v("展开所有")]),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.handleToggleAllPanel(!0)}}},[e._v("收起所有")])],1)],1),a("cc-virtual-tab",{ref:"virtualTab",staticClass:"tab-info__virtual-tab",attrs:{panels:e.tabInfo.pannelList,"panel-data":e.panelListIndexed,width:840,ratio:.4,"show-title":!0},on:{"insert-panel":e.handleInsertPanel,"reorder-panel":e.handleReOrderPanel,"remove-panel":e.handleRemovePanel,"change-crowd":e.handleChangeCrowdOfPanel,"toggle-type":e.handleTogglePanelType,collapse:e.handleChangeCollapseState,uncollapse:e.handleChangeCollapseState,"open-panel":e.handlePreviewPanel,"change-panel-order":e.handleChangePanelOrder,"click-block":e.handleClickBlock,"drag-start":e.handleDragStart,"drag-end":e.handleDragEnd,"show-all-panel":e.handleShowAllPanels}})],1):e._e()],2),2===e.tabInfo.tabType?[a("div",{staticClass:"form-legend-header",on:{click:function(t){e.isCollapseSpec=!e.isCollapseSpec}}},[e.isCollapseSpec?a("i",{staticClass:"el-icon-arrow-down"}):a("i",{staticClass:"el-icon-arrow-up"}),a("span",[e._v("专题配置")])]),a("div",{style:{display:e.isCollapseSpec||e.isPanelDragging?"none":"block"}},[a("el-form-item",{attrs:{label:"会员展示"}},[a("el-select",{attrs:{placeholder:"前端不显示",clearable:!0},model:{value:e.tabInfo.vipButtonSourceId,callback:function(t){e.$set(e.tabInfo,"vipButtonSourceId",t)},expression:"tabInfo.vipButtonSourceId"}},e._l(e.vipEnums,function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})}),1)],1),a("el-form-item",{attrs:{label:"专题版面大背景",prop:"alumbTabBg"}},[a("cc-global-picture-selector",{attrs:{title:"选择素材","picture-resolution":"1920*1080"},on:{"select-end":e.handleSelectBgEnd}}),e.tabInfo.alumbTabBg?a("div",{staticClass:"image-preview-wrapper"},[a("img",{staticClass:"image-preview",attrs:{src:e.tabInfo.alumbTabBg}})]):e._e()],1),a("el-form-item",{attrs:{label:"专题版面长图背景图",prop:"alumbTabLongBg"}},[a("cc-global-picture-selector",{attrs:{title:"选择长图素材","query-long-poster":1},on:{"select-end":e.handleSelectLongBgEnd}}),a("span",{staticClass:"remarks marginL"},[e._v("备注：长图下最多支持6个版块")]),e.tabInfo.alumbTabLongBg?a("div",{staticClass:"image-preview-wrapper image-preview-wrapper--long"},[a("img",{staticClass:"image-preview",attrs:{src:e.tabInfo.alumbTabLongBg}}),a("i",{staticClass:"el-icon el-icon-close",attrs:{title:"移除"},on:{click:function(t){e.tabInfo.alumbTabLongBg=void 0}}})]):e._e()],1),e._e(),a("el-form-item",{attrs:{label:"版面简介显示高"}},[a("el-input-number",{attrs:{min:0,max:880,step:1},model:{value:e.tabInfo.sinkSize,callback:function(t){e.$set(e.tabInfo,"sinkSize",e._n(t))},expression:"tabInfo.sinkSize"}}),a("span",{staticClass:"remarks marginL"},[e._v(" 注:数值范围0-880")])],1),a("el-form-item",{attrs:{label:"版块标题颜色"}},[a("el-color-picker",{model:{value:e.tabInfo.pannelTitleColor,callback:function(t){e.$set(e.tabInfo,"pannelTitleColor",t)},expression:"tabInfo.pannelTitleColor"}})],1),a("el-form-item",{attrs:{label:"推荐位字体颜色(落焦)"}},[a("el-color-picker",{model:{value:e.tabInfo.blockTitleFocusColor,callback:function(t){e.$set(e.tabInfo,"blockTitleFocusColor",t)},expression:"tabInfo.blockTitleFocusColor"}})],1),a("el-form-item",{attrs:{label:"推荐位字体颜色(非落焦)"}},[a("el-color-picker",{model:{value:e.tabInfo.blockTitleUnfocusColor,callback:function(t){e.$set(e.tabInfo,"blockTitleUnfocusColor",t)},expression:"tabInfo.blockTitleUnfocusColor"}})],1)],1)]:e._e()],2),e.showIconSelector?a("cc-icon-selector",{on:{"select-cancel":e.handleSelectIconCancel,"select-end":e.handleSelectIconEnd}}):e._e(),e.showCrowdSelector?a("cc-crowd-selector",{on:{"select-cancel":e.handleSelectCrowdCancel,"select-end":e.handleSelectCrowdEnd}}):e._e()]:e._e(),"read"===e.mode?[a("el-form",{ref:"tabForm",attrs:{rules:e.rules,model:e.tabInfo,"label-width":"170px"}},[a("div",{staticClass:"form-legend-header",on:{click:function(t){e.isCollapseBase=!e.isCollapseBase}}},[e.isCollapseBase?a("i",{staticClass:"el-icon-arrow-down"}):a("i",{staticClass:"el-icon-arrow-up"}),a("span",[e._v("基本信息")])]),a("div",{style:{display:e.isCollapseBase?"none":"block"}},[a("el-form-item",{attrs:{label:"版面名称",prop:"tabName"}},[e._v(e._s(e.tabInfo.tabName))]),a("el-form-item",{attrs:{label:"TAB标题(中文)",prop:"tabCnTitle"}},[e._v(e._s(e.tabInfo.tabCnTitle))]),a("el-form-item",{attrs:{label:"TAB标题(英文)",prop:"tabEnTitle"}},[e._v(e._s(e.tabInfo.tabEnTitle))]),a("el-form-item",{attrs:{label:"业务分类",prop:"tabCategory"}},[a("cc-business-type-selector",{attrs:{"is-read":!0},model:{value:e.tabInfo.tabCategory,callback:function(t){e.$set(e.tabInfo,"tabCategory",t)},expression:"tabInfo.tabCategory"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.showSystemDefault,expression:"showSystemDefault"}],attrs:{label:"系统默认",prop:"systemDefault"}},[e._v(e._s(e.tabInfo.systemDefault?"是":"否"))]),a("el-form-item",{attrs:{label:"AppId",prop:"tabAppid"}},[a("cc-appid-selector",{attrs:{"is-read":!0},model:{value:e.tabInfo.tabAppid,callback:function(t){e.$set(e.tabInfo,"tabAppid",t)},expression:"tabInfo.tabAppid"}})],1),e.hasSource?a("el-form-item",{attrs:{label:"内容源",prop:"tabResource"}},[e._v(e._s(e.$consts.sourceText[e.tabInfo.tabResource]))]):e._e(),a("el-form-item",{attrs:{label:"TAB对应的icon",prop:"pictureName"}},[e.tabInfo.iconTypeName?a("span",[e._v(e._s(e.tabInfo.iconTypeName))]):e._e(),e.tabInfo.pictureUrl?a("div",{staticClass:"tab-icon-wrapper",on:{click:e.handleSelectIconStart}},[a("img",{attrs:{src:e.tabInfo.pictureUrl}})]):e._e()]),a("el-form-item",{attrs:{label:"标题图片"}},[a("el-form-item",{staticClass:"tab-title-icon-wrapper",attrs:{prop:"imgOnSelected"}},[e.tabInfo.imgOnSelected?a("img",{attrs:{src:e.tabInfo.imgOnSelected}}):e._e(),a("div",{staticClass:"tab-title-icon__title"},[e._v("选中")])]),a("el-form-item",{staticClass:"tab-title-icon-wrapper",attrs:{prop:"imgOnFocus"}},[e.tabInfo.imgOnFocus?a("img",{attrs:{src:e.tabInfo.imgOnFocus}}):e._e(),a("div",{staticClass:"tab-title-icon__title"},[e._v("落焦")])]),a("el-form-item",{staticClass:"tab-title-icon-wrapper",attrs:{prop:"imgOnBlur"}},[e.tabInfo.imgOnBlur?a("img",{attrs:{src:e.tabInfo.imgOnBlur}}):e._e(),a("div",{staticClass:"tab-title-icon__title"},[e._v("非落焦")])])],1),a("el-form-item",{attrs:{label:"自动化推荐",prop:"autoPromotion"}},[e._v(e._s("movie"===e.tabInfo.autoPromotion?"影视":"无"))]),a("el-form-item",{attrs:{label:"固定刷新时间",prop:"timeCycle"}},[e._v(e._s(e.parseMinToStr(e.tabInfo.timeCycle)))])],1),a("div",{staticClass:"form-legend-header",on:{click:function(t){e.isCollapseExtend=!e.isCollapseExtend}}},[e.isCollapseExtend?a("i",{staticClass:"el-icon-arrow-down"}):a("i",{staticClass:"el-icon-arrow-up"}),a("span",[e._v("配置内容")])]),a("div",{style:{display:e.isCollapseExtend?"none":"block"}},[a("el-form-item",{attrs:{label:"版面属性",prop:"tabType"}},[e._v(e._s(1===e.tabInfo.tabType?"普通版面":"专题版面"))]),1===e.tabInfo.tabType?[a("el-form-item",{attrs:{label:"是否二级版面",prop:"hasSubTab"}},[e._v(e._s(1===e.tabInfo.hasSubTab?"是":"否"))]),1===e.tabInfo.hasSubTab?a("el-form-item",{attrs:{label:"是否支持记忆",prop:"flagIsRecord"}},[e._v(e._s(1===e.tabInfo.flagIsRecord?"是":"否"))]):e._e(),a("el-form-item",{attrs:{label:"活动浮窗",prop:"floatWindow"}},[e.tabInfo.activityFloatWindow?[e._v(e._s(e.tabInfo.activityFloatWindow.pluginName))]:e._e()],2),1===e.tabInfo.hasSubTab?a("el-form-item",{attrs:{label:"选择版面"}},[a("div",[a("el-table",{staticStyle:{"margin-top":"20px","max-width":"80%"},attrs:{data:e.tabInfo.tabList,border:""}},[a("el-table-column",{attrs:{prop:"",label:"排序",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.$index+1))]}}],null,!1,811300409)}),a("el-table-column",{attrs:{prop:"tabId",label:"版面ID",width:"180"}}),a("el-table-column",{attrs:{prop:"tabName",label:"版面名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.handlePreviewTab(t.row,t.row.currentVersion,t.$index)}}},[e._v(e._s(t.row.tabName))])]}}],null,!1,4001151170)}),a("el-table-column",{attrs:{prop:"duplicateVersion",label:"待审核副本",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.duplicateVersion?a("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(a){return a.preventDefault(),e.handlePreviewTab(t.row,t.row.duplicateVersion,t.$index)}}},[e._v(e._s(t.row.duplicateVersion))]):e._e()]}}],null,!1,3763728115)})],1)],1)]):e._e()]:e._e(),2===e.tabInfo.tabType?[a("el-form-item",{attrs:{label:"活动浮窗",prop:"floatWindow"}},[e.tabInfo.activityFloatWindow?[e._v(e._s(e.tabInfo.activityFloatWindow.pluginName))]:e._e()],2)]:e._e(),0===e.tabInfo.hasSubTab?a("el-form-item",{attrs:{label:"选择版块"}},[a("div",{staticClass:"tab-info__virtual-tab-menu"},[a("affix",{staticStyle:{width:"840px",display:"inline-block",background:"#fff","z-index":"1"},attrs:{"relative-element-selector":".tab-info__virtual-tab","scroll-container-selector":".el-main",offset:{top:128,bottom:50}}},[a("el-button",{on:{click:function(t){return e.handleToggleAllPanel(!1)}}},[e._v("展开所有")]),a("el-button",{on:{click:function(t){return e.handleToggleAllPanel(!0)}}},[e._v("收起所有")])],1)],1),a("cc-virtual-tab",{staticClass:"tab-info__virtual-tab",attrs:{panels:e.tabInfo.pannelList,"panel-data":e.panelListIndexed,"read-only":!0,width:840,ratio:.4,"show-title":!0},on:{"open-panel":e.handlePreviewPanel,"click-block":e.handleClickBlock,collapse:e.handleChangeCollapseState,uncollapse:e.handleChangeCollapseState}})],1):e._e(),2===e.tabInfo.tabType?[a("div",{staticClass:"form-legend-header"},[a("span",[e._v("专题配置")])]),a("el-form-item",{attrs:{label:"会员展示"}},[e._v("\n                    "+e._s(e.getVipButtonSourceItem(e.tabInfo.vipButtonSourceId).sourceName)+"\n                ")]),a("el-form-item",{attrs:{label:"专题版面大背景",prop:"alumbTabBg"}},[e.tabInfo.alumbTabBg?a("div",{staticClass:"image-preview-wrapper"},[a("img",{staticClass:"image-preview",attrs:{src:e.tabInfo.alumbTabBg}})]):e._e()]),a("el-form-item",{attrs:{label:"专题版面长图背景",prop:"alumbTabLongBg"}},[e.tabInfo.alumbTabLongBg?a("div",{staticClass:"image-preview-wrapper"},[a("img",{staticClass:"image-preview",attrs:{src:e.tabInfo.alumbTabLongBg}})]):e._e()]),e._e(),a("el-form-item",{attrs:{label:"版面简介显示高"}},[e._v(e._s(e.tabInfo.sinkSize))]),a("el-form-item",{attrs:{label:"版块标题颜色"}},[a("input",{attrs:{disabled:"",type:"color"},domProps:{value:e.tabInfo.pannelTitleColor}})]),a("el-form-item",{attrs:{label:"推荐位字体颜色(落焦)"}},[a("input",{attrs:{disabled:"",type:"color"},domProps:{value:e.tabInfo.blockTitleFocusColor}})]),a("el-form-item",{attrs:{label:"推荐位字体颜色(非落焦)"}},[a("input",{attrs:{disabled:"",type:"color"},domProps:{value:e.tabInfo.blockTitleUnfocusColor}})])]:e._e()],2)])]:e._e()],2)],1)],1),"tab"===e.activePage?a("PageContentWrapper",[a("TabInfo",{attrs:{"title-prefix":e.title,id:e.embedTab.id,version:e.embedTab.version,"init-mode":e.embedTab.mode},on:{"upsert-end":e.handleTabEmbedBack,"go-back":function(t){e.activePage="tab_info"}}})],1):e._e(),"panel_preview"===e.activePage?a("PageContentWrapper",[[5,9,10].indexOf(e.panelPreview.dataType)>-1?a("PrivatePanelInfo",{attrs:{"title-prefix":e.title,"init-mode":e.panelPreview.initMode,id:e.panelPreview.id,version:e.panelPreview.version},on:{"upsert-end":e.handlePreviewPanelEnd,"go-back":e.handlePreviewPanelEnd}}):a("PanelInfo",{attrs:{"title-prefix":e.title,"init-mode":e.panelPreview.initMode,id:e.panelPreview.id,version:e.panelPreview.version,"panel-data-type":e.panelPreview.dataType,"init-group-index":e.panelPreview.initGroupIndex,"init-block-index":e.panelPreview.initBlockIndex},on:{"upsert-end":e.handlePreviewPanelEnd,"go-back":e.handlePreviewPanelEnd}})],1):e._e(),"panel"===e.activePage?a("PageContentWrapper",[a("PanelInfo",{attrs:{"title-prefix":e.title,"init-mode":"create","panel-data-type":1},on:{"upsert-end":function(t){e.activePage="tab_info"},"go-back":function(t){e.activePage="tab_info"}}})],1):e._e(),"album_panel"===e.activePage?a("PageContentWrapper",[a("PanelInfo",{attrs:{"title-prefix":e.title,"init-mode":"create","panel-data-type":3},on:{"upsert-end":function(t){e.activePage="tab_info"},"go-back":function(t){e.activePage="tab_info"}}})],1):e._e(),"private_panel"===e.activePage?a("PageContentWrapper",[a("PrivatePanelInfo",{attrs:{"title-prefix":e.title,"init-mode":"create"},on:{"upsert-end":function(t){e.activePage="tab_info"},"go-back":function(t){e.activePage="tab_info"}}})],1):e._e()],1)},bb=[],vb={60:"4",67:"-1",61:"10",66:"6",31:"0"};function yb(e){return vb[e]||"-1"}var wb,Ib,Cb,Tb,Sb,kb,_b,Pb,xb={props:["element"],render:function(e){return e(this.element||"div",{class:"cc-var"},this.$scopedSlots.default(this.$vnode.data.attrs))}},Db=xb,Fb=Object(Bn["a"])(Db,wb,Ib,!1,null,null,null),$b=Fb.exports,Lb=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("RemoteSelectorWrapper",{ref:"wrapper",attrs:{title:"选择版块","custom-class":"resource-selector"},on:{"select-start":e.handleSelectStart},scopedSlots:e._u([{key:"content",fn:function(t){var i=t.isShow;return[e.isLive||i?a("BaseSelector",{ref:"baseSelector",attrs:{"id-field":"pannelGroupId","is-live":e.isLive,"selection-type":e.selectionType,table:e.table,pagination:e.pagination},on:{"pagination-change":e.fetchData,"select-cancel":e.handleSelectCancel,"select-end":e.handleSelectEnd}},[a("el-form",{attrs:{slot:"filter",inline:!0},slot:"filter",model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("el-form-item",[a("el-select",{attrs:{placeholder:"类型"},model:{value:e.filter.pannelType,callback:function(t){e.$set(e.filter,"pannelType",t)},expression:"filter.pannelType"}},[a("el-option",{attrs:{value:1,label:"内容版块"}}),a("el-option",{attrs:{value:3,label:"专辑版块"}}),a("el-option",{attrs:{value:5,label:"专属影院版块"}})],1)],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"版块ID"},model:{value:e.filter.pannelId,callback:function(t){e.$set(e.filter,"pannelId",t)},expression:"filter.pannelId"}})],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"版块名称"},model:{value:e.filter.pannelName,callback:function(t){e.$set(e.filter,"pannelName",t)},expression:"filter.pannelName"}})],1),a("el-form-item",[a("el-select",{attrs:{placeholder:"业务分类"},model:{value:e.filter.pannelCategory,callback:function(t){e.$set(e.filter,"pannelCategory",t)},expression:"filter.pannelCategory"}},e._l(e.panelCategoryOptions,function(e,t){return a("el-option",{key:t,attrs:{disabled:e.disabled,value:e.value,label:e.label}})}),1)],1),a("el-form-item",[a("el-select",{attrs:{placeholder:"状态"},model:{value:e.filter.pannelStatus,callback:function(t){e.$set(e.filter,"pannelStatus",t)},expression:"filter.pannelStatus"}},e._l(e.$consts.statusOptions,function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})}),1)],1),a("el-form-item",[a("el-select",{attrs:{placeholder:"版块组类型"},model:{value:e.filter.parentType,callback:function(t){e.$set(e.filter,"parentType",t)},expression:"filter.parentType"}},e._l(e.parentTypeOptions,function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})}),1)],1),a("el-form-item",[a("el-select",{attrs:{placeholder:"数据来源"},model:{value:e.filter.idPrefix,callback:function(t){e.$set(e.filter,"idPrefix",t)},expression:"filter.idPrefix"}},[a("el-option",{attrs:{label:"酷开",value:"10"}}),a("el-option",{attrs:{label:"江苏广电",value:"11"}})],1)],1),a("el-button",{attrs:{type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{attrs:{type:"warning"},on:{click:e.handleResetFilter}},[e._v("重置")])],1)],1):e._e()]}}])},[e._t("default")],2)},Rb=[],Nb={data:function(){var e=this.$consts.statusOptions.filter(function(e){return[3,4,7].indexOf(e.value)>-1}),t=e.reduce(function(e,t){return e[t.value]=t.label,e},{});return{options:[],panelCategoryOptions:[],pannelCategoryOptionsIndexed:{},panelStatusOptions:e,panelStatusOptionsIndexed:t,parentTypeOptions:[{label:"分组版块",value:"group"},{label:"功能版块",value:"function"}],pagination:{currentPage:1,pageSize:15,total:0},filter:this.genDefaultFilter(),efficientFilter:this.genDefaultFilter(),table:{data:[],selected:[],header:[{label:"ID",prop:"pannelGroupId"},{label:"名称",prop:"pannelGroupRemark","show-overflow-tooltip":!0,width:200},{label:"业务分类",width:100,render:function(e,t){return this.pannelCategoryOptionsIndexed[t.row.pannelCategory]}.bind(this)},{label:"布局",width:200,prop:"fullLayoutName","show-overflow-tooltip":!0},{label:"引用状态",prop:"fullTabName","show-overflow-tooltip":!0},{label:"状态",render:function(e,t){return this.$consts.statusText[t.row.pannelStatus]}.bind(this)},{prop:"lastUpdateDate",label:"更新时间",width:190},{prop:"userName",label:"更新人",width:120}],selectionType:"multiple",props:{"tooltip-effect":"dark"}},selected:[],originSelected:[]}},props:["isLive","source","selectionType"],components:{RemoteSelectorWrapper:Qo,BaseSelector:nr},methods:{handleSelectStart:function(){this.$emit("select-start"),this.fetchData()},handleSelectCancel:function(){this.$refs.wrapper.handleSelectCancel()},handleSelectEnd:function(e){this.$emit("select-end",e),this.$refs.wrapper.handleSelectEnd()},genDefaultFilter:function(){return{idPrefix:this.$consts.idPrefix,pannelType:1,panelId:void 0,pannelName:void 0,pannelCategory:void 0,pannelStatus:void 0,parentType:void 0,pannelResource:void 0,resourceIsNull:!0}},handleFilterChange:function(){this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.pagination.currentPage=1,this.fetchData()},handleResetFilter:function(){this.filter=this.genDefaultFilter(),this.efficientFilter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},fetchData:function(){var e=this,t=JSON.parse(JSON.stringify(this.efficientFilter)),a=this.pagination;a&&(t.page=a.currentPage,t.rows=a.pageSize),t.pannelStatus||(t.multiStatus="3,4"),t.pannelResource=this.source,this.$service.panelPageList(t).then(function(t){e.table.data=t.rows,e.pagination.total=t.total})}},created:function(){var e=this;this.$service.getDictType({type:"businessType"}).then(function(t){e.panelCategoryOptions=t.map(function(e){return{label:e.dictCnName,value:e.dictId,disabled:e.disabled}}),e.pannelCategoryOptionsIndexed=e.panelCategoryOptions.reduce(function(e,t){return e[t.value]=t.label,e},{})})}},Eb=Nb,Ob=Object(Bn["a"])(Eb,Lb,Rb,!1,null,null,null),Ab=Ob.exports,Vb=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isRead?a("span",[e._v(e._s(e.valueLabel))]):a("el-select",{attrs:{value:e.value},on:{input:function(t){return e.$emit("input",t)}}},e._l(e.options,function(e,t){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})}),1)},Mb=[],Bb={data:function(){return{options:[]}},computed:{valueLabel:function(){var e=this.value,t=this.options;if(e&&t){var a=t.find(function(t){return t.value===e});if(a)return a.label}}},props:["value","isRead"],methods:{},created:function(){var e=this,t=this.isRead;this.$service.getDictType({type:"businessType",isFilter:t?0:1}).then(function(t){e.options=t.map(function(e){return{label:e.dictCnName,value:e.dictId}})})}},Ub=Bb,jb=Object(Bn["a"])(Ub,Vb,Mb,!1,null,null,null),Gb=jb.exports,Wb=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isRead?a("span",[e._v("\n    "+e._s(e.valueLabel)+"\n")]):a("el-select",{attrs:{value:e.value,disabled:e.disabled},on:{input:function(t){return e.$emit("input",t)}}},e._l(e.options,function(e,t){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})}),1)},qb=[],Hb={data:function(){return{options:[]}},computed:{valueLabel:function(){var e=this.value,t=this.options;if(void 0!==e&&t){var a=t.find(function(t){return t.value===e});if(a)return a.label}}},props:["value","isRead","disabled"],methods:{},created:function(){var e=this;this.$service.getDictType({type:"appIdType"}).then(function(t){e.options=t.map(function(e){return{label:e.dictCnName,value:+e.dictEnName}})})}},zb=Hb,Jb=Object(Bn["a"])(zb,Wb,qb,!1,null,null,null),Kb=Jb.exports,Qb=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("RemoteSelectorWrapper",{ref:"wrapper",attrs:{title:"选择浮窗",filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset,"select-end":e.handleSelectEnd,"select-start":e.fetchData}},[a("CardList",{attrs:{slot:"item-list",data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-change":e.handleRowSelectionChange},slot:"item-list",scopedSlots:e._u([{key:"row",fn:function(t){var i=t.row;return a("div",{staticClass:"box-list"},[a("p",{staticClass:"list-p"},[a("img",{staticClass:"list-img",attrs:{src:i.globalPicture.pictureUrl}})]),a("p",{staticClass:"list-title"},[e._v(e._s(i.pluginName))]),a("div",[e._v(e._s(i.pluginId)+" / "+e._s(i.modifierName)+" / "+e._s(i.createdDate))])])}}])}),a("div",{attrs:{slot:"actions"},slot:"actions"}),e._t("default")],2)},Xb=[],Yb={components:{Table:Dn["Table"],CardList:Dn["CardList"],RemoteSelectorWrapper:Qo},props:{params:{type:Object,default:function(){return{}}}},data:function(){return{filter:{pluginId:void 0,pluginName:void 0},filterSchema:co.a.map({pluginId:co.a.o.oneOf([co.a.value(""),co.a.number]).$msg("请输入数字").other("form",{component:"Input",label:" ",placeholder:"ID",cols:{item:3,wrapper:23}}),pluginName:co.a.o.string.other("form",{label:" ",placeholder:"功能名称",cols:{item:3,wrapper:23}})}).other("form",{layout:"inline",footer:{cols:{item:3,wrapper:23},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}}),pagination:{currentPage:1,pageSize:15},selected:[],table:{loading:!1,props:{},data:[],selected:void 0,selectionType:"single"}}},methods:{handleRowSelectionChange:function(e,t){this.table.selected=t,this.$refs.wrapper.handleSelectEnd()},handleFilterChange:function(){this.pagination.currentPage=1,this.fetchData()},handleFilterReset:function(){this.filter={pluginId:void 0,pluginName:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination,a=this.params,i=a.sourceArray;return t&&(e.page=t.currentPage,e.rows=t.pageSize),i&&(e.sourceArray=i),e},fetchData:function(){var e=this;this.table.selected=void 0;var t=this.parseFilter();this.pictureResolution&&(t.pictureResolution=this.pictureResolution),this.$service.floatWindowList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},handleSelectEnd:function(){var e=this.table,t=e.data,a=e.selected;this.$emit("select-end",t[a]),this.table.selected=void 0}},created:function(){}},Zb=Yb,ev=(a("35a7"),Object(Bn["a"])(Zb,Qb,Xb,!1,null,"4499cead",null)),tv=ev.exports,av=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"选择 ICON",visible:!0,"before-close":e.handleClose}},[a("div",{staticClass:"icon-selector__wrapper"},e._l(e.options,function(t,i){return a("img",{class:e.selected&&e.selected.pictureId===t.pictureId?"active":"",attrs:{src:t.pictureUrl,alt:"图标",title:t.iconTypeName},on:{click:function(a){e.selected=t}}})}),0),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSelectEnd}},[e._v("确 定")])],1)])},iv=[],nv={data:function(){return{selected:void 0,options:[]}},props:["value"],methods:{handleClose:function(){this.selected=void 0,this.$nextTick(function(){this.$emit("select-cancel")}.bind(this))},handleSelectEnd:function(){this.$emit("select-end",this.selected)}},created:function(){var e=this;this.$service.tabIconList().then(function(t){e.options=t.rows})}},ov=nv,rv=(a("087a"),Object(Bn["a"])(ov,av,iv,!1,null,"4801d750",null)),lv=rv.exports,sv=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-time-select",{attrs:{"picker-options":{start:"00:00",step:"00:10",end:"24:00"},placeholder:"选择时间"},on:{change:e.handle},model:{value:e.value1,callback:function(t){e.value1=t},expression:"value1"}})},cv=[],uv={data:function(){return{value1:"",time:""}},methods:{parseStrToMin:function(e){var t=e.split(":"),a=parseInt(t[0]),i=parseInt(t[1]);return 60*a+i},handle:function(){void 0!=this.value1&&(this.time=this.parseStrToMin(this.value1),this.$emit("input",this.time))}}},dv=uv,pv=Object(Bn["a"])(dv,sv,cv,!1,null,null,null),hv=pv.exports,mv=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:{"cc-virtual-tab":!0,"collapse-all":e.isDragging},style:{width:e.width+"px"}},[e.readOnly?e._e():a("div",{staticClass:"panel-placeholder panel-placeholder__normal",on:{dragenter:e.handleDragEnter,dragleave:e.handleDragLeave,dragover:e.handleDragOver,drop:function(t){return e.handleDrop(t,{type:"NORMAL",index:-1})}}}),e._l(e.panels,function(t,i){return[a("div",{directives:[{name:"shadow-drag",rawName:"v-shadow-drag",value:{type:t.type,index:i},expression:"{type: panelItem.type, index: index}"}],class:{"tab-placeholder":!0,"tab-placeholder--normal":"NORMAL"===t.type,collapse:t.isCollapse,"is-dragable":!e.readOnly,"tab-placeholder--dragging":void 0===e.draggingCrowdIndex&&e.draggingIndex===i},on:{"shadow-drag-start":function(t){return e.handleDragStart(t,i)},"shadow-drag-end":e.handleDragEnd}},[a("div",{staticClass:"panel-group-title"},[t.isCollapse?a("i",{staticClass:"el-icon-arrow-down",on:{click:function(t){return e.handleCollapse(!1,i)}}}):a("i",{staticClass:"el-icon-arrow-up",on:{click:function(t){return e.handleCollapse(!0,i)}}}),"SPEC"===t.type?[e._v("\n          "+e._s(e.getPanelInfo(t.crowdPanels[0]).panelTitle)+" ("+e._s(t.crowdPanels.length)+")\n        ")]:[e._v(e._s(e.getPanelInfo(t.panel).panelTitle))],a("InputOrder",{key:Math.random().toString(),staticClass:"tab-placeholder__index",attrs:{size:"small",value:i+1,disabled:e.readOnly,draggable:"true"},on:{input:function(t){return e.$emit("change-panel-order",i,t)}},nativeOn:{dragstart:function(t){return e.disableDrag(t)}}}),e.readOnly?e._e():a("i",{staticClass:"tab-placeholder__group-remove el-icon-close",attrs:{title:"删除组"},on:{click:function(t){return e.handleRemovePanel(i)}}})],2),a("div",{staticClass:"panel-group-content"},["SPEC"===t.type?a("div",[e.readOnly?e._e():a("div",{staticClass:"panel-placeholder",on:{dragenter:e.handleDragEnter,dragleave:e.handleDragLeave,dragover:e.handleDragOver,drop:function(t){return e.handleDrop(t,{type:"CROWD",index:i,crowdIndex:-1})}}}),e._l(t.crowdPanels,function(n,o){return[a("cc-var",{directives:[{name:"show",rawName:"v-show",value:e.isDragging||t.isShowAll||0===o,expression:"isDragging || panelItem.isShowAll || crowdIndex === 0"},{name:"shadow-drag",rawName:"v-shadow-drag",value:{type:"CROWD",index:i,crowdIndex:o},expression:"{type: 'CROWD', index: index, crowdIndex: crowdIndex}"}],key:o,class:{"tab-placeholder__panel-wrapper":!0,"panel-duplicate":n.isDuplicate,"tab-placeholder__panel-wrapper--dragging":e.draggingCrowdIndex===o&&e.draggingIndex===i},attrs:{panel:e.getPanelInfo(n)},nativeOn:{"shadow-drag-start":function(t){return e.handleDragStart(t,i,o)},"shadow-drag-end":function(t){return e.handleDragEnd(t)}},scopedSlots:e._u([{key:"default",fn:function(r){var l=r.panel;return[e.readOnly?e._e():[a("i",{staticClass:"tab-placeholder__panel-remove el-icon-close",attrs:{title:"删除"},on:{click:function(t){return e.handleRemovePanel(i,o)}}}),1===t.crowdPanels.length?a("a",{staticClass:"btn-crowd btn-crowd--unset",on:{click:function(t){return e.$emit("toggle-type",i)}}},[e._v("取消定向")]):a("a",{staticClass:"btn-crowd btn-crowd--disabled",attrs:{title:"请将版块移出版块组，再取消定向"}},[e._v("取消定向")])],a("div",{staticClass:"tab-plcacholder-info"},[a("div",{staticClass:"tab-placeholder-info__link",on:{click:function(t){return e.handleOpenPanel(l)}}},[e._v("\n                    "+e._s(l.panelId)+"\n                    "),a("span",{directives:[{name:"show",rawName:"v-show",value:4!==l.status,expression:"panel.status !== 4"}],staticClass:"panel-status--waiting"},[e._v("("+e._s(e.STATUS_TEXT[l.status])+")")])]),a("div",{staticClass:"tab-placeholder-info__link",on:{click:function(t){return e.handleOpenPanel(l)}}},[e._v(e._s(l.panelName))]),n.dmpInfo?a("div",{staticClass:"tab-placeholder-info__link",on:{click:function(t){return e.$emit("change-crowd",i,o)}}},[e._v("人群: "+e._s(n.dmpInfo.crowdName))]):e._e()]),a("div",{staticClass:"tab-placeholder__panel"},[a("div",{staticClass:"tab-placeholder__panel-title",on:{click:function(t){return e.handleOpenPanel(l)}}},[e._v(e._s(l.panelTitle))]),a("cc-virtual-panel-group",{key:o,attrs:{panel:e.panelData[n.id],ratio:e.ratio,active:n.activeIndex,"show-title":e.showTitle},on:{activate:function(t){return e.handleActivate(n,t)},"click-block":function(t){return e.handleClickBlock({index:i,crowdIndex:o,activeIndex:arguments[0],blockIndex:arguments[1]})}}})],1)]}}],null,!0)}),e.readOnly?e._e():a("div",{directives:[{name:"show",rawName:"v-show",value:e.isDragging||t.isShowAll||0===o,expression:"isDragging || panelItem.isShowAll || crowdIndex === 0"}],staticClass:"panel-placeholder",on:{dragenter:e.handleDragEnter,dragleave:e.handleDragLeave,dragover:e.handleDragOver,drop:function(t){return e.handleDrop(t,{type:"CROWD",index:i,crowdIndex:o})}}})]}),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isDragging&&!t.isShowAll&&t.crowdPanels.length>1,expression:"!isDragging && !panelItem.isShowAll && panelItem.crowdPanels.length > 1"}],staticClass:"btn-show-all"},[a("a",{attrs:{title:"显示所有版块"},on:{click:function(t){return e.handleShowAllPanels(i)}}},[a("i",{staticClass:"el-icon-arrow-down"}),e._v("\n              共 "+e._s(t.crowdPanels.length)+" 个版块\n            ")])])],2):a("div",{staticClass:"tab-placeholder__normal-panel"},[a("cc-var",{class:{"tab-placeholder__panel-wrapper":!0,"panel-duplicate":t.panel.isDuplicate},attrs:{panel:e.getPanelInfo(t.panel)},scopedSlots:e._u([{key:"default",fn:function(n){var o=n.panel;return[e.readOnly?e._e():[a("i",{staticClass:"tab-placeholder__panel-remove el-icon-close",attrs:{title:"删除"},on:{click:function(t){return e.handleRemovePanel(i)}}}),a("a",{staticClass:"btn-crowd btn-crowd--set",on:{click:function(t){return e.$emit("toggle-type",i)}}},[e._v("设置定向")])],a("div",{staticClass:"tab-plcacholder-info"},[a("div",{staticClass:"tab-placeholder-info__link",on:{click:function(t){return e.handleOpenPanel(o)}}},[e._v("\n                  "+e._s(o.panelId)+"\n                  "),a("span",{directives:[{name:"show",rawName:"v-show",value:4!==o.status,expression:"panel.status !== 4"}],staticClass:"panel-status--waiting"},[e._v("("+e._s(e.STATUS_TEXT[o.status])+")")])]),a("div",{staticClass:"tab-placeholder-info__link",on:{click:function(t){return e.handleOpenPanel(o)}}},[e._v(e._s(o.panelName))])]),a("div",{staticClass:"tab-placeholder__panel"},[a("div",{staticClass:"tab-placeholder__panel-title",on:{click:function(t){return e.handleOpenPanel(o)}}},[e._v(e._s(o.panelTitle))]),a("cc-virtual-panel-group",{attrs:{panel:e.panelData[t.panel.id],active:t.panel.activeIndex,ratio:e.ratio,"show-title":e.showTitle},on:{activate:function(a){return e.handleActivate(t,a)},"click-block":function(t){return e.handleClickBlock({index:i,activeIndex:arguments[0],blockIndex:arguments[1]})}}})],1)]}}],null,!0)})],1)])]),e.readOnly?e._e():a("div",{staticClass:"panel-placeholder panel-placeholder__normal",on:{dragenter:e.handleDragEnter,dragleave:e.handleDragLeave,dragover:e.handleDragOver,drop:function(t){return e.handleDrop(t,{type:"NORMAL",index:i})}}})]})],2)},fv=[],gv=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"cc-virtual-panel-group"},[e.panel.panelList?["group"===e.panel.parentType?[a("el-tabs",{attrs:{type:"card",value:e.active+""},on:{input:function(t){return e.$emit("activate",t)}}},e._l(e.panel.panelList,function(t,i){return a("el-tab-pane",{key:i,attrs:{name:i+""}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(t.panelTitle))]),a("cc-virtual-panel",{attrs:{blocks:t.blocks,ratio:e.ratio,"show-title":e.showTitle},on:{"click-block":function(t){return e.handleClickBlock(i,t)}}})],1)}),1)]:a("cc-virtual-panel",{attrs:{blocks:e.panel.panelList[0].blocks,ratio:e.ratio,"show-title":e.showTitle},on:{"click-block":function(t){return e.handleClickBlock(0,t)}}})]:e._e()],2)},bv=[],vv={components:{"cc-virtual-panel":Zu},props:["panel","ratio","active","showTitle"],methods:{handleClickBlock:function(e,t){this.$emit("click-block",e,t)}}},yv=vv,wv=(a("53bc"),Object(Bn["a"])(yv,gv,bv,!1,null,"03193c48",null)),Iv=wv.exports,Cv={components:{"cc-var":$b,"cc-virtual-panel":Zu,"cc-virtual-panel-group":Iv,InputOrder:lb},data:function(){return{isDragging:!1,draggingIndex:void 0,draggingCrowdIndex:void 0,STATUS_TEXT:this.$consts.statusText}},props:["panels","ratio","width","panelData","showTitle","readOnly"],methods:{disableDrag:function(e){e.stopPropagation(),e.preventDefault()},getPanelInfo:function(e){var t=this.panelData[e.id],a={duplicateVersion:t.duplicateVersion,dmpInfo:e.dmpInfo,panelId:t.pannelGroupId,status:t.pannelStatus};if(t.parentType){var i=t.pannelList[e.activeIndex||0];a.panelTitle=t.groupTitle||i.pannelTitle,a.panelName=i.pannelName}return a},hasDuplicateVersion:function(e){var t=e.duplicateVersion;if(t&&"no"!==t)return t},handleActivate:function(e,t){this.$set(e,"activeIndex",+t)},handleDragStart:function(e,t,a){if(this.readOnly)return e.preventDefault(),void e.stopPropagation();this.$emit("drag-start"),setTimeout(function(){this.isDragging=!0,this.draggingIndex=t,this.draggingCrowdIndex=a}.bind(this),0)},handleDragEnd:function(){this.isDragging=!1,this.draggingIndex=void 0,this.draggingCrowdIndex=void 0,this.$emit("drag-end")},handleCollapse:function(e,t){this.$emit(e?"collapse":"uncollapse",t)},handleDragEnter:function(e){e.currentTarget.classList.add("active")},handleDragLeave:function(e){e.currentTarget.classList.remove("active")},handleAddPanel:function(e,t,a){this.$emit("add-panel",{type:e,index:t,crowdIndex:a})},handleDrop:function(e,t){this.handleDragLeave(e);var a=JSON.parse(e.dataTransfer.getData("text/plain"));setTimeout(function(){a.pannelGroupId?this.$emit("insert-panel",a,t):this.$emit("reorder-panel",a,t)}.bind(this),20)},handleDragOver:function(e){e.preventDefault()},handleOpenPanel:function(e){this.$emit("open-panel",e)},handleInsertPanel:function(){},handleRemovePanel:function(e,t){this.$emit("remove-panel",e,t)},handleClickBlock:function(e){this.$emit("click-block",e)},handleShowAllPanels:function(e){this.$emit("show-all-panel",e)}}},Tv=Cv,Sv=(a("e96a"),Object(Bn["a"])(Tv,mv,fv,!1,null,null,null)),kv=Sv.exports,_v=a("9ead"),Pv=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-input-number",{attrs:{"controls-position":"right",precision:0,min:0,max:e.hourMax},on:{change:e.handleInputHour},model:{value:e.hour,callback:function(t){e.hour=t},expression:"hour"}}),e._v(" 小时\n  "),a("el-input-number",{attrs:{"controls-position":"right",precision:0,min:0,max:e.minMax},on:{change:e.handleInputMinute},model:{value:e.minute,callback:function(t){e.minute=t},expression:"minute"}}),e._v(" 分钟\n")],1)},xv=[],Dv={data:function(){return{hour:0,minute:0}},computed:{hourMax:function(){return this.max?Math.floor(this.max/60):24},minMax:function(){return this.max<60?this.max:59}},props:["value","max","min"],methods:{handleInputMinute:function(e){var t=60*this.hour+e;return t>this.max?this.setHourAndMinute(this.max):t<this.min?this.setHourAndMinute(this.min):(this.minute=e,void this.$emit("input",t))},handleInputHour:function(e){var t=60*e+this.minute;return t>this.max?this.setHourAndMinute(this.max):t<this.min?this.setHourAndMinute(this.min):(this.hour=e,void this.$emit("input",t))},setHourAndMinute:function(e){var t=this;e&&this.$nextTick(function(){t.hour=Math.floor(e/60),t.minute=e%60})}},created:function(){this.$watch("value",this.setHourAndMinute,{immediate:!0})}},Fv=Dv,$v=Object(Bn["a"])(Fv,Pv,xv,!1,null,null,null),Lv=$v.exports,Rv={name:"TabInfo",mixins:[zu],components:{"cc-var":$b,"cc-table-el":Dn["Table"],"cc-tab-selector-el":Hc,"cc-panel-selector-el":Ab,"cc-business-type-selector":Gb,"cc-appid-selector":Kb,"cc-global-picture-selector":yd,"cc-float-window-selector":tv,"cc-icon-selector":lv,"cc-time-spinner":hv,"cc-virtual-tab":kv,"cc-crowd-selector":tp,Table:Dn["Table"],CommonContent:Us,Affix:_v["Affix"],ContentCard:Hn,SourceRadioSelector:od,InputOrder:lb,OrderableTable:fb,PageWrapper:Mu,PageContentWrapper:qu,PanelInfo:Jp,PrivatePanelInfo:Jh,InputMinute:Lv},data:function(){var e=this,t={draft:2,waiting:3,accepted:4,rejected:5,processing:7},a={0:"下架",2:"草稿",3:"待审核",4:"审核通过",5:"审核不通过",7:"审核通过未上线"};return{mode:"create",activePage:"tab_info",panelPreview:{panel:null,id:void 0,version:void 0,initMode:void 0,initGroupIndex:void 0,initBlockIndex:void 0},resourceName:"版面",embedTab:void 0,isCollapseBase:!1,isCollapseExtend:!1,isCollapseSpec:!1,isPanelDragging:!1,STATUS:t,STATUS_TEXT:a,urls:{save:"/tab/save.html",historyList:"/v1/hvi/historyList.html"},showIconSelector:!1,showFloatWindowSelector:!1,showBgSelector:!1,showLongBgSelector:!1,showPanelSelector:!1,showCrowdSelector:!1,SOURCE:[{label:"腾讯",value:"o_tencent"},{label:"爱奇艺",value:"o_iqiyi"},{label:"优酷",value:"o_youku"}],TAB_TYPES:[{label:"普通版面",value:1},{label:"专题版面",value:2}],PROMOTIONS:[{label:"无",value:"none"},{label:"影视",value:"movie"}],panelListIndexed:{},vipEnums:[],vipEnumsData:[],tabInfo:{tabId:void 0,currentVersion:void 0,tabParentType:"home",tabType:1,hasSubTab:0,flagIsBlockBg:0,tabName:void 0,tabCnTitle:void 0,tabEnTitle:void 0,tabCategory:67,tabAppid:-1,tabResource:"o_tencent",iconTypeName:void 0,pictureName:void 0,tabParams:{},tabStatus:void 0,tabOnclick:void 0,systemDefault:0,timeCycle:120,cornerIconName:void 0,flagIsRecord:0,isTiming:0,releaseTime:void 0,tabExtArr:{},pannelList:[],tabList:[],sinkSize:0,isShowvip:1,alumbTabBg:void 0,alumbTabLongBg:void 0,pannelTitleColor:void 0,blockTitleFocusColor:void 0,blockTitleUnfocusColor:void 0,autoPromotion:"none",activityFloatWindow:void 0,imgOnBlur:void 0,imgOnFocus:void 0,imgOnSelected:void 0,vipButtonSourceId:void 0},versionList:[],panelNormalDuplicates:{},panelSpecDuplicates:{},subTabTableHeader:[{label:"版面ID",prop:"tabId",width:180},{label:"版面名称",prop:"tabName",render:function(t,a){var i=a.$index,n=a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handlePreviewTab(n,n.currentVersion,i)}}},n.tabName)}},{label:"待审核副本",width:120,render:function(t,a){var i=a.$index,n=a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handlePreviewTab(n,n.duplicateVersion,i)}}},n.duplicateVersion)}}]}},props:["id","version","init-mode"],computed:{resourceInfo:function(){var e=this.tabInfo;if(e.tabId)return{id:e.tabId,version:e.currentVersion,status:e.tabStatus,type:"tab",menuElId:"tabInfo"}},floatWindowParams:function(){var e={o_tencent:"0,1",o_iqiyi:"0,2",o_youku:"0,3"};return{sourceArray:e[this.tabInfo.tabResource]||"0"}},isReplicate:function(){return"replicate"===this.mode},rules:function(){return{tabName:[{required:!0,message:"请输入版面名称",trigger:"blur"},{max:45,message:"不超过 45 个字符"}],tabCnTitle:[{required:!0,message:"请输入中文标题",trigger:"blur"},{max:45,message:"不超过 45 个字符"}],tabEnTitle:[{required:!0,message:"请输入英文标题",trigger:"blur"},{max:45,message:"不超过 45 个字符"}],pictureName:[{required:!0,message:"请选择Tab对应的icon",trigger:"blur"}],alumbTabBg:[{required:!0,message:"请设置大背景",trigger:"blur"}]}},showSystemDefault:function(){var e=this.tabInfo.tabCategory;return 60==e||61==e||66==e},hasSource:function(){var e=this.tabInfo.tabCategory;return 67==e||31==e},disableAppId:function(){return-1!=+yb(this.tabInfo.tabCategory)},couldSetReleaseTime:function(){var e=this.mode,t=this.tabInfo.currentVersion,a="create"===e||"copy"===e,i="edit"===e&&"V1"===t,n="10"==this.$consts.idPrefix;return n&&!(a||i)}},watch:{},methods:(Cb={parseMinToStr:function(e){var t=Math.floor(e/60),a=e%60,i=t>9?""+t:"0"+t,n=a>9?""+a:"0"+a;return i+":"+n},openPannelWin:function(e){var t=this.FastDevTool,a=basicFn.numToPannelTypeUrl(e)+"/add.html";t.createDialogWin("add-view",{confirmInfo:!0,fit:!0,iconCls:"icon-edit",minimizable:!1,maximizable:!0,title:"版块页面",content:t.createIframe(a)})},handleDragStart:function(){setTimeout(function(){this.isPanelDragging=!0}.bind(this))},handleDragEnd:function(){setTimeout(function(){this.isPanelDragging=!1}.bind(this))},handleCreateTab:function(){this.activePage="tab",this.embedTab={mode:"create"}},handleOpenPanel:function(){console.log(arguments)},handleShowAllPanels:function(e){this.$set(this.tabInfo.pannelList[e],"isShowAll",!0)},handleTogglePanelType:function(e){var t=this.tabInfo.pannelList,a=t[e];if("SPEC"===a.type){var i=a.crowdPanels[0];i.dmpInfo=void 0,this.$set(t,e,{type:"NORMAL",panel:i,isCollapse:a.isCollapse}),this.updateDuplicates()}else this.selectCrowdCallback=function(i){a.panel.dmpInfo=i,this.$set(t,e,{type:"SPEC",crowdPanels:[a.panel],isShowAll:!1,isCollapse:a.isCollapse}),this.updateDuplicates()},this.selectCrowdForIndex=e,this.handleSelectCrowdStart()},handleToggleAllPanel:function(e){this.tabInfo.pannelList.forEach(function(t){this.$set(t,"isCollapse",e)}.bind(this))},handleChangeTabCategory:function(e){var t=this.tabInfo,a=t.tabCategory,i=[67,31].indexOf(a)>-1,n=[67,31].indexOf(e)>-1,o=!i&&n,r=function(){n?""===t.tabResource&&(t.tabResource="o_tencent"):t.tabResource="",60!=e&&61!=e&&66!=e&&(t.systemDefault=0),t.tabAppid=+yb(e),t.tabCategory=e,o&&this.clearContents()}.bind(this);o?this.$confirm("是否要切换业务分类，从不分源分类切换到分源分类之后所选择的版块或二级版面数据将会清除掉?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(r).catch(function(){}):r()}},Object(ei["a"])(Cb,"openPannelWin",function(e){var t=this.basicFn.numToPannelTypeUrl(e)+"/add.html";this.FastDevTool.createDialogWin("add-view",{confirmInfo:!0,fit:!0,iconCls:"icon-edit",minimizable:!1,maximizable:!0,title:"版块页面",content:this.FastDevTool.createIframe(t)})}),Object(ei["a"])(Cb,"handlePreviewPanel",function(e){var t=this.panelListIndexed[e.panelId],a=t.duplicateVersion||t.currentVersion;this.activePage="panel_preview",this.panelPreview={panel:t,initMode:"read",id:t.pannelGroupId,dataType:t.pannelType,version:a}}),Object(ei["a"])(Cb,"handlePreviewPanelEnd",function(){var e=this.panelPreview.panel;this.updatePanelVersion(e,function(){this.loadPanelDetail(e)}.bind(this)),this.panelPreview=null,this.activePage="tab_info"}),Object(ei["a"])(Cb,"handleClickBlock",function(e){var t=this.$consts.idPrefix,a=e.index,i=e.crowdIndex,n=e.activeIndex,o=e.blockIndex,r=this.getPanelByIndex(a,i),l=this.panelListIndexed[r.id],s=l.pannelStatus,c=this.STATUS,u=(l.duplicateVersion||l.currentVersion,"11"===t),d={panel:l,dataType:l.pannelType,initMode:"read",id:l.pannelGroupId,version:l.currentVersion,initGroupIndex:void 0,initBlockIndex:void 0};switch(!0){case u&&0===l.pannelGroupId.toString().indexOf(10):break;case s===c.draft:d.initMode="edit",d.initGroupIndex=n,d.initBlockIndex=o;break;case s===c.accepted:d.initMode="replicate",d.initGroupIndex=n,d.initBlockIndex=o;break;case s===c.waiting:break}this.panelPreview=d,this.activePage="panel_preview"}),Object(ei["a"])(Cb,"handleChangeSource",function(e){this.$confirm("是否要切换内容源，切换内容源之后所选择的版块或二级版面数据将会清除掉！","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){this.tabInfo.tabResource=e,this.clearContents()}.bind(this)).catch(function(e){throw e})}),Object(ei["a"])(Cb,"clearContents",function(){var e=this.$refs.tabSelector;this.tabInfo.vipButtonSourceId=void 0,this.tabInfo.tabList=[],e&&e.handleRemoteSelectClear(),this.tabInfo.pannelList=[]}),Object(ei["a"])(Cb,"handleClose",function(){}),Object(ei["a"])(Cb,"handleSelectTitleIcon",function(e,t){this.tabInfo[e]=t.pictureUrl}),Object(ei["a"])(Cb,"handleSelectIconStart",function(){this.showIconSelector=!0}),Object(ei["a"])(Cb,"handleSelectIconCancel",function(){this.showIconSelector=!1}),Object(ei["a"])(Cb,"handleSelectIconEnd",function(e){this.showIconSelector=!1,this.tabInfo.pictureName=e.pictureName,this.tabInfo.iconTypeName=e.iconTypeName,this.tabInfo.pictureUrl=e.pictureUrl}),Object(ei["a"])(Cb,"handleSelectFloatWindowEnd",function(e){this.showFloatWindowSelector=!1,this.tabInfo.activityFloatWindow={pluginId:e.pluginId,pluginName:e.pluginName,pluginType:e.pluginType}}),Object(ei["a"])(Cb,"handleRemoveFloatWindow",function(){this.tabInfo.activityFloatWindow=void 0}),Object(ei["a"])(Cb,"handleSelectBgStart",function(){this.showBgSelector=!0}),Object(ei["a"])(Cb,"handleSelectBgCancel",function(){this.showBgSelector=!1}),Object(ei["a"])(Cb,"handleSelectBgEnd",function(e){this.showBgSelector=!1,this.tabInfo.alumbTabBg=e.pictureUrl}),Object(ei["a"])(Cb,"handleSelectLongBgStart",function(){this.showLongBgSelector=!0}),Object(ei["a"])(Cb,"handleSelectLongBgCancel",function(){this.showLongBgSelector=!1}),Object(ei["a"])(Cb,"handleSelectLongBgEnd",function(e){this.showLongBgSelector=!1,this.tabInfo.alumbTabLongBg=e.pictureUrl}),Object(ei["a"])(Cb,"handleSelectCrowdStart",function(){this.showCrowdSelector=!0}),Object(ei["a"])(Cb,"handleSelectCrowdCancel",function(){this.showCrowdSelector=!1}),Object(ei["a"])(Cb,"handleSelectCrowdEnd",function(e,t){var a={crowdId:t.value,crowdName:t.label,policyId:e.value,policyName:e.label},i=this.selectCrowdForIndex,n=this.tabInfo.pannelList[i];if(void 0!==i&&"SPEC"===n.type){var o=n.crowdPanels,r=o.length;while(--r>=0)if(o[r].dmpInfo.crowdId===a.crowdId)break;if(r>=0)return this.$message({type:"error",message:"该定向版块组第"+(r+1)+"个版块已选择该人群"})}this.selectCrowdCallback(a),this.showCrowdSelector=!1,this.selectCrowdCallback=void 0}),Object(ei["a"])(Cb,"handleChangeCrowdOfPanel",function(e,t){this.selectCrowdCallback=function(a){this.tabInfo.pannelList[e].crowdPanels[t].dmpInfo=a},this.selectCrowdForIndex=e,this.handleSelectCrowdStart()}),Object(ei["a"])(Cb,"handleSelectPanelEnd",function(e){var t=this.tabInfo.pannelList,a=t.length-1;e.forEach(function(e,t){this.doInsertPanel(e,{index:a+t,type:"NORMAL"})}.bind(this)),this.showPanelSelector=!1,this.$refs.virtualTab.isDragging=!1}),Object(ei["a"])(Cb,"handleInsertPanel",function(e,t){"NORMAL"===t.type||e.dmpInfo?this.doInsertPanel(e,t):(this.selectCrowdCallback=function(a){e.dmpInfo=a,this.doInsertPanel(e,t)},this.selectCrowdForIndex=t.index,this.handleSelectCrowdStart())}),Object(ei["a"])(Cb,"handleChangeCollapseState",function(e){var t=this.tabInfo.pannelList[e];this.$set(t,"isCollapse",!t.isCollapse)}),Object(ei["a"])(Cb,"doInsertPanel",function(e,t){var a=e.pannelGroupId,i=e.dmpInfo,n=t.type,o=t.index,r=t.crowdIndex,l=this.tabInfo.pannelList;if("NORMAL"===n){var s={type:n,panel:{id:a,isDuplicate:!1,activeIndex:0,dmpInfo:void 0},isCollapse:!1};l.splice(o+1,0,s)}else{var c=l[o];c.crowdPanels.splice(r+1,0,{id:a,isDuplicate:!1,activeIndex:0,dmpInfo:i})}this.loadPanelDetail(e),this.updateDuplicates()}),Object(ei["a"])(Cb,"loadPanelDetail",function(e,t){var a=this;this.$set(this.panelListIndexed,e.pannelGroupId,e);var i=e.pannelGroupId,n=e.duplicateVersion||e.currentVersion;this.$service.panelGetDetail({id:i,version:n}).then(function(t){if(t.pannelGroupId){var i=t.pannelList||[],n=i.map(function(e){return{panelTitle:e.pannelTitle,blocks:"function"===t.parentType?[]:this.getPanelBlocks(e)}}.bind(a));delete t.currentVersion,delete t.duplicateVersion,a.panelListIndexed[e.pannelGroupId]=Object.assign({},e,t,{panelList:n,pannelStatus:t.pannelList[0].pannelStatus})}})}),Object(ei["a"])(Cb,"updatePanelVersion",function(e,t){this.$service.panelPageList({pannelType:e.pannelType,pannelId:e.pannelGroupId}).then(function(a){var i=a.rows[0];e.currentVersion=i.currentVersion,e.duplicateVersion=i.duplicateVersion,t()})}),Object(ei["a"])(Cb,"handleReOrderPanel",function(e,t){var a=e.type,i=e.index,n=e.crowdIndex,o=t.type,r=t.index,l=t.crowdIndex,s=this.tabInfo.pannelList,c=s[i];switch(!0){case"SPEC"===a&&"NORMAL"===o:this.doRemovePanel(i);var u=i<=r?r:r+1;s.splice(u,0,c);break;case"SPEC"===a&&"CROWD"===o:this.$message({type:"error",message:"定向版块组不能拖到别的定向版块组里边"});break;case"CROWD"===a&&"NORMAL"===o:var d={type:"SPEC",crowdPanels:[c.crowdPanels[n]]};1===c.crowdPanels.length?(this.doRemovePanel(i,n),s.splice(i<=r?Math.max(r,0):r+1,0,d)):(this.doRemovePanel(i,n),s.splice(r+1,0,d));break;case"CROWD"===a&&"CROWD"===o:var p=s[i].crowdPanels,h=s[r].crowdPanels,m=p[n];if(i===r)h.splice(n,1),h.splice(n<=l?l:l+1,0,m);else{var f=h.length;while(--f>=0)if(h[f].dmpInfo.crowdId===m.dmpInfo.crowdId)break;if(f>=0)return this.$message({type:"error",message:"该定向版块组第"+(f+1)+"个版块已选择该人群"});h.splice(l+1,0,m),this.doRemovePanel(i,n)}break;case"NORMAL"===a&&"NORMAL"===o:this.doRemovePanel(i),s.splice(i<=r?r:r+1,0,c);break;case"NORMAL"===a&&"CROWD"===o:this.selectCrowdCallback=function(e){this.$set(c.panel,"dmpInfo",e),s[r].crowdPanels.splice(l+1,0,c.panel),this.doRemovePanel(i),this.updateDuplicates()},this.selectCrowdForIndex=r,this.handleSelectCrowdStart();break}}),Object(ei["a"])(Cb,"getPanelIdByIndex",function(e,t){return this.getPanelByIndex(e,t).id}),Object(ei["a"])(Cb,"getPanelByIndex",function(e,t){var a,i=this.tabInfo.pannelList;return a=void 0!==t?i[e].crowdPanels[t]:i[e].panel,a}),Object(ei["a"])(Cb,"handleRemovePanel",function(e,t){var a,i=this.tabInfo.pannelList,n=i[e];if(void 0===t&&"SPEC"===n.type){var o=this.getPanelIdByIndex(e,0),r=this.panelListIndexed[o];a="是否确定删除版块组 "+r.pannelGroupRemark}else{var l=this.getPanelIdByIndex(e,t),s=this.panelListIndexed[l];a="是否确定删除版块 "+s.pannelGroupRemark}this.$confirm(a).then(function(){this.doRemovePanel(e,t),this.updateDuplicates()}.bind(this)).catch(function(){})}),Object(ei["a"])(Cb,"doRemovePanel",function(e,t){var a=this.tabInfo.pannelList;if(void 0!==t){var i=a[e].crowdPanels;i.splice(t,1),0===i.length&&a.splice(e,1)}else a.splice(e,1)}),Object(ei["a"])(Cb,"getPanelBlocks",function(e){var t=e.parentType,a=(e.contentList,JSON.parse(e.layoutInfo.layoutJson)),i=a.type,n=a.contents,o=n.length,r=n.length,l=e.contentList,s=n[o-1],c=s.x+s.width,u=s.resize||{},d=s.y+(u.height||s.height),p=function(){if("Expander"===i&&2===o){var e=a.extra.space;return function(t){var a=n[1],i=a.resize,o=a.title_info,r=c+(t-2)*e+(t-3)*a.width,l=a.y,s={height:a.height,width:a.width,x:r,y:l,isExtra:!0,title_info:o,loop:a.loop,type:a.type};return o&&i&&(s.resize={height:i.height,width:i.width,x:r,y:l}),s}}if("Expander"===i){var t=a.extra.space;return function(e){var a=Math.floor(e/o)-1,i=e%o,r=n[i],l=r.resize,s=r.title_info,u=r.x+a*c+a*t,d=r.y,p={height:r.height,width:r.width,x:u,y:d,isExtra:!0,title_info:s,loop:r.loop,type:r.type};return s&&l&&(p.resize={height:l.height,width:l.width,x:u,y:d}),p}}if("Lengthwise"===i){var r=0;return function(e){var t=Math.ceil(e/o)-1,a=e-o*t-1,i=n[a],l=i.resize,s=i.title_info,c=i.x,u=i.y+t*d+t*r,p={height:i.height,width:i.width,x:c,y:u,isExtra:!0,title_info:s};return s&&l&&(p.resize={height:l.height,width:l.width,x:c,y:u}),p}}};if("Expander"===i||"Lengthwise"===i){var h=p(),m="group"===t?r:Math.max(r,l.length),f=n.length;while(f++<m)n.push(h(f))}var g={},b=n.map(function(e,t){var a=l[t]||{},i=a.videoContentList||[],n=i[0];if(n&&n.extraValue1){var o=n.extraValue1+(n.extraValue5||""),r=g[o];r?(r.duplicated=!0,a.duplicated=!0):(a.duplicated=!1,g[o]=a)}else a.duplicated=!1;return a.videoContentList=i,a.contentPosition=Object.assign({},e,{resize:void 0}),a.titleInfo=e.title_info,a.resize=e.resize,a.isExtra=e.isExtra,a});return b}),Object(ei["a"])(Cb,"updateDuplicates",function(){var e=this.tabInfo.pannelList,t={},a={},i={},n={};e.forEach(function(e,o){if("NORMAL"===e.type){var r=e.panel,l=r.id;i[l]?t[l]=!0:i[l]=!0,n[l]&&(n[l].forEach(function(e){a[e]=a[e]||{},a[e][l]=!0}),t[l]=!0)}else{var s=e.crowdPanels,c={},u=a[o]||{};s.forEach(function(e,a){var o=e,r=o.id;c[r]?u[r]=!0:c[r]=!0,n[r]=n[r]||[],n[r].push(a),i[r]&&(u[r]=!0,t[r]=!0)}),a[o]=u}}),console.log(t),console.log(a),e.forEach(function(e,i){if("NORMAL"===e.type)t[e.panel.id+""]?e.panel.isDuplicate=!0:e.panel.isDuplicate=!1;else{var n=a[i]||{};e.crowdPanels.forEach(function(e){n[e.id+""]?e.isDuplicate=!0:e.isDuplicate=!1})}}),console.log(e)}),Object(ei["a"])(Cb,"handleSelectTabStart",function(){this.$nextTick(function(){var e=this.$refs.tabSelector;this.tabInfo.tabList.forEach(function(t){e.handleTableRowSelectionAdd(t)})}.bind(this))}),Object(ei["a"])(Cb,"handleSelectTabEnd",function(e){this.$refs.subTabTable.handleAppendData(e,"tabId")}),Object(ei["a"])(Cb,"handleChangePanelOrder",function(e,t){var a=t-1,i=e,n=this.tabInfo.pannelList,o=n[i];n.splice(i,1),this.tabInfo.pannelList=[].concat(n.slice(0,a),o,n.slice(a))}),Object(ei["a"])(Cb,"openTabWin",function(e){var t=this.basicFn.numToPannelTypeUrl(e)+"/add.html";this.FastDevTool.createDialogWin("add-view",{confirmInfo:!0,fit:!0,iconCls:"icon-edit",minimizable:!1,maximizable:!0,title:"版块页面",content:this.FastDevTool.createIframe(t)})}),Object(ei["a"])(Cb,"handleTabEmbedBack",function(){var e=this;this.activePage="tab_info";var t=this.embedTab,a=t.index,i=t.id;t.version,t.mode;void 0!==a&&this.$service.tabInfoList({tabId:i}).then(function(t){Object.assign(e.tabInfo.tabList[a],t.rows[0])}),this.embedTab=void 0}),Object(ei["a"])(Cb,"handlePreviewTab",function(e,t,a){this.activePage="tab",this.embedTab={index:a,id:e.tabId,version:t,mode:"read"}}),Object(ei["a"])(Cb,"handleShowTimeShelf",function(){var e=this.getFormData();e.tabStatus=this.STATUS.waiting,this.validateFormData(e,function(){this.showTimeShelf=!0}.bind(this))}),Object(ei["a"])(Cb,"handleCopy",function(e){var t=this.$consts.status;e===t.waiting?this.handleSubmitAudit():this.handleSaveDraft()}),Object(ei["a"])(Cb,"handleSaveDraft",function(){var e=this,t=this.getFormData();t.isTiming=void 0,t.releaseTime=void 0,t.tabStatus=this.$consts.status.draft,this.validateFormData(t,function(){e.upsertTabInfo(t)})}),Object(ei["a"])(Cb,"handleSubmitAudit",function(e){var t=this,a=this.getFormData();a.tabStatus=this.$consts.status.waiting,this.validateFormData(a,function(){t.couldSetReleaseTime?e?(a.isTiming=e.isTiming,a.releaseTime=e.releaseTime,t.upsertTabInfo(a)):t.$refs.commonContent.showReleaseTimeSetter=!0:t.upsertTabInfo(a)})}),Object(ei["a"])(Cb,"getFormData",function(){var e=JSON.parse(JSON.stringify(this.tabInfo)),t=this.mode;return"replicate"===t&&(e.currentVersion=""),"copy"===t&&(e.tabId=void 0,e.currentVersion=""),e}),Object(ei["a"])(Cb,"validateFormData",function(e,t){var a,i=this.STATUS,n=e.tabStatus,o=function(e){this.$message({type:"error",message:e})}.bind(this);n===i.draft?(e.tabName||(a="请填写版面名称"),a?o(a):t()):this.$refs.tabForm.validate(function(i){if(i){if(1==e.tabType&&1===e.hasSubTab)0===e.tabList.length&&(a="请选择二级版面");else if(0===e.pannelList.length)a="请选择版块";else{var n=e.pannelList;e:for(var r=0,l=n.length;r<l;r++){var s=n[r];if("NORMAL"===s.type){if(s.panel.isDuplicate){a="含有重复版块";break e}}else for(var c=s.crowdPanels,u=0,d=c.length;u<d;u++)if(c[u].isDuplicate){a="含有重复版块";break e}}}2===e.tabType&&e.alumbTabLongBg&&e.pannelList.length>6&&(a="长图专题版块不能超过6个"),a?o(a):t()}else o("请把表单填写完整")})}),Object(ei["a"])(Cb,"parseTabInfo",function(e){for(var t=[],a=e.pannelList,i=0,n=a.length;i<n;i++){var o=a[i],r=void 0;"NORMAL"===o.type?r={pannelGroupId:o.panel.id,pannelSequence:i,isDmpPanel:0}:(r={pannelSequence:i,isDmpPanel:1},r.dmpPanelList=o.crowdPanels.map(function(e,t){return{pannelGroupId:e.id,pannelSequence:t,dmpPolicyId:e.dmpInfo.policyId,dmpPolicyName:e.dmpInfo.policyName,dmpCrowdId:e.dmpInfo.crowdId,dmpCrowdName:e.dmpInfo.crowdName}})),t.push(r)}var l={selected_img_url:e.imgOnSelected,focus_img_url:e.imgOnFocus,unfocus_img_url:e.imgOnBlur};l=JSON.stringify(l);var s={isShowvip:e.isShowvip,alumbTabBg:e.alumbTabBg,alumbTabLongBg:e.alumbTabLongBg,sinkSize:e.sinkSize,pannelTitleColor:e.pannelTitleColor,blockTitleFocusColor:e.blockTitleFocusColor,blockTitleUnfocusColor:e.blockTitleUnfocusColor,flagIsBlockBg:e.flagIsBlockBg},c=e.vipButtonSourceId;if(c){var u=this.getVipButtonSourceItem(c);s.vipButtonSourceId=c,s.vipButtonSourceName=u.sourceName,s.vipButtonSourceSign=u.sourceSign}var d={};"none"!==e.autoPromotion&&(d.autodata=e.autoPromotion),d=JSON.stringify(d);var p,h=[],m=e.activityFloatWindow;m&&h.push({pluginId:m.pluginId,pluginType:m.pluginType}),e.hasSubTab&&e.tabList.length>0&&(p=e.tabList.map(function(e,t){return{subTabId:e.tabId,subSequence:t}}),p=JSON.stringify(p));var f={cornerIconName:e.cornerIconName,currentVersion:e.currentVersion,flagIsRecord:e.flagIsRecord,hasSubTab:e.hasSubTab,isTiming:e.isTiming,panelInfoList:t,pictureName:e.pictureName,releaseTime:e.releaseTime,systemDefault:e.systemDefault||0,systemPluginList:h,tabAppid:e.tabAppid,tabCategory:e.tabCategory,tabCnTitle:e.tabCnTitle,tabEnTitle:e.tabEnTitle,tabExtArr:s,tabId:e.tabId,tabJson:p,tabName:e.tabName,tabOnclick:e.tabOnclick,tabParams:d,tabParentType:e.tabParentType,tabResource:e.tabResource,tabStatus:e.tabStatus,tabTitleIcons:l,tabType:e.tabType,timeCycle:e.timeCycle};return f}),Object(ei["a"])(Cb,"setTabInfo",function(e){var t,a=JSON.parse(e.tabTitleIcons||"{}"),i=e.tabExtArr||e.tabExtArrEntity||{},n=JSON.parse(e.tabParams||"{}"),o=e.systemPluginList||[],r=o[0];r&&(t={pluginId:r.pluginId,pluginName:r.pluginName,pluginType:r.pluginType});var l=[];if(e.panelInfoList){var s=[];l=e.panelInfoList.map(function(e){return e.isDmpPanel?{type:"SPEC",isCollapse:!1,isShowAll:!1,crowdPanels:e.dmpPanelList.map(function(e){return this.$set(this.panelListIndexed,e.pannelGroupId,e),s.push(e),{id:e.pannelGroupId,isDuplicate:!1,activeIndex:0,dmpInfo:{crowdId:e.dmpCrowdId,policyId:e.dmpPolicyId,crowdName:e.dmpCrowdName,policyName:e.dmpPolicyName}}}.bind(this))}:(this.$set(this.panelListIndexed,e.pannelGroupId,e),s.push(e),{type:"NORMAL",isCollapse:!1,panel:{id:e.pannelGroupId,isDuplicate:!1,activeIndex:0,dmpInfo:void 0}})}.bind(this)),setTimeout(function(){s.forEach(this.loadPanelDetail.bind(this))}.bind(this),50)}this.tabInfo=Object.assign({},this.tabInfo,{tabId:e.tabId,currentVersion:e.currentVersion,tabParentType:e.tabParentType,tabType:e.tabType,hasSubTab:e.hasSubTab,flagIsBlockBg:i.flagIsBlockBg,tabName:e.tabName,tabCnTitle:e.tabCnTitle,tabEnTitle:e.tabEnTitle,tabCategory:e.tabCategory,tabAppid:e.tabAppid,tabResource:e.tabResource,iconTypeName:e.iconTypeName,pictureName:e.pictureName,tabStatus:e.tabStatus,tabOnclick:void 0,systemDefault:e.systemDefault,timeCycle:e.timeCycle,cornerIconName:e.cornerIconName,flagIsRecord:e.flagIsRecord,isTiming:e.isTiming,releaseTime:e.releaseTime,pannelList:l,tabList:e.tabList,alumbTabBg:i.alumbTabBg,alumbTabLongBg:i.alumbTabLongBg,isShowvip:i.isShowvip,pannelTitleColor:i.pannelTitleColor,blockTitleFocusColor:i.blockTitleFocusColor,blockTitleUnfocusColor:i.blockTitleUnfocusColor,sinkSize:i.sinkSize,autoPromotion:n.autodata||"none",activityFloatWindow:t,imgOnBlur:a.unfocus_img_url,imgOnFocus:a.focus_img_url,imgOnSelected:a.selected_img_url,vipButtonSourceId:i.vipButtonSourceId}),this.updateDuplicates()}),Object(ei["a"])(Cb,"upsertTabInfo",function(e){var t=this,a=this.parseTabInfo(e);this.$service.tabInfoUpsert(a,"操作成功").then(function(){t.$emit("upsert-end")})}),Object(ei["a"])(Cb,"fetchData",function(e){var t=this;this.$service.tabInfoGet({id:this.id,version:e}).then(function(e){t.setTabInfo(e)})}),Object(ei["a"])(Cb,"getVipButtonSourceItem",function(e){var t=this.vipEnumsData.find(function(t){return t.sourceId===e});return t||{}}),Object(ei["a"])(Cb,"getVipButtonSource",function(){var e=this,t=this.tabInfo.tabResource;this.$service.getVipButtonSource().then(function(t){e.vipEnumsData=t,e.vipEnums=t.map(function(e){return{value:e.sourceId,label:e.sourceName}})})}),Object(ei["a"])(Cb,"handleModeChange",function(e){"edit"!==e&&"copy"!==e&&"replicate"!==e||(this.isCollapseBase=!0)}),Cb),created:function(){var e=this.initMode;this.mode=e,this.$watch("mode",this.handleModeChange,{immediate:!0}),this.id&&this.fetchData(this.version),this.getVipButtonSource()}},Nv=Rv,Ev=(a("eaf8"),a("d7ff"),Object(Bn["a"])(Nv,gb,bb,!1,null,"13c17f22",null)),Ov=Ev.exports,Av={mixins:[zu],components:{PageWrapper:Mu,PageContentWrapper:qu,TabSelector:Hc,OrderableTable:fb,TabInfo:Ov,CrowdSelector:tp},data:function(){return{activePage:"tab_group_setter",resourceName:"版面管理",showCrowdSelector:!1,tabList:[],embedTab:void 0,activeTabIndex:void 0}},computed:{tabTableHeader:function(){var e=this,t=[{label:"版面ID",prop:"tabId",width:120},{label:"版面名称",render:function(t,a){var i=a.$index,n=a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handlePreviewTab(n,i)}}},n.tabName)}},{label:"TAB标题(中文)",prop:"tabCnTitle"},{label:"TAB标题(英文)",prop:"tabEnTitle"},{label:"默认版面",align:"center",width:100,render:function(t,a){var i=a.$index,n=a.row;return e.readonly?n.isDefaultTab?"是":"否":t("el-radio",{attrs:{title:n.dmpInfo?"若要设置该版面为默认版面，请先取消版面定向":""},props:{label:!!n.isDefaultTab,disabled:!!n.dmpInfo,value:!0},on:{input:function(t){e.handleSetDefaultTab(i)}}},"")}},{label:"人群",render:function(t,a){var i=a.$index,n=a.row;return e.readonly?n.dmpInfo&&n.dmpInfo.dmpCrowdName:n.dmpInfo?t("el-button",{attrs:{title:n.dmpInfo.dmpCrowdName},props:{type:"text"},on:{click:function(t){e.handleSelectCrowdStart(i)}}},n.dmpInfo.dmpCrowdName):void 0}}];return this.readonly||t.push({label:"操作",width:180,render:function(t,a){var i=a.$index,n=a.row,o=[t("el-button",{on:{click:function(){e.handleRemoveTab(i)}}},"删除")];return n.dmpInfo?o.unshift(t("el-button",{on:{click:function(){e.handleRemoveCrowd(i)}}},"取消定向")):o.unshift(t("el-button",{props:{disabled:n.isDefaultTab},on:{click:function(){e.handleSelectCrowdStart(i)}}},"选择人群")),o}}),t}},props:{tabs:{type:Array,default:function(){return[]}},readonly:{type:Boolean,default:function(){return!1}}},methods:{handleSave:function(){this.tabList.length>0?this.$emit("set-end",this.tabList):this.$message({type:"error",message:"请至少选择一个版面"})},handlePreviewTab:function(e,t){this.activePage="tab",this.embedTab={index:t,id:e.tabId,version:e.currentVersion,mode:"read"}},handleTabEmbedBack:function(){var e=this.embedTab,t=e.index,a=e.id,i=this.tabList[t];this.activePage="tab_group_setter",this.$service.tabInfoGet({id:a}).then(function(e){Object.assign(i,e)})},handleSetDefaultTab:function(e){var t=this;this.tabList.forEach(function(a,i){i===e?t.$set(a,"isDefaultTab",!0):t.$set(a,"isDefaultTab",!1)})},handleRemoveTab:function(e){this.tabList.splice(e,1)},handleSelectTabStart:function(){var e=this;this.$nextTick(function(){var t=e.$refs.tabSelector;e.tabList.forEach(t.handleTableRowSelectionAdd)})},handleSelectTabEnd:function(e){this.$refs.tabTable.handleAppendData(e,"tabId")},handleSelectCrowdStart:function(e){this.showCrowdSelector=!0,this.activeTabIndex=e},handleSelectCrowdCancel:function(){this.showCrowdSelector=!1},handleSelectCrowdEnd:function(e,t){var a=this.tabList,i=a.findIndex(function(a){var i=a.dmpInfo;if(i&&i.dmpPolicyId===e.value&&i.dmpCrowdId===t.value)return!0});if(-1===i){this.showCrowdSelector=!1;var n=this.tabList[this.activeTabIndex];this.$set(n,"dmpInfo",{dmpPolicyId:e.value,dmpCrowdId:t.value,dmpPolicyName:e.label,dmpCrowdName:t.label})}else this.$message({type:"error",message:"第"+(i+1)+"个版面已选择该人群"})},handleRemoveCrowd:function(e){var t=this.tabList;t[e].dmpInfo=void 0}},created:function(){this.tabList=Object(Ln["cloneDeep"])(this.tabs)}},Vv=Av,Mv=Object(Bn["a"])(Vv,sb,cb,!1,null,null,null),Bv=Mv.exports,Uv={mixins:[zu],components:{PageWrapper:Mu,PageContentWrapper:qu,CommonContent:Us,TabSelector:Hc,InputOrder:lb,HomePageTabGroupSetter:Bv,OrderableTable:fb,TabInfo:Ov},data:function(){return{mode:"create",resourceName:"首页方案",activePage:"homepage",showTabGroupSetter:!1,showCrowdSelector:!1,showAuditDialog:!1,embedTab:void 0,selectedTabList:[],selectedTabListIndexed:{},activeTabGroupIndex:void 0,auditHistories:[],auditForm:{auditFlag:4,auditDesc:""},urls:{preview:"/homepageInfo/preview.html",edit:"/homepageInfo/edit.html",tools:"/buttonManage/getAuditDetailButton.html",edit_history_view:"/homepageInfo/editHistory.html"},versionList:[],homepage:{homepageId:void 0,homepageName:void 0,homepageModel:"normal",homepageVersion:void 0,homepageStatus:void 0,currentVersion:void 0,defaultFocusIndex:void 0,tabInfos:[]},HOME_MODE_MAP:{normal:"普通模式",child:"儿童模式",old:"老人模式"},rules:{homepageName:[{required:!0,message:"请输入首页名称"}],homepageModel:[{required:!0,message:"请选择首页模式"}],homepageVersion:[{required:!0,message:"请输入首页版本号"}]}}},computed:{resourceInfo:function(){var e=this.homepage;if(e.homepageId)return{id:e.homepageId,type:"homepage",menuElId:"homepageInfo",version:e.currentVersion,status:e.homepageStatus}},tabGroupList:{get:function(){var e=this.homepage,t=e.defaultFocusIndex,a=e.tabInfos||[],i=[];return a.forEach(function(e){var t=e.findIndex(function(e){return e.isDefaultTab}),a={tabCount:e.length,canBeDefaultFocusTab:!1,tabList:e},n=e[t>-1?t:0];(t>-1||1===a.tabCount&&void 0===n.dmpInfo)&&(a.canBeDefaultFocusTab=!0),Object.assign(a,n),i.push(a)}),void 0===t||i[t].canBeDefaultFocusTab||(e.defaultFocusIndex=void 0),i},set:function(e){var t=this.homepage,a=t.tabInfos,i=a[t.defaultFocusIndex],n=e.map(function(e){return e.tabList});if(i){var o=n.findIndex(function(e){return e===i});t.defaultFocusIndex=o>-1?o:void 0}this.homepage.tabInfos=n}},tabGroupTableHeader:function(){var e=this,t=[{label:"版面ID",prop:"tabId"},{label:"版面名称",render:function(t,a){var i=a.$index,n=a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handleShowTabGroup(i)}}},n.tabName)}},{prop:"tabCnTitle",label:"TAB标题(中文)"},{prop:"tabEnTitle",label:"TAB标题(英文)"},{label:"默认落焦",align:"center",render:function(t,a){var i=a.$index,n=a.row,o=e.homepage.defaultFocusIndex;return"read"===e.mode?i===o?"是":"否":t("el-radio",{attrs:{title:n.canBeDefaultFocusTab?"":"只有普通版面或设了默认版面的定向版面组才能设为默认落焦"},props:{disabled:!n.canBeDefaultFocusTab,value:o,label:i},on:{input:function(t){e.homepage.defaultFocusIndex=t}}},"")}},{label:"版面数",prop:"tabCount",width:80},{label:"默认版面",render:function(e,t){t.$index;var a=t.row;return a.isDefaultTab?"有":"否"}}];return"read"!==this.mode&&t.push({label:"操作",width:80,render:function(t,a){var i=a.$index;a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handleRemoveTab(i)}}},"删除")}}),t}},props:["id","initMode","version"],methods:{handleShowTabGroup:function(e){this.activeTabGroupIndex=e,this.activePage="tab_group_setter"},handleSetTabGroupEnd:function(e){this.activePage="homepage",this.$set(this.homepage.tabInfos,this.activeTabGroupIndex,e)},handleSaveDraft:function(){var e=JSON.parse(JSON.stringify(this.homepage));e.homepageStatus=2,"replicate"===this.mode&&(e.currentVersion=void 0),this.submit(e)},handleSubmitAudit:function(){var e=JSON.parse(JSON.stringify(this.homepage));e.homepageStatus=3,"replicate"===this.mode&&(e.currentVersion=void 0),this.submit(e)},validate:function(e,t){this.$refs.homepageForm.validate(function(a){if(a){var i=e.tabInfos;if(3===e.homepageStatus){if(0===e.tabInfos.length)return t("请至少选择一个版面");if(void 0===e.defaultFocusIndex)return t("请选择默认落焦版面");for(var n={},o=0,r=i.length;o<r;o++){var l=i[o],s=void 0;if(1===l.length&&void 0===l[0].dmpInfo?(!0,s=l[0]):(!1,s=l.find(function(e){return e.isDefaultTab})),s){var c=n[s.tabId];if(void 0!==c)return t("第 "+(o+1)+" 个版面与第 "+(c+1)+" 个版面或默认版面重复");n[s.tabId]=o}}for(var u=0,d=i.length;u<d;u++){var p=i[u];if(1!==p.length||void 0!==p[0].dmpInfo)for(var h=0,m=p.length;h<m;h++){var f=n[p[h].tabId],g=p[h].dmpInfo||{};if(!p[h].isDefaultTab){if(void 0===g.dmpCrowdId)return t("请设置第 "+(u+1)+" 个组第 "+(h+1)+" 个版面的人群");if(void 0!==f)return t("第 "+(u+1)+" 个版面组里的第"+(h+1)+"个版面与第 "+(f+1)+" 个版面组的版面重复")}}}}t()}else t("请把表单填写完整")})},submit:function(e){this.validate(e,function(t){var a=this;t?this.$message({type:"error",message:t}):this.$service.homePageInfoSave(this.parseDataToApi(e),"保存成功").then(function(e){a.$emit("upsert-end")})}.bind(this))},parseApiToData:function(e){var t=JSON.parse(JSON.stringify(e)),a=t.tabInfos.findIndex(function(e){return 1===e.tabIsFocus});t.defaultFocusIndex=a>-1?a:void 0;var i=[];return(t.tabInfos||[]).forEach(function(e,t){var a=[];e.tabId&&a.push({tabId:e.tabId,tabName:e.tabName,tabCnTitle:e.tabCnTitle,tabEnTitle:e.tabEnTitle,currentVersion:e.currentVersion,isDefaultTab:!1}),e.dmpTabList&&e.dmpTabList.forEach(function(e){var t={isDefaultTab:!1,tabId:e.tabId,tabName:e.tabName,tabCnTitle:e.tabCnTitle,tabEnTitle:e.tabEnTitle,currentVersion:e.currentVersion};-1===e.dmpCrowdId?t.isDefaultTab=!0:void 0!==e.dmpCrowdId&&(t.dmpInfo={dmpPolicyId:e.dmpPolicyId,dmpPolicyName:e.dmpPolicyName,dmpCrowdName:e.dmpCrowdName,dmpCrowdId:e.dmpCrowdId}),a.push(t)}),i.push(a)}),t.tabInfos=i,t},parseDataToApi:function(e){var t=JSON.parse(JSON.stringify(e)),a=t.defaultFocusIndex,i=[];return t.tabInfos.forEach(function(e,t){var n={isDmpTab:0,tabIsFocus:t===a?1:0},o=[],r=0;e.length;e.forEach(function(a){if(void 0===a.dmpInfo&&1===e.length)n.tabId=a.tabId,n.tabSequence=t;else if(a.isDefaultTab)n.tabId=a.tabId,n.tabSequence=t;else{var i=a.dmpInfo||{};o.push({tabId:a.tabId,tabSequence:r++,dmpPolicyId:i.dmpPolicyId,dmpCrowdId:i.dmpCrowdId,dmpPolicyName:i.dmpPolicyName,dmpCrowdName:i.dmpCrowdName})}}),o.length>0&&(n.tabId&&(o.push({tabId:n.tabId,tabSequence:r++,dmpPolicyName:"不限",dmpCrowdName:"不限",dmpPolicyId:-1,dmpCrowdId:-1}),n.tabId=void 0),n.isDmpTab=1,n.dmpTabList=o),i.push(n)}),t.tabInfos=i,delete t.defaultFocusIndex,t},setHomepage:function(e){e=this.parseApiToData(e),Object.assign(this.homepage,e),this.selectedTabList=e.tabInfos.map(function(e){return{id:e.tabId,label:e.tabName,data:e}})},handleSelectTabEnd:function(e){var t=this.homepage.tabInfos;e.forEach(function(e){t.push([Object.assign({},e)])})},handleTabEmbedBack:function(){this.activePage="homepage"},handleCreateTab:function(){this.activePage="tab",this.embedTab={mode:"create"}},handleRemoveTab:function(e){var t=this.homepage,a=t.defaultFocusIndex;this.homepage.tabInfos.splice(e,1),t.defaultFocusIndex=e<a?a-1:e===a?void 0:a},handleCopy:function(e){var t=JSON.parse(JSON.stringify(this.homepage));t.homepageId=void 0,t.homepageStatus=e,t.currentVersion="",this.submit(t)},fetchData:function(e){var t=this;this.$service.homePageGetDetail({id:this.id,version:e}).then(function(e){t.setHomepage(e)})}},created:function(){this.mode=this.initMode||"create",this.id&&this.fetchData(this.version)}},jv=Uv,Gv=(a("eeee"),Object(Bn["a"])(jv,eb,tb,!1,null,"4dba1394",null)),Wv=Gv.exports,qv=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PageWrapper",[a("PageContentWrapper",{directives:[{name:"show",rawName:"v-show",value:"homepage_list"==e.activePage,expression:"activePage == 'homepage_list'"}]},[a("ContentCard",{staticClass:"content",attrs:{refs:"contentCard"}},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"homepage"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}}),a("el-dialog",{attrs:{title:"机型机芯",visible:e.showChipDialog},on:{"update:visible":function(t){e.showChipDialog=t}}},[a("div",{staticClass:"tag-list tag-list__chip"},e._l(e.chips,function(t,i){return a("span",{key:i,staticClass:"tag-item"},[e._v("\n                "+e._s(t)+"\n            ")])}),0)]),a("el-dialog",{attrs:{title:"关联策略",visible:e.showPolicyNameDialog},on:{"update:visible":function(t){e.showPolicyNameDialog=t}}},[a("div",{staticClass:"tag-list tag-list__policy-name"},e._l(e.policyNames,function(t,i){return a("span",{key:i,staticClass:"tag-item",on:{click:function(a){return e.handleShowPolicy(t)}}},[e._v("\n                "+e._s(t)+"\n            ")])}),0)])],1)],1)],1),"policy"==e.activePage?a("PageContentWrapper",[a("Policy",{attrs:{"init-mode":"read",id:e.policyId},on:{"upsert-end":e.handleShowPolicyEnd,"go-back":e.handleShowPolicyEnd}})],1):e._e()],1)},Hv=[],zv=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PageWrapper",{staticClass:"policy-info-wrapper"},[a("PageContentWrapper",{directives:[{name:"show",rawName:"v-show",value:"policy_info"===e.activePage,expression:"activePage === 'policy_info'"}]},[a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("CommonContent",{attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{replicate:function(t){e.mode="replicate",e.title="创建副本"},edit:function(t){e.mode="edit",e.title="编辑"},unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,"submit-audit":function(t){return e.submitBtn(3)},"save-draft":function(t){return e.submitBtn(2)},audit:function(t){return e.$emit("upsert-end")},"select-version":e.fetchData,delete:function(t){return e.$emit("upsert-end",t)}}},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),"read"!==e.mode?a("div",[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:24}},[a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{model:e.form,rules:e.formRules,"label-width":"160px"}},[a("el-form-item",{attrs:{label:"策略名称",prop:"policyName"}},[a("el-input",{attrs:{placeholder:"策略名称"},model:{value:e.form.policyName,callback:function(t){e.$set(e.form,"policyName",t)},expression:"form.policyName"}})],1),a("el-form-item",{attrs:{label:"机型机芯",prop:"chipModel"}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.selectChipModel}},[e._v("选择机型机芯")]),e.form.deviceInfos.length>0?a("SelectedTag",[a("ul",e._l(e.form.deviceInfos,function(t,i){return a("li",{key:i},[a("el-tag",{attrs:{type:"success",closable:""},on:{close:function(a){return e.modelChipSelectedRemove(t)}}},[e._v(e._s(t.model)+"_"+e._s(t.chip))])],1)}),0)]):e._e()],1),a("el-form-item",{staticClass:"linkwork",attrs:{label:"首页版本号",required:""}},[a("el-col",{staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:11}},[a("el-form-item",{attrs:{prop:"homePageVerStart"}},[a("el-input-number",{attrs:{min:0,max:9999999},model:{value:e.form.homePageVerStart,callback:function(t){e.$set(e.form,"homePageVerStart",t)},expression:"form.homePageVerStart"}})],1)],1),a("el-col",{staticClass:"line",staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:2}},[e._v("-")]),a("el-col",{staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:11}},[a("el-form-item",{attrs:{prop:"homePageVerEnd"}},[a("el-input-number",{attrs:{min:0,max:9999999},model:{value:e.form.homePageVerEnd,callback:function(t){e.$set(e.form,"homePageVerEnd",t)},expression:"form.homePageVerEnd"}})],1)],1)],1),a("el-form-item",{staticClass:"linkwork",attrs:{label:"Mac地址"}},[a("el-col",{staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:11}},[a("el-form-item",{attrs:{prop:"macStart"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"Mac地址起始"},model:{value:e.form.macStart,callback:function(t){e.$set(e.form,"macStart",t)},expression:"form.macStart"}})],1)],1),a("el-col",{staticClass:"line",staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:2}},[e._v("-")]),a("el-col",{staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:11}},[a("el-form-item",{attrs:{prop:"macEnd"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"Mac地址结尾"},model:{value:e.form.macEnd,callback:function(t){e.$set(e.form,"macEnd",t)},expression:"form.macEnd"}})],1)],1)],1),a("el-form-item",{attrs:{label:"策略优先级",prop:"priority"}},[a("el-input-number",{attrs:{placeholder:"策略优先级",min:1,max:9999},model:{value:e.form.priority,callback:function(t){e.$set(e.form,"priority",t)},expression:"form.priority"}}),a("span",{staticClass:"tip"},[e._v("注：数值越大优先级越高，数值越小优先级越低")])],1),a("el-form-item",{attrs:{label:"关联首页方案"}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.selectHomePageModel("normal")}}},[e._v("选择标准模式首页")]),"undefined"!==typeof e.form.homepageInfoListObj["normal"]?a("span",{staticClass:"tip"},[e._v("\n                  已选首页：\n                  "),a("el-tag",{staticClass:"el-tag",attrs:{type:"success"},nativeOn:{click:function(t){return e.showHomePageDetail("normal")}}},[e._v(e._s(e.form.homepageInfoListObj["normal"].homepageName))])],1):e._e()],1),a("el-form-item",{attrs:{label:"关联首页方案"}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.selectHomePageModel("child")}}},[e._v("选择儿童模式首页")]),"undefined"!==typeof e.form.homepageInfoListObj["child"]?a("span",{staticClass:"tip"},[e._v("\n                  已选首页：\n                  "),a("el-tag",{staticClass:"el-tag",attrs:{type:"success"},nativeOn:{click:function(t){return e.showHomePageDetail("child")}}},[e._v(e._s(e.form.homepageInfoListObj["child"].homepageName))])],1):e._e()],1),a("el-form-item",{attrs:{label:"定向首页方案"}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.addHomePage("normal")}}},[e._v("添加标准模式")]),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.addHomePage("child")}}},[e._v("添加儿童模式")]),a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.cancel}},[e._v("解绑所有方案")]),e.form.specialNormalHp.length>0?a("SelectedHomePage",{attrs:{dataArr:e.form.specialNormalHp,title:"标准模式",mode:e.mode},on:{"edit-item":e.editHomePage,"remove-item":e.removeHomePage}}):e._e(),e.form.specialChildHp.length>0?a("SelectedHomePage",{attrs:{dataArr:e.form.specialChildHp,mode:e.mode,title:"儿童模式"},on:{"edit-item":e.editHomePage,"remove-item":e.removeHomePage}}):e._e()],1)],1)],1)],1)],1):e._e(),"read"===e.mode?a("div",[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:24}},[a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{model:e.form,"label-width":"160px"}},[a("el-form-item",{attrs:{label:"策略名称",prop:"policyName"}},[e._v(e._s(e.form.policyName))]),a("el-form-item",{attrs:{label:"机型机芯",prop:"chipModel"}},[e.form.deviceInfos.length>0?a("SelectedTag",[a("ul",e._l(e.form.deviceInfos,function(t,i){return a("li",{key:i},[a("el-tag",{attrs:{type:"success"}},[e._v(e._s(t.model)+"_"+e._s(t.chip))])],1)}),0)]):e._e()],1),a("el-form-item",{staticClass:"linkwork",attrs:{label:"首页版本号",required:""}},[a("el-col",{staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:11}},[a("el-form-item",{attrs:{prop:"homePageVerStart"}},[a("el-input-number",{attrs:{disabled:"disabled",min:0,max:9999999},model:{value:e.form.homePageVerStart,callback:function(t){e.$set(e.form,"homePageVerStart",t)},expression:"form.homePageVerStart"}})],1)],1),a("el-col",{staticClass:"line",staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:2}},[e._v("-")]),a("el-col",{staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:11}},[a("el-form-item",{attrs:{prop:"homePageVerEnd"}},[a("el-input-number",{attrs:{disabled:"disabled",min:0,max:9999999},model:{value:e.form.homePageVerEnd,callback:function(t){e.$set(e.form,"homePageVerEnd",t)},expression:"form.homePageVerEnd"}})],1)],1)],1),a("el-form-item",{staticClass:"linkwork",attrs:{label:"Mac地址",required:""}},[a("el-col",{staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:11}},[a("el-form-item",{attrs:{prop:"macStart"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"Mac地址起始",disabled:"disabled"},model:{value:e.form.macStart,callback:function(t){e.$set(e.form,"macStart",t)},expression:"form.macStart"}})],1)],1),a("el-col",{staticClass:"line",staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:2}},[e._v("-")]),a("el-col",{staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:11}},[a("el-form-item",{attrs:{prop:"macEnd"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"Mac地址起始",disabled:"disabled"},model:{value:e.form.macEnd,callback:function(t){e.$set(e.form,"macEnd",t)},expression:"form.macEnd"}})],1)],1)],1),a("el-form-item",{attrs:{label:"策略优先级",prop:"priority"}},[e._v("\n                "+e._s(e.form.priority)+"\n                "),a("span",{staticClass:"tip"},[e._v("注：数值越大优先级越高，数值越小优先级越低")])]),a("el-form-item",{attrs:{label:"关联首页方案(标准)"}},["undefined"!==typeof e.form.homepageInfoListObj["normal"]?a("span",{staticClass:"tip"},[a("el-tag",{staticClass:"el-tag",attrs:{type:"success"},nativeOn:{click:function(t){return e.showHomePageDetail("normal")}}},[e._v(e._s(e.form.homepageInfoListObj["normal"].homepageName))])],1):e._e()]),a("el-form-item",{attrs:{label:"关联首页方案(儿童)"}},["undefined"!==typeof e.form.homepageInfoListObj["child"]?a("span",{staticClass:"tip"},[a("el-tag",{staticClass:"el-tag",attrs:{type:"success"},nativeOn:{click:function(t){return e.showHomePageDetail("child")}}},[e._v(e._s(e.form.homepageInfoListObj["child"].homepageName))])],1):e._e()]),a("el-form-item",{attrs:{label:"定向首页方案"}},[e.form.specialNormalHp.length>0?a("SelectedHomePage",{attrs:{dataArr:e.form.specialNormalHp,mode:e.mode,title:"标准模式"},on:{"edit-item":e.editHomePage,"remove-item":e.removeHomePage}}):e._e(),e.form.specialChildHp.length>0?a("SelectedHomePage",{attrs:{dataArr:e.form.specialChildHp,mode:e.mode,title:"儿童模式"},on:{"edit-item":e.editHomePage,"remove-item":e.removeHomePage}}):e._e()],1)],1)],1)],1)],1):e._e()]),a("el-dialog",{attrs:{dialogTitle:e.dialogTitle,visible:e.dialogVisible,width:"80%"},on:{"update:visible":function(t){e.dialogVisible=t}}},["modelChip"===e.mode?a("ChipModel",{ref:"chipModelSelected",attrs:{selectionType:e.selectionType},on:{"row-click":e.ChipModelRowClick}}):e._e(),e.selectHomePageDialogVisible?a("HomePageModel",{attrs:{homepageModel:e.mode,homepageResource:e.platform,homepageStatusArray:"4"},on:{"row-click":e.rowClick,"row-selection-change":e.rowClick}}):e._e(),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1,e.mode=""}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.dialogSubmit}},[e._v("确 定")])],1)],1),e.addHomePageDialogVisible?a("PolicyManageAddHomePage",{attrs:{itemType:e.mode,"selected-crowds":e.selectedCrowds,editHomePageData:e.editHomePageData},on:{"add-home-page-close":e.addHomePageClose,"create-home-page":e.createHomePage}}):e._e()],1)],1),"showHomePageDetail"===e.activePage?a("PageContentWrapper",[a("HomePageInfo",{attrs:{id:e.homePageId,"init-mode":"read",version:e.homePageVersion,"title-prefix":e.title},on:{"upsert-end":function(t){e.activePage="policy_info"},"go-back":function(t){e.activePage="policy_info"}}})],1):e._e()],1)},Jv=[],Kv=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{pagination:e.pagination},on:{"filter-change":e.fetchData,"filter-reset":e.handleFilterReset}},[a("el-form",{staticClass:"search searchForm",attrs:{inline:!0,model:e.formSearch}},[a("el-form-item",[a("el-select",{attrs:{placeholder:"内容源"},on:{change:e.changePlatform},model:{value:e.formSearch.platform,callback:function(t){e.$set(e.formSearch,"platform",t)},expression:"formSearch.platform"}},[a("el-option",{attrs:{label:"爱奇艺",value:"yinhe"}}),a("el-option",{attrs:{label:"腾讯",value:"tencent"}}),a("el-option",{attrs:{label:"优朋",value:"voole"}}),a("el-option",{attrs:{label:"优酷",value:"youku"}})],1)],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"机型"},model:{value:e.formSearch.model,callback:function(t){e.$set(e.formSearch,"model",t)},expression:"formSearch.model"}},[e._v(">")])],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"机芯"},model:{value:e.formSearch.chip,callback:function(t){e.$set(e.formSearch,"chip",t)},expression:"formSearch.chip"}},[e._v(">")])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleFilterReset}},[e._v("重置")])],1)],1),a("el-collapse",[a("el-collapse-item",{attrs:{title:"新增"}},[a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{model:e.form,rules:e.formRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"内容源",prop:"platform"}},[a("el-select",{attrs:{placeholder:"内容源"},model:{value:e.form.platform,callback:function(t){e.$set(e.form,"platform",t)},expression:"form.platform"}},[a("el-option",{attrs:{label:"爱奇艺",value:"yinhe"}}),a("el-option",{attrs:{label:"腾讯",value:"tencent"}}),a("el-option",{attrs:{label:"优朋",value:"voole"}}),a("el-option",{attrs:{label:"优酷",value:"youku"}})],1)],1),a("el-form-item",{attrs:{label:"机型",prop:"model"}},[a("el-input",{attrs:{placeholder:"机型"},model:{value:e.form.model,callback:function(t){e.$set(e.form,"model",t)},expression:"form.model"}},[e._v(">")])],1),a("el-form-item",{attrs:{label:"机芯",prop:"chip"}},[a("el-input",{attrs:{placeholder:"机芯"},model:{value:e.form.chip,callback:function(t){e.$set(e.form,"chip",t)},expression:"form.chip"}},[e._v(">")])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.addModelChip}},[e._v("添加")])],1)],1)],1),a("el-collapse-item",{attrs:{title:"选中的机型机芯"}},[a("SelectedTag",[a("ul",e._l(e.selected,function(t){return a("li",{key:t.devParId},[a("el-tag",{attrs:{type:"success",closable:""},on:{close:function(a){return e.handleRowSelectionRemove(t)}}},[e._v(e._s(t.model)+"_"+e._s(t.chip))])],1)}),0)])],1)],1),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType},on:{"row-click":e.rowClick,"row-selection-change":e.rowClick,"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},Qv=[],Xv=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"selectedItem",style:{maxHeight:e.maxHeight}},[e._t("default")],2)},Yv=[],Zv={props:{maxHeight:String},data:function(){return{}}},ey=Zv,ty=(a("4bad"),Object(Bn["a"])(ey,Xv,Yv,!1,null,"beda78a6",null)),ay=ty.exports,iy={props:{selectionType:{type:String,default:function(){return"multiple"}}},components:{ActionList:Dn["ActionList"],Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"],SelectedTag:ay},data:function(){var e=this;return{platform:"tencent",form:{platform:null,model:null,chip:null},formRules:{platform:[{required:!0,message:"请选择",trigger:"blur"}],model:[{required:!0,message:"请输入机型",trigger:"blur"}],chip:[{required:!0,message:"请输入机芯",trigger:"blur"}]},formSearch:this.genDefaultFilter(),filter:this.genDefaultFilter(),pagination:{pageSize:5},selected:[],table:{props:{},header:[{label:"ID",prop:"devParId"},{label:"内容源",prop:"platform",render:function(t,a){var i=a.row;return e.$platform(i.platform)}},{label:"机芯",prop:"chip"},{label:"机型",prop:"model"}],data:[],selected:[],selectionType:this.selectionType}}},methods:{genDefaultFilter:function(){return{platform:"tencent",chip:void 0,model:void 0}},rowClick:function(e){this.$emit("row-click",e)},changePlatform:function(e){window.confirm("是否要切换内容源，切换内容源之后，首页方案数据将会清除掉")?(this.platform=e,this.fetchData()):this.formSearch.platform=this.platform},addModelChip:function(){var e=this;this.$refs.form.validate(function(t){t&&e.$service.addChipAndModel(e.form,"添加成功").then(function(t){e.fetchData()})})},handleRowSelectionAdd:function(e){this.selected.push(e),this.updateTableSelected()},handleRowSelectionRemove:function(e){this.selected=this.selected.filter(function(t){return t.devParId!==e.devParId}),this.updateTableSelected()},handleAllRowSelectionChange:function(e){var t=this;e?this.table.data.forEach(this.handleRowSelectionAdd):(this.unselectedIds=this.table.data.map(function(e){return e.devParId}),this.selected=this.selected.filter(function(e){if(t.unselectedIds.indexOf(e.devParId)<0)return e}),this.table.selected=[])},handleAllRowSelectionRemove:function(){this.selected=[],this.table.selected=[]},updateTableSelected:function(){var e=this.table,t=this.selected.map(function(e){return e.devParId});e.selected=e.data.reduce(function(e,a,i){return t.indexOf(a.devParId)>-1&&e.push(i),e},[])},handleFilterChange:function(){this.filter=Object(j["a"])({},this.formSearch),this.pagination.currentPage=1,this.fetchData()},handleFilterReset:function(){this.filter=this.genDefaultFilter(),this.formSearch=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.getChipAndModelPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){this.fetchData()}},ny=iy,oy=(a("97e2"),Object(Bn["a"])(ny,Kv,Qv,!1,null,"65bed422",null)),ry=oy.exports,ly=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType},on:{"row-click":e.rowClick,"row-selection-change":e.rowClick}})],1)],1)},sy=[],cy={components:{Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"],ContentEllipsis:Dn["ContentEllipsis"]},props:{homepageModel:String,homepageResource:String,homepageStatusArray:String},data:function(){return{filter:{sort:void 0,order:void 0},filterSchema:null,pagination:{pageSize:5},selected:[],table:{props:{},header:[{label:"ID",prop:"homepageId",width:"100"},{label:"名称",width:"130",prop:"homepageName",sortable:!0},{label:"关联版面名称",prop:"relationTabName",render:function(e,t){var a=t.row,i=a.relationTabName;return i.length>40&&(i=i.substring(0,40)+"..."),e("div",{attrs:{title:a.relationTabName}},i)}},{label:"首页模式",prop:"homepageModel",render:function(e,t){var a=t.row;return"child"===a.homepageModel?"儿童模式":"标准模式"}},{label:"更新时间",prop:"lastUpdateDate",width:150,sortable:!0}],data:[],selected:[],selectionType:"single"}}},watch:{homepageModel:function(){this.fetchData()}},methods:{rowClick:function(e){this.$emit("row-click",e)},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.homepageId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();t.homepageModel=this.homepageModel,t.homepageResource=this.homepageResource,t.homepageStatusArray=this.homepageStatusArray,this.$service.getHomePageModelPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=co.a.map({homepageId:co.a.o.string.other("form",{component:"Input",placeholder:"ID"}),homepageName:co.a.o.string.other("form",{component:"Input",placeholder:"名称"})}).other("form",{cols:{item:6,label:0,wrapper:22},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},uy=cy,dy=Object(Bn["a"])(uy,ly,sy,!1,null,null,null),py=dy.exports,hy=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:"添加定向首页方案",visible:e.dialogVisible,width:"80%","before-close":e.addHomePageClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{attrs:{"label-width":"120px"}},[a("el-form-item",{attrs:{label:"模式"}},[e._v(e._s("normal"===e.itemType?"标准模式":"儿童模式"))]),a("el-form-item",{attrs:{label:"人群"}},[a("el-button",{on:{click:e.handleSelectCrowdStart}},[e._v("选择人群")]),a("span",{directives:[{name:"show",rawName:"v-show",value:e.form.attribute&&e.form.attribute.crowdIds,expression:"form.attribute && form.attribute.crowdIds"}],staticClass:"marginL"},[e._v("已选择: "+e._s(e.form.attribute.crowdName)+"\n       ")])],1),a("el-form-item",{attrs:{label:"首页方案"}},[a("el-button",{on:{click:function(t){return e.handleSelectHomePageStart()}}},[e._v("选择首页")]),a("span",{directives:[{name:"show",rawName:"v-show",value:e.form.homepageName,expression:"form.homepageName"}],staticClass:"marginL"},[e._v("已选择: "+e._s(e.form.homepageName))])],1),a("el-form-item",{attrs:{label:"AB测试"}},[a("el-switch",{attrs:{"on-text":"开启","off-text":"关闭"},model:{value:e.form.useABTest,callback:function(t){e.$set(e.form,"useABTest",t)},expression:"form.useABTest"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.form.useABTest,expression:"form.useABTest"}],attrs:{label:"测试组"}},[e._l(e.form.testHomeList,function(t,i){return a("el-form",{key:i,staticClass:"test-group",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"编号"}},[a("el-select",{model:{value:t.distributeModel,callback:function(a){e.$set(t,"distributeModel",a)},expression:"testItem.distributeModel"}},[a("el-option",{attrs:{label:"A",value:"A"}}),a("el-option",{attrs:{label:"B",value:"B"}}),a("el-option",{attrs:{label:"C",value:"C"}}),a("el-option",{attrs:{label:"D",value:"D"}})],1)],1),a("el-form-item",{attrs:{label:"首页方案"}},[a("el-button",{on:{click:function(a){return e.handleSelectHomePageStart(t)}}},[e._v("选择首页")]),a("span",{directives:[{name:"show",rawName:"v-show",value:t.homepageName,expression:"testItem.homepageName"}],staticClass:"marginL"},[e._v("已选择: "+e._s(t.homepageName))])],1),a("el-button",{staticClass:"test-group__remove",attrs:{type:"text"},on:{click:function(a){return e.handleRemoveTestItem(t)}}},[a("i",{staticClass:"el-icon-close"})])],1)}),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.form.testHomeList&&e.form.testHomeList.length<4,expression:"form.testHomeList && form.testHomeList.length < 4"}],attrs:{type:"primary"},on:{click:e.handleAddTestItem}},[e._v("添加组")])],2)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.addHomePageClose}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.addHomePageSubmit}},[e._v("确 定")])],1)],1),e.showSelectCrowdDialog?a("CrowdSelector",{on:{"select-cancel":e.handleSelectCrowdCancel,"select-end":e.handleSelectCrowdEnd}}):e._e(),a("el-dialog",{attrs:{title:"选择首页",visible:e.showHomePageDialogVisible,width:"80%","append-to-body":""},on:{"update:visible":function(t){e.showHomePageDialogVisible=t}}},[a("HomePageModel",{attrs:{homepageModel:e.itemType},on:{"row-click":e.rowClick}})],1)],1)},my=[],fy={components:{CrowdSelector:tp,HomePageModel:py},props:{itemType:String,editHomePageData:Object,selectedCrowds:Array},watch:{"form.useABTest":"handleToggleABTest"},data:function(){return{form:{},dialogVisible:!0,showSelectCrowdDialog:!1,showHomePageDialogVisible:!1,specialNormalHp:[],specialChildHp:[],crowdsIndexed:{},useABTestHomePage:void 0,activeItem:void 0,activeGroup:void 0}},methods:{addHomePageClose:function(){this.$emit("add-home-page-close")},addHomePageSubmit:function(){var e=this.form,t=e.attribute.crowdIds;if(!t||0===t.length)return this.$message("请选择人群");if(!e.homepageId)return this.$message("请选择首页");if(e.useABTest){for(var a,i,n,o,r,l=e.testHomeList,s=[],c=[],u=0,d=l.length;u<d;u++){r=l[u];var p=r.distributeModel,h=r.homepageId;if(s.indexOf(p)>-1){n=p;break}if(!p){a=u;break}if(s.push(p),c.indexOf(h)>-1){o=r.homepageName;break}if(!h){i=p;break}c.push(h)}if(void 0!==a)return this.$message("请选择第"+(a+1)+"测试组的编号");if(i)return this.$message("请选择测试组"+i+"的首页");if(o)return this.$message("测试组含有重复首页: "+o);if(n)return this.$message("含有重复测试组编号: "+n)}e.testHomeList=e.useABTest?e.testHomeList:[],"{}"!==JSON.stringify(this.editHomePageData)?this.$emit("create-home-page",this.form,!0):this.$emit("create-home-page",this.form,!1)},rowClick:function(e){void 0!==this.useABTestHomePage?(this.useABTestHomePage.homepageId=e.homepageId,this.useABTestHomePage.homepageStatus=e.homepageStatus,this.useABTestHomePage.homepageName=e.homepageName):(this.form.homepageId=e.homepageId,this.form.homepageVersion=e.homepageVersion,this.form.homepageStatus=e.homepageStatus,this.form.homepageName=e.homepageName),this.showHomePageDialogVisible=!1},handleSelectCrowdStart:function(){var e=JSON.parse(JSON.stringify(this.form.attribute||{}));this.selectedPolicyIds=e.crowdPolicyIds||[],this.selectedCrowdIds=e.crowdIds||[],this.showSelectCrowdDialog=!0},handleSelectHomePageStart:function(e){this.useABTestHomePage=e,this.showHomePageDialogVisible=!0},handleSelectCrowdCancel:function(){},handleSelectCrowdEnd:function(e,t){this.isContainCrowdName(t.value)?this.$message({type:"error",message:"已经存在相同的人群"}):(this.$set(this.crowdsIndexed,t.value,t),this.form.attribute={crowdIds:[t.value],crowdName:t.label,crowdPolicyName:e.label,crowdPolicyIds:[e.value]},this.showSelectCrowdDialog=!1)},isContainCrowdName:function(e){return this.selectedCrowds.some(function(t){return t.attribute.crowdIds[0]===e})},getSelectedCrowdNames:function(e){console.log(e);var t=e.attribute||{},a=this.crowdsIndexed,i=t.crowdIds;if(i)return i.map(function(e){return a[e]?a[e].label:"加载中..."})},handleRemoveTestItem:function(e){var t=this.form.testHomeList;t.splice(t.indexOf(e),1)},handleAddTestItem:function(){this.form.testHomeList.push(this.getInitTestItem())},getInitTestItem:function(){return{distributeModel:void 0,homepageId:void 0,homepageName:void 0,homepageStatus:void 0}},handleToggleABTest:function(e){e&&0===this.form.testHomeList.length&&this.handleAddTestItem()},getInitSpecialNormal:function(){return{homepageId:void 0,homepageVersion:"",homepageModel:"normal",homepageStatus:void 0,distributeModel:"default",attribute:{},useABTest:!1,testHomeList:[]}},getInitSpecialChild:function(){return{homepageId:void 0,homepageVersion:"",homepageModel:"child",homepageStatus:void 0,distributeModel:"default",attribute:{},useABTest:!1,testHomeList:[]}}},created:function(){this.form="child"===this.itemType?this.getInitSpecialChild():this.getInitSpecialNormal(),"{}"!==JSON.stringify(this.editHomePageData)&&(this.form=this.editHomePageData)}},gy=fy,by=(a("252f"),Object(Bn["a"])(gy,hy,my,!1,null,"76bd7f5e",null)),vy=by.exports,yy=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h4",[e._v(e._s(e.title))]),a("section",{staticClass:"content"},e._l(e.dataArr,function(t,i){return a("div",{key:i,staticClass:"homePageView"},[a("el-form",{attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"人群"}},[a("el-tag",{attrs:{type:"success",size:"medium"}},[e._v("\n           "+e._s(t.attribute.crowdName)+"\n          ")])],1),a("el-form-item",{attrs:{label:"首页方案"}},[a("el-tag",{attrs:{type:"success",size:"medium"}},[e._v(e._s(t.homepageName))])],1),t.testHomeList.length>0?a("el-form-item",{attrs:{label:"AB测试"}},[a("el-table",{attrs:{data:t.testHomeList,border:""}},[a("el-table-column",{attrs:{prop:"distributeModel",label:"编号"}}),a("el-table-column",{attrs:{prop:"homepageName",label:"首页方案"}})],1)],1):e._e()],1),"read"!==e.mode?a("div",{staticClass:"homePageView__action"},[a("i",{staticClass:"el-icon-edit",on:{click:function(a){return e.edit(t.homepageModel,i)}}}),a("i",{staticClass:"el-icon-close",on:{click:function(a){return e.remove(t.homepageModel,i)}}})]):e._e()],1)}),0)])},wy=[],Iy={props:{dataArr:Array,title:String,mode:String},data:function(){return{}},methods:{edit:function(e,t){this.$emit("edit-item",e,t)},remove:function(e,t){this.$emit("remove-item",e,t)}}},Cy=Iy,Ty=(a("d5ab"),Object(Bn["a"])(Cy,yy,wy,!1,null,"3902359c",null)),Sy=Ty.exports,ky={mixins:[zu],components:{ChipModel:ry,SelectedTag:ay,HomePageModel:py,PolicyManageAddHomePage:vy,SelectedHomePage:Sy,CommonContent:Us,HomePageInfo:Wv,PageWrapper:Mu,PageContentWrapper:qu},props:["id","initMode","version"],data:function(){var e;return e={homePageId:void 0,homePageVersion:void 0,homePageReadDialogVisible:!1,activePage:"policy_info",mode:void 0,resourceName:"策略管理",selectionType:"multiple",dialogTitle:null},Object(ei["a"])(e,"mode","normal"),Object(ei["a"])(e,"dialogVisible",!1),Object(ei["a"])(e,"selectHomePageDialogVisible",!1),Object(ei["a"])(e,"addHomePageDialogVisible",!1),Object(ei["a"])(e,"platform","tencent"),Object(ei["a"])(e,"selectedCrowds",[]),Object(ei["a"])(e,"editHomePageData",{}),Object(ei["a"])(e,"editHomePageIndex",void 0),Object(ei["a"])(e,"form",{policyId:null,policyName:null,macStart:"000000000000",macEnd:"ffffffffffff",homePageVerEnd:"9999999",homePageVerStart:"",priority:null,policyStatus:3,deviceInfos:[],homepageInfoList:[],homepageInfoListObj:{},schemeFilterEntity:{partner:"tencent"},regionCityPairs:[],specialNormalHp:[],specialChildHp:[]}),Object(ei["a"])(e,"formRules",{policyName:[{required:!0,message:"请输入策略名称",trigger:"blur"}],macStart:[{validator:this.$checkMacType,message:"请输入12位以字母数字组成的MAC地址",trigger:"blur"}],macEnd:[{validator:this.$checkMacType,message:"请输入12位以字母数字组成的MAC地址",trigger:"blur"}],homePageVerStart:[{required:!0,message:"请输入首页版本起始值",trigger:"blur"}],homePageVerEnd:[{required:!0,message:"请输入首页版本结束值",trigger:"blur"}]}),e},watch:{platform:function(e){this.form.homepageInfoList=[],this.form.homepageInfoListObj={},this.form.specialNormalHp=[],this.form.specialChildHp=[],this.form.schemeFilterEntity.partner=e}},computed:{resourceInfo:function(){var e=this.form;if(e.policyId)return{id:e.policyId,type:"policy",menuElId:"policyConf",version:e.currentVersion,status:e.policyStatus}}},methods:{showHomePageDetail:function(e){this.homePageId=this.form.homepageInfoListObj[e].homepageId,this.homePageVersion=this.form.homepageInfoListObj[e].currentVersion,this.activePage="showHomePageDetail"},ChipModelRowClick:function(e){this.dialogVisible=!1,this.form.deviceInfos=[{chip:e.chip,model:e.model}]},cancel:function(){this.form.specialNormalHp=[],this.form.specialChildHp=[]},rowClick:function(e){this.dialogVisible=!1,this.form.homepageInfoListObj[this.mode]={homepageId:e.homepageId,homepageModel:e.homepageModel,homepageName:e.homepageName,homepageVersion:e.homepageVersion}},addHomePageClose:function(){this.addHomePageDialogVisible=!1},editHomePage:function(e,t){this.addHomePageDialogVisible=!0,this.mode=e,this.editHomePageIndex=t,"normal"===e?(this.selectedCrowds=this.form.specialNormalHp,this.editHomePageData=this.form.specialNormalHp[t]):(this.selectedCrowds=this.form.specialChildHp,this.editHomePageData=this.form.specialChildHp[t])},removeHomePage:function(e,t){this.editHomePageData="normal"===e?this.form.specialNormalHp.splice(t,1):this.form.specialChildHp.splice(t,1)},createHomePage:function(e,t){var a=this,i=e.attribute.crowdPolicyIds[0],n=e.attribute.crowdIds[0];this.$service.getTaglist({id:i,type:"crowd"}).then(function(i){for(var o=0;o<i.length;o++)if(i[o].value===n){e.attribute.crowdName=i[o].label;break}"normal"===a.mode?t?a.form.specialNormalHp[a.editHomePageIndex]=e:a.isContainCrowdName(a.form.specialNormalHp,n)?a.$message({type:"error",message:"已经存在相同的人群"}):a.form.specialNormalHp.push(e):t?a.form.specialChildHp[a.editHomePageIndex]=e:a.isContainCrowdName(a.form.specialChildHp,n)?a.$message({type:"error",message:"已经存在相同的人群"}):a.form.specialChildHp.push(e)}),this.addHomePageDialogVisible=!1},isContainCrowdName:function(e,t){return e.some(function(e){return e.attribute.crowdIds[0]===t})},getCrowdNames:function(e){var t=this,a=e.map(function(e){var a=e.attribute.crowdPolicyIds[0],i=e.attribute.crowdIds[0];return t.$service.getTaglist({id:a,type:"crowd"}).then(function(a){for(var n=0;n<a.length;n++)if(a[n].value===i){t.$set(e.attribute,"crowdName",a[n].label);break}}),e});return a},addHomePage:function(e){this.addHomePageDialogVisible=!0,this.mode=e,this.selectedCrowds="normal"===e?this.form.specialNormalHp:this.form.specialChildHp,this.editHomePageData={}},modelChipSelectedRemove:function(e){this.form.deviceInfos.splice(e,1)},dialogSubmit:function(){switch(this.dialogVisible=!1,this.mode){case"modelChip":var e=this.$refs.chipModelSelected.platform;e!==this.platform&&(this.platform=e),this.form.deviceInfos=this.$refs.chipModelSelected.selected.map(function(e){return{chip:e.chip,model:e.model}});break}},selectChipModel:function(){this.dialogVisible=!0,this.dialogTitle="选择机型机芯",this.mode="modelChip"},selectHomePageModel:function(e){this.dialogVisible=!0,this.dialogTitle="选择首页方案模式",this.mode=e,this.selectHomePageDialogVisible=!0},submitBtn:function(e){var t=this;this.$refs.form.validate(function(a){var i=t.form;i.homepageInfoList=[];var n=i.homepageInfoListObj;if(Object.keys(n).forEach(function(e){i.homepageInfoList.push(n[e])}),i.policyStatus=e,a){if(void 0===n["normal"])return void t.$message({type:"error",message:"请选择标准模式首页"});if(void 0===n["child"])return void t.$message({type:"error",message:"请选择儿童模式首页"});if(""!==i.macStart&&""!==i.macEnd||(i.macStart=i.macEnd=""),0===i.deviceInfos.length&&""===i.macStart)return void t.$message({type:"error",message:"mac地址或者机型机芯至少选择一项"});"replicate"===t.mode&&(i.currentVersion=""),t.$service.policyConfSave({jsonStr:JSON.stringify(i)},"保存成功").then(function(e){t.$emit("upsert-end")})}})},fetchData:function(e){var t=this;this.$service.getPolicyConfDetail({id:this.id,version:e}).then(function(e){t.form={currentVersion:e.currentVersion,policyId:e.policyId,policyName:e.policyName,macStart:e.macStart,macEnd:e.macEnd,homePageVerEnd:e.homePageVerEnd,homePageVerStart:e.homepageVerStart,priority:e.priority,policyStatus:e.policyStatus,deviceInfos:[{chip:e.chip,model:e.model}],homepageInfoList:e.homepageInfoList,homepageInfoListObj:{normal:e.homepageInfoList.length>0?e.homepageInfoList[0]:{},child:2===e.homepageInfoList.length?e.homepageInfoList[1]:{}},schemeFilterEntity:{partner:e.platform},regionCityPairs:[],specialNormalHp:t.getCrowdNames(e.specialNormalHp),specialChildHp:t.getCrowdNames(e.specialChildHp)}})}},created:function(){this.mode=this.initMode||"create",this.id&&(this.selectionType="single",this.fetchData(this.version))}},_y=ky,Py=(a("ec97"),Object(Bn["a"])(_y,zv,Jv,!1,null,"ed31dd4e",null)),xy=Py.exports,Dy={extends:Po,components:{ActionList:Dn["ActionList"],Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"],ButtonGroupForListPage:Ro,Policy:xy,PageWrapper:Mu,PageContentWrapper:qu},data:function(){var e=this;return{resourceType:"homepage",activePage:"homepage_list",showChipDialog:!1,showPolicyNameDialog:!1,policyId:void 0,policyNames:[],chips:[],filter:{sort:void 0,order:void 0},filterSchema:null,pagination:{},setDialogVisible:!1,selected:[],buttonList:[],table:{props:{"row-key":"homepageId"},header:[{label:"ID",prop:"homepageId"},{label:"首页名称",prop:"homepageName",minWidth:150,"show-overflow-tooltip":!0,render:function(t,a){var i=a.row;return t(A["Button"],{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(i)}}},i.homepageName)}},{label:"关联策略",prop:"relationPolicyName",align:"center",render:function(t,a){var i=a.row,n=i.relationPolicyName;if("--"!==n)return t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleShowPolicyNames(n)}}},"查看")}},{label:"版本/状态",prop:"homepageStatus",align:"center",render:function(t,a){var i=a.row,n=e.$consts.statusText;return t("span","".concat(i.currentVersion,"/").concat(n[i.homepageStatus]))}},{label:"待审核副本",prop:"duplicateVersion",align:"center",render:function(t,a){var i=a.row;return""===i.duplicateVersion?"":t(A["Button"],{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(i,i.duplicateVersion)}}},i.duplicateVersion)}},{label:"机型机芯",prop:"chipModel",align:"center",render:function(t,a){var i=a.row,n=i.chipModel;if("--"!==n)return t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleShowChips(n)}}},"查看")}},{label:"更新时间",prop:"lastUpdateDate",width:140},{label:"更新人",prop:"modiferName"},{label:"操作",width:"140",fixed:"right",render:function(t,a){var i=a.row;return t("div",[t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleCopy(i)}}},"复制"),!!i.showContentAuthSettingBtn&&t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleOpenContentAuthManager(i)}}},"内容权限")])}}],data:[],selected:[],selectionType:"multiple"}}},computed:{},methods:{handleOpenContentAuthManager:function(e){this.$refs.contentCard.handleShowContentAuthManager({id:e.homepageId,type:"homepage",menuElId:"homepageInfo"})},handleShowChips:function(e){this.chips=e.split(","),this.showChipDialog=!0},handleShowPolicyNames:function(e){this.policyNames=e.split(","),this.showPolicyNameDialog=!0},handleShowPolicy:function(e){var t=e.match(/\((.+)\)/)[1];this.policyId=+t,this.activePage="policy",this.showPolicyNameDialog=!1},handleShowPolicyEnd:function(){this.showPolicyNameDialog=!0,this.activePage="homepage_list"},handleFilterChange:function(e,t){t&&(this.filter=t),"query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData()},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();this.$service.getHomePageInfoList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=co.a.map({homepageId:co.a.o.oneOf([co.a.value(""),co.a.number]).$msg("请输入数字").other("form",{component:"InputPositiveInt",placeholder:"ID"}),homepageName:co.a.o.string.other("form",{component:"Input",placeholder:"名称"}),homepageStatus:co.a.o.enum({"下架":"0","上架":"1","草稿":"2","待审核":"3","审核通过":"4","审核不通过":"5"}).other("form",{component:"Select",placeholder:"状态"}),chipModel:co.a.o.string.other("form",{component:"Input",placeholder:"机型/机芯"})}).other("form",{cols:{item:5,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},Fy=Dy,$y=(a("ca68"),Object(Bn["a"])(Fy,qv,Hv,!1,null,"f2eb18a2",null)),Ly=$y.exports,Ry={extends:hc,components:{ResourceList:Ly,ResourceContent:Wv},data:function(){return{}},computed:{resourceInfo:function(){return{type:"homepage",idField:"homepageId"}}}},Ny=Ry,Ey=Object(Bn["a"])(Ny,Tb,Sb,!1,null,null,null),Oy=Ey.exports,Ay=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("PolicyManageList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,read:e.handleRead,edit:e.handleEdit,delete:e.handleDelete}}),e.isShowList?e._e():a("PolicyManageInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},Vy=[],My=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{ref:"contentCard",staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"policyConf"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}),a("Table",{staticClass:"policy-list",attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},By=[],Uy={extends:Po,components:{ActionList:Dn["ActionList"],Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"],ButtonGroupForListPage:Ro},data:function(){var e=this;return{resourceType:"policy",filter:{},filterSchema:null,pagination:{pageSize:10},selected:[],selectedItems:[],table:{props:{rowKey:"policyId",treeProps:{children:"children"}},header:[{label:"ID",prop:"policyId",width:70},{label:"策略名称",prop:"policyName",minWidth:150,"show-overflow-tooltip":!0,render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(i)}}},i.policyName)}},{label:"策略优先级",prop:"priority"},{label:"关联首页方案",width:150,prop:"relationHomepageName"},{label:"机型",prop:"model"},{label:"机芯",prop:"chip"},{label:"版本",prop:"currentVersion"},{label:"状态",prop:"policyStatus",render:function(t,a){var i=a.row;return e.$numToAuditStatus(i.policyStatus)}},{label:"待审核副本",prop:"duplicateVersion",align:"center",render:function(t,a){var i=a.row;return""===i.duplicateVersion?"":t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(i,i.duplicateVersion)}}},i.duplicateVersion)}},{label:"更新时间",prop:"lastUpdateDate",width:140},{label:"更新人",prop:"modifierName"},{label:"操作",render:function(t,a){var i=a.row;if(i.showContentAuthSettingBtn)return t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleOpenContentAuthManager(i)}}},"内容权限")}}],data:[],selected:[],selectionType:"multiple"}}},methods:{handleOpenContentAuthManager:function(e){this.$refs.contentCard.handleShowContentAuthManager({id:e.policyId,type:"policy",menuElId:"policyConf"})},handleFilterChange:function(e,t){t&&(this.filter=t),this.pagination&&(this.pagination.currentPage=1);var a=this.pagination;a.currentPage*a.pageSize-a.total<a.pageSize&&this.fetchData()},handleFilterReset:function(){this.filter={},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();this.$service.getPolicyManagePageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows||[]})},expandItem:function(e){return e.children?[e].concat(Object(Bo["a"])(e.children)):[e]},handleRowSelectionAdd:function(e){this.selected=this.selected.concat(this.expandItem(e)),this.updateTableSelected()},handleRowSelectionRemove:function(e){var t="policyId",a=this.expandItem(e).reduce(function(e,a){return e[a[t]]=!0,e},{});this.selected=this.selected.filter(function(e){return!a[e[t]]}),this.updateTableSelected()},handleAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleRowSelectionAdd):(this.selected=[],this.table.selected=[])},updateTableSelected:function(){var e=this,t="policyId",a=this.table,i=this.selected.reduce(function(e,a){return e[a[t]]=!0,e},{}),n=a.data.reduce(function(t,a){return t.concat(e.expandItem(a))},[]);a.selected=n.reduce(function(e,a,n){return i[a[t]]&&e.push(n),e},[])}},created:function(){var e=co.a.map({policyId:co.a.o.oneOf([co.a.value(""),co.a.number]).$msg("请输入数字").other("form",{component:"InputPositiveInt",placeholder:"ID"}),policyName:co.a.o.string.other("form",{component:"Input",placeholder:"策略名称"}),policyStatus:co.a.o.enum({"下架":"0","上架":"1","草稿":"2","待审核":"3","审核通过":"4","审核不通过":"5"}).other("form",{component:"Select",placeholder:"状态"}),chipModel:co.a.o.string.other("form",{component:"Input",placeholder:"机型/机芯"})}).other("form",{cols:{item:5,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},jy=Uy,Gy=(a("dcd9"),Object(Bn["a"])(jy,My,By,!1,null,"133227de",null)),Wy=Gy.exports,qy={components:{PolicyManageInfo:xy,PolicyManageList:Wy},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0}},methods:{handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e.policyId,this.mode="edit",this.isShowList=!1},handleRead:function(e,t){this.id=e.policyId,this.mode="read",this.version=t,this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.policyConfRemove({id:e.map(function(e){return e.policyId}).join(",")},"删除成功").then(function(){t.$refs.list.fetchData()})},handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},Hy=qy,zy=Object(Bn["a"])(Hy,Ay,Vy,!1,null,null,null),Jy=zy.exports,Ky=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("TestPolicyManageList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,read:e.handleRead,edit:e.handleEdit,delete:e.handleDelete}}),e.isShowList?e._e():a("TestPolicyManageInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},Qy=[],Xy=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PageWrapper",{staticClass:"testPolicy-info-wrapper"},[a("PageContentWrapper",{directives:[{name:"show",rawName:"v-show",value:"policy_info"===e.activePage,expression:"activePage === 'policy_info'"}]},[a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("CommonContent",{attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{replicate:function(t){e.mode="replicate",e.title="创建副本"},edit:function(t){e.mode="edit",e.title="编辑"},unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,"submit-audit":function(t){return e.submitBtn(3)},"save-draft":function(t){return e.submitBtn(2)},audit:function(t){return e.$emit("upsert-end")},"select-version":e.fetchData,delete:function(t){return e.$emit("upsert-end",t)}}},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),"read"!==e.mode?a("div",[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:24}},[a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{model:e.form,rules:e.formRules,"label-width":"160px"}},[a("el-form-item",{attrs:{label:"策略名称",prop:"policyName"}},[a("el-input",{attrs:{placeholder:"策略名称"},model:{value:e.form.policyName,callback:function(t){e.$set(e.form,"policyName",t)},expression:"form.policyName"}})],1),a("el-form-item",{attrs:{label:"机型机芯",prop:"chipModel"}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.selectChipModel}},[e._v("选择机型机芯")]),e.form.deviceInfos.length>0?a("SelectedTag",[a("ul",e._l(e.form.deviceInfos,function(t,i){return a("li",{key:i},[a("el-tag",{attrs:{type:"success",closable:""},on:{close:function(a){return e.modelChipSelectedRemove(t)}}},[e._v(e._s(t.model)+"_"+e._s(t.chip))])],1)}),0)]):e._e()],1),a("el-form-item",{staticClass:"linkwork",attrs:{label:"首页版本号",required:""}},[a("el-col",{staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:11}},[a("el-form-item",{attrs:{prop:"homePageVerStart"}},[a("el-input-number",{attrs:{min:0,max:9999999},model:{value:e.form.homePageVerStart,callback:function(t){e.$set(e.form,"homePageVerStart",t)},expression:"form.homePageVerStart"}})],1)],1),a("el-col",{staticClass:"line",staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:2}},[e._v("-")]),a("el-col",{staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:11}},[a("el-form-item",{attrs:{prop:"homePageVerEnd"}},[a("el-input-number",{attrs:{min:0,max:9999999},model:{value:e.form.homePageVerEnd,callback:function(t){e.$set(e.form,"homePageVerEnd",t)},expression:"form.homePageVerEnd"}})],1)],1)],1),a("el-form-item",{staticClass:"linkwork",attrs:{label:"Mac地址",required:""}},[a("el-form-item",{attrs:{prop:"macStart"}},[a("el-input",{attrs:{placeholder:"Mac地址"},model:{value:e.form.macStart,callback:function(t){e.$set(e.form,"macStart",t)},expression:"form.macStart"}})],1)],1),a("el-form-item",{attrs:{label:"策略优先级",prop:"priority"}},[a("el-input-number",{attrs:{placeholder:"策略优先级",min:1,max:9999},model:{value:e.form.priority,callback:function(t){e.$set(e.form,"priority",t)},expression:"form.priority"}}),a("span",{staticClass:"tip"},[e._v("注：数值越大优先级越高，数值越小优先级越低")])],1),a("el-form-item",{attrs:{label:"关联首页方案"}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.selectHomePageModel("normal")}}},[e._v("选择标准模式首页")]),"undefined"!==typeof e.form.homepageInfoListObj["normal"]?a("span",{staticClass:"tip"},[e._v("\n                  已选首页：\n                  "),a("el-tag",{staticClass:"el-tag",attrs:{type:"success"},nativeOn:{click:function(t){return e.showHomePageDetail("normal")}}},[e._v(e._s(e.form.homepageInfoListObj["normal"].homepageName))])],1):e._e()],1),a("el-form-item",{attrs:{label:"关联首页方案"}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.selectHomePageModel("child")}}},[e._v("选择儿童模式首页")]),"undefined"!==typeof e.form.homepageInfoListObj["child"]?a("span",{staticClass:"tip"},[e._v("\n                  已选首页：\n                  "),a("el-tag",{staticClass:"el-tag",attrs:{type:"success"},nativeOn:{click:function(t){return e.showHomePageDetail("child")}}},[e._v(e._s(e.form.homepageInfoListObj["child"].homepageName))])],1):e._e()],1),a("el-form-item",{attrs:{label:"定向首页方案"}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.addHomePage("normal")}}},[e._v("添加标准模式")]),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.addHomePage("child")}}},[e._v("添加儿童模式")]),a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.cancel}},[e._v("解绑所有方案")]),e.form.specialNormalHp.length>0?a("SelectedHomePage",{attrs:{dataArr:e.form.specialNormalHp,mode:e.mode,title:"标准模式"},on:{"edit-item":e.editHomePage,"remove-item":e.removeHomePage}}):e._e(),e.form.specialChildHp.length>0?a("SelectedHomePage",{attrs:{dataArr:e.form.specialChildHp,mode:e.mode,title:"儿童模式"},on:{"edit-item":e.editHomePage,"remove-item":e.removeHomePage}}):e._e()],1)],1)],1)],1)],1):e._e(),"read"===e.mode?a("div",[a("el-row",{attrs:{gutter:40}},[a("el-col",{attrs:{span:24}},[a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{model:e.form,"label-width":"160px"}},[a("el-form-item",{attrs:{label:"策略名称",prop:"policyName"}},[e._v(e._s(e.form.policyName))]),a("el-form-item",{attrs:{label:"机型机芯",prop:"chipModel"}},[e.form.deviceInfos.length>0?a("SelectedTag",[a("ul",e._l(e.form.deviceInfos,function(t,i){return a("li",{key:i},[a("el-tag",{attrs:{type:"success"}},[e._v(e._s(t.model)+"_"+e._s(t.chip))])],1)}),0)]):e._e()],1),a("el-form-item",{staticClass:"linkwork",attrs:{label:"首页版本号",required:""}},[a("el-col",{staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:11}},[a("el-form-item",{attrs:{prop:"homePageVerStart"}},[a("el-input-number",{attrs:{disabled:"disabled",min:0,max:9999999},model:{value:e.form.homePageVerStart,callback:function(t){e.$set(e.form,"homePageVerStart",t)},expression:"form.homePageVerStart"}})],1)],1),a("el-col",{staticClass:"line",staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:2}},[e._v("-")]),a("el-col",{staticStyle:{"padding-left":"0px","padding-right":"0px"},attrs:{span:11}},[a("el-form-item",{attrs:{prop:"homePageVerEnd"}},[a("el-input-number",{attrs:{disabled:"disabled",min:0,max:9999999},model:{value:e.form.homePageVerEnd,callback:function(t){e.$set(e.form,"homePageVerEnd",t)},expression:"form.homePageVerEnd"}})],1)],1)],1),a("el-form-item",{staticClass:"linkwork",attrs:{label:"Mac地址",required:""}},[a("el-form-item",{attrs:{prop:"macStart"}},[e._v(e._s(e.form.macStart))])],1),a("el-form-item",{attrs:{label:"策略优先级",prop:"priority"}},[e._v("\n                "+e._s(e.form.priority)+"\n                "),a("span",{staticClass:"tip"},[e._v("注：数值越大优先级越高，数值越小优先级越低")])]),a("el-form-item",{attrs:{label:"关联首页方案(标准)"}},["undefined"!==typeof e.form.homepageInfoListObj["normal"]?a("span",{staticClass:"tip"},[a("el-tag",{staticClass:"el-tag",attrs:{type:"success"},nativeOn:{click:function(t){return e.showHomePageDetail("normal")}}},[e._v(e._s(e.form.homepageInfoListObj["normal"].homepageName))])],1):e._e()]),a("el-form-item",{attrs:{label:"关联首页方案(儿童)"}},["undefined"!==typeof e.form.homepageInfoListObj["child"]?a("span",{staticClass:"tip"},[a("el-tag",{staticClass:"el-tag",attrs:{type:"success"},nativeOn:{click:function(t){return e.showHomePageDetail("child")}}},[e._v(e._s(e.form.homepageInfoListObj["child"].homepageName))])],1):e._e()]),a("el-form-item",{attrs:{label:"定向首页方案"}},[e.form.specialNormalHp.length>0?a("SelectedHomePage",{attrs:{dataArr:e.form.specialNormalHp,mode:e.mode,title:"标准模式"},on:{"edit-item":e.editHomePage,"remove-item":e.removeHomePage}}):e._e(),e.form.specialChildHp.length>0?a("SelectedHomePage",{attrs:{dataArr:e.form.specialChildHp,mode:e.mode,title:"儿童模式"},on:{"edit-item":e.editHomePage,"remove-item":e.removeHomePage}}):e._e()],1)],1)],1)],1)],1):e._e()]),a("el-dialog",{attrs:{dialogTitle:e.dialogTitle,visible:e.dialogVisible,width:"80%"},on:{"update:visible":function(t){e.dialogVisible=t}}},["modelChip"===e.mode?a("ChipModel",{ref:"chipModelSelected",attrs:{selectionType:e.selectionType},on:{"row-click":e.ChipModelRowClick}}):e._e(),e.selectHomePageDialogVisible?a("HomePageModel",{attrs:{homepageModel:e.mode,homepageResource:e.platform,homepageStatusArray:"4"},on:{"row-click":e.rowClick,"row-selection-change":e.rowClick}}):e._e(),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1,e.mode=""}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.dialogSubmit}},[e._v("确 定")])],1)],1),e.addHomePageDialogVisible?a("PolicyManageAddHomePage",{attrs:{itemType:e.mode,"selected-crowds":e.selectedCrowds,editHomePageData:e.editHomePageData},on:{"add-home-page-close":e.addHomePageClose,"create-home-page":e.createHomePage}}):e._e()],1)],1),"showHomePageDetail"===e.activePage?a("PageContentWrapper",[a("HomePageInfo",{attrs:{id:e.homePageId,"init-mode":"read",version:e.homePageVersion,"title-prefix":e.title},on:{"upsert-end":function(t){e.activePage="policy_info"},"go-back":function(t){e.activePage="policy_info"}}})],1):e._e()],1)},Yy=[],Zy={mixins:[zu],components:{ChipModel:ry,SelectedTag:ay,HomePageModel:py,PolicyManageAddHomePage:vy,SelectedHomePage:Sy,CommonContent:Us,HomePageInfo:Wv,PageWrapper:Mu,PageContentWrapper:qu},props:["id","initMode","version"],data:function(){return{homePageId:void 0,homePageVersion:void 0,homePageReadDialogVisible:!1,activePage:"policy_info",mode:void 0,selectionType:"multiple",dialogTitle:null,dialogVisible:!1,selectHomePageDialogVisible:!1,addHomePageDialogVisible:!1,platform:"tencent",selectedCrowds:[],editHomePageData:{},editHomePageMode:void 0,editHomePageIndex:void 0,form:{policyId:null,policyName:null,macStart:void 0,macEnd:"ffffffffffff",homePageVerEnd:"9999999",homePageVerStart:"",priority:null,policyStatus:3,deviceInfos:[],homepageInfoList:[],homepageInfoListObj:{},schemeFilterEntity:{partner:"tencent"},regionCityPairs:[],specialNormalHp:[],specialChildHp:[]},formRules:{policyName:[{required:!0,message:"请输入策略名称",trigger:"blur"}],macStart:[{required:!0,message:"请输入MAC起始地址",trigger:"blur"},{validator:this.$checkMacType,message:"请输入12位以字母数字组成的MAC地址",trigger:"blur"}],macEnd:[{validator:this.$checkMacType,message:"请输入12位以字母数字组成的MAC地址",trigger:"blur"}],homePageVerStart:[{required:!0,message:"请输入首页版本起始值",trigger:"blur"}],homePageVerEnd:[{required:!0,message:"请输入首页版本结束值",trigger:"blur"}]}}},watch:{platform:function(e){this.form.homepageInfoList=[],this.form.homepageInfoListObj={},this.form.specialNormalHp=[],this.form.specialChildHp=[],this.form.schemeFilterEntity.partner=e}},computed:{resourceInfo:function(){var e=this.form;if(e.policyId)return{id:e.policyId,type:"policy",menuElId:"policyConf",version:e.currentVersion,status:e.policyStatus}}},methods:{showHomePageDetail:function(e){this.homePageId=this.form.homepageInfoListObj[e].homepageId,this.homePageVersion=this.form.homepageInfoListObj[e].currentVersion,this.activePage="showHomePageDetail"},ChipModelRowClick:function(e){this.dialogVisible=!1,this.form.deviceInfos=[{chip:e.chip,model:e.model}]},cancel:function(){this.form.specialNormalHp=[],this.form.specialChildHp=[]},rowClick:function(e){this.dialogVisible=!1,this.form.homepageInfoListObj[this.mode]={homepageId:e.homepageId,homepageModel:e.homepageModel,homepageName:e.homepageName,homepageVersion:e.homepageVersion}},addHomePageClose:function(){this.addHomePageDialogVisible=!1},editHomePage:function(e,t){this.addHomePageDialogVisible=!0,"normal"===e?(this.selectedCrowds=this.form.specialNormalHp,this.editHomePageData=this.form.specialNormalHp[t]):(this.selectedCrowds=this.form.specialChildHp,this.editHomePageData=this.form.specialChildHp[t])},removeHomePage:function(e,t){this.editHomePageData="normal"===e?this.form.specialNormalHp.splice(t,1):this.form.specialChildHp.splice(t,1)},createHomePage:function(e,t){var a=this,i=e.attribute.crowdPolicyIds[0],n=e.attribute.crowdIds[0];this.$service.getTaglist({id:i,type:"crowd"}).then(function(i){for(var o=0;o<i.length;o++)if(i[o].value===n){e.attribute.crowdName=i[o].label;break}"normal"===a.mode?t?a.form.specialNormalHp[a.editHomePageIndex]=e:a.form.specialNormalHp.push(e):t?a.form.specialChildHp[a.editHomePageIndex]=e:a.form.specialChildHp.push(e)}),this.addHomePageDialogVisible=!1},getCrowdNames:function(e){var t=this,a=e.map(function(e){var a=e.attribute.crowdPolicyIds[0],i=e.attribute.crowdIds[0];return t.$service.getTaglist({id:a,type:"crowd"}).then(function(a){for(var n=0;n<a.length;n++)if(a[n].value===i){t.$set(e.attribute,"crowdName",a[n].label);break}}),e});return a},addHomePage:function(e){this.addHomePageDialogVisible=!0,this.mode=e,this.selectedCrowds="normal"===e?this.form.specialNormalHp:this.form.specialChildHp,this.editHomePageData={}},modelChipSelectedRemove:function(e){this.form.deviceInfos.splice(e,1)},dialogSubmit:function(){switch(this.dialogVisible=!1,this.mode){case"modelChip":var e=this.$refs.chipModelSelected.platform;e!==this.platform&&(this.platform=e),this.form.deviceInfos=this.$refs.chipModelSelected.selected.map(function(e){return{chip:e.chip,model:e.model}});break}},selectChipModel:function(){this.dialogVisible=!0,this.dialogTitle="选择机型机芯",this.mode="modelChip"},selectHomePageModel:function(e){this.dialogVisible=!0,this.dialogTitle="选择首页方案模式",this.mode=e,this.selectHomePageDialogVisible=!0},submitBtn:function(e){var t=this;this.$refs.form.validate(function(a){var i=t.form;i.homepageInfoList=[];var n=i.homepageInfoListObj;if(Object.keys(n).forEach(function(e){i.homepageInfoList.push(n[e])}),i.policyStatus=e,a){if(void 0===n["normal"])return void t.$message({type:"error",message:"请选择标准模式首页"});if(void 0===n["child"])return void t.$message({type:"error",message:"请选择儿童模式首页"});if(i.macEnd=i.macStart,0===i.deviceInfos.length)return void t.$message({type:"error",message:"机型机芯不能为空"});"replicate"===t.mode&&(i.currentVersion=""),t.$service.testPolicyConfSave({jsonStr:JSON.stringify(i)},"保存成功").then(function(e){t.$emit("upsert-end")})}})},fetchData:function(e){var t=this;this.$service.getTestPolicyConfDetail({id:this.id,version:e}).then(function(e){t.form={currentVersion:"replicate"===t.mode?"":e.currentVersion,policyId:e.policyId,policyName:e.policyName,macStart:e.macStart,macEnd:e.macEnd,homePageVerEnd:e.homePageVerEnd,homePageVerStart:e.homepageVerStart,priority:e.priority,policyStatus:e.policyStatus,deviceInfos:[{chip:e.chip,model:e.model}],homepageInfoList:e.homepageInfoList,homepageInfoListObj:{normal:e.homepageInfoList.length>0?e.homepageInfoList[0]:{},child:2===e.homepageInfoList.length?e.homepageInfoList[1]:{}},schemeFilterEntity:{partner:e.platform},regionCityPairs:[],specialNormalHp:t.getCrowdNames(e.specialNormalHp),specialChildHp:t.getCrowdNames(e.specialChildHp)}})}},created:function(){this.mode=this.initMode||"create",this.id&&(this.selectionType="single",this.fetchData(this.version))}},ew=Zy,tw=(a("8095"),Object(Bn["a"])(ew,Xy,Yy,!1,null,"3997d4ea",null)),aw=tw.exports,iw=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{ref:"contentCard",staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"policyConf"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}),a("Table",{staticClass:"policy-list",attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},nw=[],ow={extends:Po,components:{ActionList:Dn["ActionList"],Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"],ButtonGroupForListPage:Ro},data:function(){var e=this;return{resourceType:"policy",filter:{},filterSchema:null,pagination:{pageSize:15},selected:[],selectedItems:[],table:{props:{rowKey:"policyId"},header:[{label:"ID",prop:"policyId",width:70},{label:"策略名称",prop:"policyName",minWidth:150,"show-overflow-tooltip":!0,render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(i)}}},i.policyName)}},{label:"策略优先级",prop:"priority"},{label:"关联首页方案",width:150,prop:"relationHomepageName"},{label:"机型",prop:"model"},{label:"机芯",prop:"chip"},{label:"版本",prop:"currentVersion"},{label:"状态",prop:"policyStatus",render:function(t,a){var i=a.row;return e.$numToAuditStatus(i.policyStatus)}},{label:"待审核副本",prop:"duplicateVersion",align:"center",render:function(t,a){var i=a.row;return""===i.duplicateVersion?"":t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(i,i.duplicateVersion)}}},i.duplicateVersion)}},{label:"更新时间",prop:"lastUpdateDate",width:140},{label:"更新人",prop:"modifierName"},{label:"操作",render:function(t,a){var i=a.row;if(i.showContentAuthSettingBtn)return t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleOpenContentAuthManager(i)}}},"内容权限")}}],data:[],selected:[],selectionType:"multiple"}}},methods:{handleOpenContentAuthManager:function(e){this.$refs.contentCard.handleShowContentAuthManager({id:e.policyId,type:"policy",menuElId:"policyConf"})},handleFilterChange:function(e,t){t&&(this.filter=t),this.pagination&&(this.pagination.currentPage=1);var a=this.pagination;a.currentPage*a.pageSize-a.total<a.pageSize&&this.fetchData()},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.getTestPolicyManagePageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},expandItem:function(e){return e.children?[e].concat(Object(Bo["a"])(e.children)):[e]},handleRowSelectionAdd:function(e){this.selected=this.selected.concat(this.expandItem(e)),this.updateTableSelected()},handleRowSelectionRemove:function(e){var t="policyId",a=this.expandItem(e).reduce(function(e,a){return e[a[t]]=!0,e},{});this.selected=this.selected.filter(function(e){return!a[e[t]]}),this.updateTableSelected()},handleAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleRowSelectionAdd):(this.selected=[],this.table.selected=[])},updateTableSelected:function(){var e=this,t="policyId",a=this.table,i=this.selected.reduce(function(e,a){return e[a[t]]=!0,e},{}),n=a.data.reduce(function(t,a){return t.concat(e.expandItem(a))},[]);a.selected=n.reduce(function(e,a,n){return i[a[t]]&&e.push(n),e},[])}},created:function(){var e=co.a.map({policyId:co.a.o.oneOf([co.a.value(""),co.a.number]).$msg("请输入数字").other("form",{component:"InputPositiveInt",placeholder:"ID"}),policyName:co.a.o.string.other("form",{component:"Input",placeholder:"策略名称"}),policyStatus:co.a.o.enum({"下架":"0","上架":"1","草稿":"2","待审核":"3","审核通过":"4","审核不通过":"5"}).other("form",{component:"Select",placeholder:"状态"}),chipModel:co.a.o.string.other("form",{component:"Input",placeholder:"机型/机芯"})}).other("form",{cols:{item:5,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},rw=ow,lw=(a("38ff"),Object(Bn["a"])(rw,iw,nw,!1,null,"690cd810",null)),sw=lw.exports,cw={components:{TestPolicyManageInfo:aw,TestPolicyManageList:sw},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0}},methods:{handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e.policyId,this.mode="edit",this.isShowList=!1},handleRead:function(e,t){this.id=e.policyId,this.mode="read",this.version=t,this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.policyConfRemove({id:e.map(function(e){return e.policyId}).join(",")},"删除成功").then(function(){t.$refs.list.fetchData()})},handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},uw=cw,dw=Object(Bn["a"])(uw,Ky,Qy,!1,null,null,null),pw=dw.exports,hw=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("BusinessTabList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,read:e.handleRead,edit:e.handleEdit,copy:e.handleCopy,delete:e.handleDelete}}),e.isShowList?e._e():a("BusinessTabInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},mw=[],fw=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{ref:"contentCard",staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"businessTab"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},gw=[],bw={extends:Po,components:{ContentWrapper:Dn["ContentWrapper"],Table:Dn["Table"],ButtonGroupForListPage:Ro},data:function(){var e=this;return{resourceType:"tabInfo",tabTypeOption:[{label:"第三方版面",value:"4"},{label:"专题版面",value:"2"},{label:"普通版面",value:"1"}],tabStatusOption:[{label:"下架",value:"0"},{label:"上架",value:"1"},{label:"草稿",value:"2"},{label:"待审核",value:"3"},{label:"审核通过",value:"4"},{label:"审核不通过",value:"5"}],tabStatus:{},filter:this.genDefaultFilter(),filterSchema:null,pagination:{currentPage:1},appIdType:[],businessType:[],tabType:{},tabTypeReverse:{},selected:[],selectedItems:[],table:{props:{},data:[],header:[{label:"ID",prop:"tabId"},{label:"名称",prop:"tabName","show-overflow-tooltip":!0,minWidth:180,render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(i)}}},i.tabName)}},{label:"版面属性",prop:"tabType",width:120,render:function(t,a){var i=a.row;return e.tabTypeReverse[i.tabType]}},{label:"业务分类",prop:"businessCategoryName"},{label:"内容源",prop:"tabResource",render:function(t,a){var i=a.row;return e.$sourceName(i.tabResource)}},{label:"AppId",prop:"tabAppid",formatter:function(t){return e.appIdType.map(function(e){if(t.tabAppid.toString()===e.dictEnName)return e.dictCnName})}},{label:"版本/状态",prop:"tabStatus",width:110,formatter:function(t){var a=t.tabStatus,i=t.currentVersion;return i+"/"+e.tabStatusOption.map(function(e){if(a.toString()===e.value)return e.label}).join("")}},{label:"待审核副本",prop:"duplicateVersion",width:90,render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(i,i.duplicateVersion)}}},i.duplicateVersion)}},{label:"更新时间",prop:"lastUpdateDate",width:140},{label:"审核人",prop:"auditor",width:100},{label:"更新人",prop:"modifierName",width:100},{label:"操作",width:180,fixed:"right",render:this.createOperationRender(this)}],selected:[],selectionType:"multiple"}}},methods:{handleOpenContentAuthManager:function(e){this.$refs.contentCard.handleShowContentAuthManager({id:e.tabId,type:"tab",menuElId:"tabInfo"})},createOperationRender:function(e){var t=this;return function(a,i){var n=i.row,o=a("el-button",{props:{type:"text"},on:{click:function(){e.handleCopy(n)}}},"复制"),r=null;r=n.collected?a("el-button",{props:{type:"text"},on:{click:function(){e.cancalCollect(n)}}},"取消"):a("el-button",{props:{type:"text"},on:{click:function(){e.collect(n)}}},"收藏");var l=!!n.showContentAuthSettingBtn&&a("el-button",{props:{type:"text"},on:{click:function(e){e.stopPropagation(),t.handleOpenContentAuthManager(n)}}},"内容权限");return[o,r,l]}},collect:function(e){var t=this;this.$service.collect({type:"tab",data:{resourceId:e.tabId}},"收藏成功").then(function(){t.fetchData()})},cancalCollect:function(e){var t=this;this.$service.collectCancel({type:"tab",data:{resourceId:e.tabId}},"取消成功").then(function(){t.fetchData()})},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.tabInfoList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},genDefaultFilter:function(){return{tabParentType:"biz",idPrefix:this.$consts.idPrefix}},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},handleFilterChange:function(e,t){t&&(this.filter=t),this.pagination&&(this.pagination.currentPage=1),this.fetchData()},handleFilterReset:function(){this.filter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},getTabType:function(){var e=this;return this.$service.getTabType({tabParentType:"biz"}).then(function(t){t.forEach(function(t){e.tabType[t.dictCnName]=t.dictEnName,e.tabTypeReverse[t.dictEnName]=t.dictCnName})})},getBusinessType:function(){var e=this;this.$service.getDictType({type:"businessType"}).then(function(t){e.businessType=t})}},created:function(){var e=this;this.tabStatus=this.tabStatusOption.reduce(function(e,t){return e[t.label]=t.value,e},{});var t=co.a.map({tabId:co.a.o.oneOf([co.a.value(""),co.a.number]).$msg("请输入数字").other("form",{component:"InputPositiveInt",placeholder:"ID"}),tabName:co.a.o.string.other("form",{placeholder:"版面标题"}),tabType:co.a.o.enum(this.tabType).other("form",{component:"Select",placeholder:"版面属性"}),tabStatus:co.a.o.enum(this.tabStatus).other("form",{component:"Select",placeholder:"状态"})}).other("form",{cols:{item:5,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});"10"!=this.$consts.idPrefix&&t.map({idPrefix:co.a.o.enum({"酷开":"10","江苏广电":"11"}).other("form",{component:"Select",placeholder:"数据来源"})}),this.getTabType().then(function(){e.filterSchema=t}),this.$service.getDictType({type:"appIdType"}).then(function(t){e.appIdType=t,e.fetchData()}),this.getBusinessType()}},vw=bw,yw=Object(Bn["a"])(vw,fw,gw,!1,null,"7d9cb404",null),ww=yw.exports,Iw=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PageWrapper",{staticClass:"tab-info-wrapper"},[a("PageContentWrapper",{directives:[{name:"show",rawName:"v-show",value:"tab_info"===e.activePage,expression:"activePage === 'tab_info'"}]},[a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("CommonContent",{ref:"commonContent",attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{replicate:function(t){e.mode="replicate"},edit:function(t){e.mode="edit"},unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,"submit-audit":e.handleSubmitAudit,"save-draft":e.handleSaveDraft,audit:function(t){return e.$emit("upsert-end")},copy:function(t){return e.handleCopy(t)},"select-version":e.fetchData,delete:function(t){return e.$emit("upsert-end",t)}}},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),"read"!==e.mode?a("div",[a("el-form",{ref:"tabForm",staticClass:"el-form-add",attrs:{rules:e.rules,model:e.tab,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"版面名称",prop:"tabName"}},[a("el-input",{model:{value:e.tab.tabName,callback:function(t){e.$set(e.tab,"tabName","string"===typeof t?t.trim():t)},expression:"tab.tabName"}})],1),a("el-form-item",{attrs:{label:"标题(中文)",prop:"tabCnTitle"}},[a("el-input",{model:{value:e.tab.tabCnTitle,callback:function(t){e.$set(e.tab,"tabCnTitle","string"===typeof t?t.trim():t)},expression:"tab.tabCnTitle"}})],1),a("el-form-item",{attrs:{label:"标题(英文)",prop:"tabEnTitle"}},[a("el-input",{model:{value:e.tab.tabEnTitle,callback:function(t){e.$set(e.tab,"tabEnTitle","string"===typeof t?t.trim():t)},expression:"tab.tabEnTitle"}})],1),a("el-form-item",{attrs:{label:"内容源",prop:"tabResource"}},[a("el-radio-group",{attrs:{value:e.tab.tabResource},on:{input:e.handleChangeTabResource}},[a("el-radio",{attrs:{label:""}},[e._v("不限")]),a("el-radio",{attrs:{label:"o_tencent"}},[e._v("腾讯")]),a("el-radio",{attrs:{label:"o_iqiyi"}},[e._v("爱奇艺")]),a("el-radio",{attrs:{label:"o_youku"}},[e._v("优酷")])],1)],1),a("el-form-item",{attrs:{label:"刷新时间间隔",prop:"interval"}},[a("SelectHourAndMinute",{staticClass:"selectHourAndMinute",attrs:{"hour-option":e.hourOption,"minute-option":e.minuteOption,initSumTime:e.initSumTime,min:"5",max:"360"},model:{value:e.tab.timeCycle,callback:function(t){e.$set(e.tab,"timeCycle",t)},expression:"tab.timeCycle"}},[e._v(e._s(e.initSumTime))]),a("span",{staticClass:"hint remarks"},[e._v("设置范围:5分钟-6小时")])],1),a("el-form-item",{attrs:{label:"类型",prop:"tabType"}},[a("el-select",{attrs:{placeholder:"请选择类型",disabled:e.isDisableTabType},model:{value:e.tab.tabType,callback:function(t){e.$set(e.tab,"tabType",t)},expression:"tab.tabType"}},e._l(e.tabTypes,function(e,t){return a("el-option",{key:"tabTypes"+t,attrs:{value:e.value,label:e.label,disabled:e.disabled}})}),1)],1),a("el-form-item",{attrs:{label:"选择版块",prop:"tags"}},[a("cc-panel-selector-el",{ref:"panelSelector",attrs:{source:e.tab.tabResource},on:{"select-end":e.handleSelectPanelEnd}}),a("el-dropdown",[a("el-button",{attrs:{type:"primary",plain:""}},[e._v("\n                  新建\n                  "),a("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(t){e.activePage="panel"}}},[e._v("常规版块")]),a("el-dropdown-item",{nativeOn:{click:function(t){e.activePage="album_panel"}}},[e._v("业务专辑")]),a("el-dropdown-item",{nativeOn:{click:function(t){e.activePage="private_panel"}}},[e._v("专属影院")])],1)],1),a("OrderableTable",{staticClass:"orderableTable",attrs:{header:e.tabGroupTableHeader,"hide-action":!0},model:{value:e.tab.pannelList,callback:function(t){e.$set(e.tab,"pannelList",t)},expression:"tab.pannelList"}})],1)],1)],1):e._e(),"read"===e.mode?a("div",[a("el-form",{ref:"tabForm",staticClass:"el-form-add",attrs:{rules:e.rules,model:e.tab,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"版面名称",prop:"tabName"}},[e._v(e._s(e.tab.tabName))]),a("el-form-item",{attrs:{label:"标题(中文)",prop:"tabCnTitle"}},[e._v(e._s(e.tab.tabCnTitle))]),a("el-form-item",{attrs:{label:"标题(英文)",prop:"tabEnTitle"}},[e._v(e._s(e.tab.tabEnTitle))]),a("el-form-item",{attrs:{label:"内容源",prop:"tabResource"}},[a("el-radio-group",{attrs:{value:e.tab.tabResource,disabed:!0}},[a("el-radio",{attrs:{label:""}},[e._v("不限")]),a("el-radio",{attrs:{label:"o_tencent"}},[e._v("腾讯")]),a("el-radio",{attrs:{label:"o_iqiyi"}},[e._v("爱奇艺")]),a("el-radio",{attrs:{label:"o_youku"}},[e._v("优酷")])],1)],1),a("el-form-item",{attrs:{label:"刷新时间间隔",prop:"interval"}},[a("SelectHourAndMinute",{staticClass:"selectHourAndMinute",attrs:{"hour-option":e.hourOption,"minute-option":e.minuteOption,initSumTime:e.initSumTime,disabled:!0,min:5,max:360},model:{value:e.tab.timeCycle,callback:function(t){e.$set(e.tab,"timeCycle",t)},expression:"tab.timeCycle"}})],1),a("el-form-item",{attrs:{label:"类型",prop:"tabType"}},[a("el-select",{attrs:{placeholder:"请选择类型",disabled:!e.isDisableTabType},model:{value:e.tab.tabType,callback:function(t){e.$set(e.tab,"tabType",t)},expression:"tab.tabType"}},e._l(e.tabTypes,function(e,t){return a("el-option",{key:"tabTypes"+t,attrs:{value:e.value,label:e.label,disabled:e.disabled}})}),1)],1),a("el-form-item",{attrs:{label:"选择的版块",prop:"tags"}},[a("OrderableTable",{staticClass:"orderableTable",attrs:{header:e.tabGroupTableHeader,"hide-action":!0,readonly:!0},model:{value:e.tab.pannelList,callback:function(t){e.$set(e.tab,"pannelList",t)},expression:"tab.pannelList"}})],1)],1)],1):e._e()])],1)],1),"panel_preview"===e.activePage?a("PageContentWrapper",[[5,9,10].indexOf(e.panelPreview.dataType)>-1?a("PrivatePanelInfo",{attrs:{"title-prefix":e.title,"init-mode":e.panelPreview.initMode,id:e.panelPreview.id,version:e.panelPreview.version},on:{"upsert-end":e.handlePreviewPanelEnd,"go-back":e.handlePreviewPanelEnd}}):a("PanelInfo",{attrs:{"title-prefix":e.title,"init-mode":e.panelPreview.initMode,id:e.panelPreview.id,version:e.panelPreview.version,"panel-data-type":e.panelPreview.dataType,"init-group-index":e.panelPreview.initGroupIndex,"init-block-index":e.panelPreview.initBlockIndex},on:{"upsert-end":e.handlePreviewPanelEnd,"go-back":e.handlePreviewPanelEnd}})],1):e._e(),"panel"===e.activePage?a("PageContentWrapper",[a("PanelInfo",{attrs:{"title-prefix":e.title,"init-mode":"create","panel-data-type":1},on:{"upsert-end":function(t){e.activePage="tab_info"},"go-back":function(t){e.activePage="tab_info"}}})],1):e._e(),"album_panel"===e.activePage?a("PageContentWrapper",[a("PanelInfo",{attrs:{"title-prefix":e.title,"init-mode":"create","panel-data-type":3},on:{"upsert-end":function(t){e.activePage="tab_info"},"go-back":function(t){e.activePage="tab_info"}}})],1):e._e(),"private_panel"===e.activePage?a("PageContentWrapper",[a("PrivatePanelInfo",{attrs:{"title-prefix":e.title,"init-mode":"create"},on:{"upsert-end":function(t){e.activePage="tab_info"},"go-back":function(t){e.activePage="tab_info"}}})],1):e._e()],1)},Cw=[],Tw=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",[a("el-col",{attrs:{span:7}},[a("el-time-select",{attrs:{disabled:e.disabled,"picker-options":e.hourOption,placeholder:"选择小时"},model:{value:e.hour,callback:function(t){e.hour=t},expression:"hour"}})],1),a("el-col",{staticClass:"marginL",attrs:{span:2}},[e._v("小时")]),a("el-col",{attrs:{span:7}},[a("el-time-select",{attrs:{disabled:e.disabled,"picker-options":e.minuteOption,placeholder:"选择分钟"},model:{value:e.minute,callback:function(t){e.minute=t},expression:"minute"}})],1),a("el-col",{staticClass:"marginL",attrs:{span:1}},[e._v("分")]),a("el-col",{staticClass:"marginL",attrs:{span:5}},[e._v("总共："+e._s(e.sumTime)+"分")])],1)],1)},Sw=[],kw={props:["hourOption","minuteOption","initSumTime","min","max","disabled"],data:function(){return{hour:null,minute:null}},computed:{sumTime:function(){return 60*parseInt(null===this.hour?0:this.hour)+parseInt(null===this.minute?0:this.minute.toString().replace("00:",""))}},methods:{limit:function(){return this.sumTime>this.max?(this.$message({type:"error",message:"不能超过"+this.max+"分钟"}),!1):!(this.sumTime<this.min)||(this.$message({type:"error",message:"不能小于"+this.min+"分钟"}),!1)},setHourAndMinute:function(){var e=Math.floor(this.initSumTime/60),t=this.initSumTime-60*e;this.hour="0"+e+":00",this.hour=e>9?e+":00":"0"+e+":00",this.minute=t>9?"00:"+t:"00:0"+t}},watch:{hour:function(e,t){this.limit()?this.$emit("input",this.sumTime):this.hour=t},minute:function(e,t){this.limit()?this.$emit("input",this.sumTime):this.minute=t},initSumTime:function(e){this.setHourAndMinute()}},created:function(){this.setHourAndMinute()}},_w=kw,Pw=Object(Bn["a"])(_w,Tw,Sw,!1,null,"40142062",null),xw=Pw.exports,Dw={mixins:[zu],components:(kb={PageWrapper:Mu,PageContentWrapper:qu,PanelInfo:Jp,PrivatePanelInfo:Jh,"cc-panel-selector-el":Ab,Table:Dn["Table"],PrivatePannelInfo:Jh},Object(ei["a"])(kb,"PanelInfo",Jp),Object(ei["a"])(kb,"OrderableTable",fb),Object(ei["a"])(kb,"ReleaseTimeSetter",As),Object(ei["a"])(kb,"SelectHourAndMinute",xw),Object(ei["a"])(kb,"CommonContent",Us),kb),props:{id:Number,initMode:String,version:{type:String,default:function(){return""}}},data:function(){return{resourceName:"业务版面",hourOption:{start:"00:00",step:"1:00",end:"06:00"},minuteOption:{start:"00:00",step:"00:01",end:"00:59"},activePage:"tab_info",panelPreview:{panel:null,id:void 0,version:void 0,initMode:void 0,initGroupIndex:void 0,initBlockIndex:void 0},initSumTime:120,showTimeShelf:!1,tabTypes:[],status:void 0,mode:"create",isReplica:!1,tab:{tabId:void 0,currentVersion:void 0,tabParentType:"biz",tabType:"6",hasSubTab:0,tabName:void 0,tabCnTitle:void 0,tabEnTitle:void 0,tabCategory:67,tabAppid:-1,tabResource:"",pictureName:void 0,tabTitleIcons:void 0,tabParams:{},tabStatus:void 0,tabOnclick:void 0,systemDefault:0,timeCycle:120,cornerIconName:void 0,flagIsRecord:0,isTiming:0,releaseTime:void 0,tabExtArr:void 0,pannelList:[],specificPannelList:void 0,tabList:void 0},rules:{tabName:[{required:!0,message:"请输入版面名称",trigger:"blur"}],tabCnTitle:[{required:!0,message:"请输入中文标题",trigger:"blur"}],tabEnTitle:[{required:!0,message:"请输入英文标题",trigger:"blur"}]}}},computed:{resourceInfo:function(){var e=this.tab;if(e.tabId)return{id:e.tabId,type:"tab",menuElId:"tabInfo",version:e.currentVersion,status:e.tabStatus}},isDisableTabType:function(){var e=this.mode;return"edit"===e||"replicate"===e||"copy"===e},tabGroupTableHeader:function(){var e=this,t=[{label:"版块ID",prop:"pannelGroupId"},{label:"版块名称",width:180,render:function(t,a){a.$index;var i=a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handlePreviewPanel(i)}}},i.pannelGroupRemark)}},{prop:"duplicateVersion",label:"待审核副本",width:180,render:function(t,a){a.$index;var i=a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handlePreviewPanel(i,i.duplicateVersion)}}},i.duplicateVersion)}}];return"read"!==this.mode&&t.push({label:"操作",width:80,render:function(t,a){var i=a.$index;a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handleRemovePannel(i)}}},"删除")}}),t},couldSetReleaseTime:function(){var e=this.mode,t=this.tab.currentVersion,a="create"===e||"copy"===e,i="edit"===e&&"V1"===t,n="10"==this.$consts.idPrefix;return n&&!(a||i)}},methods:{handleCopy:function(e){var t=this.getFormData();t.tabStatus=e,t.tabId=void 0,t.currentVersion="",this.validateFormData(t,function(){3===e?this.$refs.commonContent.showReleaseTimeSetter=!0:this.submit(t)}.bind(this))},validateFormData:function(e,t){var a,i=e.tabStatus,n=function(e){this.$message({type:"error",message:e})}.bind(this);i===this.$consts.draft?(e.tabName||(a="请填写版面名称"),a?n(a):t()):this.$refs.tabForm.validate(function(i){i?(0===e.pannelList.length&&(a="请选择版块"),a?n(a):t()):n("请把表单填写完整")})},handleSubmitAudit:function(e){var t=this,a=this.getFormData();a.tabStatus=this.$consts.status.waiting,this.validateFormData(a,function(){t.couldSetReleaseTime?e?(a.isTiming=e.isTiming,a.releaseTime=e.releaseTime,t.submit(a)):t.$refs.commonContent.showReleaseTimeSetter=!0:t.submit(a)})},handleSaveDraft:function(){var e=this.getFormData();e.isTiming=void 0,e.releaseTime=void 0,e.tabStatus=this.$consts.status.draft,this.validateFormData(e,function(){this.submit(e)}.bind(this))},submit:function(e){var t=this;e=this.parseFormData(e),this.$service.businessTabSave({jsonStr:JSON.stringify(e)},"保存成功").then(function(e){t.showTimeShelf=!1,t.$emit("upsert-end")})},parseFormData:function(e){return e.tabParams&&(e.tabParams=JSON.stringify(e.tabParams)),e.pannelList&&(e.panelInfoList=e.pannelList.map(function(e,t){return{pannelGroupId:e.pannelGroupId,pannelSequence:t,isDmpPanel:!1}}),e.pannelList=void 0),e.tabList&&(e.tabJson=JSON.stringify(e.tabList),e.tabList=void 0),e},getFormData:function(){var e=JSON.parse(JSON.stringify(this.tab)),t=this.mode;return"replicate"===t&&(e.currentVersion=""),"copy"===t&&(e.tabId=void 0,e.currentVersion=""),e},handlePreviewPanel:function(e,t){var a=e,i=t||a.currentVersion;this.activePage="panel_preview",this.panelPreview={panel:a,initMode:"read",id:a.pannelGroupId,dataType:a.pannelType,version:i}},handlePreviewPanelEnd:function(){var e=this.panelPreview.panel;this.updatePanelVersion(e),this.panelPreview=null,this.activePage="tab_info"},handleSelectPanelEnd:function(e){var t=e||[],a=this.tab.pannelList||[],i=a.reduce(function(e,t,a){return e[t.pannelGroupId]=a,e},{}),n=[];t.forEach(function(e){var t=i[e.pannelGroupId];void 0===t&&n.push(e)}),this.tab.pannelList=a.concat(n)},handleRemovePannel:function(e){this.tab.pannelList.splice(e,1)},handleChangeTabResource:function(e){this.$confirm("是否要切换内容源，切换内容源之后所选择的版块数据将会清除掉！","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){this.tab.tabResource=e,this.tab.pannelList=[]}.bind(this)).catch(function(){})},updatePanelVersion:function(e,t){this.$service.panelPageList({pannelType:e.pannelType,pannelId:e.pannelGroupId}).then(function(a){var i=a.rows[0];Object.assign(e,i),t&&t()})},getTabType:function(){var e=this;return this.$service.getTabType({tabParentType:"biz"}).then(function(t){e.tabTypes=t.reduce(function(e,t){return e.push({label:t.dictCnName,value:t.dictEnName,disabled:"6"!==t.dictEnName}),e},[])})},fetchData:function(e){var t=this;this.$service.businessTabEdit({id:this.id,version:e}).then(function(e){t.tab.pannelList=e.panelInfoList.map(function(e){return e.pannelGroupRemark=e.pannelName,e}),t.status?e.currentVersion:t.status,e.tabType=e.tabType.toString(),t.initSumTime=e.timeCycle,t.tab=Object.assign({},t.tab,e)})}},created:function(){this.getTabType(),this.mode=this.initMode||"create",this.id&&this.fetchData(this.version)}},Fw=Dw,$w=(a("833b"),Object(Bn["a"])(Fw,Iw,Cw,!1,null,"54b6955e",null)),Lw=$w.exports,Rw={components:{BusinessTabList:ww,BusinessTabInfo:Lw},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0}},methods:{handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e.tabId,this.mode="edit",this.isShowList=!1},handleRead:function(e,t){this.id=e.tabId,this.mode="read",this.version=t,this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.businessTabDelete({id:e.map(function(e){return e.tabId}).join(",")},"删除成功").then(function(e){t.$refs.list.fetchData()})},handleCopy:function(e){this.id=e.tabId,this.mode="copy",this.isShowList=!1},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},Nw=Rw,Ew=Object(Bn["a"])(Nw,hw,mw,!1,null,"7073d0ee",null),Ow=Ew.exports,Aw=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("FilmDetailPageList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,read:e.handleRead,edit:e.handleEdit,delete:e.handleDelete}}),e.isShowList?e._e():a("FilmDetailPageAdd",{attrs:{id:e.id,initMode:e.mode,version:e.version},on:{"upsert-end":e.openListPage,"go-back":e.goBack}})],1)},Vw=[],Mw=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{pagination:e.pagination},on:{"filter-change":e.fetchData}},[a("div",{staticClass:"el-row"},[a("el-form",{ref:"filterForm",attrs:{rules:e.filterFormRules,model:e.filter,inline:"","label-width":"90px"}},[a("el-form-item",{staticClass:"el-col el-col-6",attrs:{prop:"tabId"}},[a("div",{staticClass:"el-col-20"},[a("InputPositiveInt",{attrs:{placeholder:"版面ID"},model:{value:e.filter.tabId,callback:function(t){e.$set(e.filter,"tabId",t)},expression:"filter.tabId"}})],1)]),a("el-form-item",{staticClass:"el-col el-col-6"},[a("div",{staticClass:"el-col-20"},[a("el-input",{attrs:{placeholder:"版面名称"},model:{value:e.filter.tabName,callback:function(t){e.$set(e.filter,"tabName",t)},expression:"filter.tabName"}})],1)]),a("el-form-item",{staticClass:"el-col el-col-6"},[a("div",{staticClass:"el-col-20"},[a("el-select",{attrs:{placeholder:"内容源",clearable:""},on:{change:function(t){e.pannelValue=[],e.filter["filmDetailPageInfo.channel"]=[]}},model:{value:e.filter["filmDetailPageInfo.source"],callback:function(t){e.$set(e.filter,"filmDetailPageInfo.source",t)},expression:"filter['filmDetailPageInfo.source']"}},[a("el-option",{attrs:{value:"qq",label:"腾讯"}}),a("el-option",{attrs:{value:"iqiyi",label:"爱奇艺"}}),a("el-option",{attrs:{value:"youku",label:"优酷"}})],1)],1)]),a("el-form-item",{staticClass:"el-col el-col-6"},[a("div",{staticClass:"el-col-20"},[a("el-select",{attrs:{clearable:"",placeholder:"状态"},model:{value:e.filter.tabStatus,callback:function(t){e.$set(e.filter,"tabStatus",t)},expression:"filter.tabStatus"}},e._l(e.tabStatusOption,function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1)]),a("el-form-item",{staticClass:"el-col el-col-6"},[a("div",{staticClass:"el-col-20"},[a("el-select",{attrs:{clearable:"",placeholder:"业务分类"},model:{value:e.filter["filmDetailPageInfo.category"],callback:function(t){e.$set(e.filter,"filmDetailPageInfo.category",t)},expression:"filter['filmDetailPageInfo.category']"}},[a("el-option",{attrs:{value:"0",label:"影视"}}),a("el-option",{attrs:{value:"1",label:"教育"}})],1)],1)]),a("el-form-item",{staticClass:"el-col el-col-6"},[a("div",{staticClass:"el-col-20"},[a("el-cascader",{attrs:{placeholder:"频道",value:e.filter["filmDetailPageInfo.channel"],options:e.channelOptions,"expand-trigger":"hover",clearable:""},on:{change:e.handleChannelChange}})],1)]),a("el-form-item",{staticClass:"el-col el-col-6"},[a("div",{staticClass:"el-col-20"},[a("el-select",{attrs:{clearable:"",placeholder:"产品包"},model:{value:e.filter["filmDetailPageInfo.product"],callback:function(t){e.$set(e.filter,"filmDetailPageInfo.product",t)},expression:"filter['filmDetailPageInfo.product']"}},e._l(e.productOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.source_name,value:e.source_sign}})}),1)],1)]),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{on:{click:e.handleFilterReset}},[e._v("重置")])],1)],1)],1),a("ButtonGroupForListPage",{attrs:{pageName:"filmDetailPage"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},Bw=[],Uw=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-input",{ref:"input",attrs:{type:"text",value:e.inputValue,disabled:e.disabled,placeholder:e.placeholder},on:{input:e.handleInputValue}},[e.prepend?a("span",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("\n    "+e._s(e.prepend)+"\n  ")]):e._e(),e.append?a("span",{attrs:{slot:"append"},slot:"append"},[e._v("\n    "+e._s(e.append)+"\n  ")]):e._e()])},jw=[],Gw={data:function(){return{inputValue:void 0}},props:["value","disabled","append","prepend","placeholder"],methods:{handleInputValue:function(e){(""===e||/^[1-9]\d*$/.test(e))&&(this.inputValue=e,this.$emit("input",e))}},created:function(){var e=this;this.$watch("value",function(t){e.inputValue!==t&&(e.inputValue=t)},{immediate:!0})}},Ww=Gw,qw=Object(Bn["a"])(Ww,Uw,jw,!1,null,null,null),Hw=qw.exports,zw={extends:Po,components:{ContentWrapper:Dn["ContentWrapper"],ButtonGroupForListPage:Ro,Table:Dn["Table"],InputPositiveInt:Hw},data:function(){var e=this;return{resourceType:"film",pannelValue:[],filter:this.genDefaultFilter(),efficientFilter:this.genDefaultFilter(),pagination:{currentPage:1},tabStatusOption:[{label:"下架",value:"0"},{label:"上架",value:"1"},{label:"草稿",value:"2"},{label:"待审核",value:"3"},{label:"审核通过",value:"4"},{label:"审核不通过",value:"5"}],productOptions:[],channelOptions:[],table:{props:{},data:[],header:[{prop:"tabId",label:"ID",sortable:!0},{prop:"tabName",label:"版面名称",minWidth:180,"show-overflow-tooltip":!0,render:function(t,a){var i=a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handleRead(i)}}},i.tabName)}},{prop:"filmDetailPageInfo.priority",label:"优先级",sortable:!0},{prop:"tabCategory",label:"业务分类",sortable:!0,formatter:function(e){return 0==e.tabCategory||67==e.tabCategory?"影视":1==e.tabCategory?"教育":""}},{prop:"filmDetailPageInfo.source",label:"内容源",sortable:!0,formatter:function(e){if(0!==e.tabCategory&&67!==e.tabCategory)return"";switch(e.filmDetailPageInfo.source){case"qq":return"腾讯";case"iqiyi":return"爱奇艺";case"youku":return"优酷"}}},{prop:"tabStatus",label:"版本/状态",sortable:!0,formatter:function(e){return e.currentVersion+"/"+["下架","上架","草稿","待审核","审核通过","审核不通过"][e.tabStatus]}},{prop:"duplicateVersion",label:"待审核副本",sortable:!0,render:function(t,a){var i=a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handleRead(i,i.duplicateVersion)}}},i.duplicateVersion)}},{prop:"lastUpdateDate",label:"更新时间",sortable:!0,width:140},{prop:"modifierName",label:"更新人",sortable:!0},{prop:"auditor",label:"审核人",sortable:!0}],selected:[],selectionType:"multiple"},selected:[],filterFormRules:{tabId:[{validator:function(e,t,a){if(t&&!/^\d+$/.test(t))return a("请输入数字");a()}}]}}},methods:{genDefaultFilter:function(){return{tabType:3,tabId:void 0,tabName:void 0,tabStatus:void 0,"filmDetailPageInfo.source":void 0,"filmDetailPageInfo.channel":[],"filmDetailPageInfo.category":void 0,"filmDetailPageInfo.product":void 0}},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.tabInfoList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows,e.table.selected=[],e.selected=[]})},parseFilter:function(){var e=this.pagination,t=JSON.parse(JSON.stringify(this.efficientFilter));e&&(t.page=e.currentPage,t.rows=e.pageSize);var a=t["filmDetailPageInfo.channel"][1];return a&&(t["filmDetailPageInfo.channel"]=a),t},handleFilterChange:function(){var e=this;this.$refs.filterForm.validate(function(t){t&&(e.pagination.currentPage=1,e.efficientFilter=Object(Ln["cloneDeep"])(e.filter),e.fetchData())})},handleFilterReset:function(){this.filter=this.genDefaultFilter(),this.efficientFilter=this.genDefaultFilter(),this.pannelValue=[],this.pagination.currentPage=1,this.fetchData()},getMediaResourceInfo:function(){var e=this;return this.$service.getMediaResourceInfo().then(function(t){var a=JSON.parse(decodeURI(t.slice(5,-1))),i=a.videoItemModels,n=i.reduce(function(e,t){return e.push(t.productList),e},[]),o=[].concat.apply([],n);e.productOptions=o;var r={label:"爱奇艺",value:"iqiyi",children:[]};r.children=i[0].categoryList.reduce(function(e,t){return e.concat({label:t.category_name,value:t.cc_category_id})},[]);var l={label:"腾讯",value:"qq",children:[]};l.children=i[1].categoryList.reduce(function(e,t){return e.concat({label:t.category_name,value:t.cc_category_id})},[]);var s={label:"优酷",value:"youku",children:[]};s.children=i[2].categoryList.reduce(function(e,t){return e.concat({label:t.category_name,value:t.cc_category_id})},[]),e.channelOptions.push(r),e.channelOptions.push(l),e.channelOptions.push(s)})},handleChannelChange:function(e){this.filter["filmDetailPageInfo.source"]="",this.filter["filmDetailPageInfo.source"]=e[0]}},created:function(){this.getMediaResourceInfo().then(function(){}),this.fetchData()}},Jw=zw,Kw=(a("6d0a"),Object(Bn["a"])(Jw,Mw,Bw,!1,null,"c838db2a",null)),Qw=Kw.exports,Xw=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("PageWrapper",[a("PageContentWrapper",{directives:[{name:"show",rawName:"v-show",value:"tab_info"===e.activePage,expression:"activePage === 'tab_info'"}]},[a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("CommonContent",{ref:"commonContent",attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{edit:function(t){e.mode="edit"},replicate:function(t){e.mode="replicate"},"submit-audit":e.btnAudit,"save-draft":e.btnSave,"select-version":e.fetchData,unaudit:function(t){return e.$emit("upsert-end")},shelves:e.fetchData,audit:function(t){return e.$emit("upsert-end")},delete:function(t){return e.$emit("upsert-end",t)}}},[a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),"read"!==e.mode?[a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{rules:e.rules,model:e.form,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"版面名称",prop:"tabName"}},[a("el-input",{model:{value:e.form.tabName,callback:function(t){e.$set(e.form,"tabName",t)},expression:"form.tabName"}})],1),a("el-form-item",{attrs:{label:"业务分类"}},[a("el-select",{attrs:{disabled:e.categoryEdit},model:{value:e.form.tabCategory,callback:function(t){e.$set(e.form,"tabCategory",t)},expression:"form.tabCategory"}},[a("el-option",{attrs:{label:"影视",value:0}}),a("el-option",{attrs:{label:"教育",value:1}})],1)],1),0==e.form.tabCategory?a("el-form-item",{attrs:{label:"内容源"}},[a("el-radio-group",{nativeOn:{change:function(t){return t.preventDefault(),e.changeResource(t)}},model:{value:e.form.tabResource,callback:function(t){e.$set(e.form,"tabResource",t)},expression:"form.tabResource"}},[a("el-radio",{attrs:{label:"qq"}},[e._v("腾讯")]),a("el-radio",{attrs:{label:"iqiyi"}},[e._v("爱奇艺")]),a("el-radio",{attrs:{label:"youku"}},[e._v("优酷")])],1)],1):e._e(),a("el-form-item",{attrs:{label:"频道"}},[a("el-select",{model:{value:e.pannel,callback:function(t){e.pannel=t},expression:"pannel"}},[a("el-option",{attrs:{value:"0",label:"不限"}}),e._l(e.pannelItems,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})],2)],1),a("el-form-item",{attrs:{label:"产品包"}},[a("el-select",{model:{value:e.product,callback:function(t){e.product=t},expression:"product"}},[a("el-option",{attrs:{value:"0",label:"不限"}}),e._l(e.productItems,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})],2)],1),a("el-form-item",{attrs:{label:"优先级"}},[a("el-input-number",{attrs:{min:1},model:{value:e.form.priority,callback:function(t){e.$set(e.form,"priority",t)},expression:"form.priority"}}),a("span",{staticClass:"remarks marginL"},[e._v("注：数值越大优先级越高，数值越小优先级越低")])],1),a("el-form-item",{attrs:{label:"选择版块",prop:"tags"}},[a("cc-panel-selector-el",{ref:"panelSelector",attrs:{source:e.form.tabResource},on:{"select-end":e.handleSelectPanelEnd}}),a("el-dropdown",[a("el-button",{staticClass:"marginL",attrs:{type:"primary",plain:""}},[e._v("\n                    添加版块\n                    "),a("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(t){e.activePage="panel"}}},[e._v("常规版块")]),a("el-dropdown-item",{nativeOn:{click:function(t){e.activePage="album_panel"}}},[e._v("业务专辑")]),a("el-dropdown-item",{nativeOn:{click:function(t){e.activePage="private_panel"}}},[e._v("专属影院")])],1)],1),a("OrderableTable",{staticClass:"orderableTable",attrs:{header:e.tabGroupTableHeader,"hide-action":!0},model:{value:e.form.panelInfoList,callback:function(t){e.$set(e.form,"panelInfoList",t)},expression:"form.panelInfoList"}})],1)],1)]:e._e(),"read"===e.mode?[a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{rules:e.rules,model:e.form,"label-width":"90px"}},[a("el-form-item",{attrs:{label:"版面名称",prop:"tabName"}},[e._v(e._s(e.form.tabName))]),a("el-form-item",{attrs:{label:"业务分类",prop:"tabCategory"}},[e._v(e._s(0==e.form.tabCategory?"影视":"教育"))]),0==e.form.tabCategory?a("el-form-item",{attrs:{label:"内容源",prop:"tabResource"}},[e._v(e._s(e.sourceText[e.form.tabResource]))]):e._e(),a("el-form-item",{attrs:{label:"频道"}},[a("el-select",{attrs:{disabled:!0},model:{value:e.pannel,callback:function(t){e.pannel=t},expression:"pannel"}},[a("el-option",{attrs:{value:"0",label:"不限"}}),e._l(e.pannelItems,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})],2)],1),a("el-form-item",{attrs:{label:"产品包"}},[a("el-select",{attrs:{disabled:!0},model:{value:e.product,callback:function(t){e.product=t},expression:"product"}},[a("el-option",{attrs:{value:"0",label:"不限"}}),e._l(e.productItems,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})],2)],1),a("el-form-item",{attrs:{label:"优先级",prop:"priority"}},[e._v("\n              "+e._s(e.form.priority)+"\n            ")]),a("el-form-item",{attrs:{label:"选择的版块",prop:"tags"}},[a("OrderableTable",{staticClass:"orderableTable",attrs:{header:e.tabGroupTableHeader,"hide-action":!0,readonly:!0},model:{value:e.form.panelInfoList,callback:function(t){e.$set(e.form,"panelInfoList",t)},expression:"form.panelInfoList"}})],1)],1)]:e._e()],2)],1)],1),"panel_preview"===e.activePage?a("PageContentWrapper",[[5,9,10].indexOf(e.panelPreview.dataType)>-1?a("PrivatePanelInfo",{attrs:{"title-prefix":e.title,"init-mode":e.panelPreview.initMode,id:e.panelPreview.id,version:e.panelPreview.version},on:{"upsert-end":e.handlePreviewPanelEnd,"go-back":e.handlePreviewPanelEnd}}):a("PanelInfo",{attrs:{"title-prefix":e.title,"init-mode":e.panelPreview.initMode,id:e.panelPreview.id,version:e.panelPreview.version,"panel-data-type":e.panelPreview.dataType,"init-group-index":e.panelPreview.initGroupIndex,"init-block-index":e.panelPreview.initBlockIndex},on:{"upsert-end":e.handlePreviewPanelEnd,"go-back":e.handlePreviewPanelEnd}})],1):e._e(),"panel"===e.activePage?a("PageContentWrapper",[a("PanelInfo",{attrs:{"title-prefix":e.title,"init-mode":"create","panel-data-type":1},on:{"upsert-end":function(t){e.activePage="tab_info"},"go-back":function(t){e.activePage="tab_info"}}})],1):e._e(),"album_panel"===e.activePage?a("PageContentWrapper",[a("PanelInfo",{attrs:{"title-prefix":e.title,"init-mode":"create","panel-data-type":3},on:{"upsert-end":function(t){e.activePage="tab_info"},"go-back":function(t){e.activePage="tab_info"}}})],1):e._e(),"private_panel"===e.activePage?a("PageContentWrapper",[a("PrivatePanelInfo",{attrs:{"title-prefix":e.title,"init-mode":"create"},on:{"upsert-end":function(t){e.activePage="tab_info"},"go-back":function(t){e.activePage="tab_info"}}})],1):e._e()],1)},Yw=[],Zw={mixins:[zu],components:{PageWrapper:Mu,PageContentWrapper:qu,"cc-panel-selector-el":Ab,Table:Dn["Table"],PrivatePanelInfo:Jh,PanelInfo:Jp,OrderableTable:fb,SelectHourAndMinute:xw,CommonContent:Us},props:{id:Number,initMode:String,version:{type:String,default:function(){return""}}},watch:{"form.tabCategory":{deep:!0,handler:function(e,t){1===e?(this.pannelItems=this.eduProductItems.categoryList,this.productItems=this.eduProductItems.productList,0===this.eduProductItems.categoryList.length&&(this.pannel="不限"),0===this.tabResourceFlag?this.tabResourceFlag=1:(this.pannel="",this.product="")):0===e&&this.handleTabResourceChange(this.form.tabResource)}},"form.tabResource":function(e,t){this.handleTabResourceChange(e)}},data:function(){return{activePage:"tab_info",panelPreview:{panel:null,id:void 0,version:void 0,initMode:void 0,initGroupIndex:void 0,initBlockIndex:void 0},resourceName:"影片详情页",mode:"create",rules:{tabName:[{required:!0,message:"请输入主题名称",trigger:"blur"}]},sourceText:{qq:"腾讯",iqiyi:"爱奇艺",youku:"优酷"},form:{tabId:void 0,tabName:"",tabParentType:"special",tabCategory:0,tabResource:"qq",priority:1,currentVersion:"",currentStatus:"",panelInfoList:[]},globalTabResource:"",parentResource:"",tabResourceFlag:1,iqiyiSource:[],qqSource:[],youkuSource:[],pannel:"",pannelItems:[],product:"",productItems:[],eduProductItems:[],blockTable:[],categoryEdit:!1}},computed:{resourceInfo:function(){var e=this.form;if(e.tabId)return{id:e.tabId,version:e.currentVersion,status:e.currentStatus,type:"tab",menuElId:"tabInfo"}},isDisableTabType:function(){var e=this.mode;return"edit"===e||"replicate"===e||"copy"===e},tabGroupTableHeader:function(){var e=this,t=[{label:"版块ID",prop:"pannelGroupId"},{label:"版块名称",width:180,render:function(t,a){a.$index;var i=a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handlePreviewPanel(i)}}},i.pannelGroupRemark)}},{prop:"duplicateVersion",label:"待审核副本",width:180,render:function(t,a){a.$index;var i=a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handlePreviewPanel(i,i.duplicateVersion)}}},i.duplicateVersion)}}];return"read"!==this.mode&&t.push({label:"操作",width:80,render:function(t,a){var i=a.$index;a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handleRemovePanel(i)}}},"删除")}}),t}},methods:{handlePreviewPanel:function(e,t){var a=e,i=t||a.currentVersion;a.pannelGroupId>0?(this.activePage="panel_preview",this.panelPreview={panel:a,initMode:"read",id:a.pannelGroupId,dataType:a.pannelType,version:i}):this.$message({type:"error",message:"版块来自第三方数据，无法预览"})},handlePreviewPanelEnd:function(){var e=this.panelPreview.panel;this.updatePanelVersion(e),this.panelPreview=null,this.activePage="tab_info"},handleSelectPanelEnd:function(e){var t=this.form.panelInfoList||[];0===t.length&&(t=[{pannelGroupId:"-1002",pannelGroupRemark:"花絮"},{pannelGroupId:"-1001",pannelGroupRemark:"相关推荐"},{pannelGroupId:"-1003",pannelGroupRemark:"相关明星"}]);var a=e||[],i=t.reduce(function(e,t,a){return e[t.pannelGroupId]=a,e},{}),n=[];a.forEach(function(e){var t=i[e.pannelGroupId];void 0===t&&n.push(e)}),this.form.panelInfoList=t.concat(n)},updatePanelVersion:function(e,t){this.$service.panelPageList({pannelType:e.pannelType,pannelId:e.pannelGroupId}).then(function(a){var i=a.rows[0];Object.assign(e,i),t&&t()})},btnAudit:function(){this.save(3)},btnSave:function(){this.save(2)},save:function(e){var t=this;if(0===this.form.panelInfoList.length)return this.$message("请添加版块"),!1;var a=this.form;this.$refs.form.validate(function(i){if(i){a.panelInfoList&&(a.panelInfoList=a.panelInfoList.map(function(e,t){return{pannelGroupId:e.pannelGroupId,pannelSequence:t,isDmpPanel:!1}}));var n={tabParentType:"special",tabId:a.tabId,tabName:a.tabName,tabType:3,tabStatus:e,tabResource:0===a.tabCategory?a.tabResource:"",currentVersion:a.currentVersion,tabCategory:a.tabCategory,hasSubTab:0,tabCnTitle:a.tabName,filmDetailPageInfo:{source:0===a.tabCategory?a.tabResource:"",product:t.product||"0",channel:t.pannel||"0",category:a.tabCategory,priority:a.priority},panelInfoList:a.panelInfoList};console.log(n),t.$service.tabInfoUpsert(n,"保存成功").then(function(e){t.$emit("upsert-end")})}else t.$message("请将表单填写完整")})},changeResource:function(e){var t=this;this.$confirm("是否要切换内容源，切换内容源之后所选择的版块数据将会清除掉！","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$message({type:"success",message:"内容源切换成功!"}),t.form.panelInfoList=[]}).catch(function(){t.$message({type:"info",message:"已取消切换"})})},handleRemovePanel:function(e){this.form.panelInfoList.splice(e,1)},getMediaResourceInfos:function(){var e=this,t=function(e,t,a){return e.map(function(e){return{label:e[t],value:e[a]}})};return this.$service.getMediaResourceInfo().then(function(a){var i=JSON.parse(decodeURI(a.slice(5,-1))),n=i.videoItemModels,o={categoryList:[],productList:[]};o.categoryList=t(n[0].categoryList,"category_name","cc_category_id"),o.productList=t(n[0].productList,"source_name","source_sign"),e.iqiyiSource=o;var r={categoryList:[],productList:[]};r.categoryList=t(n[1].categoryList,"category_name","cc_category_id"),r.productList=t(n[1].productList,"source_name","source_sign"),e.qqSource=r;var l={categoryList:[],productList:[]};l.categoryList=t(n[2].categoryList,"category_name","cc_category_id"),l.productList=t(n[2].productList,"source_name","source_sign"),e.youkuSource=l;var s={categoryList:[],productList:[]};s.categoryList=t(n[3].categoryList,"category_name","cc_category_id"),s.productList=t(n[3].productList,"source_name","source_sign"),e.eduProductItems=s})},handleTabResourceChange:function(e){var t=this.qqSource,a=this.iqiyiSource,i=this.youkuSource;switch(0===this.tabResourceFlag&&this.globalTabResource===e?this.tabResourceFlag=1:(this.pannel="",this.product=""),e){case"qq":this.pannelItems=t.categoryList,this.productItems=t.productList;break;case"iqiyi":this.pannelItems=a.categoryList,this.productItems=a.productList;break;case"youku":this.pannelItems=i.categoryList,this.productItems=i.productList;break;default:this.pannelItems=[],this.productItems=[]}},setFormInfo:function(e){this.form.tabId=e.tabId,this.form.tabName=e.tabName,this.form.tabCategory=e.tabCategory,this.form.priority=e.filmDetailPageInfo.priority,this.form.tabResource=e.tabResource,this.form.currentVersion=e.currentVersion,this.form.currentStatus=e.tabStatus,this.globalTabResource=e.tabResource,this.pannel=e.filmDetailPageInfo.channel,this.product=e.filmDetailPageInfo.product,this.form.panelInfoList=e.panelInfoList.map(function(e){return e.pannelGroupRemark=e.pannelName,e}),this.tabResourceFlag=0},fetchData:function(e){var t=this;this.$service.tabInfoGet({id:this.id,version:e,tabType:3}).then(function(e){t.setFormInfo(e)})}},created:function(){var e=this;this.mode=this.initMode||"create",this.getMediaResourceInfos().then(function(){e.handleTabResourceChange(e.form.tabResource),e.id&&(e.categoryEdit=!0,e.form.tabResource="",e.fetchData(e.version))})}},eI=Zw,tI=(a("8a6e"),Object(Bn["a"])(eI,Xw,Yw,!1,null,"6c5cbca0",null)),aI=tI.exports,iI={components:{FilmDetailPageList:Qw,FilmDetailPageAdd:aI},data:function(){return{isShowList:!0,id:void 0,mode:"",version:""}},methods:{handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e.tabId,this.mode="edit",this.isShowList=!1},handleRead:function(e,t){this.id=e.tabId,this.mode="read",this.version=t,this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.businessTabDelete({id:e.map(function(e){return e.tabId}).join(",")},"删除成功").then(function(e){t.$refs.list.fetchData()})},goBack:function(){this.isShowList=!0},openListPage:function(){this.isShowList=!0,this.$refs.list.fetchData()}}},nI=iI,oI=Object(Bn["a"])(nI,Aw,Vw,!1,null,"965204e4",null),rI=oI.exports,lI=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("TabInfoList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{create:e.handleCreate,read:e.handleRead,edit:e.handleEdit,copy:e.handleCopy,delete:e.handleDelete}}),e.isShowList?e._e():a("TabInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},sI=[],cI=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{ref:"contentCard",staticClass:"content"},[a("ContentWrapper",{attrs:{pagination:e.pagination},on:{"filter-change":e.fetchData}},[a("el-form",{ref:"form",staticClass:"form",attrs:{inline:"","label-width":"90px"},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},[a("el-form-item",{staticClass:"el-col-6"},[a("InputPositiveInt",{attrs:{placeholder:"版面ID"},model:{value:e.filter.tabId,callback:function(t){e.$set(e.filter,"tabId",t)},expression:"filter.tabId"}})],1),a("el-form-item",{staticClass:"el-col-6"},[a("el-input",{attrs:{placeholder:"版面标题"},model:{value:e.filter.tabName,callback:function(t){e.$set(e.filter,"tabName",t)},expression:"filter.tabName"}})],1),a("el-form-item",{staticClass:"el-col-6"},[a("el-select",{attrs:{placeholder:"版面属性"},model:{value:e.filter.tabType,callback:function(t){e.$set(e.filter,"tabType",t)},expression:"filter.tabType"}},e._l(e.tabTypeOption,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{staticClass:"el-col-6"},[a("el-select",{attrs:{clearable:"",placeholder:"是否二级tab"},model:{value:e.filter.hasSubTab,callback:function(t){e.$set(e.filter,"hasSubTab",t)},expression:"filter.hasSubTab"}},[a("el-option",{attrs:{value:"1",label:"是"}}),a("el-option",{attrs:{value:"0",label:"否"}})],1)],1),a("el-form-item",{staticClass:"el-col-6"},[a("el-select",{attrs:{placeholder:"业务分类"},model:{value:e.filter.tabCategory,callback:function(t){e.$set(e.filter,"tabCategory",t)},expression:"filter.tabCategory"}},[a("el-option",{attrs:{value:""}},[e._v("请选择")]),e._l(e.businessType,function(e,t){return a("el-option",{key:t,attrs:{label:e.dictCnName,value:e.dictId}})})],2)],1),a("el-form-item",{staticClass:"el-col-6"},[a("el-select",{attrs:{placeholder:"AppId"},model:{value:e.filter.tabAppid,callback:function(t){e.$set(e.filter,"tabAppid",t)},expression:"filter.tabAppid"}},e._l(e.appIdType,function(e){return a("el-option",{key:e.dictEnName,attrs:{label:e.dictCnName,value:e.dictEnName}})}),1)],1),a("el-form-item",{staticClass:"el-col-6"},[a("el-select",{attrs:{placeholder:"状态"},model:{value:e.filter.tabStatus,callback:function(t){e.$set(e.filter,"tabStatus",t)},expression:"filter.tabStatus"}},e._l(e.tabStatusOption,function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1),"10"!=e.$consts.idPrefix?a("el-form-item",{staticClass:"el-col-6"},[a("el-select",{attrs:{placeholder:"数据来源"},model:{value:e.filter.idPrefix,callback:function(t){e.$set(e.filter,"idPrefix",t)},expression:"filter.idPrefix"}},[a("el-option",{attrs:{value:"10",label:"酷开"}}),a("el-option",{attrs:{value:"11",label:"江苏广电"}})],1)],1):e._e(),a("el-form-item",{staticClass:"el-form-item-submit"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleFilterChange}},[e._v("查询")]),a("el-button",{on:{click:e.handleFilterReset}},[e._v("重置")])],1)],1),a("ButtonGroupForListPage",{attrs:{pageName:"tab"},on:{add:e.handleCreate,edit:e.handleEdit,delete:e.handleDelete}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},uI=[],dI={extends:Po,components:{ContentWrapper:Dn["ContentWrapper"],Table:Dn["Table"],ButtonGroupForListPage:Ro,InputPositiveInt:Hw},data:function(){var e=this;return{resourceType:"tabInfo",selected:[],tabTypeOption:[{label:"信号源版面",value:"5"},{label:"第三方版面",value:"4"},{label:"专题版面",value:"2"},{label:"普通版面",value:"1"}],tabStatusOption:[{label:"下架",value:"0"},{label:"上架",value:"1"},{label:"草稿",value:"2"},{label:"待审核",value:"3"},{label:"审核通过",value:"4"},{label:"审核不通过",value:"5"}],businessType:[],filter:this.genDefaultFilter(),efficientFilter:this.genDefaultFilter(),appIdType:[],filterSchema:null,pagination:{currentPage:1},table:{props:{},data:[],header:[{label:"ID",prop:"tabId"},{label:"名称",prop:"tabName","show-overflow-tooltip":!0,render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(i)}}},i.tabName)}},{label:"版面属性",prop:"tabType",formatter:function(e){var t=e.tabType;return{1:"普通版面",2:"专题版面",4:"第三方版面",5:"信号源版面"}[t+""]||"未知版面"}},{label:"业务分类",prop:"businessCategoryName"},{label:"内容源",prop:"tabResource",formatter:function(e){var t=e.tabResource;return{o_tencent:"腾讯",o_iqiyi:"爱奇艺",o_voole:"优朋"}[t+""]||""}},{label:"AppId",prop:"tabAppid",formatter:function(t){return e.appIdType.map(function(e){if(t.tabAppid.toString()===e.dictEnName)return e.dictCnName})}},{label:"版本/状态",prop:"tabStatus",formatter:function(t){var a=t.tabStatus,i=t.currentVersion;return i+"/"+e.tabStatusOption.map(function(e){if(a.toString()===e.value)return e.label}).join("")}},{label:"待审核副本",prop:"duplicateVersion",render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(i,i.duplicateVersion)}}},i.duplicateVersion)}},{label:"更新时间",prop:"lastUpdateDate",width:140},{label:"审核人",prop:"auditor",width:100},{label:"更新人",prop:"modifierName",width:100},{label:"操作",width:180,fixed:"right",render:function(t,a){var i=a.row;return t("div",[t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleCopy(i)}}},"复制"),t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleToggleCollect(i)}}},[t("el-icon",{class:i.collected?"el-icon-star-on":"el-icon-star-off"}),i.collected?"取消":"收藏"]),!!i.showContentAuthSettingBtn&&t("el-button",{props:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleOpenContentAuthManager(i)}}},"内容权限")])}}],selected:[],selectionType:"multiple"}}},methods:{handleOpenContentAuthManager:function(e){this.$refs.contentCard.handleShowContentAuthManager({id:e.tabId,type:"tab",menuElId:"tabInfo"})},genDefaultFilter:function(){return{idPrefix:this.$consts.idPrefix}},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();if(t.tabId&&!/^\d+$/.test(t.tabId))return this.$message({type:"error",message:"ID 必须为正整数"});this.$service.tabInfoList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.pagination,t=JSON.parse(JSON.stringify(this.efficientFilter));return e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(){this.pagination.currentPage=1,this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.fetchData()},handleFilterReset:function(){this.filter=this.genDefaultFilter(),this.efficientFilter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},addTabInfo:function(){this.$emit("create")},editData:function(){var e=this.table,t=this.table.selected,a=e.data[t[0]];this.$emit("edit",a)},getBusinessType:function(){var e=this;this.$service.getDictType({type:"businessType"}).then(function(t){e.businessType=t})},handleToggleCollect:function(e){var t=this;e.collected?this.$service.collectCancel({type:"tab",data:{resourceId:e.tabId}},"取消收藏成功").then(function(){t.$set(e,"collected",!1)}):this.$service.collect({type:"tab",data:{resourceId:e.tabId}},"收藏成功").then(function(){t.$set(e,"collected",!0)})}},created:function(){var e=this;this.$service.getDictType({type:"appIdType"}).then(function(t){e.appIdType=t,e.fetchData()}),this.getBusinessType()}},pI=dI,hI=(a("554f"),Object(Bn["a"])(pI,cI,uI,!1,null,"307f81ba",null)),mI=hI.exports,fI={components:{TabInfoList:mI,TabInfo:Ov},data:function(){return{isShowList:!0,id:null,mode:"create",version:void 0}},methods:{handleCreate:function(){this.id=void 0,this.mode="create",this.isShowList=!1},handleEdit:function(e){this.id=e.tabId,this.mode="edit",this.isShowList=!1},handleRead:function(e,t){this.id=e.tabId,this.mode="read",this.version=t,this.isShowList=!1},handleCopy:function(e){this.id=e.tabId,this.mode="copy",this.isShowList=!1},handleDelete:function(e){var t=this;this.$service.tabInfoRemove({id:e.map(function(e){return e.tabId}).join(",")},"删除成功").then(function(){t.$refs.list.fetchData()})},handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},goBack:function(){this.isShowList=!0,this.mode="list"}}},gI=fI,bI=Object(Bn["a"])(gI,lI,sI,!1,null,null,null),vI=bI.exports,yI=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("VideoSelector",{ref:"video-selector",attrs:{"selection-type":"none"}})],1)},wI=[],II={components:{VideoSelector:Pl}},CI=II,TI=(a("adca"),Object(Bn["a"])(CI,yI,wI,!1,null,"5daded01",null)),SI=TI.exports,kI=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("div",[a("el-form",{ref:"form",staticClass:"admin-control-content",attrs:{model:e.form,rules:e.rules,"label-width":"200px"}},[a("el-form-item",{attrs:{label:"是否开启管理后台缓存",prop:"openCache"}},[a("el-select",{model:{value:e.form.openCache,callback:function(t){e.$set(e.form,"openCache",t)},expression:"form.openCache"}},e._l(e.cacheItems,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"缓存版本",prop:"cacheVersion"}},[a("el-input",{model:{value:e.form.cacheVersion,callback:function(t){e.$set(e.form,"cacheVersion",t)},expression:"form.cacheVersion"}})],1),a("el-form-item",{attrs:{label:"媒资回溯策略",prop:"mediaRecallPolicy"}},[a("el-select",{model:{value:e.form.mediaRecallPolicy,callback:function(t){e.$set(e.form,"mediaRecallPolicy",t)},expression:"form.mediaRecallPolicy"}},e._l(e.callBackItems,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("保存修改")])],1)],1)],1)])},_I=[],PI={data:function(){return{form:{openCache:"",cacheVersion:"",mediaRecallPolicy:""},id:1,cacheItems:[{label:"开启缓存",value:1},{label:"关闭缓存",value:0}],callBackItems:[{label:"推送",value:"push"},{label:"定时",value:"polling"},{label:"不回溯",value:"none"}],rules:{openCache:[{required:!0,message:"请选择是否开启缓存",trigger:"blur"}],cacheVersion:[{required:!0,message:"请输入缓存版本",trigger:"blur"}],mediaRecallPolicy:[{required:!0,message:"请选择媒资回溯策略",trigger:"blur"}]}}},methods:{fetchData:function(){var e=this;this.$service.getAdminMasterControllInfo({id:this.id}).then(function(t){console.log(t),e.form=t})},submitForm:function(){var e=this;this.$refs.form.validate(function(t){t&&e.$service.saveAdminMasterControll({jsonStr:JSON.stringify(e.form)},"保存成功").then(function(e){console.log(e)})})}},created:function(){this.fetchData()}},xI=PI,DI=(a("ec25"),Object(Bn["a"])(xI,kI,_I,!1,null,"5d5b563a",null)),FI=(DI.exports,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("DataDictionaryList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{"open-add-page":e.openAddPage}}),e.isShowList?e._e():a("DataDictionaryAdd",{attrs:{editData:e.editData},on:{"open-list-page":e.openListPage,"go-back":e.goBack}})],1)}),$I=[],LI=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("div",{staticClass:"btns"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.addDict}},[e._v("新增")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.editData}},[e._v("编辑")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.batchDel}},[e._v("删除")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("新增字典分类")])],1),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}}),a("el-dialog",{attrs:{title:"添加字典分类",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"140px","label-position":e.labelPosition}},[a("el-form-item",{attrs:{label:"字典分类名称",prop:"dictCategoryCnName"}},[a("el-input",{model:{value:e.ruleForm.dictCategoryCnName,callback:function(t){e.$set(e.ruleForm,"dictCategoryCnName",t)},expression:"ruleForm.dictCategoryCnName"}})],1),a("el-form-item",{attrs:{label:"字典分类值",prop:"dictCategoryEnName"}},[a("el-input",{model:{value:e.ruleForm.dictCategoryEnName,callback:function(t){e.$set(e.ruleForm,"dictCategoryEnName",t)},expression:"ruleForm.dictCategoryEnName"}})],1),a("el-form-item",[a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("确定")]),a("el-button",{staticStyle:{float:"right","margin-right":"15px"},on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("取消")])],1)],1)],1)],1)],1)},RI=[],NI={components:{ActionList:Dn["ActionList"],Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"],ButtonGroupForListPage:Ro},data:function(){return{dialogFormVisible:!1,labelPosition:"right",ruleForm:{dictCategoryEnName:"",dictCategoryCnName:""},rules:{dictCategoryCnName:[{required:!0,message:"请输入字典分类名称",trigger:"blur"}],dictCategoryEnName:[{required:!0,message:"请输入字典分类值",trigger:"blur"}]},formLabelWidth:"120px",filter:{sort:void 0,order:void 0},filterSchema:null,pagination:{},selected:[],selectedRows:{},dictCategories:{},table:{props:{},header:[{label:"ID",prop:"dictId",width:"70"},{label:"字典名称","min-width":"90",prop:"dictCnName",sortable:!0},{label:"字典值",prop:"dictEnName",width:"110",sortable:!0},{label:"字典分类",prop:"dictCategory","min-width":"160"}],data:[],selected:[],selectionType:"multiple"}}},methods:{addDict:function(){this.$emit("open-add-page",null)},editData:function(){this.$isAllowEdit(this.selected)&&this.$emit("open-add-page",this.selectedRows[this.selected[0]])},batchDel:function(){var e=this;0==this.selected.length&&this.$message("请选择一条数据"),1==this.selected.length&&this.$confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$service.DeleteDict({id:e.selected[0]},"删除成功").then(function(t){e.handleAllRowSelectionRemove(),e.fetchData()})}),this.selected.length>1&&this.$message("只能选择一条数据")},getDictCategoryList:function(){var e=this;return this.$service.getDictCategoryList().then(function(t){t.forEach(function(t){e.dictCategories[t.label]=t.value})})},submitForm:function(e){var t=this;this.$refs[e].validate(function(a){if(!a)return!1;var i={dictCategoryCnName:t.ruleForm.dictCategoryCnName,dictCategoryEnName:t.ruleForm.dictCategoryEnName};console.log(i),t.$service.SaveDictCategory(i,"保存成功").then(function(a){t.dialogFormVisible=!1,t.$refs[e].resetFields()})})},resetForm:function(e){this.dialogFormVisible=!1,this.$refs[e].resetFields()},handleCreate:function(){this.$router.push({name:"prize-create"})},handleRowSelectionAdd:function(e){this.selected.push(e.dictId);var t=e.dictId;this.selectedRows[t]=e,this.updateTableSelected()},handleRowSelectionRemove:function(e){this.selected=this.selected.filter(function(t){return t!==e.dictId}),delete this.selectedRows[e.dictId],this.updateTableSelected()},handleAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleRowSelectionAdd):(this.selected=[],this.table.selected=[])},handleAllRowSelectionRemove:function(){this.selected=[],this.table.selected=[]},updateTableSelected:function(){var e=this.table,t=this.selected;e.selected=e.data.reduce(function(e,a,i){return t.indexOf(a.dictId)>-1&&e.push(i),e},[])},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.dictId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.getDictList(t).then(function(t){console.log(t),e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=this,t=co.a.map({dictId:co.a.o.string.other("form",{component:"Input",placeholder:"ID"}),dictCnName:co.a.o.string.other("form",{component:"Input",placeholder:"字典名称"}),dictEnName:co.a.o.string.other("form",{component:"Input",placeholder:"字典值"}),dictCategory:co.a.o.enum(this.dictCategories).other("form",{component:"Select",placeholder:"字典分类"})}).other("form",{cols:{item:5,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.getDictCategoryList().then(function(){e.filterSchema=t}),this.fetchData()}},EI=NI,OI=(a("6174"),Object(Bn["a"])(EI,LI,RI,!1,null,"4dcde6c6",null)),AI=OI.exports,VI=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitBtn}},[e._v("保存")]),a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{model:e.form,rules:e.formRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"字典名称",prop:"dictCnName"}},[a("el-input",{attrs:{placeholder:"字典名称"},model:{value:e.form.dictCnName,callback:function(t){e.$set(e.form,"dictCnName",t)},expression:"form.dictCnName"}})],1),a("el-form-item",{attrs:{label:"字典值",prop:"dictEnName"}},[a("el-input",{attrs:{placeholder:"字典值"},model:{value:e.form.dictEnName,callback:function(t){e.$set(e.form,"dictEnName",t)},expression:"form.dictEnName"}})],1),a("el-form-item",{attrs:{label:"字典分类",prop:"dictCategory"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择字典分类"},model:{value:e.form.dictCategory,callback:function(t){e.$set(e.form,"dictCategory",t)},expression:"form.dictCategory"}},e._l(e.dictCategoryStr,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1)},MI=[],BI={props:{editData:{type:Object}},data:function(){return{title:null,form:{dictId:null,dictCnName:null,dictEnName:null,dictCategory:null,checked:null,createdDate:null,creater:null,dictStatus:null,flag:null,id:null,keyword:null,lastUpdateDate:null,modifier:null},dictCategoryStr:[],formRules:{dictCnName:[{required:!0,message:"请输入字典名称",trigger:"blur"}],dictEnName:[{required:!0,message:"请输入字典值",trigger:"blur"}],dictCategory:[{required:!0,message:"请选择字典分类",trigger:"blur"}]}}},methods:{getDictCategoryList:function(){var e=this;this.$service.getDictCategoryList().then(function(t){e.dictCategoryStr=t})},submitBtn:function(){var e=this;this.$refs.form.validate(function(t){if(t){var a={dictId:e.form.dictId,dictCategory:e.form.dictCategory,dictCnName:e.form.dictCnName,dictEnName:e.form.dictEnName};e.$service.SaveDictionary(a,"保存成功").then(function(t){e.$emit("open-list-page")})}})}},created:function(){null!==this.editData&&void 0!==this.editData?(this.title="编辑",this.form=this.editData):this.title="新增",this.getDictCategoryList()}},UI=BI,jI=Object(Bn["a"])(UI,VI,MI,!1,null,null,null),GI=jI.exports,WI={components:{DataDictionaryList:AI,DataDictionaryAdd:GI},data:function(){return{isShowList:!0,editData:null}},methods:{openAddPage:function(e){this.editData=e,this.isShowList=!1},openListPage:function(){this.isShowList=!0,this.$refs.list.fetchData()},goBack:function(){this.isShowList=!0}}},qI=WI,HI=Object(Bn["a"])(qI,FI,$I,!1,null,null,null),zI=(HI.exports,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("DepartmentManageList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{"open-add-page":e.openAddPage}}),e.isShowList?e._e():a("DepartmentManageAdd",{attrs:{editId:e.editId},on:{"open-list-page":e.openListPage,"go-back":e.goBack}})],1)}),JI=[],KI=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"sysDept"},on:{add:e.addDep,edit:e.editData,delete:e.batchDel}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},QI=[],XI={components:{ContentWrapper:Dn["ContentWrapper"],Table:Dn["Table"],ButtonGroupForListPage:Ro},data:function(){var e=this;return{filterSchema:null,filter:{sort:void 0,order:void 0},pagination:{},selected:[],table:{props:{},header:[{label:"部门名称",prop:"deptName",fit:!0,sortable:!0},{label:"部门电话",prop:"deptTel",fit:!0,sortable:!0},{label:"部门传真",prop:"deptFax",fit:!0,sortable:!0},{label:"是否禁用",prop:"disabled",fit:!0,sortable:!0,render:function(e,t){var a=t.row;return e("div",{style:{color:["red","green"][a.disabled]}},["否","是"][a.disabled])}},{label:"备注",prop:"remark",fit:!0,sortable:!0},{label:"排序",prop:"seq",width:100,sortable:!0,render:function(t,a){var i=a.row;return t(A["Input"],{ref:"input",props:{value:i.seq},on:{input:function(e){i.seq=e},blur:function(t){e.$service.sysDeptUpdateSeq({id:i.deptId,seq:i.seq})}}})}},{label:"部门父编号",prop:"pid",fit:!0,sortable:!0}],data:[],selected:[],selectionType:"multiple"}}},methods:{fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.sysDeptPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},addDep:function(){this.$emit("open-add-page",null)},editData:function(){this.$isAllowEdit(this.selected)&&this.$emit("open-add-page",this.selected[0])},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},handleFilterChange:function(e,t){t&&(this.filter=t),"query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData()},batchDel:function(){var e=this;0!==this.selected.length?this.$confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$service.sysDeptRemove({id:e.selected.join(",")},"删除成功").then(function(t){e.handleAllRowSelectionRemove(),e.fetchData()})}):this.$message("请选择再删除")},handleRowSelectionAdd:function(e){this.selected.push(e.deptId),this.updateTableSelected()},handleRowSelectionRemove:function(e){this.selected=this.selected.filter(function(t){return t!==e.deptId}),this.updateTableSelected()},handleAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleRowSelectionAdd):(this.selected=[],this.table.selected=[])},handleAllRowSelectionRemove:function(){this.selected=[],this.table.selected=[]},updateTableSelected:function(){var e=this.table,t=this.selected;e.selected=e.data.reduce(function(e,a,i){return t.indexOf(a.deptId)>-1&&e.push(i),e},[])}},created:function(){var e=co.a.map({deptName:co.a.o.string.other("form",{placeholder:"部门名称"}),deptTel:co.a.o.string.other("form",{placeholder:"部门电话"}),deptFax:co.a.o.string.other("form",{placeholder:"部门传真"}),remark:co.a.o.string.other("form",{placeholder:"备注"}),pid:co.a.o.number.other("form",{placeholder:"部门父编号"}),disabled:co.a.o.enum({"否":0,"是":1}).other("form",{component:"Select",placeholder:"是否禁用"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},YI=XI,ZI=(a("221a"),Object(Bn["a"])(YI,KI,QI,!1,null,"7e579133",null)),eC=ZI.exports,tC=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitBtn}},[e._v("保存")]),a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{model:e.formData,rules:e.formRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"部门名称",prop:"deptName"}},[a("el-input",{attrs:{placeholder:"部门名称"},model:{value:e.formData.deptName,callback:function(t){e.$set(e.formData,"deptName",t)},expression:"formData.deptName"}})],1),a("el-form-item",{attrs:{label:"部门电话",prop:"deptTel"}},[a("el-input",{attrs:{placeholder:"部门电话"},model:{value:e.formData.deptTel,callback:function(t){e.$set(e.formData,"deptTel",t)},expression:"formData.deptTel"}})],1),a("el-form-item",{attrs:{label:"部门传真",prop:"deptFax"}},[a("el-input",{attrs:{placeholder:"部门传真"},model:{value:e.formData.deptFax,callback:function(t){e.$set(e.formData,"deptFax",t)},expression:"formData.deptFax"}})],1),a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{attrs:{placeholder:"备注"},model:{value:e.formData.remark,callback:function(t){e.$set(e.formData,"remark",t)},expression:"formData.remark"}})],1),a("el-form-item",{attrs:{label:"排序",prop:"seq"}},[a("el-input",{attrs:{placeholder:"排序"},model:{value:e.formData.seq,callback:function(t){e.$set(e.formData,"seq",t)},expression:"formData.seq"}})],1),a("el-form-item",{attrs:{label:"上级部门",prop:"pid"}},[a("el-select",{attrs:{placeholder:"所在部门"},model:{value:e.formData.pid,callback:function(t){e.$set(e.formData,"pid",t)},expression:"formData.pid"}},[a("el-option",{attrs:{label:"无",value:"0"}}),e._l(e.pidList,function(e){return a("el-option",{key:e.deptId+"",attrs:{label:e.deptName,value:e.deptId}})})],2)],1),a("el-form-item",{attrs:{label:"是否禁用",prop:"disabled"}},[a("el-radio",{attrs:{label:"0"},model:{value:e.formData.disabled,callback:function(t){e.$set(e.formData,"disabled",t)},expression:"formData.disabled"}},[e._v("否")]),a("el-radio",{attrs:{label:"1"},model:{value:e.formData.disabled,callback:function(t){e.$set(e.formData,"disabled",t)},expression:"formData.disabled"}},[e._v("是")])],1)],1)],1)},aC=[],iC={props:{editId:Number,default:null},data:function(){return{title:null,pidList:[],formData:{deptName:"",deptTel:"",deptFax:"",remark:"",seq:null,disabled:"0",pid:"0"},formRules:{deptName:[{required:!0,message:"请输入部门名称",trigger:"blur"}],deptTel:[{required:!0,message:"请输入部门电话",trigger:"blur"}],deptFax:[{required:!0,message:"请输入部门传真",trigger:"blur"}],remark:[{required:!0,message:"请输入备注",trigger:"blur"}],seq:[{required:!0,message:"请输入序号",trigger:"blur"}]}}},methods:{submitBtn:function(){var e=this;this.$refs.form.validate(function(t){if(t){var a=e.formData;e.editId&&(a.deptId=e.editId),e.$service.sysDeptSave(a,"保存成功").then(function(){e.$emit("open-list-page")})}})},getDepts:function(){var e=this;return this.$service.getDepts().then(function(t){e.pidList=t})},getEditData:function(){var e=this;this.$service.sysDeptDetailInfo({id:this.editId}).then(function(t){Object.keys(e.formData).forEach(function(a){e.formData[a]="disabled"===a?t[a]+"":t[a]})})}},created:function(){this.getDepts(),this.editId?(this.title="编辑",this.getEditData()):this.title="新增"}},nC=iC,oC=(a("5093"),Object(Bn["a"])(nC,tC,aC,!1,null,"843622ac",null)),rC=oC.exports,lC={components:{DepartmentManageList:eC,DepartmentManageAdd:rC},data:function(){return{isShowList:!0,editId:null}},methods:{openAddPage:function(e){this.editId=e,this.isShowList=!1},openListPage:function(){this.isShowList=!0,this.$refs.list.fetchData()},goBack:function(){this.isShowList=!0}}},sC=lC,cC=Object(Bn["a"])(sC,zI,JI,!1,null,"31b2cce4",null),uC=cC.exports,dC=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("RoleConfigList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{"open-add-page":e.openAddPage}}),e.isShowList?e._e():a("RoleConfigAdd",{attrs:{editId:e.editId},on:{"open-list-page":e.openListPage,"go-back":e.goBack}})],1)},pC=[],hC=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("el-button",{attrs:{type:"primary"},on:{click:e.saveRoleInfo}},[e._v("保存")]),a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{model:e.formData,rules:e.formRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[a("el-input",{attrs:{placeholder:"用户名称"},model:{value:e.formData.roleName,callback:function(t){e.$set(e.formData,"roleName",t)},expression:"formData.roleName"}})],1),a("el-form-item",{attrs:{label:"排序号",prop:"seq"}},[a("el-input",{attrs:{placeholder:"用户名称"},model:{value:e.formData.seq,callback:function(t){e.$set(e.formData,"seq",t)},expression:"formData.seq"}})],1),a("el-form-item",{attrs:{label:"说明",prop:"roleDesc"}},[a("el-input",{attrs:{placeholder:"用户名称"},model:{value:e.formData.roleDesc,callback:function(t){e.$set(e.formData,"roleDesc",t)},expression:"formData.roleDesc"}})],1)],1)],1)},mC=[],fC={name:"RoleConfigAdd",props:{editId:void 0,index:void 0},data:function(){return{title:"",formData:{roleName:"",seq:"",roleDesc:""},formRules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"}],seq:[{required:!0,message:"请输入排序号",trigger:"blur"}],roleDesc:[{required:!0,message:"请输入角色说明",trigger:"blur"}]}}},methods:{saveRoleInfo:function(){var e=this;this.$refs.form.validate(function(t){t&&e.$service.saveRoleData({jsonStr:JSON.stringify(e.formData)},"保存成功").then(function(t){e.$emit("open-list-page")})})},getEditData:function(){var e=this;this.$service.getRoleDetailById({id:this.editId}).then(function(t){Object.keys(e.formData).forEach(function(a){e.formData[a]=t[a]})})}},created:function(){null!==this.editId&&void 0!==this.editId?(this.title="编辑",this.formData.roleId=this.editId,this.getEditData()):this.title="新增"}},gC=fC,bC=Object(Bn["a"])(gC,hC,mC,!1,null,"22803e9d",null),vC=bC.exports,yC=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"sysRole"},on:{add:e.handleCreate,edit:e.editData,delete:e.handleBatchDelete}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1),a("el-dialog",{attrs:{title:"查看用户",visible:e.viewUserDialogVisible},on:{"update:visible":function(t){e.viewUserDialogVisible=t}}},[a("el-table",{attrs:{data:e.userRoleData,border:""}},[a("el-table-column",{attrs:{label:"用户ID",property:"userId"}}),a("el-table-column",{attrs:{label:"用户名",property:"userName"}}),a("el-table-column",{attrs:{label:"公司部门",property:"deptName"}}),a("el-table-column",{attrs:{label:"电子邮箱",property:"email"}})],1)],1),a("el-dialog",{staticClass:"auth-set-window",attrs:{title:"权限设置",visible:e.setAuthDialogVisible,fullscreen:!0},on:{"update:visible":function(t){e.setAuthDialogVisible=t}}},[a("div",{staticClass:"auth-set-window__buttons"},[a("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAllValue,callback:function(t){e.checkAllValue=t},expression:"checkAllValue"}},[e._v("全选")]),a("el-button",{staticClass:"button--position",attrs:{type:"primary"},on:{click:function(t){return e.updateAuth()}}},[e._v("保存修改")]),a("el-button",{attrs:{type:"info"},on:{click:function(t){e.setAuthDialogVisible=!1}}},[e._v("关闭")])],1),a("div",{staticClass:"auth-set-window__header"},e._l(e.headerItems,function(t,i){return a("span",{key:i,staticClass:"auth-set-window__header-item"},[e._v("\n           "+e._s(t)+"\n        ")])}),0),a("div",{staticClass:"auth-set-window__content"},[a("el-tree",{attrs:{data:e.AuthList,"node-key":"menuId","default-expand-all":"","expand-on-click-node":""},scopedSlots:e._u([{key:"default",fn:function(t){t.node;var i=t.data;return a("span",{},[a("span",{staticClass:"tree-data tree-data--big-size"},[e._v(e._s(i.title))]),e._l(e.dataItems,function(e,t){return a("span",{key:t,staticClass:"tree-data",on:{click:function(e){e.stopPropagation()}}},[a("el-checkbox",{key:i.menuId+t+Math.random(),attrs:{value:1==i[e],disabled:-1==i[e],runId:t+1},on:{input:function(t){i[e]=t?"1":"0"}}})],1)})],2)}}])})],1)]),a("el-dialog",{attrs:{title:"数据权限设置",visible:e.showAuthOfCrowdDialog},on:{"update:visible":function(t){e.showAuthOfCrowdDialog=t}}},[a("div",{directives:[{name:"show",rawName:"v-show",value:0===e.policies.length,expression:"policies.length === 0"}]},[e._v("\n      加载中...\n    ")]),e._l(e.policies,function(t){return a("div",{key:t.value,staticClass:"crowd-selector"},[a("span",{staticClass:"crowd-selector__policy ellipsis",attrs:{title:t.label}},[e._v("\n        "+e._s(t.label)+"\n      ")]),a("div",{staticClass:"crowd-selector__crowd-list"},e._l(t.crowds,function(t,i){return a("el-tag",{key:i,class:{ellipsis:!0,"crowd-selector__crowd":!0,"crowd-selector__crowd--disabled":1==t.disable},attrs:{type:"info",title:t.label},nativeOn:{click:function(a){return e.handleSelectCrowd(t)}}},[e._v("\n          "+e._s(t.label)+"\n        ")])}),1)])}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showAuthOfCrowdDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSaveAuth}},[e._v("确 定")])],1)],2)],1)},wC=[],IC={components:{Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"],ButtonGroupForListPage:Ro},data:function(){var e=this;return{filter:{},filterSchema:co.a.map({roleName:co.a.o.string.other("form",{label:"角色名称",placeholder:"请输入角色名称",cols:{item:6,label:0,wrapper:18}})}).other("form",{layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}}),pagination:{},selected:[],table:{props:{},header:[{label:"角色名称",prop:"roleName"},{label:"排序号",prop:"seq",sortable:!0,render:function(t,a){var i=a.row;return t("el-input",{props:{value:i.seq,type:"text"},on:{input:function(e){i.seq=e},blur:function(){e.$service.updateSeq({id:i.roleId,seq:i.seq})}}})}},{label:"说明",prop:"roleDesc"},{label:"创建人",prop:"creatorName"},{label:"创建时间",width:"180",sortable:!0,prop:"createDate"},{label:"修改人",prop:"modifierName"},{label:"修改时间",width:"180",sortable:!0,prop:"modifyDate"},{label:"操作",fixed:"right",width:"350",render:Dn["utils"].component.createOperationRender(this,{setAuth:"设置权限",handleSetAuthOfCrowd:"设置人群权限",sysRoleView:"查看用户"})}],data:[],selected:[],selectionType:"multiple"},viewUserDialogVisible:!1,userRoleData:[],showAuthOfCrowdDialog:!1,policies:[],roleId:void 0,setAuthDialogVisible:!1,AuthList:[],isIndeterminate:!0,checkAllValue:!1,headerItems:["菜单名称","浏览","新增","编辑","删除","内容权限","搜索","刷新","打印","导入","导出","审核","认领","撤销认领","撤销审核","上架","创建副本","批量审核"],dataItems:["browser","add","edit","delete","contentAuthSetting","search","refresh","print","inport","export","audit","claim","unclaim","unaudit","shelves","copy","batchAudit"]}},methods:{parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},handleCreate:function(){this.$emit("open-add-page",null)},handleBatchDelete:function(){var e=this;0!==this.selected.length?this.$confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$service.deleteRole({id:e.selected.join(",")},"删除成功").then(function(t){e.handleAllRowSelectionRemove(),e.fetchData()})}):this.$message("请选择再删除")},editData:function(){this.$isAllowEdit(this.selected)&&this.$emit("open-add-page",this.selected[0])},handleFilterChange:function(e){"query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData()},handleFilterReset:function(){this.filter={roleName:void 0},this.pagination.currentPage=1,this.fetchData()},handleRowSelectionAdd:function(e){this.selected.push(e.roleId),this.updateTableSelected()},handleRowSelectionRemove:function(e){this.selected=this.selected.filter(function(t){return t!==e.roleId}),this.updateTableSelected()},handleAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleRowSelectionAdd):(this.selected=[],this.table.selected=[])},handleAllRowSelectionRemove:function(){this.selected=[],this.table.selected=[]},updateTableSelected:function(){var e=this.table,t=this.selected;e.selected=e.data.reduce(function(e,a,i){return t.indexOf(a.roleId)>-1&&e.push(i),e},[])},handleCheckAllChange:function(e){this.checkAllValue=e,this.isIndeterminate=!1;var t=this.dataItems;function a(i){i.forEach(function(i){t.forEach(function(t){"-1"!==i[t]&&(i[t]=e?"1":"0")}),i.children&&a(i.children)})}a(this.AuthList)},updateAuth:function(){var e=this,t=this.roleId,a=this.dataItems,i=[];function n(e){e.forEach(function(e){a.forEach(function(t,a){"1"===e[t]&&i.push({menuId:e["menuId"],runId:(a+1).toString()})}),e.children&&n(e.children)})}n(this.AuthList),this.$service.saveAuthOfRole({roleId:t,mrs:JSON.stringify(i)},"设置成功").then(function(){e.setAuthDialogVisible=!1})},setAuth:function(e){var t=this,a=e.row;this.$service.getAuthList({roleId:a.roleId}).then(function(e){console.log(e),t.setAuthDialogVisible=!0,t.AuthList=e,t.roleId=a.roleId})},fetchPolicies:function(e){var t=this;this.$service.getTaglist({roleId:e,type:"crowdPolicy"}).then(function(a){t.policies=a,a.forEach(function(a){t.$service.getTaglist({id:a.value,roleId:e,type:"crowd"}).then(function(e){console.log(e),t.$set(a,"crowds",e)})})})},handleSelectCrowd:function(e){e.disable=1===e.disable?0:1},handleSetAuthOfCrowd:function(e){var t=e.row;this.showAuthOfCrowdDialog=!0,this.policies=[],this.roleId=t.roleId,this.fetchPolicies(t.roleId)},handleSaveAuth:function(){var e=this,t=this.roleId,a=[],i=[],n=this.policies;n.forEach(function(e){var t=!0;e.crowds.forEach(function(e){1===e.disable?a.push(e.value):t=!1}),!1!==t&&e.crowds.length>0&&i.push(e.value)}),this.$service.setCrowdAuthOfRole({roleId:t,disableTagInfoList:[{type:"crowd",tagIds:a},{type:"crowdPolicy",tagIds:i}]},"设置成功").then(function(){e.showAuthOfCrowdDialog=!1})},sysRoleView:function(e){var t=this,a=e.row;this.viewUserDialogVisible=!0;var i=a.roleId;this.$service.userRoleList({roleId:i}).then(function(e){t.userRoleData=e})},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.getRoleList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){this.fetchData()}},CC=IC,TC=(a("455a"),Object(Bn["a"])(CC,yC,wC,!1,null,"d9a4af5e",null)),SC=TC.exports,kC={components:{RoleConfigAdd:vC,RoleConfigList:SC},data:function(){return{isShowList:!0,editId:void 0,index:void 0}},methods:{openAddPage:function(e){this.editId=e,this.isShowList=!1},openListPage:function(){this.isShowList=!0,this.$refs.list.fetchData()},goBack:function(){this.isShowList=!0}}},_C=kC,PC=Object(Bn["a"])(_C,dC,pC,!1,null,null,null),xC=PC.exports,DC=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},FC=[],$C={components:{ActionList:Dn["ActionList"],Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"]},data:function(){return{filter:{sort:void 0,order:void 0},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"id",width:"70"},{label:"用户名",width:"130",prop:"userName"},{label:"用户编号",prop:"userId",width:"90"},{label:"登录时间",prop:"loginTime",width:"150"},{label:"用户IP",prop:"loginIp",width:"150"},{label:"用户浏览器信息",prop:"userAgent","min-width":"100"},{label:"登录类型",prop:"loginType",width:"100"},{label:"说明",prop:"remark",width:"100"}],data:[],selected:[],selectionType:"multiple"}}},methods:{handleCreate:function(){this.$router.push({name:"prize-create"})},handleRowSelectionAdd:function(e){this.selected.push(e.id),this.updateTableSelected()},handleRowSelectionRemove:function(e){this.selected=this.selected.filter(function(t){return t!==e.id}),this.updateTableSelected()},handleAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleRowSelectionAdd):(this.selected=[],this.table.selected=[])},handleAllRowSelectionRemove:function(){this.selected=[],this.table.selected=[]},updateTableSelected:function(){var e=this.table,t=this.selected;e.selected=e.data.reduce(function(e,a,i){return t.indexOf(a.id)>-1&&e.push(i),e},[])},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.id)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();this.$service.getLoginLogList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=co.a.map({userName:co.a.o.string.other("form",{component:"Input",placeholder:"用户名  "}),id:co.a.o.string.other("form",{component:"Input",placeholder:"ID  "}),loginIp:co.a.o.string.other("form",{component:"Input",placeholder:"用户登陆IP"}),loginType:co.a.o.string.other("form",{component:"Input",placeholder:"登陆类型"})}).other("form",{cols:{item:5,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},LC=$C,RC=(a("aaf9"),Object(Bn["a"])(LC,DC,FC,!1,null,"716c6c21",null)),NC=RC.exports,EC=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data}})],1)],1)},OC=[],AC={components:{ActionList:Dn["ActionList"],Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"]},data:function(){var e=this;return{filter:{sort:void 0,order:void 0},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"自增ID",prop:"id",width:"70",sortable:!0},{label:"操作者ID",prop:"userId",width:"60",sortable:!0},{label:"操作名称",prop:"userName"},{label:"菜单名称",prop:"menuName"},{label:"菜单Elid",prop:"menuElid"},{label:"执行的方法",prop:"execMethod"},{label:"操作的数据",prop:"opData",render:function(e,t){var a=t.row;return e(A["Tooltip"],{props:{content:a.opData,placement:"top"}},[e("div",{class:"operatiton-data"},[a.opData])])}},{label:"操作耗时",prop:"elapsedTime",fit:!0,sortable:!0},{label:"操作时间",prop:"createTime",fit:!0},{label:"操作",width:"90",fixed:"right",render:function(t,a){var i=a.row;return t(A["Button"],{props:{type:"success",icon:"el-icon-plus"},on:{click:e.handleCopy.bind(e,i)}},["复制"])}}],data:[],selected:[],selectionType:"multiple"}}},methods:{handleCopy:function(e){var t=e.opData,a=document.createElement("textarea");a.style.position="fixed",a.style.top="0",a.style.left="0",a.style.width="2em",a.style.height="2em",a.style.padding="0",a.style.border="none",a.style.outline="none",a.style.boxShadow="none",a.style.background="transparent",a.value=t,document.body.appendChild(a),a.select();try{var i=document.execCommand("copy");i&&this.$message({showClose:!0,message:"复制成功",type:"success"})}catch(n){this.$message({showClose:!0,message:"复制失败",type:"warning"})}document.body.removeChild(a)},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.id)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();this.$service.sysLogOpPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=co.a.map({id:co.a.o.string.other("form",{component:"Input",placeholder:"ID  "}),userId:co.a.o.string.other("form",{component:"Input",placeholder:"操作者ID  "}),userName:co.a.o.string.other("form",{component:"Input",placeholder:"操作者名称"}),menuName:co.a.o.string.other("form",{component:"Input",placeholder:"菜单名称"}),menuElid:co.a.o.string.other("form",{component:"Input",placeholder:"菜单Elid  "}),execMethod:co.a.o.string.other("form",{component:"Input",placeholder:"执行的方法  "}),elapsedTime:co.a.o.string.other("form",{component:"Input",placeholder:"操作耗时"}),createTime:co.a.o.string.other("form",{component:"Input",placeholder:"操作耗时"}),opData:co.a.o.string.other("form",{component:"Input",type:"textarea",placeholder:"操作的数据"})}).other("form",{cols:{item:5,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},VC=AC,MC=(a("7a6e"),Object(Bn["a"])(VC,EC,OC,!1,null,"a3f52698",null)),BC=MC.exports,UC=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("SysMenuList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{"open-add-page":e.openAddPage}}),e.isShowList?e._e():a("SysMenuAdd",{attrs:{editId:e.editId},on:{"open-list-page":e.openListPage,"go-back":e.goBack}})],1)},jC=[],GC=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.showIcon?e._e():a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitBtn}},[e._v("保存")]),a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{model:e.form,rules:e.formRules,"label-width":"160px"}},[a("el-form-item",{attrs:{label:"菜单名称",prop:"menuName"}},[a("el-input",{attrs:{placeholder:"菜单名称"},model:{value:e.form.menuName,callback:function(t){e.$set(e.form,"menuName",t)},expression:"form.menuName"}})],1),a("el-form-item",{attrs:{label:"元素ID",prop:"elid"}},[a("el-input",{attrs:{placeholder:"元素ID"},model:{value:e.form.elid,callback:function(t){e.$set(e.form,"elid",t)},expression:"form.elid"}})],1),a("el-form-item",{attrs:{label:"图标样式",prop:"iconClass"}},[a("el-input",{attrs:{placeholder:"图标样式"},model:{value:e.form.iconClass,callback:function(t){e.$set(e.form,"iconClass",t)},expression:"form.iconClass"}}),a("el-button",{staticClass:"marginL",attrs:{type:"primary",plain:""},on:{click:e.selectIcon}},[e._v("选择图标")])],1),a("el-form-item",{attrs:{label:"标签ID",prop:"tabId"}},[a("el-input",{attrs:{placeholder:"标签ID"},model:{value:e.form.tabId,callback:function(t){e.$set(e.form,"tabId",t)},expression:"form.tabId"}})],1),a("el-form-item",{attrs:{label:"标签名称",prop:"tabTitle"}},[a("el-input",{attrs:{placeholder:"标签名称"},model:{value:e.form.tabTitle,callback:function(t){e.$set(e.form,"tabTitle",t)},expression:"form.tabTitle"}})],1),a("el-form-item",{attrs:{label:"标签图标",prop:"tabIcon"}},[a("el-input",{attrs:{placeholder:"标签图标"},model:{value:e.form.tabIcon,callback:function(t){e.$set(e.form,"tabIcon",t)},expression:"form.tabIcon"}})],1),a("el-form-item",{attrs:{label:"跳转地址URL",prop:"iframeUrl"}},[a("el-input",{attrs:{placeholder:"跳转地址URL"},model:{value:e.form.iframeUrl,callback:function(t){e.$set(e.form,"iframeUrl",t)},expression:"form.iframeUrl"}})],1),a("el-form-item",{attrs:{label:"排序",prop:"seq"}},[a("el-input",{attrs:{placeholder:"排序"},model:{value:e.form.seq,callback:function(t){e.$set(e.form,"seq",t)},expression:"form.seq"}})],1),a("el-form-item",{attrs:{label:"菜单目录",prop:"modle"}},[a("el-radio",{attrs:{label:"0"},model:{value:e.form.modle,callback:function(t){e.$set(e.form,"modle",t)},expression:"form.modle"}},[e._v("收起")]),a("el-radio",{attrs:{label:"1"},model:{value:e.form.modle,callback:function(t){e.$set(e.form,"modle",t)},expression:"form.modle"}},[e._v("展开")]),a("el-radio",{attrs:{label:"3"},model:{value:e.form.modle,callback:function(t){e.$set(e.form,"modle",t)},expression:"form.modle"}},[e._v("媒资菜单")])],1),a("el-form-item",{attrs:{label:"是否禁用",prop:"disabled"}},[a("el-radio",{attrs:{label:"0"},model:{value:e.form.disabled,callback:function(t){e.$set(e.form,"disabled",t)},expression:"form.disabled"}},[e._v("否")]),a("el-radio",{attrs:{label:"1"},model:{value:e.form.disabled,callback:function(t){e.$set(e.form,"disabled",t)},expression:"form.disabled"}},[e._v("是")])],1),a("el-form-item",{attrs:{label:"菜单父ID",prop:"pmid"}},[a("el-input",{attrs:{placeholder:"菜单父ID"},model:{value:e.form.pmid,callback:function(t){e.$set(e.form,"pmid",t)},expression:"form.pmid"}})],1)],1)],1),e.showIcon?a("IconSelect",{attrs:{title:"选择图标",isUseInitialIcon:!0},on:{"get-icon":e.getIcon,"go-back":e.goBack}}):e._e()],1)},WC=[],qC={props:{editId:Number,default:null},components:{IconSelect:Dn["IconSelect"]},data:function(){return{title:null,showIcon:!1,form:{menuName:null,elid:null,iconClass:null,tabId:null,tabTitle:null,tabIcon:null,iframeUrl:null,seq:null,modle:null,disabled:null,pmid:null,menuId:void 0},formRules:{menuName:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],elid:[{required:!0,message:"请输入元素ID",trigger:"blur"}],iconClass:[{required:!0,message:"请输入图标样式",trigger:"blur"}],tabId:[{required:!1,message:"请输入标签ID",trigger:"blur"}],tabTitle:[{required:!0,message:"请输入标签名称",trigger:"blur"}],tabIcon:[{required:!0,message:"请输入标签图标样式",trigger:"blur"}],iframeUrl:[{required:!0,message:"跳转地址URL",trigger:"blur"}],disabled:[{required:!0,message:"禁用",trigger:"blur"}],seq:[{required:!0,message:"请输入排序",trigger:"blur"}],modle:[{required:!0,message:"请选择菜单目录",trigger:"blur"}],pmid:[{required:!0,message:"请输入父菜单ID",trigger:"blur"}]}}},methods:{selectIcon:function(){this.showIcon=!0},goBack:function(){this.showIcon=!1},getIcon:function(e,t){this.form.iconClass=e,this.showIcon=!1},submitBtn:function(){var e=this;this.$refs.form.validate(function(t){t&&e.$service.saveSysMenu({jsonStr:JSON.stringify(e.form)},"保存成功").then(function(){e.$emit("open-list-page")})})},getEditData:function(){var e=this;this.$service.editSysMenu({id:this.editId}).then(function(t){Object.keys(e.form).forEach(function(a){e.form[a]="disabled"===a?t[a]+"":t[a]})})}},created:function(){null!==this.editId&&void 0!==this.editId?(this.title="编辑",this.form.menuId=this.editId,this.getEditData()):this.title="新增"}},HC=qC,zC=Object(Bn["a"])(HC,GC,WC,!1,null,null,null),JC=zC.exports,KC=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"sysMenu"},on:{add:e.addData,edit:e.editData,delete:e.deleteData}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}}),e.setDialogVisible?a("el-dialog",{attrs:{title:"设置操作",visible:e.setDialogVisible},on:{"update:visible":function(t){e.setDialogVisible=t}}},[a("span",[a("el-transfer",{staticClass:"el-transfer",attrs:{data:e.sdata,titles:["待选操作","已选操作"]},on:{change:e.handleChange},model:{value:e.svalue,callback:function(t){e.svalue=t},expression:"svalue"}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.setDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.setDialogVisible=!1,e.setSave()}}},[e._v("确 定")])],1)]):e._e()],1)],1)},QC=[],XC={components:{Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"],ButtonGroupForListPage:Ro},data:function(){return{filter:{sort:void 0,order:void 0},filterSchema:null,pagination:{},setDialogVisible:!1,svalue:[],sdata:[],allData:[],setMenuId:[],setMenu:[],selectMenu:[],data1:[],data2:[],selected:[],buttonList:[],table:{props:{},header:[{label:"菜单ID",prop:"menuId"},{label:"菜单名称",prop:"menuName"},{label:"元素ID",prop:"elid"},{label:"图标样式",prop:"iconClass"},{label:"标签ID",prop:"tabId"},{label:"标签名称",prop:"tabTitle"},{label:"标签图标",prop:"tabIcon"},{label:"跳转地址URL",prop:"iframeUrl"},{label:"排序",prop:"seq"},{label:"菜单目录",prop:"modle"},{label:"禁用",prop:"disabled"},{label:"父菜单ID",prop:"pmid"},{label:"操作",fixed:"right",render:Dn["utils"].component.createOperationRender(this,{setData:"设置操作"})}],data:[],selected:[],selectionType:"multiple"}}},methods:{addData:function(){this.$emit("open-add-page",null)},editData:function(){this.$isAllowEdit(this.selected)&&this.$emit("open-add-page",this.selected[0])},deleteData:function(){var e=this;0!==this.selected.length?this.$confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$service.deleteMenuById({id:e.selected.join(",")},"删除成功").then(function(t){e.handleAllRowSelectionRemove(),e.fetchData()})}):this.$message("请选择再删除")},handleCreate:function(){this.$router.push({name:"prize-create"})},handleRowSelectionAdd:function(e){this.selected.push(e.menuId),this.updateTableSelected()},handleRowSelectionRemove:function(e){this.selected=this.selected.filter(function(t){return t!==e.menuId}),this.updateTableSelected()},handleAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleRowSelectionAdd):(this.selected=[],this.table.selected=[])},handleAllRowSelectionRemove:function(){this.selected=[],this.table.selected=[]},updateTableSelected:function(){var e=this.table,t=this.selected;e.selected=e.data.reduce(function(e,a,i){return t.indexOf(a.menuId)>-1&&e.push(i),e},[])},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId([{label:"ID",value:this.filter.elid},{label:"标签ID",value:this.filter.tabId},{label:"菜单父ID",value:this.filter.pmid}])&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.getSysMenuList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},getSysMenuInfo:function(){var e=this;return this.$service.getMenuInfo().then(function(t){e.buttonList=t})},setData:function(e){var t=this,a=e.row;this.setDialogVisible=!0;var i={menuId:a.menuId},n=[],o=[],r=[];this.setMenuId=a.menuId,this.$service.getNotMenuByRunId(i).then(function(e){t.data1=e,t.$service.getMenuByRunId(i).then(function(e){t.data2=e,t.allData=t.data1.concat(t.data2);var a={};t.allData=t.allData.reduce(function(e,t){return!a[t.runId]&&(a[t.runId]=e.push(t)),e},[]);for(var i=0;i<t.allData.length;i++)n.push({key:t.allData[i].runId,label:t.allData[i].runName});for(var l=0;l<t.data2.length;l++)o.push(t.data2[l].runId);for(var s=0;s<o.length;s++)-1==r.indexOf(o[s])&&r.push(o[s]);t.sdata=n,t.svalue=r,console.log(n),console.log(r)})})},handleChange:function(e,t,a){for(var i=[],n=0;n<e.length;n++)-1==i.indexOf(e[n])&&i.push(e[n]);var o=i.join(",");this.setMenu=o},setSave:function(){var e=this,t=this.setMenuId,a=this.setMenu;this.$service.saveMenuRun({menuId:t,runIds:a},"保存成功").then(function(){e.setDialogVisible=!1,e.fetchData()})}},created:function(){var e=co.a.map({menuName:co.a.o.string.other("form",{component:"Input",placeholder:"菜单名称"}),elid:co.a.o.string.other("form",{component:"Input",placeholder:"ID"}),tabId:co.a.o.string.other("form",{component:"Input",placeholder:"标签ID"}),iframeUrl:co.a.o.string.other("form",{component:"Input",placeholder:"跳转地址URL"}),modle:co.a.o.string.other("form",{component:"Input",placeholder:"菜单目录"}),pmid:co.a.o.string.other("form",{component:"Input",placeholder:"菜单父ID"}),disabled:co.a.o.enum({"否":"0","是":"1"}).other("form",{component:"Select",placeholder:"是否禁用"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData(),this.getSysMenuInfo()}},YC=XC,ZC=(a("e913"),Object(Bn["a"])(YC,KC,QC,!1,null,"033ef6ac",null)),eT=ZC.exports,tT={components:{SysMenuAdd:JC,SysMenuList:eT},data:function(){return{isShowList:!0,editId:null}},methods:{openAddPage:function(e){this.editId=e,this.isShowList=!1},openListPage:function(){this.isShowList=!0,this.$refs.list.fetchData()},goBack:function(){this.isShowList=!0}}},aT=tT,iT=Object(Bn["a"])(aT,UC,jC,!1,null,null,null),nT=iT.exports,oT=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("UserConfigList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{"open-add-page":e.openAddPage}}),e.isShowList?e._e():a("UserConfigAdd",{attrs:{editId:e.editId},on:{"open-list-page":e.openListPage,"go-back":e.goBack}})],1)},rT=[],lT=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitBtn}},[e._v("保存")]),a("div",{staticClass:"form-legend-header"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{model:e.form,rules:e.formRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"用户名称",prop:"userName"}},[a("el-input",{attrs:{placeholder:"用户名称",maxlength:"50"},model:{value:e.form.userName,callback:function(t){e.$set(e.form,"userName",t)},expression:"form.userName"}})],1),a("el-form-item",{attrs:{label:"所在部门",prop:"deptId"}},[a("el-select",{attrs:{placeholder:"所在部门"},model:{value:e.form.deptId,callback:function(t){e.$set(e.form,"deptId",t)},expression:"form.deptId"}},e._l(e.departmentList,function(e){return a("el-option",{key:e.deptId+"",attrs:{label:e.deptName,value:e.deptId}})}),1)],1),a("el-form-item",{attrs:{label:"登录账号",prop:"loginName"}},[a("el-input",{attrs:{placeholder:"登录账号",maxlength:"50"},model:{value:e.form.loginName,callback:function(t){e.$set(e.form,"loginName",t)},expression:"form.loginName"}},[e._v(">")])],1),e.isShowloginPwd?a("el-form-item",{attrs:{label:"密码",prop:"loginPwd"}},[a("el-input",{attrs:{placeholder:"密码",maxlength:"50"},model:{value:e.form.loginPwd,callback:function(t){e.$set(e.form,"loginPwd",t)},expression:"form.loginPwd"}},[e._v(">")])],1):e._e(),a("el-form-item",{attrs:{label:"邮件地址",prop:"email"}},[a("el-input",{attrs:{type:"email",placeholder:"邮件地址"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),a("el-form-item",{attrs:{label:"是否可用",prop:"disabled"}},[a("el-radio",{attrs:{label:"0"},model:{value:e.form.disabled,callback:function(t){e.$set(e.form,"disabled",t)},expression:"form.disabled"}},[e._v("是")]),a("el-radio",{attrs:{label:"1"},model:{value:e.form.disabled,callback:function(t){e.$set(e.form,"disabled",t)},expression:"form.disabled"}},[e._v("否")])],1),a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{attrs:{type:"textarea",placeholder:"备注"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),a("el-form-item",{attrs:{label:"数据权限",prop:"dicts"}},[a("el-form-item",[a("el-checkbox-group",{model:{value:e.form.dicts,callback:function(t){e.$set(e.form,"dicts",t)},expression:"form.dicts"}},e._l(e.dictEnNameList,function(t){return a("el-checkbox",{key:t.dictId,attrs:{label:t.dictId}},[e._v(e._s(t.dictCnName))])}),1)],1)],1)],1)],1)},sT=[],cT={props:{editId:Number,default:null},data:function(){return{title:null,dictEnNameList:null,departmentList:[],isShowloginPwd:!0,form:{userName:null,deptId:null,loginName:null,loginPwd:null,email:null,disabled:null,remark:null,superAdmin:0,dicts:[]},formRules:{userName:[{required:!0,message:"请输入用户名称",trigger:"blur"},{max:45,message:"不超过 45 个字符",trigger:"blur"}],loginName:[{required:!0,message:"请输入登录账号",trigger:"blur"},{max:45,message:"不超过 45 个字符",trigger:"blur"}],loginPwd:[{required:!0,message:"请输入密码",trigger:"blur"},{max:45,message:"不超过 45 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮件地址",trigger:"blur"},{type:"email",message:"邮件地址格式不正确",trigger:"blur"}]}}},methods:{userConfigBusinessType:function(){var e=this;this.$service.getDictType({type:"businessType"}).then(function(t){e.dictEnNameList=t})},submitBtn:function(){var e=this;this.$refs.form.validate(function(t){t&&e.$service.userConfigSave({jsonStr:JSON.stringify(e.form)},"保存成功").then(function(t){e.$emit("open-list-page")})})},getEditData:function(){var e=this;this.$service.userConfigEdit({id:this.editId}).then(function(t){console.log(t),Object.keys(e.form).forEach(function(a){e.form[a]="disabled"===a?t[a]+"":t[a]})})},getDepts:function(){var e=this;return this.$service.getDepts().then(function(t){e.departmentList=t,console.log(t),t.forEach(function(e){console.log(e.deptName+e.deptId)})})}},created:function(){this.userConfigBusinessType(),this.getDepts(),null!==this.editId&&void 0!==this.editId?(this.title="编辑",this.isShowloginPwd=!1,this.form.userId=this.editId,this.getEditData()):this.title="新增"}},uT=cT,dT=Object(Bn["a"])(uT,lT,sT,!1,null,null,null),pT=dT.exports,hT=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"sysUser"},on:{add:e.addUser,edit:e.editData,delete:e.batchDel}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1),a("el-dialog",{attrs:{title:"设置用户角色",visible:e.roleDialogVisible},on:{"update:visible":function(t){e.roleDialogVisible=t}}},[a("span",[a("el-transfer",{attrs:{data:e.roleData,titles:["待选角色","已选角色"]},on:{change:e.handleChange},model:{value:e.roleValue,callback:function(t){e.roleValue=t},expression:"roleValue"}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.roleDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.roleDialogVisible=!1,e.add()}}},[e._v("确 定")])],1)]),a("el-dialog",{attrs:{title:"数据权限设置",width:"30%",visible:e.dataPermissionWinVisible},on:{"update:visible":function(t){e.dataPermissionWinVisible=t}}},[a("el-checkbox-group",{directives:[{name:"show",rawName:"v-show",value:!e.isLoading,expression:"!isLoading"}],model:{value:e.checkedDictItems,callback:function(t){e.checkedDictItems=t},expression:"checkedDictItems"}},e._l(e.DataPermissionItems,function(t){var i=t.dictId,n=t.dictCnName;return a("el-checkbox",{key:i,staticClass:"checkItemStyle",attrs:{label:i}},[e._v("\n        "+e._s(n)+"\n      ")])}),1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dataPermissionWinVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveProfession}},[e._v("确 定")])],1)],1)],1)},mT=[],fT={components:{Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"],ButtonGroupForListPage:Ro},data:function(){return{depts:{},roleData:[],roleValue:[],data1:[],user:[],setRolesId:[],roleDataSelected:null,roleDialogVisible:!1,currentUserId:null,dataPermissionWinVisible:!1,DataPermissionItems:{},checkedDictItems:[],isLoading:!1,selectedRole:[],filter:{sort:void 0,order:void 0},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"userId",width:"70",sortable:!0},{label:"用户名称","min-width":"120",prop:"userName",sortable:!0},{label:"登录账号",prop:"loginName",width:"110",sortable:!0},{label:"所在部门",prop:"deptName","min-width":"90"},{label:"电子邮箱",prop:"email","min-width":"160"},{label:"登录IP",prop:"loginIp",width:"130"},{label:"登录次数",prop:"loginCount"},{label:"最后登录时间",prop:"loginTime",width:"170"},{label:"是否禁用",prop:"disabled",formatter:function(e){return 0===e.disabled?"否":1===e.disabled?"是":void 0}},{label:"创建时间",prop:"dateCreate",width:"170",sortable:!0},{label:"修改时间",prop:"dateModify",width:"170",sortable:!0},{label:"备注",prop:"remark","min-width":"170"},{label:"操作",width:"200",fixed:"right",render:Dn["utils"].component.createOperationRender(this,{setRole:"设置角色",setData:"数据权限"})}],data:[],selected:[],selectionType:"multiple"}}},methods:{addUser:function(){this.$emit("open-add-page",null)},handleRead:function(e){e.row},setRole:function(e){var t=this,a=e.row,i={userId:a.userId},n=[],o=[];this.roleDialogVisible=!0,this.user=a.userId,this.$service.getNotRolesByUserId(i).then(function(e){t.data1=e,t.$service.getRolesByUserId(i).then(function(e){null!=e&&(t.data1=t.data1.concat(e));for(var a=0;a<t.data1.length;a++)n.push({key:t.data1[a].roleId,label:t.data1[a].roleName});for(var i=0;i<e.length;i++)o.push(e[i].roleId);t.roleData=n,t.roleValue=o})})},handleChange:function(e,t,a){for(var i=[],n=0;n<e.length;n++)-1==i.indexOf(e[n])&&i.push(e[n]);var o=i.join(",");this.setRolesId=o},add:function(){var e=this,t=this.user,a=this.setRolesId;this.$service.saveUserRoles({userId:t,roleIds:a},"保存成功").then(function(){e.roleDialogVisible=!1,e.fetchData()})},editData:function(){this.$isAllowEdit(this.selected)&&this.$emit("open-add-page",this.selected[0])},batchDel:function(){var e=this;0!==this.selected.length?this.$confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$service.userConfigDelete({id:e.selected.join(",")},"删除成功").then(function(t){e.fetchData(),e.handleAllRowSelectionRemove()})}):this.$message("请选择再删除")},handleRowSelectionAdd:function(e){this.selected.push(e.userId),this.updateTableSelected()},handleRowSelectionRemove:function(e){this.selected=this.selected.filter(function(t){return t!==e.userId}),this.updateTableSelected()},handleAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleRowSelectionAdd):(this.selected=[],this.table.selected=[])},handleAllRowSelectionRemove:function(){this.selected=[],this.table.selected=[]},updateTableSelected:function(){var e=this.table,t=this.selected;e.selected=e.data.reduce(function(e,a,i){return t.indexOf(a.userId)>-1&&e.push(i),e},[])},handleFilterChange:function(e,t){t&&(this.filter=t),"query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData()},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.userConfigPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},getDepts:function(){var e=this;return this.$service.getDepts().then(function(t){t.forEach(function(t){e.depts[t.deptName]=t.deptId})})},getNotRolesByUserId:function(e){var t=this;this.$service.getNotRolesByUserId({userId:e}).then(function(e){e.forEach(function(e){t.depts[e.deptName]=e.deptId})})},setData:function(){var e=Object(U["a"])(regeneratorRuntime.mark(function e(t){var a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.row,this.currentUserId=a.userId,e.next=4,this.userConfigBusinessType();case 4:return this.checkedDictItems=[],this.isLoading=!0,e.next=8,this.getDictCheckedByUserId(a.userId);case 8:this.isLoading=!1,this.dataPermissionWinVisible=!0;case 10:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),getDictCheckedByUserId:function(e){var t=this;return this.$service.getDictCheckedByUserId({userId:e}).then(function(e){t.checkedDictItems=e})},userConfigBusinessType:function(){var e=this;return this.$service.getDictType({type:"businessType"}).then(function(t){e.DataPermissionItems=t})},saveProfession:function(){var e=this,t=this.checkedDictItems.join(",");this.$service.saveProfession({userId:this.currentUserId,dicts:t},"保存成功").then(function(){e.dataPermissionWinVisible=!1})}},created:function(){var e=this,t=co.a.map({userName:co.a.o.string.other("form",{component:"Input",placeholder:"用户名称"}),deptId:co.a.o.enum(this.depts).other("form",{component:"Select",placeholder:"所在部门"}),loginName:co.a.o.string.other("form",{component:"Input",placeholder:"登录账号"}),email:co.a.o.string.other("form",{component:"Input",placeholder:"电子邮箱"}),loginIp:co.a.o.string.other("form",{component:"Input",placeholder:"最后登录IP"}),disabled:co.a.o.enum({"否":"0","是":"1"}).other("form",{component:"Select",placeholder:"是否禁用"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.getDepts().then(function(){e.filterSchema=t}),this.fetchData()}},gT=fT,bT=(a("8ac5"),Object(Bn["a"])(gT,hT,mT,!1,null,"7d1a23c2",null)),vT=bT.exports,yT={components:{UserConfigAdd:pT,UserConfigList:vT},data:function(){return{isShowList:!0,editId:null}},methods:{openAddPage:function(e){this.editId=e,this.isShowList=!1},openListPage:function(){this.isShowList=!0,this.$refs.list.fetchData()},goBack:function(){this.isShowList=!0}}},wT=yT,IT=Object(Bn["a"])(wT,oT,rT,!1,null,null,null),CT=IT.exports,TT=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("ThemeInfoList",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{"open-add-page":e.openAddPage}}),e.isShowList?e._e():a("ThemeInfoAdd",{attrs:{editId:e.editId,version:e.version,initMode:e.mode},on:{"upsert-end":e.openListPage,"go-back":e.goBack}})],1)},ST=[],kT=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("ButtonGroupForListPage",{attrs:{pageName:"theme"},on:{add:e.addUser,edit:e.editData,delete:e.batchDel}}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1),a("el-dialog",{attrs:{title:"大图预览",visible:e.onclickPictureVisible,width:"70%"},on:{"update:visible":function(t){e.onclickPictureVisible=t}}},[a("img",{attrs:{src:e.URL,width:"100%"}})])],1)},_T=[],PT={components:{ContentWrapper:Dn["ContentWrapper"],Table:Dn["Table"],ButtonGroupForListPage:Ro},data:function(){var e=this;return{URL:"",onclickPictureVisible:!1,filterSchema:null,filter:{sort:void 0,order:void 0},pagination:{currentPage:1,pageSize:10},selected:[],table:{props:{},data:[],header:[{label:"ID",prop:"themeId",sortable:!0},{label:"主题名称",prop:"themeName",sortable:!0,render:function(t,a){var i=a.row;return t(A["Button"],{props:{type:"text"},on:{click:function(){return e.themeInfoPreview(i)}}},i.themeName)}},{label:"主题品牌",prop:"themeBrand",sortable:!0,formatter:function(e){return"Coocaa"===e.themeBrand?"创维酷开":"Other"===e.themeBrand?"全部":void 0}},{label:"系统默认",prop:"systemDefault",sortable:!0,formatter:function(e){var t=["否","是"];return t[e.systemDefault]}},{label:"状态",prop:"themeStatus",sortable:!0,formatter:function(e){var t=["下架","上架","草稿","待审核","审核通过","审核不通过"];return t[e.themeStatus]}},{label:"主题当前版本",prop:"currentVersion",sortable:!0},{label:"主题预览图",prop:"previewImgUrl",sortable:!0,render:function(t,a){var i=a.row;if(i.previewImgUrl)return t("img",{attrs:{src:i.previewImgUrl,width:"100px",height:"45px",class:"imgs"},on:{click:function(){e.URL=i.previewImgUrl,e.onclickPictureVisible=!0}}})}},{label:"待审核副本",prop:"duplicateVersion",sortable:!0,render:function(t,a){var i=a.row;if(i.duplicateVersion)return t(A["Button"],{props:{type:"success"},on:{click:function(){return e.duplicatePreview(i)}}},i.duplicateVersion)}},{label:"原价(元)",prop:"price",sortable:!0,formatter:function(e){return e.chargeType?e.price:"免费"}},{label:"折扣价(元)",prop:"discountPrice",sortable:!0,formatter:function(e){return e.chargeType?e.discountPrice:"免费"}},{label:"更新时间",prop:"lastUpdateDate",sortable:!0},{label:"更新人",prop:"modifierName",sortable:!0}],selected:[],selectionType:"multiple"}}},methods:{fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.themeInfoPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.themeId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={},this.pagination.currentPage=1,this.fetchData()},addUser:function(){this.$emit("open-add-page")},editData:function(){var e=this.selected;if(1!==e.length)return this.$message("只能选择一条数据"),!1;var t=this.table.data,a=t.find(function(t){return t.themeId===e[0]}).themeStatus;if(4===a)return this.$alert("审核通过的数据无法编辑！","操作提示"),!1;this.$emit("open-add-page",e[0],"edit")},batchDel:function(){var e=this;if(0!==this.selected.length){if(window.confirm("确定要删除吗")){var t=this.selected.join(",");this.$service.themeInfoRemove({id:t}).then(function(){e.selected=[],e.fetchData()})}}else this.$message("请选择数据后进行操作")},handleRowSelectionAdd:function(e){this.selected.push(e.themeId),this.updateTableSelected()},handleRowSelectionRemove:function(e){this.selected=this.selected.filter(function(t){return t!==e.themeId}),this.updateTableSelected()},handleAllRowSelectionChange:function(e){e?this.table.data.forEach(this.handleRowSelectionAdd):(this.selected=[],this.table.selected=[])},handleAllRowSelectionRemove:function(){this.selected=[],this.table.selected=[]},updateTableSelected:function(){var e=this.table,t=this.selected;e.selected=e.data.reduce(function(e,a,i){return t.indexOf(a.themeId)>-1&&e.push(i),e},[])},themeInfoPreview:function(e){this.$emit("open-add-page",e.themeId,"read")},duplicatePreview:function(e){this.$emit("open-add-page",e.themeId,"read",e.duplicateVersion)}},created:function(){var e=co.a.map({themeId:co.a.o.string.other("form",{component:"Input",placeholder:"ID"}),themeName:co.a.o.string.other("form",{component:"Input",placeholder:"主题名称"}),currentVersion:co.a.o.string.other("form",{component:"Input",placeholder:"当前版本"}),themeStatus:co.a.o.enum({"待审核":"3","审核通过":"4","审核不通过":"5"}).other("form",{component:"Select",placeholder:"状态"})}).other("form",{cols:{item:5,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},xT=PT,DT=(a("8259"),Object(Bn["a"])(xT,kT,_T,!1,null,"756b8d7c",null)),FT=DT.exports,$T=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:e.title},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("div",[a("CommonContent",{ref:"commonContent",attrs:{mode:e.mode,"resource-info":e.resourceInfo},on:{edit:e.edit,replicate:e.replicate,"submit-audit":e.btnSave,"select-version":e.fetchData,unaudit:e.fetchData,shelves:e.fetchData,audit:function(t){return e.$emit("upsert-end")},delete:function(t){return e.$emit("upsert-end",t)}}},[a("div",{attrs:{slot:"auditAndDraft"},slot:"auditAndDraft"},[a("el-button",{attrs:{type:"primary"},on:{click:e.btnSave}},[e._v("提交审核")])],1),a("div",{staticClass:"split-bar"},[a("i",{staticClass:"el-icon-edit"},[e._v("基本信息")])]),"read"!==e.mode?[a("el-form",{ref:"form",staticClass:"el-form-add",attrs:{rules:e.rules,model:e.form,"label-width":"150px"}},[a("el-form-item",{attrs:{label:"主题名称",prop:"themeName"}},[a("el-input",{model:{value:e.form.themeName,callback:function(t){e.$set(e.form,"themeName",t)},expression:"form.themeName"}})],1),a("el-form-item",{attrs:{label:"收费类型"}},[a("el-radio-group",{model:{value:e.form.chargeType,callback:function(t){e.$set(e.form,"chargeType",t)},expression:"form.chargeType"}},[a("el-radio",{attrs:{label:"0"}},[e._v("免费")]),a("el-radio",{attrs:{label:"1"}},[e._v("付费")]),a("el-radio",{attrs:{label:"2"}},[e._v("VIP免费")])],1)],1),"0"!==e.form.chargeType?a("div",{staticClass:"priceInput"},[a("el-form-item",{attrs:{label:"价格"}},[a("el-input",{model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}}),e._v("元\n            ")],1),a("el-form-item",{attrs:{label:"折扣价"}},[a("el-input",{model:{value:e.form.discountPrice,callback:function(t){e.$set(e.form,"discountPrice",t)},expression:"form.discountPrice"}}),e._v("元\n            ")],1)],1):e._e(),a("el-form-item",{attrs:{label:"主题品牌"}},[a("el-radio-group",{model:{value:e.form.themeBrand,callback:function(t){e.$set(e.form,"themeBrand",t)},expression:"form.themeBrand"}},[a("el-radio",{attrs:{label:"Coocaa"}},[e._v("创维酷开")]),a("el-radio",{attrs:{label:"Other"}},[e._v("全部")])],1)],1),a("el-form-item",{attrs:{label:"皮肤APK"}},[a("ThemeFileUpload",{ref:"apk",attrs:{accept:"application/vnd.android.package-archive",fileCount:"1"},on:{"pic-data":e.handleApk,handleRemove:function(t){e.form.themeDownUrl="",e.form.themeMd5=""}}})],1),a("el-form-item",{attrs:{label:"主题预览图"}},[a("ThemeFileUpload",{ref:"preview",attrs:{accept:"image/*",fileCount:"1"},on:{"pic-data":e.handlePreviewImg,handleRemove:function(t){e.form.previewImgUrl=""}}})],1),a("el-form-item",{attrs:{label:"主题缩略图"}},[a("ThemeFileUpload",{ref:"thumbImg",attrs:{accept:"image/*",fileCount:"1"},on:{"pic-data":e.handleThumbImg,handleRemove:function(t){e.form.thumbImgUrl=""}}})],1),a("el-form-item",{attrs:{label:"图标库zip文件"}},[a("ThemeFileUpload",{ref:"pictureEntitys",attrs:{accept:"application/zip",fileCount:"1",zipType:"icon"},on:{"pic-data":e.handlePictureEntitys,handleRemove:function(t){e.form.pictureEntitys=[]}}})],1),a("div",{staticClass:"icon-list"},e._l(e.form.pictureEntitys,function(t,i){return a("div",{key:i,staticClass:"icon-list__item"},[a("img",{staticClass:"icon-list__item-img--pictureEntitys",attrs:{src:t.pictureUrl}}),a("span",{staticClass:"icon-list__item-text"},[e._v(e._s(i+1))])])}),0),a("el-form-item",{attrs:{label:"指定背景图片zip文件"}},[a("ThemeFileUpload",{ref:"tabBgEntitys",attrs:{accept:"application/zip",fileCount:"1",zipType:"tabBg"},on:{"pic-data":e.handleTabBgEntitys,handleRemove:function(t){e.form.tabBgEntitys=[]}}})],1),a("div",{staticClass:"icon-list"},e._l(e.form.tabBgEntitys,function(t,i){return a("div",{key:i,staticClass:"icon-list__item"},[a("img",{staticClass:"icon-list__item-img--tabBgEntitys",attrs:{src:t.pictureUrl}}),a("span",{staticClass:"icon-list__item-text"},[e._v(e._s(i+1))])])}),0)],1)]:e._e(),"read"===e.mode?[a("el-form",{staticClass:"preview-form",attrs:{model:e.form,"label-width":"150px"}},[a("el-form-item",{staticClass:"label",attrs:{label:"主题名称"}},[a("span",{attrs:{title:"themeName"}},[e._v(e._s(e.form.themeName))])]),a("el-form-item",{staticClass:"label",attrs:{label:"价格"}},[a("span",{attrs:{title:"price"}},[e._v(e._s(e.form.price)+"元")]),a("span",{attrs:{title:"discountPrice"}},[e._v("(折扣:"+e._s(e.form.discountPrice)+"元)")])]),a("el-form-item",{staticClass:"label",attrs:{label:"主题品牌"}},[a("span",{attrs:{title:"themeBrand"}},[e._v(e._s("Coocaa"===e.form.themeBrand?"创维酷开":"其他"))])]),a("el-form-item",{staticClass:"label",attrs:{label:"主题预览图"}},[a("div",{staticClass:"img-box",attrs:{title:"previewImgUrl"}},[a("img",{staticClass:"img",attrs:{src:e.form.previewImgUrl}})])]),a("el-form-item",{staticClass:"label",attrs:{label:"主题缩略图"}},[a("div",{staticClass:"img-box",attrs:{title:"thumbImgUrl"}},[a("img",{staticClass:"img",attrs:{src:e.form.thumbImgUrl}})])]),a("el-form-item",{staticClass:"label",attrs:{label:"图标库"}},[a("div",{staticClass:"icon-list",attrs:{title:"pictureEntitys"}},e._l(e.form.pictureEntitys,function(t,i){return a("div",{key:i,staticClass:"icon-list__item"},[a("img",{staticClass:"icon-list__item-img--pictureEntitys",attrs:{src:t.pictureUrl}}),a("span",{staticClass:"icon-list__item-text"},[e._v(e._s(t.iconTypeName))])])}),0)]),a("el-form-item",{staticClass:"label",attrs:{label:"指定背景图"}},[a("div",{staticClass:"icon-list",attrs:{title:"tabBgEntitys"}},e._l(e.form.tabBgEntitys,function(t,i){return a("div",{key:i,staticClass:"icon-list__item"},[a("img",{staticClass:"icon-list__item-img--tabBgEntitys",attrs:{src:t.pictureUrl}}),a("span",{staticClass:"icon-list__item-text"},[e._v(e._s(i+1))])])}),0)])],1)]:e._e()],2)],1)])},LT=[],RT=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Upload",{ref:"upload",attrs:{multiple:!0,accept:e.accept},on:{upload:e.handleUpload},scopedSlots:e._u([{key:"preview",fn:function(t){var n=t.fileList;return i("div",{staticClass:"upload-pic-list"},[i("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.$refs.upload.handleSelectFile()}}},[e._v("点击选择文件")]),e._l(n,function(t){return i("div",{key:t.id,staticClass:"upload-pic-list__item"},["error"===t.status?i("div",{staticClass:"upload-pic-list__error"},[e._v("上传失败: "+e._s(t.message))]):e._e(),"uploading"===t.status?i("div",{staticClass:"upload-pic-list__progress"},[i("el-progress",{attrs:{width:100,type:"circle",percentage:t.percentage}})],1):i("div",{staticClass:"upload-pic-list__success"},[void 0===t.dataUrl||""===t.dataUrl?i("img",{staticClass:"upload-pic-list__success__img",attrs:{src:a("87d4")}}):e._e(),void 0!==t.dataUrl&&""!==t.dataUrl?i("img",{staticClass:"upload-pic-list__success__img",attrs:{src:t.dataUrl}}):e._e(),"uploading"!==t.status?i("i",{staticClass:"upload-pic-list__remove el-icon el-icon-error",attrs:{title:"移除"},on:{click:function(a){return e.handleRemove(t)}}}):e._e(),i("div",{staticClass:"diy-file-name"},[e._v(e._s(t.name))]),"success"===t.status?i("div",{staticClass:"diy-bar"},[i("span",{staticClass:"diy-bar__text"},[e._v("上传完成")])]):e._e()])])})],2)}}])})},NT=[],ET={components:{Upload:Dn["Upload"]},props:{accept:{type:String},fileCount:{type:String},zipType:{type:String,default:function(){return"none"}}},data:function(){return{fileNum:0,picData:{}}},methods:{handleUpload:function(e,t){var a=this,i=this.$refs.upload.fileList,n=!1;if(i.map(function(t){t.name===e.name&&(n=!0)}),n)return this.$message("该资源已存在"),void i.pop();if(i[i.length-1].name=e.name,this.fileNum>=parseInt(this.fileCount))return this.$message("上传文件数量超过限制,最大上传文件个数为"+this.fileCount),void i.pop();this.fileNum++,this.fileName=e.name;var o=this.accept;if(/image/.test(o))this.$service.uploadImage({file:e,onUploadProgerss:function(e){e.lengthComputable&&(t.percentage=e.loaded/e.total)}}).then(function(e){0==e.code?(t.status="success",a.picData.url=e.data[0].url,a.$emit("pic-data",a.picData)):(t.status="error",t.message=e.msg)}).catch(function(){t.status="error",t.message="网络错误"});else if(/vnd.android.package-archive/.test(o))this.$service.uploadApk({file:e,onUploadProgerss:function(e){e.lengthComputable&&(t.percentage=e.loaded/e.total)}}).then(function(e){0==e.code?(t.status="success",a.picData.url=e.data.url,a.picData.fileMd5=e.data.fileMd5,a.$emit("pic-data",a.picData)):(t.status="error",t.message=e.msg)}).catch(function(){t.status="error",t.message="网络错误"});else if(/zip/.test(o)){var r=this.zipType;this.$service.uploadZip({file:e,type:r,onUploadProgerss:function(e){e.lengthComputable&&(t.percentage=e.loaded/e.total)}}).then(function(e){0==e.code?(t.status="success",a.picData=e.data,a.$emit("pic-data",a.picData)):(t.status="error",t.message=e.msg)}).catch(function(){t.status="error",t.message="网络错误"})}},handleRemove:function(e){this.$refs.upload.handleRemove(e),this.fileNum--,this.$emit("handleRemove")}},created:function(){}},OT=ET,AT=(a("0f1a"),Object(Bn["a"])(OT,RT,NT,!1,null,"2ba78736",null)),VT=AT.exports,MT={props:{editId:Number,version:String,default:null,initMode:String},components:{CommonContent:Us,ThemeFileUpload:VT},data:function(){return{form:{themeId:void 0,themeName:"",chargeType:"0",price:"",discountPrice:"",themeBrand:"Coocaa",themeDownUrl:"",previewImgUrl:"",thumbImgUrl:"",systemDefault:"0",themeCode:"",themeVersion:"",themeMd5:"",pictureEntitys:[],tabBgEntitys:[],currentVersion:void 0,themeStatus:3},title:"",mode:"",status:"",rules:{themeName:[{required:!0,message:"请输入主题名称",trigger:"blur"}]},editForm:{}}},computed:{resourceInfo:function(){var e=this.form;if(e.themeId)return{id:e.themeId,version:e.currentVersion,status:e.themeStatus,type:"theme",menuElId:"themeInfo"}}},methods:{replicate:function(){var e=this;this.mode="replicate",this.title="创建副本",this.$nextTick(function(){e.$refs.preview.$refs.upload.fileList=[{dataUrl:e.form.previewImgUrl}],e.$refs.apk.$refs.upload.fileList=[{dataUrl:e.form.themeDownUrl}],e.$refs.thumbImg.$refs.upload.fileList=[{dataUrl:e.form.thumbImgUrl}],e.$refs.pictureEntitys.$refs.upload.fileList=[{dataUrl:""}],e.$refs.tabBgEntitys.$refs.upload.fileList=[{dataUrl:""}]})},edit:function(){var e=this;this.mode="edit",this.title="编辑",this.$nextTick(function(){e.$refs.preview.$refs.upload.fileList=[{dataUrl:e.form.previewImgUrl}],e.$refs.apk.$refs.upload.fileList=[{dataUrl:e.form.themeDownUrl}],e.$refs.thumbImg.$refs.upload.fileList=[{dataUrl:e.form.thumbImgUrl}],e.$refs.pictureEntitys.$refs.upload.fileList=[{dataUrl:""}],e.$refs.tabBgEntitys.$refs.upload.fileList=[{dataUrl:""}]})},btnSave:function(){var e=this,t=this.form;"0"===t.chargeType&&(t.price="0",t.discountPrice="0"),"replicate"===this.mode&&(this.form.currentVersion=""),this.form.themeStatus=3;var a=this.editForm,i=Object.assign({},t,a);this.$refs.form.validate(function(t){t&&e.$service.savethemeInfo({jsonStr:JSON.stringify(i)},"保存成功").then(function(){e.$emit("upsert-end")})})},handleApk:function(e){var t=this;this.$service.checkThemeMd5({themeMd5:e.fileMd5},"该主题可用").then(function(){t.form.themeDownUrl=e.url,t.form.themeMd5=e.fileMd5})},handlePreviewImg:function(e){this.form.previewImgUrl=e.url},handleThumbImg:function(e){this.form.thumbImgUrl=e.url},handlePictureEntitys:function(e){this.form.pictureEntitys=this.EntitysPicUp(e)},handleTabBgEntitys:function(e){this.form.tabBgEntitys=this.EntitysPicUp(e)},EntitysPicUp:function(e){return e.reduce(function(e,t){var a={pictureName:t.originFileName,pictureUrl:t.url,pictureResolution:t.resolution};return e.push(a),e},[])},setFormData:function(e){var t=this.form;if(t.themeId=e.themeId,t.themeName=e.themeName,t.chargeType=e.chargeType.toString(),t.price=e.price,t.discountPrice=e.discountPrice,t.themeBrand=e.themeBrand,t.systemDefault=e.systemDefault,t.themeStatus=e.themeStatus,t.cornerIconEntities=e.cornerIconEntities,t.currentVersion=e.currentVersion,t.previewImgUrl=e.previewImgUrl,t.thumbImgUrl=e.thumbImgUrl,t.pictureEntitys=e.pictureEntitys,t.tabBgEntitys=e.tabBgEntitys,t.themeDownUrl=e.themeDownUrl,t.themeMd5=e.themeMd5,"edit"===this.mode){var a={name:"file"},i=this.$refs.apk.$refs.upload.fileList;i.push(a),this.$refs.apk.fileNum++,t.previewImgUrl=e.previewImgUrl;var n={name:"img",dataUrl:e.previewImgUrl},o=this.$refs.preview.$refs.upload.fileList;o.push(n),this.$refs.preview.fileNum++,t.thumbImgUrl=e.thumbImgUrl;var r={name:"img",dataUrl:e.thumbImgUrl},l=this.$refs.thumbImg.$refs.upload.fileList;l.push(r),this.$refs.thumbImg.fileNum++,t.pictureEntitys=e.pictureEntitys.map(function(e){return{pictureName:e.pictureName,pictureResolution:e.pictureResolution,pictureUrl:e.pictureUrl}});var s={name:"file"},c=this.$refs.pictureEntitys.$refs.upload.fileList;c.push(s),this.$refs.pictureEntitys.fileNum++,t.tabBgEntitys=e.tabBgEntitys.map(function(e){return{pictureName:e.pictureName,pictureResolution:e.pictureResolution,pictureUrl:e.pictureUrl}});var u={name:"file"},d=this.$refs.tabBgEntitys.$refs.upload.fileList;d.push(u),this.$refs.tabBgEntitys.fileNum++}},fetchData:function(e){var t=this;void 0!==e&&(this.form.currentVersion=e),this.$service.themeInfoDetail({id:this.editId,version:e}).then(function(e){t.setFormData(e)})}},created:function(){this.mode=this.initMode,this.editId?"edit"===this.mode?(this.title="编辑页面",this.fetchData()):"read"===this.mode&&(this.title="预览页面",this.fetchData(this.version)):this.title="新增页面"}},BT=MT,UT=(a("5245"),Object(Bn["a"])(BT,$T,LT,!1,null,"1bf05284",null)),jT=UT.exports,GT={components:{ThemeInfoList:FT,ThemeInfoAdd:jT},data:function(){return{isShowList:!0,editId:null,version:null,mode:""}},methods:{openAddPage:function(e,t,a){this.editId=e,this.isShowList=!1,this.mode=t,this.version=a},goBack:function(){this.isShowList=!0},openListPage:function(){this.isShowList=!0,this.$refs.list.fetchData()}}},WT=GT,qT=Object(Bn["a"])(WT,TT,ST,!1,null,"5d5a7750",null),HT=qT.exports,zT=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType}})],1)],1)},JT=[],KT={components:{Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"]},data:function(){var e=this;return{filter:{sort:void 0,order:void 0},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"id",width:"70"},{label:"名称",width:"150",prop:"thirdVideoTitle"},{label:"图片",width:"150",prop:"imgUrl",render:function(e,t){var a=t.row;return e("img",{attrs:{src:a.imgUrl,width:"100px",height:"100px",class:"imgs"}})}},{label:"引用状态",prop:"rlsInfo",render:function(t,a){var i=a.row;return i.rlsInfo.reduce(function(a,i){var n=t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(i)}}},i);return a.push(n),a},[])}}],data:[],selected:[],selectionType:"none"}}},methods:{goBack:function(){this.isShowList=!0},handleRead:function(e){var t=e.indexOf("[")+1,a=e.indexOf("]"),i=e.slice(t,a).split(","),n=i[0],o=i[1];this.$emit("read",n,o)},handleFilterChange:function(e,t){t&&(this.filter=t),"query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData()},handleFilterReset:function(){this.filter={sort:void 0,order:void 0},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();this.$service.getMoviePageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=co.a.map({keyword:co.a.o.string.other("form",{component:"Input",placeholder:"影片名称/引用状态"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},QT=KT,XT=(a("2a32"),Object(Bn["a"])(QT,zT,JT,!1,null,"3caf6664",null)),YT=XT.exports,ZT=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"版面",name:"first"}},[a("MyDraftsTabIndex",{staticClass:"el-tab-pane-preview"})],1),a("el-tab-pane",{attrs:{label:"版块",name:"second"}},[a("MyDraftsPanelIndex",{staticClass:"el-tab-pane-preview"})],1),a("el-tab-pane",{attrs:{label:"首页",name:"third"}},[a("MyDraftsHomePageIndex",{staticClass:"el-tab-pane-preview"})],1),a("el-tab-pane",{attrs:{label:"策略",name:"fourth"}},[a("MyDraftsPolicyIndex",{staticClass:"el-tab-pane-preview"})],1)],1)},eS=[],tS=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("MyDraftsTab",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{read:e.handleRead}}),e.isShowList||"special"!==e.tabParentType?e._e():a("FilmDetailPageAdd",{attrs:{id:e.id,initMode:e.mode,version:e.version},on:{"go-back":e.goBack,"open-list-page":e.handleUpsertEnd}}),e.isShowList||"biz"!==e.tabParentType?e._e():a("BusinessTabInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}),e.isShowList||"home"!==e.tabParentType?e._e():a("TabInfo",{attrs:{id:e.id,"init-mode":e.mode},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},aS=[],iS=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data}})],1)],1)},nS=[],oS={components:{Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"]},data:function(){var e=this;return{filter:{sort:void 0,order:void 0,type:"myDrafts"},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"tabId",width:"70"},{label:"名称",width:"170",prop:"tabName",sortable:!0,render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(i)}}},i.tabName)}},{label:"标题",prop:"tabCnTitle"},{label:"待处理的版本",prop:"currentVersion"},{label:"更新时间",prop:"lastUpdateDate",sortable:!0}],data:[],selected:[],selectionType:"none"}}},methods:{handleRead:function(e){this.$emit("read",e)},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.taskId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0,type:"myDrafts"},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();t.resourceType="tab",this.$service.todoTaskPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=co.a.map({taskId:co.a.o.string.other("form",{component:"Input",placeholder:"ID"}),taskName:co.a.o.string.other("form",{component:"Input",placeholder:"名称"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},rS=oS,lS=Object(Bn["a"])(rS,iS,nS,!1,null,null,null),sS=lS.exports,cS={components:{FilmDetailPageAdd:aI,MyDraftsTab:sS,TabInfo:Ov,BusinessTabInfo:Lw},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0,tabParentType:void 0}},methods:{handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},handleRead:function(e){this.id=e.tabId,this.mode="read",this.version=e.currentVersion,this.isShowList=!1,this.tabParentType=e.tabParentType,console.log(e.tabParentType)},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},uS=cS,dS=Object(Bn["a"])(uS,tS,aS,!1,null,"ffbdfa16",null),pS=dS.exports,hS=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("MyDraftsHomePage",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{read:e.handleRead}}),e.isShowList?e._e():a("HomePageInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},mS=[],fS=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data}})],1)],1)},gS=[],bS={components:{Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"]},data:function(){var e=this;return{filter:{sort:void 0,order:void 0,type:"myDrafts"},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"homepageId",width:"70"},{label:"名称",width:"170",prop:"homepageName",sortable:!0,render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(i)}}},i.homepageName)}},{label:"待处理的版本",prop:"currentVersion"},{label:"更新时间",prop:"lastUpdateDate",sortable:!0}],data:[],selected:[],selectionType:"none"}}},methods:{handleRead:function(e){this.$emit("read",e)},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.taskId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0,type:"myDrafts"},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();t.resourceType="homepage",this.$service.todoTaskPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=co.a.map({taskId:co.a.o.string.other("form",{component:"Input",placeholder:"ID"}),taskName:co.a.o.string.other("form",{component:"Input",placeholder:"名称"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},vS=bS,yS=Object(Bn["a"])(vS,fS,gS,!1,null,null,null),wS=yS.exports,IS={components:{MyDraftsHomePage:wS,HomePageInfo:Wv},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0,pannelType:void 0}},methods:{handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},handleRead:function(e){this.id=e.homepageId,this.mode="read",this.version=e.currentVersion,this.isShowList=!1},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},CS=IS,TS=Object(Bn["a"])(CS,hS,mS,!1,null,"b35fd33c",null),SS=TS.exports,kS=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("MyDraftsPolicy",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{read:e.handleRead}}),e.isShowList?e._e():a("PolicyManageInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},_S=[],PS=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data}})],1)],1)},xS=[],DS={components:{Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"]},data:function(){var e=this;return{filter:{sort:void 0,order:void 0,type:"myDrafts"},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"policyId",width:"70"},{label:"名称",width:"170",prop:"policyName",sortable:!0,render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(i)}}},i.policyName)}},{label:"更新时间",prop:"lastUpdateDate",sortable:!0}],data:[],selected:[],selectionType:"none"}}},methods:{handleRead:function(e){this.$emit("read",e)},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.taskId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0,type:"myDrafts"},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();t.resourceType="policy",this.$service.todoTaskPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=co.a.map({taskId:co.a.o.string.other("form",{component:"Input",placeholder:"ID"}),taskName:co.a.o.string.other("form",{component:"Input",placeholder:"名称"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},FS=DS,$S=Object(Bn["a"])(FS,PS,xS,!1,null,null,null),LS=$S.exports,RS={components:{MyDraftsPolicy:LS,PolicyManageInfo:xy},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0,pannelType:void 0}},methods:{handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},handleRead:function(e){this.id=e.policyId,this.mode="read",this.version=e.currentVersion,this.isShowList=!1},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},NS=RS,ES=Object(Bn["a"])(NS,kS,_S,!1,null,"62c65575",null),OS=ES.exports,AS=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("MyDraftsPanel",{directives:[{name:"show",rawName:"v-show",value:e.isShowList,expression:"isShowList"}],ref:"list",on:{read:e.handleRead}}),e.isShowList||8!==e.pannelType?e._e():a("MarkPanelInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}),e.isShowList||1!==e.pannelType?e._e():a("PanelInfo",{attrs:{id:e.id,"panel-data-type":1,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}),e.isShowList||3!==e.pannelType?e._e():a("PanelInfo",{attrs:{id:e.id,"panel-data-type":3,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}),e.isShowList||9!==e.pannelType?e._e():a("PrivatePannelInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}})],1)},VS=[],MS=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data}})],1)],1)},BS=[],US={components:{Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"]},data:function(){var e=this;return{filter:{sort:void 0,order:void 0,type:"myDrafts"},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"pannelGroupId",width:"70"},{label:"名称",width:"170",prop:"pannelGroupRemark",sortable:!0,render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(i)}}},i.pannelGroupRemark)}},{label:"标题",prop:"pannelTitle"},{label:"业务类型",prop:"categoryName"},{label:"更新时间",prop:"lastUpdateDate",sortable:!0}],data:[],selected:[],selectionType:"none"}}},methods:{handleRead:function(e){this.$emit("read",e)},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.taskId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0,type:"myDrafts"},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();t.resourceType="panel",this.$service.todoTaskPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=co.a.map({taskId:co.a.o.string.other("form",{component:"Input",placeholder:"ID"}),taskName:co.a.o.string.other("form",{component:"Input",placeholder:"名称"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},jS=US,GS=Object(Bn["a"])(jS,MS,BS,!1,null,null,null),WS=GS.exports,qS={components:{PanelInfo:Jp,MarkPanelInfo:bh,PrivatePannelInfo:Jh,MyDraftsPanel:WS},data:function(){return{isShowList:!0,id:void 0,mode:"create",version:void 0,pannelType:void 0}},methods:{handleUpsertEnd:function(e){this.$refs.list.fetchData(),e||(this.isShowList=!0,this.mode="list",this.version=void 0)},handleRead:function(e){this.id=e.pannelGroupId,this.mode="read",this.version=e.currentVersion,this.isShowList=!1,this.pannelType=parseInt(e.pannelType),console.log(e.pannelType)},goBack:function(){this.isShowList=!0,this.mode="list",this.version=void 0}}},HS=qS,zS=Object(Bn["a"])(HS,AS,VS,!1,null,"58c24aa4",null),JS=zS.exports,KS={components:{MyDraftsTabIndex:pS,MyDraftsHomePageIndex:SS,MyDraftsPolicyIndex:OS,MyDraftsPanelIndex:JS},data:function(){return{activeName:"first"}},methods:{handleClick:function(){}}},QS=KS,XS=(a("a8da"),Object(Bn["a"])(QS,ZT,eS,!1,null,"8ed0d998",null)),YS=XS.exports,ZS=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"版面",name:"tab"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"tabList"===e.mode,expression:"mode==='tabList'"}],ref:"tabList",attrs:{resourceType:"tab"},on:{read:e.handleRead}}),"tabPreview"===e.mode?a("TabPreview",{attrs:{row:e.previewData},on:{"go-back":e.goBack,"upsert-end":e.handleUpsertEnd}}):e._e()],1),a("el-tab-pane",{attrs:{label:"版块",name:"pannel"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"pannelList"===e.mode,expression:"mode==='pannelList'"}],ref:"pannelList",attrs:{resourceType:"pannel"},on:{read:e.handleRead}}),"pannelPreview"===e.mode?a("PanelPreview",{attrs:{row:e.previewData},on:{"go-back":e.goBack,"upsert-end":e.handleUpsertEnd}}):e._e()],1),a("el-tab-pane",{attrs:{label:"素材",name:"material"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"materialList"===e.mode,expression:"mode==='materialList'"}],attrs:{resourceType:"material"},on:{read:e.handleRead}}),"materialPreview"===e.mode?a("GlobalPictureUpsert",{attrs:{"edit-id":e.previewData.resourceId,initMode:"read"},on:{"show-list":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1),a("el-tab-pane",{attrs:{label:"布局",name:"layout"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"layoutList"===e.mode,expression:"mode==='layoutList'"}],attrs:{resourceType:"layout"},on:{read:e.handleRead}}),"layoutPreview"===e.mode?a("LayoutInfo",{staticClass:"el-tab-preview",attrs:{id:e.previewData.resourceId,"init-mode":"read"},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}},[e._v("\n      "+e._s(JSON.stringify(e.previewData))+"\n    ")]):e._e()],1),a("el-tab-pane",{attrs:{label:"首页",name:"homepage"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"homepageList"===e.mode,expression:"mode==='homepageList'"}],attrs:{resourceType:"homepage"},on:{read:e.handleRead}}),"homepagePreview"===e.mode?a("HomePageInfo",{staticClass:"el-tab-preview",attrs:{id:e.previewData.resourceId,"init-mode":"read",version:void 0},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1),a("el-tab-pane",{attrs:{label:"策略",name:"policy"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"policyList"===e.mode,expression:"mode==='policyList'"}],attrs:{resourceType:"policy"},on:{read:e.handleRead}}),"policyPreview"===e.mode?a("PolicyManageInfo",{attrs:{id:e.previewData.resourceId,"init-mode":"read",version:void 0},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1),a("el-tab-pane",{attrs:{label:"主题",name:"theme"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"themeList"===e.mode,expression:"mode==='themeList'"}],attrs:{resourceType:"theme"},on:{read:e.handleRead}}),"themePreview"===e.mode?a("ThemeInfoAdd",{attrs:{editId:e.previewData.resourceId,version:void 0,initMode:"read"},on:{"open-list-page":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1),a("el-tab-pane",{attrs:{label:"角标",name:"icon"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"iconList"===e.mode,expression:"mode==='iconList'"}],attrs:{resourceType:"icon"},on:{read:e.handleRead}}),"iconPreview"===e.mode?a("GlobalCornerIcon",{staticClass:"el-tab-preview",attrs:{id:e.previewData.resourceId,"init-mode":"read"},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1),a("el-tab-pane",{attrs:{label:"系统功能",name:"sysPlugin"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"sysPluginList"===e.mode,expression:"mode==='sysPluginList'"}],attrs:{resourceType:"sysPlugin"},on:{read:e.handleRead}}),"sysPluginPreview"===e.mode?a("MultiFunctionBlockInfo",{attrs:{"init-mode":"read",id:e.previewData.resourceId},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1)],1)},ek=[],tk=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data}})],1)],1)},ak=[],ik={components:{Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"]},props:{resourceType:String},data:function(){var e=this;return{filter:{sort:void 0,order:void 0,type:"myAuditTasks"},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"taskId",width:"100"},{label:"名称",width:"130",prop:"taskName",sortable:!0,render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(i)}}},i.taskName)}},{label:"待处理的版本",prop:"resourceVersion",render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(i)}}},i.taskName)}},{label:"内容源",prop:"source"},{label:"优先级",prop:"priority",render:function(t,a){var i=a.row;return e.$numToReviewPriority(i.priority)}},{label:"任务状态",prop:"taskFlag",render:function(t,a){var i=a.row;return e.$numToTaskStatus(i.taskFlag)}},{label:"审核状态",prop:"auditFlag",render:function(t,a){var i=a.row;return e.$numToAuditStatus(i.auditFlag)}},{label:"审核人",prop:"currentOperatorName"},{label:"审核意见",prop:"auditDesc"},{label:"更新时间",prop:"lastUpdateDate",width:150,sortable:!0}],data:[],selected:[],selectionType:"none"}}},methods:{handleRead:function(e){this.$emit("read",e,this.resourceType+"Preview")},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.taskId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0,type:"myAuditTasks"},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();t.resourceType=this.resourceType,this.$service.todoTaskPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=co.a.map({taskId:co.a.o.string.other("form",{component:"Input",placeholder:"ID"}),taskName:co.a.o.string.other("form",{component:"Input",placeholder:"名称"}),auditFlag:co.a.o.enum({"审核中":6,"待审核":3,"审核通过":4,"审核不通过":5}).other("form",{component:"Select",placeholder:"审核状态"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},nk=ik,ok=Object(Bn["a"])(nk,tk,ak,!1,null,null,null),rk=ok.exports,lk=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"el-tab-pane-preview"},["special"===e.tabParentType&&void 0!==e.id?a("FilmDetailPageAdd",{attrs:{id:e.id,initMode:e.mode,version:e.version},on:{"open-list-page":e.handleUpsertEnd,"go-back":e.goBack}}):e._e(),"biz"===e.tabParentType&&void 0!==e.id?a("BusinessTabInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}):e._e(),"home"===e.tabParentType&&void 0!==e.id?a("TabInfo",{attrs:{id:e.id,"init-mode":e.mode},on:{"go-back":e.goBack,"upsert-end":e.handleUpsertEnd}}):e._e()],1)},sk=[],ck={components:{FilmDetailPageAdd:aI,BusinessTabInfo:Lw,TabInfo:Ov},props:["row"],data:function(){return{id:void 0,mode:"read",version:void 0,tabParentType:void 0}},methods:{goBack:function(){this.$emit("go-back")},handleUpsertEnd:function(){this.$emit("upsert-end")}},created:function(){var e=this.row;this.id=e.resourceId,this.tabParentType=e.tabParentType,this.version=e.resourceVersion}},uk=ck,dk=(a("0f91"),Object(Bn["a"])(uk,lk,sk,!1,null,"02d32640",null)),pk=dk.exports,hk=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"el-tab-pane-preview"},[8===e.pannelType?a("MarkPanelInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"go-back":e.goBack}}):e._e(),1===e.pannelType?a("PanelInfo",{attrs:{id:e.id,"panel-data-type":1,"init-mode":e.mode,version:e.version},on:{"go-back":e.goBack}}):e._e(),3===e.pannelType?a("PanelInfo",{attrs:{id:e.id,"panel-data-type":3,"init-mode":e.mode,version:e.version},on:{"go-back":e.goBack}}):e._e(),9===e.pannelType||10===e.pannelType||5===e.pannelType?a("PrivatePannelInfo",{attrs:{id:e.id,"init-mode":e.mode,version:e.version},on:{"go-back":e.goBack}}):e._e()],1)},mk=[],fk={components:{PanelInfo:Jp,MarkPanelInfo:bh,PrivatePannelInfo:Jh},props:["row"],data:function(){return{id:void 0,mode:"read",version:void 0,pannelType:void 0}},methods:{goBack:function(){this.$emit("go-back")}},created:function(){var e=this.row;this.id=e.resourceId,this.pannelType=e.pannelType,this.version=e.resourceVersion}},gk=fk,bk=(a("5598"),Object(Bn["a"])(gk,hk,mk,!1,null,"80a14bfe",null)),vk=bk.exports,yk={components:{MySubmitTasksList:rk,PanelPreview:vk,TabPreview:pk,GlobalPictureUpsert:_f,LayoutInfo:sg,HomePageInfo:Wv,PolicyManageInfo:xy,ThemeInfoAdd:jT,GlobalCornerIcon:Km,MultiFunctionBlockInfo:ru},data:function(){return{activeName:"tab",mode:"tabList",preMode:"tabList",previewData:void 0}},methods:{handleRead:function(e,t){this.previewData=e,this.preMode=this.mode,this.mode=t},goBack:function(){this.mode=this.preMode},handleClick:function(e){this.mode=this.preMode=e.name+"List"},handleUpsertEnd:function(){this.$refs[this.preMode].fetchData()}}},wk=yk,Ik=(a("d82d"),Object(Bn["a"])(wk,ZS,ek,!1,null,"100f138f",null)),Ck=Ik.exports,Tk=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"版面",name:"tab"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"tabList"===e.mode,expression:"mode==='tabList'"}],ref:"tabList",attrs:{resourceType:"tab"},on:{read:e.handleRead}}),"tabPreview"===e.mode?a("TabPreview",{attrs:{row:e.previewData},on:{"go-back":e.goBack,"upsert-end":e.handleUpsertEnd}}):e._e()],1),a("el-tab-pane",{attrs:{label:"版块",name:"pannel"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"pannelList"===e.mode,expression:"mode==='pannelList'"}],ref:"pannelList",attrs:{resourceType:"pannel"},on:{read:e.handleRead}}),"pannelPreview"===e.mode?a("PanelPreview",{attrs:{row:e.previewData},on:{"go-back":e.goBack,"upsert-end":e.handleUpsertEnd}}):e._e()],1),a("el-tab-pane",{attrs:{label:"素材",name:"material"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"materialList"===e.mode,expression:"mode==='materialList'"}],attrs:{resourceType:"material"},on:{read:e.handleRead}}),"materialPreview"===e.mode?a("GlobalPictureUpsert",{attrs:{"edit-id":e.previewData.resourceId,initMode:"read"},on:{"show-list":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1),a("el-tab-pane",{attrs:{label:"布局",name:"layout"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"layoutList"===e.mode,expression:"mode==='layoutList'"}],attrs:{resourceType:"layout"},on:{read:e.handleRead}}),"layoutPreview"===e.mode?a("LayoutInfo",{staticClass:"el-tab-preview",attrs:{id:e.previewData.resourceId,"init-mode":"read"},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1),a("el-tab-pane",{attrs:{label:"首页",name:"homepage"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"homepageList"===e.mode,expression:"mode==='homepageList'"}],attrs:{resourceType:"homepage"},on:{read:e.handleRead}}),"homepagePreview"===e.mode?a("HomePageInfo",{staticClass:"el-tab-preview",attrs:{id:e.previewData.resourceId,"init-mode":"read",version:void 0},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1),a("el-tab-pane",{attrs:{label:"策略",name:"policy"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"policyList"===e.mode,expression:"mode==='policyList'"}],attrs:{resourceType:"policy"},on:{read:e.handleRead}}),"policyPreview"===e.mode?a("PolicyManageInfo",{attrs:{id:e.previewData.resourceId,"init-mode":"read",version:void 0},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1),a("el-tab-pane",{attrs:{label:"主题",name:"theme"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"themeList"===e.mode,expression:"mode==='themeList'"}],attrs:{resourceType:"theme"},on:{read:e.handleRead}}),"themePreview"===e.mode?a("ThemeInfoAdd",{attrs:{editId:e.previewData.resourceId,version:void 0,initMode:"read"},on:{"open-list-page":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1),a("el-tab-pane",{attrs:{label:"角标",name:"icon"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"iconList"===e.mode,expression:"mode==='iconList'"}],attrs:{resourceType:"icon"},on:{read:e.handleRead}}),"iconPreview"===e.mode?a("GlobalCornerIcon",{attrs:{id:e.previewData.resourceId,"init-mode":"read"},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1),a("el-tab-pane",{attrs:{label:"系统功能",name:"sysPlugin"}},[a("MySubmitTasksList",{directives:[{name:"show",rawName:"v-show",value:"sysPluginList"===e.mode,expression:"mode==='sysPluginList'"}],attrs:{resourceType:"sysPlugin"},on:{read:e.handleRead}}),"sysPluginPreview"===e.mode?a("MultiFunctionBlockInfo",{attrs:{"init-mode":"read",id:e.previewData.resourceId},on:{"upsert-end":e.handleUpsertEnd,"go-back":e.goBack}}):e._e()],1)],1)},Sk=[],kk=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{filter:e.filter,filterSchema:e.filterSchema,pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data}})],1)],1)},_k=[],Pk={components:{Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"]},props:{resourceType:String},data:function(){var e=this;return{filter:{sort:void 0,order:void 0,type:"mySubmittedTasks"},filterSchema:null,pagination:{},selected:[],table:{props:{},header:[{label:"ID",prop:"taskId",width:"100"},{label:"名称",width:"130",prop:"taskName",sortable:!0,render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(i)}}},i.taskName)}},{label:"待处理的版本",prop:"resourceVersion",render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(i)}}},i.taskName)}},{label:"内容源",prop:"source"},{label:"优先级",prop:"priority",render:function(t,a){var i=a.row;return e.$numToReviewPriority(i.priority)}},{label:"任务状态",prop:"taskFlag",render:function(t,a){var i=a.row;return e.$numToTaskStatus(i.taskFlag)}},{label:"审核状态",prop:"auditFlag",render:function(t,a){var i=a.row;return e.$numToAuditStatus(i.auditFlag)}},{label:"审核人",prop:"currentOperatorName"},{label:"审核意见",prop:"auditDesc"},{label:"更新时间",prop:"lastUpdateDate",width:150,sortable:!0}],data:[],selected:[],selectionType:"none"}}},methods:{handleRead:function(e){this.$emit("read",e,this.resourceType+"Preview")},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.taskId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={sort:void 0,order:void 0,type:"mySubmittedTasks"},this.pagination.currentPage=1,this.fetchData()},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},fetchData:function(){var e=this,t=this.parseFilter();t.resourceType=this.resourceType,this.$service.todoTaskPageList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})}},created:function(){var e=co.a.map({taskId:co.a.o.string.other("form",{component:"Input",placeholder:"ID"}),taskName:co.a.o.string.other("form",{component:"Input",placeholder:"名称"}),auditFlag:co.a.o.enum({"待审核":3,"审核通过":4,"审核不通过":5}).other("form",{component:"Select",placeholder:"审核状态"})}).other("form",{cols:{item:6,label:0,wrapper:20},layout:"inline",footer:{cols:{label:0,wrapper:24},showSubmit:!0,submitText:"查询",showReset:!0,resetText:"重置"}});this.filterSchema=e,this.fetchData()}},xk=Pk,Dk=Object(Bn["a"])(xk,kk,_k,!1,null,null,null),Fk=Dk.exports,$k={components:{MySubmitTasksList:Fk,PanelPreview:vk,TabPreview:pk,GlobalPictureUpsert:_f,LayoutInfo:sg,HomePageInfo:Wv,PolicyManageInfo:xy,ThemeInfoAdd:jT,GlobalCornerIcon:Km,MultiFunctionBlockInfo:ru},data:function(){return{activeName:"tab",mode:"tabList",preMode:"tabList",previewData:void 0}},methods:{handleRead:function(e,t){this.previewData=e,this.preMode=this.mode,this.mode=t},goBack:function(){this.mode=this.preMode},handleClick:function(e){this.mode=this.preMode=e.name+"List"},handleUpsertEnd:function(){this.$refs[this.preMode].fetchData()}}},Lk=$k,Rk=(a("5d88"),Object(Bn["a"])(Lk,Tk,Sk,!1,null,"cdce334c",null)),Nk=Rk.exports,Ek=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ContentCard",[i("div",{staticClass:"ad-upsert"},[i("el-tabs",{model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[i("el-tab-pane",{staticClass:"detail-ad-wrapper",attrs:{label:"详情页广告位",name:"detail"}},[i("img",{staticClass:"detail-ad-1-2",attrs:{src:a("58c5")}}),i("img",{staticClass:"detail-ad-3",attrs:{src:a("580c")}}),i("el-form",{ref:"form",staticClass:"detail-form",attrs:{"label-width":"150px"}},[e.adSwitches.middle?i("cc-var",{attrs:{ad:e.adSwitches.middle},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[i("el-form-item",{staticClass:"detail-ad__1",attrs:{label:a.label}},[i("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,4110040685)}):e._e(),e.adSwitches.bottom_serial?i("cc-var",{attrs:{ad:e.adSwitches.bottom_serial},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[i("el-form-item",{staticClass:"detail-ad__2",attrs:{label:a.label}},[i("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,3558405422)}):e._e(),e.adSwitches.bottom_movie?i("cc-var",{attrs:{ad:e.adSwitches.bottom_movie},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[i("el-form-item",{staticClass:"detail-ad__3",attrs:{label:a.label}},[i("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,4197844207)}):e._e()],1)],1),i("el-tab-pane",{attrs:{label:"视频播放广告",name:"video"}},[i("div",{staticClass:"video-ad-wrapper"},[i("p",{staticClass:"ad-title"},[e._v("前贴广告A"),i("span",[e._v("(加在腾讯、爱奇艺前贴广告之前的，酷开前贴广告)")])]),i("el-form",{attrs:{inline:!0,"label-width":"150px","label-position":"left"}},[e.adSwitches.front_detail_a?i("cc-var",{attrs:{ad:e.adSwitches.front_detail_a},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[i("el-form-item",{attrs:{label:a.label}},[i("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,3495716613)}):e._e(),e.adSwitches.front_loop_a?i("cc-var",{attrs:{ad:e.adSwitches.front_loop_a},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[i("el-form-item",{attrs:{label:a.label}},[i("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,3495716613)}):e._e(),e.adSwitches.front_topic_a?i("cc-var",{attrs:{ad:e.adSwitches.front_topic_a},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[i("el-form-item",{attrs:{label:a.label}},[i("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,3495716613)}):e._e()],1)],1),i("div",{staticClass:"video-ad-wrapper"},[i("p",{staticClass:"ad-title"},[e._v("前贴广告B"),i("span",[e._v("(仅针对腾讯、爱奇艺不播前贴广告的场景，才播放我们自己的前贴广告B)")])]),i("el-form",{attrs:{inline:!0,"label-width":"150px","label-position":"left"}},[e.adSwitches.front_detail_b?i("cc-var",{attrs:{ad:e.adSwitches.front_detail_b},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[i("el-form-item",{attrs:{label:a.label}},[i("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,3495716613)}):e._e(),e.adSwitches.front_loop_b?i("cc-var",{attrs:{ad:e.adSwitches.front_loop_b},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[i("el-form-item",{attrs:{label:a.label}},[i("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,3495716613)}):e._e(),e.adSwitches.front_topic_b?i("cc-var",{attrs:{ad:e.adSwitches.front_topic_b},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[i("el-form-item",{attrs:{label:a.label}},[i("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,3495716613)}):e._e()],1)],1),i("div",{staticClass:"video-ad-wrapper"},[i("p",{staticClass:"ad-title"},[e._v("中插广告")]),i("el-form",{attrs:{inline:!0,"label-width":"150px","label-position":"left"}},[e.adSwitches.middle_detail?i("cc-var",{attrs:{ad:e.adSwitches.middle_detail},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[i("el-form-item",{attrs:{label:a.label}},[i("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,3495716613)}):e._e(),e.adSwitches.middle_loop?i("cc-var",{attrs:{ad:e.adSwitches.middle_loop},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[i("el-form-item",{attrs:{label:a.label}},[i("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,3495716613)}):e._e(),e.adSwitches.middle_topic?i("cc-var",{attrs:{ad:e.adSwitches.middle_topic},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[i("el-form-item",{attrs:{label:a.label}},[i("el-switch",{attrs:{"active-text":"开","inactive-text":"关",value:a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,3495716613)}):e._e()],1)],1)]),i("el-tab-pane",{attrs:{label:"主页广告",name:"homepage"}},[i("div",{staticClass:"video-ad-wrapper"},[i("p",{staticClass:"ad-title"},[e._v("主页霸屏广告")]),i("el-form",{attrs:{inline:!0,"label-width":"150px","label-position":"left"}},[e.adSwitches.screen?i("cc-var",{attrs:{ad:e.adSwitches.screen},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.ad;return[i("el-form-item",{attrs:{label:a.label}},[i("el-switch",{attrs:{"on-text":"开","off-text":"关",value:a.value},on:{input:function(t){return e.handleToggleSwitch(a)}}})],1)]}}],null,!1,142842380)}):e._e()],1)],1)])],1)],1)])},Ok=[],Ak={components:{"cc-var":$b},data:function(){return{adSwitches:{},activeTab:"detail"}},methods:{handleToggleSwitch:function(e){var t=this;this.$confirm("确定"+(e.value?"关闭":"开启")+"【"+e.label+"】的广告投放权限吗？").then(function(){t.$service.advertisementUpsert({id:e.id,status:e.value?0:1},"操作成功").then(function(t){e.value=!e.value})}).catch(function(){})},getLabel:function(e,t){return this.adSwitches[e+t].label},getSwitches:function(){var e=this;this.$service.advertisementList().then(function(t){var a={};t.rows.forEach(function(e){a[e.remark]={id:e.id,label:e.name,key:e.remark,value:!!e.status}}),e.$set(e,"adSwitches",a)})}},created:function(){this.getSwitches()}},Vk=Ak,Mk=(a("561d"),Object(Bn["a"])(Vk,Ek,Ok,!1,null,null,null)),Bk=Mk.exports,Uk=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{staticClass:"layout"},[a("div",{class:e.isCollapseMenu?"aside__menu aside__menu_collapse":"aside__menu"},[a("div",{staticClass:"left-aside"},[a("el-button",{staticClass:"collpase-btn",attrs:{type:"text",icon:e.isCollapseMenu?"el-icon-cc-indent":"el-icon-cc-outdent"},on:{click:e.toggleMenu}}),a("Menu",{attrs:{"default-active":e.$route.name,items:e.menu,isCollapse:e.isCollapseMenu},on:{select:e.handleOpenMenu}})],1)]),a("el-container",{attrs:{direction:"vertical"}},[a("el-header",{staticClass:"header"},[a("div",{staticClass:"logo",attrs:{direction:"vertical"}},[a("div",{staticClass:"logo__img"},[a("i",{staticClass:"el-icon-location"}),e._v(" "+e._s(e.companyMap[e.$consts.idPrefix])+"内容运营平台\n        ")])]),a("span",{staticClass:"el-breadcrumb__separator",attrs:{role:"presentation"}},[e._v("/")]),a("Breadcrumb",{staticClass:"breadcrumb",attrs:{items:e.breadcrumb}}),a("div",{staticClass:"user-info"},[a("el-dropdown",{attrs:{"hide-on-click":!1},on:{command:e.handleDropdownCommand}},[a("span",{staticClass:"el-dropdown-link"},[a("i",{staticClass:"el-icon-cc-user"}),e._v("\n            "+e._s(e.$appState.user.name)+"\n            "),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"modifyPassword"},nativeOn:{click:function(t){return e.modifyPwd(t)}}},[e._v("修改密码")]),a("el-dropdown-item",{attrs:{command:"logout"}},[e._v("退出")])],1)],1)],1)],1),a("TagNav",{directives:[{name:"show",rawName:"v-show",value:e.isShowTagNav,expression:"isShowTagNav"}],ref:"tag",staticClass:"tagNav",attrs:{"default-path":"/desktop",titles:e.titles,"init-tags":e.initTags}}),a("el-main",[a("keep-alive",[e.isKeepAlive?a("router-view"):e._e()],1),e.isKeepAlive?e._e():a("router-view")],1)],1),a("el-dialog",{attrs:{title:"修改密码",visible:e.modifyDialogVisible},on:{"update:visible":function(t){e.modifyDialogVisible=t}}},[a("span",[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.formRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"旧密码",prop:"oldpwd"}},[a("el-input",{attrs:{placeholder:"旧密码"},model:{value:e.form.oldpwd,callback:function(t){e.$set(e.form,"oldpwd",t)},expression:"form.oldpwd"}})],1),a("el-form-item",{attrs:{label:"新密码",prop:"newpwd"}},[a("el-input",{attrs:{placeholder:"旧密码"},model:{value:e.form.newpwd,callback:function(t){e.$set(e.form,"newpwd",t)},expression:"form.newpwd"}})],1),a("el-form-item",{attrs:{label:"确认新密码",prop:"newpwd2"}},[a("el-input",{attrs:{placeholder:"旧密码"},model:{value:e.form.newpwd2,callback:function(t){e.$set(e.form,"newpwd2",t)},expression:"form.newpwd2"}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.modifyDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.modifyPwdSave}},[e._v("确 定")])],1)])],1)},jk=[],Gk=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-menu",{staticClass:"menu",attrs:{"background-color":e.backgroundColor,"text-color":e.textColor,"active-text-color":e.activeTextColor,defaultActive:e.defaultActive,collapse:e.isCollapse},on:{select:e.handleSelect}},[e._l(e.items,function(t,i){return[t.children?a("el-submenu",{key:i,attrs:{index:i+""}},[a("template",{slot:"title"},[t.icon?a("i",{class:t.icon}):e._e(),a("span",[e._v(e._s(t.title))])]),e._l(t.children,function(t,n){return["undefined"===typeof t.children?a("el-menu-item",{key:n,attrs:{index:t.route}},[t.icon?a("i",{class:t.icon}):e._e(),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.title))])]):a("el-submenu",{key:n,attrs:{index:i+"_"+n}},[a("template",{slot:"title"},[t.icon?a("i",{class:t.icon}):e._e(),a("span",[e._v(e._s(t.title))])]),e._l(t.children,function(t,i){return[a("el-menu-item",{key:i,attrs:{index:t.route}},[t.icon?a("i",{class:t.icon}):e._e(),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.title))])])]})],2)]})],2):a("el-menu-item",{key:i,attrs:{index:t.route}},[t.icon?a("i",{class:t.icon}):e._e(),a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.title))])])]})],2)},Wk=[],qk={data:function(){return{itemsIndexed:{}}},props:["isCollapse","items","defaultActive","textColor","activeTextColor","backgroundColor"],methods:{handleSelect:function(e){this.$emit("select",e,this.itemsIndexed[e])},buildIndex:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t={};function a(e){e.route&&(t[e.route]=e),e.children&&e.children.forEach(a),Array.isArray(e)&&e.forEach(a)}a(e),this.itemsIndexed=t}},created:function(){this.$watch("items",this.buildIndex,{immediate:!0})}},Hk=qk,zk=Object(Bn["a"])(Hk,Gk,Wk,!1,null,null,null),Jk=zk.exports,Kk={rotateStationCategory:"rotateStationCategory",rotateStationCategory_viewStation:"rotateStationCategory_viewStation",rotateTopicInfo:"rotateTopicInfo",broadcastBlock:"broadcastBlock",multiFunctionBlock:"multiFunctionBlock",sysPlugin:"sysPlugin",albumPannelInfo:"albumPannelInfo",markPanel:"markPanel",pannelInfo:"pannelInfo",privatePannelInfo:"privatePannelInfo",commonOnclickInfo:"commonOnclickInfo",globalCornerIcon:"globalCornerIcon",globalCornerIconType:"globalCornerIconType",globalPicture:"globalPicture",layoutInfo:"layoutInfo",commonAlbumPanneleUser:"commonAlbumPanneleUser",commonPannelUser:"commonPannelUser",commonTabUser:"commonTabUser",dataSync:"dataSync",slaveBizErrLog:"slaveBizErrLog",slaveSecondAudit:"slaveSecondAudit",actDmpGroupInfo:"actDmpGroupInfo",homepageInfo:"homepageInfo",policyConf:"policyConf",testPolicyConf:"testPolicyConf",businessTab:"businessTab",filmDetailPage:"filmDetailPage",tabInfo:"tabInfo",videoContent:"videoContent",adminMasterControl:"adminMasterControl",dict:"dataDictionary",baDept:"baDept",roleConfig:"roleConfig",sysLogLogin:"sysLogLogin",sysLogOp:"sysLogOp",sysMenu:"sysMenu",userConfig:"userConfig",themeInfo:"themeInfo",msn:"msn",myDrafts:"myDrafts",myReviewTasks:"myReviewTasks",mySubmitTasks:"mySubmitTasks",filmDetailAdBit:"filmDetailAdBit",dmpMgr:"dmpMgr"},Qk={components:{Menu:Jk,Breadcrumb:Dn["Breadcrumb"],TagNav:Dn["TagNav"]},data:function(){return{menu:[],titles:{},breadcrumb:[],isCollapseMenu:!1,isShowSetting:!1,isShowTagNav:!0,modifyDialogVisible:!1,companyMap:{10:"酷开",11:"江苏有线"},form:{oldpwd:null,newpwd:null,newpwd2:null},formRules:{oldpwd:[{required:!0,message:"请输入原始密码",trigger:"blur"}],newpwd:[{required:!0,message:"请输入新密码",trigger:"blur"}],newpwd2:[{required:!0,validator:this.validatePass2,trigger:"blur"}]}}},computed:{isKeepAlive:function(){var e=this.$route.meta;return e&&!1!==e.isCache},initTags:function(){return this.$appState.$get("tags_"+this.$appState.user.name)||[]},defaultMenu:function(){var e=this.$router.options.routes.find(function(e){return"/"===e.path});function t(e){var a=e.name,i=e.meta,n=void 0===i?{}:i,o=e.children;if(!n.hideInMenu){var r={title:n.title,icon:n.icon,route:a};return o&&(r.children=o.reduce(function(e,a){var i=t(a);return i&&e.push(i),e},[])),r}}e.children.pop();var a=t(e).children;return console.log("defaultMenu:",a),a}},methods:{handleOpenMenu:function(e,t){this.$router.push({name:Kk[e],query:t.query,params:t.params})},modifyPwd:function(){this.modifyDialogVisible=!0},modifyPwdSave:function(){var e=this;this.$refs.form.validate(function(t){t&&e.$service.modifyPwd(e.form,"修改成功").then(function(t){e.modifyDialogVisible=!1,e.$logout().then(function(){e.$router.push({name:"login"})})})})},validatePass2:function(e,t,a){""===t?a(new Error("请再次输入密码")):t!=this.form.newpwd?a(new Error("两次输入密码不一致！")):a()},handleDropdownCommand:function(e){var t=this;"logout"===e&&this.$logout().then(function(){t.$router.push({name:"login"})})},toggleMenu:function(){var e=!this.isCollapseMenu;this.$appState.$set("isCollapseMenu",e),this.isCollapseMenu=e},saveTags:function(){var e=this.$refs.tag.tags;0===e.length?e.unshift({fullPath:"/desktop",meta:{title:"我的桌面",tagId:"desktop"},name:"desktop",isCloseable:!1}):"desktop"!==e[0].name&&e.unshift({fullPath:"/desktop",meta:{title:"我的桌面",tagId:"desktop"},name:"desktop",isCloseable:!1}),this.$appState.$set("tags_"+this.$appState.user.name,e)},getMenu:function(){var e=this;this.$service.getMenu().then(function(t){var a={},i=function e(t){if(Array.isArray(t))return t.map(e);a[t.id]=t.text;var i={icon:t.icon,route:t.id,title:t.text},n=t.attributes;n&&"3"===n.modle&&(i.openType=n.iframeUrl,i.query={url:n.iframeUrl});var o=t.children;return o&&o.length>0&&(i.children=e(o)),i};e.menu=i(t),e.titles=a})}},created:function(){var e=this;this.isCollapseMenu=!!this.$appState.$get("isCollapseMenu"),this.$bus.$on("breadcrumb-change",function(t){e.breadcrumb=t}),this.getMenu()},mounted:function(){window.addEventListener("beforeunload",this.saveTags)},destroyed:function(){window.removeEventListener("beforeunload",this.saveTags)}},Xk=Qk,Yk=(a("38b6"),Object(Bn["a"])(Xk,Uk,jk,!1,null,"b8bb6cac",null)),Zk=Yk.exports,e_=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("PageWrapper",[i("PageContentWrapper",{directives:[{name:"show",rawName:"v-show",value:"desktop"===e.activePage,expression:"activePage === 'desktop'"}]},[i("ContentCard",{staticClass:"content"},[i("h2",[e._v("待处理任务")]),i("div",{staticClass:"list"},[i("div",[i("el-card",{staticClass:"box-card",staticStyle:{cursor:"pointer"}},[i("div",{on:{click:function(t){return e.goTo("myDrafts")}}},[i("img",{staticClass:"cod-img",attrs:{src:a("2366")}}),i("div",{staticClass:"text-wrap"},[i("span",{staticClass:"text"},[e._v("我的草稿")]),i("span",{staticClass:"text-num"},[e._v("("+e._s(e.draftNum)+")")])])])])],1),i("div",[i("el-card",{staticClass:"box-card",staticStyle:{cursor:"pointer"}},[i("div",{on:{click:function(t){return e.goTo("mySubmitTasks")}}},[i("img",{staticClass:"cod-img",attrs:{src:a("66d9")}}),i("div",{staticClass:"text-wrap"},[i("span",{staticClass:"text"},[e._v("我提交的任务")]),i("span",{staticClass:"text-num"},[e._v("("+e._s(e.submitNum)+")")])])])])],1),i("div",[i("el-card",{staticClass:"box-card",staticStyle:{cursor:"pointer"}},[i("div",{on:{click:function(t){return e.goTo("myReviewTasks")}}},[i("img",{staticClass:"cod-img",attrs:{src:a("3c3a")}}),i("div",{staticClass:"text-wrap"},[i("span",{staticClass:"text"},[e._v("我的审核任务")]),i("span",{staticClass:"text-num"},[e._v("("+e._s(e.auditNum)+")")])])])])],1),i("div",[i("el-card",{staticClass:"box-card",staticStyle:{cursor:"pointer"}},[i("div",{on:{click:function(t){return e.goTo("msn")}}},[i("img",{staticClass:"cod-img",attrs:{src:a("55cf")}}),i("div",{staticClass:"text-wrap"},[i("span",{staticClass:"text"},[e._v("下架影片")]),i("span",{staticClass:"text-num"},[e._v("("+e._s(e.movieNum)+")")])])])])],1)])]),"11"==e.$consts.idPrefix?i("ContentCard",{staticStyle:{"margin-top":"20px"}},[i("div",[i("h2",[e._v("\n          江苏有线\n          "),i("span",{directives:[{name:"show",rawName:"v-show",value:void 0!==e.isAutoSync,expression:"isAutoSync !== undefined"}],staticStyle:{float:"right","font-weight":"normal"}},[e._v("\n            是否自动同步酷开数据 "),i("el-switch",{attrs:{value:e.isAutoSync},on:{input:function(t){return e.handleSetAutoSync(t)}}})],1)]),!1===e.isAutoSync&&e.dataSyncGeneral?i("div",[i("el-row",{staticClass:"data-sync-list"},[i("el-col",{staticClass:"data-sync-list__item",attrs:{span:24},nativeOn:{click:function(t){return e.handleViewDataList("panel-list")}}},[i("span",[e._v("常规运营版块")]),i("span",{staticClass:"data-sync-list__num"},[e._v(e._s(e.dataSyncGeneral.normalPanel.total))])]),i("el-col",{staticClass:"data-sync-list__item",attrs:{span:24},nativeOn:{click:function(t){return e.handleViewDataList("album-list")}}},[i("span",[e._v("业务专辑版块")]),i("span",{staticClass:"data-sync-list__num"},[e._v(e._s(e.dataSyncGeneral.albumPanel.total))])]),i("el-col",{staticClass:"data-sync-list__item",attrs:{span:24},nativeOn:{click:function(t){return e.handleViewDataList("tab-list")}}},[i("span",[e._v("TAB版面")]),i("span",{staticClass:"data-sync-list__num"},[e._v(e._s(e.dataSyncGeneral.otherTab.total))])]),i("el-col",{staticClass:"data-sync-list__item",attrs:{span:24},nativeOn:{click:function(t){return e.handleViewDataList("film-list")}}},[i("span",[e._v("影视详情页版面")]),i("span",{staticClass:"data-sync-list__num"},[e._v(e._s(e.dataSyncGeneral.filmDetailTab.total))])])],1)],1):e._e()])]):e._e()],1),"panel-list"===e.activePage?i("PageContentWrapper",[i("keep-alive",[i("PanelList",{on:{read:e.handleReadPanel,"go-back":e.goBack}})],1)],1):e._e(),"tab-list"===e.activePage?i("PageContentWrapper",[i("keep-alive",[i("TabList",{on:{read:e.handleReadTab,"go-back":e.goBack}})],1)],1):e._e(),"album-list"===e.activePage?i("PageContentWrapper",[i("keep-alive",[i("AlbumList",{on:{read:e.handleReadPanel,"go-back":e.goBack}})],1)],1):e._e(),"film-list"===e.activePage?i("PageContentWrapper",[i("keep-alive",[i("FilmPageList",{on:{read:e.handleReadFilm,"go-back":e.goBack}})],1)],1):e._e(),"panel-read"===e.activePage?i("PageContentWrapper",[i("PanelInfo",{attrs:{id:e.panelPreview.id,"panel-data-type":e.panelPreview.dataType,"init-mode":"read",version:e.panelPreview.version},on:{"upsert-end":function(t){return e.goBack(3==e.panelPreview.dataType?"album-list":"panel-list")},"go-back":function(t){return e.goBack(3==e.panelPreview.dataType?"album-list":"panel-list")}}})],1):e._e(),"tab-read"===e.activePage?i("PageContentWrapper",[i("TabInfo",{attrs:{id:e.tabPreview.id,"init-mode":"read",version:e.tabPreview.version},on:{"upsert-end":function(t){return e.goBack("tab-list")},"go-back":function(t){return e.goBack("tab-list")}}})],1):e._e(),"film-read"===e.activePage?i("PageContentWrapper",[i("TabInfo",{attrs:{id:e.filmPreview.id,"init-mode":"read",version:e.filmPreview.version},on:{"upsert-end":function(t){return e.goBack("tab-list")},"go-back":function(t){return e.goBack("tab-list")}}})],1):e._e()],1)},t_=[],a_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:"待处理板块"},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("ContentWrapper",{attrs:{pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},i_=[],n_={extends:Po,components:{ContentWrapper:Dn["ContentWrapper"],Table:Dn["Table"]},data:function(){var e=this;return{resourceType:"panelInfo",filter:this.genDefaultFilter(),filterSchema:null,pagination:{currentPage:1,pageSize:20},businessType:{},table:{props:{},data:[],header:[{label:"ID",prop:"pannelGroupId"},{label:"名称",minWidth:"180","show-overflow-tooltip":!0,render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(i)}}},i.pannelGroupRemark)}},{label:"布局",width:"150",prop:"fullLayoutName"},{label:"业务分类",prop:"categoryName"},{label:"内容源",prop:"pannelResource",formatter:function(t){return e.$consts.sourceText[t.pannelList[0].pannelResource]}},{label:"引用状态",prop:"fullTabName","show-overflow-tooltip":!0},{label:"版本/状态",prop:"pannelStatus",width:"130",formatter:function(t){var a=t.pannelStatus,i=t.currentVersion;return i+"/"+e.$consts.statusText[a]}},{label:"更新时间",prop:"lastUpdateDate",width:"140","show-overflow-tooltip":!0},{label:"审核人",prop:"auditor",width:"100"},{label:"更新人",width:"100",prop:"userName"}],selected:[],selectionType:"multiple"},selected:[]}},methods:{genDefaultFilter:function(){return{keyword:"pannel",subCategoryArray:"1"}},fetchData:function(){var e=this,t=this.parseFilter();this.$service.desktopGetDataSyncList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.pannelId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){console.log(this.dataList),this.dataList?(this.filter=Object.assign({},this.dataList.filter),console.log(this.filter)):this.filter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()}},created:function(){this.fetchData()}},o_=n_,r_=Object(Bn["a"])(o_,a_,i_,!1,null,"7a996b4f",null),l_=r_.exports,s_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:"待处理业务专辑"},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("ContentWrapper",{attrs:{pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},c_=[],u_={extends:Po,components:{ContentWrapper:Dn["ContentWrapper"],Table:Dn["Table"]},data:function(){var e=this;return{resourceType:"panelInfo",filter:this.genDefaultFilter(),filterSchema:null,pagination:{currentPage:1,pageSize:20},businessType:{},table:{props:{},data:[],header:[{label:"ID",prop:"pannelGroupId"},{label:"名称",minWidth:"180","show-overflow-tooltip":!0,render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.handleRead(i)}}},i.pannelGroupRemark)}},{label:"布局",width:"150",prop:"fullLayoutName"},{label:"业务分类",prop:"categoryName"},{label:"内容源",prop:"pannelResource",formatter:function(t){return e.$consts.sourceText[t.pannelList[0].pannelResource]}},{label:"引用状态",prop:"fullTabName","show-overflow-tooltip":!0},{label:"版本/状态",prop:"pannelStatus",width:"130",formatter:function(t){var a=t.pannelStatus,i=t.currentVersion;return i+"/"+e.$consts.statusText[a]}},{label:"更新时间",prop:"lastUpdateDate",width:"140","show-overflow-tooltip":!0},{label:"审核人",prop:"auditor",width:"100"},{label:"更新人",width:"100",prop:"userName"}],selected:[],selectionType:"multiple"},selected:[]}},methods:{genDefaultFilter:function(){return{keyword:"pannel",subCategoryArray:"3",idPrefix:"10"}},fetchData:function(){var e=this,t=this.parseFilter();this.$service.desktopGetDataSyncList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.pannelId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){console.log(this.dataList),this.dataList?(this.filter=Object.assign({},this.dataList.filter),console.log(this.filter)):this.filter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()}},created:function(){this.fetchData()}},d_=u_,p_=Object(Bn["a"])(d_,s_,c_,!1,null,"cb2b2606",null),h_=p_.exports,m_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:"待处理版面"},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("ContentWrapper",{attrs:{pagination:e.pagination},on:{"filter-change":e.fetchData}},[a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},f_=[],g_={extends:Po,components:{ContentWrapper:Dn["ContentWrapper"],Table:Dn["Table"],ButtonGroupForListPage:Ro,InputPositiveInt:Hw},data:function(){var e=this;return{resourceType:"tabInfo",selected:[],tabTypeOption:[{label:"信号源版面",value:"5"},{label:"第三方版面",value:"4"},{label:"专题版面",value:"2"},{label:"普通版面",value:"1"}],tabStatusOption:[{label:"下架",value:"0"},{label:"上架",value:"1"},{label:"草稿",value:"2"},{label:"待审核",value:"3"},{label:"审核通过",value:"4"},{label:"审核不通过",value:"5"}],businessType:[],filter:this.genDefaultFilter(),efficientFilter:this.genDefaultFilter(),appIdType:[],filterSchema:null,pagination:{currentPage:1,pageSize:20},table:{props:{},data:[],header:[{label:"ID",prop:"tabId"},{label:"名称",prop:"tabName","show-overflow-tooltip":!0,render:function(t,a){var i=a.row;return t("el-button",{attrs:{type:"text"},on:{click:function(){e.handleRead(i)}}},i.tabName)}},{label:"版面属性",prop:"tabType",formatter:function(e){var t=e.tabType;return{1:"普通版面",2:"专题版面",4:"第三方版面",5:"信号源版面"}[t+""]||"未知版面"}},{label:"业务分类",prop:"businessCategoryName"},{label:"内容源",prop:"tabResource",formatter:function(e){var t=e.tabResource;return{o_tencent:"腾讯",o_iqiyi:"爱奇艺",o_voole:"优朋"}[t+""]||""}},{label:"AppId",prop:"tabAppid",formatter:function(t){return e.appIdType.map(function(e){if(t.tabAppid.toString()===e.dictEnName)return e.dictCnName})}},{label:"版本/状态",prop:"tabStatus",formatter:function(t){var a=t.tabStatus,i=t.currentVersion;return i+"/"+e.tabStatusOption.map(function(e){if(a.toString()===e.value)return e.label}).join("")}},{label:"更新时间",prop:"lastUpdateDate",width:140},{label:"审核人",prop:"auditor",width:100},{label:"更新人",prop:"modifierName",width:100}],selected:[],selectionType:"multiple"}}},methods:{genDefaultFilter:function(){return{idPrefix:"10",keyword:"tab",subCategoryArray:"1,2"}},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();if(t.tabId&&!/^\d+$/.test(t.tabId))return this.$message({type:"error",message:"ID 必须为正整数"});this.$service.desktopGetDataSyncList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.pagination,t=JSON.parse(JSON.stringify(this.efficientFilter));return e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(){this.pagination.currentPage=1,this.efficientFilter=JSON.parse(JSON.stringify(this.filter)),this.fetchData()},handleFilterReset:function(){this.filter=this.genDefaultFilter(),this.efficientFilter=this.genDefaultFilter(),this.pagination.currentPage=1,this.fetchData()},addTabInfo:function(){this.$emit("create")},editData:function(){var e=this.table,t=this.table.selected,a=e.data[t[0]];this.$emit("edit",a)},getBusinessType:function(){var e=this;this.$service.getDictType({type:"businessType"}).then(function(t){e.businessType=t})},handleToggleCollect:function(e){var t=this;e.collected?this.$service.collectCancel({type:"tab",data:{resourceId:e.tabId}},"取消收藏成功").then(function(){t.$set(e,"collected",!1)}):this.$service.collect({type:"tab",data:{resourceId:e.tabId}},"收藏成功").then(function(){t.$set(e,"collected",!0)})}},created:function(){var e=this;this.$service.getDictType({type:"appIdType"}).then(function(t){e.appIdType=t,e.fetchData()}),this.getBusinessType()}},b_=g_,v_=(a("b599"),Object(Bn["a"])(b_,m_,f_,!1,null,"8d4cf3c4",null)),y_=v_.exports,w_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:"待处理影片详情页"},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("ContentWrapper",{attrs:{pagination:e.pagination},on:{"filter-change":e.fetchData}},[a("div",{staticClass:"el-row"}),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},I_=[],C_={extends:Po,components:{ContentWrapper:Dn["ContentWrapper"],ButtonGroupForListPage:Ro,Table:Dn["Table"],InputPositiveInt:Hw},data:function(){var e=this;return{resourceType:"film",pannelValue:[],filter:this.genDefaultFilter(),efficientFilter:this.genDefaultFilter(),pagination:{currentPage:1,pageSize:20},tabStatusOption:[{label:"下架",value:"0"},{label:"上架",value:"1"},{label:"草稿",value:"2"},{label:"待审核",value:"3"},{label:"审核通过",value:"4"},{label:"审核不通过",value:"5"}],productOptions:[],channelOptions:[],table:{props:{},data:[],header:[{prop:"tabId",label:"ID",sortable:!0},{prop:"tabName",label:"版面名称",minWidth:180,"show-overflow-tooltip":!0,render:function(t,a){var i=a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handleRead(i)}}},i.tabName)}},{prop:"filmDetailPageInfo.priority",label:"优先级",sortable:!0},{prop:"tabCategory",label:"业务分类",sortable:!0,formatter:function(e){return 0==e.tabCategory||67==e.tabCategory?"影视":1==e.tabCategory?"教育":""}},{prop:"filmDetailPageInfo.source",label:"内容源",sortable:!0,formatter:function(e){if(0!==e.tabCategory&&67!==e.tabCategory)return"";switch(e.filmDetailPageInfo.source){case"qq":return"腾讯";case"iqiyi":return"爱奇艺";case"youku":return"优酷"}}},{prop:"tabStatus",label:"版本/状态",sortable:!0,formatter:function(e){return e.currentVersion+"/"+["下架","上架","草稿","待审核","审核通过","审核不通过"][e.tabStatus]}},{prop:"duplicateVersion",label:"待审核副本",sortable:!0,render:function(t,a){var i=a.row;return t("el-button",{props:{type:"text"},on:{click:function(){e.handleRead(i,i.duplicateVersion)}}},i.duplicateVersion)}},{prop:"lastUpdateDate",label:"更新时间",sortable:!0,width:140},{prop:"modifierName",label:"更新人",sortable:!0},{prop:"auditor",label:"审核人",sortable:!0}],selected:[],selectionType:"multiple"},selected:[],filterFormRules:{tabId:[{validator:function(e,t,a){if(t&&!/^\d+$/.test(t))return a("请输入数字");a()}}]}}},methods:{genDefaultFilter:function(){return{keyword:"tab",subCategoryArray:3}},fetchData:function(){var e=this;this.handleAllRowSelectionRemove();var t=this.parseFilter();this.$service.desktopGetDataSyncList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows,e.table.selected=[],e.selected=[]})},parseFilter:function(){var e=this.pagination,t=JSON.parse(JSON.stringify(this.efficientFilter));return e&&(t.page=e.currentPage,t.rows=e.pageSize),t},handleFilterChange:function(){var e=this;this.$refs.filterForm.validate(function(t){t&&(e.pagination.currentPage=1,e.efficientFilter=Object(Ln["cloneDeep"])(e.filter),e.fetchData())})},handleFilterReset:function(){this.filter=this.genDefaultFilter(),this.efficientFilter=this.genDefaultFilter(),this.pannelValue=[],this.pagination.currentPage=1,this.fetchData()},getMediaResourceInfo:function(){var e=this;return this.$service.getMediaResourceInfo().then(function(t){var a=JSON.parse(decodeURI(t.slice(5,-1))),i=a.videoItemModels,n=i.reduce(function(e,t){return e.push(t.productList),e},[]),o=[].concat.apply([],n);e.productOptions=o;var r={label:"爱奇艺",value:"iqiyi",children:[]};r.children=i[0].categoryList.reduce(function(e,t){return e.concat({label:t.category_name,value:t.cc_category_id})},[]);var l={label:"腾讯",value:"qq",children:[]};l.children=i[1].categoryList.reduce(function(e,t){return e.concat({label:t.category_name,value:t.cc_category_id})},[]);var s={label:"优酷",value:"youku",children:[]};s.children=i[2].categoryList.reduce(function(e,t){return e.concat({label:t.category_name,value:t.cc_category_id})},[]),e.channelOptions.push(r),e.channelOptions.push(l),e.channelOptions.push(s)})},handleChannelChange:function(e){this.filter["filmDetailPageInfo.source"]="",this.filter["filmDetailPageInfo.source"]=e[0]}},created:function(){this.getMediaResourceInfo().then(function(){}),this.fetchData()}},T_=C_,S_=(a("025b"),Object(Bn["a"])(T_,w_,I_,!1,null,"6e664eda",null)),k_=S_.exports,__={components:{ContentCard:Hn,PanelList:l_,AlbumList:h_,TabList:y_,FilmPageList:k_,PanelInfo:Jp,TabInfo:Ov,FilmPage:aI,PageWrapper:Mu,PageContentWrapper:qu},data:function(){return{activePage:"desktop",draftNum:null,movieNum:null,auditNum:null,submitNum:null,mode:void 0,title:void 0,id:void 0,version:void 0,isAutoSync:void 0,dataSyncGeneral:null,panelPreview:{id:void 0,version:void 0,dataType:void 0},tabPreview:{id:void 0,version:void 0},filmPreview:{id:void 0,version:void 0}}},watch:{isAutoSync:"handleAutoSyncChange"},methods:{handleViewDataList:function(e){this.activePage=e},handleSetAutoSync:function(e){var t=this,a=e?"开启同步后，酷开数据将会自动更新至该平台，确认开启？":"关闭同步后，您需要进行手动确认才可同步酷开数据，确认关闭？";this.$confirm(a,"提示").then(function(){t.$service.desktopUpdateDataSyncInfo({enableManualOn:e}).then(function(){t.isAutoSync=e})}).catch(function(e){console.log(e)})},handleAutoSyncChange:function(){this.isAutoSync||this.getDataSyncGeneral()},handleReadPanel:function(e){this.panelPreview={id:e.pannelGroupId,version:e.currentVersion,dataType:e.pannelType},this.activePage="panel-read"},handleReadTab:function(e){this.tabPreview={id:e.tabId,version:e.currentVersion},this.activePage="tab-read"},handleReadFilm:function(e){this.filmPreview={id:e.tabId,version:e.currentVersion},this.activePage="film-read"},goTo:function(e){return this.$router.push({name:e})},goBack:function(e){this.activePage=e||"desktop"},getDataSyncGeneral:function(){var e=this;this.$service.desktopGetDataSyncGeneral().then(function(t){e.dataSyncGeneral=t})}},created:function(){var e=this;this.$service.getTotal("myDrafts").then(function(t){e.draftNum=t}),this.$service.getTotal("mySubmittedTasks").then(function(t){e.submitNum=t}),this.$service.getTotal("myAuditTasks").then(function(t){e.auditNum=t}),this.$service.getTotal("msn").then(function(t){e.movieNum=t}),this.$service.desktopGetDataSyncInfo().then(function(t){e.isAutoSync=t.isOn})}},P_=__,x_=(a("3e6d"),Object(Bn["a"])(P_,e_,t_,!1,null,"70a05b8b",null)),D_=x_.exports,F_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("iframe",{staticClass:"frame-page",attrs:{src:e.src}})},$_=[],L_={computed:{src:function(){var e=this.$route.query.url;return/^http/.test(e)?e:"".concat(location.protocol,"//").concat(e)}}},R_=L_,N_=(a("600f"),Object(Bn["a"])(R_,F_,$_,!1,null,"ca95b364",null)),E_=N_.exports,O_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{staticClass:"content"},[a("ContentWrapper",{attrs:{pagination:e.pagination},on:{"filter-change":e.handleFilterChange,"filter-reset":e.handleFilterReset}},[a("div",{staticStyle:{margin:"10px 0"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleCreate}},[e._v("新建")]),a("el-button",{attrs:{type:"success"},on:{click:e.handleEdit}},[e._v("编辑")]),a("el-button",{attrs:{type:"danger"},on:{click:e.handleDelete}},[e._v("删除")])],1),a("Table",{attrs:{props:e.table.props,header:e.table.header,data:e.table.data,selected:e.table.selected,"selection-type":e.table.selectionType,"select-on-row-click":!0},on:{"row-selection-add":e.handleRowSelectionAdd,"row-selection-remove":e.handleRowSelectionRemove,"all-row-selection-change":e.handleAllRowSelectionChange}})],1)],1)},A_=[],V_={extends:Po,components:{Table:Dn["Table"],ContentWrapper:Dn["ContentWrapper"],ButtonGroupForListPage:Ro},data:function(){return{resourceType:"crowdRel",filter:{},filterSchema:null,pagination:{currentPage:1,pageSize:20},selected:[],table:{props:{},header:[{label:"策略ID",prop:"policyId"},{label:"策略名",prop:"policyName"}],data:[],selected:[],selectionType:"multiple"}}},methods:{fetchData:function(){var e=this,t=this.parseFilter();this.$service.crowdRelList(t).then(function(t){e.pagination.total=t.total,e.table.data=t.rows})},parseFilter:function(){var e=this.filter,t=this.pagination;return t&&(e.page=t.currentPage,e.rows=t.pageSize),e},handleFilterChange:function(e,t){t&&(this.filter=t),this.$validateId(this.filter.pannelId)&&("query"===e&&this.pagination&&(this.pagination.currentPage=1),this.fetchData())},handleFilterReset:function(){this.filter={},this.pagination.currentPage=1,this.fetchData()}},created:function(){this.fetchData()}},M_=V_,B_=(a("a6f8"),Object(Bn["a"])(M_,O_,A_,!1,null,"465cc483",null)),U_=B_.exports,j_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentCard",{attrs:{title:"人群关系管理"},on:{"go-back":function(t){return e.$emit("go-back")}}},[a("div",{staticClass:"dmp-relationship"},[a("div",{staticClass:"actions"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("保存")])],1),a("el-form",{attrs:{"label-width":"120px"}},[a("el-form-item",{attrs:{label:"人群策略"}},[a("el-select",{staticClass:"dmp-relationship__policy",attrs:{disabled:!!e.id,placeholder:"请选择"},model:{value:e.rel.policyId,callback:function(t){e.$set(e.rel,"policyId",t)},expression:"rel.policyId"}},e._l(e.policyOptions,function(e){return a("el-option",{key:e.value,attrs:{disabled:!!e.disable,label:e.label,value:e.value}})}),1),a("el-button",{attrs:{type:"primary",disabled:!e.rel.policyId,loading:e.isRefreshing},on:{click:e.handleRefreshCrowd}},[e._v(e._s(e.isRefreshing?"刷新中":"刷新人群列表"))])],1),a("el-form-item",{attrs:{label:"人群关系图"}},[a("cc-level",{directives:[{name:"show",rawName:"v-show",value:e.rel.policyId,expression:"rel.policyId"}],attrs:{levels:e.rel.levels,items:e.rel.items,"max-depth":8},on:{"level-label-change":e.handleChangeLevelLabel,"level-add":e.handleAddLevel,"level-remove":e.handleRemoveLevel,"item-remove":e.handleRemoveItem,"item-activate":e.handleActivateItem},scopedSlots:e._u([{key:"item-add",fn:function(t){return[a("div",{staticClass:"crowd-add-wrapper"},[a("el-autocomplete",{attrs:{disabled:t.levelIndex>0&&void 0===e.rel.levels[t.levelIndex-1].activeValue,value:e.itemToAdd[t.levelIndex],placeholder:"人群ID，人群名称","custom-item":"crowd-search-item","trigger-on-focus":!1,"fetch-suggestions":e.handleSearchCrowd},on:{input:function(a){return e.$set(e.itemToAdd,t.levelIndex,a)},select:function(a){return e.handleAddCrowdFromInput(a,t.levelIndex)}},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.item;return a("span",{attrs:{title:i.label}},[e._v("\n                  "+e._s(i.label)+"\n                ")])}}],null,!0)}),a("el-button",{attrs:{disabled:t.levelIndex>0&&void 0===e.rel.levels[t.levelIndex-1].activeValue},on:{click:function(a){return e.handleAddItem(t.levelIndex)}}},[e._v("添加")])],1)]}}])})],1)],1),e.showCrowdSelector?a("cc-tag-selector",{attrs:{tags:e.availableCrowdOptions,disables:e.disabledCrowdIds},on:{"select-end":e.handleSelectCrowdEnd,"select-cancel":function(t){e.showCrowdSelector=!1}}}):e._e()],1)])},G_=[],W_=(a("386d"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"cc-level"},[e._l(e.levels,function(t,i){return[i>0?a("div",{staticClass:"cc-level-buttons"},[a("i",{staticClass:"el-icon-arrow-right"})]):e._e(),a("div",{staticClass:"cc-level-wrapper"},[a("div",{staticClass:"cc-level-title"},[a("el-input",{attrs:{value:t.label},on:{input:function(t){return e.$emit("level-label-change",t,i)}}})],1),e._t("item-add",[a("div",{staticClass:"cc-level-add"},[a("el-input",{model:{value:e.itemToAdd[i],callback:function(t){e.$set(e.itemToAdd,i,t)},expression:"itemToAdd[levelIndex]"}}),a("el-button",{on:{click:function(t){return e.handleAddItem(i)}}},[e._v("添加")])],1)],{levelIndex:i}),a("div",{staticClass:"cc-level-item-list"},[e._l(e.items,function(n,o){return[n.parentValue===t.parentValue&&n.level===i?a("div",{key:n.value,class:["cc-level-item",n.value===t.activeValue?"active":""],on:{click:function(t){return e.$emit("item-activate",n,i)}}},[a("span",{attrs:{title:n.label}},[e._v(e._s(n.label))]),a("i",{staticClass:"cc-level-item-remove el-icon-circle-close",attrs:{title:"删除"},on:{click:function(t){return e.$emit("item-remove",n)}}})]):e._e()]})],2),a("i",{staticClass:"cc-level-level-remove el-icon-circle-close",attrs:{title:"删除"},on:{click:function(t){return e.$emit("level-remove",i)}}})],2)]}),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.maxDepth||e.levels.length<e.maxDepth,expression:"maxDepth ? levels.length < maxDepth : true"}],staticClass:"cc-level__add-level",attrs:{type:"primary"},on:{click:function(t){return e.$emit("level-add")}}},[e._v("添加下一级")])],2)}),q_=[],H_={data:function(){return{itemToAdd:{}}},props:["levels","items","maxDepth"],methods:{handleAddItem:function(e){this.$emit("item-add",this.itemToAdd[e])}}},z_=H_,J_=(a("e749"),Object(Bn["a"])(z_,W_,q_,!1,null,"4c82ad34",null)),K_=J_.exports,Q_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"选择人群",visible:!0,"before-close":e.handleClose}},[a("div",{staticClass:"name-list"},[a("div",[a("el-input",{attrs:{placeholder:"搜素人群ID， 人群名称"},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),e._l(e.availableTags,function(t){return a("el-checkbox",{key:t.value,staticClass:"name-list__item",attrs:{title:t.label,disabled:!(!t.disabled&&!e.disablesIndexed[t.value])},model:{value:e.selectMap[t.value],callback:function(a){e.$set(e.selectMap,t.value,a)},expression:"selectMap[item.value]"}},[e._v("\n      "+e._s(t.label)+"\n    ")])})],2),a("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSelectEnd}},[e._v("添加")])],1)])},X_=[],Y_=a("ffe7"),Z_=a.n(Y_),eP={props:{tags:{type:Array},selected:{type:Array},disables:{type:Array}},data:function(){return{keyword:void 0,selectedIndexed:{},disablesIndexed:{},selectMap:{}}},computed:{availableTags:function(){var e=this.keyword;if(e){var t=new Z_.a(this.tags,{keys:["label","value"]});return t.search(e)}return this.tags}},watch:{selected:"updateSelectedIndex",disables:"updateDisablesIndex"},methods:{handleSelectEnd:function(){var e=this.selectMap,t=this.tags.reduce(function(t,a){return e[a.value]&&t.push(a),t},[]);this.$emit("select-end",t)},updateSelectedIndex:function(){this.buildIndex("selected","selectedIndexed")},updateDisablesIndex:function(){this.buildIndex("disables","disablesIndexed")},buildIndex:function(e,t){this[t]=(this[e]||[]).reduce(function(e,t){return e[t]=!0,e},{})},handleClose:function(){this.$emit("select-cancel")}},created:function(){this.buildIndex("selected","selectedIndexed"),this.buildIndex("disables","disablesIndexed");var e={},t=this.selectedIndexed;this.tags.forEach(function(a){e[a.value]=!!t[a.value]}),this.selectMap=e}},tP=eP,aP=(a("7e85"),Object(Bn["a"])(tP,Q_,X_,!1,null,"0743d295",null)),iP=aP.exports,nP={components:{"cc-level":K_,"cc-tag-selector":iP},data:function(){return{isRefreshing:!1,showCrowdSelector:!1,crowdKeyword:"",rel:{policyId:void 0,levels:this.getDefaultLevels(),items:[]},policyOptions:[],availableCrowdOptions:[],crowdOptions:[],disabledCrowdIds:[],selectedLevelIndex:void 0,itemToAdd:{}}},props:["id","mode"],watch:{"rel.policyId":"handlePolicyIdChange"},methods:{getDefaultLevels:function(){return[{level:0,label:"一级",parentValue:void 0,activeValue:void 0},{level:1,label:"二级",parentValue:void 0,activeValue:void 0},{level:2,label:"三级",parentValue:void 0,activeValue:void 0}]},handleAddCrowdFromInput:function(e,t){void 0!==e.value&&this.addCrowdToLevel(e,t),this.itemToAdd[t]=""},handleSearchCrowd:function(e,t){var a=[];if(e){var i=this.rel.items.reduce(function(e,t){return e[t.value]=t,e},{}),n=this.crowdOptions.filter(function(e){return void 0===i[e.value]}),o=new Z_.a(n,{keys:["label","value"]});a=o.search(e)}0===a.length&&a.push({label:"没有相关结果..."}),t(a)},handleAddLevel:function(){var e=this.rel.levels;e.push({id:void 0,label:["一","二","三","四","五","六","七","八","九","十"][e.length]+"级",selected:{}})},handleChangeLevelLabel:function(e,t){this.rel.levels[t].label=e},handleRemoveLevel:function(e){var t=this.rel.levels[e];this.$confirm("是否确认删除整个 "+t.label+"  层级, 删除后所有后面的层级也会被删除","提示").then(function(){var t=this.rel.items.filter(function(t){return t.level===e});t.forEach(this.doRemoveItem),this.rel.levels=this.rel.levels.slice(0,e)}.bind(this)).catch(function(){})},handleAddItem:function(e){this.showCrowdSelector=!0,this.selectedLevelIndex=e;var t={};this.rel.items.forEach(function(e){t[e.value]=!0}),this.availableCrowdOptions=this.crowdOptions.filter(function(e){return!t[e.value]})},handleActivateItem:function(e,t){var a=!this.rel.items.find(function(t){return t.value===e.value});if(!a){this.rel.levels.slice(t+1).forEach(function(e){e.parentValue=void 0,e.activeValue=void 0});var i=this.rel.levels[t+1];i&&(i.parentValue=e.value),this.rel.levels[t].activeValue=e.value}},doRemoveItem:function(e){var t=this.rel.items,a={},i=this.rel.levels.reduce(function(e,t){return t.activeValue&&(e[t.activeValue]=t),e},{}),n=function e(n){0,a[n]=!0,t.forEach(function(t){t.parentValue===n&&e(t.value)}),i[n]&&(i[n].activeValue=void 0)};n(e.value),this.rel.items=t.filter(function(e){return!a[e.value]})},handleRemoveItem:function(e){var t=this.rel.items.some(function(t){return t.parentValue===e.value}),a=this.doRemoveItem.bind(this);t?this.$confirm("是否确认删除 "+e.label+" 分组, 删除后将同时删除它下面的标签","提示").then(function(){a(e)}).catch(function(){}):a(e)},handlePolicyIdChange:function(e){this.clearDmpRel(),this.$service.crowdRelGet({id:e}).then(function(e){e.hasCascadeTag&&(this.setDmpRel(e),this.id||this.$message("该策略下已经创建了人群关系"))}.bind(this)),this.$service.getCrowdOfPolicy({id:e}).then(function(e){this.crowdOptions=e}.bind(this))},handleSelectCrowdEnd:function(e){var t=this.selectedLevelIndex;e&&e.forEach(function(e){this.addCrowdToLevel(e,t)}.bind(this)),this.showCrowdSelector=!1},addCrowdToLevel:function(e,t){var a=this.rel.levels[t],i={parentValue:a.parentValue,label:e.label,value:e.value,level:t};this.rel.items.push(i)},handleSubmit:function(){this.validate(this.rel,function(e){e?this.$message({type:"error",message:e}):this.$service.crowdRelUpsert(this.parseDataToApi(this.rel),"保存成功").then(function(){this.$emit("upsert-end")}.bind(this))}.bind(this))},validate:function(e,t){for(var a=e.levels,i=0,n=a.length;i<n;i++)if(""==a[i].label)return t("请填写第"+(i+1)+"个层级的标题");t()},parseDataToApi:function(e){e=JSON.parse(JSON.stringify(e));var t={policyId:e.policyId,crowdRelationship:{}};return t.crowdRelationship.levels=e.levels.map(function(e){return{label:e.label}}),t.crowdRelationship.items=e.items,t},parseApiToData:function(e){e=JSON.parse(JSON.stringify(e));var t=e.crowdRelationship;return e.levels=t.levels.map(function(e,t){return{level:t,label:e.label,parentValue:void 0,activeValue:void 0}}),e.items=t.items.map(function(e){return{label:e.label,value:+e.value,parentValue:e.parentValue?+e.parentValue:void 0,level:e.level}}),e.crowdRelationship=void 0,e},setDmpRel:function(e){var t={};e=this.parseApiToData(e),t.policyId=e.policyId,t.levels=e.levels,t.items=e.items,this.rel=t,console.log(this.rel)},clearDmpRel:function(){this.rel.levels=this.getDefaultLevels(),this.rel.items=[]},getPolicyOptions:function(){return this.$service.getCrowdPolicy().then(function(e){this.policyOptions=e}.bind(this))},handleRefreshCrowd:function(){this.isRefreshing=!0,this.$service.crowdRefresh().then(function(){this.$service.getCrowdOfPolicy({id:this.rel.policyId}).then(function(e){this.crowdOptions=e;var t=e.reduce(function(e,t){return e[t.value]=t,e},{});this.rel.items.forEach(function(e){var a=t[e.value];a&&this.$set(e,"label",a.label)}.bind(this)),this.isRefreshing=!1,this.$message("刷新成功")}.bind(this))}.bind(this)).catch(function(){this.isRefreshing=!1,this.$message("刷新失败")})}},created:function(){this.getPolicyOptions(),this.id&&this.$service.crowdRelGet({id:this.id}).then(function(e){this.setDmpRel(e)}.bind(this))}},oP=nP,rP=(a("4207"),Object(Bn["a"])(oP,j_,G_,!1,null,"5637eb52",null)),lP=rP.exports,sP={extends:hc,components:{ResourceList:U_,ResourceContent:lP},data:function(){return{}},computed:{resourceInfo:function(){return{type:"crowdRel",idField:"policyId"}}},methods:{handleDelete:function(e){var t=this,a=this.resourceInfo,i="id";this.$service.deleteResource({type:a.type,id:e.map(function(e){return e[i]}).join(",")},"删除成功").then(function(){t.$refs.list.fetchData()})}}},cP=sP,uP=Object(Bn["a"])(cP,_b,Pb,!1,null,null,null),dP=uP.exports,pP=[{path:"commonResource",name:"commonResource",component:Io,meta:{title:"常用文件",icon:"el-icon-cc-file"},children:[{name:"commonTopPannelUser",path:"/commonResourceUser/TopPannel/view.html",component:void 0,meta:{title:"常用排行榜",tagId:"commonTopPannelUser"}},{name:"commonPannelUser",path:"/commonResourceUser/Pannel/view.html",component:Fg,meta:{title:"常用常规运营版块",tagId:"commonPannelUser"}},{name:"commonAlbumPanneleUser",path:"/commonResourceUser/AlbumPannel/view.html",component:vg,meta:{title:"常用业务专辑",tagId:"commonAlbumPanneleUser"}}]},{path:"homePageManage",name:"homePageManage",component:Io,meta:{title:"首页方案管理",icon:"el-icon-cc-toufangfangan"},children:[{name:"homepageInfo",path:"/homepageInfo/view.html",component:Oy,meta:{title:"首页方案",tagId:"homepageInfo"}},{name:"policyConf",path:"/policyConf/view.html",component:Jy,meta:{title:"策略管理",tagId:"policyConf"}},{name:"testPolicyConf",path:"/testPolicyConf/view.html",component:pw,meta:{title:"测试策略",tagId:"testPolicyConf"}}]},{path:"panelManage",name:"panelManage",component:Io,meta:{title:"版面管理",icon:"el-icon-cc-banmianguanli-"},children:[{name:"tabInfo",path:"/tabInfo/view.html",component:vI,meta:{title:"TAB版面管理",tagId:"tabInfo"}},{name:"businessTab",path:"/businessTab/view.html",component:Ow,meta:{title:"业务版面",tagId:"businessTab"}},{name:"filmDetailPage",path:"/filmDetailPage/view.html",component:rI,meta:{title:"影片详情页",tagId:"filmDetailPage"}}]},{path:"blockManage",name:"blockManage",component:Io,meta:{title:"版块管理",icon:"el-icon-cc-bankuaiguanli"},children:[{name:"pannelInfo",path:"/pannelInfo/view.html",component:Nh,meta:{title:"常规运营",tagId:"pannelInfo"}},{name:"markPanel",path:"/markPanel/view.html",component:Ih,meta:{title:"功能版块",tagId:"markPanel"}},{name:"albumPannelInfo",path:"/albumPannelInfo/view.html",component:oh,meta:{title:"业务专辑",tagId:"albumPannelInfo"}},{name:"privatePannelInfo",path:"/privatePannelInfo/view.html",component:Yh,meta:{title:"专属影院",tagId:"privatePannelInfo"}},{name:"intelliReccomendPannel",path:"/intelliReccomendPannel/view.html",component:void 0,meta:{title:"智能化推荐",tagId:"intelliReccomendPannel"}}]},{path:"rotateStation",name:"rotateStation",component:Io,meta:{title:"轮播管理"},children:[{path:"frame-page",name:"rotateStationCategory",component:E_,meta:{tagId:"rotateStationCategory"}},{path:"frame-page",name:"rotateStationCategory_viewStation",component:E_,meta:{tagId:"rotateStationCategory_viewStation"}},{path:"frame-page",name:"rotateTopicInfo",component:E_,meta:{tagId:"rotateTopicInfo"}}]},{path:"commonModule",name:"commonModule",component:Io,meta:{title:"公共模块"},children:[{name:"layoutInfo",path:"/layoutInfo/view.html",component:pg,meta:{title:"布局管理",tagId:"layoutInfo"}},{name:"globalPicture",path:"/globalPicture/view.html",component:Of,meta:{title:"素材管理",tagId:"GlobalPicture"}},{name:"globalCornerIcon",path:"/globalCornerIcon/view.html",component:Zm,meta:{title:"角标素材管理",tagId:"globalCornerIcon"}},{name:"globalCornerIconType",path:"/globalCornerIconType/view.html",component:vf,meta:{title:"角标分类管理",tagId:"globalCornerIconType"}},{name:"commonOnclickInfo",path:"/commonOnclickInfo/view.html",component:gm,meta:{title:"点击事件管理",tagId:"commonOnclickInfo"}}]},{path:"resourceMgr",name:"resourceMgr",component:Io,meta:{title:"资源管理",icon:"el-icon-cc-huaban"},children:[{name:"videoContent",path:"/videoContent/view.html",component:SI,meta:{title:"影片资源库",tagId:"videoContent"}},{name:"videoDataList",path:"/videoDataList/view.html",component:void 0,meta:{title:"数据列表",tagId:"videoDataList"}}]},{path:"blockInfo",name:"blockInfo",component:Io,meta:{title:"推荐位管理",icon:"el-icon-cc-ziyuanguanli"},children:[{name:"broadcastBlock",path:"/broadcastBlock/view.html",component:lc,meta:{title:"轮播推荐位",tagId:"BroadcastBlock"}},{name:"sysPlugin",path:"/sysPlugin/view.html",component:Du,meta:{title:"系统插件(状态栏)",tagId:"SysPlugin"}},{name:"multiFunctionBlock",path:"/multiFunctionBlock/view.html",component:uu,meta:{title:"多功能推荐位",tagId:"multiFunctionBlock"}}]},{path:"videoOnDemand",name:"videoOnDemand",component:Io,meta:{title:"点播资源管理",icon:"el-icon-cc-huaban"},children:[]},{path:"themeManage",name:"themeManage",component:Io,meta:{title:"主题管理",icon:"el-icon-cc-zhuti"},children:[{name:"themeInfo",path:"/themeInfo/view.html",component:HT,meta:{title:"主题皮肤管理",tagId:"themeInfo"}}]},{path:"dirCrowdManager",name:"dirCrowdManager",component:Io,meta:{title:"定向人群管理",icon:"el-icon-cc-institute"},children:[{name:"actDmpGroupInfo",path:"/actDmpGroupInfo/view.html",component:Zg,meta:{title:"RPC人群列表",tagId:"actDmpGroupInfo"}},{name:"dmpMgr",path:"/dmpMgr",component:dP,meta:{tagId:"dmpMgr"}}]},{path:"sysConfig",name:"sysConfig",component:Io,meta:{title:"系统设置",icon:"el-icon-cc-renyuanguanli"},children:[{name:"sysMenu",path:"/sysMenu/view.html",component:nT,meta:{title:"系统菜单",tagId:"sysMenu"}},{name:"userConfig",path:"/sysUser/view.html",component:CT,meta:{title:"用户管理",tagId:"userConfig"}},{name:"baDept",path:"/sysDept/view.html",component:uC,meta:{title:"部门管理",tagId:"baDept"}},{name:"sysLogLogin",path:"/sysLogLogin/view.html",component:NC,meta:{title:"登录日志",tagId:"sysLogLogin"}},{name:"sysLogOp",path:"/sysLogOp/view.html",component:BC,meta:{title:"操作日志",tagId:"sysLogOp"}},{name:"roleConfig",path:"/sysRole/view.html",component:xC,meta:{title:"角色管理",tagId:"roleConfig"}}]},{path:"adBitMgr",name:"adBitMgr",component:Io,meta:{title:"广告位管理",icon:"el-icon-cc-banner"},children:[{name:"filmDetailAdBit",path:"/filmDetailAdBit/view.html",component:Bk,meta:{title:"详情页广告位",tagId:"filmDetailAdBit"}}]},{path:"todoTask",name:"todoTask",component:Io,meta:{title:"待处理任务",icon:"el-icon-cc-daichuli2"},children:[{name:"myDrafts",path:"/myDrafts/view.html",component:YS,meta:{title:"我的草稿",tagId:"myDrafts"}},{name:"mySubmitTasks",path:"/mySubmitTasks/view.html",component:Nk,meta:{title:"我提交的任务",tagId:"mySubmitTasks"}},{name:"myReviewTasks",path:"/myReviewTasks/view.html",component:Ck,meta:{title:"我的审核任务",tagId:"myReviewTasks"}},{name:"msn",path:"/v1/msn/view.html",component:YT,meta:{title:"下架影片通知",tagId:"msn"}}]},{name:"desktop",path:"desktop",component:D_,meta:{title:"我的桌面",tagId:"desktop"}}],hP=[{path:"/",component:Zk,children:pP},{name:"login",path:"/login",component:fo,meta:{title:"登录"}}],mP=hP;function fP(e,t,a){var i=this.app;i.$isLoggedIn().then(function(){a("login"!==e.name?0===e.matched.length&&i.$router.getMatchedComponents(e.fullPath).length>0?{path:e.fullPath}:void 0:{name:"/"})}).catch(function(t){a("login"===e.name?void 0:{name:"login",query:{redirect:e.fullPath}})})}function gP(e){var t=this.app,a=e.matched.slice(1).map(function(e){e.name;var t=e.meta;return{name:t.title,to:void 0}});t.$nextTick(function(){t.$bus.$emit("breadcrumb-change",a)})}O["default"].use(Zn["a"]);var bP=new Zn["a"]({routes:mP});bP.beforeEach(fP.bind(bP)),bP.afterEach(gP.bind(bP));var vP=bP;a("86d7");O["default"].config.productionTip=!1,new O["default"]({router:vP,render:function(e){return e(Yn)}}).$mount("#app")},"571c":function(e,t,a){},"580c":function(e,t,a){e.exports=a.p+"img/detail-ad-3.8a40a230.png"},"58c5":function(e,t,a){e.exports=a.p+"img/detail-ad-1-2.151fc6ac.png"},"5a1f":function(e,t,a){"use strict";var i=a("d92c"),n=a.n(i);n.a},"5a76":function(e,t,a){},"5d88":function(e,t,a){"use strict";var i=a("e433"),n=a.n(i);n.a},"5e4e":function(e,t,a){},"5f09":function(e,t,a){"use strict";var i=a("571c"),n=a.n(i);n.a},"5f98":function(e,t,a){"use strict";var i=a("7d94"),n=a.n(i);n.a},"600f":function(e,t,a){"use strict";var i=a("3fb4"),n=a.n(i);n.a},"606e":function(e,t,a){},6143:function(e,t,a){},6174:function(e,t,a){"use strict";var i=a("a095"),n=a.n(i);n.a},"64e3":function(e,t,a){},"65e8":function(e,t,a){},"66d9":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAI30lEQVR4XtWbeZBcVRXGf6dnJgScsKaCsimCyKJVQEQwxOk3wyYURbGYQA1CmNeEFApUISK4oBYoiCBggZKY6TfJmJhKWKpIgQgE8noIIAURFApQq4BICSIgywQImen+rNtJh0nS3W/p2bz/vu9859yv77v33XNOG6MwvG59QRm+COxv8Hng04jJMnYBdjQwF4ZgPfA3g+cQTwMrQp/VmGmkwiw7Hu7hzdNkmjldRgfCM2Pn1D7Em04IjHsGxF2P5Kw/NVcVw+ETQDIvoFOQA7JmZIYz0DKXeFfw65Jx08O+vTEc/MMiQDav4zGuNzhwOIKKwbFOImhq5uqHZtm/YuBrQhoSwL3bGHMxjmwkiNS2Yq3g+wWfW9LuE6kEOHyRtp+4nuuA2ZUNLPUkhsNQPFkqcXbfbHs+KV1iAdoCTcvAMmD3pM5GFC8GgQvDnM1N4ieRANlAFyFuHJENLknU9bE/DH37WVy62AJ4gb4D5WX//zBuCbu4KM6+EEuAbF6XmvGL/4eZV2IU9BR886NijhTAy+scjJ4oovH4XHBlwbcf14utrgBeoK9LLB3n73xd7UvGmX1d9vtaoJoCeN3aV8ZfzNhuPP66cWOSGMgYx6z0rVDNpqoAXo8mqsSfzTggrqNxjXP3iQyfC7vsnS3jrC5AoOuBS8b1pJIGJ+aGOTs/UgCvR/sjngWakvoYz3iBTHw5zNmTQ+PcagV4ea0as2/7EVZQ8MyUVg65baYVK642E6C9W0cpw4oRjmNM6QWdBd+WVBXAC/QYcMSYRpjQucSrZtxYEn/NiJ3J8FNgn1o0Ek8VcnboVgK0dastk6HqUZEwptGDi8X9g5y3eo59UHHq9WhHSjyBsW+ds/+Ilb497p5vegW8vBZhnDl60af3JFHC+F7Bt6qf516gbwC/q7kKYEnBt85NAhzbq0+sHyzn3iamD2uULMXaUobT+7rsD7U8Tu/VXs2DrKnzGgxYhu3DLltXXgHZHp1loneUptCIm5cxjg+77IV6JFPnabtJLbwf4eiY0LcVGwQItNigvCTG8SgMbsMpq860t6NibA+UFYT1cBJXFXL2o4oArxtMiSIeq+cSN0+ZxMVDz+9asXg9+ozEgwafjYg3DH1rt3JiM8MzYzW5un7FoIzzCr7Fuo63Bzpc4m6MyTHms469mWRtPerMiMUxDEYb8lYJTurz7dE4jtt6dKqJJQYT4uAdpggHWTavK824Io6RO37MmI/4N0azxAwz9otjmwgjni0ZJ/T59kocOy/QD6D8AZRoGJzsBHAJj5mRluKjktEx9BfZuNsuBU6MtI8PuKt/gM6hHze1TKfOU8ukZnoxzohPvxnyUvMCud0yG0UgcUkhZzdsidsowmpX+IziqLsrl2ujXBWVwqpwTF+snZrXsRxjelq/bnN1K8AlPg6JCq5lgJ1WzLF3q+EazR5JfJAxOlf6dlecyUxfqP2aitwbY6evTycWmJfXP+p9NzsGif8WcuZK2TWHyx8Ct8WZwFCM4BUrcUJ4rrkcROTw8nK/uNvpd4gERwAEd1o20BqDvaLIii3s9vBZ9lqECDcDF0RxVZ4LHm1u4qQHZ9lbcWza8jrboNuMljj4GJi73SvwXJzcn0RvIWez6pGWN6UW3JV6apRzl7e3vTkvbDdX0opYquXS+9UYl0dBkzwXLHGboEsRRQa8kfjC0Ldb6jnpWKjdS8VySm3HGrgixiVhl/0qTrDlBK1wn+qnxsEnwUjMdyvgPjOOjWNYvobC0YWcrayHb8vrWDP+uGXlWPB2Bk6plaLekvOo+dq12MQ9CX6gONPYhJG4zq0AV02dE9dS8F6xicNWzbK/17PJ9mgGJRYMqSs8Pgidq3x7MY6vrwY6MCMeMGO3OPg0GMEc83p0GeLnSQgkXipOZGrUzezoedqh2MLBxSL/7JttL8X10R7oOInbMVrj2qTBSXS4u8AJGZWXWbIhHukfpH31HBtIZlgfnc1rNjB3NMpx7mSzcjZogHfct32KiSwKfTsrhd1WJjOWqek//eXegwuHgy+KQ/Biwbd9yvkAL5Db1Lwoo2rPN/To2DVpbCs23jK1spbbgeMa4Ulo2x365lp8wMvrcoxUk3AVF4mT+3K2PGEAZbg7NotF7h/FDrNKmGeEvi3dIECPDkY8lWYCzkbwoRnTwi5z3Z2xR/sCTVWRezB2jW00PMD3t13LLvdeZB99nBYP5AQ4OC2/xGulCUyN+lyu8LsExsZEzKhnogW/LfhWPvo/FqBbZ5BhU8kopRBPf9TKtMdm2of17NMcvSnjqWpWKnFo37lWXvEf1wZ/ooy3J2sw9mjEmcTygs/J1RqU3F2htbl8mTm7ER+N2ErcX8jZps12s+LocHWCVVLOQwOd1qspEwa4o5EERiMTr9iW4MihWa3NBPjKMm07YW25XX3PRp0JbjW4U8a2iOmI882Y1Chvg/b3hb59bSjHVv0BrvHZjJplpwYDGEvz4iDst+VdpGqLTDbQHSNx/RzL2SNuCnN28ZYx1GqS+iQlXKpsRC8joyjIy/0DHFQt01y7TS7QiYLl46IbvAGl3N9wzDi81kda3UbJbF7fNuOXDfgfc1MZ3yp02W9qBRLZKpsNFBh0jflM0gVwbehb3TxipADumvpGP0sxTksXw5hZLQx9OyfKe6QAZQLJsgHXmnFpFOF4eO5yfYWcfTdOLPEE2Mjk8vIZIxjHTZRFiYsLOXP1iVgjkQCOsS1Qh4lFZnwqlofRAok1yjCj0GVPJHGZWABHfmRek1rgGhnfHCfH5EJauSCcaWuTTN5hUwlQceLl9SVBb5zKUtLAYuHF64KuQs7ujYWvAmpIAMdXPiXeY4YyXDGKaS1XS7x1cBtuiErNRwnTsABDHWysCF1m0BHlOOXzP7kVt76VBVFJl7j8wypAxWnHAu1TEu7vNqcZHBY3mK1wG/4Z+qgZD2RK3PbQuVaz+TGtjxERYGgw3nztoSZONXANyvsLDjDYfghmHe4fHcabglcRL5jxvMEzk1t5Mk5rXNrJO7v/AYQmHqWA1KfRAAAAAElFTkSuQmCC"},"6b22":function(e,t,a){"use strict";var i=a("aaed"),n=a.n(i);n.a},"6d0a":function(e,t,a){"use strict";var i=a("892d"),n=a.n(i);n.a},7421:function(e,t,a){},"77a2":function(e,t,a){},"782b":function(e,t,a){},"79c8":function(e,t,a){},"7a6e":function(e,t,a){"use strict";var i=a("64e3"),n=a.n(i);n.a},"7c31":function(e,t,a){},"7d94":function(e,t,a){},"7e85":function(e,t,a){"use strict";var i=a("3a26"),n=a.n(i);n.a},"7efd":function(e,t,a){e.exports=a.p+"img/logo-jscn.b9c445d9.png"},8078:function(e,t,a){},8095:function(e,t,a){"use strict";var i=a("7c31"),n=a.n(i);n.a},8177:function(e,t,a){"use strict";var i=a("ccd8"),n=a.n(i);n.a},"81eb":function(e,t,a){"use strict";var i=a("216b"),n=a.n(i);n.a},8259:function(e,t,a){"use strict";var i=a("320d"),n=a.n(i);n.a},"833b":function(e,t,a){"use strict";var i=a("e525"),n=a.n(i);n.a},"85c0":function(e,t,a){},"85e6":function(e,t,a){},8686:function(e,t,a){},"86d7":function(e,t,a){},87281:function(e,t,a){"use strict";var i=a("98e7b"),n=a.n(i);n.a},"87d4":function(e,t,a){e.exports=a.p+"img/file.dc19d61e.png"},8857:function(e,t,a){"use strict";var i=a("f808"),n=a.n(i);n.a},"88de":function(e,t,a){},"892d":function(e,t,a){},"8a38":function(e,t,a){},"8a6e":function(e,t,a){"use strict";var i=a("85e6"),n=a.n(i);n.a},"8ac5":function(e,t,a){"use strict";var i=a("5a76"),n=a.n(i);n.a},"8b5d":function(e,t,a){"use strict";var i=a("db7e"),n=a.n(i);n.a},"8c9b":function(e,t,a){"use strict";var i=a("6143"),n=a.n(i);n.a},"8ffe":function(e,t,a){"use strict";var i=a("e320"),n=a.n(i);n.a},9020:function(e,t,a){},"909a":function(e,t,a){},"95be":function(e,t,a){"use strict";var i=a("ca63"),n=a.n(i);n.a},"972d":function(e,t,a){},9742:function(e,t,a){},9788:function(e,t,a){},"97a6":function(e,t,a){"use strict";var i=a("4af5"),n=a.n(i);n.a},"97e2":function(e,t,a){"use strict";var i=a("4cc7"),n=a.n(i);n.a},"98e7b":function(e,t,a){},"99e1":function(e,t,a){"use strict";var i=a("0933"),n=a.n(i);n.a},"9af4":function(e,t,a){"use strict";var i=a("c2dd"),n=a.n(i);n.a},"9c57":function(e,t,a){},"9ce2":function(e,t,a){},"9d6f":function(e,t,a){},a095:function(e,t,a){},a0cd:function(e,t,a){},a14f:function(e,t,a){},a181:function(e,t,a){"use strict";var i=a("d7f6"),n=a.n(i);n.a},a379:function(e,t,a){},a3ea:function(e,t,a){},a536:function(e,t,a){"use strict";var i=a("acda"),n=a.n(i);n.a},a6f8:function(e,t,a){"use strict";var i=a("8a38"),n=a.n(i);n.a},a82c:function(e,t,a){e.exports=a.p+"img/logo-coocaa.bceb1860.png"},a8da:function(e,t,a){"use strict";var i=a("d053"),n=a.n(i);n.a},aaed:function(e,t,a){},aaf9:function(e,t,a){"use strict";var i=a("2d09"),n=a.n(i);n.a},ab5a:function(e,t,a){},acda:function(e,t,a){},ad40:function(e,t,a){"use strict";var i=a("0c40"),n=a.n(i);n.a},adca:function(e,t,a){"use strict";var i=a("28cf"),n=a.n(i);n.a},b2b0:function(e,t,a){},b4d7:function(e,t,a){},b599:function(e,t,a){"use strict";var i=a("e73b"),n=a.n(i);n.a},b637:function(e,t,a){"use strict";var i=a("9ce2"),n=a.n(i);n.a},b6e6:function(e,t,a){},b812:function(e,t,a){},bd60:function(e,t,a){"use strict";var i=a("d3c1"),n=a.n(i);n.a},be0a:function(e,t,a){},be9b:function(e,t,a){},c06a:function(e,t,a){"use strict";var i=a("9020"),n=a.n(i);n.a},c2dd:function(e,t,a){},c34d:function(e,t,a){"use strict";var i=a("21aa"),n=a.n(i);n.a},c566:function(e,t,a){},c7a1:function(e,t,a){},ca63:function(e,t,a){},ca68:function(e,t,a){"use strict";var i=a("9742"),n=a.n(i);n.a},cb4a:function(e,t,a){},cbc1:function(e,t,a){},cc48:function(e,t,a){},ccd8:function(e,t,a){},d053:function(e,t,a){},d0fb:function(e,t,a){"use strict";var i=a("fa3a"),n=a.n(i);n.a},d137:function(e,t,a){"use strict";var i=a("f76f"),n=a.n(i);n.a},d3c1:function(e,t,a){},d42e:function(e,t,a){},d529:function(e,t,a){"use strict";var i=a("ec19"),n=a.n(i);n.a},d57e:function(e,t,a){},d5ab:function(e,t,a){"use strict";var i=a("85c0"),n=a.n(i);n.a},d610:function(e,t,a){"use strict";var i=a("7421"),n=a.n(i);n.a},d62f:function(e,t,a){"use strict";var i=a("65e8"),n=a.n(i);n.a},d6b8:function(e,t,a){},d7f6:function(e,t,a){},d7ff:function(e,t,a){"use strict";var i=a("c7a1"),n=a.n(i);n.a},d82d:function(e,t,a){"use strict";var i=a("e22a"),n=a.n(i);n.a},d92c:function(e,t,a){},db09:function(e,t,a){"use strict";var i=a("e25c"),n=a.n(i);n.a},db7e:function(e,t,a){},dba1:function(e,t,a){},dc37:function(e,t,a){},dc3c:function(e,t,a){},dcd9:function(e,t,a){"use strict";var i=a("972d"),n=a.n(i);n.a},dce0:function(e,t,a){"use strict";var i=a("3e3a"),n=a.n(i);n.a},df77:function(e,t,a){},e020:function(e,t,a){"use strict";var i=a("dc3c"),n=a.n(i);n.a},e091:function(e,t,a){"use strict";var i=a("606e"),n=a.n(i);n.a},e1cc:function(e,t,a){"use strict";var i=a("dc37"),n=a.n(i);n.a},e22a:function(e,t,a){},e25c:function(e,t,a){},e25c4:function(e,t,a){},e320:function(e,t,a){},e345:function(e,t,a){"use strict";var i=a("5e4e"),n=a.n(i);n.a},e433:function(e,t,a){},e525:function(e,t,a){},e716:function(e,t,a){},e73b:function(e,t,a){},e749:function(e,t,a){"use strict";var i=a("77a2"),n=a.n(i);n.a},e86d:function(e,t,a){"use strict";var i=a("a0cd"),n=a.n(i);n.a},e913:function(e,t,a){"use strict";var i=a("0243"),n=a.n(i);n.a},e96a:function(e,t,a){"use strict";var i=a("782b"),n=a.n(i);n.a},e9bb:function(e,t,a){"use strict";var i=a("cc48"),n=a.n(i);n.a},eaf8:function(e,t,a){"use strict";var i=a("a379"),n=a.n(i);n.a},eb2f:function(e,t,a){"use strict";var i=a("b4d7"),n=a.n(i);n.a},ec19:function(e,t,a){},ec194:function(e,t,a){"use strict";var i=a("37b1"),n=a.n(i);n.a},ec25:function(e,t,a){"use strict";var i=a("e716"),n=a.n(i);n.a},ec97:function(e,t,a){"use strict";var i=a("48c0"),n=a.n(i);n.a},ed2c:function(e,t,a){},ed36:function(e,t,a){"use strict";var i=a("f098"),n=a.n(i);n.a},eeee:function(e,t,a){"use strict";var i=a("e25c4"),n=a.n(i);n.a},efa1:function(e,t,a){},f098:function(e,t,a){},f3bf:function(e,t,a){},f5e9:function(e,t,a){"use strict";var i=a("c566"),n=a.n(i);n.a},f63c:function(e,t,a){},f76f:function(e,t,a){},f7cc:function(e,t,a){"use strict";var i=a("53c5"),n=a.n(i);n.a},f808:function(e,t,a){},fa3a:function(e,t,a){},fd3d:function(e,t,a){},fde9:function(e,t,a){},fe46:function(e,t,a){"use strict";var i=a("b812"),n=a.n(i);n.a},fee3:function(e,t,a){"use strict";var i=a("cb4a"),n=a.n(i);n.a}});
//# sourceMappingURL=app.1c2bf425.js.map